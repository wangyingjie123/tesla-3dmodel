function LW(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}function BR(n,e){const t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return e?i=>!!t[i.toLowerCase()]:i=>!!t[i]}const Qr={},ym=[],va=()=>{},fre=()=>!1,hre=/^on[^a-z]/,RS=n=>hre.test(n),UR=n=>n.startsWith("onUpdate:"),fi=Object.assign,zR=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},dre=Object.prototype.hasOwnProperty,qn=(n,e)=>dre.call(n,e),Ht=Array.isArray,_m=n=>g_(n)==="[object Map]",PS=n=>g_(n)==="[object Set]",o0=n=>g_(n)==="[object Date]",rn=n=>typeof n=="function",_n=n=>typeof n=="string",l0=n=>typeof n=="symbol",Fn=n=>n!==null&&typeof n=="object",NW=n=>Fn(n)&&rn(n.then)&&rn(n.catch),OW=Object.prototype.toString,g_=n=>OW.call(n),pre=n=>g_(n).slice(8,-1),$W=n=>g_(n)==="[object Object]",VR=n=>_n(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,y1=BR(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),IS=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},mre=/-(\w)/g,Qo=IS(n=>n.replace(mre,(e,t)=>t?t.toUpperCase():"")),gre=/\B([A-Z])/g,Tf=IS(n=>n.replace(gre,"-$1").toLowerCase()),DS=IS(n=>n.charAt(0).toUpperCase()+n.slice(1)),_1=IS(n=>n?`on${DS(n)}`:""),u0=(n,e)=>!Object.is(n,e),x1=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},lw=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},FW=n=>{const e=parseFloat(n);return isNaN(e)?n:e},vre=n=>{const e=_n(n)?Number(n):NaN;return isNaN(e)?n:e};let o$;const IA=()=>o$||(o$=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ui(n){if(Ht(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=_n(r)?bre(r):ui(r);if(i)for(const a in i)e[a]=i[a]}return e}else{if(_n(n))return n;if(Fn(n))return n}}const yre=/;(?![^(]*\))/g,_re=/:([^]+)/,xre=/\/\*[^]*?\*\//g;function bre(n){const e={};return n.replace(xre,"").split(yre).forEach(t=>{if(t){const r=t.split(_re);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Et(n){let e="";if(_n(n))e=n;else if(Ht(n))for(let t=0;t<n.length;t++){const r=Et(n[t]);r&&(e+=r+" ")}else if(Fn(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}function uy(n){if(!n)return null;let{class:e,style:t}=n;return e&&!_n(e)&&(n.class=Et(e)),t&&(n.style=ui(t)),n}const wre="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Sre=BR(wre);function BW(n){return!!n||n===""}function Tre(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=LS(n[r],e[r]);return t}function LS(n,e){if(n===e)return!0;let t=o0(n),r=o0(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=l0(n),r=l0(e),t||r)return n===e;if(t=Ht(n),r=Ht(e),t||r)return t&&r?Tre(n,e):!1;if(t=Fn(n),r=Fn(e),t||r){if(!t||!r)return!1;const i=Object.keys(n).length,a=Object.keys(e).length;if(i!==a)return!1;for(const s in n){const o=n.hasOwnProperty(s),l=e.hasOwnProperty(s);if(o&&!l||!o&&l||!LS(n[s],e[s]))return!1}}return String(n)===String(e)}function Cre(n,e){return n.findIndex(t=>LS(t,e))}const pi=n=>_n(n)?n:n==null?"":Ht(n)||Fn(n)&&(n.toString===OW||!rn(n.toString))?JSON.stringify(n,UW,2):String(n),UW=(n,e)=>e&&e.__v_isRef?UW(n,e.value):_m(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,i])=>(t[`${r} =>`]=i,t),{})}:PS(e)?{[`Set(${e.size})`]:[...e.values()]}:Fn(e)&&!Ht(e)&&!$W(e)?String(e):e;let ws;class Ere{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ws,!e&&ws&&(this.index=(ws.scopes||(ws.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=ws;try{return ws=this,e()}finally{ws=t}}}on(){ws=this}off(){ws=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function Are(n,e=ws){e&&e.active&&e.effects.push(n)}function zW(){return ws}function Mre(n){ws&&ws.cleanups.push(n)}const HR=n=>{const e=new Set(n);return e.w=0,e.n=0,e},VW=n=>(n.w&of)>0,HW=n=>(n.n&of)>0,kre=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=of},Rre=n=>{const{deps:e}=n;if(e.length){let t=0;for(let r=0;r<e.length;r++){const i=e[r];VW(i)&&!HW(i)?i.delete(n):e[t++]=i,i.w&=~of,i.n&=~of}e.length=t}},uw=new WeakMap;let cy=0,of=1;const DA=30;let Wo;const qh=Symbol(""),LA=Symbol("");class WR{constructor(e,t=null,r){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,Are(this,r)}run(){if(!this.active)return this.fn();let e=Wo,t=Qc;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Wo,Wo=this,Qc=!0,of=1<<++cy,cy<=DA?kre(this):l$(this),this.fn()}finally{cy<=DA&&Rre(this),of=1<<--cy,Wo=this.parent,Qc=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Wo===this?this.deferStop=!0:this.active&&(l$(this),this.onStop&&this.onStop(),this.active=!1)}}function l$(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}let Qc=!0;const WW=[];function Ag(){WW.push(Qc),Qc=!1}function Mg(){const n=WW.pop();Qc=n===void 0?!0:n}function os(n,e,t){if(Qc&&Wo){let r=uw.get(n);r||uw.set(n,r=new Map);let i=r.get(t);i||r.set(t,i=HR()),GW(i)}}function GW(n,e){let t=!1;cy<=DA?HW(n)||(n.n|=of,t=!VW(n)):t=!n.has(Wo),t&&(n.add(Wo),Wo.deps.push(n))}function Hu(n,e,t,r,i,a){const s=uw.get(n);if(!s)return;let o=[];if(e==="clear")o=[...s.values()];else if(t==="length"&&Ht(n)){const l=Number(r);s.forEach((u,c)=>{(c==="length"||c>=l)&&o.push(u)})}else switch(t!==void 0&&o.push(s.get(t)),e){case"add":Ht(n)?VR(t)&&o.push(s.get("length")):(o.push(s.get(qh)),_m(n)&&o.push(s.get(LA)));break;case"delete":Ht(n)||(o.push(s.get(qh)),_m(n)&&o.push(s.get(LA)));break;case"set":_m(n)&&o.push(s.get(qh));break}if(o.length===1)o[0]&&NA(o[0]);else{const l=[];for(const u of o)u&&l.push(...u);NA(HR(l))}}function NA(n,e){const t=Ht(n)?n:[...n];for(const r of t)r.computed&&u$(r);for(const r of t)r.computed||u$(r)}function u$(n,e){(n!==Wo||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function Pre(n,e){var t;return(t=uw.get(n))==null?void 0:t.get(e)}const Ire=BR("__proto__,__v_isRef,__isVue"),jW=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(l0)),Dre=GR(),Lre=GR(!1,!0),Nre=GR(!0),c$=Ore();function Ore(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=er(this);for(let a=0,s=this.length;a<s;a++)os(r,"get",a+"");const i=r[e](...t);return i===-1||i===!1?r[e](...t.map(er)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){Ag();const r=er(this)[e].apply(this,t);return Mg(),r}}),n}function $re(n){const e=er(this);return os(e,"has",n),e.hasOwnProperty(n)}function GR(n=!1,e=!1){return function(r,i,a){if(i==="__v_isReactive")return!n;if(i==="__v_isReadonly")return n;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&a===(n?e?Jre:ZW:e?YW:KW).get(r))return r;const s=Ht(r);if(!n){if(s&&qn(c$,i))return Reflect.get(c$,i,a);if(i==="hasOwnProperty")return $re}const o=Reflect.get(r,i,a);return(l0(i)?jW.has(i):Ire(i))||(n||os(r,"get",i),e)?o:mi(o)?s&&VR(i)?o:o.value:Fn(o)?n?OS(o):bo(o):o}}const Fre=qW(),Bre=qW(!0);function qW(n=!1){return function(t,r,i,a){let s=t[r];if(zm(s)&&mi(s)&&!mi(i))return!1;if(!n&&(!cw(i)&&!zm(i)&&(s=er(s),i=er(i)),!Ht(t)&&mi(s)&&!mi(i)))return s.value=i,!0;const o=Ht(t)&&VR(r)?Number(r)<t.length:qn(t,r),l=Reflect.set(t,r,i,a);return t===er(a)&&(o?u0(i,s)&&Hu(t,"set",r,i):Hu(t,"add",r,i)),l}}function Ure(n,e){const t=qn(n,e);n[e];const r=Reflect.deleteProperty(n,e);return r&&t&&Hu(n,"delete",e,void 0),r}function zre(n,e){const t=Reflect.has(n,e);return(!l0(e)||!jW.has(e))&&os(n,"has",e),t}function Vre(n){return os(n,"iterate",Ht(n)?"length":qh),Reflect.ownKeys(n)}const XW={get:Dre,set:Fre,deleteProperty:Ure,has:zre,ownKeys:Vre},Hre={get:Nre,set(n,e){return!0},deleteProperty(n,e){return!0}},Wre=fi({},XW,{get:Lre,set:Bre}),jR=n=>n,NS=n=>Reflect.getPrototypeOf(n);function vx(n,e,t=!1,r=!1){n=n.__v_raw;const i=er(n),a=er(e);t||(e!==a&&os(i,"get",e),os(i,"get",a));const{has:s}=NS(i),o=r?jR:t?KR:c0;if(s.call(i,e))return o(n.get(e));if(s.call(i,a))return o(n.get(a));n!==i&&n.get(e)}function yx(n,e=!1){const t=this.__v_raw,r=er(t),i=er(n);return e||(n!==i&&os(r,"has",n),os(r,"has",i)),n===i?t.has(n):t.has(n)||t.has(i)}function _x(n,e=!1){return n=n.__v_raw,!e&&os(er(n),"iterate",qh),Reflect.get(n,"size",n)}function f$(n){n=er(n);const e=er(this);return NS(e).has.call(e,n)||(e.add(n),Hu(e,"add",n,n)),this}function h$(n,e){e=er(e);const t=er(this),{has:r,get:i}=NS(t);let a=r.call(t,n);a||(n=er(n),a=r.call(t,n));const s=i.call(t,n);return t.set(n,e),a?u0(e,s)&&Hu(t,"set",n,e):Hu(t,"add",n,e),this}function d$(n){const e=er(this),{has:t,get:r}=NS(e);let i=t.call(e,n);i||(n=er(n),i=t.call(e,n)),r&&r.call(e,n);const a=e.delete(n);return i&&Hu(e,"delete",n,void 0),a}function p$(){const n=er(this),e=n.size!==0,t=n.clear();return e&&Hu(n,"clear",void 0,void 0),t}function xx(n,e){return function(r,i){const a=this,s=a.__v_raw,o=er(s),l=e?jR:n?KR:c0;return!n&&os(o,"iterate",qh),s.forEach((u,c)=>r.call(i,l(u),l(c),a))}}function bx(n,e,t){return function(...r){const i=this.__v_raw,a=er(i),s=_m(a),o=n==="entries"||n===Symbol.iterator&&s,l=n==="keys"&&s,u=i[n](...r),c=t?jR:e?KR:c0;return!e&&os(a,"iterate",l?LA:qh),{next(){const{value:f,done:h}=u.next();return h?{value:f,done:h}:{value:o?[c(f[0]),c(f[1])]:c(f),done:h}},[Symbol.iterator](){return this}}}}function mc(n){return function(...e){return n==="delete"?!1:this}}function Gre(){const n={get(a){return vx(this,a)},get size(){return _x(this)},has:yx,add:f$,set:h$,delete:d$,clear:p$,forEach:xx(!1,!1)},e={get(a){return vx(this,a,!1,!0)},get size(){return _x(this)},has:yx,add:f$,set:h$,delete:d$,clear:p$,forEach:xx(!1,!0)},t={get(a){return vx(this,a,!0)},get size(){return _x(this,!0)},has(a){return yx.call(this,a,!0)},add:mc("add"),set:mc("set"),delete:mc("delete"),clear:mc("clear"),forEach:xx(!0,!1)},r={get(a){return vx(this,a,!0,!0)},get size(){return _x(this,!0)},has(a){return yx.call(this,a,!0)},add:mc("add"),set:mc("set"),delete:mc("delete"),clear:mc("clear"),forEach:xx(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{n[a]=bx(a,!1,!1),t[a]=bx(a,!0,!1),e[a]=bx(a,!1,!0),r[a]=bx(a,!0,!0)}),[n,t,e,r]}const[jre,qre,Xre,Kre]=Gre();function qR(n,e){const t=e?n?Kre:Xre:n?qre:jre;return(r,i,a)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(qn(t,i)&&i in r?t:r,i,a)}const Yre={get:qR(!1,!1)},Zre={get:qR(!1,!0)},Qre={get:qR(!0,!1)},KW=new WeakMap,YW=new WeakMap,ZW=new WeakMap,Jre=new WeakMap;function eie(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function tie(n){return n.__v_skip||!Object.isExtensible(n)?0:eie(pre(n))}function bo(n){return zm(n)?n:XR(n,!1,XW,Yre,KW)}function QW(n){return XR(n,!1,Wre,Zre,YW)}function OS(n){return XR(n,!0,Hre,Qre,ZW)}function XR(n,e,t,r,i){if(!Fn(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const a=i.get(n);if(a)return a;const s=tie(n);if(s===0)return n;const o=new Proxy(n,s===2?r:t);return i.set(n,o),o}function xm(n){return zm(n)?xm(n.__v_raw):!!(n&&n.__v_isReactive)}function zm(n){return!!(n&&n.__v_isReadonly)}function cw(n){return!!(n&&n.__v_isShallow)}function JW(n){return xm(n)||zm(n)}function er(n){const e=n&&n.__v_raw;return e?er(e):n}function eG(n){return lw(n,"__v_skip",!0),n}const c0=n=>Fn(n)?bo(n):n,KR=n=>Fn(n)?OS(n):n;function tG(n){Qc&&Wo&&(n=er(n),GW(n.dep||(n.dep=HR())))}function nG(n,e){n=er(n);const t=n.dep;t&&NA(t)}function mi(n){return!!(n&&n.__v_isRef===!0)}function It(n){return rG(n,!1)}function Py(n){return rG(n,!0)}function rG(n,e){return mi(n)?n:new nie(n,e)}class nie{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:er(e),this._value=t?e:c0(e)}get value(){return tG(this),this._value}set value(e){const t=this.__v_isShallow||cw(e)||zm(e);e=t?e:er(e),u0(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:c0(e),nG(this))}}function Q(n){return mi(n)?n.value:n}const rie={get:(n,e,t)=>Q(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return mi(i)&&!mi(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function iG(n){return xm(n)?n:new Proxy(n,rie)}function YR(n){const e=Ht(n)?new Array(n.length):{};for(const t in n)e[t]=aG(n,t);return e}class iie{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return Pre(er(this._object),this._key)}}class aie{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function Go(n,e,t){return mi(n)?n:rn(n)?new aie(n):Fn(n)&&arguments.length>1?aG(n,e,t):It(n)}function aG(n,e,t){const r=n[e];return mi(r)?r:new iie(n,e,t)}class sie{constructor(e,t,r,i){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new WR(e,()=>{this._dirty||(this._dirty=!0,nG(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=er(this);return tG(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function oie(n,e,t=!1){let r,i;const a=rn(n);return a?(r=n,i=va):(r=n.get,i=n.set),new sie(r,i,a||!i,t)}function lie(n,...e){}function Jc(n,e,t,r){let i;try{i=r?n(...r):n()}catch(a){$S(a,e,t)}return i}function co(n,e,t,r){if(rn(n)){const a=Jc(n,e,t,r);return a&&NW(a)&&a.catch(s=>{$S(s,e,t)}),a}const i=[];for(let a=0;a<n.length;a++)i.push(co(n[a],e,t,r));return i}function $S(n,e,t,r=!0){const i=e?e.vnode:null;if(e){let a=e.parent;const s=e.proxy,o=t;for(;a;){const u=a.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](n,s,o)===!1)return}a=a.parent}const l=e.appContext.config.errorHandler;if(l){Jc(l,null,10,[n,s,o]);return}}uie(n,t,i,r)}function uie(n,e,t,r=!0){console.error(n)}let f0=!1,OA=!1;const ha=[];let Rl=0;const bm=[];let wu=null,kh=0;const sG=Promise.resolve();let ZR=null;function ua(n){const e=ZR||sG;return n?e.then(this?n.bind(this):n):e}function cie(n){let e=Rl+1,t=ha.length;for(;e<t;){const r=e+t>>>1;h0(ha[r])<n?e=r+1:t=r}return e}function QR(n){(!ha.length||!ha.includes(n,f0&&n.allowRecurse?Rl+1:Rl))&&(n.id==null?ha.push(n):ha.splice(cie(n.id),0,n),oG())}function oG(){!f0&&!OA&&(OA=!0,ZR=sG.then(uG))}function fie(n){const e=ha.indexOf(n);e>Rl&&ha.splice(e,1)}function hie(n){Ht(n)?bm.push(...n):(!wu||!wu.includes(n,n.allowRecurse?kh+1:kh))&&bm.push(n),oG()}function m$(n,e=f0?Rl+1:0){for(;e<ha.length;e++){const t=ha[e];t&&t.pre&&(ha.splice(e,1),e--,t())}}function lG(n){if(bm.length){const e=[...new Set(bm)];if(bm.length=0,wu){wu.push(...e);return}for(wu=e,wu.sort((t,r)=>h0(t)-h0(r)),kh=0;kh<wu.length;kh++)wu[kh]();wu=null,kh=0}}const h0=n=>n.id==null?1/0:n.id,die=(n,e)=>{const t=h0(n)-h0(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function uG(n){OA=!1,f0=!0,ha.sort(die);const e=va;try{for(Rl=0;Rl<ha.length;Rl++){const t=ha[Rl];t&&t.active!==!1&&Jc(t,null,14)}}finally{Rl=0,ha.length=0,lG(),f0=!1,ZR=null,(ha.length||bm.length)&&uG()}}function pie(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Qr;let i=t;const a=e.startsWith("update:"),s=a&&e.slice(7);if(s&&s in r){const c=`${s==="modelValue"?"model":s}Modifiers`,{number:f,trim:h}=r[c]||Qr;h&&(i=t.map(d=>_n(d)?d.trim():d)),f&&(i=t.map(FW))}let o,l=r[o=_1(e)]||r[o=_1(Qo(e))];!l&&a&&(l=r[o=_1(Tf(e))]),l&&co(l,n,6,i);const u=r[o+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[o])return;n.emitted[o]=!0,co(u,n,6,i)}}function cG(n,e,t=!1){const r=e.emitsCache,i=r.get(n);if(i!==void 0)return i;const a=n.emits;let s={},o=!1;if(!rn(n)){const l=u=>{const c=cG(u,e,!0);c&&(o=!0,fi(s,c))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!a&&!o?(Fn(n)&&r.set(n,null),null):(Ht(a)?a.forEach(l=>s[l]=null):fi(s,a),Fn(n)&&r.set(n,s),s)}function FS(n,e){return!n||!RS(e)?!1:(e=e.slice(2).replace(/Once$/,""),qn(n,e[0].toLowerCase()+e.slice(1))||qn(n,Tf(e))||qn(n,e))}let Gi=null,BS=null;function fw(n){const e=Gi;return Gi=n,BS=n&&n.type.__scopeId||null,e}function lrt(n){BS=n}function urt(){BS=null}function An(n,e=Gi,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&k$(-1);const a=fw(e);let s;try{s=n(...i)}finally{fw(a),r._d&&k$(1)}return s};return r._n=!0,r._c=!0,r._d=!0,r}function NC(n){const{type:e,vnode:t,proxy:r,withProxy:i,props:a,propsOptions:[s],slots:o,attrs:l,emit:u,render:c,renderCache:f,data:h,setupState:d,ctx:p,inheritAttrs:m}=n;let g,v;const _=fw(n);try{if(t.shapeFlag&4){const b=i||r;g=Al(c.call(b,b,f,a,d,h,p)),v=l}else{const b=e;g=Al(b.length>1?b(a,{attrs:l,slots:o,emit:u}):b(a,null)),v=e.props?l:mie(l)}}catch(b){Ny.length=0,$S(b,n,1),g=Pn(Ms)}let x=g;if(v&&m!==!1){const b=Object.keys(v),{shapeFlag:S}=x;b.length&&S&7&&(s&&b.some(UR)&&(v=gie(v,s)),x=Wu(x,v))}return t.dirs&&(x=Wu(x),x.dirs=x.dirs?x.dirs.concat(t.dirs):t.dirs),t.transition&&(x.transition=t.transition),g=x,fw(_),g}const mie=n=>{let e;for(const t in n)(t==="class"||t==="style"||RS(t))&&((e||(e={}))[t]=n[t]);return e},gie=(n,e)=>{const t={};for(const r in n)(!UR(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function vie(n,e,t){const{props:r,children:i,component:a}=n,{props:s,children:o,patchFlag:l}=e,u=a.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?g$(r,s,u):!!s;if(l&8){const c=e.dynamicProps;for(let f=0;f<c.length;f++){const h=c[f];if(s[h]!==r[h]&&!FS(u,h))return!0}}}else return(i||o)&&(!o||!o.$stable)?!0:r===s?!1:r?s?g$(r,s,u):!0:!!s;return!1}function g$(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const a=r[i];if(e[a]!==n[a]&&!FS(t,a))return!0}return!1}function yie({vnode:n,parent:e},t){for(;e&&e.subTree===n;)(n=e.vnode).el=t,e=e.parent}const _ie=n=>n.__isSuspense;function xie(n,e){e&&e.pendingBranch?Ht(n)?e.effects.push(...n):e.effects.push(n):hie(n)}function bie(n,e){return JR(n,null,e)}const Sx={};function Sn(n,e,t){return JR(n,e,t)}function JR(n,e,{immediate:t,deep:r,flush:i,onTrack:a,onTrigger:s}=Qr){var o;const l=zW()===((o=Oi)==null?void 0:o.scope)?Oi:null;let u,c=!1,f=!1;if(mi(n)?(u=()=>n.value,c=cw(n)):xm(n)?(u=()=>n,r=!0):Ht(n)?(f=!0,c=n.some(b=>xm(b)||cw(b)),u=()=>n.map(b=>{if(mi(b))return b.value;if(xm(b))return Oh(b);if(rn(b))return Jc(b,l,2)})):rn(n)?e?u=()=>Jc(n,l,2):u=()=>{if(!(l&&l.isUnmounted))return h&&h(),co(n,l,3,[d])}:u=va,e&&r){const b=u;u=()=>Oh(b())}let h,d=b=>{h=_.onStop=()=>{Jc(b,l,4)}},p;if(g0)if(d=va,e?t&&co(e,l,3,[u(),f?[]:void 0,d]):u(),i==="sync"){const b=dae();p=b.__watcherHandles||(b.__watcherHandles=[])}else return va;let m=f?new Array(n.length).fill(Sx):Sx;const g=()=>{if(_.active)if(e){const b=_.run();(r||c||(f?b.some((S,T)=>u0(S,m[T])):u0(b,m)))&&(h&&h(),co(e,l,3,[b,m===Sx?void 0:f&&m[0]===Sx?[]:m,d]),m=b)}else _.run()};g.allowRecurse=!!e;let v;i==="sync"?v=g:i==="post"?v=()=>qa(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),v=()=>QR(g));const _=new WR(u,v);e?t?g():m=_.run():i==="post"?qa(_.run.bind(_),l&&l.suspense):_.run();const x=()=>{_.stop(),l&&l.scope&&zR(l.scope.effects,_)};return p&&p.push(x),x}function wie(n,e,t){const r=this.proxy,i=_n(n)?n.includes(".")?fG(r,n):()=>r[n]:n.bind(r,r);let a;rn(e)?a=e:(a=e.handler,t=e);const s=Oi;Vm(this);const o=JR(i,a.bind(r),t);return s?Vm(s):Xh(),o}function fG(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}function Oh(n,e){if(!Fn(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),mi(n))Oh(n.value,e);else if(Ht(n))for(let t=0;t<n.length;t++)Oh(n[t],e);else if(PS(n)||_m(n))n.forEach(t=>{Oh(t,e)});else if($W(n))for(const t in n)Oh(n[t],e);return n}function Cf(n,e){const t=Gi;if(t===null)return n;const r=HS(t)||t.proxy,i=n.dirs||(n.dirs=[]);for(let a=0;a<e.length;a++){let[s,o,l,u=Qr]=e[a];s&&(rn(s)&&(s={mounted:s,updated:s}),s.deep&&Oh(o),i.push({dir:s,instance:r,value:o,oldValue:void 0,arg:l,modifiers:u}))}return n}function Wf(n,e,t,r){const i=n.dirs,a=e&&e.dirs;for(let s=0;s<i.length;s++){const o=i[s];a&&(o.oldValue=a[s].value);let l=o.dir[r];l&&(Ag(),co(l,t,8,[n.el,o,n,e]),Mg())}}function hG(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ii(()=>{n.isMounted=!0}),cs(()=>{n.isUnmounting=!0}),n}const $s=[Function,Array],dG={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:$s,onEnter:$s,onAfterEnter:$s,onEnterCancelled:$s,onBeforeLeave:$s,onLeave:$s,onAfterLeave:$s,onLeaveCancelled:$s,onBeforeAppear:$s,onAppear:$s,onAfterAppear:$s,onAppearCancelled:$s},Sie={name:"BaseTransition",props:dG,setup(n,{slots:e}){const t=Is(),r=hG();let i;return()=>{const a=e.default&&eP(e.default(),!0);if(!a||!a.length)return;let s=a[0];if(a.length>1){for(const m of a)if(m.type!==Ms){s=m;break}}const o=er(n),{mode:l}=o;if(r.isLeaving)return OC(s);const u=v$(s);if(!u)return OC(s);const c=d0(u,o,r,t);p0(u,c);const f=t.subTree,h=f&&v$(f);let d=!1;const{getTransitionKey:p}=u.type;if(p){const m=p();i===void 0?i=m:m!==i&&(i=m,d=!0)}if(h&&h.type!==Ms&&(!Rh(u,h)||d)){const m=d0(h,o,r,t);if(p0(h,m),l==="out-in")return r.isLeaving=!0,m.afterLeave=()=>{r.isLeaving=!1,t.update.active!==!1&&t.update()},OC(s);l==="in-out"&&u.type!==Ms&&(m.delayLeave=(g,v,_)=>{const x=pG(r,h);x[String(h.key)]=h,g._leaveCb=()=>{v(),g._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=_})}return s}}},Tie=Sie;function pG(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function d0(n,e,t,r){const{appear:i,mode:a,persisted:s=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:u,onEnterCancelled:c,onBeforeLeave:f,onLeave:h,onAfterLeave:d,onLeaveCancelled:p,onBeforeAppear:m,onAppear:g,onAfterAppear:v,onAppearCancelled:_}=e,x=String(n.key),b=pG(t,n),S=(C,k)=>{C&&co(C,r,9,k)},T=(C,k)=>{const R=k[1];S(C,k),Ht(C)?C.every(P=>P.length<=1)&&R():C.length<=1&&R()},M={mode:a,persisted:s,beforeEnter(C){let k=o;if(!t.isMounted)if(i)k=m||o;else return;C._leaveCb&&C._leaveCb(!0);const R=b[x];R&&Rh(n,R)&&R.el._leaveCb&&R.el._leaveCb(),S(k,[C])},enter(C){let k=l,R=u,P=c;if(!t.isMounted)if(i)k=g||l,R=v||u,P=_||c;else return;let N=!1;const L=C._enterCb=F=>{N||(N=!0,F?S(P,[C]):S(R,[C]),M.delayedLeave&&M.delayedLeave(),C._enterCb=void 0)};k?T(k,[C,L]):L()},leave(C,k){const R=String(n.key);if(C._enterCb&&C._enterCb(!0),t.isUnmounting)return k();S(f,[C]);let P=!1;const N=C._leaveCb=L=>{P||(P=!0,k(),L?S(p,[C]):S(d,[C]),C._leaveCb=void 0,b[R]===n&&delete b[R])};b[R]=n,h?T(h,[C,N]):N()},clone(C){return d0(C,e,t,r)}};return M}function OC(n){if(US(n))return n=Wu(n),n.children=null,n}function v$(n){return US(n)?n.children?n.children[0]:void 0:n}function p0(n,e){n.shapeFlag&6&&n.component?p0(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function eP(n,e=!1,t){let r=[],i=0;for(let a=0;a<n.length;a++){let s=n[a];const o=t==null?s.key:String(t)+String(s.key!=null?s.key:a);s.type===hr?(s.patchFlag&128&&i++,r=r.concat(eP(s.children,e,o))):(e||s.type!==Ms)&&r.push(o!=null?Wu(s,{key:o}):s)}if(i>1)for(let a=0;a<r.length;a++)r[a].patchFlag=-2;return r}function Dt(n,e){return rn(n)?(()=>fi({name:n.name},e,{setup:n}))():n}const Iy=n=>!!n.type.__asyncLoader,US=n=>n.type.__isKeepAlive;function Cie(n,e){gG(n,"a",e)}function mG(n,e){gG(n,"da",e)}function gG(n,e,t=Oi){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(zS(e,r,t),t){let i=t.parent;for(;i&&i.parent;)US(i.parent.vnode)&&Eie(r,e,t,i),i=i.parent}}function Eie(n,e,t,r){const i=zS(e,n,r,!0);nP(()=>{zR(r[e],i)},t)}function zS(n,e,t=Oi,r=!1){if(t){const i=t[n]||(t[n]=[]),a=e.__weh||(e.__weh=(...s)=>{if(t.isUnmounted)return;Ag(),Vm(t);const o=co(e,t,n,s);return Xh(),Mg(),o});return r?i.unshift(a):i.push(a),a}}const ec=n=>(e,t=Oi)=>(!g0||n==="sp")&&zS(n,(...r)=>e(...r),t),vG=ec("bm"),Ii=ec("m"),Aie=ec("bu"),tP=ec("u"),cs=ec("bum"),nP=ec("um"),Mie=ec("sp"),kie=ec("rtg"),Rie=ec("rtc");function Pie(n,e=Oi){zS("ec",n,e)}const rP="components";function Iie(n,e){return _G(rP,n,!0,e)||n}const yG=Symbol.for("v-ndc");function ro(n){return _n(n)?_G(rP,n,!1)||n:n||yG}function _G(n,e,t=!0,r=!1){const i=Gi||Oi;if(i){const a=i.type;if(n===rP){const o=cae(a,!1);if(o&&(o===e||o===Qo(e)||o===DS(Qo(e))))return a}const s=y$(i[n]||a[n],e)||y$(i.appContext[n],e);return!s&&r?a:s}}function y$(n,e){return n&&(n[e]||n[Qo(e)]||n[DS(Qo(e))])}function wm(n,e,t,r){let i;const a=t&&t[r];if(Ht(n)||_n(n)){i=new Array(n.length);for(let s=0,o=n.length;s<o;s++)i[s]=e(n[s],s,void 0,a&&a[s])}else if(typeof n=="number"){i=new Array(n);for(let s=0;s<n;s++)i[s]=e(s+1,s,void 0,a&&a[s])}else if(Fn(n))if(n[Symbol.iterator])i=Array.from(n,(s,o)=>e(s,o,void 0,a&&a[o]));else{const s=Object.keys(n);i=new Array(s.length);for(let o=0,l=s.length;o<l;o++){const u=s[o];i[o]=e(n[u],u,o,a&&a[o])}}else i=[];return t&&(t[r]=i),i}function _$(n,e){for(let t=0;t<e.length;t++){const r=e[t];if(Ht(r))for(let i=0;i<r.length;i++)n[r[i].name]=r[i].fn;else r&&(n[r.name]=r.key?(...i)=>{const a=r.fn(...i);return a&&(a.key=r.key),a}:r.fn)}return n}function en(n,e,t={},r,i){if(Gi.isCE||Gi.parent&&Iy(Gi.parent)&&Gi.parent.isCE)return e!=="default"&&(t.name=e),Pn("slot",t,r&&r());let a=n[e];a&&a._c&&(a._d=!1),at();const s=a&&xG(a(t)),o=On(hr,{key:t.key||s&&s.key||`_${e}`},s||(r?r():[]),s&&n._===1?64:-2);return!i&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),a&&a._c&&(a._d=!0),o}function xG(n){return n.some(e=>lf(e)?!(e.type===Ms||e.type===hr&&!xG(e.children)):!0)?n:null}function Die(n,e){const t={};for(const r in n)t[e&&/[A-Z]/.test(r)?`on:${r}`:_1(r)]=n[r];return t}const $A=n=>n?IG(n)?HS(n)||n.proxy:$A(n.parent):null,Dy=fi(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>$A(n.parent),$root:n=>$A(n.root),$emit:n=>n.emit,$options:n=>iP(n),$forceUpdate:n=>n.f||(n.f=()=>QR(n.update)),$nextTick:n=>n.n||(n.n=ua.bind(n.proxy)),$watch:n=>wie.bind(n)}),$C=(n,e)=>n!==Qr&&!n.__isScriptSetup&&qn(n,e),Lie={get({_:n},e){const{ctx:t,setupState:r,data:i,props:a,accessCache:s,type:o,appContext:l}=n;let u;if(e[0]!=="$"){const d=s[e];if(d!==void 0)switch(d){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return a[e]}else{if($C(r,e))return s[e]=1,r[e];if(i!==Qr&&qn(i,e))return s[e]=2,i[e];if((u=n.propsOptions[0])&&qn(u,e))return s[e]=3,a[e];if(t!==Qr&&qn(t,e))return s[e]=4,t[e];FA&&(s[e]=0)}}const c=Dy[e];let f,h;if(c)return e==="$attrs"&&os(n,"get",e),c(n);if((f=o.__cssModules)&&(f=f[e]))return f;if(t!==Qr&&qn(t,e))return s[e]=4,t[e];if(h=l.config.globalProperties,qn(h,e))return h[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:a}=n;return $C(i,e)?(i[e]=t,!0):r!==Qr&&qn(r,e)?(r[e]=t,!0):qn(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(a[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:a}},s){let o;return!!t[s]||n!==Qr&&qn(n,s)||$C(e,s)||(o=a[0])&&qn(o,s)||qn(r,s)||qn(Dy,s)||qn(i.config.globalProperties,s)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:qn(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function v_(){return bG().slots}function Nie(){return bG().attrs}function bG(){const n=Is();return n.setupContext||(n.setupContext=LG(n))}function x$(n){return Ht(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let FA=!0;function Oie(n){const e=iP(n),t=n.proxy,r=n.ctx;FA=!1,e.beforeCreate&&b$(e.beforeCreate,n,"bc");const{data:i,computed:a,methods:s,watch:o,provide:l,inject:u,created:c,beforeMount:f,mounted:h,beforeUpdate:d,updated:p,activated:m,deactivated:g,beforeDestroy:v,beforeUnmount:_,destroyed:x,unmounted:b,render:S,renderTracked:T,renderTriggered:M,errorCaptured:C,serverPrefetch:k,expose:R,inheritAttrs:P,components:N,directives:L,filters:F}=e;if(u&&$ie(u,r,null),s)for(const H in s){const j=s[H];rn(j)&&(r[H]=j.bind(t))}if(i){const H=i.call(t,t);Fn(H)&&(n.data=bo(H))}if(FA=!0,a)for(const H in a){const j=a[H],K=rn(j)?j.bind(t,t):rn(j.get)?j.get.bind(t,t):va,J=!rn(j)&&rn(j.set)?j.set.bind(t):va,re=Le({get:K,set:J});Object.defineProperty(r,H,{enumerable:!0,configurable:!0,get:()=>re.value,set:se=>re.value=se})}if(o)for(const H in o)wG(o[H],r,t,H);if(l){const H=rn(l)?l.call(t):l;Reflect.ownKeys(H).forEach(j=>{Ci(j,H[j])})}c&&b$(c,n,"c");function B(H,j){Ht(j)?j.forEach(K=>H(K.bind(t))):j&&H(j.bind(t))}if(B(vG,f),B(Ii,h),B(Aie,d),B(tP,p),B(Cie,m),B(mG,g),B(Pie,C),B(Rie,T),B(kie,M),B(cs,_),B(nP,b),B(Mie,k),Ht(R))if(R.length){const H=n.exposed||(n.exposed={});R.forEach(j=>{Object.defineProperty(H,j,{get:()=>t[j],set:K=>t[j]=K})})}else n.exposed||(n.exposed={});S&&n.render===va&&(n.render=S),P!=null&&(n.inheritAttrs=P),N&&(n.components=N),L&&(n.directives=L)}function $ie(n,e,t=va){Ht(n)&&(n=BA(n));for(const r in n){const i=n[r];let a;Fn(i)?"default"in i?a=$n(i.from||r,i.default,!0):a=$n(i.from||r):a=$n(i),mi(a)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:s=>a.value=s}):e[r]=a}}function b$(n,e,t){co(Ht(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function wG(n,e,t,r){const i=r.includes(".")?fG(t,r):()=>t[r];if(_n(n)){const a=e[n];rn(a)&&Sn(i,a)}else if(rn(n))Sn(i,n.bind(t));else if(Fn(n))if(Ht(n))n.forEach(a=>wG(a,e,t,r));else{const a=rn(n.handler)?n.handler.bind(t):e[n.handler];rn(a)&&Sn(i,a,n)}}function iP(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=n.appContext,o=a.get(e);let l;return o?l=o:!i.length&&!t&&!r?l=e:(l={},i.length&&i.forEach(u=>hw(l,u,s,!0)),hw(l,e,s)),Fn(e)&&a.set(e,l),l}function hw(n,e,t,r=!1){const{mixins:i,extends:a}=e;a&&hw(n,a,t,!0),i&&i.forEach(s=>hw(n,s,t,!0));for(const s in e)if(!(r&&s==="expose")){const o=Fie[s]||t&&t[s];n[s]=o?o(n[s],e[s]):e[s]}return n}const Fie={data:w$,props:S$,emits:S$,methods:fy,computed:fy,beforeCreate:Ra,created:Ra,beforeMount:Ra,mounted:Ra,beforeUpdate:Ra,updated:Ra,beforeDestroy:Ra,beforeUnmount:Ra,destroyed:Ra,unmounted:Ra,activated:Ra,deactivated:Ra,errorCaptured:Ra,serverPrefetch:Ra,components:fy,directives:fy,watch:Uie,provide:w$,inject:Bie};function w$(n,e){return e?n?function(){return fi(rn(n)?n.call(this,this):n,rn(e)?e.call(this,this):e)}:e:n}function Bie(n,e){return fy(BA(n),BA(e))}function BA(n){if(Ht(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Ra(n,e){return n?[...new Set([].concat(n,e))]:e}function fy(n,e){return n?fi(Object.create(null),n,e):e}function S$(n,e){return n?Ht(n)&&Ht(e)?[...new Set([...n,...e])]:fi(Object.create(null),x$(n),x$(e??{})):e}function Uie(n,e){if(!n)return e;if(!e)return n;const t=fi(Object.create(null),n);for(const r in e)t[r]=Ra(n[r],e[r]);return t}function SG(){return{app:null,config:{isNativeTag:fre,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let zie=0;function Vie(n,e){return function(r,i=null){rn(r)||(r=fi({},r)),i!=null&&!Fn(i)&&(i=null);const a=SG(),s=new Set;let o=!1;const l=a.app={_uid:zie++,_component:r,_props:i,_container:null,_context:a,_instance:null,version:pae,get config(){return a.config},set config(u){},use(u,...c){return s.has(u)||(u&&rn(u.install)?(s.add(u),u.install(l,...c)):rn(u)&&(s.add(u),u(l,...c))),l},mixin(u){return a.mixins.includes(u)||a.mixins.push(u),l},component(u,c){return c?(a.components[u]=c,l):a.components[u]},directive(u,c){return c?(a.directives[u]=c,l):a.directives[u]},mount(u,c,f){if(!o){const h=Pn(r,i);return h.appContext=a,c&&e?e(h,u):n(h,u,f),o=!0,l._container=u,u.__vue_app__=l,HS(h.component)||h.component.proxy}},unmount(){o&&(n(null,l._container),delete l._container.__vue_app__)},provide(u,c){return a.provides[u]=c,l},runWithContext(u){dw=l;try{return u()}finally{dw=null}}};return l}}let dw=null;function Ci(n,e){if(Oi){let t=Oi.provides;const r=Oi.parent&&Oi.parent.provides;r===t&&(t=Oi.provides=Object.create(r)),t[n]=e}}function $n(n,e,t=!1){const r=Oi||Gi;if(r||dw){const i=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:dw._context.provides;if(i&&n in i)return i[n];if(arguments.length>1)return t&&rn(e)?e.call(r&&r.proxy):e}}function Hie(n,e,t,r=!1){const i={},a={};lw(a,VS,1),n.propsDefaults=Object.create(null),TG(n,e,i,a);for(const s in n.propsOptions[0])s in i||(i[s]=void 0);t?n.props=r?i:QW(i):n.type.props?n.props=i:n.props=a,n.attrs=a}function Wie(n,e,t,r){const{props:i,attrs:a,vnode:{patchFlag:s}}=n,o=er(i),[l]=n.propsOptions;let u=!1;if((r||s>0)&&!(s&16)){if(s&8){const c=n.vnode.dynamicProps;for(let f=0;f<c.length;f++){let h=c[f];if(FS(n.emitsOptions,h))continue;const d=e[h];if(l)if(qn(a,h))d!==a[h]&&(a[h]=d,u=!0);else{const p=Qo(h);i[p]=UA(l,o,p,d,n,!1)}else d!==a[h]&&(a[h]=d,u=!0)}}}else{TG(n,e,i,a)&&(u=!0);let c;for(const f in o)(!e||!qn(e,f)&&((c=Tf(f))===f||!qn(e,c)))&&(l?t&&(t[f]!==void 0||t[c]!==void 0)&&(i[f]=UA(l,o,f,void 0,n,!0)):delete i[f]);if(a!==o)for(const f in a)(!e||!qn(e,f))&&(delete a[f],u=!0)}u&&Hu(n,"set","$attrs")}function TG(n,e,t,r){const[i,a]=n.propsOptions;let s=!1,o;if(e)for(let l in e){if(y1(l))continue;const u=e[l];let c;i&&qn(i,c=Qo(l))?!a||!a.includes(c)?t[c]=u:(o||(o={}))[c]=u:FS(n.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,s=!0)}if(a){const l=er(t),u=o||Qr;for(let c=0;c<a.length;c++){const f=a[c];t[f]=UA(i,l,f,u[f],n,!qn(u,f))}}return s}function UA(n,e,t,r,i,a){const s=n[t];if(s!=null){const o=qn(s,"default");if(o&&r===void 0){const l=s.default;if(s.type!==Function&&!s.skipFactory&&rn(l)){const{propsDefaults:u}=i;t in u?r=u[t]:(Vm(i),r=u[t]=l.call(null,e),Xh())}else r=l}s[0]&&(a&&!o?r=!1:s[1]&&(r===""||r===Tf(t))&&(r=!0))}return r}function CG(n,e,t=!1){const r=e.propsCache,i=r.get(n);if(i)return i;const a=n.props,s={},o=[];let l=!1;if(!rn(n)){const c=f=>{l=!0;const[h,d]=CG(f,e,!0);fi(s,h),d&&o.push(...d)};!t&&e.mixins.length&&e.mixins.forEach(c),n.extends&&c(n.extends),n.mixins&&n.mixins.forEach(c)}if(!a&&!l)return Fn(n)&&r.set(n,ym),ym;if(Ht(a))for(let c=0;c<a.length;c++){const f=Qo(a[c]);T$(f)&&(s[f]=Qr)}else if(a)for(const c in a){const f=Qo(c);if(T$(f)){const h=a[c],d=s[f]=Ht(h)||rn(h)?{type:h}:fi({},h);if(d){const p=A$(Boolean,d.type),m=A$(String,d.type);d[0]=p>-1,d[1]=m<0||p<m,(p>-1||qn(d,"default"))&&o.push(f)}}}const u=[s,o];return Fn(n)&&r.set(n,u),u}function T$(n){return n[0]!=="$"}function C$(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function E$(n,e){return C$(n)===C$(e)}function A$(n,e){return Ht(e)?e.findIndex(t=>E$(t,n)):rn(e)&&E$(e,n)?0:-1}const EG=n=>n[0]==="_"||n==="$stable",aP=n=>Ht(n)?n.map(Al):[Al(n)],Gie=(n,e,t)=>{if(e._n)return e;const r=An((...i)=>aP(e(...i)),t);return r._c=!1,r},AG=(n,e,t)=>{const r=n._ctx;for(const i in n){if(EG(i))continue;const a=n[i];if(rn(a))e[i]=Gie(i,a,r);else if(a!=null){const s=aP(a);e[i]=()=>s}}},MG=(n,e)=>{const t=aP(e);n.slots.default=()=>t},jie=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=er(e),lw(e,"_",t)):AG(e,n.slots={})}else n.slots={},e&&MG(n,e);lw(n.slots,VS,1)},qie=(n,e,t)=>{const{vnode:r,slots:i}=n;let a=!0,s=Qr;if(r.shapeFlag&32){const o=e._;o?t&&o===1?a=!1:(fi(i,e),!t&&o===1&&delete i._):(a=!e.$stable,AG(e,i)),s=e}else e&&(MG(n,e),s={default:1});if(a)for(const o in i)!EG(o)&&!(o in s)&&delete i[o]};function zA(n,e,t,r,i=!1){if(Ht(n)){n.forEach((h,d)=>zA(h,e&&(Ht(e)?e[d]:e),t,r,i));return}if(Iy(r)&&!i)return;const a=r.shapeFlag&4?HS(r.component)||r.component.proxy:r.el,s=i?null:a,{i:o,r:l}=n,u=e&&e.r,c=o.refs===Qr?o.refs={}:o.refs,f=o.setupState;if(u!=null&&u!==l&&(_n(u)?(c[u]=null,qn(f,u)&&(f[u]=null)):mi(u)&&(u.value=null)),rn(l))Jc(l,o,12,[s,c]);else{const h=_n(l),d=mi(l);if(h||d){const p=()=>{if(n.f){const m=h?qn(f,l)?f[l]:c[l]:l.value;i?Ht(m)&&zR(m,a):Ht(m)?m.includes(a)||m.push(a):h?(c[l]=[a],qn(f,l)&&(f[l]=c[l])):(l.value=[a],n.k&&(c[n.k]=l.value))}else h?(c[l]=s,qn(f,l)&&(f[l]=s)):d&&(l.value=s,n.k&&(c[n.k]=s))};s?(p.id=-1,qa(p,t)):p()}}}const qa=xie;function Xie(n){return Kie(n)}function Kie(n,e){const t=IA();t.__VUE__=!0;const{insert:r,remove:i,patchProp:a,createElement:s,createText:o,createComment:l,setText:u,setElementText:c,parentNode:f,nextSibling:h,setScopeId:d=va,insertStaticContent:p}=n,m=(ee,ie,xe,Ve=null,Ge=null,Ze=null,ut=!1,Qe=null,ve=!!ie.dynamicChildren)=>{if(ee===ie)return;ee&&!Rh(ee,ie)&&(Ve=me(ee),se(ee,Ge,Ze,!0),ee=null),ie.patchFlag===-2&&(ve=!1,ie.dynamicChildren=null);const{type:Ke,ref:ne,shapeFlag:Z}=ie;switch(Ke){case kg:g(ee,ie,xe,Ve);break;case Ms:v(ee,ie,xe,Ve);break;case b1:ee==null&&_(ie,xe,Ve,ut);break;case hr:N(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve);break;default:Z&1?S(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve):Z&6?L(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve):(Z&64||Z&128)&&Ke.process(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve,Me)}ne!=null&&Ge&&zA(ne,ee&&ee.ref,Ze,ie||ee,!ie)},g=(ee,ie,xe,Ve)=>{if(ee==null)r(ie.el=o(ie.children),xe,Ve);else{const Ge=ie.el=ee.el;ie.children!==ee.children&&u(Ge,ie.children)}},v=(ee,ie,xe,Ve)=>{ee==null?r(ie.el=l(ie.children||""),xe,Ve):ie.el=ee.el},_=(ee,ie,xe,Ve)=>{[ee.el,ee.anchor]=p(ee.children,ie,xe,Ve,ee.el,ee.anchor)},x=({el:ee,anchor:ie},xe,Ve)=>{let Ge;for(;ee&&ee!==ie;)Ge=h(ee),r(ee,xe,Ve),ee=Ge;r(ie,xe,Ve)},b=({el:ee,anchor:ie})=>{let xe;for(;ee&&ee!==ie;)xe=h(ee),i(ee),ee=xe;i(ie)},S=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve)=>{ut=ut||ie.type==="svg",ee==null?T(ie,xe,Ve,Ge,Ze,ut,Qe,ve):k(ee,ie,Ge,Ze,ut,Qe,ve)},T=(ee,ie,xe,Ve,Ge,Ze,ut,Qe)=>{let ve,Ke;const{type:ne,props:Z,shapeFlag:fe,transition:Be,dirs:Xe}=ee;if(ve=ee.el=s(ee.type,Ze,Z&&Z.is,Z),fe&8?c(ve,ee.children):fe&16&&C(ee.children,ve,null,Ve,Ge,Ze&&ne!=="foreignObject",ut,Qe),Xe&&Wf(ee,null,Ve,"created"),M(ve,ee,ee.scopeId,ut,Ve),Z){for(const mt in Z)mt!=="value"&&!y1(mt)&&a(ve,mt,null,Z[mt],Ze,ee.children,Ve,Ge,we);"value"in Z&&a(ve,"value",null,Z.value),(Ke=Z.onVnodeBeforeMount)&&_l(Ke,Ve,ee)}Xe&&Wf(ee,null,Ve,"beforeMount");const st=(!Ge||Ge&&!Ge.pendingBranch)&&Be&&!Be.persisted;st&&Be.beforeEnter(ve),r(ve,ie,xe),((Ke=Z&&Z.onVnodeMounted)||st||Xe)&&qa(()=>{Ke&&_l(Ke,Ve,ee),st&&Be.enter(ve),Xe&&Wf(ee,null,Ve,"mounted")},Ge)},M=(ee,ie,xe,Ve,Ge)=>{if(xe&&d(ee,xe),Ve)for(let Ze=0;Ze<Ve.length;Ze++)d(ee,Ve[Ze]);if(Ge){let Ze=Ge.subTree;if(ie===Ze){const ut=Ge.vnode;M(ee,ut,ut.scopeId,ut.slotScopeIds,Ge.parent)}}},C=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve=0)=>{for(let Ke=ve;Ke<ee.length;Ke++){const ne=ee[Ke]=Qe?Fc(ee[Ke]):Al(ee[Ke]);m(null,ne,ie,xe,Ve,Ge,Ze,ut,Qe)}},k=(ee,ie,xe,Ve,Ge,Ze,ut)=>{const Qe=ie.el=ee.el;let{patchFlag:ve,dynamicChildren:Ke,dirs:ne}=ie;ve|=ee.patchFlag&16;const Z=ee.props||Qr,fe=ie.props||Qr;let Be;xe&&Gf(xe,!1),(Be=fe.onVnodeBeforeUpdate)&&_l(Be,xe,ie,ee),ne&&Wf(ie,ee,xe,"beforeUpdate"),xe&&Gf(xe,!0);const Xe=Ge&&ie.type!=="foreignObject";if(Ke?R(ee.dynamicChildren,Ke,Qe,xe,Ve,Xe,Ze):ut||j(ee,ie,Qe,null,xe,Ve,Xe,Ze,!1),ve>0){if(ve&16)P(Qe,ie,Z,fe,xe,Ve,Ge);else if(ve&2&&Z.class!==fe.class&&a(Qe,"class",null,fe.class,Ge),ve&4&&a(Qe,"style",Z.style,fe.style,Ge),ve&8){const st=ie.dynamicProps;for(let mt=0;mt<st.length;mt++){const ye=st[mt],$e=Z[ye],vt=fe[ye];(vt!==$e||ye==="value")&&a(Qe,ye,$e,vt,Ge,ee.children,xe,Ve,we)}}ve&1&&ee.children!==ie.children&&c(Qe,ie.children)}else!ut&&Ke==null&&P(Qe,ie,Z,fe,xe,Ve,Ge);((Be=fe.onVnodeUpdated)||ne)&&qa(()=>{Be&&_l(Be,xe,ie,ee),ne&&Wf(ie,ee,xe,"updated")},Ve)},R=(ee,ie,xe,Ve,Ge,Ze,ut)=>{for(let Qe=0;Qe<ie.length;Qe++){const ve=ee[Qe],Ke=ie[Qe],ne=ve.el&&(ve.type===hr||!Rh(ve,Ke)||ve.shapeFlag&70)?f(ve.el):xe;m(ve,Ke,ne,null,Ve,Ge,Ze,ut,!0)}},P=(ee,ie,xe,Ve,Ge,Ze,ut)=>{if(xe!==Ve){if(xe!==Qr)for(const Qe in xe)!y1(Qe)&&!(Qe in Ve)&&a(ee,Qe,xe[Qe],null,ut,ie.children,Ge,Ze,we);for(const Qe in Ve){if(y1(Qe))continue;const ve=Ve[Qe],Ke=xe[Qe];ve!==Ke&&Qe!=="value"&&a(ee,Qe,Ke,ve,ut,ie.children,Ge,Ze,we)}"value"in Ve&&a(ee,"value",xe.value,Ve.value)}},N=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve)=>{const Ke=ie.el=ee?ee.el:o(""),ne=ie.anchor=ee?ee.anchor:o("");let{patchFlag:Z,dynamicChildren:fe,slotScopeIds:Be}=ie;Be&&(Qe=Qe?Qe.concat(Be):Be),ee==null?(r(Ke,xe,Ve),r(ne,xe,Ve),C(ie.children,xe,ne,Ge,Ze,ut,Qe,ve)):Z>0&&Z&64&&fe&&ee.dynamicChildren?(R(ee.dynamicChildren,fe,xe,Ge,Ze,ut,Qe),(ie.key!=null||Ge&&ie===Ge.subTree)&&sP(ee,ie,!0)):j(ee,ie,xe,ne,Ge,Ze,ut,Qe,ve)},L=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve)=>{ie.slotScopeIds=Qe,ee==null?ie.shapeFlag&512?Ge.ctx.activate(ie,xe,Ve,ut,ve):F(ie,xe,Ve,Ge,Ze,ut,ve):O(ee,ie,ve)},F=(ee,ie,xe,Ve,Ge,Ze,ut)=>{const Qe=ee.component=sae(ee,Ve,Ge);if(US(ee)&&(Qe.ctx.renderer=Me),oae(Qe),Qe.asyncDep){if(Ge&&Ge.registerDep(Qe,B),!ee.el){const ve=Qe.subTree=Pn(Ms);v(null,ve,ie,xe)}return}B(Qe,ee,ie,xe,Ge,Ze,ut)},O=(ee,ie,xe)=>{const Ve=ie.component=ee.component;if(vie(ee,ie,xe))if(Ve.asyncDep&&!Ve.asyncResolved){H(Ve,ie,xe);return}else Ve.next=ie,fie(Ve.update),Ve.update();else ie.el=ee.el,Ve.vnode=ie},B=(ee,ie,xe,Ve,Ge,Ze,ut)=>{const Qe=()=>{if(ee.isMounted){let{next:ne,bu:Z,u:fe,parent:Be,vnode:Xe}=ee,st=ne,mt;Gf(ee,!1),ne?(ne.el=Xe.el,H(ee,ne,ut)):ne=Xe,Z&&x1(Z),(mt=ne.props&&ne.props.onVnodeBeforeUpdate)&&_l(mt,Be,ne,Xe),Gf(ee,!0);const ye=NC(ee),$e=ee.subTree;ee.subTree=ye,m($e,ye,f($e.el),me($e),ee,Ge,Ze),ne.el=ye.el,st===null&&yie(ee,ye.el),fe&&qa(fe,Ge),(mt=ne.props&&ne.props.onVnodeUpdated)&&qa(()=>_l(mt,Be,ne,Xe),Ge)}else{let ne;const{el:Z,props:fe}=ie,{bm:Be,m:Xe,parent:st}=ee,mt=Iy(ie);if(Gf(ee,!1),Be&&x1(Be),!mt&&(ne=fe&&fe.onVnodeBeforeMount)&&_l(ne,st,ie),Gf(ee,!0),Z&&He){const ye=()=>{ee.subTree=NC(ee),He(Z,ee.subTree,ee,Ge,null)};mt?ie.type.__asyncLoader().then(()=>!ee.isUnmounted&&ye()):ye()}else{const ye=ee.subTree=NC(ee);m(null,ye,xe,Ve,ee,Ge,Ze),ie.el=ye.el}if(Xe&&qa(Xe,Ge),!mt&&(ne=fe&&fe.onVnodeMounted)){const ye=ie;qa(()=>_l(ne,st,ye),Ge)}(ie.shapeFlag&256||st&&Iy(st.vnode)&&st.vnode.shapeFlag&256)&&ee.a&&qa(ee.a,Ge),ee.isMounted=!0,ie=xe=Ve=null}},ve=ee.effect=new WR(Qe,()=>QR(Ke),ee.scope),Ke=ee.update=()=>ve.run();Ke.id=ee.uid,Gf(ee,!0),Ke()},H=(ee,ie,xe)=>{ie.component=ee;const Ve=ee.vnode.props;ee.vnode=ie,ee.next=null,Wie(ee,ie.props,Ve,xe),qie(ee,ie.children,xe),Ag(),m$(),Mg()},j=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve=!1)=>{const Ke=ee&&ee.children,ne=ee?ee.shapeFlag:0,Z=ie.children,{patchFlag:fe,shapeFlag:Be}=ie;if(fe>0){if(fe&128){J(Ke,Z,xe,Ve,Ge,Ze,ut,Qe,ve);return}else if(fe&256){K(Ke,Z,xe,Ve,Ge,Ze,ut,Qe,ve);return}}Be&8?(ne&16&&we(Ke,Ge,Ze),Z!==Ke&&c(xe,Z)):ne&16?Be&16?J(Ke,Z,xe,Ve,Ge,Ze,ut,Qe,ve):we(Ke,Ge,Ze,!0):(ne&8&&c(xe,""),Be&16&&C(Z,xe,Ve,Ge,Ze,ut,Qe,ve))},K=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve)=>{ee=ee||ym,ie=ie||ym;const Ke=ee.length,ne=ie.length,Z=Math.min(Ke,ne);let fe;for(fe=0;fe<Z;fe++){const Be=ie[fe]=ve?Fc(ie[fe]):Al(ie[fe]);m(ee[fe],Be,xe,null,Ge,Ze,ut,Qe,ve)}Ke>ne?we(ee,Ge,Ze,!0,!1,Z):C(ie,xe,Ve,Ge,Ze,ut,Qe,ve,Z)},J=(ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve)=>{let Ke=0;const ne=ie.length;let Z=ee.length-1,fe=ne-1;for(;Ke<=Z&&Ke<=fe;){const Be=ee[Ke],Xe=ie[Ke]=ve?Fc(ie[Ke]):Al(ie[Ke]);if(Rh(Be,Xe))m(Be,Xe,xe,null,Ge,Ze,ut,Qe,ve);else break;Ke++}for(;Ke<=Z&&Ke<=fe;){const Be=ee[Z],Xe=ie[fe]=ve?Fc(ie[fe]):Al(ie[fe]);if(Rh(Be,Xe))m(Be,Xe,xe,null,Ge,Ze,ut,Qe,ve);else break;Z--,fe--}if(Ke>Z){if(Ke<=fe){const Be=fe+1,Xe=Be<ne?ie[Be].el:Ve;for(;Ke<=fe;)m(null,ie[Ke]=ve?Fc(ie[Ke]):Al(ie[Ke]),xe,Xe,Ge,Ze,ut,Qe,ve),Ke++}}else if(Ke>fe)for(;Ke<=Z;)se(ee[Ke],Ge,Ze,!0),Ke++;else{const Be=Ke,Xe=Ke,st=new Map;for(Ke=Xe;Ke<=fe;Ke++){const Ct=ie[Ke]=ve?Fc(ie[Ke]):Al(ie[Ke]);Ct.key!=null&&st.set(Ct.key,Ke)}let mt,ye=0;const $e=fe-Xe+1;let vt=!1,bt=0;const dt=new Array($e);for(Ke=0;Ke<$e;Ke++)dt[Ke]=0;for(Ke=Be;Ke<=Z;Ke++){const Ct=ee[Ke];if(ye>=$e){se(Ct,Ge,Ze,!0);continue}let Kt;if(Ct.key!=null)Kt=st.get(Ct.key);else for(mt=Xe;mt<=fe;mt++)if(dt[mt-Xe]===0&&Rh(Ct,ie[mt])){Kt=mt;break}Kt===void 0?se(Ct,Ge,Ze,!0):(dt[Kt-Xe]=Ke+1,Kt>=bt?bt=Kt:vt=!0,m(Ct,ie[Kt],xe,null,Ge,Ze,ut,Qe,ve),ye++)}const $t=vt?Yie(dt):ym;for(mt=$t.length-1,Ke=$e-1;Ke>=0;Ke--){const Ct=Xe+Ke,Kt=ie[Ct],Vt=Ct+1<ne?ie[Ct+1].el:Ve;dt[Ke]===0?m(null,Kt,xe,Vt,Ge,Ze,ut,Qe,ve):vt&&(mt<0||Ke!==$t[mt]?re(Kt,xe,Vt,2):mt--)}}},re=(ee,ie,xe,Ve,Ge=null)=>{const{el:Ze,type:ut,transition:Qe,children:ve,shapeFlag:Ke}=ee;if(Ke&6){re(ee.component.subTree,ie,xe,Ve);return}if(Ke&128){ee.suspense.move(ie,xe,Ve);return}if(Ke&64){ut.move(ee,ie,xe,Me);return}if(ut===hr){r(Ze,ie,xe);for(let Z=0;Z<ve.length;Z++)re(ve[Z],ie,xe,Ve);r(ee.anchor,ie,xe);return}if(ut===b1){x(ee,ie,xe);return}if(Ve!==2&&Ke&1&&Qe)if(Ve===0)Qe.beforeEnter(Ze),r(Ze,ie,xe),qa(()=>Qe.enter(Ze),Ge);else{const{leave:Z,delayLeave:fe,afterLeave:Be}=Qe,Xe=()=>r(Ze,ie,xe),st=()=>{Z(Ze,()=>{Xe(),Be&&Be()})};fe?fe(Ze,Xe,st):st()}else r(Ze,ie,xe)},se=(ee,ie,xe,Ve=!1,Ge=!1)=>{const{type:Ze,props:ut,ref:Qe,children:ve,dynamicChildren:Ke,shapeFlag:ne,patchFlag:Z,dirs:fe}=ee;if(Qe!=null&&zA(Qe,null,xe,ee,!0),ne&256){ie.ctx.deactivate(ee);return}const Be=ne&1&&fe,Xe=!Iy(ee);let st;if(Xe&&(st=ut&&ut.onVnodeBeforeUnmount)&&_l(st,ie,ee),ne&6)Ne(ee.component,xe,Ve);else{if(ne&128){ee.suspense.unmount(xe,Ve);return}Be&&Wf(ee,null,ie,"beforeUnmount"),ne&64?ee.type.remove(ee,ie,xe,Ge,Me,Ve):Ke&&(Ze!==hr||Z>0&&Z&64)?we(Ke,ie,xe,!1,!0):(Ze===hr&&Z&384||!Ge&&ne&16)&&we(ve,ie,xe),Ve&&Ae(ee)}(Xe&&(st=ut&&ut.onVnodeUnmounted)||Be)&&qa(()=>{st&&_l(st,ie,ee),Be&&Wf(ee,null,ie,"unmounted")},xe)},Ae=ee=>{const{type:ie,el:xe,anchor:Ve,transition:Ge}=ee;if(ie===hr){Ee(xe,Ve);return}if(ie===b1){b(ee);return}const Ze=()=>{i(xe),Ge&&!Ge.persisted&&Ge.afterLeave&&Ge.afterLeave()};if(ee.shapeFlag&1&&Ge&&!Ge.persisted){const{leave:ut,delayLeave:Qe}=Ge,ve=()=>ut(xe,Ze);Qe?Qe(ee.el,Ze,ve):ve()}else Ze()},Ee=(ee,ie)=>{let xe;for(;ee!==ie;)xe=h(ee),i(ee),ee=xe;i(ie)},Ne=(ee,ie,xe)=>{const{bum:Ve,scope:Ge,update:Ze,subTree:ut,um:Qe}=ee;Ve&&x1(Ve),Ge.stop(),Ze&&(Ze.active=!1,se(ut,ee,ie,xe)),Qe&&qa(Qe,ie),qa(()=>{ee.isUnmounted=!0},ie),ie&&ie.pendingBranch&&!ie.isUnmounted&&ee.asyncDep&&!ee.asyncResolved&&ee.suspenseId===ie.pendingId&&(ie.deps--,ie.deps===0&&ie.resolve())},we=(ee,ie,xe,Ve=!1,Ge=!1,Ze=0)=>{for(let ut=Ze;ut<ee.length;ut++)se(ee[ut],ie,xe,Ve,Ge)},me=ee=>ee.shapeFlag&6?me(ee.component.subTree):ee.shapeFlag&128?ee.suspense.next():h(ee.anchor||ee.el),Se=(ee,ie,xe)=>{ee==null?ie._vnode&&se(ie._vnode,null,null,!0):m(ie._vnode||null,ee,ie,null,null,null,xe),m$(),lG(),ie._vnode=ee},Me={p:m,um:se,m:re,r:Ae,mt:F,mc:C,pc:j,pbc:R,n:me,o:n};let ke,He;return e&&([ke,He]=e(Me)),{render:Se,hydrate:ke,createApp:Vie(Se,ke)}}function Gf({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function sP(n,e,t=!1){const r=n.children,i=e.children;if(Ht(r)&&Ht(i))for(let a=0;a<r.length;a++){const s=r[a];let o=i[a];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=i[a]=Fc(i[a]),o.el=s.el),t||sP(s,o)),o.type===kg&&(o.el=s.el)}}function Yie(n){const e=n.slice(),t=[0];let r,i,a,s,o;const l=n.length;for(r=0;r<l;r++){const u=n[r];if(u!==0){if(i=t[t.length-1],n[i]<u){e[r]=i,t.push(r);continue}for(a=0,s=t.length-1;a<s;)o=a+s>>1,n[t[o]]<u?a=o+1:s=o;u<n[t[a]]&&(a>0&&(e[r]=t[a-1]),t[a]=r)}}for(a=t.length,s=t[a-1];a-- >0;)t[a]=s,s=e[s];return t}const Zie=n=>n.__isTeleport,Ly=n=>n&&(n.disabled||n.disabled===""),M$=n=>typeof SVGElement<"u"&&n instanceof SVGElement,VA=(n,e)=>{const t=n&&n.to;return _n(t)?e?e(t):null:t},Qie={__isTeleport:!0,process(n,e,t,r,i,a,s,o,l,u){const{mc:c,pc:f,pbc:h,o:{insert:d,querySelector:p,createText:m,createComment:g}}=u,v=Ly(e.props);let{shapeFlag:_,children:x,dynamicChildren:b}=e;if(n==null){const S=e.el=m(""),T=e.anchor=m("");d(S,t,r),d(T,t,r);const M=e.target=VA(e.props,p),C=e.targetAnchor=m("");M&&(d(C,M),s=s||M$(M));const k=(R,P)=>{_&16&&c(x,R,P,i,a,s,o,l)};v?k(t,T):M&&k(M,C)}else{e.el=n.el;const S=e.anchor=n.anchor,T=e.target=n.target,M=e.targetAnchor=n.targetAnchor,C=Ly(n.props),k=C?t:T,R=C?S:M;if(s=s||M$(T),b?(h(n.dynamicChildren,b,k,i,a,s,o),sP(n,e,!0)):l||f(n,e,k,R,i,a,s,o,!1),v)C||Tx(e,t,S,u,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const P=e.target=VA(e.props,p);P&&Tx(e,P,null,u,0)}else C&&Tx(e,T,M,u,1)}kG(e)},remove(n,e,t,r,{um:i,o:{remove:a}},s){const{shapeFlag:o,children:l,anchor:u,targetAnchor:c,target:f,props:h}=n;if(f&&a(c),(s||!Ly(h))&&(a(u),o&16))for(let d=0;d<l.length;d++){const p=l[d];i(p,e,t,!0,!!p.dynamicChildren)}},move:Tx,hydrate:Jie};function Tx(n,e,t,{o:{insert:r},m:i},a=2){a===0&&r(n.targetAnchor,e,t);const{el:s,anchor:o,shapeFlag:l,children:u,props:c}=n,f=a===2;if(f&&r(s,e,t),(!f||Ly(c))&&l&16)for(let h=0;h<u.length;h++)i(u[h],e,t,2);f&&r(o,e,t)}function Jie(n,e,t,r,i,a,{o:{nextSibling:s,parentNode:o,querySelector:l}},u){const c=e.target=VA(e.props,l);if(c){const f=c._lpa||c.firstChild;if(e.shapeFlag&16)if(Ly(e.props))e.anchor=u(s(n),e,o(n),t,r,i,a),e.targetAnchor=f;else{e.anchor=s(n);let h=f;for(;h;)if(h=s(h),h&&h.nodeType===8&&h.data==="teleport anchor"){e.targetAnchor=h,c._lpa=e.targetAnchor&&s(e.targetAnchor);break}u(f,e,c,t,r,i,a)}kG(e)}return e.anchor&&s(e.anchor)}const eae=Qie;function kG(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const hr=Symbol.for("v-fgt"),kg=Symbol.for("v-txt"),Ms=Symbol.for("v-cmt"),b1=Symbol.for("v-stc"),Ny=[];let jo=null;function at(n=!1){Ny.push(jo=n?null:[])}function tae(){Ny.pop(),jo=Ny[Ny.length-1]||null}let m0=1;function k$(n){m0+=n}function RG(n){return n.dynamicChildren=m0>0?jo||ym:null,tae(),m0>0&&jo&&jo.push(n),n}function kt(n,e,t,r,i,a){return RG(cn(n,e,t,r,i,a,!0))}function On(n,e,t,r,i){return RG(Pn(n,e,t,r,i,!0))}function lf(n){return n?n.__v_isVNode===!0:!1}function Rh(n,e){return n.type===e.type&&n.key===e.key}const VS="__vInternal",PG=({key:n})=>n??null,w1=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?_n(n)||mi(n)||rn(n)?{i:Gi,r:n,k:e,f:!!t}:n:null);function cn(n,e=null,t=null,r=0,i=null,a=n===hr?0:1,s=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&PG(e),ref:e&&w1(e),scopeId:BS,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Gi};return o?(oP(l,t),a&128&&n.normalize(l)):t&&(l.shapeFlag|=_n(t)?8:16),m0>0&&!s&&jo&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&jo.push(l),l}const Pn=nae;function nae(n,e=null,t=null,r=0,i=null,a=!1){if((!n||n===yG)&&(n=Ms),lf(n)){const o=Wu(n,e,!0);return t&&oP(o,t),m0>0&&!a&&jo&&(o.shapeFlag&6?jo[jo.indexOf(n)]=o:jo.push(o)),o.patchFlag|=-2,o}if(fae(n)&&(n=n.__vccOpts),e){e=rae(e);let{class:o,style:l}=e;o&&!_n(o)&&(e.class=Et(o)),Fn(l)&&(JW(l)&&!Ht(l)&&(l=fi({},l)),e.style=ui(l))}const s=_n(n)?1:_ie(n)?128:Zie(n)?64:Fn(n)?4:rn(n)?2:0;return cn(n,e,t,r,i,s,a,!0)}function rae(n){return n?JW(n)||VS in n?fi({},n):n:null}function Wu(n,e,t=!1){const{props:r,ref:i,patchFlag:a,children:s}=n,o=e?ji(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:o,key:o&&PG(o),ref:e&&e.ref?t&&i?Ht(i)?i.concat(w1(e)):[i,w1(e)]:w1(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:s,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==hr?a===-1?16:a|16:a,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Wu(n.ssContent),ssFallback:n.ssFallback&&Wu(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function ef(n=" ",e=0){return Pn(kg,null,n,e)}function crt(n,e){const t=Pn(b1,null,n);return t.staticCount=e,t}function Nn(n="",e=!1){return e?(at(),On(Ms,null,n)):Pn(Ms,null,n)}function Al(n){return n==null||typeof n=="boolean"?Pn(Ms):Ht(n)?Pn(hr,null,n.slice()):typeof n=="object"?Fc(n):Pn(kg,null,String(n))}function Fc(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Wu(n)}function oP(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(Ht(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),oP(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!(VS in e)?e._ctx=Gi:i===3&&Gi&&(Gi.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else rn(e)?(e={default:e,_ctx:Gi},t=32):(e=String(e),r&64?(t=16,e=[ef(e)]):t=8);n.children=e,n.shapeFlag|=t}function ji(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Et([e.class,r.class]));else if(i==="style")e.style=ui([e.style,r.style]);else if(RS(i)){const a=e[i],s=r[i];s&&a!==s&&!(Ht(a)&&a.includes(s))&&(e[i]=a?[].concat(a,s):s)}else i!==""&&(e[i]=r[i])}return e}function _l(n,e,t,r=null){co(n,e,7,[t,r])}const iae=SG();let aae=0;function sae(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||iae,a={uid:aae++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Ere(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:CG(r,i),emitsOptions:cG(r,i),emit:null,emitted:null,propsDefaults:Qr,inheritAttrs:r.inheritAttrs,ctx:Qr,data:Qr,props:Qr,attrs:Qr,slots:Qr,refs:Qr,setupState:Qr,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=pie.bind(null,a),n.ce&&n.ce(a),a}let Oi=null;const Is=()=>Oi||Gi;let lP,fp,R$="__VUE_INSTANCE_SETTERS__";(fp=IA()[R$])||(fp=IA()[R$]=[]),fp.push(n=>Oi=n),lP=n=>{fp.length>1?fp.forEach(e=>e(n)):fp[0](n)};const Vm=n=>{lP(n),n.scope.on()},Xh=()=>{Oi&&Oi.scope.off(),lP(null)};function IG(n){return n.vnode.shapeFlag&4}let g0=!1;function oae(n,e=!1){g0=e;const{props:t,children:r}=n.vnode,i=IG(n);Hie(n,t,i,e),jie(n,r);const a=i?lae(n,e):void 0;return g0=!1,a}function lae(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=eG(new Proxy(n.ctx,Lie));const{setup:r}=t;if(r){const i=n.setupContext=r.length>1?LG(n):null;Vm(n),Ag();const a=Jc(r,n,0,[n.props,i]);if(Mg(),Xh(),NW(a)){if(a.then(Xh,Xh),e)return a.then(s=>{P$(n,s,e)}).catch(s=>{$S(s,n,0)});n.asyncDep=a}else P$(n,a,e)}else DG(n,e)}function P$(n,e,t){rn(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Fn(e)&&(n.setupState=iG(e)),DG(n,t)}let I$;function DG(n,e,t){const r=n.type;if(!n.render){if(!e&&I$&&!r.render){const i=r.template||iP(n).template;if(i){const{isCustomElement:a,compilerOptions:s}=n.appContext.config,{delimiters:o,compilerOptions:l}=r,u=fi(fi({isCustomElement:a,delimiters:o},s),l);r.render=I$(i,u)}}n.render=r.render||va}Vm(n),Ag(),Oie(n),Mg(),Xh()}function uae(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(e,t){return os(n,"get","$attrs"),e[t]}}))}function LG(n){const e=t=>{n.exposed=t||{}};return{get attrs(){return uae(n)},slots:n.slots,emit:n.emit,expose:e}}function HS(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(iG(eG(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Dy)return Dy[t](n)},has(e,t){return t in e||t in Dy}}))}function cae(n,e=!0){return rn(n)?n.displayName||n.name:n.name||e&&n.__name}function fae(n){return rn(n)&&"__vccOpts"in n}const Le=(n,e)=>oie(n,e,g0);function Zr(n,e,t){const r=arguments.length;return r===2?Fn(e)&&!Ht(e)?lf(e)?Pn(n,null,[e]):Pn(n,e):Pn(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&lf(t)&&(t=[t]),Pn(n,e,t))}const hae=Symbol.for("v-scx"),dae=()=>$n(hae),pae="3.3.4",mae="http://www.w3.org/2000/svg",Ph=typeof document<"u"?document:null,D$=Ph&&Ph.createElement("template"),gae={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e?Ph.createElementNS(mae,n):Ph.createElement(n,t?{is:t}:void 0);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>Ph.createTextNode(n),createComment:n=>Ph.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Ph.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,a){const s=t?t.previousSibling:e.lastChild;if(i&&(i===a||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===a||!(i=i.nextSibling)););else{D$.innerHTML=r?`<svg>${n}</svg>`:n;const o=D$.content;if(r){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,t)}return[s?s.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function vae(n,e,t){const r=n._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}function yae(n,e,t){const r=n.style,i=_n(t);if(t&&!i){if(e&&!_n(e))for(const a in e)t[a]==null&&HA(r,a,"");for(const a in t)HA(r,a,t[a])}else{const a=r.display;i?e!==t&&(r.cssText=t):e&&n.removeAttribute("style"),"_vod"in n&&(r.display=a)}}const L$=/\s*!important$/;function HA(n,e,t){if(Ht(t))t.forEach(r=>HA(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=_ae(n,e);L$.test(t)?n.setProperty(Tf(r),t.replace(L$,""),"important"):n[r]=t}}const N$=["Webkit","Moz","ms"],FC={};function _ae(n,e){const t=FC[e];if(t)return t;let r=Qo(e);if(r!=="filter"&&r in n)return FC[e]=r;r=DS(r);for(let i=0;i<N$.length;i++){const a=N$[i]+r;if(a in n)return FC[e]=a}return e}const O$="http://www.w3.org/1999/xlink";function xae(n,e,t,r,i){if(r&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(O$,e.slice(6,e.length)):n.setAttributeNS(O$,e,t);else{const a=Sre(e);t==null||a&&!BW(t)?n.removeAttribute(e):n.setAttribute(e,a?"":t)}}function bae(n,e,t,r,i,a,s){if(e==="innerHTML"||e==="textContent"){r&&s(r,i,a),n[e]=t??"";return}const o=n.tagName;if(e==="value"&&o!=="PROGRESS"&&!o.includes("-")){n._value=t;const u=o==="OPTION"?n.getAttribute("value"):n.value,c=t??"";u!==c&&(n.value=c),t==null&&n.removeAttribute(e);return}let l=!1;if(t===""||t==null){const u=typeof n[e];u==="boolean"?t=BW(t):t==null&&u==="string"?(t="",l=!0):u==="number"&&(t=0,l=!0)}try{n[e]=t}catch{}l&&n.removeAttribute(e)}function NG(n,e,t,r){n.addEventListener(e,t,r)}function wae(n,e,t,r){n.removeEventListener(e,t,r)}function Sae(n,e,t,r,i=null){const a=n._vei||(n._vei={}),s=a[e];if(r&&s)s.value=r;else{const[o,l]=Tae(e);if(r){const u=a[e]=Aae(r,i);NG(n,o,u,l)}else s&&(wae(n,o,s,l),a[e]=void 0)}}const $$=/(?:Once|Passive|Capture)$/;function Tae(n){let e;if($$.test(n)){e={};let r;for(;r=n.match($$);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Tf(n.slice(2)),e]}let BC=0;const Cae=Promise.resolve(),Eae=()=>BC||(Cae.then(()=>BC=0),BC=Date.now());function Aae(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;co(Mae(r,t.value),e,5,[r])};return t.value=n,t.attached=Eae(),t}function Mae(n,e){if(Ht(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const F$=/^on[a-z]/,kae=(n,e,t,r,i=!1,a,s,o,l)=>{e==="class"?vae(n,r,i):e==="style"?yae(n,t,r):RS(e)?UR(e)||Sae(n,e,t,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Rae(n,e,r,i))?bae(n,e,r,a,s,o,l):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),xae(n,e,r,i))};function Rae(n,e,t,r){return r?!!(e==="innerHTML"||e==="textContent"||e in n&&F$.test(e)&&rn(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||F$.test(e)&&_n(t)?!1:e in n}const gc="transition",yv="animation",Ef=(n,{slots:e})=>Zr(Tie,$G(n),e);Ef.displayName="Transition";const OG={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Pae=Ef.props=fi({},dG,OG),jf=(n,e=[])=>{Ht(n)?n.forEach(t=>t(...e)):n&&n(...e)},B$=n=>n?Ht(n)?n.some(e=>e.length>1):n.length>1:!1;function $G(n){const e={};for(const N in n)N in OG||(e[N]=n[N]);if(n.css===!1)return e;const{name:t="v",type:r,duration:i,enterFromClass:a=`${t}-enter-from`,enterActiveClass:s=`${t}-enter-active`,enterToClass:o=`${t}-enter-to`,appearFromClass:l=a,appearActiveClass:u=s,appearToClass:c=o,leaveFromClass:f=`${t}-leave-from`,leaveActiveClass:h=`${t}-leave-active`,leaveToClass:d=`${t}-leave-to`}=n,p=Iae(i),m=p&&p[0],g=p&&p[1],{onBeforeEnter:v,onEnter:_,onEnterCancelled:x,onLeave:b,onLeaveCancelled:S,onBeforeAppear:T=v,onAppear:M=_,onAppearCancelled:C=x}=e,k=(N,L,F)=>{Dc(N,L?c:o),Dc(N,L?u:s),F&&F()},R=(N,L)=>{N._isLeaving=!1,Dc(N,f),Dc(N,d),Dc(N,h),L&&L()},P=N=>(L,F)=>{const O=N?M:_,B=()=>k(L,N,F);jf(O,[L,B]),U$(()=>{Dc(L,N?l:a),bu(L,N?c:o),B$(O)||z$(L,r,m,B)})};return fi(e,{onBeforeEnter(N){jf(v,[N]),bu(N,a),bu(N,s)},onBeforeAppear(N){jf(T,[N]),bu(N,l),bu(N,u)},onEnter:P(!1),onAppear:P(!0),onLeave(N,L){N._isLeaving=!0;const F=()=>R(N,L);bu(N,f),BG(),bu(N,h),U$(()=>{N._isLeaving&&(Dc(N,f),bu(N,d),B$(b)||z$(N,r,g,F))}),jf(b,[N,F])},onEnterCancelled(N){k(N,!1),jf(x,[N])},onAppearCancelled(N){k(N,!0),jf(C,[N])},onLeaveCancelled(N){R(N),jf(S,[N])}})}function Iae(n){if(n==null)return null;if(Fn(n))return[UC(n.enter),UC(n.leave)];{const e=UC(n);return[e,e]}}function UC(n){return vre(n)}function bu(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n._vtc||(n._vtc=new Set)).add(e)}function Dc(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const{_vtc:t}=n;t&&(t.delete(e),t.size||(n._vtc=void 0))}function U$(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let Dae=0;function z$(n,e,t,r){const i=n._endId=++Dae,a=()=>{i===n._endId&&r()};if(t)return setTimeout(a,t);const{type:s,timeout:o,propCount:l}=FG(n,e);if(!s)return r();const u=s+"end";let c=0;const f=()=>{n.removeEventListener(u,h),a()},h=d=>{d.target===n&&++c>=l&&f()};setTimeout(()=>{c<l&&f()},o+1),n.addEventListener(u,h)}function FG(n,e){const t=window.getComputedStyle(n),r=p=>(t[p]||"").split(", "),i=r(`${gc}Delay`),a=r(`${gc}Duration`),s=V$(i,a),o=r(`${yv}Delay`),l=r(`${yv}Duration`),u=V$(o,l);let c=null,f=0,h=0;e===gc?s>0&&(c=gc,f=s,h=a.length):e===yv?u>0&&(c=yv,f=u,h=l.length):(f=Math.max(s,u),c=f>0?s>u?gc:yv:null,h=c?c===gc?a.length:l.length:0);const d=c===gc&&/\b(transform|all)(,|$)/.test(r(`${gc}Property`).toString());return{type:c,timeout:f,propCount:h,hasTransform:d}}function V$(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>H$(t)+H$(n[r])))}function H$(n){return Number(n.slice(0,-1).replace(",","."))*1e3}function BG(){return document.body.offsetHeight}const UG=new WeakMap,zG=new WeakMap,VG={name:"TransitionGroup",props:fi({},Pae,{tag:String,moveClass:String}),setup(n,{slots:e}){const t=Is(),r=hG();let i,a;return tP(()=>{if(!i.length)return;const s=n.moveClass||`${n.name||"v"}-move`;if(!Bae(i[0].el,t.vnode.el,s))return;i.forEach(Oae),i.forEach($ae);const o=i.filter(Fae);BG(),o.forEach(l=>{const u=l.el,c=u.style;bu(u,s),c.transform=c.webkitTransform=c.transitionDuration="";const f=u._moveCb=h=>{h&&h.target!==u||(!h||/transform$/.test(h.propertyName))&&(u.removeEventListener("transitionend",f),u._moveCb=null,Dc(u,s))};u.addEventListener("transitionend",f)})}),()=>{const s=er(n),o=$G(s);let l=s.tag||hr;i=a,a=e.default?eP(e.default()):[];for(let u=0;u<a.length;u++){const c=a[u];c.key!=null&&p0(c,d0(c,o,r,t))}if(i)for(let u=0;u<i.length;u++){const c=i[u];p0(c,d0(c,o,r,t)),UG.set(c,c.el.getBoundingClientRect())}return Pn(l,null,a)}}},Lae=n=>delete n.mode;VG.props;const Nae=VG;function Oae(n){const e=n.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function $ae(n){zG.set(n,n.el.getBoundingClientRect())}function Fae(n){const e=UG.get(n),t=zG.get(n),r=e.left-t.left,i=e.top-t.top;if(r||i){const a=n.el.style;return a.transform=a.webkitTransform=`translate(${r}px,${i}px)`,a.transitionDuration="0s",n}}function Bae(n,e,t){const r=n.cloneNode();n._vtc&&n._vtc.forEach(s=>{s.split(/\s+/).forEach(o=>o&&r.classList.remove(o))}),t.split(/\s+/).forEach(s=>s&&r.classList.add(s)),r.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(r);const{hasTransform:a}=FG(r);return i.removeChild(r),a}const W$=n=>{const e=n.props["onUpdate:modelValue"]||!1;return Ht(e)?t=>x1(e,t):e},frt={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const i=PS(e);NG(n,"change",()=>{const a=Array.prototype.filter.call(n.options,s=>s.selected).map(s=>t?FW(pw(s)):pw(s));n._assign(n.multiple?i?new Set(a):a:a[0])}),n._assign=W$(r)},mounted(n,{value:e}){G$(n,e)},beforeUpdate(n,e,t){n._assign=W$(t)},updated(n,{value:e}){G$(n,e)}};function G$(n,e){const t=n.multiple;if(!(t&&!Ht(e)&&!PS(e))){for(let r=0,i=n.options.length;r<i;r++){const a=n.options[r],s=pw(a);if(t)Ht(e)?a.selected=Cre(e,s)>-1:a.selected=e.has(s);else if(LS(pw(a),e)){n.selectedIndex!==r&&(n.selectedIndex=r);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function pw(n){return"_value"in n?n._value:n.value}const Uae=["ctrl","shift","alt","meta"],zae={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>Uae.some(t=>n[`${t}Key`]&&!e.includes(t))},uP=(n,e)=>(t,...r)=>{for(let i=0;i<e.length;i++){const a=zae[e[i]];if(a&&a(t,e))return}return n(t,...r)},Vae={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Hae=(n,e)=>t=>{if(!("key"in t))return;const r=Tf(t.key);if(e.some(i=>i===r||Vae[i]===r))return n(t)},Dd={beforeMount(n,{value:e},{transition:t}){n._vod=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):_v(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),_v(n,!0),r.enter(n)):r.leave(n,()=>{_v(n,!1)}):_v(n,e))},beforeUnmount(n,{value:e}){_v(n,e)}};function _v(n,e){n.style.display=e?n._vod:"none"}const Wae=fi({patchProp:kae},gae);let j$;function HG(){return j$||(j$=Xie(Wae))}const q$=(...n)=>{HG().render(...n)},Gae=(...n)=>{const e=HG().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=jae(r);if(!i)return;const a=e._component;!rn(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const s=t(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},e};function jae(n){return _n(n)?document.querySelector(n):n}/*!
  * vue-router v4.2.2
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Yp=typeof window<"u";function qae(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const xr=Object.assign;function zC(n,e){const t={};for(const r in e){const i=e[r];t[r]=Jo(i)?i.map(n):n(i)}return t}const Oy=()=>{},Jo=Array.isArray,Xae=/\/$/,Kae=n=>n.replace(Xae,"");function VC(n,e,t="/"){let r,i={},a="",s="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(r=e.slice(0,l),a=e.slice(l+1,o>-1?o:e.length),i=n(a)),o>-1&&(r=r||e.slice(0,o),s=e.slice(o,e.length)),r=Jae(r??e,t),{fullPath:r+(a&&"?")+a+s,path:r,query:i,hash:s}}function Yae(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function X$(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function Zae(n,e,t){const r=e.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&Hm(e.matched[r],t.matched[i])&&WG(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Hm(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function WG(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!Qae(n[t],e[t]))return!1;return!0}function Qae(n,e){return Jo(n)?K$(n,e):Jo(e)?K$(e,n):n===e}function K$(n,e){return Jo(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function Jae(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let a=t.length-1,s,o;for(s=0;s<r.length;s++)if(o=r[s],o!==".")if(o==="..")a>1&&a--;else break;return t.slice(0,a).join("/")+"/"+r.slice(s-(s===r.length?1:0)).join("/")}var v0;(function(n){n.pop="pop",n.push="push"})(v0||(v0={}));var $y;(function(n){n.back="back",n.forward="forward",n.unknown=""})($y||($y={}));function ese(n){if(!n)if(Yp){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),Kae(n)}const tse=/^[^#]+#/;function nse(n,e){return n.replace(tse,"#")+e}function rse(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const WS=()=>({left:window.pageXOffset,top:window.pageYOffset});function ise(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=rse(i,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Y$(n,e){return(history.state?history.state.position-e:-1)+n}const WA=new Map;function ase(n,e){WA.set(n,e)}function sse(n){const e=WA.get(n);return WA.delete(n),e}let ose=()=>location.protocol+"//"+location.host;function GG(n,e){const{pathname:t,search:r,hash:i}=e,a=n.indexOf("#");if(a>-1){let o=i.includes(n.slice(a))?n.slice(a).length:1,l=i.slice(o);return l[0]!=="/"&&(l="/"+l),X$(l,"")}return X$(t,n)+r+i}function lse(n,e,t,r){let i=[],a=[],s=null;const o=({state:h})=>{const d=GG(n,location),p=t.value,m=e.value;let g=0;if(h){if(t.value=d,e.value=h,s&&s===p){s=null;return}g=m?h.position-m.position:0}else r(d);i.forEach(v=>{v(t.value,p,{delta:g,type:v0.pop,direction:g?g>0?$y.forward:$y.back:$y.unknown})})};function l(){s=t.value}function u(h){i.push(h);const d=()=>{const p=i.indexOf(h);p>-1&&i.splice(p,1)};return a.push(d),d}function c(){const{history:h}=window;h.state&&h.replaceState(xr({},h.state,{scroll:WS()}),"")}function f(){for(const h of a)h();a=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:u,destroy:f}}function Z$(n,e,t,r=!1,i=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:i?WS():null}}function use(n){const{history:e,location:t}=window,r={value:GG(n,t)},i={value:e.state};i.value||a(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function a(l,u,c){const f=n.indexOf("#"),h=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:ose()+n+l;try{e[c?"replaceState":"pushState"](u,"",h),i.value=u}catch(d){console.error(d),t[c?"replace":"assign"](h)}}function s(l,u){const c=xr({},e.state,Z$(i.value.back,l,i.value.forward,!0),u,{position:i.value.position});a(l,c,!0),r.value=l}function o(l,u){const c=xr({},i.value,e.state,{forward:l,scroll:WS()});a(c.current,c,!0);const f=xr({},Z$(r.value,l,null),{position:c.position+1},u);a(l,f,!1),r.value=l}return{location:r,state:i,push:o,replace:s}}function hrt(n){n=ese(n);const e=use(n),t=lse(n,e.state,e.location,e.replace);function r(a,s=!0){s||t.pauseListeners(),history.go(a)}const i=xr({location:"",base:n,go:r,createHref:nse.bind(null,n)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function cse(n){return typeof n=="string"||n&&typeof n=="object"}function jG(n){return typeof n=="string"||typeof n=="symbol"}const vc={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},qG=Symbol("");var Q$;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Q$||(Q$={}));function Wm(n,e){return xr(new Error,{type:n,[qG]:!0},e)}function cu(n,e){return n instanceof Error&&qG in n&&(e==null||!!(n.type&e))}const J$="[^/]+?",fse={sensitive:!1,strict:!1,start:!0,end:!0},hse=/[.+*?^${}()[\]/\\]/g;function dse(n,e){const t=xr({},fse,e),r=[];let i=t.start?"^":"";const a=[];for(const u of n){const c=u.length?[]:[90];t.strict&&!u.length&&(i+="/");for(let f=0;f<u.length;f++){const h=u[f];let d=40+(t.sensitive?.25:0);if(h.type===0)f||(i+="/"),i+=h.value.replace(hse,"\\$&"),d+=40;else if(h.type===1){const{value:p,repeatable:m,optional:g,regexp:v}=h;a.push({name:p,repeatable:m,optional:g});const _=v||J$;if(_!==J$){d+=10;try{new RegExp(`(${_})`)}catch(b){throw new Error(`Invalid custom RegExp for param "${p}" (${_}): `+b.message)}}let x=m?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;f||(x=g&&u.length<2?`(?:/${x})`:"/"+x),g&&(x+="?"),i+=x,d+=20,g&&(d+=-8),m&&(d+=-20),_===".*"&&(d+=-50)}c.push(d)}r.push(c)}if(t.strict&&t.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&(i+="(?:/|$)");const s=new RegExp(i,t.sensitive?"":"i");function o(u){const c=u.match(s),f={};if(!c)return null;for(let h=1;h<c.length;h++){const d=c[h]||"",p=a[h-1];f[p.name]=d&&p.repeatable?d.split("/"):d}return f}function l(u){let c="",f=!1;for(const h of n){(!f||!c.endsWith("/"))&&(c+="/"),f=!1;for(const d of h)if(d.type===0)c+=d.value;else if(d.type===1){const{value:p,repeatable:m,optional:g}=d,v=p in u?u[p]:"";if(Jo(v)&&!m)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const _=Jo(v)?v.join("/"):v;if(!_)if(g)h.length<2&&(c.endsWith("/")?c=c.slice(0,-1):f=!0);else throw new Error(`Missing required param "${p}"`);c+=_}}return c||"/"}return{re:s,score:r,keys:a,parse:o,stringify:l}}function pse(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function mse(n,e){let t=0;const r=n.score,i=e.score;for(;t<r.length&&t<i.length;){const a=pse(r[t],i[t]);if(a)return a;t++}if(Math.abs(i.length-r.length)===1){if(eF(r))return 1;if(eF(i))return-1}return i.length-r.length}function eF(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const gse={type:0,value:""},vse=/[a-zA-Z0-9_]/;function yse(n){if(!n)return[[]];if(n==="/")return[[gse]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(d){throw new Error(`ERR (${t})/"${u}": ${d}`)}let t=0,r=t;const i=[];let a;function s(){a&&i.push(a),a=[]}let o=0,l,u="",c="";function f(){u&&(t===0?a.push({type:0,value:u}):t===1||t===2||t===3?(a.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:u,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function h(){u+=l}for(;o<n.length;){if(l=n[o++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(u&&f(),s()):l===":"?(f(),t=1):h();break;case 4:h(),t=r;break;case 1:l==="("?t=2:vse.test(l)?h():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:t=3:c+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,c="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),s(),i}function _se(n,e,t){const r=dse(yse(n.path),t),i=xr(r,{record:n,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function xse(n,e){const t=[],r=new Map;e=rF({strict:!1,end:!0,sensitive:!1},e);function i(c){return r.get(c)}function a(c,f,h){const d=!h,p=bse(c);p.aliasOf=h&&h.record;const m=rF(e,c),g=[p];if("alias"in c){const x=typeof c.alias=="string"?[c.alias]:c.alias;for(const b of x)g.push(xr({},p,{components:h?h.record.components:p.components,path:b,aliasOf:h?h.record:p}))}let v,_;for(const x of g){const{path:b}=x;if(f&&b[0]!=="/"){const S=f.record.path,T=S[S.length-1]==="/"?"":"/";x.path=f.record.path+(b&&T+b)}if(v=_se(x,f,m),h?h.alias.push(v):(_=_||v,_!==v&&_.alias.push(v),d&&c.name&&!nF(v)&&s(c.name)),p.children){const S=p.children;for(let T=0;T<S.length;T++)a(S[T],v,h&&h.children[T])}h=h||v,(v.record.components&&Object.keys(v.record.components).length||v.record.name||v.record.redirect)&&l(v)}return _?()=>{s(_)}:Oy}function s(c){if(jG(c)){const f=r.get(c);f&&(r.delete(c),t.splice(t.indexOf(f),1),f.children.forEach(s),f.alias.forEach(s))}else{const f=t.indexOf(c);f>-1&&(t.splice(f,1),c.record.name&&r.delete(c.record.name),c.children.forEach(s),c.alias.forEach(s))}}function o(){return t}function l(c){let f=0;for(;f<t.length&&mse(c,t[f])>=0&&(c.record.path!==t[f].record.path||!XG(c,t[f]));)f++;t.splice(f,0,c),c.record.name&&!nF(c)&&r.set(c.record.name,c)}function u(c,f){let h,d={},p,m;if("name"in c&&c.name){if(h=r.get(c.name),!h)throw Wm(1,{location:c});m=h.record.name,d=xr(tF(f.params,h.keys.filter(_=>!_.optional).map(_=>_.name)),c.params&&tF(c.params,h.keys.map(_=>_.name))),p=h.stringify(d)}else if("path"in c)p=c.path,h=t.find(_=>_.re.test(p)),h&&(d=h.parse(p),m=h.record.name);else{if(h=f.name?r.get(f.name):t.find(_=>_.re.test(f.path)),!h)throw Wm(1,{location:c,currentLocation:f});m=h.record.name,d=xr({},f.params,c.params),p=h.stringify(d)}const g=[];let v=h;for(;v;)g.unshift(v.record),v=v.parent;return{name:m,path:p,params:d,matched:g,meta:Sse(g)}}return n.forEach(c=>a(c)),{addRoute:a,resolve:u,removeRoute:s,getRoutes:o,getRecordMatcher:i}}function tF(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function bse(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:wse(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function wse(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="boolean"?t:t[r];return e}function nF(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function Sse(n){return n.reduce((e,t)=>xr(e,t.meta),{})}function rF(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function XG(n,e){return e.children.some(t=>t===n||XG(n,t))}const KG=/#/g,Tse=/&/g,Cse=/\//g,Ese=/=/g,Ase=/\?/g,YG=/\+/g,Mse=/%5B/g,kse=/%5D/g,ZG=/%5E/g,Rse=/%60/g,QG=/%7B/g,Pse=/%7C/g,JG=/%7D/g,Ise=/%20/g;function cP(n){return encodeURI(""+n).replace(Pse,"|").replace(Mse,"[").replace(kse,"]")}function Dse(n){return cP(n).replace(QG,"{").replace(JG,"}").replace(ZG,"^")}function GA(n){return cP(n).replace(YG,"%2B").replace(Ise,"+").replace(KG,"%23").replace(Tse,"%26").replace(Rse,"`").replace(QG,"{").replace(JG,"}").replace(ZG,"^")}function Lse(n){return GA(n).replace(Ese,"%3D")}function Nse(n){return cP(n).replace(KG,"%23").replace(Ase,"%3F")}function Ose(n){return n==null?"":Nse(n).replace(Cse,"%2F")}function mw(n){try{return decodeURIComponent(""+n)}catch{}return""+n}function $se(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let i=0;i<r.length;++i){const a=r[i].replace(YG," "),s=a.indexOf("="),o=mw(s<0?a:a.slice(0,s)),l=s<0?null:mw(a.slice(s+1));if(o in e){let u=e[o];Jo(u)||(u=e[o]=[u]),u.push(l)}else e[o]=l}return e}function iF(n){let e="";for(let t in n){const r=n[t];if(t=Lse(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Jo(r)?r.map(a=>a&&GA(a)):[r&&GA(r)]).forEach(a=>{a!==void 0&&(e+=(e.length?"&":"")+t,a!=null&&(e+="="+a))})}return e}function Fse(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Jo(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const Bse=Symbol(""),aF=Symbol(""),fP=Symbol(""),e8=Symbol(""),jA=Symbol("");function xv(){let n=[];function e(r){return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}function t(){n=[]}return{add:e,list:()=>n,reset:t}}function Bc(n,e,t,r,i){const a=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((s,o)=>{const l=f=>{f===!1?o(Wm(4,{from:t,to:e})):f instanceof Error?o(f):cse(f)?o(Wm(2,{from:e,to:f})):(a&&r.enterCallbacks[i]===a&&typeof f=="function"&&a.push(f),s())},u=n.call(r&&r.instances[i],e,t,l);let c=Promise.resolve(u);n.length<3&&(c=c.then(l)),c.catch(f=>o(f))})}function HC(n,e,t,r){const i=[];for(const a of n)for(const s in a.components){let o=a.components[s];if(!(e!=="beforeRouteEnter"&&!a.instances[s]))if(Use(o)){const u=(o.__vccOpts||o)[e];u&&i.push(Bc(u,t,r,a,s))}else{let l=o();i.push(()=>l.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${a.path}"`));const c=qae(u)?u.default:u;a.components[s]=c;const h=(c.__vccOpts||c)[e];return h&&Bc(h,t,r,a,s)()}))}}return i}function Use(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function sF(n){const e=$n(fP),t=$n(e8),r=Le(()=>e.resolve(Q(n.to))),i=Le(()=>{const{matched:l}=r.value,{length:u}=l,c=l[u-1],f=t.matched;if(!c||!f.length)return-1;const h=f.findIndex(Hm.bind(null,c));if(h>-1)return h;const d=oF(l[u-2]);return u>1&&oF(c)===d&&f[f.length-1].path!==d?f.findIndex(Hm.bind(null,l[u-2])):h}),a=Le(()=>i.value>-1&&Wse(t.params,r.value.params)),s=Le(()=>i.value>-1&&i.value===t.matched.length-1&&WG(t.params,r.value.params));function o(l={}){return Hse(l)?e[Q(n.replace)?"replace":"push"](Q(n.to)).catch(Oy):Promise.resolve()}return{route:r,href:Le(()=>r.value.href),isActive:a,isExactActive:s,navigate:o}}const zse=Dt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:sF,setup(n,{slots:e}){const t=bo(sF(n)),{options:r}=$n(fP),i=Le(()=>({[lF(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[lF(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const a=e.default&&e.default(t);return n.custom?a:Zr("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},a)}}}),Vse=zse;function Hse(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function Wse(n,e){for(const t in e){const r=e[t],i=n[t];if(typeof r=="string"){if(r!==i)return!1}else if(!Jo(i)||i.length!==r.length||r.some((a,s)=>a!==i[s]))return!1}return!0}function oF(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const lF=(n,e,t)=>n??e??t,Gse=Dt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=$n(jA),i=Le(()=>n.route||r.value),a=$n(aF,0),s=Le(()=>{let u=Q(a);const{matched:c}=i.value;let f;for(;(f=c[u])&&!f.components;)u++;return u}),o=Le(()=>i.value.matched[s.value]);Ci(aF,Le(()=>s.value+1)),Ci(Bse,o),Ci(jA,i);const l=It();return Sn(()=>[l.value,o.value,n.name],([u,c,f],[h,d,p])=>{c&&(c.instances[f]=u,d&&d!==c&&u&&u===h&&(c.leaveGuards.size||(c.leaveGuards=d.leaveGuards),c.updateGuards.size||(c.updateGuards=d.updateGuards))),u&&c&&(!d||!Hm(c,d)||!h)&&(c.enterCallbacks[f]||[]).forEach(m=>m(u))},{flush:"post"}),()=>{const u=i.value,c=n.name,f=o.value,h=f&&f.components[c];if(!h)return uF(t.default,{Component:h,route:u});const d=f.props[c],p=d?d===!0?u.params:typeof d=="function"?d(u):d:null,g=Zr(h,xr({},p,e,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(f.instances[c]=null)},ref:l}));return uF(t.default,{Component:g,route:u})||g}}});function uF(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const jse=Gse;function drt(n){const e=xse(n.routes,n),t=n.parseQuery||$se,r=n.stringifyQuery||iF,i=n.history,a=xv(),s=xv(),o=xv(),l=Py(vc);let u=vc;Yp&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=zC.bind(null,me=>""+me),f=zC.bind(null,Ose),h=zC.bind(null,mw);function d(me,Se){let Me,ke;return jG(me)?(Me=e.getRecordMatcher(me),ke=Se):ke=me,e.addRoute(ke,Me)}function p(me){const Se=e.getRecordMatcher(me);Se&&e.removeRoute(Se)}function m(){return e.getRoutes().map(me=>me.record)}function g(me){return!!e.getRecordMatcher(me)}function v(me,Se){if(Se=xr({},Se||l.value),typeof me=="string"){const xe=VC(t,me,Se.path),Ve=e.resolve({path:xe.path},Se),Ge=i.createHref(xe.fullPath);return xr(xe,Ve,{params:h(Ve.params),hash:mw(xe.hash),redirectedFrom:void 0,href:Ge})}let Me;if("path"in me)Me=xr({},me,{path:VC(t,me.path,Se.path).path});else{const xe=xr({},me.params);for(const Ve in xe)xe[Ve]==null&&delete xe[Ve];Me=xr({},me,{params:f(xe)}),Se.params=f(Se.params)}const ke=e.resolve(Me,Se),He=me.hash||"";ke.params=c(h(ke.params));const ee=Yae(r,xr({},me,{hash:Dse(He),path:ke.path})),ie=i.createHref(ee);return xr({fullPath:ee,hash:He,query:r===iF?Fse(me.query):me.query||{}},ke,{redirectedFrom:void 0,href:ie})}function _(me){return typeof me=="string"?VC(t,me,l.value.path):xr({},me)}function x(me,Se){if(u!==me)return Wm(8,{from:Se,to:me})}function b(me){return M(me)}function S(me){return b(xr(_(me),{replace:!0}))}function T(me){const Se=me.matched[me.matched.length-1];if(Se&&Se.redirect){const{redirect:Me}=Se;let ke=typeof Me=="function"?Me(me):Me;return typeof ke=="string"&&(ke=ke.includes("?")||ke.includes("#")?ke=_(ke):{path:ke},ke.params={}),xr({query:me.query,hash:me.hash,params:"path"in ke?{}:me.params},ke)}}function M(me,Se){const Me=u=v(me),ke=l.value,He=me.state,ee=me.force,ie=me.replace===!0,xe=T(Me);if(xe)return M(xr(_(xe),{state:typeof xe=="object"?xr({},He,xe.state):He,force:ee,replace:ie}),Se||Me);const Ve=Me;Ve.redirectedFrom=Se;let Ge;return!ee&&Zae(r,ke,Me)&&(Ge=Wm(16,{to:Ve,from:ke}),re(ke,ke,!0,!1)),(Ge?Promise.resolve(Ge):R(Ve,ke)).catch(Ze=>cu(Ze)?cu(Ze,2)?Ze:J(Ze):j(Ze,Ve,ke)).then(Ze=>{if(Ze){if(cu(Ze,2))return M(xr({replace:ie},_(Ze.to),{state:typeof Ze.to=="object"?xr({},He,Ze.to.state):He,force:ee}),Se||Ve)}else Ze=N(Ve,ke,!0,ie,He);return P(Ve,ke,Ze),Ze})}function C(me,Se){const Me=x(me,Se);return Me?Promise.reject(Me):Promise.resolve()}function k(me){const Se=Ee.values().next().value;return Se&&typeof Se.runWithContext=="function"?Se.runWithContext(me):me()}function R(me,Se){let Me;const[ke,He,ee]=qse(me,Se);Me=HC(ke.reverse(),"beforeRouteLeave",me,Se);for(const xe of ke)xe.leaveGuards.forEach(Ve=>{Me.push(Bc(Ve,me,Se))});const ie=C.bind(null,me,Se);return Me.push(ie),we(Me).then(()=>{Me=[];for(const xe of a.list())Me.push(Bc(xe,me,Se));return Me.push(ie),we(Me)}).then(()=>{Me=HC(He,"beforeRouteUpdate",me,Se);for(const xe of He)xe.updateGuards.forEach(Ve=>{Me.push(Bc(Ve,me,Se))});return Me.push(ie),we(Me)}).then(()=>{Me=[];for(const xe of me.matched)if(xe.beforeEnter&&!Se.matched.includes(xe))if(Jo(xe.beforeEnter))for(const Ve of xe.beforeEnter)Me.push(Bc(Ve,me,Se));else Me.push(Bc(xe.beforeEnter,me,Se));return Me.push(ie),we(Me)}).then(()=>(me.matched.forEach(xe=>xe.enterCallbacks={}),Me=HC(ee,"beforeRouteEnter",me,Se),Me.push(ie),we(Me))).then(()=>{Me=[];for(const xe of s.list())Me.push(Bc(xe,me,Se));return Me.push(ie),we(Me)}).catch(xe=>cu(xe,8)?xe:Promise.reject(xe))}function P(me,Se,Me){for(const ke of o.list())k(()=>ke(me,Se,Me))}function N(me,Se,Me,ke,He){const ee=x(me,Se);if(ee)return ee;const ie=Se===vc,xe=Yp?history.state:{};Me&&(ke||ie?i.replace(me.fullPath,xr({scroll:ie&&xe&&xe.scroll},He)):i.push(me.fullPath,He)),l.value=me,re(me,Se,Me,ie),J()}let L;function F(){L||(L=i.listen((me,Se,Me)=>{if(!Ne.listening)return;const ke=v(me),He=T(ke);if(He){M(xr(He,{replace:!0}),ke).catch(Oy);return}u=ke;const ee=l.value;Yp&&ase(Y$(ee.fullPath,Me.delta),WS()),R(ke,ee).catch(ie=>cu(ie,12)?ie:cu(ie,2)?(M(ie.to,ke).then(xe=>{cu(xe,20)&&!Me.delta&&Me.type===v0.pop&&i.go(-1,!1)}).catch(Oy),Promise.reject()):(Me.delta&&i.go(-Me.delta,!1),j(ie,ke,ee))).then(ie=>{ie=ie||N(ke,ee,!1),ie&&(Me.delta&&!cu(ie,8)?i.go(-Me.delta,!1):Me.type===v0.pop&&cu(ie,20)&&i.go(-1,!1)),P(ke,ee,ie)}).catch(Oy)}))}let O=xv(),B=xv(),H;function j(me,Se,Me){J(me);const ke=B.list();return ke.length?ke.forEach(He=>He(me,Se,Me)):console.error(me),Promise.reject(me)}function K(){return H&&l.value!==vc?Promise.resolve():new Promise((me,Se)=>{O.add([me,Se])})}function J(me){return H||(H=!me,F(),O.list().forEach(([Se,Me])=>me?Me(me):Se()),O.reset()),me}function re(me,Se,Me,ke){const{scrollBehavior:He}=n;if(!Yp||!He)return Promise.resolve();const ee=!Me&&sse(Y$(me.fullPath,0))||(ke||!Me)&&history.state&&history.state.scroll||null;return ua().then(()=>He(me,Se,ee)).then(ie=>ie&&ise(ie)).catch(ie=>j(ie,me,Se))}const se=me=>i.go(me);let Ae;const Ee=new Set,Ne={currentRoute:l,listening:!0,addRoute:d,removeRoute:p,hasRoute:g,getRoutes:m,resolve:v,options:n,push:b,replace:S,go:se,back:()=>se(-1),forward:()=>se(1),beforeEach:a.add,beforeResolve:s.add,afterEach:o.add,onError:B.add,isReady:K,install(me){const Se=this;me.component("RouterLink",Vse),me.component("RouterView",jse),me.config.globalProperties.$router=Se,Object.defineProperty(me.config.globalProperties,"$route",{enumerable:!0,get:()=>Q(l)}),Yp&&!Ae&&l.value===vc&&(Ae=!0,b(i.location).catch(He=>{}));const Me={};for(const He in vc)Me[He]=Le(()=>l.value[He]);me.provide(fP,Se),me.provide(e8,bo(Me)),me.provide(jA,l);const ke=me.unmount;Ee.add(me),me.unmount=function(){Ee.delete(me),Ee.size<1&&(u=vc,L&&L(),L=null,l.value=vc,Ae=!1,H=!1),ke()}}};function we(me){return me.reduce((Se,Me)=>Se.then(()=>k(Me)),Promise.resolve())}return Ne}function qse(n,e){const t=[],r=[],i=[],a=Math.max(e.matched.length,n.matched.length);for(let s=0;s<a;s++){const o=e.matched[s];o&&(n.matched.find(u=>Hm(u,o))?r.push(o):t.push(o));const l=n.matched[s];l&&(e.matched.find(u=>Hm(u,l))||i.push(l))}return[t,r,i]}const S1=function(n,e,...t){let r;e.includes("mouse")||e.includes("click")?r="MouseEvents":e.includes("key")?r="KeyboardEvent":r="HTMLEvents";const i=document.createEvent(r);return i.initEvent(e,...t),n.dispatchEvent(i),n},Su=(n,e,{checkForDefaultPrevented:t=!0}={})=>i=>{const a=n==null?void 0:n(i);if(t===!1||!a)return e==null?void 0:e(i)};var cF;const ya=typeof window<"u",Xse=n=>typeof n=="string",gw=()=>{},Kse=ya&&((cF=window==null?void 0:window.navigator)==null?void 0:cF.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function y0(n){return typeof n=="function"?n():Q(n)}function Yse(n,e){function t(...r){return new Promise((i,a)=>{Promise.resolve(n(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})).then(i).catch(a)})}return t}function Zse(n,e={}){let t,r,i=gw;const a=o=>{clearTimeout(o),i(),i=gw};return o=>{const l=y0(n),u=y0(e.maxWait);return t&&a(t),l<=0||u!==void 0&&u<=0?(r&&(a(r),r=null),Promise.resolve(o())):new Promise((c,f)=>{i=e.rejectOnCancel?f:c,u&&!r&&(r=setTimeout(()=>{t&&a(t),r=null,c(o())},u)),t=setTimeout(()=>{r&&a(r),r=null,c(o())},l)})}}function Qse(n){return n}function GS(n){return zW()?(Mre(n),!0):!1}function Jse(n,e=200,t={}){return Yse(Zse(e,t),n)}function eoe(n,e=200,t={}){const r=It(n.value),i=Jse(()=>{r.value=n.value},e,t);return Sn(n,()=>i()),r}function toe(n,e=!0){Is()?Ii(n):e?n():ua(n)}function qA(n,e,t={}){const{immediate:r=!0}=t,i=It(!1);let a=null;function s(){a&&(clearTimeout(a),a=null)}function o(){i.value=!1,s()}function l(...u){s(),i.value=!0,a=setTimeout(()=>{i.value=!1,a=null,n(...u)},y0(e))}return r&&(i.value=!0,ya&&l()),GS(o),{isPending:OS(i),start:l,stop:o}}function Wc(n){var e;const t=y0(n);return(e=t==null?void 0:t.$el)!=null?e:t}const hP=ya?window:void 0;function T1(...n){let e,t,r,i;if(Xse(n[0])||Array.isArray(n[0])?([t,r,i]=n,e=hP):[e,t,r,i]=n,!e)return gw;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const a=[],s=()=>{a.forEach(c=>c()),a.length=0},o=(c,f,h,d)=>(c.addEventListener(f,h,d),()=>c.removeEventListener(f,h,d)),l=Sn(()=>[Wc(e),y0(i)],([c,f])=>{s(),c&&a.push(...t.flatMap(h=>r.map(d=>o(c,h,d,f))))},{immediate:!0,flush:"post"}),u=()=>{l(),s()};return GS(u),u}let fF=!1;function noe(n,e,t={}){const{window:r=hP,ignore:i=[],capture:a=!0,detectIframe:s=!1}=t;if(!r)return;Kse&&!fF&&(fF=!0,Array.from(r.document.body.children).forEach(h=>h.addEventListener("click",gw)));let o=!0;const l=h=>i.some(d=>{if(typeof d=="string")return Array.from(r.document.querySelectorAll(d)).some(p=>p===h.target||h.composedPath().includes(p));{const p=Wc(d);return p&&(h.target===p||h.composedPath().includes(p))}}),c=[T1(r,"click",h=>{const d=Wc(n);if(!(!d||d===h.target||h.composedPath().includes(d))){if(h.detail===0&&(o=!l(h)),!o){o=!0;return}e(h)}},{passive:!0,capture:a}),T1(r,"pointerdown",h=>{const d=Wc(n);d&&(o=!h.composedPath().includes(d)&&!l(h))},{passive:!0}),s&&T1(r,"blur",h=>{var d;const p=Wc(n);((d=r.document.activeElement)==null?void 0:d.tagName)==="IFRAME"&&!(p!=null&&p.contains(r.document.activeElement))&&e(h)})].filter(Boolean);return()=>c.forEach(h=>h())}function roe(n,e=!1){const t=It(),r=()=>t.value=!!n();return r(),toe(r,e),t}const hF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dF="__vueuse_ssr_handlers__";hF[dF]=hF[dF]||{};var pF=Object.getOwnPropertySymbols,ioe=Object.prototype.hasOwnProperty,aoe=Object.prototype.propertyIsEnumerable,soe=(n,e)=>{var t={};for(var r in n)ioe.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&pF)for(var r of pF(n))e.indexOf(r)<0&&aoe.call(n,r)&&(t[r]=n[r]);return t};function jS(n,e,t={}){const r=t,{window:i=hP}=r,a=soe(r,["window"]);let s;const o=roe(()=>i&&"ResizeObserver"in i),l=()=>{s&&(s.disconnect(),s=void 0)},u=Sn(()=>Wc(n),f=>{l(),o.value&&i&&f&&(s=new ResizeObserver(e),s.observe(f,a))},{immediate:!0,flush:"post"}),c=()=>{l(),u()};return GS(c),{isSupported:o,stop:c}}var mF;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(mF||(mF={}));var ooe=Object.defineProperty,gF=Object.getOwnPropertySymbols,loe=Object.prototype.hasOwnProperty,uoe=Object.prototype.propertyIsEnumerable,vF=(n,e,t)=>e in n?ooe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,coe=(n,e)=>{for(var t in e||(e={}))loe.call(e,t)&&vF(n,t,e[t]);if(gF)for(var t of gF(e))uoe.call(e,t)&&vF(n,t,e[t]);return n};const foe={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};coe({linear:Qse},foe);const hoe=()=>ya&&/firefox/i.test(window.navigator.userAgent);var doe=typeof global=="object"&&global&&global.Object===Object&&global;const t8=doe;var poe=typeof self=="object"&&self&&self.Object===Object&&self,moe=t8||poe||Function("return this")();const Jl=moe;var goe=Jl.Symbol;const uf=goe;var n8=Object.prototype,voe=n8.hasOwnProperty,yoe=n8.toString,bv=uf?uf.toStringTag:void 0;function _oe(n){var e=voe.call(n,bv),t=n[bv];try{n[bv]=void 0;var r=!0}catch{}var i=yoe.call(n);return r&&(e?n[bv]=t:delete n[bv]),i}var xoe=Object.prototype,boe=xoe.toString;function woe(n){return boe.call(n)}var Soe="[object Null]",Toe="[object Undefined]",yF=uf?uf.toStringTag:void 0;function Rg(n){return n==null?n===void 0?Toe:Soe:yF&&yF in Object(n)?_oe(n):woe(n)}function Pg(n){return n!=null&&typeof n=="object"}var Coe="[object Symbol]";function dP(n){return typeof n=="symbol"||Pg(n)&&Rg(n)==Coe}function Eoe(n,e){for(var t=-1,r=n==null?0:n.length,i=Array(r);++t<r;)i[t]=e(n[t],t,n);return i}var Aoe=Array.isArray;const Ld=Aoe;var Moe=1/0,_F=uf?uf.prototype:void 0,xF=_F?_F.toString:void 0;function r8(n){if(typeof n=="string")return n;if(Ld(n))return Eoe(n,r8)+"";if(dP(n))return xF?xF.call(n):"";var e=n+"";return e=="0"&&1/n==-Moe?"-0":e}function ud(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var koe="[object AsyncFunction]",Roe="[object Function]",Poe="[object GeneratorFunction]",Ioe="[object Proxy]";function i8(n){if(!ud(n))return!1;var e=Rg(n);return e==Roe||e==Poe||e==koe||e==Ioe}var Doe=Jl["__core-js_shared__"];const WC=Doe;var bF=function(){var n=/[^.]+$/.exec(WC&&WC.keys&&WC.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function Loe(n){return!!bF&&bF in n}var Noe=Function.prototype,Ooe=Noe.toString;function Nd(n){if(n!=null){try{return Ooe.call(n)}catch{}try{return n+""}catch{}}return""}var $oe=/[\\^$.*+?()[\]{}|]/g,Foe=/^\[object .+?Constructor\]$/,Boe=Function.prototype,Uoe=Object.prototype,zoe=Boe.toString,Voe=Uoe.hasOwnProperty,Hoe=RegExp("^"+zoe.call(Voe).replace($oe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Woe(n){if(!ud(n)||Loe(n))return!1;var e=i8(n)?Hoe:Foe;return e.test(Nd(n))}function Goe(n,e){return n==null?void 0:n[e]}function Od(n,e){var t=Goe(n,e);return Woe(t)?t:void 0}var joe=Od(Jl,"WeakMap");const XA=joe;var wF=Object.create,qoe=function(){function n(){}return function(e){if(!ud(e))return{};if(wF)return wF(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}();const Xoe=qoe;function Koe(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var Yoe=function(){try{var n=Od(Object,"defineProperty");return n({},"",{}),n}catch{}}();const SF=Yoe;function Zoe(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}var Qoe=9007199254740991,Joe=/^(?:0|[1-9]\d*)$/;function a8(n,e){var t=typeof n;return e=e??Qoe,!!e&&(t=="number"||t!="symbol"&&Joe.test(n))&&n>-1&&n%1==0&&n<e}function s8(n,e,t){e=="__proto__"&&SF?SF(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function o8(n,e){return n===e||n!==n&&e!==e}var ele=Object.prototype,tle=ele.hasOwnProperty;function pP(n,e,t){var r=n[e];(!(tle.call(n,e)&&o8(r,t))||t===void 0&&!(e in n))&&s8(n,e,t)}function qS(n,e,t,r){var i=!t;t||(t={});for(var a=-1,s=e.length;++a<s;){var o=e[a],l=r?r(t[o],n[o],o,t,n):void 0;l===void 0&&(l=n[o]),i?s8(t,o,l):pP(t,o,l)}return t}var nle=9007199254740991;function l8(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=nle}function u8(n){return n!=null&&l8(n.length)&&!i8(n)}var rle=Object.prototype;function mP(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||rle;return n===t}function ile(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var ale="[object Arguments]";function TF(n){return Pg(n)&&Rg(n)==ale}var c8=Object.prototype,sle=c8.hasOwnProperty,ole=c8.propertyIsEnumerable,lle=TF(function(){return arguments}())?TF:function(n){return Pg(n)&&sle.call(n,"callee")&&!ole.call(n,"callee")};const ule=lle;function cle(){return!1}var f8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,CF=f8&&typeof module=="object"&&module&&!module.nodeType&&module,fle=CF&&CF.exports===f8,EF=fle?Jl.Buffer:void 0,hle=EF?EF.isBuffer:void 0,dle=hle||cle;const h8=dle;var ple="[object Arguments]",mle="[object Array]",gle="[object Boolean]",vle="[object Date]",yle="[object Error]",_le="[object Function]",xle="[object Map]",ble="[object Number]",wle="[object Object]",Sle="[object RegExp]",Tle="[object Set]",Cle="[object String]",Ele="[object WeakMap]",Ale="[object ArrayBuffer]",Mle="[object DataView]",kle="[object Float32Array]",Rle="[object Float64Array]",Ple="[object Int8Array]",Ile="[object Int16Array]",Dle="[object Int32Array]",Lle="[object Uint8Array]",Nle="[object Uint8ClampedArray]",Ole="[object Uint16Array]",$le="[object Uint32Array]",Yr={};Yr[kle]=Yr[Rle]=Yr[Ple]=Yr[Ile]=Yr[Dle]=Yr[Lle]=Yr[Nle]=Yr[Ole]=Yr[$le]=!0;Yr[ple]=Yr[mle]=Yr[Ale]=Yr[gle]=Yr[Mle]=Yr[vle]=Yr[yle]=Yr[_le]=Yr[xle]=Yr[ble]=Yr[wle]=Yr[Sle]=Yr[Tle]=Yr[Cle]=Yr[Ele]=!1;function Fle(n){return Pg(n)&&l8(n.length)&&!!Yr[Rg(n)]}function gP(n){return function(e){return n(e)}}var d8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Fy=d8&&typeof module=="object"&&module&&!module.nodeType&&module,Ble=Fy&&Fy.exports===d8,GC=Ble&&t8.process,Ule=function(){try{var n=Fy&&Fy.require&&Fy.require("util").types;return n||GC&&GC.binding&&GC.binding("util")}catch{}}();const Gm=Ule;var AF=Gm&&Gm.isTypedArray,zle=AF?gP(AF):Fle;const Vle=zle;var Hle=Object.prototype,Wle=Hle.hasOwnProperty;function p8(n,e){var t=Ld(n),r=!t&&ule(n),i=!t&&!r&&h8(n),a=!t&&!r&&!i&&Vle(n),s=t||r||i||a,o=s?ile(n.length,String):[],l=o.length;for(var u in n)(e||Wle.call(n,u))&&!(s&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||a8(u,l)))&&o.push(u);return o}function m8(n,e){return function(t){return n(e(t))}}var Gle=m8(Object.keys,Object);const jle=Gle;var qle=Object.prototype,Xle=qle.hasOwnProperty;function Kle(n){if(!mP(n))return jle(n);var e=[];for(var t in Object(n))Xle.call(n,t)&&t!="constructor"&&e.push(t);return e}function vP(n){return u8(n)?p8(n):Kle(n)}function Yle(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var Zle=Object.prototype,Qle=Zle.hasOwnProperty;function Jle(n){if(!ud(n))return Yle(n);var e=mP(n),t=[];for(var r in n)r=="constructor"&&(e||!Qle.call(n,r))||t.push(r);return t}function yP(n){return u8(n)?p8(n,!0):Jle(n)}var eue=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tue=/^\w*$/;function nue(n,e){if(Ld(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||dP(n)?!0:tue.test(n)||!eue.test(n)||e!=null&&n in Object(e)}var rue=Od(Object,"create");const _0=rue;function iue(){this.__data__=_0?_0(null):{},this.size=0}function aue(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var sue="__lodash_hash_undefined__",oue=Object.prototype,lue=oue.hasOwnProperty;function uue(n){var e=this.__data__;if(_0){var t=e[n];return t===sue?void 0:t}return lue.call(e,n)?e[n]:void 0}var cue=Object.prototype,fue=cue.hasOwnProperty;function hue(n){var e=this.__data__;return _0?e[n]!==void 0:fue.call(e,n)}var due="__lodash_hash_undefined__";function pue(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=_0&&e===void 0?due:e,this}function cd(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}cd.prototype.clear=iue;cd.prototype.delete=aue;cd.prototype.get=uue;cd.prototype.has=hue;cd.prototype.set=pue;function mue(){this.__data__=[],this.size=0}function XS(n,e){for(var t=n.length;t--;)if(o8(n[t][0],e))return t;return-1}var gue=Array.prototype,vue=gue.splice;function yue(n){var e=this.__data__,t=XS(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():vue.call(e,t,1),--this.size,!0}function _ue(n){var e=this.__data__,t=XS(e,n);return t<0?void 0:e[t][1]}function xue(n){return XS(this.__data__,n)>-1}function bue(n,e){var t=this.__data__,r=XS(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function tc(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}tc.prototype.clear=mue;tc.prototype.delete=yue;tc.prototype.get=_ue;tc.prototype.has=xue;tc.prototype.set=bue;var wue=Od(Jl,"Map");const x0=wue;function Sue(){this.size=0,this.__data__={hash:new cd,map:new(x0||tc),string:new cd}}function Tue(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function KS(n,e){var t=n.__data__;return Tue(e)?t[typeof e=="string"?"string":"hash"]:t.map}function Cue(n){var e=KS(this,n).delete(n);return this.size-=e?1:0,e}function Eue(n){return KS(this,n).get(n)}function Aue(n){return KS(this,n).has(n)}function Mue(n,e){var t=KS(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function Af(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Af.prototype.clear=Sue;Af.prototype.delete=Cue;Af.prototype.get=Eue;Af.prototype.has=Aue;Af.prototype.set=Mue;var kue="Expected a function";function _P(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(kue);var t=function(){var r=arguments,i=e?e.apply(this,r):r[0],a=t.cache;if(a.has(i))return a.get(i);var s=n.apply(this,r);return t.cache=a.set(i,s)||a,s};return t.cache=new(_P.Cache||Af),t}_P.Cache=Af;var Rue=500;function Pue(n){var e=_P(n,function(r){return t.size===Rue&&t.clear(),r}),t=e.cache;return e}var Iue=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Due=/\\(\\)?/g,Lue=Pue(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(Iue,function(t,r,i,a){e.push(i?a.replace(Due,"$1"):r||t)}),e});const Nue=Lue;function Oue(n){return n==null?"":r8(n)}function g8(n,e){return Ld(n)?n:nue(n,e)?[n]:Nue(Oue(n))}var $ue=1/0;function v8(n){if(typeof n=="string"||dP(n))return n;var e=n+"";return e=="0"&&1/n==-$ue?"-0":e}function Fue(n,e){e=g8(e,n);for(var t=0,r=e.length;n!=null&&t<r;)n=n[v8(e[t++])];return t&&t==r?n:void 0}function y8(n,e,t){var r=n==null?void 0:Fue(n,e);return r===void 0?t:r}function _8(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}var Bue=m8(Object.getPrototypeOf,Object);const x8=Bue;function b0(){if(!arguments.length)return[];var n=arguments[0];return Ld(n)?n:[n]}function Uue(){this.__data__=new tc,this.size=0}function zue(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function Vue(n){return this.__data__.get(n)}function Hue(n){return this.__data__.has(n)}var Wue=200;function Gue(n,e){var t=this.__data__;if(t instanceof tc){var r=t.__data__;if(!x0||r.length<Wue-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Af(r)}return t.set(n,e),this.size=t.size,this}function Ig(n){var e=this.__data__=new tc(n);this.size=e.size}Ig.prototype.clear=Uue;Ig.prototype.delete=zue;Ig.prototype.get=Vue;Ig.prototype.has=Hue;Ig.prototype.set=Gue;function jue(n,e){return n&&qS(e,vP(e),n)}function que(n,e){return n&&qS(e,yP(e),n)}var b8=typeof exports=="object"&&exports&&!exports.nodeType&&exports,MF=b8&&typeof module=="object"&&module&&!module.nodeType&&module,Xue=MF&&MF.exports===b8,kF=Xue?Jl.Buffer:void 0,RF=kF?kF.allocUnsafe:void 0;function Kue(n,e){if(e)return n.slice();var t=n.length,r=RF?RF(t):new n.constructor(t);return n.copy(r),r}function Yue(n,e){for(var t=-1,r=n==null?0:n.length,i=0,a=[];++t<r;){var s=n[t];e(s,t,n)&&(a[i++]=s)}return a}function w8(){return[]}var Zue=Object.prototype,Que=Zue.propertyIsEnumerable,PF=Object.getOwnPropertySymbols,Jue=PF?function(n){return n==null?[]:(n=Object(n),Yue(PF(n),function(e){return Que.call(n,e)}))}:w8;const xP=Jue;function ece(n,e){return qS(n,xP(n),e)}var tce=Object.getOwnPropertySymbols,nce=tce?function(n){for(var e=[];n;)_8(e,xP(n)),n=x8(n);return e}:w8;const S8=nce;function rce(n,e){return qS(n,S8(n),e)}function T8(n,e,t){var r=e(n);return Ld(n)?r:_8(r,t(n))}function ice(n){return T8(n,vP,xP)}function ace(n){return T8(n,yP,S8)}var sce=Od(Jl,"DataView");const KA=sce;var oce=Od(Jl,"Promise");const YA=oce;var lce=Od(Jl,"Set");const ZA=lce;var IF="[object Map]",uce="[object Object]",DF="[object Promise]",LF="[object Set]",NF="[object WeakMap]",OF="[object DataView]",cce=Nd(KA),fce=Nd(x0),hce=Nd(YA),dce=Nd(ZA),pce=Nd(XA),Sh=Rg;(KA&&Sh(new KA(new ArrayBuffer(1)))!=OF||x0&&Sh(new x0)!=IF||YA&&Sh(YA.resolve())!=DF||ZA&&Sh(new ZA)!=LF||XA&&Sh(new XA)!=NF)&&(Sh=function(n){var e=Rg(n),t=e==uce?n.constructor:void 0,r=t?Nd(t):"";if(r)switch(r){case cce:return OF;case fce:return IF;case hce:return DF;case dce:return LF;case pce:return NF}return e});const bP=Sh;var mce=Object.prototype,gce=mce.hasOwnProperty;function vce(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&gce.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var yce=Jl.Uint8Array;const $F=yce;function wP(n){var e=new n.constructor(n.byteLength);return new $F(e).set(new $F(n)),e}function _ce(n,e){var t=e?wP(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var xce=/\w*$/;function bce(n){var e=new n.constructor(n.source,xce.exec(n));return e.lastIndex=n.lastIndex,e}var FF=uf?uf.prototype:void 0,BF=FF?FF.valueOf:void 0;function wce(n){return BF?Object(BF.call(n)):{}}function Sce(n,e){var t=e?wP(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var Tce="[object Boolean]",Cce="[object Date]",Ece="[object Map]",Ace="[object Number]",Mce="[object RegExp]",kce="[object Set]",Rce="[object String]",Pce="[object Symbol]",Ice="[object ArrayBuffer]",Dce="[object DataView]",Lce="[object Float32Array]",Nce="[object Float64Array]",Oce="[object Int8Array]",$ce="[object Int16Array]",Fce="[object Int32Array]",Bce="[object Uint8Array]",Uce="[object Uint8ClampedArray]",zce="[object Uint16Array]",Vce="[object Uint32Array]";function Hce(n,e,t){var r=n.constructor;switch(e){case Ice:return wP(n);case Tce:case Cce:return new r(+n);case Dce:return _ce(n,t);case Lce:case Nce:case Oce:case $ce:case Fce:case Bce:case Uce:case zce:case Vce:return Sce(n,t);case Ece:return new r;case Ace:case Rce:return new r(n);case Mce:return bce(n);case kce:return new r;case Pce:return wce(n)}}function Wce(n){return typeof n.constructor=="function"&&!mP(n)?Xoe(x8(n)):{}}var Gce="[object Map]";function jce(n){return Pg(n)&&bP(n)==Gce}var UF=Gm&&Gm.isMap,qce=UF?gP(UF):jce;const Xce=qce;var Kce="[object Set]";function Yce(n){return Pg(n)&&bP(n)==Kce}var zF=Gm&&Gm.isSet,Zce=zF?gP(zF):Yce;const Qce=Zce;var Jce=1,efe=2,tfe=4,C8="[object Arguments]",nfe="[object Array]",rfe="[object Boolean]",ife="[object Date]",afe="[object Error]",E8="[object Function]",sfe="[object GeneratorFunction]",ofe="[object Map]",lfe="[object Number]",A8="[object Object]",ufe="[object RegExp]",cfe="[object Set]",ffe="[object String]",hfe="[object Symbol]",dfe="[object WeakMap]",pfe="[object ArrayBuffer]",mfe="[object DataView]",gfe="[object Float32Array]",vfe="[object Float64Array]",yfe="[object Int8Array]",_fe="[object Int16Array]",xfe="[object Int32Array]",bfe="[object Uint8Array]",wfe="[object Uint8ClampedArray]",Sfe="[object Uint16Array]",Tfe="[object Uint32Array]",zr={};zr[C8]=zr[nfe]=zr[pfe]=zr[mfe]=zr[rfe]=zr[ife]=zr[gfe]=zr[vfe]=zr[yfe]=zr[_fe]=zr[xfe]=zr[ofe]=zr[lfe]=zr[A8]=zr[ufe]=zr[cfe]=zr[ffe]=zr[hfe]=zr[bfe]=zr[wfe]=zr[Sfe]=zr[Tfe]=!0;zr[afe]=zr[E8]=zr[dfe]=!1;function C1(n,e,t,r,i,a){var s,o=e&Jce,l=e&efe,u=e&tfe;if(t&&(s=i?t(n,r,i,a):t(n)),s!==void 0)return s;if(!ud(n))return n;var c=Ld(n);if(c){if(s=vce(n),!o)return Koe(n,s)}else{var f=bP(n),h=f==E8||f==sfe;if(h8(n))return Kue(n,o);if(f==A8||f==C8||h&&!i){if(s=l||h?{}:Wce(n),!o)return l?rce(n,que(s,n)):ece(n,jue(s,n))}else{if(!zr[f])return i?n:{};s=Hce(n,f,o)}}a||(a=new Ig);var d=a.get(n);if(d)return d;a.set(n,s),Qce(n)?n.forEach(function(g){s.add(C1(g,e,t,g,n,a))}):Xce(n)&&n.forEach(function(g,v){s.set(v,C1(g,e,t,v,n,a))});var p=u?l?ace:ice:l?yP:vP,m=c?void 0:p(n);return Zoe(m||n,function(g,v){m&&(v=g,g=n[v]),pP(s,v,C1(g,e,t,v,n,a))}),s}var Cfe=4;function VF(n){return C1(n,Cfe)}function vw(n){for(var e=-1,t=n==null?0:n.length,r={};++e<t;){var i=n[e];r[i[0]]=i[1]}return r}function jm(n){return n==null}function Efe(n){return n===void 0}function Afe(n,e,t,r){if(!ud(n))return n;e=g8(e,n);for(var i=-1,a=e.length,s=a-1,o=n;o!=null&&++i<a;){var l=v8(e[i]),u=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(i!=s){var c=o[l];u=r?r(c,l,o):void 0,u===void 0&&(u=ud(c)?c:a8(e[i+1])?[]:{})}pP(o,l,u),o=o[l]}return n}function Mfe(n,e,t){return n==null?n:Afe(n,e,t)}const kfe=n=>n===void 0,YS=n=>typeof n=="boolean",el=n=>typeof n=="number",w0=n=>typeof Element>"u"?!1:n instanceof Element,Rfe=n=>_n(n)?!Number.isNaN(Number(n)):!1,HF=n=>Object.keys(n),jC=(n,e,t)=>({get value(){return y8(n,e,t)},set value(r){Mfe(n,e,r)}});class Pfe extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function S0(n,e){throw new Pfe(`[${n}] ${e}`)}const M8=(n="")=>n.split(" ").filter(e=>!!e.trim()),Ife=(n,e)=>{if(!n||!e)return!1;if(e.includes(" "))throw new Error("className should not contain space.");return n.classList.contains(e)},lm=(n,e)=>{!n||!e.trim()||n.classList.add(...M8(e))},Kh=(n,e)=>{!n||!e.trim()||n.classList.remove(...M8(e))},wv=(n,e)=>{var t;if(!ya||!n||!e)return"";let r=Qo(e);r==="float"&&(r="cssFloat");try{const i=n.style[r];if(i)return i;const a=(t=document.defaultView)==null?void 0:t.getComputedStyle(n,"");return a?a[r]:""}catch{return n.style[r]}};function QA(n,e="px"){if(!n)return"";if(el(n)||Rfe(n))return`${n}${e}`;if(_n(n))return n}/*! Element Plus Icons Vue v2.1.0 */var Ua=(n,e)=>{let t=n.__vccOpts||n;for(let[r,i]of e)t[r]=i;return t},Dfe={name:"ArrowDown"},Lfe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Nfe=cn("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),Ofe=[Nfe];function $fe(n,e,t,r,i,a){return at(),kt("svg",Lfe,Ofe)}var Ffe=Ua(Dfe,[["render",$fe],["__file","arrow-down.vue"]]),Bfe={name:"ArrowRight"},Ufe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},zfe=cn("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),Vfe=[zfe];function Hfe(n,e,t,r,i,a){return at(),kt("svg",Ufe,Vfe)}var k8=Ua(Bfe,[["render",Hfe],["__file","arrow-right.vue"]]),Wfe={name:"Check"},Gfe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},jfe=cn("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),qfe=[jfe];function Xfe(n,e,t,r,i,a){return at(),kt("svg",Gfe,qfe)}var Kfe=Ua(Wfe,[["render",Xfe],["__file","check.vue"]]),Yfe={name:"CircleCheck"},Zfe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Qfe=cn("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),Jfe=cn("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),ehe=[Qfe,Jfe];function the(n,e,t,r,i,a){return at(),kt("svg",Zfe,ehe)}var R8=Ua(Yfe,[["render",the],["__file","circle-check.vue"]]),nhe={name:"CircleCloseFilled"},rhe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ihe=cn("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1),ahe=[ihe];function she(n,e,t,r,i,a){return at(),kt("svg",rhe,ahe)}var P8=Ua(nhe,[["render",she],["__file","circle-close-filled.vue"]]),ohe={name:"CircleClose"},lhe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},uhe=cn("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),che=cn("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),fhe=[uhe,che];function hhe(n,e,t,r,i,a){return at(),kt("svg",lhe,fhe)}var SP=Ua(ohe,[["render",hhe],["__file","circle-close.vue"]]),dhe={name:"Close"},phe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},mhe=cn("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),ghe=[mhe];function vhe(n,e,t,r,i,a){return at(),kt("svg",phe,ghe)}var I8=Ua(dhe,[["render",vhe],["__file","close.vue"]]),yhe={name:"Hide"},_he={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},xhe=cn("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"},null,-1),bhe=cn("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"},null,-1),whe=[xhe,bhe];function She(n,e,t,r,i,a){return at(),kt("svg",_he,whe)}var The=Ua(yhe,[["render",She],["__file","hide.vue"]]),Che={name:"InfoFilled"},Ehe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ahe=cn("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1),Mhe=[Ahe];function khe(n,e,t,r,i,a){return at(),kt("svg",Ehe,Mhe)}var D8=Ua(Che,[["render",khe],["__file","info-filled.vue"]]),Rhe={name:"Loading"},Phe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ihe=cn("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),Dhe=[Ihe];function Lhe(n,e,t,r,i,a){return at(),kt("svg",Phe,Dhe)}var L8=Ua(Rhe,[["render",Lhe],["__file","loading.vue"]]),Nhe={name:"More"},Ohe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},$he=cn("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"},null,-1),Fhe=[$he];function Bhe(n,e,t,r,i,a){return at(),kt("svg",Ohe,Fhe)}var Uhe=Ua(Nhe,[["render",Bhe],["__file","more.vue"]]),zhe={name:"PictureFilled"},Vhe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Hhe=cn("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32H96zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112zM256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384z"},null,-1),Whe=[Hhe];function Ghe(n,e,t,r,i,a){return at(),kt("svg",Vhe,Whe)}var jhe=Ua(zhe,[["render",Ghe],["__file","picture-filled.vue"]]),qhe={name:"SuccessFilled"},Xhe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Khe=cn("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),Yhe=[Khe];function Zhe(n,e,t,r,i,a){return at(),kt("svg",Xhe,Yhe)}var N8=Ua(qhe,[["render",Zhe],["__file","success-filled.vue"]]),Qhe={name:"View"},Jhe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ede=cn("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),tde=[ede];function nde(n,e,t,r,i,a){return at(),kt("svg",Jhe,tde)}var rde=Ua(Qhe,[["render",nde],["__file","view.vue"]]),ide={name:"WarningFilled"},ade={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},sde=cn("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1),ode=[sde];function lde(n,e,t,r,i,a){return at(),kt("svg",ade,ode)}var TP=Ua(ide,[["render",lde],["__file","warning-filled.vue"]]);const O8="__epPropKey",on=n=>n,ude=n=>Fn(n)&&!!n[O8],ZS=(n,e)=>{if(!Fn(n)||ude(n))return n;const{values:t,required:r,default:i,type:a,validator:s}=n,l={type:a,required:!!r,validator:t||s?u=>{let c=!1,f=[];if(t&&(f=Array.from(t),qn(n,"default")&&f.push(i),c||(c=f.includes(u))),s&&(c||(c=s(u))),!c&&f.length>0){const h=[...new Set(f)].map(d=>JSON.stringify(d)).join(", ");lie(`Invalid prop: validation failed${e?` for prop "${e}"`:""}. Expected one of [${h}], got value ${JSON.stringify(u)}.`)}return c}:void 0,[O8]:!0};return qn(n,"default")&&(l.default=i),l},vr=n=>vw(Object.entries(n).map(([e,t])=>[e,ZS(t,e)])),Pu=on([String,Object,Function]),cde={Close:I8,SuccessFilled:N8,InfoFilled:D8,WarningFilled:TP,CircleCloseFilled:P8},WF={success:N8,warning:TP,error:P8,info:D8},fde={validating:L8,success:R8,error:SP},wa=(n,e)=>{if(n.install=t=>{for(const r of[n,...Object.values(e??{})])t.component(r.name,r)},e)for(const[t,r]of Object.entries(e))n[t]=r;return n},hde=(n,e)=>(n.install=t=>{n._context=t._context,t.config.globalProperties[e]=n},n),il=n=>(n.install=va,n),Na={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},qC=["sun","mon","tue","wed","thu","fri","sat"],fd="update:modelValue",$8="change",F8="input",CP=["","default","small","large"],E1=n=>{const e=Ht(n)?n:[n],t=[];return e.forEach(r=>{var i;Ht(r)?t.push(...E1(r)):lf(r)&&Ht(r.children)?t.push(...E1(r.children)):(t.push(r),lf(r)&&((i=r.component)!=null&&i.subTree)&&t.push(...E1(r.component.subTree)))}),t},dde=n=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(n),B8=()=>Math.floor(Math.random()*1e4),Au=n=>n,pde=["class","style"],mde=/^on[A-Z]/,gde=(n={})=>{const{excludeListeners:e=!1,excludeKeys:t}=n,r=Le(()=>((t==null?void 0:t.value)||[]).concat(pde)),i=Is();return Le(i?()=>{var a;return vw(Object.entries((a=i.proxy)==null?void 0:a.$attrs).filter(([s])=>!r.value.includes(s)&&!(e&&mde.test(s))))}:()=>({}))},EP=({from:n,replacement:e,scope:t,version:r,ref:i,type:a="API"},s)=>{Sn(()=>Q(s),o=>{},{immediate:!0})};var vde={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const yde=n=>(e,t)=>_de(e,t,Q(n)),_de=(n,e,t)=>y8(t,n,n).replace(/\{(\w+)\}/g,(r,i)=>{var a;return`${(a=e==null?void 0:e[i])!=null?a:`{${i}}`}`}),xde=n=>{const e=Le(()=>Q(n).name),t=mi(n)?n:It(n);return{lang:e,locale:t,t:yde(n)}},U8=Symbol("localeContextKey"),QS=n=>{const e=n||$n(U8,It());return xde(Le(()=>e.value||vde))},JA="el",bde="is-",qf=(n,e,t,r,i)=>{let a=`${n}-${e}`;return t&&(a+=`-${t}`),r&&(a+=`__${r}`),i&&(a+=`--${i}`),a},z8=Symbol("namespaceContextKey"),AP=n=>{const e=n||$n(z8,It(JA));return Le(()=>Q(e)||JA)},Tn=(n,e)=>{const t=AP(e);return{namespace:t,b:(m="")=>qf(t.value,n,m,"",""),e:m=>m?qf(t.value,n,"",m,""):"",m:m=>m?qf(t.value,n,"","",m):"",be:(m,g)=>m&&g?qf(t.value,n,m,g,""):"",em:(m,g)=>m&&g?qf(t.value,n,"",m,g):"",bm:(m,g)=>m&&g?qf(t.value,n,m,"",g):"",bem:(m,g,v)=>m&&g&&v?qf(t.value,n,m,g,v):"",is:(m,...g)=>{const v=g.length>=1?g[0]:!0;return m&&v?`${bde}${m}`:""},cssVar:m=>{const g={};for(const v in m)m[v]&&(g[`--${t.value}-${v}`]=m[v]);return g},cssVarName:m=>`--${t.value}-${m}`,cssVarBlock:m=>{const g={};for(const v in m)m[v]&&(g[`--${t.value}-${n}-${v}`]=m[v]);return g},cssVarBlockName:m=>`--${t.value}-${n}-${m}`}},wde=ZS({type:on(Boolean),default:null}),Sde=ZS({type:on(Function)}),V8=n=>{const e=`update:${n}`,t=`onUpdate:${n}`,r=[e],i={[n]:wde,[t]:Sde};return{useModelToggle:({indicator:s,toggleReason:o,shouldHideWhenRouteChanges:l,shouldProceed:u,onShow:c,onHide:f})=>{const h=Is(),{emit:d}=h,p=h.props,m=Le(()=>rn(p[t])),g=Le(()=>p[n]===null),v=M=>{s.value!==!0&&(s.value=!0,o&&(o.value=M),rn(c)&&c(M))},_=M=>{s.value!==!1&&(s.value=!1,o&&(o.value=M),rn(f)&&f(M))},x=M=>{if(p.disabled===!0||rn(u)&&!u())return;const C=m.value&&ya;C&&d(e,!0),(g.value||!C)&&v(M)},b=M=>{if(p.disabled===!0||!ya)return;const C=m.value&&ya;C&&d(e,!1),(g.value||!C)&&_(M)},S=M=>{YS(M)&&(p.disabled&&M?m.value&&d(e,!1):s.value!==M&&(M?v():_()))},T=()=>{s.value?b():x()};return Sn(()=>p[n],S),l&&h.appContext.config.globalProperties.$route!==void 0&&Sn(()=>({...h.proxy.$route}),()=>{l.value&&s.value&&b()}),Ii(()=>{S(p[n])}),{hide:b,show:x,toggle:T,hasUpdateHandler:m}},useModelToggleProps:i,useModelToggleEmits:r}};V8("modelValue");const H8=n=>{const e=Is();return Le(()=>{var t,r;return(r=(t=e==null?void 0:e.proxy)==null?void 0:t.$props)==null?void 0:r[n]})};var is="top",yo="bottom",_o="right",as="left",MP="auto",y_=[is,yo,_o,as],qm="start",T0="end",Tde="clippingParents",W8="viewport",Sv="popper",Cde="reference",GF=y_.reduce(function(n,e){return n.concat([e+"-"+qm,e+"-"+T0])},[]),kP=[].concat(y_,[MP]).reduce(function(n,e){return n.concat([e,e+"-"+qm,e+"-"+T0])},[]),Ede="beforeRead",Ade="read",Mde="afterRead",kde="beforeMain",Rde="main",Pde="afterMain",Ide="beforeWrite",Dde="write",Lde="afterWrite",Nde=[Ede,Ade,Mde,kde,Rde,Pde,Ide,Dde,Lde];function Hl(n){return n?(n.nodeName||"").toLowerCase():null}function al(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Xm(n){var e=al(n).Element;return n instanceof e||n instanceof Element}function fo(n){var e=al(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function RP(n){if(typeof ShadowRoot>"u")return!1;var e=al(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Ode(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var r=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!fo(a)||!Hl(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function $de(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],a=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:t[r]),o=s.reduce(function(l,u){return l[u]="",l},{});!fo(i)||!Hl(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}var G8={name:"applyStyles",enabled:!0,phase:"write",fn:Ode,effect:$de,requires:["computeStyles"]};function $l(n){return n.split("-")[0]}var Yh=Math.max,yw=Math.min,Km=Math.round;function Ym(n,e){e===void 0&&(e=!1);var t=n.getBoundingClientRect(),r=1,i=1;if(fo(n)&&e){var a=n.offsetHeight,s=n.offsetWidth;s>0&&(r=Km(t.width)/s||1),a>0&&(i=Km(t.height)/a||1)}return{width:t.width/r,height:t.height/i,top:t.top/i,right:t.right/r,bottom:t.bottom/i,left:t.left/r,x:t.left/r,y:t.top/i}}function PP(n){var e=Ym(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function j8(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&RP(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Gu(n){return al(n).getComputedStyle(n)}function Fde(n){return["table","td","th"].indexOf(Hl(n))>=0}function Mf(n){return((Xm(n)?n.ownerDocument:n.document)||window.document).documentElement}function JS(n){return Hl(n)==="html"?n:n.assignedSlot||n.parentNode||(RP(n)?n.host:null)||Mf(n)}function jF(n){return!fo(n)||Gu(n).position==="fixed"?null:n.offsetParent}function Bde(n){var e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,t=navigator.userAgent.indexOf("Trident")!==-1;if(t&&fo(n)){var r=Gu(n);if(r.position==="fixed")return null}var i=JS(n);for(RP(i)&&(i=i.host);fo(i)&&["html","body"].indexOf(Hl(i))<0;){var a=Gu(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function __(n){for(var e=al(n),t=jF(n);t&&Fde(t)&&Gu(t).position==="static";)t=jF(t);return t&&(Hl(t)==="html"||Hl(t)==="body"&&Gu(t).position==="static")?e:t||Bde(n)||e}function IP(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function By(n,e,t){return Yh(n,yw(e,t))}function Ude(n,e,t){var r=By(n,e,t);return r>t?t:r}function q8(){return{top:0,right:0,bottom:0,left:0}}function X8(n){return Object.assign({},q8(),n)}function K8(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var zde=function(n,e){return n=typeof n=="function"?n(Object.assign({},e.rects,{placement:e.placement})):n,X8(typeof n!="number"?n:K8(n,y_))};function Vde(n){var e,t=n.state,r=n.name,i=n.options,a=t.elements.arrow,s=t.modifiersData.popperOffsets,o=$l(t.placement),l=IP(o),u=[as,_o].indexOf(o)>=0,c=u?"height":"width";if(!(!a||!s)){var f=zde(i.padding,t),h=PP(a),d=l==="y"?is:as,p=l==="y"?yo:_o,m=t.rects.reference[c]+t.rects.reference[l]-s[l]-t.rects.popper[c],g=s[l]-t.rects.reference[l],v=__(a),_=v?l==="y"?v.clientHeight||0:v.clientWidth||0:0,x=m/2-g/2,b=f[d],S=_-h[c]-f[p],T=_/2-h[c]/2+x,M=By(b,T,S),C=l;t.modifiersData[r]=(e={},e[C]=M,e.centerOffset=M-T,e)}}function Hde(n){var e=n.state,t=n.options,r=t.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||!j8(e.elements.popper,i)||(e.elements.arrow=i))}var Wde={name:"arrow",enabled:!0,phase:"main",fn:Vde,effect:Hde,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Zm(n){return n.split("-")[1]}var Gde={top:"auto",right:"auto",bottom:"auto",left:"auto"};function jde(n){var e=n.x,t=n.y,r=window,i=r.devicePixelRatio||1;return{x:Km(e*i)/i||0,y:Km(t*i)/i||0}}function qF(n){var e,t=n.popper,r=n.popperRect,i=n.placement,a=n.variation,s=n.offsets,o=n.position,l=n.gpuAcceleration,u=n.adaptive,c=n.roundOffsets,f=n.isFixed,h=s.x,d=h===void 0?0:h,p=s.y,m=p===void 0?0:p,g=typeof c=="function"?c({x:d,y:m}):{x:d,y:m};d=g.x,m=g.y;var v=s.hasOwnProperty("x"),_=s.hasOwnProperty("y"),x=as,b=is,S=window;if(u){var T=__(t),M="clientHeight",C="clientWidth";if(T===al(t)&&(T=Mf(t),Gu(T).position!=="static"&&o==="absolute"&&(M="scrollHeight",C="scrollWidth")),T=T,i===is||(i===as||i===_o)&&a===T0){b=yo;var k=f&&T===S&&S.visualViewport?S.visualViewport.height:T[M];m-=k-r.height,m*=l?1:-1}if(i===as||(i===is||i===yo)&&a===T0){x=_o;var R=f&&T===S&&S.visualViewport?S.visualViewport.width:T[C];d-=R-r.width,d*=l?1:-1}}var P=Object.assign({position:o},u&&Gde),N=c===!0?jde({x:d,y:m}):{x:d,y:m};if(d=N.x,m=N.y,l){var L;return Object.assign({},P,(L={},L[b]=_?"0":"",L[x]=v?"0":"",L.transform=(S.devicePixelRatio||1)<=1?"translate("+d+"px, "+m+"px)":"translate3d("+d+"px, "+m+"px, 0)",L))}return Object.assign({},P,(e={},e[b]=_?m+"px":"",e[x]=v?d+"px":"",e.transform="",e))}function qde(n){var e=n.state,t=n.options,r=t.gpuAcceleration,i=r===void 0?!0:r,a=t.adaptive,s=a===void 0?!0:a,o=t.roundOffsets,l=o===void 0?!0:o,u={placement:$l(e.placement),variation:Zm(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,qF(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,qF(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var Y8={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:qde,data:{}},Cx={passive:!0};function Xde(n){var e=n.state,t=n.instance,r=n.options,i=r.scroll,a=i===void 0?!0:i,s=r.resize,o=s===void 0?!0:s,l=al(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&u.forEach(function(c){c.addEventListener("scroll",t.update,Cx)}),o&&l.addEventListener("resize",t.update,Cx),function(){a&&u.forEach(function(c){c.removeEventListener("scroll",t.update,Cx)}),o&&l.removeEventListener("resize",t.update,Cx)}}var Z8={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Xde,data:{}},Kde={left:"right",right:"left",bottom:"top",top:"bottom"};function A1(n){return n.replace(/left|right|bottom|top/g,function(e){return Kde[e]})}var Yde={start:"end",end:"start"};function XF(n){return n.replace(/start|end/g,function(e){return Yde[e]})}function DP(n){var e=al(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function LP(n){return Ym(Mf(n)).left+DP(n).scrollLeft}function Zde(n){var e=al(n),t=Mf(n),r=e.visualViewport,i=t.clientWidth,a=t.clientHeight,s=0,o=0;return r&&(i=r.width,a=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=r.offsetLeft,o=r.offsetTop)),{width:i,height:a,x:s+LP(n),y:o}}function Qde(n){var e,t=Mf(n),r=DP(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=Yh(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Yh(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-r.scrollLeft+LP(n),l=-r.scrollTop;return Gu(i||t).direction==="rtl"&&(o+=Yh(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function NP(n){var e=Gu(n),t=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+r)}function Q8(n){return["html","body","#document"].indexOf(Hl(n))>=0?n.ownerDocument.body:fo(n)&&NP(n)?n:Q8(JS(n))}function Uy(n,e){var t;e===void 0&&(e=[]);var r=Q8(n),i=r===((t=n.ownerDocument)==null?void 0:t.body),a=al(r),s=i?[a].concat(a.visualViewport||[],NP(r)?r:[]):r,o=e.concat(s);return i?o:o.concat(Uy(JS(s)))}function eM(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Jde(n){var e=Ym(n);return e.top=e.top+n.clientTop,e.left=e.left+n.clientLeft,e.bottom=e.top+n.clientHeight,e.right=e.left+n.clientWidth,e.width=n.clientWidth,e.height=n.clientHeight,e.x=e.left,e.y=e.top,e}function KF(n,e){return e===W8?eM(Zde(n)):Xm(e)?Jde(e):eM(Qde(Mf(n)))}function epe(n){var e=Uy(JS(n)),t=["absolute","fixed"].indexOf(Gu(n).position)>=0,r=t&&fo(n)?__(n):n;return Xm(r)?e.filter(function(i){return Xm(i)&&j8(i,r)&&Hl(i)!=="body"}):[]}function tpe(n,e,t){var r=e==="clippingParents"?epe(n):[].concat(e),i=[].concat(r,[t]),a=i[0],s=i.reduce(function(o,l){var u=KF(n,l);return o.top=Yh(u.top,o.top),o.right=yw(u.right,o.right),o.bottom=yw(u.bottom,o.bottom),o.left=Yh(u.left,o.left),o},KF(n,a));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function J8(n){var e=n.reference,t=n.element,r=n.placement,i=r?$l(r):null,a=r?Zm(r):null,s=e.x+e.width/2-t.width/2,o=e.y+e.height/2-t.height/2,l;switch(i){case is:l={x:s,y:e.y-t.height};break;case yo:l={x:s,y:e.y+e.height};break;case _o:l={x:e.x+e.width,y:o};break;case as:l={x:e.x-t.width,y:o};break;default:l={x:e.x,y:e.y}}var u=i?IP(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(a){case qm:l[u]=l[u]-(e[c]/2-t[c]/2);break;case T0:l[u]=l[u]+(e[c]/2-t[c]/2);break}}return l}function C0(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=r===void 0?n.placement:r,a=t.boundary,s=a===void 0?Tde:a,o=t.rootBoundary,l=o===void 0?W8:o,u=t.elementContext,c=u===void 0?Sv:u,f=t.altBoundary,h=f===void 0?!1:f,d=t.padding,p=d===void 0?0:d,m=X8(typeof p!="number"?p:K8(p,y_)),g=c===Sv?Cde:Sv,v=n.rects.popper,_=n.elements[h?g:c],x=tpe(Xm(_)?_:_.contextElement||Mf(n.elements.popper),s,l),b=Ym(n.elements.reference),S=J8({reference:b,element:v,strategy:"absolute",placement:i}),T=eM(Object.assign({},v,S)),M=c===Sv?T:b,C={top:x.top-M.top+m.top,bottom:M.bottom-x.bottom+m.bottom,left:x.left-M.left+m.left,right:M.right-x.right+m.right},k=n.modifiersData.offset;if(c===Sv&&k){var R=k[i];Object.keys(C).forEach(function(P){var N=[_o,yo].indexOf(P)>=0?1:-1,L=[is,yo].indexOf(P)>=0?"y":"x";C[P]+=R[L]*N})}return C}function npe(n,e){e===void 0&&(e={});var t=e,r=t.placement,i=t.boundary,a=t.rootBoundary,s=t.padding,o=t.flipVariations,l=t.allowedAutoPlacements,u=l===void 0?kP:l,c=Zm(r),f=c?o?GF:GF.filter(function(p){return Zm(p)===c}):y_,h=f.filter(function(p){return u.indexOf(p)>=0});h.length===0&&(h=f);var d=h.reduce(function(p,m){return p[m]=C0(n,{placement:m,boundary:i,rootBoundary:a,padding:s})[$l(m)],p},{});return Object.keys(d).sort(function(p,m){return d[p]-d[m]})}function rpe(n){if($l(n)===MP)return[];var e=A1(n);return[XF(n),e,XF(e)]}function ipe(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,s=t.altAxis,o=s===void 0?!0:s,l=t.fallbackPlacements,u=t.padding,c=t.boundary,f=t.rootBoundary,h=t.altBoundary,d=t.flipVariations,p=d===void 0?!0:d,m=t.allowedAutoPlacements,g=e.options.placement,v=$l(g),_=v===g,x=l||(_||!p?[A1(g)]:rpe(g)),b=[g].concat(x).reduce(function(Ee,Ne){return Ee.concat($l(Ne)===MP?npe(e,{placement:Ne,boundary:c,rootBoundary:f,padding:u,flipVariations:p,allowedAutoPlacements:m}):Ne)},[]),S=e.rects.reference,T=e.rects.popper,M=new Map,C=!0,k=b[0],R=0;R<b.length;R++){var P=b[R],N=$l(P),L=Zm(P)===qm,F=[is,yo].indexOf(N)>=0,O=F?"width":"height",B=C0(e,{placement:P,boundary:c,rootBoundary:f,altBoundary:h,padding:u}),H=F?L?_o:as:L?yo:is;S[O]>T[O]&&(H=A1(H));var j=A1(H),K=[];if(a&&K.push(B[N]<=0),o&&K.push(B[H]<=0,B[j]<=0),K.every(function(Ee){return Ee})){k=P,C=!1;break}M.set(P,K)}if(C)for(var J=p?3:1,re=function(Ee){var Ne=b.find(function(we){var me=M.get(we);if(me)return me.slice(0,Ee).every(function(Se){return Se})});if(Ne)return k=Ne,"break"},se=J;se>0;se--){var Ae=re(se);if(Ae==="break")break}e.placement!==k&&(e.modifiersData[r]._skip=!0,e.placement=k,e.reset=!0)}}var ape={name:"flip",enabled:!0,phase:"main",fn:ipe,requiresIfExists:["offset"],data:{_skip:!1}};function YF(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function ZF(n){return[is,_o,yo,as].some(function(e){return n[e]>=0})}function spe(n){var e=n.state,t=n.name,r=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=C0(e,{elementContext:"reference"}),o=C0(e,{altBoundary:!0}),l=YF(s,r),u=YF(o,i,a),c=ZF(l),f=ZF(u);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}var ope={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:spe};function lpe(n,e,t){var r=$l(n),i=[as,is].indexOf(r)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[as,_o].indexOf(r)>=0?{x:o,y:s}:{x:s,y:o}}function upe(n){var e=n.state,t=n.options,r=n.name,i=t.offset,a=i===void 0?[0,0]:i,s=kP.reduce(function(c,f){return c[f]=lpe(f,e.rects,a),c},{}),o=s[e.placement],l=o.x,u=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=s}var cpe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:upe};function fpe(n){var e=n.state,t=n.name;e.modifiersData[t]=J8({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var e9={name:"popperOffsets",enabled:!0,phase:"read",fn:fpe,data:{}};function hpe(n){return n==="x"?"y":"x"}function dpe(n){var e=n.state,t=n.options,r=n.name,i=t.mainAxis,a=i===void 0?!0:i,s=t.altAxis,o=s===void 0?!1:s,l=t.boundary,u=t.rootBoundary,c=t.altBoundary,f=t.padding,h=t.tether,d=h===void 0?!0:h,p=t.tetherOffset,m=p===void 0?0:p,g=C0(e,{boundary:l,rootBoundary:u,padding:f,altBoundary:c}),v=$l(e.placement),_=Zm(e.placement),x=!_,b=IP(v),S=hpe(b),T=e.modifiersData.popperOffsets,M=e.rects.reference,C=e.rects.popper,k=typeof m=="function"?m(Object.assign({},e.rects,{placement:e.placement})):m,R=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),P=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,N={x:0,y:0};if(T){if(a){var L,F=b==="y"?is:as,O=b==="y"?yo:_o,B=b==="y"?"height":"width",H=T[b],j=H+g[F],K=H-g[O],J=d?-C[B]/2:0,re=_===qm?M[B]:C[B],se=_===qm?-C[B]:-M[B],Ae=e.elements.arrow,Ee=d&&Ae?PP(Ae):{width:0,height:0},Ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:q8(),we=Ne[F],me=Ne[O],Se=By(0,M[B],Ee[B]),Me=x?M[B]/2-J-Se-we-R.mainAxis:re-Se-we-R.mainAxis,ke=x?-M[B]/2+J+Se+me+R.mainAxis:se+Se+me+R.mainAxis,He=e.elements.arrow&&__(e.elements.arrow),ee=He?b==="y"?He.clientTop||0:He.clientLeft||0:0,ie=(L=P==null?void 0:P[b])!=null?L:0,xe=H+Me-ie-ee,Ve=H+ke-ie,Ge=By(d?yw(j,xe):j,H,d?Yh(K,Ve):K);T[b]=Ge,N[b]=Ge-H}if(o){var Ze,ut=b==="x"?is:as,Qe=b==="x"?yo:_o,ve=T[S],Ke=S==="y"?"height":"width",ne=ve+g[ut],Z=ve-g[Qe],fe=[is,as].indexOf(v)!==-1,Be=(Ze=P==null?void 0:P[S])!=null?Ze:0,Xe=fe?ne:ve-M[Ke]-C[Ke]-Be+R.altAxis,st=fe?ve+M[Ke]+C[Ke]-Be-R.altAxis:Z,mt=d&&fe?Ude(Xe,ve,st):By(d?Xe:ne,ve,d?st:Z);T[S]=mt,N[S]=mt-ve}e.modifiersData[r]=N}}var ppe={name:"preventOverflow",enabled:!0,phase:"main",fn:dpe,requiresIfExists:["offset"]};function mpe(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function gpe(n){return n===al(n)||!fo(n)?DP(n):mpe(n)}function vpe(n){var e=n.getBoundingClientRect(),t=Km(e.width)/n.offsetWidth||1,r=Km(e.height)/n.offsetHeight||1;return t!==1||r!==1}function ype(n,e,t){t===void 0&&(t=!1);var r=fo(e),i=fo(e)&&vpe(e),a=Mf(e),s=Ym(n,i),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((Hl(e)!=="body"||NP(a))&&(o=gpe(e)),fo(e)?(l=Ym(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=LP(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function _pe(n){var e=new Map,t=new Set,r=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!t.has(o)){var l=e.get(o);l&&i(l)}}),r.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),r}function xpe(n){var e=_pe(n);return Nde.reduce(function(t,r){return t.concat(e.filter(function(i){return i.phase===r}))},[])}function bpe(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function wpe(n){var e=n.reduce(function(t,r){var i=t[r.name];return t[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var QF={placement:"bottom",modifiers:[],strategy:"absolute"};function JF(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function OP(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?QF:i;return function(s,o,l){l===void 0&&(l=a);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},QF,a),modifiersData:{},elements:{reference:s,popper:o},attributes:{},styles:{}},c=[],f=!1,h={state:u,setOptions:function(m){var g=typeof m=="function"?m(u.options):m;p(),u.options=Object.assign({},a,u.options,g),u.scrollParents={reference:Xm(s)?Uy(s):s.contextElement?Uy(s.contextElement):[],popper:Uy(o)};var v=xpe(wpe([].concat(r,u.options.modifiers)));return u.orderedModifiers=v.filter(function(_){return _.enabled}),d(),h.update()},forceUpdate:function(){if(!f){var m=u.elements,g=m.reference,v=m.popper;if(JF(g,v)){u.rects={reference:ype(g,__(v),u.options.strategy==="fixed"),popper:PP(v)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(C){return u.modifiersData[C.name]=Object.assign({},C.data)});for(var _=0;_<u.orderedModifiers.length;_++){if(u.reset===!0){u.reset=!1,_=-1;continue}var x=u.orderedModifiers[_],b=x.fn,S=x.options,T=S===void 0?{}:S,M=x.name;typeof b=="function"&&(u=b({state:u,options:T,name:M,instance:h})||u)}}}},update:bpe(function(){return new Promise(function(m){h.forceUpdate(),m(u)})}),destroy:function(){p(),f=!0}};if(!JF(s,o))return h;h.setOptions(l).then(function(m){!f&&l.onFirstUpdate&&l.onFirstUpdate(m)});function d(){u.orderedModifiers.forEach(function(m){var g=m.name,v=m.options,_=v===void 0?{}:v,x=m.effect;if(typeof x=="function"){var b=x({state:u,name:g,instance:h,options:_}),S=function(){};c.push(b||S)}})}function p(){c.forEach(function(m){return m()}),c=[]}return h}}OP();var Spe=[Z8,e9,Y8,G8];OP({defaultModifiers:Spe});var Tpe=[Z8,e9,Y8,G8,cpe,ape,ppe,Wde,ope],Cpe=OP({defaultModifiers:Tpe});const Epe=(n,e,t={})=>{const r={name:"updateState",enabled:!0,phase:"write",fn:({state:l})=>{const u=Ape(l);Object.assign(s.value,u)},requires:["computeStyles"]},i=Le(()=>{const{onFirstUpdate:l,placement:u,strategy:c,modifiers:f}=Q(t);return{onFirstUpdate:l,placement:u||"bottom",strategy:c||"absolute",modifiers:[...f||[],r,{name:"applyStyles",enabled:!1}]}}),a=Py(),s=It({styles:{popper:{position:Q(i).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=()=>{a.value&&(a.value.destroy(),a.value=void 0)};return Sn(i,l=>{const u=Q(a);u&&u.setOptions(l)},{deep:!0}),Sn([n,e],([l,u])=>{o(),!(!l||!u)&&(a.value=Cpe(l,u,Q(i)))}),cs(()=>{o()}),{state:Le(()=>{var l;return{...((l=Q(a))==null?void 0:l.state)||{}}}),styles:Le(()=>Q(s).styles),attributes:Le(()=>Q(s).attributes),update:()=>{var l;return(l=Q(a))==null?void 0:l.update()},forceUpdate:()=>{var l;return(l=Q(a))==null?void 0:l.forceUpdate()},instanceRef:Le(()=>Q(a))}};function Ape(n){const e=Object.keys(n.elements),t=vw(e.map(i=>[i,n.styles[i]||{}])),r=vw(e.map(i=>[i,n.attributes[i]]));return{styles:t,attributes:r}}const Mpe=(n,e=0)=>{if(e===0)return n;const t=It(!1);let r=0;const i=()=>{r&&clearTimeout(r),r=window.setTimeout(()=>{t.value=n.value},e)};return Ii(i),Sn(()=>n.value,a=>{a?i():t.value=a}),t};function eB(){let n;const e=(r,i)=>{t(),n=window.setTimeout(r,i)},t=()=>window.clearTimeout(n);return GS(()=>t()),{registerTimeout:e,cancelTimeout:t}}const tB={prefix:Math.floor(Math.random()*1e4),current:0},kpe=Symbol("elIdInjection"),t9=()=>Is()?$n(kpe,tB):tB,$P=n=>{const e=t9(),t=AP();return Le(()=>Q(n)||`${t.value}-id-${e.prefix}-${e.current++}`)};let Zp=[];const nB=n=>{const e=n;e.key===Na.esc&&Zp.forEach(t=>t(e))},Rpe=n=>{Ii(()=>{Zp.length===0&&document.addEventListener("keydown",nB),ya&&Zp.push(n)}),cs(()=>{Zp=Zp.filter(e=>e!==n),Zp.length===0&&ya&&document.removeEventListener("keydown",nB)})};let rB;const n9=()=>{const n=AP(),e=t9(),t=Le(()=>`${n.value}-popper-container-${e.prefix}`),r=Le(()=>`#${t.value}`);return{id:t,selector:r}},Ppe=n=>{const e=document.createElement("div");return e.id=n,document.body.appendChild(e),e},Ipe=()=>{const{id:n,selector:e}=n9();return vG(()=>{ya&&!rB&&!document.body.querySelector(e.value)&&(rB=Ppe(n.value))}),{id:n,selector:e}},Dpe=vr({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),Lpe=({showAfter:n,hideAfter:e,autoClose:t,open:r,close:i})=>{const{registerTimeout:a}=eB(),{registerTimeout:s,cancelTimeout:o}=eB();return{onOpen:c=>{a(()=>{r(c);const f=Q(t);el(f)&&f>0&&s(()=>{i(c)},f)},Q(n))},onClose:c=>{o(),a(()=>{i(c)},Q(e))}}},r9=Symbol("elForwardRef"),Npe=n=>{Ci(r9,{setForwardRef:t=>{n.value=t}})},Ope=n=>({mounted(e){n(e)},updated(e){n(e)},unmounted(){n(null)}}),iB=It(0),i9=2e3,a9=Symbol("zIndexContextKey"),s9=n=>{const e=n||$n(a9,void 0),t=Le(()=>{const a=Q(e);return el(a)?a:i9}),r=Le(()=>t.value+iB.value);return{initialZIndex:t,currentZIndex:r,nextZIndex:()=>(iB.value++,r.value)}};function $pe(n){const e=It();function t(){if(n.value==null)return;const{selectionStart:i,selectionEnd:a,value:s}=n.value;if(i==null||a==null)return;const o=s.slice(0,Math.max(0,i)),l=s.slice(Math.max(0,a));e.value={selectionStart:i,selectionEnd:a,value:s,beforeTxt:o,afterTxt:l}}function r(){if(n.value==null||e.value==null)return;const{value:i}=n.value,{beforeTxt:a,afterTxt:s,selectionStart:o}=e.value;if(a==null||s==null||o==null)return;let l=i.length;if(i.endsWith(s))l=i.length-s.length;else if(i.startsWith(a))l=a.length;else{const u=a[o-1],c=i.indexOf(u,o-1);c!==-1&&(l=c+1)}n.value.setSelectionRange(l,l)}return[t,r]}const o9=ZS({type:String,values:CP,required:!1}),l9=Symbol("size"),Fpe=()=>{const n=$n(l9,{});return Le(()=>Q(n.size)||"")},u9=Symbol(),_w=It();function FP(n,e=void 0){const t=Is()?$n(u9,_w):_w;return n?Le(()=>{var r,i;return(i=(r=t.value)==null?void 0:r[n])!=null?i:e}):t}function c9(n,e){const t=FP(),r=Tn(n,Le(()=>{var o;return((o=t.value)==null?void 0:o.namespace)||JA})),i=QS(Le(()=>{var o;return(o=t.value)==null?void 0:o.locale})),a=s9(Le(()=>{var o;return((o=t.value)==null?void 0:o.zIndex)||i9})),s=Le(()=>{var o;return Q(e)||((o=t.value)==null?void 0:o.size)||""});return Bpe(Le(()=>Q(t)||{})),{ns:r,locale:i,zIndex:a,size:s}}const Bpe=(n,e,t=!1)=>{var r;const i=!!Is(),a=i?FP():void 0,s=(r=e==null?void 0:e.provide)!=null?r:i?Ci:void 0;if(!s)return;const o=Le(()=>{const l=Q(n);return a!=null&&a.value?Upe(a.value,l):l});return s(u9,o),s(U8,Le(()=>o.value.locale)),s(z8,Le(()=>o.value.namespace)),s(a9,Le(()=>o.value.zIndex)),s(l9,{size:Le(()=>o.value.size||"")}),(t||!_w.value)&&(_w.value=o.value),o},Upe=(n,e)=>{var t;const r=[...new Set([...HF(n),...HF(e)])],i={};for(const a of r)i[a]=(t=e[a])!=null?t:n[a];return i},aB={};var Yn=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t};const zpe=vr({size:{type:on([Number,String])},color:{type:String}}),Vpe=Dt({name:"ElIcon",inheritAttrs:!1}),Hpe=Dt({...Vpe,props:zpe,setup(n){const e=n,t=Tn("icon"),r=Le(()=>{const{size:i,color:a}=e;return!i&&!a?{}:{fontSize:kfe(i)?void 0:QA(i),"--color":a}});return(i,a)=>(at(),kt("i",ji({class:Q(t).b(),style:Q(r)},i.$attrs),[en(i.$slots,"default")],16))}});var Wpe=Yn(Hpe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const Ss=wa(Wpe),Dg=Symbol("formContextKey"),hd=Symbol("formItemContextKey"),eT=(n,e={})=>{const t=It(void 0),r=e.prop?t:H8("size"),i=e.global?t:Fpe(),a=e.form?{size:void 0}:$n(Dg,void 0),s=e.formItem?{size:void 0}:$n(hd,void 0);return Le(()=>r.value||Q(n)||(s==null?void 0:s.size)||(a==null?void 0:a.size)||i.value||"")},BP=n=>{const e=H8("disabled"),t=$n(Dg,void 0);return Le(()=>e.value||Q(n)||(t==null?void 0:t.disabled)||!1)},f9=()=>{const n=$n(Dg,void 0),e=$n(hd,void 0);return{form:n,formItem:e}},Gpe=(n,{formItemContext:e,disableIdGeneration:t,disableIdManagement:r})=>{t||(t=It(!1)),r||(r=It(!1));const i=It();let a;const s=Le(()=>{var o;return!!(!n.label&&e&&e.inputIds&&((o=e.inputIds)==null?void 0:o.length)<=1)});return Ii(()=>{a=Sn([Go(n,"id"),t],([o,l])=>{const u=o??(l?void 0:$P().value);u!==i.value&&(e!=null&&e.removeInputId&&(i.value&&e.removeInputId(i.value),!(r!=null&&r.value)&&!l&&u&&e.addInputId(u)),i.value=u)},{immediate:!0})}),nP(()=>{a&&a(),e!=null&&e.removeInputId&&i.value&&e.removeInputId(i.value)}),{isLabeledByFormItem:s,inputId:i}},jpe=vr({size:{type:String,values:CP},disabled:Boolean}),qpe=vr({...jpe,model:Object,rules:{type:on(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1},scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),Xpe={validate:(n,e,t)=>(Ht(n)||_n(n))&&YS(e)&&_n(t)};function Kpe(){const n=It([]),e=Le(()=>{if(!n.value.length)return"0";const a=Math.max(...n.value);return a?`${a}px`:""});function t(a){const s=n.value.indexOf(a);return s===-1&&e.value,s}function r(a,s){if(a&&s){const o=t(s);n.value.splice(o,1,a)}else a&&n.value.push(a)}function i(a){const s=t(a);s>-1&&n.value.splice(s,1)}return{autoLabelWidth:e,registerLabelWidth:r,deregisterLabelWidth:i}}const Ex=(n,e)=>{const t=b0(e);return t.length>0?n.filter(r=>r.prop&&t.includes(r.prop)):n},Ype="ElForm",Zpe=Dt({name:Ype}),Qpe=Dt({...Zpe,props:qpe,emits:Xpe,setup(n,{expose:e,emit:t}){const r=n,i=[],a=eT(),s=Tn("form"),o=Le(()=>{const{labelPosition:_,inline:x}=r;return[s.b(),s.m(a.value||"default"),{[s.m(`label-${_}`)]:_,[s.m("inline")]:x}]}),l=_=>{i.push(_)},u=_=>{_.prop&&i.splice(i.indexOf(_),1)},c=(_=[])=>{r.model&&Ex(i,_).forEach(x=>x.resetField())},f=(_=[])=>{Ex(i,_).forEach(x=>x.clearValidate())},h=Le(()=>!!r.model),d=_=>{if(i.length===0)return[];const x=Ex(i,_);return x.length?x:[]},p=async _=>g(void 0,_),m=async(_=[])=>{if(!h.value)return!1;const x=d(_);if(x.length===0)return!0;let b={};for(const S of x)try{await S.validate("")}catch(T){b={...b,...T}}return Object.keys(b).length===0?!0:Promise.reject(b)},g=async(_=[],x)=>{const b=!rn(x);try{const S=await m(_);return S===!0&&(x==null||x(S)),S}catch(S){if(S instanceof Error)throw S;const T=S;return r.scrollToError&&v(Object.keys(T)[0]),x==null||x(!1,T),b&&Promise.reject(T)}},v=_=>{var x;const b=Ex(i,_)[0];b&&((x=b.$el)==null||x.scrollIntoView(r.scrollIntoViewOptions))};return Sn(()=>r.rules,()=>{r.validateOnRuleChange&&p().catch(_=>void 0)},{deep:!0}),Ci(Dg,bo({...YR(r),emit:t,resetFields:c,clearValidate:f,validateField:g,addField:l,removeField:u,...Kpe()})),e({validate:p,validateField:g,resetFields:c,clearValidate:f,scrollToField:v}),(_,x)=>(at(),kt("form",{class:Et(Q(o))},[en(_.$slots,"default")],2))}});var Jpe=Yn(Qpe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);function $h(){return $h=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},$h.apply(this,arguments)}function eme(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,E0(n,e)}function tM(n){return tM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tM(n)}function E0(n,e){return E0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},E0(n,e)}function tme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function M1(n,e,t){return tme()?M1=Reflect.construct.bind():M1=function(i,a,s){var o=[null];o.push.apply(o,a);var l=Function.bind.apply(i,o),u=new l;return s&&E0(u,s.prototype),u},M1.apply(null,arguments)}function nme(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function nM(n){var e=typeof Map=="function"?new Map:void 0;return nM=function(r){if(r===null||!nme(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(r))return e.get(r);e.set(r,i)}function i(){return M1(r,arguments,tM(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),E0(i,r)},nM(n)}var rme=/%[sdj%]/g,ime=function(){};typeof process<"u"&&process.env;function rM(n){if(!n||!n.length)return null;var e={};return n.forEach(function(t){var r=t.field;e[r]=e[r]||[],e[r].push(t)}),e}function Cs(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var i=0,a=t.length;if(typeof n=="function")return n.apply(null,t);if(typeof n=="string"){var s=n.replace(rme,function(o){if(o==="%%")return"%";if(i>=a)return o;switch(o){case"%s":return String(t[i++]);case"%d":return Number(t[i++]);case"%j":try{return JSON.stringify(t[i++])}catch{return"[Circular]"}break;default:return o}});return s}return n}function ame(n){return n==="string"||n==="url"||n==="hex"||n==="email"||n==="date"||n==="pattern"}function Mi(n,e){return!!(n==null||e==="array"&&Array.isArray(n)&&!n.length||ame(e)&&typeof n=="string"&&!n)}function sme(n,e,t){var r=[],i=0,a=n.length;function s(o){r.push.apply(r,o||[]),i++,i===a&&t(r)}n.forEach(function(o){e(o,s)})}function sB(n,e,t){var r=0,i=n.length;function a(s){if(s&&s.length){t(s);return}var o=r;r=r+1,o<i?e(n[o],a):t([])}a([])}function ome(n){var e=[];return Object.keys(n).forEach(function(t){e.push.apply(e,n[t]||[])}),e}var oB=function(n){eme(e,n);function e(t,r){var i;return i=n.call(this,"Async Validation Error")||this,i.errors=t,i.fields=r,i}return e}(nM(Error));function lme(n,e,t,r,i){if(e.first){var a=new Promise(function(h,d){var p=function(v){return r(v),v.length?d(new oB(v,rM(v))):h(i)},m=ome(n);sB(m,t,p)});return a.catch(function(h){return h}),a}var s=e.firstFields===!0?Object.keys(n):e.firstFields||[],o=Object.keys(n),l=o.length,u=0,c=[],f=new Promise(function(h,d){var p=function(g){if(c.push.apply(c,g),u++,u===l)return r(c),c.length?d(new oB(c,rM(c))):h(i)};o.length||(r(c),h(i)),o.forEach(function(m){var g=n[m];s.indexOf(m)!==-1?sB(g,t,p):sme(g,t,p)})});return f.catch(function(h){return h}),f}function ume(n){return!!(n&&n.message!==void 0)}function cme(n,e){for(var t=n,r=0;r<e.length;r++){if(t==null)return t;t=t[e[r]]}return t}function lB(n,e){return function(t){var r;return n.fullFields?r=cme(e,n.fullFields):r=e[t.field||n.fullField],ume(t)?(t.field=t.field||n.fullField,t.fieldValue=r,t):{message:typeof t=="function"?t():t,fieldValue:r,field:t.field||n.fullField}}}function uB(n,e){if(e){for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];typeof r=="object"&&typeof n[t]=="object"?n[t]=$h({},n[t],r):n[t]=r}}return n}var h9=function(e,t,r,i,a,s){e.required&&(!r.hasOwnProperty(e.field)||Mi(t,s||e.type))&&i.push(Cs(a.messages.required,e.fullField))},fme=function(e,t,r,i,a){(/^\s+$/.test(t)||t==="")&&i.push(Cs(a.messages.whitespace,e.fullField))},Ax,hme=function(){if(Ax)return Ax;var n="[a-fA-F\\d:]",e=function(b){return b&&b.includeBoundaries?"(?:(?<=\\s|^)(?="+n+")|(?<="+n+")(?=\\s|$))":""},t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",i=(`
(?:
(?:`+r+":){7}(?:"+r+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+r+":){6}(?:"+t+"|:"+r+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+r+":){5}(?::"+t+"|(?::"+r+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+r+":){4}(?:(?::"+r+"){0,1}:"+t+"|(?::"+r+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+r+":){3}(?:(?::"+r+"){0,2}:"+t+"|(?::"+r+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+r+":){2}(?:(?::"+r+"){0,3}:"+t+"|(?::"+r+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+r+":){1}(?:(?::"+r+"){0,4}:"+t+"|(?::"+r+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+r+"){0,5}:"+t+"|(?::"+r+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=new RegExp("(?:^"+t+"$)|(?:^"+i+"$)"),s=new RegExp("^"+t+"$"),o=new RegExp("^"+i+"$"),l=function(b){return b&&b.exact?a:new RegExp("(?:"+e(b)+t+e(b)+")|(?:"+e(b)+i+e(b)+")","g")};l.v4=function(x){return x&&x.exact?s:new RegExp(""+e(x)+t+e(x),"g")},l.v6=function(x){return x&&x.exact?o:new RegExp(""+e(x)+i+e(x),"g")};var u="(?:(?:[a-z]+:)?//)",c="(?:\\S+(?::\\S*)?@)?",f=l.v4().source,h=l.v6().source,d="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",p="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",m="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",g="(?::\\d{2,5})?",v='(?:[/?#][^\\s"]*)?',_="(?:"+u+"|www\\.)"+c+"(?:localhost|"+f+"|"+h+"|"+d+p+m+")"+g+v;return Ax=new RegExp("(?:^"+_+"$)","i"),Ax},cB={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},hy={integer:function(e){return hy.number(e)&&parseInt(e,10)===e},float:function(e){return hy.number(e)&&!hy.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return typeof e=="object"&&!hy.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(cB.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(hme())},hex:function(e){return typeof e=="string"&&!!e.match(cB.hex)}},dme=function(e,t,r,i,a){if(e.required&&t===void 0){h9(e,t,r,i,a);return}var s=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=e.type;s.indexOf(o)>-1?hy[o](t)||i.push(Cs(a.messages.types[o],e.fullField,e.type)):o&&typeof t!==e.type&&i.push(Cs(a.messages.types[o],e.fullField,e.type))},pme=function(e,t,r,i,a){var s=typeof e.len=="number",o=typeof e.min=="number",l=typeof e.max=="number",u=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,c=t,f=null,h=typeof t=="number",d=typeof t=="string",p=Array.isArray(t);if(h?f="number":d?f="string":p&&(f="array"),!f)return!1;p&&(c=t.length),d&&(c=t.replace(u,"_").length),s?c!==e.len&&i.push(Cs(a.messages[f].len,e.fullField,e.len)):o&&!l&&c<e.min?i.push(Cs(a.messages[f].min,e.fullField,e.min)):l&&!o&&c>e.max?i.push(Cs(a.messages[f].max,e.fullField,e.max)):o&&l&&(c<e.min||c>e.max)&&i.push(Cs(a.messages[f].range,e.fullField,e.min,e.max))},hp="enum",mme=function(e,t,r,i,a){e[hp]=Array.isArray(e[hp])?e[hp]:[],e[hp].indexOf(t)===-1&&i.push(Cs(a.messages[hp],e.fullField,e[hp].join(", ")))},gme=function(e,t,r,i,a){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||i.push(Cs(a.messages.pattern.mismatch,e.fullField,t,e.pattern));else if(typeof e.pattern=="string"){var s=new RegExp(e.pattern);s.test(t)||i.push(Cs(a.messages.pattern.mismatch,e.fullField,t,e.pattern))}}},zn={required:h9,whitespace:fme,type:dme,range:pme,enum:mme,pattern:gme},vme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t,"string")&&!e.required)return r();zn.required(e,t,i,s,a,"string"),Mi(t,"string")||(zn.type(e,t,i,s,a),zn.range(e,t,i,s,a),zn.pattern(e,t,i,s,a),e.whitespace===!0&&zn.whitespace(e,t,i,s,a))}r(s)},yme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&zn.type(e,t,i,s,a)}r(s)},_me=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(t===""&&(t=void 0),Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&(zn.type(e,t,i,s,a),zn.range(e,t,i,s,a))}r(s)},xme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&zn.type(e,t,i,s,a)}r(s)},bme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),Mi(t)||zn.type(e,t,i,s,a)}r(s)},wme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&(zn.type(e,t,i,s,a),zn.range(e,t,i,s,a))}r(s)},Sme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&(zn.type(e,t,i,s,a),zn.range(e,t,i,s,a))}r(s)},Tme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(t==null&&!e.required)return r();zn.required(e,t,i,s,a,"array"),t!=null&&(zn.type(e,t,i,s,a),zn.range(e,t,i,s,a))}r(s)},Cme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&zn.type(e,t,i,s,a)}r(s)},Eme="enum",Ame=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a),t!==void 0&&zn[Eme](e,t,i,s,a)}r(s)},Mme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t,"string")&&!e.required)return r();zn.required(e,t,i,s,a),Mi(t,"string")||zn.pattern(e,t,i,s,a)}r(s)},kme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t,"date")&&!e.required)return r();if(zn.required(e,t,i,s,a),!Mi(t,"date")){var l;t instanceof Date?l=t:l=new Date(t),zn.type(e,l,i,s,a),l&&zn.range(e,l.getTime(),i,s,a)}}r(s)},Rme=function(e,t,r,i,a){var s=[],o=Array.isArray(t)?"array":typeof t;zn.required(e,t,i,s,a,o),r(s)},XC=function(e,t,r,i,a){var s=e.type,o=[],l=e.required||!e.required&&i.hasOwnProperty(e.field);if(l){if(Mi(t,s)&&!e.required)return r();zn.required(e,t,i,o,a,s),Mi(t,s)||zn.type(e,t,i,o,a)}r(o)},Pme=function(e,t,r,i,a){var s=[],o=e.required||!e.required&&i.hasOwnProperty(e.field);if(o){if(Mi(t)&&!e.required)return r();zn.required(e,t,i,s,a)}r(s)},zy={string:vme,method:yme,number:_me,boolean:xme,regexp:bme,integer:wme,float:Sme,array:Tme,object:Cme,enum:Ame,pattern:Mme,date:kme,url:XC,hex:XC,email:XC,required:Rme,any:Pme};function iM(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var aM=iM(),x_=function(){function n(t){this.rules=null,this._messages=aM,this.define(t)}var e=n.prototype;return e.define=function(r){var i=this;if(!r)throw new Error("Cannot configure a schema with no rules");if(typeof r!="object"||Array.isArray(r))throw new Error("Rules must be an object");this.rules={},Object.keys(r).forEach(function(a){var s=r[a];i.rules[a]=Array.isArray(s)?s:[s]})},e.messages=function(r){return r&&(this._messages=uB(iM(),r)),this._messages},e.validate=function(r,i,a){var s=this;i===void 0&&(i={}),a===void 0&&(a=function(){});var o=r,l=i,u=a;if(typeof l=="function"&&(u=l,l={}),!this.rules||Object.keys(this.rules).length===0)return u&&u(null,o),Promise.resolve(o);function c(m){var g=[],v={};function _(b){if(Array.isArray(b)){var S;g=(S=g).concat.apply(S,b)}else g.push(b)}for(var x=0;x<m.length;x++)_(m[x]);g.length?(v=rM(g),u(g,v)):u(null,o)}if(l.messages){var f=this.messages();f===aM&&(f=iM()),uB(f,l.messages),l.messages=f}else l.messages=this.messages();var h={},d=l.keys||Object.keys(this.rules);d.forEach(function(m){var g=s.rules[m],v=o[m];g.forEach(function(_){var x=_;typeof x.transform=="function"&&(o===r&&(o=$h({},o)),v=o[m]=x.transform(v)),typeof x=="function"?x={validator:x}:x=$h({},x),x.validator=s.getValidationMethod(x),x.validator&&(x.field=m,x.fullField=x.fullField||m,x.type=s.getType(x),h[m]=h[m]||[],h[m].push({rule:x,value:v,source:o,field:m}))})});var p={};return lme(h,l,function(m,g){var v=m.rule,_=(v.type==="object"||v.type==="array")&&(typeof v.fields=="object"||typeof v.defaultField=="object");_=_&&(v.required||!v.required&&m.value),v.field=m.field;function x(T,M){return $h({},M,{fullField:v.fullField+"."+T,fullFields:v.fullFields?[].concat(v.fullFields,[T]):[T]})}function b(T){T===void 0&&(T=[]);var M=Array.isArray(T)?T:[T];!l.suppressWarning&&M.length&&n.warning("async-validator:",M),M.length&&v.message!==void 0&&(M=[].concat(v.message));var C=M.map(lB(v,o));if(l.first&&C.length)return p[v.field]=1,g(C);if(!_)g(C);else{if(v.required&&!m.value)return v.message!==void 0?C=[].concat(v.message).map(lB(v,o)):l.error&&(C=[l.error(v,Cs(l.messages.required,v.field))]),g(C);var k={};v.defaultField&&Object.keys(m.value).map(function(N){k[N]=v.defaultField}),k=$h({},k,m.rule.fields);var R={};Object.keys(k).forEach(function(N){var L=k[N],F=Array.isArray(L)?L:[L];R[N]=F.map(x.bind(null,N))});var P=new n(R);P.messages(l.messages),m.rule.options&&(m.rule.options.messages=l.messages,m.rule.options.error=l.error),P.validate(m.value,m.rule.options||l,function(N){var L=[];C&&C.length&&L.push.apply(L,C),N&&N.length&&L.push.apply(L,N),g(L.length?L:null)})}}var S;if(v.asyncValidator)S=v.asyncValidator(v,m.value,b,m.source,l);else if(v.validator){try{S=v.validator(v,m.value,b,m.source,l)}catch(T){console.error==null||console.error(T),l.suppressValidatorError||setTimeout(function(){throw T},0),b(T.message)}S===!0?b():S===!1?b(typeof v.message=="function"?v.message(v.fullField||v.field):v.message||(v.fullField||v.field)+" fails"):S instanceof Array?b(S):S instanceof Error&&b(S.message)}S&&S.then&&S.then(function(){return b()},function(T){return b(T)})},function(m){c(m)},o)},e.getType=function(r){if(r.type===void 0&&r.pattern instanceof RegExp&&(r.type="pattern"),typeof r.validator!="function"&&r.type&&!zy.hasOwnProperty(r.type))throw new Error(Cs("Unknown rule type %s",r.type));return r.type||"string"},e.getValidationMethod=function(r){if(typeof r.validator=="function")return r.validator;var i=Object.keys(r),a=i.indexOf("message");return a!==-1&&i.splice(a,1),i.length===1&&i[0]==="required"?zy.required:zy[this.getType(r)]||void 0},n}();x_.register=function(e,t){if(typeof t!="function")throw new Error("Cannot register a validator by type, validator is not a function");zy[e]=t};x_.warning=ime;x_.messages=aM;x_.validators=zy;const Ime=["","error","validating","success"],Dme=vr({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:on([String,Array])},required:{type:Boolean,default:void 0},rules:{type:on([Object,Array])},error:String,validateStatus:{type:String,values:Ime},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:CP}}),fB="ElLabelWrap";var Lme=Dt({name:fB,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(n,{slots:e}){const t=$n(Dg,void 0),r=$n(hd);r||S0(fB,"usage: <el-form-item><label-wrap /></el-form-item>");const i=Tn("form"),a=It(),s=It(0),o=()=>{var c;if((c=a.value)!=null&&c.firstElementChild){const f=window.getComputedStyle(a.value.firstElementChild).width;return Math.ceil(Number.parseFloat(f))}else return 0},l=(c="update")=>{ua(()=>{e.default&&n.isAutoWidth&&(c==="update"?s.value=o():c==="remove"&&(t==null||t.deregisterLabelWidth(s.value)))})},u=()=>l("update");return Ii(()=>{u()}),cs(()=>{l("remove")}),tP(()=>u()),Sn(s,(c,f)=>{n.updateAll&&(t==null||t.registerLabelWidth(c,f))}),jS(Le(()=>{var c,f;return(f=(c=a.value)==null?void 0:c.firstElementChild)!=null?f:null}),u),()=>{var c,f;if(!e)return null;const{isAutoWidth:h}=n;if(h){const d=t==null?void 0:t.autoLabelWidth,p=r==null?void 0:r.hasLabel,m={};if(p&&d&&d!=="auto"){const g=Math.max(0,Number.parseInt(d,10)-s.value),v=t.labelPosition==="left"?"marginRight":"marginLeft";g&&(m[v]=`${g}px`)}return Pn("div",{ref:a,class:[i.be("item","label-wrap")],style:m},[(c=e.default)==null?void 0:c.call(e)])}else return Pn(hr,{ref:a},[(f=e.default)==null?void 0:f.call(e)])}}});const Nme=["role","aria-labelledby"],Ome=Dt({name:"ElFormItem"}),$me=Dt({...Ome,props:Dme,setup(n,{expose:e}){const t=n,r=v_(),i=$n(Dg,void 0),a=$n(hd,void 0),s=eT(void 0,{formItem:!1}),o=Tn("form-item"),l=$P().value,u=It([]),c=It(""),f=eoe(c,100),h=It(""),d=It();let p,m=!1;const g=Le(()=>{if((i==null?void 0:i.labelPosition)==="top")return{};const me=QA(t.labelWidth||(i==null?void 0:i.labelWidth)||"");return me?{width:me}:{}}),v=Le(()=>{if((i==null?void 0:i.labelPosition)==="top"||i!=null&&i.inline)return{};if(!t.label&&!t.labelWidth&&k)return{};const me=QA(t.labelWidth||(i==null?void 0:i.labelWidth)||"");return!t.label&&!r.label?{marginLeft:me}:{}}),_=Le(()=>[o.b(),o.m(s.value),o.is("error",c.value==="error"),o.is("validating",c.value==="validating"),o.is("success",c.value==="success"),o.is("required",F.value||t.required),o.is("no-asterisk",i==null?void 0:i.hideRequiredAsterisk),(i==null?void 0:i.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[o.m("feedback")]:i==null?void 0:i.statusIcon}]),x=Le(()=>YS(t.inlineMessage)?t.inlineMessage:(i==null?void 0:i.inlineMessage)||!1),b=Le(()=>[o.e("error"),{[o.em("error","inline")]:x.value}]),S=Le(()=>t.prop?_n(t.prop)?t.prop:t.prop.join("."):""),T=Le(()=>!!(t.label||r.label)),M=Le(()=>t.for||u.value.length===1?u.value[0]:void 0),C=Le(()=>!M.value&&T.value),k=!!a,R=Le(()=>{const me=i==null?void 0:i.model;if(!(!me||!t.prop))return jC(me,t.prop).value}),P=Le(()=>{const{required:me}=t,Se=[];t.rules&&Se.push(...b0(t.rules));const Me=i==null?void 0:i.rules;if(Me&&t.prop){const ke=jC(Me,t.prop).value;ke&&Se.push(...b0(ke))}if(me!==void 0){const ke=Se.map((He,ee)=>[He,ee]).filter(([He])=>Object.keys(He).includes("required"));if(ke.length>0)for(const[He,ee]of ke)He.required!==me&&(Se[ee]={...He,required:me});else Se.push({required:me})}return Se}),N=Le(()=>P.value.length>0),L=me=>P.value.filter(Me=>!Me.trigger||!me?!0:Array.isArray(Me.trigger)?Me.trigger.includes(me):Me.trigger===me).map(({trigger:Me,...ke})=>ke),F=Le(()=>P.value.some(me=>me.required)),O=Le(()=>{var me;return f.value==="error"&&t.showMessage&&((me=i==null?void 0:i.showMessage)!=null?me:!0)}),B=Le(()=>`${t.label||""}${(i==null?void 0:i.labelSuffix)||""}`),H=me=>{c.value=me},j=me=>{var Se,Me;const{errors:ke,fields:He}=me;(!ke||!He)&&console.error(me),H("error"),h.value=ke?(Me=(Se=ke==null?void 0:ke[0])==null?void 0:Se.message)!=null?Me:`${t.prop} is required`:"",i==null||i.emit("validate",t.prop,!1,h.value)},K=()=>{H("success"),i==null||i.emit("validate",t.prop,!0,"")},J=async me=>{const Se=S.value;return new x_({[Se]:me}).validate({[Se]:R.value},{firstFields:!0}).then(()=>(K(),!0)).catch(ke=>(j(ke),Promise.reject(ke)))},re=async(me,Se)=>{if(m||!t.prop)return!1;const Me=rn(Se);if(!N.value)return Se==null||Se(!1),!1;const ke=L(me);return ke.length===0?(Se==null||Se(!0),!0):(H("validating"),J(ke).then(()=>(Se==null||Se(!0),!0)).catch(He=>{const{fields:ee}=He;return Se==null||Se(!1,ee),Me?!1:Promise.reject(ee)}))},se=()=>{H(""),h.value="",m=!1},Ae=async()=>{const me=i==null?void 0:i.model;if(!me||!t.prop)return;const Se=jC(me,t.prop);m=!0,Se.value=VF(p),await ua(),se(),m=!1},Ee=me=>{u.value.includes(me)||u.value.push(me)},Ne=me=>{u.value=u.value.filter(Se=>Se!==me)};Sn(()=>t.error,me=>{h.value=me||"",H(me?"error":"")},{immediate:!0}),Sn(()=>t.validateStatus,me=>H(me||""));const we=bo({...YR(t),$el:d,size:s,validateState:c,labelId:l,inputIds:u,isGroup:C,hasLabel:T,addInputId:Ee,removeInputId:Ne,resetField:Ae,clearValidate:se,validate:re});return Ci(hd,we),Ii(()=>{t.prop&&(i==null||i.addField(we),p=VF(R.value))}),cs(()=>{i==null||i.removeField(we)}),e({size:s,validateMessage:h,validateState:c,validate:re,clearValidate:se,resetField:Ae}),(me,Se)=>{var Me;return at(),kt("div",{ref_key:"formItemRef",ref:d,class:Et(Q(_)),role:Q(C)?"group":void 0,"aria-labelledby":Q(C)?Q(l):void 0},[Pn(Q(Lme),{"is-auto-width":Q(g).width==="auto","update-all":((Me=Q(i))==null?void 0:Me.labelWidth)==="auto"},{default:An(()=>[Q(T)?(at(),On(ro(Q(M)?"label":"div"),{key:0,id:Q(l),for:Q(M),class:Et(Q(o).e("label")),style:ui(Q(g))},{default:An(()=>[en(me.$slots,"label",{label:Q(B)},()=>[ef(pi(Q(B)),1)])]),_:3},8,["id","for","class","style"])):Nn("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),cn("div",{class:Et(Q(o).e("content")),style:ui(Q(v))},[en(me.$slots,"default"),Pn(Nae,{name:`${Q(o).namespace.value}-zoom-in-top`},{default:An(()=>[Q(O)?en(me.$slots,"error",{key:0,error:h.value},()=>[cn("div",{class:Et(Q(b))},pi(h.value),3)]):Nn("v-if",!0)]),_:3},8,["name"])],6)],10,Nme)}}});var d9=Yn($me,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const prt=wa(Jpe,{FormItem:d9}),mrt=il(d9);let Mo;const Fme=`
  height:0 !important;
  visibility:hidden !important;
  ${hoe()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Bme=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Ume(n){const e=window.getComputedStyle(n),t=e.getPropertyValue("box-sizing"),r=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),i=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:Bme.map(s=>`${s}:${e.getPropertyValue(s)}`).join(";"),paddingSize:r,borderSize:i,boxSizing:t}}function hB(n,e=1,t){var r;Mo||(Mo=document.createElement("textarea"),document.body.appendChild(Mo));const{paddingSize:i,borderSize:a,boxSizing:s,contextStyle:o}=Ume(n);Mo.setAttribute("style",`${o};${Fme}`),Mo.value=n.value||n.placeholder||"";let l=Mo.scrollHeight;const u={};s==="border-box"?l=l+a:s==="content-box"&&(l=l-i),Mo.value="";const c=Mo.scrollHeight-i;if(el(e)){let f=c*e;s==="border-box"&&(f=f+i+a),l=Math.max(f,l),u.minHeight=`${f}px`}if(el(t)){let f=c*t;s==="border-box"&&(f=f+i+a),l=Math.min(f,l)}return u.height=`${l}px`,(r=Mo.parentNode)==null||r.removeChild(Mo),Mo=void 0,u}const zme=vr({id:{type:String,default:void 0},size:o9,disabled:Boolean,modelValue:{type:on([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:on([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Pu},prefixIcon:{type:Pu},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:on([Object,Array,String]),default:()=>Au({})}}),Vme={[fd]:n=>_n(n),input:n=>_n(n),change:n=>_n(n),focus:n=>n instanceof FocusEvent,blur:n=>n instanceof FocusEvent,clear:()=>!0,mouseleave:n=>n instanceof MouseEvent,mouseenter:n=>n instanceof MouseEvent,keydown:n=>n instanceof Event,compositionstart:n=>n instanceof CompositionEvent,compositionupdate:n=>n instanceof CompositionEvent,compositionend:n=>n instanceof CompositionEvent},Hme=["role"],Wme=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],Gme=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],jme=Dt({name:"ElInput",inheritAttrs:!1}),qme=Dt({...jme,props:zme,emits:Vme,setup(n,{expose:e,emit:t}){const r=n,i=Nie(),a=v_(),s=Le(()=>{const fe={};return r.containerRole==="combobox"&&(fe["aria-haspopup"]=i["aria-haspopup"],fe["aria-owns"]=i["aria-owns"],fe["aria-expanded"]=i["aria-expanded"]),fe}),o=Le(()=>[r.type==="textarea"?g.b():m.b(),m.m(d.value),m.is("disabled",p.value),m.is("exceed",re.value),{[m.b("group")]:a.prepend||a.append,[m.bm("group","append")]:a.append,[m.bm("group","prepend")]:a.prepend,[m.m("prefix")]:a.prefix||r.prefixIcon,[m.m("suffix")]:a.suffix||r.suffixIcon||r.clearable||r.showPassword,[m.bm("suffix","password-clear")]:H.value&&j.value},i.class]),l=Le(()=>[m.e("wrapper"),m.is("focus",x.value)]),u=gde({excludeKeys:Le(()=>Object.keys(s.value))}),{form:c,formItem:f}=f9(),{inputId:h}=Gpe(r,{formItemContext:f}),d=eT(),p=BP(),m=Tn("input"),g=Tn("textarea"),v=Py(),_=Py(),x=It(!1),b=It(!1),S=It(!1),T=It(!1),M=It(),C=Py(r.inputStyle),k=Le(()=>v.value||_.value),R=Le(()=>{var fe;return(fe=c==null?void 0:c.statusIcon)!=null?fe:!1}),P=Le(()=>(f==null?void 0:f.validateState)||""),N=Le(()=>P.value&&fde[P.value]),L=Le(()=>T.value?rde:The),F=Le(()=>[i.style,r.inputStyle]),O=Le(()=>[r.inputStyle,C.value,{resize:r.resize}]),B=Le(()=>jm(r.modelValue)?"":String(r.modelValue)),H=Le(()=>r.clearable&&!p.value&&!r.readonly&&!!B.value&&(x.value||b.value)),j=Le(()=>r.showPassword&&!p.value&&!r.readonly&&!!B.value&&(!!B.value||x.value)),K=Le(()=>r.showWordLimit&&!!u.value.maxlength&&(r.type==="text"||r.type==="textarea")&&!p.value&&!r.readonly&&!r.showPassword),J=Le(()=>B.value.length),re=Le(()=>!!K.value&&J.value>Number(u.value.maxlength)),se=Le(()=>!!a.suffix||!!r.suffixIcon||H.value||r.showPassword||K.value||!!P.value&&R.value),[Ae,Ee]=$pe(v);jS(_,fe=>{if(me(),!K.value||r.resize!=="both")return;const Be=fe[0],{width:Xe}=Be.contentRect;M.value={right:`calc(100% - ${Xe+15+6}px)`}});const Ne=()=>{const{type:fe,autosize:Be}=r;if(!(!ya||fe!=="textarea"||!_.value))if(Be){const Xe=Fn(Be)?Be.minRows:void 0,st=Fn(Be)?Be.maxRows:void 0,mt=hB(_.value,Xe,st);C.value={overflowY:"hidden",...mt},ua(()=>{_.value.offsetHeight,C.value=mt})}else C.value={minHeight:hB(_.value).minHeight}},me=(fe=>{let Be=!1;return()=>{var Xe;if(Be||!r.autosize)return;((Xe=_.value)==null?void 0:Xe.offsetParent)===null||(fe(),Be=!0)}})(Ne),Se=()=>{const fe=k.value;!fe||fe.value===B.value||(fe.value=B.value)},Me=async fe=>{Ae();let{value:Be}=fe.target;if(r.formatter&&(Be=r.parser?r.parser(Be):Be,Be=r.formatter(Be)),!S.value){if(Be===B.value){Se();return}t(fd,Be),t("input",Be),await ua(),Se(),Ee()}},ke=fe=>{t("change",fe.target.value)},He=fe=>{t("compositionstart",fe),S.value=!0},ee=fe=>{var Be;t("compositionupdate",fe);const Xe=(Be=fe.target)==null?void 0:Be.value,st=Xe[Xe.length-1]||"";S.value=!dde(st)},ie=fe=>{t("compositionend",fe),S.value&&(S.value=!1,Me(fe))},xe=()=>{T.value=!T.value,Ve()},Ve=async()=>{var fe;await ua(),(fe=k.value)==null||fe.focus()},Ge=()=>{var fe;return(fe=k.value)==null?void 0:fe.blur()},Ze=fe=>{x.value=!0,t("focus",fe)},ut=fe=>{var Be;x.value=!1,t("blur",fe),r.validateEvent&&((Be=f==null?void 0:f.validate)==null||Be.call(f,"blur").catch(Xe=>void 0))},Qe=fe=>{b.value=!1,t("mouseleave",fe)},ve=fe=>{b.value=!0,t("mouseenter",fe)},Ke=fe=>{t("keydown",fe)},ne=()=>{var fe;(fe=k.value)==null||fe.select()},Z=()=>{t(fd,""),t("change",""),t("clear"),t("input","")};return Sn(()=>r.modelValue,()=>{var fe;ua(()=>Ne()),r.validateEvent&&((fe=f==null?void 0:f.validate)==null||fe.call(f,"change").catch(Be=>void 0))}),Sn(B,()=>Se()),Sn(()=>r.type,async()=>{await ua(),Se(),Ne()}),Ii(()=>{!r.formatter&&r.parser,Se(),ua(Ne)}),e({input:v,textarea:_,ref:k,textareaStyle:O,autosize:Go(r,"autosize"),focus:Ve,blur:Ge,select:ne,clear:Z,resizeTextarea:Ne}),(fe,Be)=>Cf((at(),kt("div",ji(Q(s),{class:Q(o),style:Q(F),role:fe.containerRole,onMouseenter:ve,onMouseleave:Qe}),[Nn(" input "),fe.type!=="textarea"?(at(),kt(hr,{key:0},[Nn(" prepend slot "),fe.$slots.prepend?(at(),kt("div",{key:0,class:Et(Q(m).be("group","prepend"))},[en(fe.$slots,"prepend")],2)):Nn("v-if",!0),cn("div",{class:Et(Q(l))},[Nn(" prefix slot "),fe.$slots.prefix||fe.prefixIcon?(at(),kt("span",{key:0,class:Et(Q(m).e("prefix"))},[cn("span",{class:Et(Q(m).e("prefix-inner")),onClick:Ve},[en(fe.$slots,"prefix"),fe.prefixIcon?(at(),On(Q(Ss),{key:0,class:Et(Q(m).e("icon"))},{default:An(()=>[(at(),On(ro(fe.prefixIcon)))]),_:1},8,["class"])):Nn("v-if",!0)],2)],2)):Nn("v-if",!0),cn("input",ji({id:Q(h),ref_key:"input",ref:v,class:Q(m).e("inner")},Q(u),{type:fe.showPassword?T.value?"text":"password":fe.type,disabled:Q(p),formatter:fe.formatter,parser:fe.parser,readonly:fe.readonly,autocomplete:fe.autocomplete,tabindex:fe.tabindex,"aria-label":fe.label,placeholder:fe.placeholder,style:fe.inputStyle,form:r.form,onCompositionstart:He,onCompositionupdate:ee,onCompositionend:ie,onInput:Me,onFocus:Ze,onBlur:ut,onChange:ke,onKeydown:Ke}),null,16,Wme),Nn(" suffix slot "),Q(se)?(at(),kt("span",{key:1,class:Et(Q(m).e("suffix"))},[cn("span",{class:Et(Q(m).e("suffix-inner")),onClick:Ve},[!Q(H)||!Q(j)||!Q(K)?(at(),kt(hr,{key:0},[en(fe.$slots,"suffix"),fe.suffixIcon?(at(),On(Q(Ss),{key:0,class:Et(Q(m).e("icon"))},{default:An(()=>[(at(),On(ro(fe.suffixIcon)))]),_:1},8,["class"])):Nn("v-if",!0)],64)):Nn("v-if",!0),Q(H)?(at(),On(Q(Ss),{key:1,class:Et([Q(m).e("icon"),Q(m).e("clear")]),onMousedown:uP(Q(va),["prevent"]),onClick:Z},{default:An(()=>[Pn(Q(SP))]),_:1},8,["class","onMousedown"])):Nn("v-if",!0),Q(j)?(at(),On(Q(Ss),{key:2,class:Et([Q(m).e("icon"),Q(m).e("password")]),onClick:xe},{default:An(()=>[(at(),On(ro(Q(L))))]),_:1},8,["class"])):Nn("v-if",!0),Q(K)?(at(),kt("span",{key:3,class:Et(Q(m).e("count"))},[cn("span",{class:Et(Q(m).e("count-inner"))},pi(Q(J))+" / "+pi(Q(u).maxlength),3)],2)):Nn("v-if",!0),Q(P)&&Q(N)&&Q(R)?(at(),On(Q(Ss),{key:4,class:Et([Q(m).e("icon"),Q(m).e("validateIcon"),Q(m).is("loading",Q(P)==="validating")])},{default:An(()=>[(at(),On(ro(Q(N))))]),_:1},8,["class"])):Nn("v-if",!0)],2)],2)):Nn("v-if",!0)],2),Nn(" append slot "),fe.$slots.append?(at(),kt("div",{key:1,class:Et(Q(m).be("group","append"))},[en(fe.$slots,"append")],2)):Nn("v-if",!0)],64)):(at(),kt(hr,{key:1},[Nn(" textarea "),cn("textarea",ji({id:Q(h),ref_key:"textarea",ref:_,class:Q(g).e("inner")},Q(u),{tabindex:fe.tabindex,disabled:Q(p),readonly:fe.readonly,autocomplete:fe.autocomplete,style:Q(O),"aria-label":fe.label,placeholder:fe.placeholder,form:r.form,onCompositionstart:He,onCompositionupdate:ee,onCompositionend:ie,onInput:Me,onFocus:Ze,onBlur:ut,onChange:ke,onKeydown:Ke}),null,16,Gme),Q(K)?(at(),kt("span",{key:0,style:ui(M.value),class:Et(Q(m).e("count"))},pi(Q(J))+" / "+pi(Q(u).maxlength),7)):Nn("v-if",!0)],64))],16,Hme)),[[Dd,fe.type!=="hidden"]])}});var Xme=Yn(qme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const grt=wa(Xme),UP=Symbol("popper"),p9=Symbol("popperContent"),Kme=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],m9=vr({role:{type:String,values:Kme,default:"tooltip"}}),Yme=Dt({name:"ElPopper",inheritAttrs:!1}),Zme=Dt({...Yme,props:m9,setup(n,{expose:e}){const t=n,r=It(),i=It(),a=It(),s=It(),o=Le(()=>t.role),l={triggerRef:r,popperInstanceRef:i,contentRef:a,referenceRef:s,role:o};return e(l),Ci(UP,l),(u,c)=>en(u.$slots,"default")}});var Qme=Yn(Zme,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const g9=vr({arrowOffset:{type:Number,default:5}}),Jme=Dt({name:"ElPopperArrow",inheritAttrs:!1}),ege=Dt({...Jme,props:g9,setup(n,{expose:e}){const t=n,r=Tn("popper"),{arrowOffset:i,arrowRef:a,arrowStyle:s}=$n(p9,void 0);return Sn(()=>t.arrowOffset,o=>{i.value=o}),cs(()=>{a.value=void 0}),e({arrowRef:a}),(o,l)=>(at(),kt("span",{ref_key:"arrowRef",ref:a,class:Et(Q(r).e("arrow")),style:ui(Q(s)),"data-popper-arrow":""},null,6))}});var tge=Yn(ege,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const nge="ElOnlyChild",rge=Dt({name:nge,setup(n,{slots:e,attrs:t}){var r;const i=$n(r9),a=Ope((r=i==null?void 0:i.setForwardRef)!=null?r:va);return()=>{var s;const o=(s=e.default)==null?void 0:s.call(e,t);if(!o||o.length>1)return null;const l=v9(o);return l?Cf(Wu(l,t),[[a]]):null}}});function v9(n){if(!n)return null;const e=n;for(const t of e){if(Fn(t))switch(t.type){case Ms:continue;case kg:case"svg":return dB(t);case hr:return v9(t.children);default:return t}return dB(t)}return null}function dB(n){const e=Tn("only-child");return Pn("span",{class:e.e("content")},[n])}const y9=vr({virtualRef:{type:on(Object)},virtualTriggering:Boolean,onMouseenter:{type:on(Function)},onMouseleave:{type:on(Function)},onClick:{type:on(Function)},onKeydown:{type:on(Function)},onFocus:{type:on(Function)},onBlur:{type:on(Function)},onContextmenu:{type:on(Function)},id:String,open:Boolean}),ige=Dt({name:"ElPopperTrigger",inheritAttrs:!1}),age=Dt({...ige,props:y9,setup(n,{expose:e}){const t=n,{role:r,triggerRef:i}=$n(UP,void 0);Npe(i);const a=Le(()=>o.value?t.id:void 0),s=Le(()=>{if(r&&r.value==="tooltip")return t.open&&t.id?t.id:void 0}),o=Le(()=>{if(r&&r.value!=="tooltip")return r.value}),l=Le(()=>o.value?`${t.open}`:void 0);let u;return Ii(()=>{Sn(()=>t.virtualRef,c=>{c&&(i.value=Wc(c))},{immediate:!0}),Sn(i,(c,f)=>{u==null||u(),u=void 0,w0(c)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(h=>{var d;const p=t[h];p&&(c.addEventListener(h.slice(2).toLowerCase(),p),(d=f==null?void 0:f.removeEventListener)==null||d.call(f,h.slice(2).toLowerCase(),p))}),u=Sn([a,s,o,l],h=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((d,p)=>{jm(h[p])?c.removeAttribute(d):c.setAttribute(d,h[p])})},{immediate:!0})),w0(f)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(h=>f.removeAttribute(h))},{immediate:!0})}),cs(()=>{u==null||u(),u=void 0}),e({triggerRef:i}),(c,f)=>c.virtualTriggering?Nn("v-if",!0):(at(),On(Q(rge),ji({key:0},c.$attrs,{"aria-controls":Q(a),"aria-describedby":Q(s),"aria-expanded":Q(l),"aria-haspopup":Q(o)}),{default:An(()=>[en(c.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var sge=Yn(age,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const KC="focus-trap.focus-after-trapped",YC="focus-trap.focus-after-released",oge="focus-trap.focusout-prevented",pB={cancelable:!0,bubbles:!1},lge={cancelable:!0,bubbles:!1},mB="focusAfterTrapped",gB="focusAfterReleased",uge=Symbol("elFocusTrap"),zP=It(),tT=It(0),VP=It(0);let Mx=0;const _9=n=>{const e=[],t=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0||r===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e},vB=(n,e)=>{for(const t of n)if(!cge(t,e))return t},cge=(n,e)=>{if(getComputedStyle(n).visibility==="hidden")return!0;for(;n;){if(e&&n===e)return!1;if(getComputedStyle(n).display==="none")return!0;n=n.parentElement}return!1},fge=n=>{const e=_9(n),t=vB(e,n),r=vB(e.reverse(),n);return[t,r]},hge=n=>n instanceof HTMLInputElement&&"select"in n,Lc=(n,e)=>{if(n&&n.focus){const t=document.activeElement;n.focus({preventScroll:!0}),VP.value=window.performance.now(),n!==t&&hge(n)&&e&&n.select()}};function yB(n,e){const t=[...n],r=n.indexOf(e);return r!==-1&&t.splice(r,1),t}const dge=()=>{let n=[];return{push:r=>{const i=n[0];i&&r!==i&&i.pause(),n=yB(n,r),n.unshift(r)},remove:r=>{var i,a;n=yB(n,r),(a=(i=n[0])==null?void 0:i.resume)==null||a.call(i)}}},pge=(n,e=!1)=>{const t=document.activeElement;for(const r of n)if(Lc(r,e),document.activeElement!==t)return},_B=dge(),mge=()=>tT.value>VP.value,kx=()=>{zP.value="pointer",tT.value=window.performance.now()},xB=()=>{zP.value="keyboard",tT.value=window.performance.now()},gge=()=>(Ii(()=>{Mx===0&&(document.addEventListener("mousedown",kx),document.addEventListener("touchstart",kx),document.addEventListener("keydown",xB)),Mx++}),cs(()=>{Mx--,Mx<=0&&(document.removeEventListener("mousedown",kx),document.removeEventListener("touchstart",kx),document.removeEventListener("keydown",xB))}),{focusReason:zP,lastUserFocusTimestamp:tT,lastAutomatedFocusTimestamp:VP}),Rx=n=>new CustomEvent(oge,{...lge,detail:n}),vge=Dt({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[mB,gB,"focusin","focusout","focusout-prevented","release-requested"],setup(n,{emit:e}){const t=It();let r,i;const{focusReason:a}=gge();Rpe(p=>{n.trapped&&!s.paused&&e("release-requested",p)});const s={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},o=p=>{if(!n.loop&&!n.trapped||s.paused)return;const{key:m,altKey:g,ctrlKey:v,metaKey:_,currentTarget:x,shiftKey:b}=p,{loop:S}=n,T=m===Na.tab&&!g&&!v&&!_,M=document.activeElement;if(T&&M){const C=x,[k,R]=fge(C);if(k&&R){if(!b&&M===R){const N=Rx({focusReason:a.value});e("focusout-prevented",N),N.defaultPrevented||(p.preventDefault(),S&&Lc(k,!0))}else if(b&&[k,C].includes(M)){const N=Rx({focusReason:a.value});e("focusout-prevented",N),N.defaultPrevented||(p.preventDefault(),S&&Lc(R,!0))}}else if(M===C){const N=Rx({focusReason:a.value});e("focusout-prevented",N),N.defaultPrevented||p.preventDefault()}}};Ci(uge,{focusTrapRef:t,onKeydown:o}),Sn(()=>n.focusTrapEl,p=>{p&&(t.value=p)},{immediate:!0}),Sn([t],([p],[m])=>{p&&(p.addEventListener("keydown",o),p.addEventListener("focusin",c),p.addEventListener("focusout",f)),m&&(m.removeEventListener("keydown",o),m.removeEventListener("focusin",c),m.removeEventListener("focusout",f))});const l=p=>{e(mB,p)},u=p=>e(gB,p),c=p=>{const m=Q(t);if(!m)return;const g=p.target,v=p.relatedTarget,_=g&&m.contains(g);n.trapped||v&&m.contains(v)||(r=v),_&&e("focusin",p),!s.paused&&n.trapped&&(_?i=g:Lc(i,!0))},f=p=>{const m=Q(t);if(!(s.paused||!m))if(n.trapped){const g=p.relatedTarget;!jm(g)&&!m.contains(g)&&setTimeout(()=>{if(!s.paused&&n.trapped){const v=Rx({focusReason:a.value});e("focusout-prevented",v),v.defaultPrevented||Lc(i,!0)}},0)}else{const g=p.target;g&&m.contains(g)||e("focusout",p)}};async function h(){await ua();const p=Q(t);if(p){_B.push(s);const m=p.contains(document.activeElement)?r:document.activeElement;if(r=m,!p.contains(m)){const v=new Event(KC,pB);p.addEventListener(KC,l),p.dispatchEvent(v),v.defaultPrevented||ua(()=>{let _=n.focusStartEl;_n(_)||(Lc(_),document.activeElement!==_&&(_="first")),_==="first"&&pge(_9(p),!0),(document.activeElement===m||_==="container")&&Lc(p)})}}}function d(){const p=Q(t);if(p){p.removeEventListener(KC,l);const m=new CustomEvent(YC,{...pB,detail:{focusReason:a.value}});p.addEventListener(YC,u),p.dispatchEvent(m),!m.defaultPrevented&&(a.value=="keyboard"||!mge()||p.contains(document.activeElement))&&Lc(r??document.body),p.removeEventListener(YC,l),_B.remove(s)}}return Ii(()=>{n.trapped&&h(),Sn(()=>n.trapped,p=>{p?h():d()})}),cs(()=>{n.trapped&&d()}),{onKeydown:o}}});function yge(n,e,t,r,i,a){return en(n.$slots,"default",{handleKeydown:n.onKeydown})}var _ge=Yn(vge,[["render",yge],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const xge=["fixed","absolute"],bge=vr({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:on(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:kP,default:"bottom"},popperOptions:{type:on(Object),default:()=>({})},strategy:{type:String,values:xge,default:"absolute"}}),x9=vr({...bge,id:String,style:{type:on([String,Array,Object])},className:{type:on([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:on([String,Array,Object])},popperStyle:{type:on([String,Array,Object])},referenceEl:{type:on(Object)},triggerTargetEl:{type:on(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),wge={mouseenter:n=>n instanceof MouseEvent,mouseleave:n=>n instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},Sge=(n,e=[])=>{const{placement:t,strategy:r,popperOptions:i}=n,a={placement:t,strategy:r,...i,modifiers:[...Cge(n),...e]};return Ege(a,i==null?void 0:i.modifiers),a},Tge=n=>{if(ya)return Wc(n)};function Cge(n){const{offset:e,gpuAcceleration:t,fallbackPlacements:r}=n;return[{name:"offset",options:{offset:[0,e??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:r}},{name:"computeStyles",options:{gpuAcceleration:t}}]}function Ege(n,e){e&&(n.modifiers=[...n.modifiers,...e??[]])}const Age=0,Mge=n=>{const{popperInstanceRef:e,contentRef:t,triggerRef:r,role:i}=$n(UP,void 0),a=It(),s=It(),o=Le(()=>({name:"eventListeners",enabled:!!n.visible})),l=Le(()=>{var v;const _=Q(a),x=(v=Q(s))!=null?v:Age;return{name:"arrow",enabled:!Efe(_),options:{element:_,padding:x}}}),u=Le(()=>({onFirstUpdate:()=>{p()},...Sge(n,[Q(l),Q(o)])})),c=Le(()=>Tge(n.referenceEl)||Q(r)),{attributes:f,state:h,styles:d,update:p,forceUpdate:m,instanceRef:g}=Epe(c,t,u);return Sn(g,v=>e.value=v),Ii(()=>{Sn(()=>{var v;return(v=Q(c))==null?void 0:v.getBoundingClientRect()},()=>{p()})}),{attributes:f,arrowRef:a,contentRef:t,instanceRef:g,state:h,styles:d,role:i,forceUpdate:m,update:p}},kge=(n,{attributes:e,styles:t,role:r})=>{const{nextZIndex:i}=s9(),a=Tn("popper"),s=Le(()=>Q(e).popper),o=It(n.zIndex||i()),l=Le(()=>[a.b(),a.is("pure",n.pure),a.is(n.effect),n.popperClass]),u=Le(()=>[{zIndex:Q(o)},n.popperStyle||{},Q(t).popper]),c=Le(()=>r.value==="dialog"?"false":void 0),f=Le(()=>Q(t).arrow||{});return{ariaModal:c,arrowStyle:f,contentAttrs:s,contentClass:l,contentStyle:u,contentZIndex:o,updateZIndex:()=>{o.value=n.zIndex||i()}}},Rge=(n,e)=>{const t=It(!1),r=It();return{focusStartRef:r,trapped:t,onFocusAfterReleased:u=>{var c;((c=u.detail)==null?void 0:c.focusReason)!=="pointer"&&(r.value="first",e("blur"))},onFocusAfterTrapped:()=>{e("focus")},onFocusInTrap:u=>{n.visible&&!t.value&&(u.target&&(r.value=u.target),t.value=!0)},onFocusoutPrevented:u=>{n.trapping||(u.detail.focusReason==="pointer"&&u.preventDefault(),t.value=!1)},onReleaseRequested:()=>{t.value=!1,e("close")}}},Pge=Dt({name:"ElPopperContent"}),Ige=Dt({...Pge,props:x9,emits:wge,setup(n,{expose:e,emit:t}){const r=n,{focusStartRef:i,trapped:a,onFocusAfterReleased:s,onFocusAfterTrapped:o,onFocusInTrap:l,onFocusoutPrevented:u,onReleaseRequested:c}=Rge(r,t),{attributes:f,arrowRef:h,contentRef:d,styles:p,instanceRef:m,role:g,update:v}=Mge(r),{ariaModal:_,arrowStyle:x,contentAttrs:b,contentClass:S,contentStyle:T,updateZIndex:M}=kge(r,{styles:p,attributes:f,role:g}),C=$n(hd,void 0),k=It();Ci(p9,{arrowStyle:x,arrowRef:h,arrowOffset:k}),C&&(C.addInputId||C.removeInputId)&&Ci(hd,{...C,addInputId:va,removeInputId:va});let R;const P=(L=!0)=>{v(),L&&M()},N=()=>{P(!1),r.visible&&r.focusOnShow?a.value=!0:r.visible===!1&&(a.value=!1)};return Ii(()=>{Sn(()=>r.triggerTargetEl,(L,F)=>{R==null||R(),R=void 0;const O=Q(L||d.value),B=Q(F||d.value);w0(O)&&(R=Sn([g,()=>r.ariaLabel,_,()=>r.id],H=>{["role","aria-label","aria-modal","id"].forEach((j,K)=>{jm(H[K])?O.removeAttribute(j):O.setAttribute(j,H[K])})},{immediate:!0})),B!==O&&w0(B)&&["role","aria-label","aria-modal","id"].forEach(H=>{B.removeAttribute(H)})},{immediate:!0}),Sn(()=>r.visible,N,{immediate:!0})}),cs(()=>{R==null||R(),R=void 0}),e({popperContentRef:d,popperInstanceRef:m,updatePopper:P,contentStyle:T}),(L,F)=>(at(),kt("div",ji({ref_key:"contentRef",ref:d},Q(b),{style:Q(T),class:Q(S),tabindex:"-1",onMouseenter:F[0]||(F[0]=O=>L.$emit("mouseenter",O)),onMouseleave:F[1]||(F[1]=O=>L.$emit("mouseleave",O))}),[Pn(Q(_ge),{trapped:Q(a),"trap-on-focus-in":!0,"focus-trap-el":Q(d),"focus-start-el":Q(i),onFocusAfterTrapped:Q(o),onFocusAfterReleased:Q(s),onFocusin:Q(l),onFocusoutPrevented:Q(u),onReleaseRequested:Q(c)},{default:An(()=>[en(L.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var Dge=Yn(Ige,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const Lge=wa(Qme),HP=Symbol("elTooltip"),b9=vr({...Dpe,...x9,appendTo:{type:on([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:on(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),w9=vr({...y9,disabled:Boolean,trigger:{type:on([String,Array]),default:"hover"},triggerKeys:{type:on(Array),default:()=>[Na.enter,Na.space]}}),{useModelToggleProps:Nge,useModelToggleEmits:Oge,useModelToggle:$ge}=V8("visible"),Fge=vr({...m9,...Nge,...b9,...w9,...g9,showArrow:{type:Boolean,default:!0}}),Bge=[...Oge,"before-show","before-hide","show","hide","open","close"],Uge=(n,e)=>Ht(n)?n.includes(e):n===e,dp=(n,e,t)=>r=>{Uge(Q(n),e)&&t(r)},zge=Dt({name:"ElTooltipTrigger"}),Vge=Dt({...zge,props:w9,setup(n,{expose:e}){const t=n,r=Tn("tooltip"),{controlled:i,id:a,open:s,onOpen:o,onClose:l,onToggle:u}=$n(HP,void 0),c=It(null),f=()=>{if(Q(i)||t.disabled)return!0},h=Go(t,"trigger"),d=Su(f,dp(h,"hover",o)),p=Su(f,dp(h,"hover",l)),m=Su(f,dp(h,"click",b=>{b.button===0&&u(b)})),g=Su(f,dp(h,"focus",o)),v=Su(f,dp(h,"focus",l)),_=Su(f,dp(h,"contextmenu",b=>{b.preventDefault(),u(b)})),x=Su(f,b=>{const{code:S}=b;t.triggerKeys.includes(S)&&(b.preventDefault(),u(b))});return e({triggerRef:c}),(b,S)=>(at(),On(Q(sge),{id:Q(a),"virtual-ref":b.virtualRef,open:Q(s),"virtual-triggering":b.virtualTriggering,class:Et(Q(r).e("trigger")),onBlur:Q(v),onClick:Q(m),onContextmenu:Q(_),onFocus:Q(g),onMouseenter:Q(d),onMouseleave:Q(p),onKeydown:Q(x)},{default:An(()=>[en(b.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var Hge=Yn(Vge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const Wge=Dt({name:"ElTooltipContent",inheritAttrs:!1}),Gge=Dt({...Wge,props:b9,setup(n,{expose:e}){const t=n,{selector:r}=n9(),i=Tn("tooltip"),a=It(null),s=It(!1),{controlled:o,id:l,open:u,trigger:c,onClose:f,onOpen:h,onShow:d,onHide:p,onBeforeShow:m,onBeforeHide:g}=$n(HP,void 0),v=Le(()=>t.transition||`${i.namespace.value}-fade-in-linear`),_=Le(()=>t.persistent);cs(()=>{s.value=!0});const x=Le(()=>Q(_)?!0:Q(u)),b=Le(()=>t.disabled?!1:Q(u)),S=Le(()=>t.appendTo||r.value),T=Le(()=>{var H;return(H=t.style)!=null?H:{}}),M=Le(()=>!Q(u)),C=()=>{p()},k=()=>{if(Q(o))return!0},R=Su(k,()=>{t.enterable&&Q(c)==="hover"&&h()}),P=Su(k,()=>{Q(c)==="hover"&&f()}),N=()=>{var H,j;(j=(H=a.value)==null?void 0:H.updatePopper)==null||j.call(H),m==null||m()},L=()=>{g==null||g()},F=()=>{d(),B=noe(Le(()=>{var H;return(H=a.value)==null?void 0:H.popperContentRef}),()=>{if(Q(o))return;Q(c)!=="hover"&&f()})},O=()=>{t.virtualTriggering||f()};let B;return Sn(()=>Q(u),H=>{H||B==null||B()},{flush:"post"}),Sn(()=>t.content,()=>{var H,j;(j=(H=a.value)==null?void 0:H.updatePopper)==null||j.call(H)}),e({contentRef:a}),(H,j)=>(at(),On(eae,{disabled:!H.teleported,to:Q(S)},[Pn(Ef,{name:Q(v),onAfterLeave:C,onBeforeEnter:N,onAfterEnter:F,onBeforeLeave:L},{default:An(()=>[Q(x)?Cf((at(),On(Q(Dge),ji({key:0,id:Q(l),ref_key:"contentRef",ref:a},H.$attrs,{"aria-label":H.ariaLabel,"aria-hidden":Q(M),"boundaries-padding":H.boundariesPadding,"fallback-placements":H.fallbackPlacements,"gpu-acceleration":H.gpuAcceleration,offset:H.offset,placement:H.placement,"popper-options":H.popperOptions,strategy:H.strategy,effect:H.effect,enterable:H.enterable,pure:H.pure,"popper-class":H.popperClass,"popper-style":[H.popperStyle,Q(T)],"reference-el":H.referenceEl,"trigger-target-el":H.triggerTargetEl,visible:Q(b),"z-index":H.zIndex,onMouseenter:Q(R),onMouseleave:Q(P),onBlur:O,onClose:Q(f)}),{default:An(()=>[s.value?Nn("v-if",!0):en(H.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Dd,Q(b)]]):Nn("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var jge=Yn(Gge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const qge=["innerHTML"],Xge={key:1},Kge=Dt({name:"ElTooltip"}),Yge=Dt({...Kge,props:Fge,emits:Bge,setup(n,{expose:e,emit:t}){const r=n;Ipe();const i=$P(),a=It(),s=It(),o=()=>{var v;const _=Q(a);_&&((v=_.popperInstanceRef)==null||v.update())},l=It(!1),u=It(),{show:c,hide:f,hasUpdateHandler:h}=$ge({indicator:l,toggleReason:u}),{onOpen:d,onClose:p}=Lpe({showAfter:Go(r,"showAfter"),hideAfter:Go(r,"hideAfter"),autoClose:Go(r,"autoClose"),open:c,close:f}),m=Le(()=>YS(r.visible)&&!h.value);Ci(HP,{controlled:m,id:i,open:OS(l),trigger:Go(r,"trigger"),onOpen:v=>{d(v)},onClose:v=>{p(v)},onToggle:v=>{Q(l)?p(v):d(v)},onShow:()=>{t("show",u.value)},onHide:()=>{t("hide",u.value)},onBeforeShow:()=>{t("before-show",u.value)},onBeforeHide:()=>{t("before-hide",u.value)},updatePopper:o}),Sn(()=>r.disabled,v=>{v&&l.value&&(l.value=!1)});const g=()=>{var v,_;const x=(_=(v=s.value)==null?void 0:v.contentRef)==null?void 0:_.popperContentRef;return x&&x.contains(document.activeElement)};return mG(()=>l.value&&f()),e({popperRef:a,contentRef:s,isFocusInsideContent:g,updatePopper:o,onOpen:d,onClose:p,hide:f}),(v,_)=>(at(),On(Q(Lge),{ref_key:"popperRef",ref:a,role:v.role},{default:An(()=>[Pn(Hge,{disabled:v.disabled,trigger:v.trigger,"trigger-keys":v.triggerKeys,"virtual-ref":v.virtualRef,"virtual-triggering":v.virtualTriggering},{default:An(()=>[v.$slots.default?en(v.$slots,"default",{key:0}):Nn("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Pn(jge,{ref_key:"contentRef",ref:s,"aria-label":v.ariaLabel,"boundaries-padding":v.boundariesPadding,content:v.content,disabled:v.disabled,effect:v.effect,enterable:v.enterable,"fallback-placements":v.fallbackPlacements,"hide-after":v.hideAfter,"gpu-acceleration":v.gpuAcceleration,offset:v.offset,persistent:v.persistent,"popper-class":v.popperClass,"popper-style":v.popperStyle,placement:v.placement,"popper-options":v.popperOptions,pure:v.pure,"raw-content":v.rawContent,"reference-el":v.referenceEl,"trigger-target-el":v.triggerTargetEl,"show-after":v.showAfter,strategy:v.strategy,teleported:v.teleported,transition:v.transition,"virtual-triggering":v.virtualTriggering,"z-index":v.zIndex,"append-to":v.appendTo},{default:An(()=>[en(v.$slots,"content",{},()=>[v.rawContent?(at(),kt("span",{key:0,innerHTML:v.content},null,8,qge)):(at(),kt("span",Xge,pi(v.content),1))]),v.showArrow?(at(),On(Q(tge),{key:0,"arrow-offset":v.arrowOffset},null,8,["arrow-offset"])):Nn("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Zge=Yn(Yge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const S9=wa(Zge),Qge=vr({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),Jge=["textContent"],eve=Dt({name:"ElBadge"}),tve=Dt({...eve,props:Qge,setup(n,{expose:e}){const t=n,r=Tn("badge"),i=Le(()=>t.isDot?"":el(t.value)&&el(t.max)?t.max<t.value?`${t.max}+`:`${t.value}`:`${t.value}`);return e({content:i}),(a,s)=>(at(),kt("div",{class:Et(Q(r).b())},[en(a.$slots,"default"),Pn(Ef,{name:`${Q(r).namespace.value}-zoom-in-center`,persisted:""},{default:An(()=>[Cf(cn("sup",{class:Et([Q(r).e("content"),Q(r).em("content",a.type),Q(r).is("fixed",!!a.$slots.default),Q(r).is("dot",a.isDot)]),textContent:pi(Q(i))},null,10,Jge),[[Dd,!a.hidden&&(Q(i)||a.isDot)]])]),_:1},8,["name"])],2))}});var nve=Yn(tve,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const rve=wa(nve),T9=Symbol("buttonGroupContextKey"),ive=(n,e)=>{EP({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},Le(()=>n.type==="text"));const t=$n(T9,void 0),r=FP("button"),{form:i}=f9(),a=eT(Le(()=>t==null?void 0:t.size)),s=BP(),o=It(),l=v_(),u=Le(()=>n.type||(t==null?void 0:t.type)||""),c=Le(()=>{var p,m,g;return(g=(m=n.autoInsertSpace)!=null?m:(p=r.value)==null?void 0:p.autoInsertSpace)!=null?g:!1}),f=Le(()=>n.tag==="button"?{ariaDisabled:s.value||n.loading,disabled:s.value||n.loading,autofocus:n.autofocus,type:n.nativeType}:{}),h=Le(()=>{var p;const m=(p=l.default)==null?void 0:p.call(l);if(c.value&&(m==null?void 0:m.length)===1){const g=m[0];if((g==null?void 0:g.type)===kg){const v=g.children;return/^\p{Unified_Ideograph}{2}$/u.test(v.trim())}}return!1});return{_disabled:s,_size:a,_type:u,_ref:o,_props:f,shouldAddSpace:h,handleClick:p=>{n.nativeType==="reset"&&(i==null||i.resetFields()),e("click",p)}}},ave=["default","primary","success","warning","info","danger","text",""],sve=["button","submit","reset"],sM=vr({size:o9,disabled:Boolean,type:{type:String,values:ave,default:""},icon:{type:Pu},nativeType:{type:String,values:sve,default:"button"},loading:Boolean,loadingIcon:{type:Pu,default:()=>L8},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:on([String,Object]),default:"button"}}),ove={click:n=>n instanceof MouseEvent};function Xi(n,e){lve(n)&&(n="100%");var t=uve(n);return n=e===360?n:Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(String(n*e),10)/100),Math.abs(n-e)<1e-6?1:(e===360?n=(n<0?n%e+e:n%e)/parseFloat(String(e)):n=n%e/parseFloat(String(e)),n)}function Px(n){return Math.min(1,Math.max(0,n))}function lve(n){return typeof n=="string"&&n.indexOf(".")!==-1&&parseFloat(n)===1}function uve(n){return typeof n=="string"&&n.indexOf("%")!==-1}function C9(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function Ix(n){return n<=1?"".concat(Number(n)*100,"%"):n}function Fh(n){return n.length===1?"0"+n:String(n)}function cve(n,e,t){return{r:Xi(n,255)*255,g:Xi(e,255)*255,b:Xi(t,255)*255}}function bB(n,e,t){n=Xi(n,255),e=Xi(e,255),t=Xi(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),a=0,s=0,o=(r+i)/2;if(r===i)s=0,a=0;else{var l=r-i;switch(s=o>.5?l/(2-r-i):l/(r+i),r){case n:a=(e-t)/l+(e<t?6:0);break;case e:a=(t-n)/l+2;break;case t:a=(n-e)/l+4;break}a/=6}return{h:a,s,l:o}}function ZC(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*(6*t):t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function fve(n,e,t){var r,i,a;if(n=Xi(n,360),e=Xi(e,100),t=Xi(t,100),e===0)i=t,a=t,r=t;else{var s=t<.5?t*(1+e):t+e-t*e,o=2*t-s;r=ZC(o,s,n+1/3),i=ZC(o,s,n),a=ZC(o,s,n-1/3)}return{r:r*255,g:i*255,b:a*255}}function wB(n,e,t){n=Xi(n,255),e=Xi(e,255),t=Xi(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),a=0,s=r,o=r-i,l=r===0?0:o/r;if(r===i)a=0;else{switch(r){case n:a=(e-t)/o+(e<t?6:0);break;case e:a=(t-n)/o+2;break;case t:a=(n-e)/o+4;break}a/=6}return{h:a,s:l,v:s}}function hve(n,e,t){n=Xi(n,360)*6,e=Xi(e,100),t=Xi(t,100);var r=Math.floor(n),i=n-r,a=t*(1-e),s=t*(1-i*e),o=t*(1-(1-i)*e),l=r%6,u=[t,s,a,a,o,t][l],c=[o,t,t,s,a,a][l],f=[a,a,o,t,t,s][l];return{r:u*255,g:c*255,b:f*255}}function SB(n,e,t,r){var i=[Fh(Math.round(n).toString(16)),Fh(Math.round(e).toString(16)),Fh(Math.round(t).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function dve(n,e,t,r,i){var a=[Fh(Math.round(n).toString(16)),Fh(Math.round(e).toString(16)),Fh(Math.round(t).toString(16)),Fh(pve(r))];return i&&a[0].startsWith(a[0].charAt(1))&&a[1].startsWith(a[1].charAt(1))&&a[2].startsWith(a[2].charAt(1))&&a[3].startsWith(a[3].charAt(1))?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function pve(n){return Math.round(parseFloat(n)*255).toString(16)}function TB(n){return xs(n)/255}function xs(n){return parseInt(n,16)}function mve(n){return{r:n>>16,g:(n&65280)>>8,b:n&255}}var oM={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function gve(n){var e={r:0,g:0,b:0},t=1,r=null,i=null,a=null,s=!1,o=!1;return typeof n=="string"&&(n=_ve(n)),typeof n=="object"&&(fu(n.r)&&fu(n.g)&&fu(n.b)?(e=cve(n.r,n.g,n.b),s=!0,o=String(n.r).substr(-1)==="%"?"prgb":"rgb"):fu(n.h)&&fu(n.s)&&fu(n.v)?(r=Ix(n.s),i=Ix(n.v),e=hve(n.h,r,i),s=!0,o="hsv"):fu(n.h)&&fu(n.s)&&fu(n.l)&&(r=Ix(n.s),a=Ix(n.l),e=fve(n.h,r,a),s=!0,o="hsl"),Object.prototype.hasOwnProperty.call(n,"a")&&(t=n.a)),t=C9(t),{ok:s,format:n.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}var vve="[-\\+]?\\d+%?",yve="[-\\+]?\\d*\\.\\d+%?",Gc="(?:".concat(yve,")|(?:").concat(vve,")"),QC="[\\s|\\(]+(".concat(Gc,")[,|\\s]+(").concat(Gc,")[,|\\s]+(").concat(Gc,")\\s*\\)?"),JC="[\\s|\\(]+(".concat(Gc,")[,|\\s]+(").concat(Gc,")[,|\\s]+(").concat(Gc,")[,|\\s]+(").concat(Gc,")\\s*\\)?"),Lo={CSS_UNIT:new RegExp(Gc),rgb:new RegExp("rgb"+QC),rgba:new RegExp("rgba"+JC),hsl:new RegExp("hsl"+QC),hsla:new RegExp("hsla"+JC),hsv:new RegExp("hsv"+QC),hsva:new RegExp("hsva"+JC),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function _ve(n){if(n=n.trim().toLowerCase(),n.length===0)return!1;var e=!1;if(oM[n])n=oM[n],e=!0;else if(n==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=Lo.rgb.exec(n);return t?{r:t[1],g:t[2],b:t[3]}:(t=Lo.rgba.exec(n),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=Lo.hsl.exec(n),t?{h:t[1],s:t[2],l:t[3]}:(t=Lo.hsla.exec(n),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=Lo.hsv.exec(n),t?{h:t[1],s:t[2],v:t[3]}:(t=Lo.hsva.exec(n),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=Lo.hex8.exec(n),t?{r:xs(t[1]),g:xs(t[2]),b:xs(t[3]),a:TB(t[4]),format:e?"name":"hex8"}:(t=Lo.hex6.exec(n),t?{r:xs(t[1]),g:xs(t[2]),b:xs(t[3]),format:e?"name":"hex"}:(t=Lo.hex4.exec(n),t?{r:xs(t[1]+t[1]),g:xs(t[2]+t[2]),b:xs(t[3]+t[3]),a:TB(t[4]+t[4]),format:e?"name":"hex8"}:(t=Lo.hex3.exec(n),t?{r:xs(t[1]+t[1]),g:xs(t[2]+t[2]),b:xs(t[3]+t[3]),format:e?"name":"hex"}:!1)))))))))}function fu(n){return!!Lo.CSS_UNIT.exec(String(n))}var E9=function(){function n(e,t){e===void 0&&(e=""),t===void 0&&(t={});var r;if(e instanceof n)return e;typeof e=="number"&&(e=mve(e)),this.originalInput=e;var i=gve(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=(r=t.format)!==null&&r!==void 0?r:i.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return n.prototype.isDark=function(){return this.getBrightness()<128},n.prototype.isLight=function(){return!this.isDark()},n.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},n.prototype.getLuminance=function(){var e=this.toRgb(),t,r,i,a=e.r/255,s=e.g/255,o=e.b/255;return a<=.03928?t=a/12.92:t=Math.pow((a+.055)/1.055,2.4),s<=.03928?r=s/12.92:r=Math.pow((s+.055)/1.055,2.4),o<=.03928?i=o/12.92:i=Math.pow((o+.055)/1.055,2.4),.2126*t+.7152*r+.0722*i},n.prototype.getAlpha=function(){return this.a},n.prototype.setAlpha=function(e){return this.a=C9(e),this.roundA=Math.round(100*this.a)/100,this},n.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},n.prototype.toHsv=function(){var e=wB(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},n.prototype.toHsvString=function(){var e=wB(this.r,this.g,this.b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?"hsv(".concat(t,", ").concat(r,"%, ").concat(i,"%)"):"hsva(".concat(t,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},n.prototype.toHsl=function(){var e=bB(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},n.prototype.toHslString=function(){var e=bB(this.r,this.g,this.b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?"hsl(".concat(t,", ").concat(r,"%, ").concat(i,"%)"):"hsla(".concat(t,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},n.prototype.toHex=function(e){return e===void 0&&(e=!1),SB(this.r,this.g,this.b,e)},n.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},n.prototype.toHex8=function(e){return e===void 0&&(e=!1),dve(this.r,this.g,this.b,this.a,e)},n.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},n.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},n.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},n.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),r=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(t,", ").concat(r,")"):"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(this.roundA,")")},n.prototype.toPercentageRgb=function(){var e=function(t){return"".concat(Math.round(Xi(t,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},n.prototype.toPercentageRgbString=function(){var e=function(t){return Math.round(Xi(t,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},n.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+SB(this.r,this.g,this.b,!1),t=0,r=Object.entries(oM);t<r.length;t++){var i=r[t],a=i[0],s=i[1];if(e===s)return a}return!1},n.prototype.toString=function(e){var t=!!e;e=e??this.format;var r=!1,i=this.a<1&&this.a>=0,a=!t&&i&&(e.startsWith("hex")||e==="name");return a?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},n.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},n.prototype.clone=function(){return new n(this.toString())},n.prototype.lighten=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l+=e/100,t.l=Px(t.l),new n(t)},n.prototype.brighten=function(e){e===void 0&&(e=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),new n(t)},n.prototype.darken=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l-=e/100,t.l=Px(t.l),new n(t)},n.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},n.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},n.prototype.desaturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s-=e/100,t.s=Px(t.s),new n(t)},n.prototype.saturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s+=e/100,t.s=Px(t.s),new n(t)},n.prototype.greyscale=function(){return this.desaturate(100)},n.prototype.spin=function(e){var t=this.toHsl(),r=(t.h+e)%360;return t.h=r<0?360+r:r,new n(t)},n.prototype.mix=function(e,t){t===void 0&&(t=50);var r=this.toRgb(),i=new n(e).toRgb(),a=t/100,s={r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a};return new n(s)},n.prototype.analogous=function(e,t){e===void 0&&(e=6),t===void 0&&(t=30);var r=this.toHsl(),i=360/t,a=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,a.push(new n(r));return a},n.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new n(e)},n.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var t=this.toHsv(),r=t.h,i=t.s,a=t.v,s=[],o=1/e;e--;)s.push(new n({h:r,s:i,v:a})),a=(a+o)%1;return s},n.prototype.splitcomplement=function(){var e=this.toHsl(),t=e.h;return[this,new n({h:(t+72)%360,s:e.s,l:e.l}),new n({h:(t+216)%360,s:e.s,l:e.l})]},n.prototype.onBackground=function(e){var t=this.toRgb(),r=new n(e).toRgb(),i=t.a+r.a*(1-t.a);return new n({r:(t.r*t.a+r.r*r.a*(1-t.a))/i,g:(t.g*t.a+r.g*r.a*(1-t.a))/i,b:(t.b*t.a+r.b*r.a*(1-t.a))/i,a:i})},n.prototype.triad=function(){return this.polyad(3)},n.prototype.tetrad=function(){return this.polyad(4)},n.prototype.polyad=function(e){for(var t=this.toHsl(),r=t.h,i=[this],a=360/e,s=1;s<e;s++)i.push(new n({h:(r+s*a)%360,s:t.s,l:t.l}));return i},n.prototype.equals=function(e){return this.toRgbString()===new n(e).toRgbString()},n}();function yc(n,e=20){return n.mix("#141414",e).toString()}function xve(n){const e=BP(),t=Tn("button");return Le(()=>{let r={};const i=n.color;if(i){const a=new E9(i),s=n.dark?a.tint(20).toString():yc(a,20);if(n.plain)r=t.cssVarBlock({"bg-color":n.dark?yc(a,90):a.tint(90).toString(),"text-color":i,"border-color":n.dark?yc(a,50):a.tint(50).toString(),"hover-text-color":`var(${t.cssVarName("color-white")})`,"hover-bg-color":i,"hover-border-color":i,"active-bg-color":s,"active-text-color":`var(${t.cssVarName("color-white")})`,"active-border-color":s}),e.value&&(r[t.cssVarBlockName("disabled-bg-color")]=n.dark?yc(a,90):a.tint(90).toString(),r[t.cssVarBlockName("disabled-text-color")]=n.dark?yc(a,50):a.tint(50).toString(),r[t.cssVarBlockName("disabled-border-color")]=n.dark?yc(a,80):a.tint(80).toString());else{const o=n.dark?yc(a,30):a.tint(30).toString(),l=a.isDark()?`var(${t.cssVarName("color-white")})`:`var(${t.cssVarName("color-black")})`;if(r=t.cssVarBlock({"bg-color":i,"text-color":l,"border-color":i,"hover-bg-color":o,"hover-text-color":l,"hover-border-color":o,"active-bg-color":s,"active-border-color":s}),e.value){const u=n.dark?yc(a,50):a.tint(50).toString();r[t.cssVarBlockName("disabled-bg-color")]=u,r[t.cssVarBlockName("disabled-text-color")]=n.dark?"rgba(255, 255, 255, 0.5)":`var(${t.cssVarName("color-white")})`,r[t.cssVarBlockName("disabled-border-color")]=u}}}return r})}const bve=Dt({name:"ElButton"}),wve=Dt({...bve,props:sM,emits:ove,setup(n,{expose:e,emit:t}){const r=n,i=xve(r),a=Tn("button"),{_ref:s,_size:o,_type:l,_disabled:u,_props:c,shouldAddSpace:f,handleClick:h}=ive(r,t);return e({ref:s,size:o,type:l,disabled:u,shouldAddSpace:f}),(d,p)=>(at(),On(ro(d.tag),ji({ref_key:"_ref",ref:s},Q(c),{class:[Q(a).b(),Q(a).m(Q(l)),Q(a).m(Q(o)),Q(a).is("disabled",Q(u)),Q(a).is("loading",d.loading),Q(a).is("plain",d.plain),Q(a).is("round",d.round),Q(a).is("circle",d.circle),Q(a).is("text",d.text),Q(a).is("link",d.link),Q(a).is("has-bg",d.bg)],style:Q(i),onClick:Q(h)}),{default:An(()=>[d.loading?(at(),kt(hr,{key:0},[d.$slots.loading?en(d.$slots,"loading",{key:0}):(at(),On(Q(Ss),{key:1,class:Et(Q(a).is("loading"))},{default:An(()=>[(at(),On(ro(d.loadingIcon)))]),_:1},8,["class"]))],64)):d.icon||d.$slots.icon?(at(),On(Q(Ss),{key:1},{default:An(()=>[d.icon?(at(),On(ro(d.icon),{key:0})):en(d.$slots,"icon",{key:1})]),_:3})):Nn("v-if",!0),d.$slots.default?(at(),kt("span",{key:2,class:Et({[Q(a).em("text","expand")]:Q(f)})},[en(d.$slots,"default")],2)):Nn("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Sve=Yn(wve,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const Tve={size:sM.size,type:sM.type},Cve=Dt({name:"ElButtonGroup"}),Eve=Dt({...Cve,props:Tve,setup(n){const e=n;Ci(T9,bo({size:Go(e,"size"),type:Go(e,"type")}));const t=Tn("button");return(r,i)=>(at(),kt("div",{class:Et(`${Q(t).b("group")}`)},[en(r.$slots,"default")],2))}});var A9=Yn(Eve,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const e2=wa(Sve,{ButtonGroup:A9}),Ave=il(A9);var ho=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function b_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Mve(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var a=Function.bind.apply(e,i);return new a}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var M9={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(ho,function(){var t=1e3,r=6e4,i=36e5,a="millisecond",s="second",o="minute",l="hour",u="day",c="week",f="month",h="quarter",d="year",p="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(L){var F=["th","st","nd","rd"],O=L%100;return"["+L+(F[(O-20)%10]||F[O]||F[0])+"]"}},x=function(L,F,O){var B=String(L);return!B||B.length>=F?L:""+Array(F+1-B.length).join(O)+L},b={s:x,z:function(L){var F=-L.utcOffset(),O=Math.abs(F),B=Math.floor(O/60),H=O%60;return(F<=0?"+":"-")+x(B,2,"0")+":"+x(H,2,"0")},m:function L(F,O){if(F.date()<O.date())return-L(O,F);var B=12*(O.year()-F.year())+(O.month()-F.month()),H=F.clone().add(B,f),j=O-H<0,K=F.clone().add(B+(j?-1:1),f);return+(-(B+(O-H)/(j?H-K:K-H))||0)},a:function(L){return L<0?Math.ceil(L)||0:Math.floor(L)},p:function(L){return{M:f,y:d,w:c,d:u,D:p,h:l,m:o,s,ms:a,Q:h}[L]||String(L||"").toLowerCase().replace(/s$/,"")},u:function(L){return L===void 0}},S="en",T={};T[S]=_;var M=function(L){return L instanceof P},C=function L(F,O,B){var H;if(!F)return S;if(typeof F=="string"){var j=F.toLowerCase();T[j]&&(H=j),O&&(T[j]=O,H=j);var K=F.split("-");if(!H&&K.length>1)return L(K[0])}else{var J=F.name;T[J]=F,H=J}return!B&&H&&(S=H),H||!B&&S},k=function(L,F){if(M(L))return L.clone();var O=typeof F=="object"?F:{};return O.date=L,O.args=arguments,new P(O)},R=b;R.l=C,R.i=M,R.w=function(L,F){return k(L,{locale:F.$L,utc:F.$u,x:F.$x,$offset:F.$offset})};var P=function(){function L(O){this.$L=C(O.locale,null,!0),this.parse(O)}var F=L.prototype;return F.parse=function(O){this.$d=function(B){var H=B.date,j=B.utc;if(H===null)return new Date(NaN);if(R.u(H))return new Date;if(H instanceof Date)return new Date(H);if(typeof H=="string"&&!/Z$/i.test(H)){var K=H.match(g);if(K){var J=K[2]-1||0,re=(K[7]||"0").substring(0,3);return j?new Date(Date.UTC(K[1],J,K[3]||1,K[4]||0,K[5]||0,K[6]||0,re)):new Date(K[1],J,K[3]||1,K[4]||0,K[5]||0,K[6]||0,re)}}return new Date(H)}(O),this.$x=O.x||{},this.init()},F.init=function(){var O=this.$d;this.$y=O.getFullYear(),this.$M=O.getMonth(),this.$D=O.getDate(),this.$W=O.getDay(),this.$H=O.getHours(),this.$m=O.getMinutes(),this.$s=O.getSeconds(),this.$ms=O.getMilliseconds()},F.$utils=function(){return R},F.isValid=function(){return this.$d.toString()!==m},F.isSame=function(O,B){var H=k(O);return this.startOf(B)<=H&&H<=this.endOf(B)},F.isAfter=function(O,B){return k(O)<this.startOf(B)},F.isBefore=function(O,B){return this.endOf(B)<k(O)},F.$g=function(O,B,H){return R.u(O)?this[B]:this.set(H,O)},F.unix=function(){return Math.floor(this.valueOf()/1e3)},F.valueOf=function(){return this.$d.getTime()},F.startOf=function(O,B){var H=this,j=!!R.u(B)||B,K=R.p(O),J=function(Se,Me){var ke=R.w(H.$u?Date.UTC(H.$y,Me,Se):new Date(H.$y,Me,Se),H);return j?ke:ke.endOf(u)},re=function(Se,Me){return R.w(H.toDate()[Se].apply(H.toDate("s"),(j?[0,0,0,0]:[23,59,59,999]).slice(Me)),H)},se=this.$W,Ae=this.$M,Ee=this.$D,Ne="set"+(this.$u?"UTC":"");switch(K){case d:return j?J(1,0):J(31,11);case f:return j?J(1,Ae):J(0,Ae+1);case c:var we=this.$locale().weekStart||0,me=(se<we?se+7:se)-we;return J(j?Ee-me:Ee+(6-me),Ae);case u:case p:return re(Ne+"Hours",0);case l:return re(Ne+"Minutes",1);case o:return re(Ne+"Seconds",2);case s:return re(Ne+"Milliseconds",3);default:return this.clone()}},F.endOf=function(O){return this.startOf(O,!1)},F.$set=function(O,B){var H,j=R.p(O),K="set"+(this.$u?"UTC":""),J=(H={},H[u]=K+"Date",H[p]=K+"Date",H[f]=K+"Month",H[d]=K+"FullYear",H[l]=K+"Hours",H[o]=K+"Minutes",H[s]=K+"Seconds",H[a]=K+"Milliseconds",H)[j],re=j===u?this.$D+(B-this.$W):B;if(j===f||j===d){var se=this.clone().set(p,1);se.$d[J](re),se.init(),this.$d=se.set(p,Math.min(this.$D,se.daysInMonth())).$d}else J&&this.$d[J](re);return this.init(),this},F.set=function(O,B){return this.clone().$set(O,B)},F.get=function(O){return this[R.p(O)]()},F.add=function(O,B){var H,j=this;O=Number(O);var K=R.p(B),J=function(Ae){var Ee=k(j);return R.w(Ee.date(Ee.date()+Math.round(Ae*O)),j)};if(K===f)return this.set(f,this.$M+O);if(K===d)return this.set(d,this.$y+O);if(K===u)return J(1);if(K===c)return J(7);var re=(H={},H[o]=r,H[l]=i,H[s]=t,H)[K]||1,se=this.$d.getTime()+O*re;return R.w(se,this)},F.subtract=function(O,B){return this.add(-1*O,B)},F.format=function(O){var B=this,H=this.$locale();if(!this.isValid())return H.invalidDate||m;var j=O||"YYYY-MM-DDTHH:mm:ssZ",K=R.z(this),J=this.$H,re=this.$m,se=this.$M,Ae=H.weekdays,Ee=H.months,Ne=function(Me,ke,He,ee){return Me&&(Me[ke]||Me(B,j))||He[ke].slice(0,ee)},we=function(Me){return R.s(J%12||12,Me,"0")},me=H.meridiem||function(Me,ke,He){var ee=Me<12?"AM":"PM";return He?ee.toLowerCase():ee},Se={YY:String(this.$y).slice(-2),YYYY:this.$y,M:se+1,MM:R.s(se+1,2,"0"),MMM:Ne(H.monthsShort,se,Ee,3),MMMM:Ne(Ee,se),D:this.$D,DD:R.s(this.$D,2,"0"),d:String(this.$W),dd:Ne(H.weekdaysMin,this.$W,Ae,2),ddd:Ne(H.weekdaysShort,this.$W,Ae,3),dddd:Ae[this.$W],H:String(J),HH:R.s(J,2,"0"),h:we(1),hh:we(2),a:me(J,re,!0),A:me(J,re,!1),m:String(re),mm:R.s(re,2,"0"),s:String(this.$s),ss:R.s(this.$s,2,"0"),SSS:R.s(this.$ms,3,"0"),Z:K};return j.replace(v,function(Me,ke){return ke||Se[Me]||K.replace(":","")})},F.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},F.diff=function(O,B,H){var j,K=R.p(B),J=k(O),re=(J.utcOffset()-this.utcOffset())*r,se=this-J,Ae=R.m(this,J);return Ae=(j={},j[d]=Ae/12,j[f]=Ae,j[h]=Ae/3,j[c]=(se-re)/6048e5,j[u]=(se-re)/864e5,j[l]=se/i,j[o]=se/r,j[s]=se/t,j)[K]||se,H?Ae:R.a(Ae)},F.daysInMonth=function(){return this.endOf(f).$D},F.$locale=function(){return T[this.$L]},F.locale=function(O,B){if(!O)return this.$L;var H=this.clone(),j=C(O,B,!0);return j&&(H.$L=j),H},F.clone=function(){return R.w(this.$d,this)},F.toDate=function(){return new Date(this.valueOf())},F.toJSON=function(){return this.isValid()?this.toISOString():null},F.toISOString=function(){return this.$d.toISOString()},F.toString=function(){return this.$d.toUTCString()},L}(),N=P.prototype;return k.prototype=N,[["$ms",a],["$s",s],["$m",o],["$H",l],["$W",u],["$M",f],["$y",d],["$D",p]].forEach(function(L){N[L[1]]=function(F){return this.$g(F,L[0],L[1])}}),k.extend=function(L,F){return L.$i||(L(F,P,k),L.$i=!0),k},k.locale=C,k.isDayjs=M,k.unix=function(L){return k(1e3*L)},k.en=T[S],k.Ls=T,k.p={},k})})(M9);var kve=M9.exports;const Sm=b_(kve),Tm=n=>Array.from(Array.from({length:n}).keys()),Rve=(n,e)=>{const t=n.subtract(1,"month").endOf("month").date();return Tm(e).map((r,i)=>t-(e-i-1))},Pve=n=>{const e=n.daysInMonth();return Tm(e).map((t,r)=>r+1)},Ive=n=>Tm(n.length/7).map(e=>{const t=e*7;return n.slice(t,t+7)}),Dve=vr({selectedDay:{type:on(Object)},range:{type:on(Array)},date:{type:on(Object),required:!0},hideHeader:{type:Boolean}}),Lve={pick:n=>Fn(n)};var k9={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(ho,function(){return function(t,r,i){var a=r.prototype,s=function(f){return f&&(f.indexOf?f:f.s)},o=function(f,h,d,p,m){var g=f.name?f:f.$locale(),v=s(g[h]),_=s(g[d]),x=v||_.map(function(S){return S.slice(0,p)});if(!m)return x;var b=g.weekStart;return x.map(function(S,T){return x[(T+(b||0))%7]})},l=function(){return i.Ls[i.locale()]},u=function(f,h){return f.formats[h]||function(d){return d.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(p,m,g){return m||g.slice(1)})}(f.formats[h.toUpperCase()])},c=function(){var f=this;return{months:function(h){return h?h.format("MMMM"):o(f,"months")},monthsShort:function(h){return h?h.format("MMM"):o(f,"monthsShort","months",3)},firstDayOfWeek:function(){return f.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):o(f,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):o(f,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):o(f,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return u(f.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};a.localeData=function(){return c.bind(this)()},i.localeData=function(){var f=l();return{firstDayOfWeek:function(){return f.weekStart||0},weekdays:function(){return i.weekdays()},weekdaysShort:function(){return i.weekdaysShort()},weekdaysMin:function(){return i.weekdaysMin()},months:function(){return i.months()},monthsShort:function(){return i.monthsShort()},longDateFormat:function(h){return u(f,h)},meridiem:f.meridiem,ordinal:f.ordinal}},i.months=function(){return o(l(),"months")},i.monthsShort=function(){return o(l(),"monthsShort","months",3)},i.weekdays=function(f){return o(l(),"weekdays",null,null,f)},i.weekdaysShort=function(f){return o(l(),"weekdaysShort","weekdays",3,f)},i.weekdaysMin=function(f){return o(l(),"weekdaysMin","weekdays",2,f)}}})})(k9);var Nve=k9.exports;const Ove=b_(Nve),$ve=(n,e)=>{Sm.extend(Ove);const t=Sm.localeData().firstDayOfWeek(),{t:r,lang:i}=QS(),a=Sm().locale(i.value),s=Le(()=>!!n.range&&!!n.range.length),o=Le(()=>{let h=[];if(s.value){const[d,p]=n.range,m=Tm(p.date()-d.date()+1).map(_=>({text:d.date()+_,type:"current"}));let g=m.length%7;g=g===0?0:7-g;const v=Tm(g).map((_,x)=>({text:x+1,type:"next"}));h=m.concat(v)}else{const d=n.date.startOf("month").day(),p=Rve(n.date,(d-t+7)%7).map(_=>({text:_,type:"prev"})),m=Pve(n.date).map(_=>({text:_,type:"current"}));h=[...p,...m];const g=7-(h.length%7||7),v=Tm(g).map((_,x)=>({text:x+1,type:"next"}));h=h.concat(v)}return Ive(h)}),l=Le(()=>{const h=t;return h===0?qC.map(d=>r(`el.datepicker.weeks.${d}`)):qC.slice(h).concat(qC.slice(0,h)).map(d=>r(`el.datepicker.weeks.${d}`))}),u=(h,d)=>{switch(d){case"prev":return n.date.startOf("month").subtract(1,"month").date(h);case"next":return n.date.startOf("month").add(1,"month").date(h);case"current":return n.date.date(h)}};return{now:a,isInRange:s,rows:o,weekDays:l,getFormattedDate:u,handlePickDay:({text:h,type:d})=>{const p=u(h,d);e("pick",p)},getSlotData:({text:h,type:d})=>{const p=u(h,d);return{isSelected:p.isSame(n.selectedDay),type:`${d}-month`,day:p.format("YYYY-MM-DD"),date:p.toDate()}}}},Fve={key:0},Bve=["onClick"],Uve=Dt({name:"DateTable"}),zve=Dt({...Uve,props:Dve,emits:Lve,setup(n,{expose:e,emit:t}){const r=n,{isInRange:i,now:a,rows:s,weekDays:o,getFormattedDate:l,handlePickDay:u,getSlotData:c}=$ve(r,t),f=Tn("calendar-table"),h=Tn("calendar-day"),d=({text:p,type:m})=>{const g=[m];if(m==="current"){const v=l(p,m);v.isSame(r.selectedDay,"day")&&g.push(h.is("selected")),v.isSame(a,"day")&&g.push(h.is("today"))}return g};return e({getFormattedDate:l}),(p,m)=>(at(),kt("table",{class:Et([Q(f).b(),Q(f).is("range",Q(i))]),cellspacing:"0",cellpadding:"0"},[p.hideHeader?Nn("v-if",!0):(at(),kt("thead",Fve,[(at(!0),kt(hr,null,wm(Q(o),g=>(at(),kt("th",{key:g},pi(g),1))),128))])),cn("tbody",null,[(at(!0),kt(hr,null,wm(Q(s),(g,v)=>(at(),kt("tr",{key:v,class:Et({[Q(f).e("row")]:!0,[Q(f).em("row","hide-border")]:v===0&&p.hideHeader})},[(at(!0),kt(hr,null,wm(g,(_,x)=>(at(),kt("td",{key:x,class:Et(d(_)),onClick:b=>Q(u)(_)},[cn("div",{class:Et(Q(h).b())},[en(p.$slots,"date-cell",{data:Q(c)(_)},()=>[cn("span",null,pi(_.text),1)])],2)],10,Bve))),128))],2))),128))])],2))}});var CB=Yn(zve,[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/date-table.vue"]]);const Vve=(n,e)=>{const t=n.endOf("month"),r=e.startOf("month"),a=t.isSame(r,"week")?r.add(1,"week"):r;return[[n,t],[a.startOf("week"),e]]},Hve=(n,e)=>{const t=n.endOf("month"),r=n.add(1,"month").startOf("month"),i=t.isSame(r,"week")?r.add(1,"week"):r,a=i.endOf("month"),s=e.startOf("month"),o=a.isSame(s,"week")?s.add(1,"week"):s;return[[n,t],[i.startOf("week"),a],[o.startOf("week"),e]]},Wve=(n,e,t)=>{const r=v_(),{lang:i}=QS(),a=It(),s=Sm().locale(i.value),o=Le({get(){return n.modelValue?u.value:a.value},set(v){if(!v)return;a.value=v;const _=v.toDate();e(F8,_),e(fd,_)}}),l=Le(()=>{if(!n.range)return[];const v=n.range.map(b=>Sm(b).locale(i.value)),[_,x]=v;return _.isAfter(x)?[]:_.isSame(x,"month")?p(_,x):_.add(1,"month").month()!==x.month()?[]:p(_,x)}),u=Le(()=>n.modelValue?Sm(n.modelValue).locale(i.value):o.value||(l.value.length?l.value[0][0]:s)),c=Le(()=>u.value.subtract(1,"month").date(1)),f=Le(()=>u.value.add(1,"month").date(1)),h=Le(()=>u.value.subtract(1,"year").date(1)),d=Le(()=>u.value.add(1,"year").date(1)),p=(v,_)=>{const x=v.startOf("week"),b=_.endOf("week"),S=x.get("month"),T=b.get("month");return S===T?[[x,b]]:(S+1)%12===T?Vve(x,b):S+2===T||(S+1)%11===T?Hve(x,b):[]},m=v=>{o.value=v},g=v=>{const x={"prev-month":c.value,"next-month":f.value,"prev-year":h.value,"next-year":d.value,today:s}[v];x.isSame(u.value,"day")||m(x)};return EP({from:'"dateCell"',replacement:'"date-cell"',scope:"ElCalendar",version:"2.3.0",ref:"https://element-plus.org/en-US/component/calendar.html#slots",type:"Slot"},Le(()=>!!r.dateCell)),{calculateValidatedDateRange:p,date:u,realSelectedDay:o,pickDay:m,selectDate:g,validatedRange:l}},Gve=n=>Ht(n)&&n.length===2&&n.every(e=>o0(e)),jve=vr({modelValue:{type:Date},range:{type:on(Array),validator:Gve}}),qve={[fd]:n=>o0(n),[F8]:n=>o0(n)},Xve="ElCalendar",Kve=Dt({name:Xve}),Yve=Dt({...Kve,props:jve,emits:qve,setup(n,{expose:e,emit:t}){const r=n,i=Tn("calendar"),{calculateValidatedDateRange:a,date:s,pickDay:o,realSelectedDay:l,selectDate:u,validatedRange:c}=Wve(r,t),{t:f}=QS(),h=Le(()=>{const d=`el.datepicker.month${s.value.format("M")}`;return`${s.value.year()} ${f("el.datepicker.year")} ${f(d)}`});return e({selectedDay:l,pickDay:o,selectDate:u,calculateValidatedDateRange:a}),(d,p)=>(at(),kt("div",{class:Et(Q(i).b())},[cn("div",{class:Et(Q(i).e("header"))},[en(d.$slots,"header",{date:Q(h)},()=>[cn("div",{class:Et(Q(i).e("title"))},pi(Q(h)),3),Q(c).length===0?(at(),kt("div",{key:0,class:Et(Q(i).e("button-group"))},[Pn(Q(Ave),null,{default:An(()=>[Pn(Q(e2),{size:"small",onClick:p[0]||(p[0]=m=>Q(u)("prev-month"))},{default:An(()=>[ef(pi(Q(f)("el.datepicker.prevMonth")),1)]),_:1}),Pn(Q(e2),{size:"small",onClick:p[1]||(p[1]=m=>Q(u)("today"))},{default:An(()=>[ef(pi(Q(f)("el.datepicker.today")),1)]),_:1}),Pn(Q(e2),{size:"small",onClick:p[2]||(p[2]=m=>Q(u)("next-month"))},{default:An(()=>[ef(pi(Q(f)("el.datepicker.nextMonth")),1)]),_:1})]),_:1})],2)):Nn("v-if",!0)])],2),Q(c).length===0?(at(),kt("div",{key:0,class:Et(Q(i).e("body"))},[Pn(CB,{date:Q(s),"selected-day":Q(l),onPick:Q(o)},_$({_:2},[d.$slots["date-cell"]||d.$slots.dateCell?{name:"date-cell",fn:An(m=>[d.$slots["date-cell"]?en(d.$slots,"date-cell",uy(ji({key:0},m))):en(d.$slots,"dateCell",uy(ji({key:1},m)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(at(),kt("div",{key:1,class:Et(Q(i).e("body"))},[(at(!0),kt(hr,null,wm(Q(c),(m,g)=>(at(),On(CB,{key:g,date:m[0],"selected-day":Q(l),range:m,"hide-header":g!==0,onPick:Q(o)},_$({_:2},[d.$slots["date-cell"]||d.$slots.dateCell?{name:"date-cell",fn:An(v=>[d.$slots["date-cell"]?en(d.$slots,"date-cell",uy(ji({key:0},v))):en(d.$slots,"dateCell",uy(ji({key:1},v)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var Zve=Yn(Yve,[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/calendar.vue"]]);const vrt=wa(Zve),Qve=vr({header:{type:String,default:""},bodyStyle:{type:on([String,Object,Array]),default:""},shadow:{type:String,values:["always","hover","never"],default:"always"}}),Jve=Dt({name:"ElCard"}),eye=Dt({...Jve,props:Qve,setup(n){const e=Tn("card");return(t,r)=>(at(),kt("div",{class:Et([Q(e).b(),Q(e).is(`${t.shadow}-shadow`)])},[t.$slots.header||t.header?(at(),kt("div",{key:0,class:Et(Q(e).e("header"))},[en(t.$slots,"header",{},()=>[ef(pi(t.header),1)])],2)):Nn("v-if",!0),cn("div",{class:Et(Q(e).e("body")),style:ui(t.bodyStyle)},[en(t.$slots,"default")],6)],2))}});var tye=Yn(eye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/card/src/card.vue"]]);const yrt=wa(tye),R9=Symbol("rowContextKey"),nye=["start","center","end","space-around","space-between","space-evenly"],rye=["top","middle","bottom"],iye=vr({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:nye,default:"start"},align:{type:String,values:rye,default:"top"}}),aye=Dt({name:"ElRow"}),sye=Dt({...aye,props:iye,setup(n){const e=n,t=Tn("row"),r=Le(()=>e.gutter);Ci(R9,{gutter:r});const i=Le(()=>{const s={};return e.gutter&&(s.marginRight=s.marginLeft=`-${e.gutter/2}px`),s}),a=Le(()=>[t.b(),t.is(`justify-${e.justify}`,e.justify!=="start"),t.is(`align-${e.align}`,e.align!=="top")]);return(s,o)=>(at(),On(ro(s.tag),{class:Et(Q(a)),style:ui(Q(i))},{default:An(()=>[en(s.$slots,"default")]),_:3},8,["class","style"]))}});var oye=Yn(sye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/row/src/row.vue"]]);const _rt=wa(oye),lye=vr({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:on([Number,Object]),default:()=>Au({})},sm:{type:on([Number,Object]),default:()=>Au({})},md:{type:on([Number,Object]),default:()=>Au({})},lg:{type:on([Number,Object]),default:()=>Au({})},xl:{type:on([Number,Object]),default:()=>Au({})}}),uye=Dt({name:"ElCol"}),cye=Dt({...uye,props:lye,setup(n){const e=n,{gutter:t}=$n(R9,{gutter:Le(()=>0)}),r=Tn("col"),i=Le(()=>{const s={};return t.value&&(s.paddingLeft=s.paddingRight=`${t.value/2}px`),s}),a=Le(()=>{const s=[];return["span","offset","pull","push"].forEach(u=>{const c=e[u];el(c)&&(u==="span"?s.push(r.b(`${e[u]}`)):c>0&&s.push(r.b(`${u}-${e[u]}`)))}),["xs","sm","md","lg","xl"].forEach(u=>{el(e[u])?s.push(r.b(`${u}-${e[u]}`)):Fn(e[u])&&Object.entries(e[u]).forEach(([c,f])=>{s.push(c!=="span"?r.b(`${u}-${c}-${f}`):r.b(`${u}-${f}`))})}),t.value&&s.push(r.is("guttered")),[r.b(),s]});return(s,o)=>(at(),On(ro(s.tag),{class:Et(Q(a)),style:ui(Q(i))},{default:An(()=>[en(s.$slots,"default")]),_:3},8,["class","style"]))}});var fye=Yn(cye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/col/src/col.vue"]]);const xrt=wa(fye),EB=n=>typeof el(n),hye=vr({accordion:Boolean,modelValue:{type:on([Array,String,Number]),default:()=>Au([])}}),dye={[fd]:EB,[$8]:EB},P9=Symbol("collapseContextKey"),pye=(n,e)=>{const t=It(b0(n.modelValue)),r=a=>{t.value=a;const s=n.accordion?t.value[0]:t.value;e(fd,s),e($8,s)},i=a=>{if(n.accordion)r([t.value[0]===a?"":a]);else{const s=[...t.value],o=s.indexOf(a);o>-1?s.splice(o,1):s.push(a),r(s)}};return Sn(()=>n.modelValue,()=>t.value=b0(n.modelValue),{deep:!0}),Ci(P9,{activeNames:t,handleItemClick:i}),{activeNames:t,setActiveNames:r}},mye=()=>{const n=Tn("collapse");return{rootKls:Le(()=>n.b())}},gye=Dt({name:"ElCollapse"}),vye=Dt({...gye,props:hye,emits:dye,setup(n,{expose:e,emit:t}){const r=n,{activeNames:i,setActiveNames:a}=pye(r,t),{rootKls:s}=mye();return e({activeNames:i,setActiveNames:a}),(o,l)=>(at(),kt("div",{class:Et(Q(s)),role:"tablist","aria-multiselectable":"true"},[en(o.$slots,"default")],2))}});var yye=Yn(vye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const _ye=Dt({name:"ElCollapseTransition"}),xye=Dt({..._ye,setup(n){const e=Tn("collapse-transition"),t={beforeEnter(r){r.dataset||(r.dataset={}),r.dataset.oldPaddingTop=r.style.paddingTop,r.dataset.oldPaddingBottom=r.style.paddingBottom,r.style.maxHeight=0,r.style.paddingTop=0,r.style.paddingBottom=0},enter(r){r.dataset.oldOverflow=r.style.overflow,r.scrollHeight!==0?(r.style.maxHeight=`${r.scrollHeight}px`,r.style.paddingTop=r.dataset.oldPaddingTop,r.style.paddingBottom=r.dataset.oldPaddingBottom):(r.style.maxHeight=0,r.style.paddingTop=r.dataset.oldPaddingTop,r.style.paddingBottom=r.dataset.oldPaddingBottom),r.style.overflow="hidden"},afterEnter(r){r.style.maxHeight="",r.style.overflow=r.dataset.oldOverflow},beforeLeave(r){r.dataset||(r.dataset={}),r.dataset.oldPaddingTop=r.style.paddingTop,r.dataset.oldPaddingBottom=r.style.paddingBottom,r.dataset.oldOverflow=r.style.overflow,r.style.maxHeight=`${r.scrollHeight}px`,r.style.overflow="hidden"},leave(r){r.scrollHeight!==0&&(r.style.maxHeight=0,r.style.paddingTop=0,r.style.paddingBottom=0)},afterLeave(r){r.style.maxHeight="",r.style.overflow=r.dataset.oldOverflow,r.style.paddingTop=r.dataset.oldPaddingTop,r.style.paddingBottom=r.dataset.oldPaddingBottom}};return(r,i)=>(at(),On(Ef,ji({name:Q(e).b()},Die(t)),{default:An(()=>[en(r.$slots,"default")]),_:3},16,["name"]))}});var k1=Yn(xye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);k1.install=n=>{n.component(k1.name,k1)};const I9=k1,bye=vr({title:{type:String,default:""},name:{type:on([String,Number]),default:()=>B8()},disabled:Boolean}),wye=n=>{const e=$n(P9),t=It(!1),r=It(!1),i=It(B8()),a=Le(()=>e==null?void 0:e.activeNames.value.includes(n.name));return{focusing:t,id:i,isActive:a,handleFocus:()=>{setTimeout(()=>{r.value?r.value=!1:t.value=!0},50)},handleHeaderClick:()=>{n.disabled||(e==null||e.handleItemClick(n.name),t.value=!1,r.value=!0)},handleEnterClick:()=>{e==null||e.handleItemClick(n.name)}}},Sye=(n,{focusing:e,isActive:t,id:r})=>{const i=Tn("collapse"),a=Le(()=>[i.b("item"),i.is("active",Q(t)),i.is("disabled",n.disabled)]),s=Le(()=>[i.be("item","header"),i.is("active",Q(t)),{focusing:Q(e)&&!n.disabled}]),o=Le(()=>[i.be("item","arrow"),i.is("active",Q(t))]),l=Le(()=>i.be("item","wrap")),u=Le(()=>i.be("item","content")),c=Le(()=>i.b(`content-${Q(r)}`)),f=Le(()=>i.b(`head-${Q(r)}`));return{arrowKls:o,headKls:s,rootKls:a,itemWrapperKls:l,itemContentKls:u,scopedContentId:c,scopedHeadId:f}},Tye=["aria-expanded","aria-controls","aria-describedby"],Cye=["id","tabindex"],Eye=["id","aria-hidden","aria-labelledby"],Aye=Dt({name:"ElCollapseItem"}),Mye=Dt({...Aye,props:bye,setup(n,{expose:e}){const t=n,{focusing:r,id:i,isActive:a,handleFocus:s,handleHeaderClick:o,handleEnterClick:l}=wye(t),{arrowKls:u,headKls:c,rootKls:f,itemWrapperKls:h,itemContentKls:d,scopedContentId:p,scopedHeadId:m}=Sye(t,{focusing:r,isActive:a,id:i});return e({isActive:a}),(g,v)=>(at(),kt("div",{class:Et(Q(f))},[cn("div",{role:"tab","aria-expanded":Q(a),"aria-controls":Q(p),"aria-describedby":Q(p)},[cn("div",{id:Q(m),class:Et(Q(c)),role:"button",tabindex:g.disabled?-1:0,onClick:v[0]||(v[0]=(..._)=>Q(o)&&Q(o)(..._)),onKeypress:v[1]||(v[1]=Hae(uP((..._)=>Q(l)&&Q(l)(..._),["stop","prevent"]),["space","enter"])),onFocus:v[2]||(v[2]=(..._)=>Q(s)&&Q(s)(..._)),onBlur:v[3]||(v[3]=_=>r.value=!1)},[en(g.$slots,"title",{},()=>[ef(pi(g.title),1)]),Pn(Q(Ss),{class:Et(Q(u))},{default:An(()=>[Pn(Q(k8))]),_:1},8,["class"])],42,Cye)],8,Tye),Pn(Q(I9),null,{default:An(()=>[Cf(cn("div",{id:Q(p),class:Et(Q(h)),role:"tabpanel","aria-hidden":!Q(a),"aria-labelledby":Q(m)},[cn("div",{class:Et(Q(d))},[en(g.$slots,"default")],2)],10,Eye),[[Dd,Q(a)]])]),_:3})],2))}});var D9=Yn(Mye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const brt=wa(yye,{CollapseItem:D9}),wrt=il(D9),kye=Dt({name:"ElContainer"}),Rye=Dt({...kye,props:{direction:{type:String}},setup(n){const e=n,t=v_(),r=Tn("container"),i=Le(()=>e.direction==="vertical"?!0:e.direction==="horizontal"?!1:t&&t.default?t.default().some(s=>{const o=s.type.name;return o==="ElHeader"||o==="ElFooter"}):!1);return(a,s)=>(at(),kt("section",{class:Et([Q(r).b(),Q(r).is("vertical",Q(i))])},[en(a.$slots,"default")],2))}});var Pye=Yn(Rye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const Iye=Dt({name:"ElAside"}),Dye=Dt({...Iye,props:{width:{type:String,default:null}},setup(n){const e=n,t=Tn("aside"),r=Le(()=>e.width?t.cssVarBlock({width:e.width}):{});return(i,a)=>(at(),kt("aside",{class:Et(Q(t).b()),style:ui(Q(r))},[en(i.$slots,"default")],6))}});var L9=Yn(Dye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const Lye=Dt({name:"ElFooter"}),Nye=Dt({...Lye,props:{height:{type:String,default:null}},setup(n){const e=n,t=Tn("footer"),r=Le(()=>e.height?t.cssVarBlock({height:e.height}):{});return(i,a)=>(at(),kt("footer",{class:Et(Q(t).b()),style:ui(Q(r))},[en(i.$slots,"default")],6))}});var N9=Yn(Nye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const Oye=Dt({name:"ElHeader"}),$ye=Dt({...Oye,props:{height:{type:String,default:null}},setup(n){const e=n,t=Tn("header"),r=Le(()=>e.height?t.cssVarBlock({height:e.height}):{});return(i,a)=>(at(),kt("header",{class:Et(Q(t).b()),style:ui(Q(r))},[en(i.$slots,"default")],6))}});var O9=Yn($ye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const Fye=Dt({name:"ElMain"}),Bye=Dt({...Fye,setup(n){const e=Tn("main");return(t,r)=>(at(),kt("main",{class:Et(Q(e).b())},[en(t.$slots,"default")],2))}});var $9=Yn(Bye,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const Srt=wa(Pye,{Aside:L9,Footer:N9,Header:O9,Main:$9});il(L9);const Trt=il(N9),Crt=il(O9),Ert=il($9);let Uye=class{constructor(e,t){this.parent=e,this.domNode=t,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e}addListeners(){const e=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,t=>{t.addEventListener("keydown",r=>{let i=!1;switch(r.code){case Na.down:{this.gotoSubIndex(this.subIndex+1),i=!0;break}case Na.up:{this.gotoSubIndex(this.subIndex-1),i=!0;break}case Na.tab:{S1(e,"mouseleave");break}case Na.enter:case Na.space:{i=!0,r.currentTarget.click();break}}return i&&(r.preventDefault(),r.stopPropagation()),!1})})}},zye=class{constructor(e,t){this.domNode=e,this.submenu=null,this.submenu=null,this.init(t)}init(e){this.domNode.setAttribute("tabindex","0");const t=this.domNode.querySelector(`.${e}-menu`);t&&(this.submenu=new Uye(this,t)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",e=>{let t=!1;switch(e.code){case Na.down:{S1(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),t=!0;break}case Na.up:{S1(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),t=!0;break}case Na.tab:{S1(e.currentTarget,"mouseleave");break}case Na.enter:case Na.space:{t=!0,e.currentTarget.click();break}}t&&e.preventDefault()})}},Vye=class{constructor(e,t){this.domNode=e,this.init(t)}init(e){const t=this.domNode.childNodes;Array.from(t).forEach(r=>{r.nodeType===1&&new zye(r,e)})}};const Hye=Dt({name:"ElMenuCollapseTransition",setup(){const n=Tn("menu");return{listeners:{onBeforeEnter:t=>t.style.opacity="0.2",onEnter(t,r){lm(t,`${n.namespace.value}-opacity-transition`),t.style.opacity="1",r()},onAfterEnter(t){Kh(t,`${n.namespace.value}-opacity-transition`),t.style.opacity=""},onBeforeLeave(t){t.dataset||(t.dataset={}),Ife(t,n.m("collapse"))?(Kh(t,n.m("collapse")),t.dataset.oldOverflow=t.style.overflow,t.dataset.scrollWidth=t.clientWidth.toString(),lm(t,n.m("collapse"))):(lm(t,n.m("collapse")),t.dataset.oldOverflow=t.style.overflow,t.dataset.scrollWidth=t.clientWidth.toString(),Kh(t,n.m("collapse"))),t.style.width=`${t.scrollWidth}px`,t.style.overflow="hidden"},onLeave(t){lm(t,"horizontal-collapse-transition"),t.style.width=`${t.dataset.scrollWidth}px`}}}}});function Wye(n,e,t,r,i,a){return at(),On(Ef,ji({mode:"out-in"},n.listeners),{default:An(()=>[en(n.$slots,"default")]),_:3},16)}var Gye=Yn(Hye,[["render",Wye],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-collapse-transition.vue"]]);function F9(n,e){const t=Le(()=>{let i=n.parent;const a=[e.value];for(;i.type.name!=="ElMenu";)i.props.index&&a.unshift(i.props.index),i=i.parent;return a});return{parentMenu:Le(()=>{let i=n.parent;for(;i&&!["ElMenu","ElSubMenu"].includes(i.type.name);)i=i.parent;return i}),indexPath:t}}function jye(n){return Le(()=>{const t=n.backgroundColor;return t?new E9(t).shade(20).toString():""})}const B9=(n,e)=>{const t=Tn("menu");return Le(()=>t.cssVarBlock({"text-color":n.textColor||"","hover-text-color":n.textColor||"","bg-color":n.backgroundColor||"","hover-bg-color":jye(n).value||"","active-color":n.activeTextColor||"",level:`${e}`}))},qye=vr({index:{type:String,required:!0},showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0},teleported:{type:Boolean,default:void 0},popperOffset:{type:Number,default:6},expandCloseIcon:{type:Pu},expandOpenIcon:{type:Pu},collapseCloseIcon:{type:Pu},collapseOpenIcon:{type:Pu}}),Dx="ElSubMenu";var WP=Dt({name:Dx,props:qye,setup(n,{slots:e,expose:t}){EP({from:"popper-append-to-body",replacement:"teleported",scope:Dx,version:"2.3.0",ref:"https://element-plus.org/en-US/component/menu.html#submenu-attributes"},Le(()=>n.popperAppendToBody!==void 0));const r=Is(),{indexPath:i,parentMenu:a}=F9(r,Le(()=>n.index)),s=Tn("menu"),o=Tn("sub-menu"),l=$n("rootMenu");l||S0(Dx,"can not inject root menu");const u=$n(`subMenu:${a.value.uid}`);u||S0(Dx,"can not inject sub menu");const c=It({}),f=It({});let h;const d=It(!1),p=It(),m=It(null),g=Le(()=>P.value==="horizontal"&&_.value?"bottom-start":"right-start"),v=Le(()=>P.value==="horizontal"&&_.value||P.value==="vertical"&&!l.props.collapse?n.expandCloseIcon&&n.expandOpenIcon?T.value?n.expandOpenIcon:n.expandCloseIcon:Ffe:n.collapseCloseIcon&&n.collapseOpenIcon?T.value?n.collapseOpenIcon:n.collapseCloseIcon:k8),_=Le(()=>u.level===0),x=Le(()=>{var J;const re=(J=n.teleported)!=null?J:n.popperAppendToBody;return re===void 0?_.value:re}),b=Le(()=>l.props.collapse?`${s.namespace.value}-zoom-in-left`:`${s.namespace.value}-zoom-in-top`),S=Le(()=>P.value==="horizontal"&&_.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","left-start","bottom-start","bottom-end","top-start","top-end"]),T=Le(()=>l.openedMenus.includes(n.index)),M=Le(()=>{let J=!1;return Object.values(c.value).forEach(re=>{re.active&&(J=!0)}),Object.values(f.value).forEach(re=>{re.active&&(J=!0)}),J}),C=Le(()=>l.props.backgroundColor||""),k=Le(()=>l.props.activeTextColor||""),R=Le(()=>l.props.textColor||""),P=Le(()=>l.props.mode),N=bo({index:n.index,indexPath:i,active:M}),L=B9(l.props,u.level+1),F=Le(()=>P.value!=="horizontal"?{color:R.value}:{borderBottomColor:M.value?l.props.activeTextColor?k.value:"":"transparent",color:M.value?k.value:R.value}),O=()=>{var J,re,se;return(se=(re=(J=m.value)==null?void 0:J.popperRef)==null?void 0:re.popperInstanceRef)==null?void 0:se.destroy()},B=J=>{J||O()},H=()=>{l.props.menuTrigger==="hover"&&l.props.mode==="horizontal"||l.props.collapse&&l.props.mode==="vertical"||n.disabled||l.handleSubMenuClick({index:n.index,indexPath:i.value,active:M.value})},j=(J,re=n.showTimeout)=>{var se;J.type!=="focus"&&(l.props.menuTrigger==="click"&&l.props.mode==="horizontal"||!l.props.collapse&&l.props.mode==="vertical"||n.disabled||(u.mouseInChild.value=!0,h==null||h(),{stop:h}=qA(()=>{l.openMenu(n.index,i.value)},re),x.value&&((se=a.value.vnode.el)==null||se.dispatchEvent(new MouseEvent("mouseenter")))))},K=(J=!1)=>{var re,se;l.props.menuTrigger==="click"&&l.props.mode==="horizontal"||!l.props.collapse&&l.props.mode==="vertical"||(h==null||h(),u.mouseInChild.value=!1,{stop:h}=qA(()=>!d.value&&l.closeMenu(n.index,i.value),n.hideTimeout),x.value&&J&&((re=r.parent)==null?void 0:re.type.name)==="ElSubMenu"&&((se=u.handleMouseleave)==null||se.call(u,!0)))};Sn(()=>l.props.collapse,J=>B(!!J));{const J=se=>{f.value[se.index]=se},re=se=>{delete f.value[se.index]};Ci(`subMenu:${r.uid}`,{addSubMenu:J,removeSubMenu:re,handleMouseleave:K,mouseInChild:d,level:u.level+1})}return t({opened:T}),Ii(()=>{l.addSubMenu(N),u.addSubMenu(N)}),cs(()=>{u.removeSubMenu(N),l.removeSubMenu(N)}),()=>{var J;const re=[(J=e.title)==null?void 0:J.call(e),Zr(Ss,{class:o.e("icon-arrow"),style:{transform:T.value?n.expandCloseIcon&&n.expandOpenIcon||n.collapseCloseIcon&&n.collapseOpenIcon&&l.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>_n(v.value)?Zr(r.appContext.components[v.value]):Zr(v.value)})],se=l.isMenuPopup?Zr(S9,{ref:m,visible:T.value,effect:"light",pure:!0,offset:n.popperOffset,showArrow:!1,persistent:!0,popperClass:n.popperClass,placement:g.value,teleported:x.value,fallbackPlacements:S.value,transition:b.value,gpuAcceleration:!1},{content:()=>{var Ae;return Zr("div",{class:[s.m(P.value),s.m("popup-container"),n.popperClass],onMouseenter:Ee=>j(Ee,100),onMouseleave:()=>K(!0),onFocus:Ee=>j(Ee,100)},[Zr("ul",{class:[s.b(),s.m("popup"),s.m(`popup-${g.value}`)],style:L.value},[(Ae=e.default)==null?void 0:Ae.call(e)])])},default:()=>Zr("div",{class:o.e("title"),style:[F.value,{backgroundColor:C.value}],onClick:H},re)}):Zr(hr,{},[Zr("div",{class:o.e("title"),style:[F.value,{backgroundColor:C.value}],ref:p,onClick:H},re),Zr(I9,{},{default:()=>{var Ae;return Cf(Zr("ul",{role:"menu",class:[s.b(),s.m("inline")],style:L.value},[(Ae=e.default)==null?void 0:Ae.call(e)]),[[Dd,T.value]])}})]);return Zr("li",{class:[o.b(),o.is("active",M.value),o.is("opened",T.value),o.is("disabled",n.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:T.value,onMouseenter:j,onMouseleave:()=>K(!0),onFocus:j},[se])}}});const Xye=vr({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:on(Array),default:()=>Au([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperEffect:{type:String,values:["dark","light"],default:"dark"}}),t2=n=>Array.isArray(n)&&n.every(e=>_n(e)),Kye={close:(n,e)=>_n(n)&&t2(e),open:(n,e)=>_n(n)&&t2(e),select:(n,e,t,r)=>_n(n)&&t2(e)&&Fn(t)&&(r===void 0||r instanceof Promise)};var Yye=Dt({name:"ElMenu",props:Xye,emits:Kye,setup(n,{emit:e,slots:t,expose:r}){const i=Is(),a=i.appContext.config.globalProperties.$router,s=It(),o=Tn("menu"),l=Tn("sub-menu"),u=It(-1),c=It(n.defaultOpeneds&&!n.collapse?n.defaultOpeneds.slice(0):[]),f=It(n.defaultActive),h=It({}),d=It({}),p=Le(()=>n.mode==="horizontal"||n.mode==="vertical"&&n.collapse),m=()=>{const P=f.value&&h.value[f.value];if(!P||n.mode==="horizontal"||n.collapse)return;P.indexPath.forEach(L=>{const F=d.value[L];F&&g(L,F.indexPath)})},g=(P,N)=>{c.value.includes(P)||(n.uniqueOpened&&(c.value=c.value.filter(L=>N.includes(L))),c.value.push(P),e("open",P,N))},v=P=>{const N=c.value.indexOf(P);N!==-1&&c.value.splice(N,1)},_=(P,N)=>{v(P),e("close",P,N)},x=({index:P,indexPath:N})=>{c.value.includes(P)?_(P,N):g(P,N)},b=P=>{(n.mode==="horizontal"||n.collapse)&&(c.value=[]);const{index:N,indexPath:L}=P;if(!(jm(N)||jm(L)))if(n.router&&a){const F=P.route||N,O=a.push(F).then(B=>(B||(f.value=N),B));e("select",N,L,{index:N,indexPath:L,route:F},O)}else f.value=N,e("select",N,L,{index:N,indexPath:L})},S=P=>{const N=h.value,L=N[P]||f.value&&N[f.value]||N[n.defaultActive];L?f.value=L.index:f.value=P},T=()=>{var P,N;if(!s.value)return-1;const L=Array.from((N=(P=s.value)==null?void 0:P.childNodes)!=null?N:[]).filter(J=>J.nodeName!=="#comment"&&(J.nodeName!=="#text"||J.nodeValue)),F=64,O=Number.parseInt(getComputedStyle(s.value).paddingLeft,10),B=Number.parseInt(getComputedStyle(s.value).paddingRight,10),H=s.value.clientWidth-O-B;let j=0,K=0;return L.forEach((J,re)=>{j+=J.offsetWidth||0,j<=H-F&&(K=re+1)}),K===L.length?-1:K},M=(P,N=33.34)=>{let L;return()=>{L&&clearTimeout(L),L=setTimeout(()=>{P()},N)}};let C=!0;const k=()=>{const P=()=>{u.value=-1,ua(()=>{u.value=T()})};C?P():M(P)(),C=!1};Sn(()=>n.defaultActive,P=>{h.value[P]||(f.value=""),S(P)}),Sn(()=>n.collapse,P=>{P&&(c.value=[])}),Sn(h.value,m);let R;bie(()=>{n.mode==="horizontal"&&n.ellipsis?R=jS(s,k).stop:R==null||R()});{const P=O=>{d.value[O.index]=O},N=O=>{delete d.value[O.index]};Ci("rootMenu",bo({props:n,openedMenus:c,items:h,subMenus:d,activeIndex:f,isMenuPopup:p,addMenuItem:O=>{h.value[O.index]=O},removeMenuItem:O=>{delete h.value[O.index]},addSubMenu:P,removeSubMenu:N,openMenu:g,closeMenu:_,handleMenuItemClick:b,handleSubMenuClick:x})),Ci(`subMenu:${i.uid}`,{addSubMenu:P,removeSubMenu:N,mouseInChild:It(!1),level:0})}return Ii(()=>{n.mode==="horizontal"&&new Vye(i.vnode.el,o.namespace.value)}),r({open:N=>{const{indexPath:L}=d.value[N];L.forEach(F=>g(F,L))},close:v,handleResize:k}),()=>{var P,N;let L=(N=(P=t.default)==null?void 0:P.call(t))!=null?N:[];const F=[];if(n.mode==="horizontal"&&s.value){const H=E1(L),j=u.value===-1?H:H.slice(0,u.value),K=u.value===-1?[]:H.slice(u.value);K!=null&&K.length&&n.ellipsis&&(L=j,F.push(Zr(WP,{index:"sub-menu-more",class:l.e("hide-arrow")},{title:()=>Zr(Ss,{class:l.e("icon-more")},{default:()=>Zr(Uhe)}),default:()=>K})))}const O=B9(n,0),B=Zr("ul",{key:String(n.collapse),role:"menubar",ref:s,style:O.value,class:{[o.b()]:!0,[o.m(n.mode)]:!0,[o.m("collapse")]:n.collapse}},[...L,...F]);return n.collapseTransition&&n.mode==="vertical"?Zr(Gye,()=>B):B}}});const Zye=vr({index:{type:on([String,null]),default:null},route:{type:on([String,Object])},disabled:Boolean}),Qye={click:n=>_n(n.index)&&Array.isArray(n.indexPath)},n2="ElMenuItem",Jye=Dt({name:n2,components:{ElTooltip:S9},props:Zye,emits:Qye,setup(n,{emit:e}){const t=Is(),r=$n("rootMenu"),i=Tn("menu"),a=Tn("menu-item");r||S0(n2,"can not inject root menu");const{parentMenu:s,indexPath:o}=F9(t,Go(n,"index")),l=$n(`subMenu:${s.value.uid}`);l||S0(n2,"can not inject sub menu");const u=Le(()=>n.index===r.activeIndex),c=bo({index:n.index,indexPath:o,active:u}),f=()=>{n.disabled||(r.handleMenuItemClick({index:n.index,indexPath:o.value,route:n.route}),e("click",c))};return Ii(()=>{l.addSubMenu(c),r.addMenuItem(c)}),cs(()=>{l.removeSubMenu(c),r.removeMenuItem(c)}),{parentMenu:s,rootMenu:r,active:u,nsMenu:i,nsMenuItem:a,handleClick:f}}});function e0e(n,e,t,r,i,a){const s=Iie("el-tooltip");return at(),kt("li",{class:Et([n.nsMenuItem.b(),n.nsMenuItem.is("active",n.active),n.nsMenuItem.is("disabled",n.disabled)]),role:"menuitem",tabindex:"-1",onClick:e[0]||(e[0]=(...o)=>n.handleClick&&n.handleClick(...o))},[n.parentMenu.type.name==="ElMenu"&&n.rootMenu.props.collapse&&n.$slots.title?(at(),On(s,{key:0,effect:n.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:An(()=>[en(n.$slots,"title")]),default:An(()=>[cn("div",{class:Et(n.nsMenu.be("tooltip","trigger"))},[en(n.$slots,"default")],2)]),_:3},8,["effect"])):(at(),kt(hr,{key:1},[en(n.$slots,"default"),en(n.$slots,"title")],64))],2)}var U9=Yn(Jye,[["render",e0e],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item.vue"]]);const t0e={title:String},n0e="ElMenuItemGroup",r0e=Dt({name:n0e,props:t0e,setup(){return{ns:Tn("menu-item-group")}}});function i0e(n,e,t,r,i,a){return at(),kt("li",{class:Et(n.ns.b())},[cn("div",{class:Et(n.ns.e("title"))},[n.$slots.title?en(n.$slots,"title",{key:1}):(at(),kt(hr,{key:0},[ef(pi(n.title),1)],64))],2),cn("ul",null,[en(n.$slots,"default")])],2)}var z9=Yn(r0e,[["render",i0e],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item-group.vue"]]);const Rrt=wa(Yye,{MenuItem:U9,MenuItemGroup:z9,SubMenu:WP}),Prt=il(U9);il(z9);const Irt=il(WP),a0e=vr({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:n=>n>=0&&n<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:on(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:on([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:on(Function),default:n=>`${n}%`}}),s0e=["aria-valuenow"],o0e={viewBox:"0 0 100 100"},l0e=["d","stroke","stroke-width"],u0e=["d","stroke","opacity","stroke-linecap","stroke-width"],c0e={key:0},f0e=Dt({name:"ElProgress"}),h0e=Dt({...f0e,props:a0e,setup(n){const e=n,t={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},r=Tn("progress"),i=Le(()=>({width:`${e.percentage}%`,animationDuration:`${e.duration}s`,backgroundColor:_(e.percentage)})),a=Le(()=>(e.strokeWidth/e.width*100).toFixed(1)),s=Le(()=>["circle","dashboard"].includes(e.type)?Number.parseInt(`${50-Number.parseFloat(a.value)/2}`,10):0),o=Le(()=>{const x=s.value,b=e.type==="dashboard";return`
          M 50 50
          m 0 ${b?"":"-"}${x}
          a ${x} ${x} 0 1 1 0 ${b?"-":""}${x*2}
          a ${x} ${x} 0 1 1 0 ${b?"":"-"}${x*2}
          `}),l=Le(()=>2*Math.PI*s.value),u=Le(()=>e.type==="dashboard"?.75:1),c=Le(()=>`${-1*l.value*(1-u.value)/2}px`),f=Le(()=>({strokeDasharray:`${l.value*u.value}px, ${l.value}px`,strokeDashoffset:c.value})),h=Le(()=>({strokeDasharray:`${l.value*u.value*(e.percentage/100)}px, ${l.value}px`,strokeDashoffset:c.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),d=Le(()=>{let x;return e.color?x=_(e.percentage):x=t[e.status]||t.default,x}),p=Le(()=>e.status==="warning"?TP:e.type==="line"?e.status==="success"?R8:SP:e.status==="success"?Kfe:I8),m=Le(()=>e.type==="line"?12+e.strokeWidth*.4:e.width*.111111+2),g=Le(()=>e.format(e.percentage));function v(x){const b=100/x.length;return x.map((T,M)=>_n(T)?{color:T,percentage:(M+1)*b}:T).sort((T,M)=>T.percentage-M.percentage)}const _=x=>{var b;const{color:S}=e;if(rn(S))return S(x);if(_n(S))return S;{const T=v(S);for(const M of T)if(M.percentage>x)return M.color;return(b=T[T.length-1])==null?void 0:b.color}};return(x,b)=>(at(),kt("div",{class:Et([Q(r).b(),Q(r).m(x.type),Q(r).is(x.status),{[Q(r).m("without-text")]:!x.showText,[Q(r).m("text-inside")]:x.textInside}]),role:"progressbar","aria-valuenow":x.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[x.type==="line"?(at(),kt("div",{key:0,class:Et(Q(r).b("bar"))},[cn("div",{class:Et(Q(r).be("bar","outer")),style:ui({height:`${x.strokeWidth}px`})},[cn("div",{class:Et([Q(r).be("bar","inner"),{[Q(r).bem("bar","inner","indeterminate")]:x.indeterminate},{[Q(r).bem("bar","inner","striped")]:x.striped},{[Q(r).bem("bar","inner","striped-flow")]:x.stripedFlow}]),style:ui(Q(i))},[(x.showText||x.$slots.default)&&x.textInside?(at(),kt("div",{key:0,class:Et(Q(r).be("bar","innerText"))},[en(x.$slots,"default",{percentage:x.percentage},()=>[cn("span",null,pi(Q(g)),1)])],2)):Nn("v-if",!0)],6)],6)],2)):(at(),kt("div",{key:1,class:Et(Q(r).b("circle")),style:ui({height:`${x.width}px`,width:`${x.width}px`})},[(at(),kt("svg",o0e,[cn("path",{class:Et(Q(r).be("circle","track")),d:Q(o),stroke:`var(${Q(r).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":Q(a),fill:"none",style:ui(Q(f))},null,14,l0e),cn("path",{class:Et(Q(r).be("circle","path")),d:Q(o),stroke:Q(d),fill:"none",opacity:x.percentage?1:0,"stroke-linecap":x.strokeLinecap,"stroke-width":Q(a),style:ui(Q(h))},null,14,u0e)]))],6)),(x.showText||x.$slots.default)&&!x.textInside?(at(),kt("div",{key:2,class:Et(Q(r).e("text")),style:ui({fontSize:`${Q(m)}px`})},[en(x.$slots,"default",{percentage:x.percentage},()=>[x.status?(at(),On(Q(Ss),{key:1},{default:An(()=>[(at(),On(ro(Q(p))))]),_:1})):(at(),kt("span",c0e,pi(Q(g)),1))])],6)):Nn("v-if",!0)],10,s0e))}});var d0e=Yn(h0e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Drt=wa(d0e),p0e=vr({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:Number}}),m0e=vr({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),g0e=Dt({name:"ElSkeletonItem"}),v0e=Dt({...g0e,props:m0e,setup(n){const e=Tn("skeleton");return(t,r)=>(at(),kt("div",{class:Et([Q(e).e("item"),Q(e).e(t.variant)])},[t.variant==="image"?(at(),On(Q(jhe),{key:0})):Nn("v-if",!0)],2))}});var xw=Yn(v0e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/skeleton/src/skeleton-item.vue"]]);const y0e=Dt({name:"ElSkeleton"}),_0e=Dt({...y0e,props:p0e,setup(n,{expose:e}){const t=n,r=Tn("skeleton"),i=Mpe(Go(t,"loading"),t.throttle);return e({uiLoading:i}),(a,s)=>Q(i)?(at(),kt("div",ji({key:0,class:[Q(r).b(),Q(r).is("animated",a.animated)]},a.$attrs),[(at(!0),kt(hr,null,wm(a.count,o=>(at(),kt(hr,{key:o},[a.loading?en(a.$slots,"template",{key:o},()=>[Pn(xw,{class:Et(Q(r).is("first")),variant:"p"},null,8,["class"]),(at(!0),kt(hr,null,wm(a.rows,l=>(at(),On(xw,{key:l,class:Et([Q(r).e("paragraph"),Q(r).is("last",l===a.rows&&a.rows>1)]),variant:"p"},null,8,["class"]))),128))]):Nn("v-if",!0)],64))),128))],16)):en(a.$slots,"default",uy(ji({key:1},a.$attrs)))}});var x0e=Yn(_0e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/skeleton/src/skeleton.vue"]]);const Lrt=wa(x0e,{SkeletonItem:xw}),Nrt=il(xw);function b0e(n){let e;const t=It(!1),r=bo({...n,originalPosition:"",originalOverflow:"",visible:!1});function i(h){r.text=h}function a(){const h=r.parent,d=f.ns;if(!h.vLoadingAddClassList){let p=h.getAttribute("loading-number");p=Number.parseInt(p)-1,p?h.setAttribute("loading-number",p.toString()):(Kh(h,d.bm("parent","relative")),h.removeAttribute("loading-number")),Kh(h,d.bm("parent","hidden"))}s(),c.unmount()}function s(){var h,d;(d=(h=f.$el)==null?void 0:h.parentNode)==null||d.removeChild(f.$el)}function o(){var h;n.beforeClose&&!n.beforeClose()||(t.value=!0,clearTimeout(e),e=window.setTimeout(l,400),r.visible=!1,(h=n.closed)==null||h.call(n))}function l(){if(!t.value)return;const h=r.parent;t.value=!1,h.vLoadingAddClassList=void 0,a()}const u=Dt({name:"ElLoading",setup(h,{expose:d}){const{ns:p,zIndex:m}=c9("loading");return d({ns:p,zIndex:m}),()=>{const g=r.spinner||r.svg,v=Zr("svg",{class:"circular",viewBox:r.svgViewBox?r.svgViewBox:"0 0 50 50",...g?{innerHTML:g}:{}},[Zr("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),_=r.text?Zr("p",{class:p.b("text")},[r.text]):void 0;return Zr(Ef,{name:p.b("fade"),onAfterLeave:l},{default:An(()=>[Cf(Pn("div",{style:{backgroundColor:r.background||""},class:[p.b("mask"),r.customClass,r.fullscreen?"is-fullscreen":""]},[Zr("div",{class:p.b("spinner")},[v,_])]),[[Dd,r.visible]])])})}}}),c=Gae(u),f=c.mount(document.createElement("div"));return{...YR(r),setText:i,removeElLoadingChild:s,close:o,handleAfterLeave:l,vm:f,get $el(){return f.$el}}}let Lx;const w0e=function(n={}){if(!ya)return;const e=S0e(n);if(e.fullscreen&&Lx)return Lx;const t=b0e({...e,closed:()=>{var i;(i=e.closed)==null||i.call(e),e.fullscreen&&(Lx=void 0)}});T0e(e,e.parent,t),AB(e,e.parent,t),e.parent.vLoadingAddClassList=()=>AB(e,e.parent,t);let r=e.parent.getAttribute("loading-number");return r?r=`${Number.parseInt(r)+1}`:r="1",e.parent.setAttribute("loading-number",r),e.parent.appendChild(t.$el),ua(()=>t.visible.value=e.visible),e.fullscreen&&(Lx=t),t},S0e=n=>{var e,t,r,i;let a;return _n(n.target)?a=(e=document.querySelector(n.target))!=null?e:document.body:a=n.target||document.body,{parent:a===document.body||n.body?document.body:a,background:n.background||"",svg:n.svg||"",svgViewBox:n.svgViewBox||"",spinner:n.spinner||!1,text:n.text||"",fullscreen:a===document.body&&((t=n.fullscreen)!=null?t:!0),lock:(r=n.lock)!=null?r:!1,customClass:n.customClass||"",visible:(i=n.visible)!=null?i:!0,target:a}},T0e=async(n,e,t)=>{const{nextZIndex:r}=t.vm.zIndex||t.vm._.exposed.zIndex,i={};if(n.fullscreen)t.originalPosition.value=wv(document.body,"position"),t.originalOverflow.value=wv(document.body,"overflow"),i.zIndex=r();else if(n.parent===document.body){t.originalPosition.value=wv(document.body,"position"),await ua();for(const a of["top","left"]){const s=a==="top"?"scrollTop":"scrollLeft";i[a]=`${n.target.getBoundingClientRect()[a]+document.body[s]+document.documentElement[s]-Number.parseInt(wv(document.body,`margin-${a}`),10)}px`}for(const a of["height","width"])i[a]=`${n.target.getBoundingClientRect()[a]}px`}else t.originalPosition.value=wv(e,"position");for(const[a,s]of Object.entries(i))t.$el.style[a]=s},AB=(n,e,t)=>{const r=t.vm.ns||t.vm._.exposed.ns;["absolute","fixed","sticky"].includes(t.originalPosition.value)?Kh(e,r.bm("parent","relative")):lm(e,r.bm("parent","relative")),n.fullscreen&&n.lock?lm(e,r.bm("parent","hidden")):Kh(e,r.bm("parent","hidden"))},lM=Symbol("ElLoading"),MB=(n,e)=>{var t,r,i,a;const s=e.instance,o=h=>Fn(e.value)?e.value[h]:void 0,l=h=>{const d=_n(h)&&(s==null?void 0:s[h])||h;return d&&It(d)},u=h=>l(o(h)||n.getAttribute(`element-loading-${Tf(h)}`)),c=(t=o("fullscreen"))!=null?t:e.modifiers.fullscreen,f={text:u("text"),svg:u("svg"),svgViewBox:u("svgViewBox"),spinner:u("spinner"),background:u("background"),customClass:u("customClass"),fullscreen:c,target:(r=o("target"))!=null?r:c?void 0:n,body:(i=o("body"))!=null?i:e.modifiers.body,lock:(a=o("lock"))!=null?a:e.modifiers.lock};n[lM]={options:f,instance:w0e(f)}},C0e=(n,e)=>{for(const t of Object.keys(e))mi(e[t])&&(e[t].value=n[t])},Ort={mounted(n,e){e.value&&MB(n,e)},updated(n,e){const t=n[lM];e.oldValue!==e.value&&(e.value&&!e.oldValue?MB(n,e):e.value&&e.oldValue?Fn(e.value)&&C0e(e.value,t.options):t==null||t.instance.close())},unmounted(n){var e;(e=n[lM])==null||e.instance.close()}},V9=["success","info","warning","error"],ja=Au({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:ya?document.body:void 0}),E0e=vr({customClass:{type:String,default:ja.customClass},center:{type:Boolean,default:ja.center},dangerouslyUseHTMLString:{type:Boolean,default:ja.dangerouslyUseHTMLString},duration:{type:Number,default:ja.duration},icon:{type:Pu,default:ja.icon},id:{type:String,default:ja.id},message:{type:on([String,Object,Function]),default:ja.message},onClose:{type:on(Function),required:!1},showClose:{type:Boolean,default:ja.showClose},type:{type:String,values:V9,default:ja.type},offset:{type:Number,default:ja.offset},zIndex:{type:Number,default:ja.zIndex},grouping:{type:Boolean,default:ja.grouping},repeatNum:{type:Number,default:ja.repeatNum}}),A0e={destroy:()=>!0},qo=QW([]),M0e=n=>{const e=qo.findIndex(i=>i.id===n),t=qo[e];let r;return e>0&&(r=qo[e-1]),{current:t,prev:r}},k0e=n=>{const{prev:e}=M0e(n);return e?e.vm.exposed.bottom.value:0},R0e=(n,e)=>qo.findIndex(r=>r.id===n)>0?20:e,P0e=["id"],I0e=["innerHTML"],D0e=Dt({name:"ElMessage"}),L0e=Dt({...D0e,props:E0e,emits:A0e,setup(n,{expose:e}){const t=n,{Close:r}=cde,{ns:i,zIndex:a}=c9("message"),{currentZIndex:s,nextZIndex:o}=a,l=It(),u=It(!1),c=It(0);let f;const h=Le(()=>t.type?t.type==="error"?"danger":t.type:"info"),d=Le(()=>{const M=t.type;return{[i.bm("icon",M)]:M&&WF[M]}}),p=Le(()=>t.icon||WF[t.type]||""),m=Le(()=>k0e(t.id)),g=Le(()=>R0e(t.id,t.offset)+m.value),v=Le(()=>c.value+g.value),_=Le(()=>({top:`${g.value}px`,zIndex:s.value}));function x(){t.duration!==0&&({stop:f}=qA(()=>{S()},t.duration))}function b(){f==null||f()}function S(){u.value=!1}function T({code:M}){M===Na.esc&&S()}return Ii(()=>{x(),o(),u.value=!0}),Sn(()=>t.repeatNum,()=>{b(),x()}),T1(document,"keydown",T),jS(l,()=>{c.value=l.value.getBoundingClientRect().height}),e({visible:u,bottom:v,close:S}),(M,C)=>(at(),On(Ef,{name:Q(i).b("fade"),onBeforeLeave:M.onClose,onAfterLeave:C[0]||(C[0]=k=>M.$emit("destroy")),persisted:""},{default:An(()=>[Cf(cn("div",{id:M.id,ref_key:"messageRef",ref:l,class:Et([Q(i).b(),{[Q(i).m(M.type)]:M.type&&!M.icon},Q(i).is("center",M.center),Q(i).is("closable",M.showClose),M.customClass]),style:ui(Q(_)),role:"alert",onMouseenter:b,onMouseleave:x},[M.repeatNum>1?(at(),On(Q(rve),{key:0,value:M.repeatNum,type:Q(h),class:Et(Q(i).e("badge"))},null,8,["value","type","class"])):Nn("v-if",!0),Q(p)?(at(),On(Q(Ss),{key:1,class:Et([Q(i).e("icon"),Q(d)])},{default:An(()=>[(at(),On(ro(Q(p))))]),_:1},8,["class"])):Nn("v-if",!0),en(M.$slots,"default",{},()=>[M.dangerouslyUseHTMLString?(at(),kt(hr,{key:1},[Nn(" Caution here, message could've been compromised, never use user's input as message "),cn("p",{class:Et(Q(i).e("content")),innerHTML:M.message},null,10,I0e)],2112)):(at(),kt("p",{key:0,class:Et(Q(i).e("content"))},pi(M.message),3))]),M.showClose?(at(),On(Q(Ss),{key:2,class:Et(Q(i).e("closeBtn")),onClick:uP(S,["stop"])},{default:An(()=>[Pn(Q(r))]),_:1},8,["class","onClick"])):Nn("v-if",!0)],46,P0e),[[Dd,u.value]])]),_:3},8,["name","onBeforeLeave"]))}});var N0e=Yn(L0e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let O0e=1;const H9=n=>{const e=!n||_n(n)||lf(n)||rn(n)?{message:n}:n,t={...ja,...e};if(!t.appendTo)t.appendTo=document.body;else if(_n(t.appendTo)){let r=document.querySelector(t.appendTo);w0(r)||(r=document.body),t.appendTo=r}return t},$0e=n=>{const e=qo.indexOf(n);if(e===-1)return;qo.splice(e,1);const{handler:t}=n;t.close()},F0e=({appendTo:n,...e},t)=>{const r=`message_${O0e++}`,i=e.onClose,a=document.createElement("div"),s={...e,id:r,onClose:()=>{i==null||i(),$0e(c)},onDestroy:()=>{q$(null,a)}},o=Pn(N0e,s,rn(s.message)||lf(s.message)?{default:rn(s.message)?s.message:()=>s.message}:null);o.appContext=t||Qm._context,q$(o,a),n.appendChild(a.firstElementChild);const l=o.component,c={id:r,vnode:o,vm:l,handler:{close:()=>{l.exposed.visible.value=!1}},props:o.component.props};return c},Qm=(n={},e)=>{if(!ya)return{close:()=>{}};if(el(aB.max)&&qo.length>=aB.max)return{close:()=>{}};const t=H9(n);if(t.grouping&&qo.length){const i=qo.find(({vnode:a})=>{var s;return((s=a.props)==null?void 0:s.message)===t.message});if(i)return i.props.repeatNum+=1,i.props.type=t.type,i.handler}const r=F0e(t,e);return qo.push(r),r.handler};V9.forEach(n=>{Qm[n]=(e={},t)=>{const r=H9(e);return Qm({...r,type:n},t)}});function B0e(n){for(const e of qo)(!n||n===e.props.type)&&e.handler.close()}Qm.closeAll=B0e;Qm._context=null;const $rt=hde(Qm,"$message");let W9=!0,G9=!0;function R1(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseInt(r[t],10)}function $d(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(s,o){if(s!==e)return i.apply(this,arguments);const l=u=>{const c=t(u);c&&(o.handleEvent?o.handleEvent(c):o(c))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,l),i.apply(this,[s,l])};const a=r.removeEventListener;r.removeEventListener=function(s,o){if(s!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(o))return a.apply(this,arguments);const l=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[s,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(s){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),s&&this.addEventListener(e,this["_on"+e]=s)},enumerable:!0,configurable:!0})}function U0e(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(W9=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function z0e(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(G9=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function j9(){if(typeof window=="object"){if(W9)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function GP(n,e){G9&&console.warn(n+" is deprecated, please use "+e+" instead.")}function V0e(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.mozGetUserMedia)e.browser="firefox",e.version=R1(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=R1(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=R1(t.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function kB(n){return Object.prototype.toString.call(n)==="[object Object]"}function q9(n){return kB(n)?Object.keys(n).reduce(function(e,t){const r=kB(n[t]),i=r?q9(n[t]):n[t],a=r&&!Object.keys(i).length;return i===void 0||a?e:Object.assign(e,{[t]:i})},{}):n}function uM(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?uM(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{uM(n,n.get(i),t)})}))}function RB(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const a=[];return n.forEach(s=>{s.type==="track"&&s.trackIdentifier===e.id&&a.push(s)}),a.forEach(s=>{n.forEach(o=>{o.type===r&&o.trackId===s.id&&uM(n,o,i)})}),i}const PB=j9;function X9(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const l={};return Object.keys(o).forEach(u=>{if(u==="require"||u==="advanced"||u==="mediaSource")return;const c=typeof o[u]=="object"?o[u]:{ideal:o[u]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const f=function(h,d){return h?h+d.charAt(0).toUpperCase()+d.slice(1):d==="deviceId"?"sourceId":d};if(c.ideal!==void 0){l.optional=l.optional||[];let h={};typeof c.ideal=="number"?(h[f("min",u)]=c.ideal,l.optional.push(h),h={},h[f("max",u)]=c.ideal,l.optional.push(h)):(h[f("",u)]=c.ideal,l.optional.push(h))}c.exact!==void 0&&typeof c.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[f("",u)]=c.exact):["min","max"].forEach(h=>{c[h]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[f(h,u)]=c[h])})}),o.advanced&&(l.optional=(l.optional||[]).concat(o.advanced)),l},i=function(o,l){if(e.version>=61)return l(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const u=function(c,f,h){f in c&&!(h in c)&&(c[h]=c[f],delete c[f])};o=JSON.parse(JSON.stringify(o)),u(o.audio,"autoGainControl","googAutoGainControl"),u(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=r(o.audio)}if(o&&typeof o.video=="object"){let u=o.video.facingMode;u=u&&(typeof u=="object"?u:{ideal:u});const c=e.version<66;if(u&&(u.exact==="user"||u.exact==="environment"||u.ideal==="user"||u.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete o.video.facingMode;let f;if(u.exact==="environment"||u.ideal==="environment"?f=["back","rear"]:(u.exact==="user"||u.ideal==="user")&&(f=["front"]),f)return t.mediaDevices.enumerateDevices().then(h=>{h=h.filter(p=>p.kind==="videoinput");let d=h.find(p=>f.some(m=>p.label.toLowerCase().includes(m)));return!d&&h.length&&f.includes("back")&&(d=h[h.length-1]),d&&(o.video.deviceId=u.exact?{exact:d.deviceId}:{ideal:d.deviceId}),o.video=r(o.video),PB("chrome: "+JSON.stringify(o)),l(o)})}o.video=r(o.video)}return PB("chrome: "+JSON.stringify(o)),l(o)},a=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},s=function(o,l,u){i(o,c=>{t.webkitGetUserMedia(c,l,f=>{u&&u(a(f))})})};if(t.getUserMedia=s.bind(t),t.mediaDevices.getUserMedia){const o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(l){return i(l,u=>o(u).then(c=>{if(u.audio&&!c.getAudioTracks().length||u.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(a(c))))}}}function H0e(n,e){if(!(n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices)&&n.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}n.navigator.mediaDevices.getDisplayMedia=function(r){return e(r).then(i=>{const a=r.video&&r.video.width,s=r.video&&r.video.height,o=r.video&&r.video.frameRate;return r.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:i,maxFrameRate:o||3}},a&&(r.video.mandatory.maxWidth=a),s&&(r.video.mandatory.maxHeight=s),n.navigator.mediaDevices.getUserMedia(r)})}}}function K9(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function Y9(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let a;n.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(o=>o.track&&o.track.id===i.track.id):a={track:i.track};const s=new Event("track");s.track=i.track,s.receiver=a,s.transceiver={receiver:a},s.streams=[r.stream],this.dispatchEvent(s)}),r.stream.getTracks().forEach(i=>{let a;n.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(o=>o.track&&o.track.id===i.id):a={track:i};const s=new Event("track");s.track=i,s.receiver=a,s.transceiver={receiver:a},s.streams=[r.stream],this.dispatchEvent(s)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else $d(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Z9(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=i.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(o,l){let u=i.apply(this,arguments);return u||(u=e(this,o),this._senders.push(u)),u};const a=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(o){a.apply(this,arguments);const l=this._senders.indexOf(o);l!==-1&&this._senders.splice(l,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],t.apply(this,[a]),a.getTracks().forEach(s=>{this._senders.push(e(this,s))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(s=>{const o=this._senders.find(l=>l.track===s);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Q9(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[r,i,a]=arguments;if(arguments.length>0&&typeof r=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof r!="function"))return e.apply(this,[]);const s=function(l){const u={};return l.result().forEach(f=>{const h={id:f.id,timestamp:f.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[f.type]||f.type};f.names().forEach(d=>{h[d]=f.stat(d)}),u[h.id]=h}),u},o=function(l){return new Map(Object.keys(l).map(u=>[u,l[u]]))};if(arguments.length>=2){const l=function(u){i(o(s(u)))};return e.apply(this,[l,r])}return new Promise((l,u)=>{e.apply(this,[function(c){l(o(s(c)))},u])}).then(i,a)}}function J9(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const a=t.apply(this,[]);return a.forEach(s=>s._pc=this),a});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),n.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(s=>RB(s,a.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(a=>a._pc=this),i}),$d(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(a=>RB(a,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,a,s;return this.getSenders().forEach(o=>{o.track===r&&(i?s=!0:i=o)}),this.getReceivers().forEach(o=>(o.track===r&&(a?s=!0:a=o),o.track===r)),s||i&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function ej(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(s=>this._shimmedLocalStreams[s][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(s,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(l)===-1&&this._shimmedLocalStreams[o.id].push(l):this._shimmedLocalStreams[o.id]=[o,l],l};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._shimmedLocalStreams=this._shimmedLocalStreams||{},s.getTracks().forEach(u=>{if(this.getSenders().find(f=>f.track===u))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();t.apply(this,arguments);const l=this.getSenders().filter(u=>o.indexOf(u)===-1);this._shimmedLocalStreams[s.id]=[s].concat(l)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[s.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(s){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},s&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const l=this._shimmedLocalStreams[o].indexOf(s);l!==-1&&this._shimmedLocalStreams[o].splice(l,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),i.apply(this,arguments)}}function tj(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return ej(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const c=t.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(f=>this._reverseStreams[f.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(f=>{if(this.getSenders().find(d=>d.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const f=new n.MediaStream(c.getTracks());this._streams[c.id]=f,this._reverseStreams[f.id]=c,c=f}r.apply(this,[c])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},n.RTCPeerConnection.prototype.addTrack=function(c,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const h=[].slice.call(arguments,1);if(h.length!==1||!h[0].getTracks().find(m=>m===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(m=>m.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[f.id];if(p)p.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const m=new n.MediaStream([c]);this._streams[f.id]=m,this._reverseStreams[m.id]=f,this.addStream(m)}return this.getSenders().find(m=>m.track===c)};function a(u,c){let f=c.sdp;return Object.keys(u._reverseStreams||[]).forEach(h=>{const d=u._reverseStreams[h],p=u._streams[d.id];f=f.replace(new RegExp(p.id,"g"),d.id)}),new RTCSessionDescription({type:c.type,sdp:f})}function s(u,c){let f=c.sdp;return Object.keys(u._reverseStreams||[]).forEach(h=>{const d=u._reverseStreams[h],p=u._streams[d.id];f=f.replace(new RegExp(d.id,"g"),p.id)}),new RTCSessionDescription({type:c.type,sdp:f})}["createOffer","createAnswer"].forEach(function(u){const c=n.RTCPeerConnection.prototype[u],f={[u](){const h=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[p=>{const m=a(this,p);h[0].apply(null,[m])},p=>{h[1]&&h[1].apply(null,p)},arguments[2]]):c.apply(this,arguments).then(p=>a(this,p))}};n.RTCPeerConnection.prototype[u]=f[u]});const o=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=s(this,arguments[0]),o.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const u=l.get.apply(this);return u.type===""?u:a(this,u)}}),n.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let h;Object.keys(this._streams).forEach(d=>{this._streams[d].getTracks().find(m=>c.track===m)&&(h=this._streams[d])}),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function cM(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function nj(n,e){$d(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}const IB=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:nj,shimAddTrackRemoveTrack:tj,shimAddTrackRemoveTrackWithNative:ej,shimGetDisplayMedia:H0e,shimGetSendersWithDtmf:Z9,shimGetStats:Q9,shimGetUserMedia:X9,shimMediaStream:K9,shimOnTrack:Y9,shimPeerConnection:cM,shimSenderReceiverGetStats:J9},Symbol.toStringTag,{value:"Module"}));function rj(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,a,s){GP("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(a,s)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(s,o,l){o in s&&!(l in s)&&(s[l]=s[o],delete s[o])},a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(s){return typeof s=="object"&&typeof s.audio=="object"&&(s=JSON.parse(JSON.stringify(s)),i(s.audio,"autoGainControl","mozAutoGainControl"),i(s.audio,"noiseSuppression","mozNoiseSuppression")),a(s)},r&&r.prototype.getSettings){const s=r.prototype.getSettings;r.prototype.getSettings=function(){const o=s.apply(this,arguments);return i(o,"mozAutoGainControl","autoGainControl"),i(o,"mozNoiseSuppression","noiseSuppression"),o}}if(r&&r.prototype.applyConstraints){const s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o,"autoGainControl","mozAutoGainControl"),i(o,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[o])}}}}function W0e(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function ij(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fM(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const a=n.RTCPeerConnection.prototype[i],s={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=s[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[a,s,o]=arguments;return r.apply(this,[a||null]).then(l=>{if(e.version<53&&!s)try{l.forEach(u=>{u.type=t[u.type]||u.type})}catch(u){if(u.name!=="TypeError")throw u;l.forEach((c,f)=>{l.set(f,Object.assign({},c,{type:t[c.type]||c.type}))})}return l}).then(s,o)}}function aj(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(a=>a._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function sj(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),$d(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function oj(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){GP("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function lj(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function uj(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(s=>{if("rid"in s&&!/^[a-z0-9]{0,16}$/i.test(s.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in s&&!(parseFloat(s.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in s&&!(parseFloat(s.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(i){const{sender:s}=a,o=s.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=r,s.sendEncodings=r,this.setParametersPromises.push(s.setParameters(o).then(()=>{delete s.sendEncodings}).catch(()=>{delete s.sendEncodings})))}return a})}function cj(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function fj(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function hj(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const DB=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:uj,shimCreateAnswer:hj,shimCreateOffer:fj,shimGetDisplayMedia:W0e,shimGetParameters:cj,shimGetUserMedia:rj,shimOnTrack:ij,shimPeerConnection:fM,shimRTCDataChannel:lj,shimReceiverGetStats:sj,shimRemoveStream:oj,shimSenderGetStats:aj},Symbol.toStringTag,{value:"Module"}));function dj(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r,...i){return i&&i.forEach(a=>{this._localStreams?this._localStreams.includes(a)||this._localStreams.push(a):this._localStreams=[a]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(a=>{i.includes(a.track)&&this.removeTrack(a)})})}}function pj(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const a=new Event("addstream");a.stream=i,this.dispatchEvent(a)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(a=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(a)>=0)return;r._remoteStreams.push(a);const s=new Event("addstream");s.stream=a,r.dispatchEvent(s)})}),e.apply(r,arguments)}}}function mj(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,a=e.setRemoteDescription,s=e.addIceCandidate;e.createOffer=function(u,c){const f=arguments.length>=2?arguments[2]:arguments[0],h=t.apply(this,[f]);return c?(h.then(u,c),Promise.resolve()):h},e.createAnswer=function(u,c){const f=arguments.length>=2?arguments[2]:arguments[0],h=r.apply(this,[f]);return c?(h.then(u,c),Promise.resolve()):h};let o=function(l,u,c){const f=i.apply(this,[l]);return c?(f.then(u,c),Promise.resolve()):f};e.setLocalDescription=o,o=function(l,u,c){const f=a.apply(this,[l]);return c?(f.then(u,c),Promise.resolve()):f},e.setRemoteDescription=o,o=function(l,u,c){const f=s.apply(this,[l]);return c?(f.then(u,c),Promise.resolve()):f},e.addIceCandidate=o}function gj(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(vj(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=function(r,i,a){e.mediaDevices.getUserMedia(r).then(i,a)}.bind(e))}function vj(n){return n&&n.video!==void 0?Object.assign({},n,{video:q9(n.video)}):n}function yj(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const a=[];for(let s=0;s<r.iceServers.length;s++){let o=r.iceServers[s];o.urls===void 0&&o.url?(GP("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,a.push(o)):a.push(r.iceServers[s])}r.iceServers=a}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function _j(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function xj(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(s=>s.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const a=this.getTransceivers().find(s=>s.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):r.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function bj(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}const LB=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:bj,shimCallbacksAPI:mj,shimConstraints:vj,shimCreateOfferLegacy:xj,shimGetUserMedia:gj,shimLocalStreamsAPI:dj,shimRTCIceServerUrls:yj,shimRemoteStreamsAPI:pj,shimTrackEventTransceiver:_j},Symbol.toStringTag,{value:"Module"}));var wj={exports:{}};(function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,a)=>(a>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let a=8;a<r.length;a+=2)switch(r[a]){case"raddr":i.relatedAddress=r[a+1];break;case"rport":i.relatedPort=parseInt(r[a+1],10);break;case"tcptype":i.tcpType=r[a+1];break;case"ufrag":i.ufrag=r[a+1],i.usernameFragment=r[a+1];break;default:i[r[a]]===void 0&&(i[r[a]]=r[a+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const a=t.type;return r.push("typ"),r.push(a),a!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const a=t.substring(t.indexOf(" ")+1).split(";");for(let s=0;s<a.length;s++)i=a[s].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const a=[];Object.keys(t.parameters).forEach(s=>{t.parameters[s]!==void 0?a.push(s+"="+t.parameters[s]):a.push(s)}),r+="a=fmtp:"+i+" "+a.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(a=>{r+="a=rtcp-fb:"+i+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},a=t.indexOf(":",r);return a>-1?(i.attribute=t.substring(r+1,a),i.value=t.substring(a+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(a=>{i+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],a=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&a?{usernameFragment:i.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(t)[0].split(" ");r.profile=a[2];for(let o=3;o<a.length;o++){const l=a[o],u=e.matchPrefix(t,"a=rtpmap:"+l+" ")[0];if(u){const c=e.parseRtpMap(u),f=e.matchPrefix(t,"a=fmtp:"+l+" ");switch(c.parameters=f.length?e.parseFmtp(f[0]):{},c.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(c.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(o=>{r.headerExtensions.push(e.parseExtmap(o))});const s=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(o=>{s.forEach(l=>{o.rtcpFeedback.find(c=>c.type===l.type&&c.parameter===l.parameter)||o.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(s=>s.preferredPayloadType!==void 0?s.preferredPayloadType:s.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(s=>{i+=e.writeRtpMap(s),i+=e.writeFmtp(s),i+=e.writeRtcpFb(s)});let a=0;return r.codecs.forEach(s=>{s.maxptime>a&&(a=s.maxptime)}),a>0&&(i+="a=maxptime:"+a+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(s=>{i+=e.writeExtmap(s)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),a=i.fecMechanisms.indexOf("RED")!==-1,s=i.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(t,"a=ssrc:").map(h=>e.parseSsrcMedia(h)).filter(h=>h.attribute==="cname"),l=o.length>0&&o[0].ssrc;let u;const c=e.matchPrefix(t,"a=ssrc-group:FID").map(h=>h.substring(17).split(" ").map(p=>parseInt(p,10)));c.length>0&&c[0].length>1&&c[0][0]===l&&(u=c[0][1]),i.codecs.forEach(h=>{if(h.name.toUpperCase()==="RTX"&&h.parameters.apt){let d={ssrc:l,codecPayloadType:parseInt(h.parameters.apt,10)};l&&u&&(d.rtx={ssrc:u}),r.push(d),a&&(d=JSON.parse(JSON.stringify(d)),d.fec={ssrc:l,mechanism:s?"red+ulpfec":"red"},r.push(d))}}),r.length===0&&l&&r.push({ssrc:l});let f=e.matchPrefix(t,"b=");return f.length&&(f[0].indexOf("b=TIAS:")===0?f=parseInt(f[0].substring(7),10):f[0].indexOf("b=AS:")===0?f=parseInt(f[0].substring(5),10)*1e3*.95-50*40*8:f=void 0,r.forEach(h=>{h.maxBitrate=f})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const a=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=a.length>0,r.compound=a.length===0;const s=e.matchPrefix(t,"a=rtcp-mux");return r.mux=s.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const a=e.matchPrefix(t,"a=ssrc:").map(s=>e.parseSsrcMedia(s)).filter(s=>s.attribute==="msid");if(a.length>0)return r=a[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let a;i.length>0&&(a=parseInt(i[0].substring(19),10)),isNaN(a)&&(a=65536);const s=e.matchPrefix(t,"a=sctp-port:");if(s.length>0)return{port:parseInt(s[0].substring(12),10),protocol:r.fmt,maxMessageSize:a};const o=e.matchPrefix(t,"a=sctpmap:");if(o.length>0){const l=o[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:a}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let a;const s=r!==void 0?r:2;return t?a=t:a=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+a+" "+s+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let a=0;a<i.length;a++)switch(i[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[a].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e})(wj);var Sj=wj.exports;const Cm=b_(Sj),G0e=LW({__proto__:null,default:Cm},[Sj]);function P1(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),a=Cm.parseCandidate(r.candidate);for(const s in a)s in i||Object.defineProperty(i,s,{value:a[s]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,$d(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function hM(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||$d(n,"icecandidate",e=>{if(e.candidate){const t=Cm.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function I1(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(o){if(!o||!o.sdp)return!1;const l=Cm.splitSections(o.sdp);return l.shift(),l.some(u=>{const c=Cm.parseMLine(u);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},r=function(o){const l=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const u=parseInt(l[1],10);return u!==u?-1:u},i=function(o){let l=65536;return e.browser==="firefox"&&(e.version<57?o===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},a=function(o,l){let u=65536;e.browser==="firefox"&&e.version===57&&(u=65535);const c=Cm.matchPrefix(o.sdp,"a=max-message-size:");return c.length>0?u=parseInt(c[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(u=2147483637),u},s=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const l=r(arguments[0]),u=i(l),c=a(arguments[0],l);let f;u===0&&c===0?f=Number.POSITIVE_INFINITY:u===0||c===0?f=Math.max(u,c):f=Math.min(u,c);const h={};Object.defineProperty(h,"maxMessageSize",{get(){return f}}),this._sctp=h}return s.apply(this,arguments)}}function D1(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const a=r.send;r.send=function(){const o=arguments[0],l=o.length||o.size||o.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return a.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},$d(n,"datachannel",r=>(e(r.channel,r.target),r))}function dM(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const a=i.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const s=new Event("connectionstatechange",i);a.dispatchEvent(s)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function pM(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=i.sdp.split(`
`).filter(s=>s.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:a}):i.sdp=a}return t.apply(this,arguments)}}function L1(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function N1(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(s=>t.apply(this,[s]))})}const j0e=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:pM,shimAddIceCandidateNullOrEmpty:L1,shimConnectionState:dM,shimMaxMessageSize:I1,shimParameterlessSetLocalDescription:N1,shimRTCIceCandidate:P1,shimRTCIceCandidateRelayProtocol:hM,shimSendThrowTypeError:D1},Symbol.toStringTag,{value:"Module"}));function q0e({window:n}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=j9,r=V0e(n),i={browserDetails:r,commonShim:j0e,extractVersion:R1,disableLog:U0e,disableWarnings:z0e,sdp:G0e};switch(r.browser){case"chrome":if(!IB||!cM||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=IB,L1(n,r),N1(n),X9(n,r),K9(n),cM(n,r),Y9(n),tj(n,r),Z9(n),Q9(n),J9(n),nj(n,r),P1(n),hM(n),dM(n),I1(n,r),D1(n),pM(n,r);break;case"firefox":if(!DB||!fM||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=DB,L1(n,r),N1(n),rj(n,r),fM(n,r),ij(n),oj(n),aj(n),sj(n),lj(n),uj(n),cj(n),fj(n),hj(n),P1(n),dM(n),I1(n,r),D1(n);break;case"safari":if(!LB||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=LB,L1(n,r),N1(n),yj(n),xj(n),mj(n),dj(n),pj(n),_j(n),gj(n),bj(n),P1(n),hM(n),I1(n,r),D1(n),pM(n,r);break;default:t("Unsupported browser!");break}return i}q0e({window:typeof window>"u"?void 0:window});const Wl=Object.create(null);Wl.open="0";Wl.close="1";Wl.ping="2";Wl.pong="3";Wl.message="4";Wl.upgrade="5";Wl.noop="6";const O1=Object.create(null);Object.keys(Wl).forEach(n=>{O1[Wl[n]]=n});const X0e={type:"error",data:"parser error"},K0e=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Y0e=typeof ArrayBuffer=="function",Z0e=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Tj=({type:n,data:e},t,r)=>K0e&&e instanceof Blob?t?r(e):NB(e,r):Y0e&&(e instanceof ArrayBuffer||Z0e(e))?t?r(e):NB(new Blob([e]),r):r(Wl[n]+(e||"")),NB=(n,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(n)},OB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<OB.length;n++)dy[OB.charCodeAt(n)]=n;const Q0e=n=>{let e=n.length*.75,t=n.length,r,i=0,a,s,o,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const u=new ArrayBuffer(e),c=new Uint8Array(u);for(r=0;r<t;r+=4)a=dy[n.charCodeAt(r)],s=dy[n.charCodeAt(r+1)],o=dy[n.charCodeAt(r+2)],l=dy[n.charCodeAt(r+3)],c[i++]=a<<2|s>>4,c[i++]=(s&15)<<4|o>>2,c[i++]=(o&3)<<6|l&63;return u},J0e=typeof ArrayBuffer=="function",Cj=(n,e)=>{if(typeof n!="string")return{type:"message",data:Ej(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:e_e(n.substring(1),e)}:O1[t]?n.length>1?{type:O1[t],data:n.substring(1)}:{type:O1[t]}:X0e},e_e=(n,e)=>{if(J0e){const t=Q0e(n);return Ej(t,e)}else return{base64:!0,data:n}},Ej=(n,e)=>{switch(e){case"blob":return n instanceof ArrayBuffer?new Blob([n]):n;case"arraybuffer":default:return n}},Aj=String.fromCharCode(30),t_e=(n,e)=>{const t=n.length,r=new Array(t);let i=0;n.forEach((a,s)=>{Tj(a,!1,o=>{r[s]=o,++i===t&&e(r.join(Aj))})})},n_e=(n,e)=>{const t=n.split(Aj),r=[];for(let i=0;i<t.length;i++){const a=Cj(t[i],e);if(r.push(a),a.type==="error")break}return r},Mj=4;function gi(n){if(n)return r_e(n)}function r_e(n){for(var e in gi.prototype)n[e]=gi.prototype[e];return n}gi.prototype.on=gi.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};gi.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};gi.prototype.off=gi.prototype.removeListener=gi.prototype.removeAllListeners=gi.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this};gi.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this};gi.prototype.emitReserved=gi.prototype.emit;gi.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};gi.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Ys=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function kj(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}const i_e=Ys.setTimeout,a_e=Ys.clearTimeout;function nT(n,e){e.useNativeTimers?(n.setTimeoutFn=i_e.bind(Ys),n.clearTimeoutFn=a_e.bind(Ys)):(n.setTimeoutFn=Ys.setTimeout.bind(Ys),n.clearTimeoutFn=Ys.clearTimeout.bind(Ys))}const s_e=1.33;function o_e(n){return typeof n=="string"?l_e(n):Math.ceil((n.byteLength||n.size)*s_e)}function l_e(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}class u_e extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class Rj extends gi{constructor(e){super(),this.writable=!1,nT(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new u_e(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Cj(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}}const Pj="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),mM=64,c_e={};let $B=0,Nx=0,FB;function BB(n){let e="";do e=Pj[n%mM]+e,n=Math.floor(n/mM);while(n>0);return e}function Ij(){const n=BB(+new Date);return n!==FB?($B=0,FB=n):n+"."+BB($B++)}for(;Nx<mM;Nx++)c_e[Pj[Nx]]=Nx;function Dj(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function f_e(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let a=t[r].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}let Lj=!1;try{Lj=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const h_e=Lj;function Nj(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||h_e))return new XMLHttpRequest}catch{}if(!e)try{return new Ys[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function d_e(){}const p_e=function(){return new Nj({xdomain:!1}).responseType!=null}();class m_e extends Rj{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const r=location.protocol==="https:";let i=location.port;i||(i=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port,this.xs=e.secure!==r}const t=e&&e.forceBase64;this.supportsBinary=p_e&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};n_e(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,t_e(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let r="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Ij()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);const i=Dj(e),a=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(a?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new Em(this.uri(),e)}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}let Em=class $1 extends gi{constructor(e,t){super(),nT(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){const e=kj(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new Nj(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.opts.extraHeaders[r])}}catch{}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{t.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},t.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document<"u"&&(this.index=$1.requestsCount++,$1.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=d_e,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete $1.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Em.requestsCount=0;Em.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",UB);else if(typeof addEventListener=="function"){const n="onpagehide"in Ys?"pagehide":"unload";addEventListener(n,UB,!1)}}function UB(){for(let n in Em.requests)Em.requests.hasOwnProperty(n)&&Em.requests[n].abort()}const Oj=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),Ox=Ys.WebSocket||Ys.MozWebSocket,zB=!0,g_e="arraybuffer",VB=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class v_e extends Rj{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,r=VB?{}:kj(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=zB&&!VB?t?new Ox(e,t):new Ox(e):new Ox(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||g_e,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;Tj(r,this.supportsBinary,a=>{const s={};try{zB&&this.ws.send(a)}catch{}i&&Oj(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let r="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=Ij()),this.supportsBinary||(e.b64=1);const i=Dj(e),a=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(a?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}check(){return!!Ox}}const y_e={websocket:v_e,polling:m_e},__e=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,x_e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function gM(n){const e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=__e.exec(n||""),a={},s=14;for(;s--;)a[x_e[s]]=i[s]||"";return t!=-1&&r!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=b_e(a,a.path),a.queryKey=w_e(a,a.query),a}function b_e(n,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function w_e(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,a){i&&(t[i]=a)}),t}let $j=class Qp extends gi{constructor(e,t={}){super(),this.writeBuffer=[],e&&typeof e=="object"&&(t=e,e=null),e?(e=gM(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=gM(t.host).host),nT(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=f_e(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Mj,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new y_e[e](r)}open(){let e;if(this.opts.rememberUpgrade&&Qp.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(e){let t=this.createTransport(e),r=!1;Qp.priorWebsocketSuccess=!1;const i=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!r)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Qp.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(c(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const h=new Error("probe error");h.transport=t.name,this.emitReserved("upgradeError",h)}}))};function a(){r||(r=!0,c(),t.close(),t=null)}const s=f=>{const h=new Error("probe error: "+f);h.transport=t.name,a(),this.emitReserved("upgradeError",h)};function o(){s("transport closed")}function l(){s("socket closed")}function u(f){t&&f.name!==t.name&&a()}const c=()=>{t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",o),this.off("close",l),this.off("upgrading",u)};t.once("open",i),t.once("error",s),t.once("close",o),this.once("close",l),this.once("upgrading",u),t.open()}onOpen(){if(this.readyState="open",Qp.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(t+=o_e(i)),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const a={type:e,data:t,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}onError(e){Qp.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let r=0;const i=e.length;for(;r<i;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}};$j.protocol=Mj;function S_e(n,e="",t){let r=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),r=gM(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+e,r.href=r.protocol+"://"+a+(t&&t.port===r.port?"":":"+r.port),r}const T_e=typeof ArrayBuffer=="function",C_e=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Fj=Object.prototype.toString,E_e=typeof Blob=="function"||typeof Blob<"u"&&Fj.call(Blob)==="[object BlobConstructor]",A_e=typeof File=="function"||typeof File<"u"&&Fj.call(File)==="[object FileConstructor]";function jP(n){return T_e&&(n instanceof ArrayBuffer||C_e(n))||E_e&&n instanceof Blob||A_e&&n instanceof File}function F1(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(F1(n[t]))return!0;return!1}if(jP(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return F1(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&F1(n[t]))return!0;return!1}function M_e(n){const e=[],t=n.data,r=n;return r.data=vM(t,e),r.attachments=e.length,{packet:r,buffers:e}}function vM(n,e){if(!n)return n;if(jP(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=vM(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=vM(n[r],e));return t}return n}function k_e(n,e){return n.data=yM(n.data,e),delete n.attachments,n}function yM(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=yM(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=yM(n[t],e));return n}const R_e=5;var jn;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(jn||(jn={}));class P_e{constructor(e){this.replacer=e}encode(e){return(e.type===jn.EVENT||e.type===jn.ACK)&&F1(e)?this.encodeAsBinary({type:e.type===jn.EVENT?jn.BINARY_EVENT:jn.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===jn.BINARY_EVENT||e.type===jn.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=M_e(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}}class qP extends gi{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===jn.BINARY_EVENT;r||t.type===jn.BINARY_ACK?(t.type=r?jn.EVENT:jn.ACK,this.reconstructor=new I_e(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(jP(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(jn[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===jn.BINARY_EVENT||r.type===jn.BINARY_ACK){const a=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const s=e.substring(a,t);if(s!=Number(s)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(s)}if(e.charAt(t+1)==="/"){const a=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(a,t)}else r.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const a=t+1;for(;++t;){const s=e.charAt(t);if(s==null||Number(s)!=s){--t;break}if(t===e.length)break}r.id=Number(e.substring(a,t+1))}if(e.charAt(++t)){const a=this.tryParse(e.substr(t));if(qP.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case jn.CONNECT:return typeof t=="object";case jn.DISCONNECT:return t===void 0;case jn.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case jn.EVENT:case jn.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="string"||typeof t[0]=="number");case jn.ACK:case jn.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class I_e{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=k_e(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const D_e=Object.freeze(Object.defineProperty({__proto__:null,Decoder:qP,Encoder:P_e,get PacketType(){return jn},protocol:R_e},Symbol.toStringTag,{value:"Module"}));function Bo(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const L_e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Bj extends gi{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Bo(e,"open",this.onopen.bind(this)),Bo(e,"packet",this.onpacket.bind(this)),Bo(e,"error",this.onerror.bind(this)),Bo(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(L_e.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const r={type:jn.EVENT,data:t};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const s=this.ids++,o=t.pop();this._registerAckCallback(s,o),r.id=s}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(e,t){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let s=0;s<this.sendBuffer.length;s++)this.sendBuffer[s].id===e&&this.sendBuffer.splice(s,1);t.call(this,new Error("operation has timed out"))},i);this.acks[e]=(...s)=>{this.io.clearTimeoutFn(a),t.apply(this,[null,...s])}}emitWithAck(e,...t){const r=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((i,a)=>{t.push((s,o)=>r?s?a(s):i(o):i(s)),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...a)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...a)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:jn.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case jn.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case jn.EVENT:case jn.BINARY_EVENT:this.onevent(e);break;case jn.ACK:case jn.BINARY_ACK:this.onack(e);break;case jn.DISCONNECT:this.ondisconnect();break;case jn.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...i){r||(r=!0,t.packet({type:jn.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:jn.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function Lg(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Lg.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};Lg.prototype.reset=function(){this.attempts=0};Lg.prototype.setMin=function(n){this.ms=n};Lg.prototype.setMax=function(n){this.max=n};Lg.prototype.setJitter=function(n){this.jitter=n};class _M extends gi{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,nT(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Lg({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||D_e;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new $j(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Bo(t,"open",function(){r.onopen(),e&&e()}),a=Bo(t,"error",s=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",s),e?e(s):r.maybeReconnectOnOpen()});if(this._timeout!==!1){const s=this._timeout;s===0&&i();const o=this.setTimeoutFn(()=>{i(),t.close(),t.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&o.unref(),this.subs.push(function(){clearTimeout(o)})}return this.subs.push(i),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Bo(e,"ping",this.onping.bind(this)),Bo(e,"data",this.ondata.bind(this)),Bo(e,"error",this.onerror.bind(this)),Bo(e,"close",this.onclose.bind(this)),Bo(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){Oj(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new Bj(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Tv={};function r2(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=S_e(n,e.path||"/socket.io"),r=t.source,i=t.id,a=t.path,s=Tv[i]&&a in Tv[i].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||s;let l;return o?l=new _M(r,e):(Tv[i]||(Tv[i]=new _M(r,e)),l=Tv[i]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(r2,{Manager:_M,Socket:Bj,io:r2,connect:r2});/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const XP="148",pp={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},mp={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},N_e=0,HB=1,O_e=2,Uj=1,$_e=2,py=3,cf=0,po=1,rT=2,$x=3,tf=0,Am=1,WB=2,GB=3,jB=4,F_e=5,Jp=100,B_e=101,U_e=102,qB=103,XB=104,z_e=200,V_e=201,H_e=202,W_e=203,zj=204,Vj=205,G_e=206,j_e=207,q_e=208,X_e=209,K_e=210,Y_e=0,Z_e=1,Q_e=2,xM=3,J_e=4,exe=5,txe=6,nxe=7,KP=0,rxe=1,ixe=2,Bu=0,axe=1,sxe=2,oxe=3,lxe=4,uxe=5,Hj=300,Jm=301,eg=302,bM=303,wM=304,iT=306,tg=1e3,Js=1001,bw=1002,Ni=1003,SM=1004,B1=1005,Ya=1006,Wj=1007,dd=1008,pd=1009,cxe=1010,fxe=1011,Gj=1012,hxe=1013,Bh=1014,Iu=1015,A0=1016,dxe=1017,pxe=1018,Mm=1020,mxe=1021,gxe=1022,eo=1023,jj=1024,vxe=1025,Zh=1026,ng=1027,qj=1028,yxe=1029,_xe=1030,xxe=1031,bxe=1033,i2=33776,a2=33777,s2=33778,o2=33779,KB=35840,YB=35841,ZB=35842,QB=35843,wxe=36196,JB=37492,e4=37496,t4=37808,n4=37809,r4=37810,i4=37811,a4=37812,s4=37813,o4=37814,l4=37815,u4=37816,c4=37817,f4=37818,h4=37819,d4=37820,p4=37821,m4=36492,M0=2300,rg=2301,l2=2302,g4=2400,v4=2401,y4=2402,Sxe=2500,Txe=1,Xj=2,md=3e3,fr=3001,Cxe=3200,Exe=3201,YP=0,Axe=1,El="srgb",k0="srgb-linear",u2=7680,Mxe=519,TM=35044,_4="300 es",CM=1035;class Fd{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let a=0,s=i.length;a<s;a++)i[a].call(this,e);e.target=null}}}const na=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let x4=1234567;const Vy=Math.PI/180,R0=180/Math.PI;function Yo(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(na[n&255]+na[n>>8&255]+na[n>>16&255]+na[n>>24&255]+"-"+na[e&255]+na[e>>8&255]+"-"+na[e>>16&15|64]+na[e>>24&255]+"-"+na[t&63|128]+na[t>>8&255]+"-"+na[t>>16&255]+na[t>>24&255]+na[r&255]+na[r>>8&255]+na[r>>16&255]+na[r>>24&255]).toLowerCase()}function ca(n,e,t){return Math.max(e,Math.min(t,n))}function ZP(n,e){return(n%e+e)%e}function kxe(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function Rxe(n,e,t){return n!==e?(t-n)/(e-n):0}function Hy(n,e,t){return(1-t)*n+t*e}function Pxe(n,e,t,r){return Hy(n,e,1-Math.exp(-t*r))}function Ixe(n,e=1){return e-Math.abs(ZP(n,e*2)-e)}function Dxe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Lxe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function Nxe(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Oxe(n,e){return n+Math.random()*(e-n)}function $xe(n){return n*(.5-Math.random())}function Fxe(n){n!==void 0&&(x4=n);let e=x4+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Bxe(n){return n*Vy}function Uxe(n){return n*R0}function EM(n){return(n&n-1)===0&&n!==0}function Kj(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function ww(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function zxe(n,e,t,r,i){const a=Math.cos,s=Math.sin,o=a(t/2),l=s(t/2),u=a((e+r)/2),c=s((e+r)/2),f=a((e-r)/2),h=s((e-r)/2),d=a((r-e)/2),p=s((r-e)/2);switch(i){case"XYX":n.set(o*c,l*f,l*h,o*u);break;case"YZY":n.set(l*h,o*c,l*f,o*u);break;case"ZXZ":n.set(l*f,l*h,o*c,o*u);break;case"XZX":n.set(o*c,l*p,l*d,o*u);break;case"YXY":n.set(l*d,o*c,l*p,o*u);break;case"ZYZ":n.set(l*p,l*d,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Du(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Dr(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var bs=Object.freeze({__proto__:null,DEG2RAD:Vy,RAD2DEG:R0,generateUUID:Yo,clamp:ca,euclideanModulo:ZP,mapLinear:kxe,inverseLerp:Rxe,lerp:Hy,damp:Pxe,pingpong:Ixe,smoothstep:Dxe,smootherstep:Lxe,randInt:Nxe,randFloat:Oxe,randFloatSpread:$xe,seededRandom:Fxe,degToRad:Bxe,radToDeg:Uxe,isPowerOfTwo:EM,ceilPowerOfTwo:Kj,floorPowerOfTwo:ww,setQuaternionFromProperEuler:zxe,normalize:Dr,denormalize:Du});class un{constructor(e=0,t=0){un.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),a=this.x-e.x,s=this.y-e.y;return this.x=a*r-s*i+e.x,this.y=a*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Es{constructor(){Es.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,r,i,a,s,o,l,u){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=a,c[5]=l,c[6]=r,c[7]=s,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,a=this.elements,s=r[0],o=r[3],l=r[6],u=r[1],c=r[4],f=r[7],h=r[2],d=r[5],p=r[8],m=i[0],g=i[3],v=i[6],_=i[1],x=i[4],b=i[7],S=i[2],T=i[5],M=i[8];return a[0]=s*m+o*_+l*S,a[3]=s*g+o*x+l*T,a[6]=s*v+o*b+l*M,a[1]=u*m+c*_+f*S,a[4]=u*g+c*x+f*T,a[7]=u*v+c*b+f*M,a[2]=h*m+d*_+p*S,a[5]=h*g+d*x+p*T,a[8]=h*v+d*b+p*M,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8];return t*s*c-t*o*u-r*a*c+r*o*l+i*a*u-i*s*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],f=c*s-o*u,h=o*l-c*a,d=u*a-s*l,p=t*f+r*h+i*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=f*m,e[1]=(i*u-c*r)*m,e[2]=(o*r-i*s)*m,e[3]=h*m,e[4]=(c*t-i*l)*m,e[5]=(i*a-o*t)*m,e[6]=d*m,e[7]=(r*l-u*t)*m,e[8]=(s*t-r*a)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,a,s,o){const l=Math.cos(a),u=Math.sin(a);return this.set(r*l,r*u,-r*(l*s+u*o)+s+e,-i*u,i*l,-i*(-u*s+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(c2.makeScale(e,t)),this}rotate(e){return this.premultiply(c2.makeRotation(-e)),this}translate(e,t){return this.premultiply(c2.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const c2=new Es;function Yj(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function P0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Qh(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function U1(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const f2={[El]:{[k0]:Qh},[k0]:{[El]:U1}},Ma={legacyMode:!0,get workingColorSpace(){return k0},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(f2[e]&&f2[e][t]!==void 0){const r=f2[e][t];return n.r=r(n.r),n.g=r(n.g),n.b=r(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},Zj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wi={r:0,g:0,b:0},ko={h:0,s:0,l:0},Fx={h:0,s:0,l:0};function h2(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}function Bx(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let gn=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=El){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ma.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Ma.workingColorSpace){return this.r=e,this.g=t,this.b=r,Ma.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Ma.workingColorSpace){if(e=ZP(e,1),t=ca(t,0,1),r=ca(r,0,1),t===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,s=2*r-a;this.r=h2(s,a,e+1/3),this.g=h2(s,a,e),this.b=h2(s,a,e-1/3)}return Ma.toWorkingColorSpace(this,i),this}setStyle(e,t=El){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let a;const s=i[1],o=i[2];switch(s){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,Ma.toWorkingColorSpace(this,t),r(a[4]),this;if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,Ma.toWorkingColorSpace(this,t),r(a[4]),this;break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const l=parseFloat(a[1])/360,u=parseFloat(a[2])/100,c=parseFloat(a[3])/100;return r(a[4]),this.setHSL(l,u,c,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=i[1],s=a.length;if(s===3)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,Ma.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,Ma.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=El){const r=Zj[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Qh(e.r),this.g=Qh(e.g),this.b=Qh(e.b),this}copyLinearToSRGB(e){return this.r=U1(e.r),this.g=U1(e.g),this.b=U1(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=El){return Ma.fromWorkingColorSpace(Bx(this,wi),e),ca(wi.r*255,0,255)<<16^ca(wi.g*255,0,255)<<8^ca(wi.b*255,0,255)<<0}getHexString(e=El){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ma.workingColorSpace){Ma.fromWorkingColorSpace(Bx(this,wi),t);const r=wi.r,i=wi.g,a=wi.b,s=Math.max(r,i,a),o=Math.min(r,i,a);let l,u;const c=(o+s)/2;if(o===s)l=0,u=0;else{const f=s-o;switch(u=c<=.5?f/(s+o):f/(2-s-o),s){case r:l=(i-a)/f+(i<a?6:0);break;case i:l=(a-r)/f+2;break;case a:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=Ma.workingColorSpace){return Ma.fromWorkingColorSpace(Bx(this,wi),t),e.r=wi.r,e.g=wi.g,e.b=wi.b,e}getStyle(e=El){return Ma.fromWorkingColorSpace(Bx(this,wi),e),e!==El?`color(${e} ${wi.r} ${wi.g} ${wi.b})`:`rgb(${wi.r*255|0},${wi.g*255|0},${wi.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(ko),ko.h+=e,ko.s+=t,ko.l+=r,this.setHSL(ko.h,ko.s,ko.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(ko),e.getHSL(Fx);const r=Hy(ko.h,Fx.h,t),i=Hy(ko.s,Fx.s,t),a=Hy(ko.l,Fx.l,t);return this.setHSL(r,i,a),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};gn.NAMES=Zj;let gp;class Qj{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{gp===void 0&&(gp=P0("canvas")),gp.width=e.width,gp.height=e.height;const r=gp.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=gp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=P0("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),a=i.data;for(let s=0;s<a.length;s++)a[s]=Qh(a[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Qh(t[r]/255)*255):t[r]=Qh(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Jj{constructor(e=null){this.isSource=!0,this.uuid=Yo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let s=0,o=i.length;s<o;s++)i[s].isDataTexture?a.push(d2(i[s].image)):a.push(d2(i[s]))}else a=d2(i);r.url=a}return t||(e.images[this.uuid]=r),r}}function d2(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Qj.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Vxe=0;class Ki extends Fd{constructor(e=Ki.DEFAULT_IMAGE,t=Ki.DEFAULT_MAPPING,r=Js,i=Js,a=Ya,s=dd,o=eo,l=pd,u=Ki.DEFAULT_ANISOTROPY,c=md){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Vxe++}),this.uuid=Yo(),this.name="",this.source=new Jj(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=s,this.anisotropy=u,this.format=o,this.internalFormat=null,this.type=l,this.offset=new un(0,0),this.repeat=new un(1,1),this.center=new un(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Es,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Hj)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case tg:e.x=e.x-Math.floor(e.x);break;case Js:e.x=e.x<0?0:1;break;case bw:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case tg:e.y=e.y-Math.floor(e.y);break;case Js:e.y=e.y<0?0:1;break;case bw:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Ki.DEFAULT_IMAGE=null;Ki.DEFAULT_MAPPING=Hj;Ki.DEFAULT_ANISOTROPY=1;class Nr{constructor(e=0,t=0,r=0,i=1){Nr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,a=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*a,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*a,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*a,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,a;const l=e.elements,u=l[0],c=l[4],f=l[8],h=l[1],d=l[5],p=l[9],m=l[2],g=l[6],v=l[10];if(Math.abs(c-h)<.01&&Math.abs(f-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(c+h)<.1&&Math.abs(f+m)<.1&&Math.abs(p+g)<.1&&Math.abs(u+d+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const x=(u+1)/2,b=(d+1)/2,S=(v+1)/2,T=(c+h)/4,M=(f+m)/4,C=(p+g)/4;return x>b&&x>S?x<.01?(r=0,i=.707106781,a=.707106781):(r=Math.sqrt(x),i=T/r,a=M/r):b>S?b<.01?(r=.707106781,i=0,a=.707106781):(i=Math.sqrt(b),r=T/i,a=C/i):S<.01?(r=.707106781,i=.707106781,a=0):(a=Math.sqrt(S),r=M/a,i=C/a),this.set(r,i,a,t),this}let _=Math.sqrt((g-p)*(g-p)+(f-m)*(f-m)+(h-c)*(h-c));return Math.abs(_)<.001&&(_=1),this.x=(g-p)/_,this.y=(f-m)/_,this.z=(h-c)/_,this.w=Math.acos((u+d+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ff extends Fd{constructor(e=1,t=1,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Nr(0,0,e,t),this.scissorTest=!1,this.viewport=new Nr(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new Ki(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Ya,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Jj(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class e7 extends Ki{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Ni,this.minFilter=Ni,this.wrapR=Js,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Hxe extends Ki{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Ni,this.minFilter=Ni,this.wrapR=Js,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Gl{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,a,s,o){let l=r[i+0],u=r[i+1],c=r[i+2],f=r[i+3];const h=a[s+0],d=a[s+1],p=a[s+2],m=a[s+3];if(o===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=f;return}if(o===1){e[t+0]=h,e[t+1]=d,e[t+2]=p,e[t+3]=m;return}if(f!==m||l!==h||u!==d||c!==p){let g=1-o;const v=l*h+u*d+c*p+f*m,_=v>=0?1:-1,x=1-v*v;if(x>Number.EPSILON){const S=Math.sqrt(x),T=Math.atan2(S,v*_);g=Math.sin(g*T)/S,o=Math.sin(o*T)/S}const b=o*_;if(l=l*g+h*b,u=u*g+d*b,c=c*g+p*b,f=f*g+m*b,g===1-o){const S=1/Math.sqrt(l*l+u*u+c*c+f*f);l*=S,u*=S,c*=S,f*=S}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,a,s){const o=r[i],l=r[i+1],u=r[i+2],c=r[i+3],f=a[s],h=a[s+1],d=a[s+2],p=a[s+3];return e[t]=o*p+c*f+l*d-u*h,e[t+1]=l*p+c*h+u*f-o*d,e[t+2]=u*p+c*d+o*h-l*f,e[t+3]=c*p-o*f-l*h-u*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const r=e._x,i=e._y,a=e._z,s=e._order,o=Math.cos,l=Math.sin,u=o(r/2),c=o(i/2),f=o(a/2),h=l(r/2),d=l(i/2),p=l(a/2);switch(s){case"XYZ":this._x=h*c*f+u*d*p,this._y=u*d*f-h*c*p,this._z=u*c*p+h*d*f,this._w=u*c*f-h*d*p;break;case"YXZ":this._x=h*c*f+u*d*p,this._y=u*d*f-h*c*p,this._z=u*c*p-h*d*f,this._w=u*c*f+h*d*p;break;case"ZXY":this._x=h*c*f-u*d*p,this._y=u*d*f+h*c*p,this._z=u*c*p+h*d*f,this._w=u*c*f-h*d*p;break;case"ZYX":this._x=h*c*f-u*d*p,this._y=u*d*f+h*c*p,this._z=u*c*p-h*d*f,this._w=u*c*f+h*d*p;break;case"YZX":this._x=h*c*f+u*d*p,this._y=u*d*f+h*c*p,this._z=u*c*p-h*d*f,this._w=u*c*f-h*d*p;break;case"XZY":this._x=h*c*f-u*d*p,this._y=u*d*f-h*c*p,this._z=u*c*p+h*d*f,this._w=u*c*f+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],a=t[8],s=t[1],o=t[5],l=t[9],u=t[2],c=t[6],f=t[10],h=r+o+f;if(h>0){const d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(c-l)*d,this._y=(a-u)*d,this._z=(s-i)*d}else if(r>o&&r>f){const d=2*Math.sqrt(1+r-o-f);this._w=(c-l)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(a+u)/d}else if(o>f){const d=2*Math.sqrt(1+o-r-f);this._w=(a-u)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(l+c)/d}else{const d=2*Math.sqrt(1+f-r-o);this._w=(s-i)/d,this._x=(a+u)/d,this._y=(l+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ca(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,a=e._z,s=e._w,o=t._x,l=t._y,u=t._z,c=t._w;return this._x=r*c+s*o+i*u-a*l,this._y=i*c+s*l+a*o-r*u,this._z=a*c+s*u+r*l-i*o,this._w=s*c-r*o-i*l-a*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,a=this._z,s=this._w;let o=s*e._w+r*e._x+i*e._y+a*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=i,this._z=a,this;const l=1-o*o;if(l<=Number.EPSILON){const d=1-t;return this._w=d*s+t*this._w,this._x=d*r+t*this._x,this._y=d*i+t*this._y,this._z=d*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),c=Math.atan2(u,o),f=Math.sin((1-t)*c)/u,h=Math.sin(t*c)/u;return this._w=s*f+this._w*h,this._x=r*f+this._x*h,this._y=i*f+this._y*h,this._z=a*f+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(a),r*Math.cos(a),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class De{constructor(e=0,t=0,r=0){De.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(b4.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(b4.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*i,this.y=a[1]*t+a[4]*r+a[7]*i,this.z=a[2]*t+a[5]*r+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,a=e.elements,s=1/(a[3]*t+a[7]*r+a[11]*i+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*i+a[12])*s,this.y=(a[1]*t+a[5]*r+a[9]*i+a[13])*s,this.z=(a[2]*t+a[6]*r+a[10]*i+a[14])*s,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,a=e.x,s=e.y,o=e.z,l=e.w,u=l*t+s*i-o*r,c=l*r+o*t-a*i,f=l*i+a*r-s*t,h=-a*t-s*r-o*i;return this.x=u*l+h*-a+c*-o-f*-s,this.y=c*l+h*-s+f*-a-u*-o,this.z=f*l+h*-o+u*-s-c*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i,this.y=a[1]*t+a[5]*r+a[9]*i,this.z=a[2]*t+a[6]*r+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,a=e.z,s=t.x,o=t.y,l=t.z;return this.x=i*l-a*o,this.y=a*s-r*l,this.z=r*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return p2.copy(this).projectOnVector(e),this.sub(p2)}reflect(e){return this.sub(p2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(ca(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const p2=new De,b4=new Gl;class Ng{constructor(e=new De(1/0,1/0,1/0),t=new De(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,a=-1/0,s=-1/0,o=-1/0;for(let l=0,u=e.length;l<u;l+=3){const c=e[l],f=e[l+1],h=e[l+2];c<t&&(t=c),f<r&&(r=f),h<i&&(i=h),c>a&&(a=c),f>s&&(s=f),h>o&&(o=h)}return this.min.set(t,r,i),this.max.set(a,s,o),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,a=-1/0,s=-1/0,o=-1/0;for(let l=0,u=e.count;l<u;l++){const c=e.getX(l),f=e.getY(l),h=e.getZ(l);c<t&&(t=c),f<r&&(r=f),h<i&&(i=h),c>a&&(a=c),f>s&&(s=f),h>o&&(o=h)}return this.min.set(t,r,i),this.max.set(a,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Xf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){const a=r.attributes.position;for(let s=0,o=a.count;s<o;s++)Xf.fromBufferAttribute(a,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Xf)}else r.boundingBox===null&&r.computeBoundingBox(),m2.copy(r.boundingBox),m2.applyMatrix4(e.matrixWorld),this.union(m2);const i=e.children;for(let a=0,s=i.length;a<s;a++)this.expandByObject(i[a],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Xf),Xf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Cv),Ux.subVectors(this.max,Cv),vp.subVectors(e.a,Cv),yp.subVectors(e.b,Cv),_p.subVectors(e.c,Cv),_c.subVectors(yp,vp),xc.subVectors(_p,yp),Kf.subVectors(vp,_p);let t=[0,-_c.z,_c.y,0,-xc.z,xc.y,0,-Kf.z,Kf.y,_c.z,0,-_c.x,xc.z,0,-xc.x,Kf.z,0,-Kf.x,-_c.y,_c.x,0,-xc.y,xc.x,0,-Kf.y,Kf.x,0];return!g2(t,vp,yp,_p,Ux)||(t=[1,0,0,0,1,0,0,0,1],!g2(t,vp,yp,_p,Ux))?!1:(zx.crossVectors(_c,xc),t=[zx.x,zx.y,zx.z],g2(t,vp,yp,_p,Ux))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Xf.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Xf).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hu=[new De,new De,new De,new De,new De,new De,new De,new De],Xf=new De,m2=new Ng,vp=new De,yp=new De,_p=new De,_c=new De,xc=new De,Kf=new De,Cv=new De,Ux=new De,zx=new De,Yf=new De;function g2(n,e,t,r,i){for(let a=0,s=n.length-3;a<=s;a+=3){Yf.fromArray(n,a);const o=i.x*Math.abs(Yf.x)+i.y*Math.abs(Yf.y)+i.z*Math.abs(Yf.z),l=e.dot(Yf),u=t.dot(Yf),c=r.dot(Yf);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>o)return!1}return!0}const Wxe=new Ng,Ev=new De,v2=new De;class Og{constructor(e=new De,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):Wxe.setFromPoints(e).getCenter(r);let i=0;for(let a=0,s=e.length;a<s;a++)i=Math.max(i,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Ev.subVectors(e,this.center);const t=Ev.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Ev,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(v2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Ev.copy(e.center).add(v2)),this.expandByPoint(Ev.copy(e.center).sub(v2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const du=new De,y2=new De,Vx=new De,bc=new De,_2=new De,Hx=new De,x2=new De;class aT{constructor(e=new De,t=new De(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,du)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=du.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(du.copy(this.direction).multiplyScalar(t).add(this.origin),du.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){y2.copy(e).add(t).multiplyScalar(.5),Vx.copy(t).sub(e).normalize(),bc.copy(this.origin).sub(y2);const a=e.distanceTo(t)*.5,s=-this.direction.dot(Vx),o=bc.dot(this.direction),l=-bc.dot(Vx),u=bc.lengthSq(),c=Math.abs(1-s*s);let f,h,d,p;if(c>0)if(f=s*l-o,h=s*o-l,p=a*c,f>=0)if(h>=-p)if(h<=p){const m=1/c;f*=m,h*=m,d=f*(f+s*h+2*o)+h*(s*f+h+2*l)+u}else h=a,f=Math.max(0,-(s*h+o)),d=-f*f+h*(h+2*l)+u;else h=-a,f=Math.max(0,-(s*h+o)),d=-f*f+h*(h+2*l)+u;else h<=-p?(f=Math.max(0,-(-s*a+o)),h=f>0?-a:Math.min(Math.max(-a,-l),a),d=-f*f+h*(h+2*l)+u):h<=p?(f=0,h=Math.min(Math.max(-a,-l),a),d=h*(h+2*l)+u):(f=Math.max(0,-(s*a+o)),h=f>0?a:Math.min(Math.max(-a,-l),a),d=-f*f+h*(h+2*l)+u);else h=s>0?-a:a,f=Math.max(0,-(s*h+o)),d=-f*f+h*(h+2*l)+u;return r&&r.copy(this.direction).multiplyScalar(f).add(this.origin),i&&i.copy(Vx).multiplyScalar(h).add(y2),d}intersectSphere(e,t){du.subVectors(e.center,this.origin);const r=du.dot(this.direction),i=du.dot(du)-r*r,a=e.radius*e.radius;if(i>a)return null;const s=Math.sqrt(a-i),o=r-s,l=r+s;return o<0&&l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,a,s,o,l;const u=1/this.direction.x,c=1/this.direction.y,f=1/this.direction.z,h=this.origin;return u>=0?(r=(e.min.x-h.x)*u,i=(e.max.x-h.x)*u):(r=(e.max.x-h.x)*u,i=(e.min.x-h.x)*u),c>=0?(a=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(a=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||a>i||((a>r||isNaN(r))&&(r=a),(s<i||isNaN(i))&&(i=s),f>=0?(o=(e.min.z-h.z)*f,l=(e.max.z-h.z)*f):(o=(e.max.z-h.z)*f,l=(e.min.z-h.z)*f),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,du)!==null}intersectTriangle(e,t,r,i,a){_2.subVectors(t,e),Hx.subVectors(r,e),x2.crossVectors(_2,Hx);let s=this.direction.dot(x2),o;if(s>0){if(i)return null;o=1}else if(s<0)o=-1,s=-s;else return null;bc.subVectors(this.origin,e);const l=o*this.direction.dot(Hx.crossVectors(bc,Hx));if(l<0)return null;const u=o*this.direction.dot(_2.cross(bc));if(u<0||l+u>s)return null;const c=-o*bc.dot(x2);return c<0?null:this.at(c/s,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Un{constructor(){Un.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,r,i,a,s,o,l,u,c,f,h,d,p,m,g){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=a,v[5]=s,v[9]=o,v[13]=l,v[2]=u,v[6]=c,v[10]=f,v[14]=h,v[3]=d,v[7]=p,v[11]=m,v[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Un().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/xp.setFromMatrixColumn(e,0).length(),a=1/xp.setFromMatrixColumn(e,1).length(),s=1/xp.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,a=e.z,s=Math.cos(r),o=Math.sin(r),l=Math.cos(i),u=Math.sin(i),c=Math.cos(a),f=Math.sin(a);if(e.order==="XYZ"){const h=s*c,d=s*f,p=o*c,m=o*f;t[0]=l*c,t[4]=-l*f,t[8]=u,t[1]=d+p*u,t[5]=h-m*u,t[9]=-o*l,t[2]=m-h*u,t[6]=p+d*u,t[10]=s*l}else if(e.order==="YXZ"){const h=l*c,d=l*f,p=u*c,m=u*f;t[0]=h+m*o,t[4]=p*o-d,t[8]=s*u,t[1]=s*f,t[5]=s*c,t[9]=-o,t[2]=d*o-p,t[6]=m+h*o,t[10]=s*l}else if(e.order==="ZXY"){const h=l*c,d=l*f,p=u*c,m=u*f;t[0]=h-m*o,t[4]=-s*f,t[8]=p+d*o,t[1]=d+p*o,t[5]=s*c,t[9]=m-h*o,t[2]=-s*u,t[6]=o,t[10]=s*l}else if(e.order==="ZYX"){const h=s*c,d=s*f,p=o*c,m=o*f;t[0]=l*c,t[4]=p*u-d,t[8]=h*u+m,t[1]=l*f,t[5]=m*u+h,t[9]=d*u-p,t[2]=-u,t[6]=o*l,t[10]=s*l}else if(e.order==="YZX"){const h=s*l,d=s*u,p=o*l,m=o*u;t[0]=l*c,t[4]=m-h*f,t[8]=p*f+d,t[1]=f,t[5]=s*c,t[9]=-o*c,t[2]=-u*c,t[6]=d*f+p,t[10]=h-m*f}else if(e.order==="XZY"){const h=s*l,d=s*u,p=o*l,m=o*u;t[0]=l*c,t[4]=-f,t[8]=u*c,t[1]=h*f+m,t[5]=s*c,t[9]=d*f-p,t[2]=p*f-d,t[6]=o*c,t[10]=m*f+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Gxe,e,jxe)}lookAt(e,t,r){const i=this.elements;return gs.subVectors(e,t),gs.lengthSq()===0&&(gs.z=1),gs.normalize(),wc.crossVectors(r,gs),wc.lengthSq()===0&&(Math.abs(r.z)===1?gs.x+=1e-4:gs.z+=1e-4,gs.normalize(),wc.crossVectors(r,gs)),wc.normalize(),Wx.crossVectors(gs,wc),i[0]=wc.x,i[4]=Wx.x,i[8]=gs.x,i[1]=wc.y,i[5]=Wx.y,i[9]=gs.y,i[2]=wc.z,i[6]=Wx.z,i[10]=gs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,a=this.elements,s=r[0],o=r[4],l=r[8],u=r[12],c=r[1],f=r[5],h=r[9],d=r[13],p=r[2],m=r[6],g=r[10],v=r[14],_=r[3],x=r[7],b=r[11],S=r[15],T=i[0],M=i[4],C=i[8],k=i[12],R=i[1],P=i[5],N=i[9],L=i[13],F=i[2],O=i[6],B=i[10],H=i[14],j=i[3],K=i[7],J=i[11],re=i[15];return a[0]=s*T+o*R+l*F+u*j,a[4]=s*M+o*P+l*O+u*K,a[8]=s*C+o*N+l*B+u*J,a[12]=s*k+o*L+l*H+u*re,a[1]=c*T+f*R+h*F+d*j,a[5]=c*M+f*P+h*O+d*K,a[9]=c*C+f*N+h*B+d*J,a[13]=c*k+f*L+h*H+d*re,a[2]=p*T+m*R+g*F+v*j,a[6]=p*M+m*P+g*O+v*K,a[10]=p*C+m*N+g*B+v*J,a[14]=p*k+m*L+g*H+v*re,a[3]=_*T+x*R+b*F+S*j,a[7]=_*M+x*P+b*O+S*K,a[11]=_*C+x*N+b*B+S*J,a[15]=_*k+x*L+b*H+S*re,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],a=e[12],s=e[1],o=e[5],l=e[9],u=e[13],c=e[2],f=e[6],h=e[10],d=e[14],p=e[3],m=e[7],g=e[11],v=e[15];return p*(+a*l*f-i*u*f-a*o*h+r*u*h+i*o*d-r*l*d)+m*(+t*l*d-t*u*h+a*s*h-i*s*d+i*u*c-a*l*c)+g*(+t*u*f-t*o*d-a*s*f+r*s*d+a*o*c-r*u*c)+v*(-i*o*c-t*l*f+t*o*h+i*s*f-r*s*h+r*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],d=e[11],p=e[12],m=e[13],g=e[14],v=e[15],_=f*g*u-m*h*u+m*l*d-o*g*d-f*l*v+o*h*v,x=p*h*u-c*g*u-p*l*d+s*g*d+c*l*v-s*h*v,b=c*m*u-p*f*u+p*o*d-s*m*d-c*o*v+s*f*v,S=p*f*l-c*m*l-p*o*h+s*m*h+c*o*g-s*f*g,T=t*_+r*x+i*b+a*S;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/T;return e[0]=_*M,e[1]=(m*h*a-f*g*a-m*i*d+r*g*d+f*i*v-r*h*v)*M,e[2]=(o*g*a-m*l*a+m*i*u-r*g*u-o*i*v+r*l*v)*M,e[3]=(f*l*a-o*h*a-f*i*u+r*h*u+o*i*d-r*l*d)*M,e[4]=x*M,e[5]=(c*g*a-p*h*a+p*i*d-t*g*d-c*i*v+t*h*v)*M,e[6]=(p*l*a-s*g*a-p*i*u+t*g*u+s*i*v-t*l*v)*M,e[7]=(s*h*a-c*l*a+c*i*u-t*h*u-s*i*d+t*l*d)*M,e[8]=b*M,e[9]=(p*f*a-c*m*a-p*r*d+t*m*d+c*r*v-t*f*v)*M,e[10]=(s*m*a-p*o*a+p*r*u-t*m*u-s*r*v+t*o*v)*M,e[11]=(c*o*a-s*f*a-c*r*u+t*f*u+s*r*d-t*o*d)*M,e[12]=S*M,e[13]=(c*m*i-p*f*i+p*r*h-t*m*h-c*r*g+t*f*g)*M,e[14]=(p*o*i-s*m*i-p*r*l+t*m*l+s*r*g-t*o*g)*M,e[15]=(s*f*i-c*o*i+c*r*l-t*f*l-s*r*h+t*o*h)*M,this}scale(e){const t=this.elements,r=e.x,i=e.y,a=e.z;return t[0]*=r,t[4]*=i,t[8]*=a,t[1]*=r,t[5]*=i,t[9]*=a,t[2]*=r,t[6]*=i,t[10]*=a,t[3]*=r,t[7]*=i,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),a=1-r,s=e.x,o=e.y,l=e.z,u=a*s,c=a*o;return this.set(u*s+r,u*o-i*l,u*l+i*o,0,u*o+i*l,c*o+r,c*l-i*s,0,u*l-i*o,c*l+i*s,a*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,a,s){return this.set(1,r,a,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,a=t._x,s=t._y,o=t._z,l=t._w,u=a+a,c=s+s,f=o+o,h=a*u,d=a*c,p=a*f,m=s*c,g=s*f,v=o*f,_=l*u,x=l*c,b=l*f,S=r.x,T=r.y,M=r.z;return i[0]=(1-(m+v))*S,i[1]=(d+b)*S,i[2]=(p-x)*S,i[3]=0,i[4]=(d-b)*T,i[5]=(1-(h+v))*T,i[6]=(g+_)*T,i[7]=0,i[8]=(p+x)*M,i[9]=(g-_)*M,i[10]=(1-(h+m))*M,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let a=xp.set(i[0],i[1],i[2]).length();const s=xp.set(i[4],i[5],i[6]).length(),o=xp.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],Ro.copy(this);const u=1/a,c=1/s,f=1/o;return Ro.elements[0]*=u,Ro.elements[1]*=u,Ro.elements[2]*=u,Ro.elements[4]*=c,Ro.elements[5]*=c,Ro.elements[6]*=c,Ro.elements[8]*=f,Ro.elements[9]*=f,Ro.elements[10]*=f,t.setFromRotationMatrix(Ro),r.x=a,r.y=s,r.z=o,this}makePerspective(e,t,r,i,a,s){const o=this.elements,l=2*a/(t-e),u=2*a/(r-i),c=(t+e)/(t-e),f=(r+i)/(r-i),h=-(s+a)/(s-a),d=-2*s*a/(s-a);return o[0]=l,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=f,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,i,a,s){const o=this.elements,l=1/(t-e),u=1/(r-i),c=1/(s-a),f=(t+e)*l,h=(r+i)*u,d=(s+a)*c;return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-f,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const xp=new De,Ro=new Un,Gxe=new De(0,0,0),jxe=new De(1,1,1),wc=new De,Wx=new De,gs=new De,w4=new Un,S4=new Gl;class w_{constructor(e=0,t=0,r=0,i=w_.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,a=i[0],s=i[4],o=i[8],l=i[1],u=i[5],c=i[9],f=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(ca(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ca(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,a),this._z=0);break;case"ZXY":this._x=Math.asin(ca(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-f,d),this._z=Math.atan2(-s,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-ca(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-s,u));break;case"YZX":this._z=Math.asin(ca(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-ca(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return w4.makeRotationFromQuaternion(e),this.setFromRotationMatrix(w4,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return S4.setFromEuler(this),this.setFromQuaternion(S4,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}w_.DefaultOrder="XYZ";w_.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class QP{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let qxe=0;const T4=new De,bp=new Gl,pu=new Un,Gx=new De,Av=new De,Xxe=new De,Kxe=new Gl,C4=new De(1,0,0),E4=new De(0,1,0),A4=new De(0,0,1),Yxe={type:"added"},M4={type:"removed"};class Hr extends Fd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:qxe++}),this.uuid=Yo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Hr.DefaultUp.clone();const e=new De,t=new w_,r=new Gl,i=new De(1,1,1);function a(){r.setFromEuler(t,!1)}function s(){t.setFromQuaternion(r,void 0,!1)}t._onChange(a),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Un},normalMatrix:{value:new Es}}),this.matrix=new Un,this.matrixWorld=new Un,this.matrixAutoUpdate=Hr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Hr.DefaultMatrixWorldAutoUpdate,this.layers=new QP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return bp.setFromAxisAngle(e,t),this.quaternion.multiply(bp),this}rotateOnWorldAxis(e,t){return bp.setFromAxisAngle(e,t),this.quaternion.premultiply(bp),this}rotateX(e){return this.rotateOnAxis(C4,e)}rotateY(e){return this.rotateOnAxis(E4,e)}rotateZ(e){return this.rotateOnAxis(A4,e)}translateOnAxis(e,t){return T4.copy(e).applyQuaternion(this.quaternion),this.position.add(T4.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(C4,e)}translateY(e){return this.translateOnAxis(E4,e)}translateZ(e){return this.translateOnAxis(A4,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pu.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Gx.copy(e):Gx.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Av.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pu.lookAt(Av,Gx,this.up):pu.lookAt(Gx,Av,this.up),this.quaternion.setFromRotationMatrix(pu),i&&(pu.extractRotation(i.matrixWorld),bp.setFromRotationMatrix(pu),this.quaternion.premultiply(bp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Yxe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(M4)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(M4)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),pu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),pu.multiply(e.parent.matrixWorld)),e.applyMatrix4(pu),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const s=this.children[r].getObjectByProperty(e,t);if(s!==void 0)return s}}getObjectsByProperty(e,t){let r=[];this[e]===t&&r.push(this);for(let i=0,a=this.children.length;i<a;i++){const s=this.children[i].getObjectsByProperty(e,t);s.length>0&&(r=r.concat(s))}return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Av,e,Xxe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Av,Kxe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const a=t[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let a=0,s=i.length;a<s;a++){const o=i[a];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function a(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const f=l[u];a(e.shapes,f)}else a(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,u=this.material.length;l<u;l++)o.push(a(e.materials,this.material[l]));i.material=o}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(a(e.animations,l))}}if(t){const o=s(e.geometries),l=s(e.materials),u=s(e.textures),c=s(e.images),f=s(e.shapes),h=s(e.skeletons),d=s(e.animations),p=s(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),f.length>0&&(r.shapes=f),h.length>0&&(r.skeletons=h),d.length>0&&(r.animations=d),p.length>0&&(r.nodes=p)}return r.object=i,r;function s(o){const l=[];for(const u in o){const c=o[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Hr.DefaultUp=new De(0,1,0);Hr.DefaultMatrixAutoUpdate=!0;Hr.DefaultMatrixWorldAutoUpdate=!0;const Po=new De,mu=new De,b2=new De,gu=new De,wp=new De,Sp=new De,k4=new De,w2=new De,S2=new De,T2=new De;let C2=class em{constructor(e=new De,t=new De,r=new De){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Po.subVectors(e,t),i.cross(Po);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,t,r,i,a){Po.subVectors(i,t),mu.subVectors(r,t),b2.subVectors(e,t);const s=Po.dot(Po),o=Po.dot(mu),l=Po.dot(b2),u=mu.dot(mu),c=mu.dot(b2),f=s*u-o*o;if(f===0)return a.set(-2,-1,-1);const h=1/f,d=(u*l-o*c)*h,p=(s*c-o*l)*h;return a.set(1-d-p,p,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,gu),gu.x>=0&&gu.y>=0&&gu.x+gu.y<=1}static getUV(e,t,r,i,a,s,o,l){return this.getBarycoord(e,t,r,i,gu),l.set(0,0),l.addScaledVector(a,gu.x),l.addScaledVector(s,gu.y),l.addScaledVector(o,gu.z),l}static isFrontFacing(e,t,r,i){return Po.subVectors(r,t),mu.subVectors(e,t),Po.cross(mu).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Po.subVectors(this.c,this.b),mu.subVectors(this.a,this.b),Po.cross(mu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return em.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return em.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,a){return em.getUV(e,this.a,this.b,this.c,t,r,i,a)}containsPoint(e){return em.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return em.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,a=this.c;let s,o;wp.subVectors(i,r),Sp.subVectors(a,r),w2.subVectors(e,r);const l=wp.dot(w2),u=Sp.dot(w2);if(l<=0&&u<=0)return t.copy(r);S2.subVectors(e,i);const c=wp.dot(S2),f=Sp.dot(S2);if(c>=0&&f<=c)return t.copy(i);const h=l*f-c*u;if(h<=0&&l>=0&&c<=0)return s=l/(l-c),t.copy(r).addScaledVector(wp,s);T2.subVectors(e,a);const d=wp.dot(T2),p=Sp.dot(T2);if(p>=0&&d<=p)return t.copy(a);const m=d*u-l*p;if(m<=0&&u>=0&&p<=0)return o=u/(u-p),t.copy(r).addScaledVector(Sp,o);const g=c*p-d*f;if(g<=0&&f-c>=0&&d-p>=0)return k4.subVectors(a,i),o=(f-c)/(f-c+(d-p)),t.copy(i).addScaledVector(k4,o);const v=1/(g+m+h);return s=m*v,o=h*v,t.copy(r).addScaledVector(wp,s).addScaledVector(Sp,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},Zxe=0;class Zo extends Fd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Zxe++}),this.uuid=Yo(),this.name="",this.type="Material",this.blending=Am,this.side=cf,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=zj,this.blendDst=Vj,this.blendEquation=Jp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=xM,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Mxe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=u2,this.stencilZFail=u2,this.stencilZPass=u2,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Am&&(r.blending=this.blending),this.side!==cf&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(a){const s=[];for(const o in a){const l=a[o];delete l.metadata,s.push(l)}return s}if(t){const a=i(e.textures),s=i(e.images);a.length>0&&(r.textures=a),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let a=0;a!==i;++a)r[a]=t[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class jc extends Zo{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new gn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=KP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const di=new De,jx=new un;class Yi{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=TM,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)jx.fromBufferAttribute(this,t),jx.applyMatrix3(e),this.setXY(t,jx.x,jx.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.applyMatrix3(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.applyMatrix4(e),this.setXYZ(t,di.x,di.y,di.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.applyNormalMatrix(e),this.setXYZ(t,di.x,di.y,di.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)di.fromBufferAttribute(this,t),di.transformDirection(e),this.setXYZ(t,di.x,di.y,di.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Du(t,this.array)),t}setX(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Du(t,this.array)),t}setY(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Du(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Du(t,this.array)),t}setW(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Dr(t,this.array),r=Dr(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Dr(t,this.array),r=Dr(r,this.array),i=Dr(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,a){return e*=this.itemSize,this.normalized&&(t=Dr(t,this.array),r=Dr(r,this.array),i=Dr(i,this.array),a=Dr(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==TM&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class t7 extends Yi{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class n7 extends Yi{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Ei extends Yi{constructor(e,t,r){super(new Float32Array(e),t,r)}}let Qxe=0;const Fs=new Un,E2=new Hr,Tp=new De,vs=new Ng,Mv=new Ng,Li=new De;class xa extends Fd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Qxe++}),this.uuid=Yo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Yj(e)?n7:t7)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new Es().getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fs.makeRotationFromQuaternion(e),this.applyMatrix4(Fs),this}rotateX(e){return Fs.makeRotationX(e),this.applyMatrix4(Fs),this}rotateY(e){return Fs.makeRotationY(e),this.applyMatrix4(Fs),this}rotateZ(e){return Fs.makeRotationZ(e),this.applyMatrix4(Fs),this}translate(e,t,r){return Fs.makeTranslation(e,t,r),this.applyMatrix4(Fs),this}scale(e,t,r){return Fs.makeScale(e,t,r),this.applyMatrix4(Fs),this}lookAt(e){return E2.lookAt(e),E2.updateMatrix(),this.applyMatrix4(E2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Tp).negate(),this.translate(Tp.x,Tp.y,Tp.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const a=e[r];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Ei(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ng);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new De(-1/0,-1/0,-1/0),new De(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const a=t[r];vs.setFromBufferAttribute(a),this.morphTargetsRelative?(Li.addVectors(this.boundingBox.min,vs.min),this.boundingBox.expandByPoint(Li),Li.addVectors(this.boundingBox.max,vs.max),this.boundingBox.expandByPoint(Li)):(this.boundingBox.expandByPoint(vs.min),this.boundingBox.expandByPoint(vs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Og);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new De,1/0);return}if(e){const r=this.boundingSphere.center;if(vs.setFromBufferAttribute(e),t)for(let a=0,s=t.length;a<s;a++){const o=t[a];Mv.setFromBufferAttribute(o),this.morphTargetsRelative?(Li.addVectors(vs.min,Mv.min),vs.expandByPoint(Li),Li.addVectors(vs.max,Mv.max),vs.expandByPoint(Li)):(vs.expandByPoint(Mv.min),vs.expandByPoint(Mv.max))}vs.getCenter(r);let i=0;for(let a=0,s=e.count;a<s;a++)Li.fromBufferAttribute(e,a),i=Math.max(i,r.distanceToSquared(Li));if(t)for(let a=0,s=t.length;a<s;a++){const o=t[a],l=this.morphTargetsRelative;for(let u=0,c=o.count;u<c;u++)Li.fromBufferAttribute(o,u),l&&(Tp.fromBufferAttribute(e,u),Li.add(Tp)),i=Math.max(i,r.distanceToSquared(Li))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,a=t.normal.array,s=t.uv.array,o=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Yi(new Float32Array(4*o),4));const l=this.getAttribute("tangent").array,u=[],c=[];for(let R=0;R<o;R++)u[R]=new De,c[R]=new De;const f=new De,h=new De,d=new De,p=new un,m=new un,g=new un,v=new De,_=new De;function x(R,P,N){f.fromArray(i,R*3),h.fromArray(i,P*3),d.fromArray(i,N*3),p.fromArray(s,R*2),m.fromArray(s,P*2),g.fromArray(s,N*2),h.sub(f),d.sub(f),m.sub(p),g.sub(p);const L=1/(m.x*g.y-g.x*m.y);isFinite(L)&&(v.copy(h).multiplyScalar(g.y).addScaledVector(d,-m.y).multiplyScalar(L),_.copy(d).multiplyScalar(m.x).addScaledVector(h,-g.x).multiplyScalar(L),u[R].add(v),u[P].add(v),u[N].add(v),c[R].add(_),c[P].add(_),c[N].add(_))}let b=this.groups;b.length===0&&(b=[{start:0,count:r.length}]);for(let R=0,P=b.length;R<P;++R){const N=b[R],L=N.start,F=N.count;for(let O=L,B=L+F;O<B;O+=3)x(r[O+0],r[O+1],r[O+2])}const S=new De,T=new De,M=new De,C=new De;function k(R){M.fromArray(a,R*3),C.copy(M);const P=u[R];S.copy(P),S.sub(M.multiplyScalar(M.dot(P))).normalize(),T.crossVectors(C,P);const L=T.dot(c[R])<0?-1:1;l[R*4]=S.x,l[R*4+1]=S.y,l[R*4+2]=S.z,l[R*4+3]=L}for(let R=0,P=b.length;R<P;++R){const N=b[R],L=N.start,F=N.count;for(let O=L,B=L+F;O<B;O+=3)k(r[O+0]),k(r[O+1]),k(r[O+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Yi(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let h=0,d=r.count;h<d;h++)r.setXYZ(h,0,0,0);const i=new De,a=new De,s=new De,o=new De,l=new De,u=new De,c=new De,f=new De;if(e)for(let h=0,d=e.count;h<d;h+=3){const p=e.getX(h+0),m=e.getX(h+1),g=e.getX(h+2);i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,m),s.fromBufferAttribute(t,g),c.subVectors(s,a),f.subVectors(i,a),c.cross(f),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,m),u.fromBufferAttribute(r,g),o.add(c),l.add(c),u.add(c),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(g,u.x,u.y,u.z)}else for(let h=0,d=t.count;h<d;h+=3)i.fromBufferAttribute(t,h+0),a.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),c.subVectors(s,a),f.subVectors(i,a),c.cross(f),r.setXYZ(h+0,c.x,c.y,c.z),r.setXYZ(h+1,c.x,c.y,c.z),r.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Li.fromBufferAttribute(e,t),Li.normalize(),e.setXYZ(t,Li.x,Li.y,Li.z)}toNonIndexed(){function e(o,l){const u=o.array,c=o.itemSize,f=o.normalized,h=new u.constructor(l.length*c);let d=0,p=0;for(let m=0,g=l.length;m<g;m++){o.isInterleavedBufferAttribute?d=l[m]*o.data.stride+o.offset:d=l[m]*c;for(let v=0;v<c;v++)h[p++]=u[d++]}return new Yi(h,c,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new xa,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],u=e(l,r);t.setAttribute(o,u)}const a=this.morphAttributes;for(const o in a){const l=[],u=a[o];for(let c=0,f=u.length;c<f;c++){const h=u[c],d=e(h,r);l.push(d)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,l=s.length;o<l;o++){const u=s[o];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const u=r[l];e.data.attributes[l]=u.toJSON(e.data)}const i={};let a=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let f=0,h=u.length;f<h;f++){const d=u[f];c.push(d.toJSON(e.data))}c.length>0&&(i[l]=c,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const u in i){const c=i[u];this.setAttribute(u,c.clone(t))}const a=e.morphAttributes;for(const u in a){const c=[],f=a[u];for(let h=0,d=f.length;h<d;h++)c.push(f[h].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let u=0,c=s.length;u<c;u++){const f=s[u];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const R4=new Un,Cp=new aT,A2=new Og,kv=new De,Rv=new De,Pv=new De,M2=new De,qx=new De,Xx=new un,Kx=new un,Yx=new un,k2=new De,Zx=new De;class ns extends Hr{constructor(e=new xa,t=new jc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,a=r.morphAttributes.position,s=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(a&&o){qx.set(0,0,0);for(let l=0,u=a.length;l<u;l++){const c=o[l],f=a[l];c!==0&&(M2.fromBufferAttribute(f,e),s?qx.addScaledVector(M2,c):qx.addScaledVector(M2.sub(t),c))}t.add(qx)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const r=this.geometry,i=this.material,a=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),A2.copy(r.boundingSphere),A2.applyMatrix4(a),e.ray.intersectsSphere(A2)===!1)||(R4.copy(a).invert(),Cp.copy(e.ray).applyMatrix4(R4),r.boundingBox!==null&&Cp.intersectsBox(r.boundingBox)===!1))return;let s;const o=r.index,l=r.attributes.position,u=r.attributes.uv,c=r.attributes.uv2,f=r.groups,h=r.drawRange;if(o!==null)if(Array.isArray(i))for(let d=0,p=f.length;d<p;d++){const m=f[d],g=i[m.materialIndex],v=Math.max(m.start,h.start),_=Math.min(o.count,Math.min(m.start+m.count,h.start+h.count));for(let x=v,b=_;x<b;x+=3){const S=o.getX(x),T=o.getX(x+1),M=o.getX(x+2);s=Qx(this,g,e,Cp,u,c,S,T,M),s&&(s.faceIndex=Math.floor(x/3),s.face.materialIndex=m.materialIndex,t.push(s))}}else{const d=Math.max(0,h.start),p=Math.min(o.count,h.start+h.count);for(let m=d,g=p;m<g;m+=3){const v=o.getX(m),_=o.getX(m+1),x=o.getX(m+2);s=Qx(this,i,e,Cp,u,c,v,_,x),s&&(s.faceIndex=Math.floor(m/3),t.push(s))}}else if(l!==void 0)if(Array.isArray(i))for(let d=0,p=f.length;d<p;d++){const m=f[d],g=i[m.materialIndex],v=Math.max(m.start,h.start),_=Math.min(l.count,Math.min(m.start+m.count,h.start+h.count));for(let x=v,b=_;x<b;x+=3){const S=x,T=x+1,M=x+2;s=Qx(this,g,e,Cp,u,c,S,T,M),s&&(s.faceIndex=Math.floor(x/3),s.face.materialIndex=m.materialIndex,t.push(s))}}else{const d=Math.max(0,h.start),p=Math.min(l.count,h.start+h.count);for(let m=d,g=p;m<g;m+=3){const v=m,_=m+1,x=m+2;s=Qx(this,i,e,Cp,u,c,v,_,x),s&&(s.faceIndex=Math.floor(m/3),t.push(s))}}}}function Jxe(n,e,t,r,i,a,s,o){let l;if(e.side===po?l=r.intersectTriangle(s,a,i,!0,o):l=r.intersectTriangle(i,a,s,e.side===cf,o),l===null)return null;Zx.copy(o),Zx.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(Zx);return u<t.near||u>t.far?null:{distance:u,point:Zx.clone(),object:n}}function Qx(n,e,t,r,i,a,s,o,l){n.getVertexPosition(s,kv),n.getVertexPosition(o,Rv),n.getVertexPosition(l,Pv);const u=Jxe(n,e,t,r,kv,Rv,Pv,k2);if(u){i&&(Xx.fromBufferAttribute(i,s),Kx.fromBufferAttribute(i,o),Yx.fromBufferAttribute(i,l),u.uv=C2.getUV(k2,kv,Rv,Pv,Xx,Kx,Yx,new un)),a&&(Xx.fromBufferAttribute(a,s),Kx.fromBufferAttribute(a,o),Yx.fromBufferAttribute(a,l),u.uv2=C2.getUV(k2,kv,Rv,Pv,Xx,Kx,Yx,new un));const c={a:s,b:o,c:l,normal:new De,materialIndex:0};C2.getNormal(kv,Rv,Pv,c.normal),u.face=c}return u}class S_ extends xa{constructor(e=1,t=1,r=1,i=1,a=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:a,depthSegments:s};const o=this;i=Math.floor(i),a=Math.floor(a),s=Math.floor(s);const l=[],u=[],c=[],f=[];let h=0,d=0;p("z","y","x",-1,-1,r,t,e,s,a,0),p("z","y","x",1,-1,r,t,-e,s,a,1),p("x","z","y",1,1,e,r,t,i,s,2),p("x","z","y",1,-1,e,r,-t,i,s,3),p("x","y","z",1,-1,e,t,r,i,a,4),p("x","y","z",-1,-1,e,t,-r,i,a,5),this.setIndex(l),this.setAttribute("position",new Ei(u,3)),this.setAttribute("normal",new Ei(c,3)),this.setAttribute("uv",new Ei(f,2));function p(m,g,v,_,x,b,S,T,M,C,k){const R=b/M,P=S/C,N=b/2,L=S/2,F=T/2,O=M+1,B=C+1;let H=0,j=0;const K=new De;for(let J=0;J<B;J++){const re=J*P-L;for(let se=0;se<O;se++){const Ae=se*R-N;K[m]=Ae*_,K[g]=re*x,K[v]=F,u.push(K.x,K.y,K.z),K[m]=0,K[g]=0,K[v]=T>0?1:-1,c.push(K.x,K.y,K.z),f.push(se/M),f.push(1-J/C),H+=1}}for(let J=0;J<C;J++)for(let re=0;re<M;re++){const se=h+re+O*J,Ae=h+re+O*(J+1),Ee=h+(re+1)+O*(J+1),Ne=h+(re+1)+O*J;l.push(se,Ae,Ne),l.push(Ae,Ee,Ne),j+=6}o.addGroup(d,j,k),d+=j,h+=H}}static fromJSON(e){return new S_(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ig(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Ia(n){const e={};for(let t=0;t<n.length;t++){const r=ig(n[t]);for(const i in r)e[i]=r[i]}return e}function ebe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function r7(n){return n.getRenderTarget()===null&&n.outputEncoding===fr?El:k0}const JP={clone:ig,merge:Ia};var tbe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,nbe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class jl extends Zo{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=tbe,this.fragmentShader=nbe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ig(e.uniforms),this.uniformsGroups=ebe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const s=this.uniforms[i].value;s&&s.isTexture?t.uniforms[i]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[i]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[i]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[i]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[i]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[i]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[i]={type:"m4",value:s.toArray()}:t.uniforms[i]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class i7 extends Hr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Un,this.projectionMatrix=new Un,this.projectionMatrixInverse=new Un}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Za extends i7{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=R0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Vy*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return R0*2*Math.atan(Math.tan(Vy*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,a,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Vy*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,a=-.5*i;const s=this.view;if(this.view!==null&&this.view.enabled){const l=s.fullWidth,u=s.fullHeight;a+=s.offsetX*i/l,t-=s.offsetY*r/u,i*=s.width/l,r*=s.height/u}const o=this.filmOffset;o!==0&&(a+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Ep=-90,Ap=1;class rbe extends Hr{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r;const i=new Za(Ep,Ap,e,t);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);const a=new Za(Ep,Ap,e,t);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(-1,0,0),this.add(a);const s=new Za(Ep,Ap,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);const o=new Za(Ep,Ap,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);const l=new Za(Ep,Ap,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const u=new Za(Ep,Ap,e,t);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,-1),this.add(u)}update(e,t){this.parent===null&&this.updateMatrixWorld();const r=this.renderTarget,[i,a,s,o,l,u]=this.children,c=e.getRenderTarget(),f=e.toneMapping,h=e.xr.enabled;e.toneMapping=Bu,e.xr.enabled=!1;const d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,o),e.setRenderTarget(r,4),e.render(t,l),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,u),e.setRenderTarget(c),e.toneMapping=f,e.xr.enabled=h,r.texture.needsPMREMUpdate=!0}}class eI extends Ki{constructor(e,t,r,i,a,s,o,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:Jm,super(e,t,r,i,a,s,o,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ibe extends ff{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new eI(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ya}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new S_(5,5,5),a=new jl({name:"CubemapFromEquirect",uniforms:ig(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:po,blending:tf});a.uniforms.tEquirect.value=t;const s=new ns(i,a),o=t.minFilter;return t.minFilter===dd&&(t.minFilter=Ya),new rbe(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){const a=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(a)}}const R2=new De,abe=new De,sbe=new Es;class Th{constructor(e=new De(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=R2.subVectors(r,t).cross(abe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(R2),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:t.copy(r).multiplyScalar(a).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||sbe.getNormalMatrix(e),i=this.coplanarPoint(R2).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Mp=new Og,Jx=new De;class tI{constructor(e=new Th,t=new Th,r=new Th,i=new Th,a=new Th,s=new Th){this.planes=[e,t,r,i,a,s]}set(e,t,r,i,a,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(a),o[5].copy(s),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,i=r[0],a=r[1],s=r[2],o=r[3],l=r[4],u=r[5],c=r[6],f=r[7],h=r[8],d=r[9],p=r[10],m=r[11],g=r[12],v=r[13],_=r[14],x=r[15];return t[0].setComponents(o-i,f-l,m-h,x-g).normalize(),t[1].setComponents(o+i,f+l,m+h,x+g).normalize(),t[2].setComponents(o+a,f+u,m+d,x+v).normalize(),t[3].setComponents(o-a,f-u,m-d,x-v).normalize(),t[4].setComponents(o-s,f-c,m-p,x-_).normalize(),t[5].setComponents(o+s,f+c,m+p,x+_).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Mp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mp)}intersectsSprite(e){return Mp.center.set(0,0,0),Mp.radius=.7071067811865476,Mp.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mp)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(Jx.x=i.normal.x>0?e.max.x:e.min.x,Jx.y=i.normal.y>0?e.max.y:e.min.y,Jx.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Jx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function a7(){let n=null,e=!1,t=null,r=null;function i(a,s){t(a,s),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){n=a}}}function obe(n,e){const t=e.isWebGL2,r=new WeakMap;function i(u,c){const f=u.array,h=u.usage,d=n.createBuffer();n.bindBuffer(c,d),n.bufferData(c,f,h),u.onUploadCallback();let p;if(f instanceof Float32Array)p=5126;else if(f instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(f instanceof Int16Array)p=5122;else if(f instanceof Uint32Array)p=5125;else if(f instanceof Int32Array)p=5124;else if(f instanceof Int8Array)p=5120;else if(f instanceof Uint8Array)p=5121;else if(f instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:d,type:p,bytesPerElement:f.BYTES_PER_ELEMENT,version:u.version}}function a(u,c,f){const h=c.array,d=c.updateRange;n.bindBuffer(f,u),d.count===-1?n.bufferSubData(f,0,h):(t?n.bufferSubData(f,d.offset*h.BYTES_PER_ELEMENT,h,d.offset,d.count):n.bufferSubData(f,d.offset*h.BYTES_PER_ELEMENT,h.subarray(d.offset,d.offset+d.count)),d.count=-1),c.onUploadCallback()}function s(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}function o(u){u.isInterleavedBufferAttribute&&(u=u.data);const c=r.get(u);c&&(n.deleteBuffer(c.buffer),r.delete(u))}function l(u,c){if(u.isGLBufferAttribute){const h=r.get(u);(!h||h.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const f=r.get(u);f===void 0?r.set(u,i(u,c)):f.version<u.version&&(a(f.buffer,u,c),f.version=u.version)}return{get:s,remove:o,update:l}}class nI extends xa{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const a=e/2,s=t/2,o=Math.floor(r),l=Math.floor(i),u=o+1,c=l+1,f=e/o,h=t/l,d=[],p=[],m=[],g=[];for(let v=0;v<c;v++){const _=v*h-s;for(let x=0;x<u;x++){const b=x*f-a;p.push(b,-_,0),m.push(0,0,1),g.push(x/o),g.push(1-v/l)}}for(let v=0;v<l;v++)for(let _=0;_<o;_++){const x=_+u*v,b=_+u*(v+1),S=_+1+u*(v+1),T=_+1+u*v;d.push(x,b,T),d.push(b,S,T)}this.setIndex(d),this.setAttribute("position",new Ei(p,3)),this.setAttribute("normal",new Ei(m,3)),this.setAttribute("uv",new Ei(g,2))}static fromJSON(e){return new nI(e.width,e.height,e.widthSegments,e.heightSegments)}}var lbe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,ube=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,cbe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,fbe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,hbe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,dbe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,pbe="vec3 transformed = vec3( position );",mbe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,gbe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,vbe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,ybe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,_be=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,xbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,bbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,wbe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Sbe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Tbe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Cbe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Ebe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Abe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Mbe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,kbe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Rbe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Pbe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Ibe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Dbe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Lbe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Nbe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Obe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,$be=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Fbe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Bbe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Ube=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,zbe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Vbe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Hbe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Wbe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Gbe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,jbe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,qbe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Xbe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Kbe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Ybe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Zbe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,Qbe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Jbe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,e1e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,t1e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,n1e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,r1e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,i1e=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,a1e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,s1e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,o1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,l1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,u1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,c1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,f1e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,h1e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,d1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,p1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,m1e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,g1e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,v1e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,y1e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,_1e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,x1e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,b1e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,w1e=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,S1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,T1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,C1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,E1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,A1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,M1e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,k1e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,R1e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,P1e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,I1e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,D1e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,L1e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,N1e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,O1e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,$1e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,F1e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,B1e=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,U1e=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,z1e=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,V1e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,H1e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,W1e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,G1e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,j1e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,q1e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,X1e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,K1e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Y1e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Z1e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,Q1e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,J1e=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,ewe=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,twe=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,nwe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,rwe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,iwe=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,awe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const swe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,owe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,lwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,uwe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fwe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,hwe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,dwe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,pwe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,mwe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,gwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,vwe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ywe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,_we=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xwe=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,bwe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wwe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Swe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Twe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Cwe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ewe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Awe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Mwe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kwe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Rwe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Pwe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Iwe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Dwe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lwe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Nwe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Owe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$we=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Fwe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Bwe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Rn={alphamap_fragment:lbe,alphamap_pars_fragment:ube,alphatest_fragment:cbe,alphatest_pars_fragment:fbe,aomap_fragment:hbe,aomap_pars_fragment:dbe,begin_vertex:pbe,beginnormal_vertex:mbe,bsdfs:gbe,iridescence_fragment:vbe,bumpmap_pars_fragment:ybe,clipping_planes_fragment:_be,clipping_planes_pars_fragment:xbe,clipping_planes_pars_vertex:bbe,clipping_planes_vertex:wbe,color_fragment:Sbe,color_pars_fragment:Tbe,color_pars_vertex:Cbe,color_vertex:Ebe,common:Abe,cube_uv_reflection_fragment:Mbe,defaultnormal_vertex:kbe,displacementmap_pars_vertex:Rbe,displacementmap_vertex:Pbe,emissivemap_fragment:Ibe,emissivemap_pars_fragment:Dbe,encodings_fragment:Lbe,encodings_pars_fragment:Nbe,envmap_fragment:Obe,envmap_common_pars_fragment:$be,envmap_pars_fragment:Fbe,envmap_pars_vertex:Bbe,envmap_physical_pars_fragment:Zbe,envmap_vertex:Ube,fog_vertex:zbe,fog_pars_vertex:Vbe,fog_fragment:Hbe,fog_pars_fragment:Wbe,gradientmap_pars_fragment:Gbe,lightmap_fragment:jbe,lightmap_pars_fragment:qbe,lights_lambert_fragment:Xbe,lights_lambert_pars_fragment:Kbe,lights_pars_begin:Ybe,lights_toon_fragment:Qbe,lights_toon_pars_fragment:Jbe,lights_phong_fragment:e1e,lights_phong_pars_fragment:t1e,lights_physical_fragment:n1e,lights_physical_pars_fragment:r1e,lights_fragment_begin:i1e,lights_fragment_maps:a1e,lights_fragment_end:s1e,logdepthbuf_fragment:o1e,logdepthbuf_pars_fragment:l1e,logdepthbuf_pars_vertex:u1e,logdepthbuf_vertex:c1e,map_fragment:f1e,map_pars_fragment:h1e,map_particle_fragment:d1e,map_particle_pars_fragment:p1e,metalnessmap_fragment:m1e,metalnessmap_pars_fragment:g1e,morphcolor_vertex:v1e,morphnormal_vertex:y1e,morphtarget_pars_vertex:_1e,morphtarget_vertex:x1e,normal_fragment_begin:b1e,normal_fragment_maps:w1e,normal_pars_fragment:S1e,normal_pars_vertex:T1e,normal_vertex:C1e,normalmap_pars_fragment:E1e,clearcoat_normal_fragment_begin:A1e,clearcoat_normal_fragment_maps:M1e,clearcoat_pars_fragment:k1e,iridescence_pars_fragment:R1e,output_fragment:P1e,packing:I1e,premultiplied_alpha_fragment:D1e,project_vertex:L1e,dithering_fragment:N1e,dithering_pars_fragment:O1e,roughnessmap_fragment:$1e,roughnessmap_pars_fragment:F1e,shadowmap_pars_fragment:B1e,shadowmap_pars_vertex:U1e,shadowmap_vertex:z1e,shadowmask_pars_fragment:V1e,skinbase_vertex:H1e,skinning_pars_vertex:W1e,skinning_vertex:G1e,skinnormal_vertex:j1e,specularmap_fragment:q1e,specularmap_pars_fragment:X1e,tonemapping_fragment:K1e,tonemapping_pars_fragment:Y1e,transmission_fragment:Z1e,transmission_pars_fragment:Q1e,uv_pars_fragment:J1e,uv_pars_vertex:ewe,uv_vertex:twe,uv2_pars_fragment:nwe,uv2_pars_vertex:rwe,uv2_vertex:iwe,worldpos_vertex:awe,background_vert:swe,background_frag:owe,backgroundCube_vert:lwe,backgroundCube_frag:uwe,cube_vert:cwe,cube_frag:fwe,depth_vert:hwe,depth_frag:dwe,distanceRGBA_vert:pwe,distanceRGBA_frag:mwe,equirect_vert:gwe,equirect_frag:vwe,linedashed_vert:ywe,linedashed_frag:_we,meshbasic_vert:xwe,meshbasic_frag:bwe,meshlambert_vert:wwe,meshlambert_frag:Swe,meshmatcap_vert:Twe,meshmatcap_frag:Cwe,meshnormal_vert:Ewe,meshnormal_frag:Awe,meshphong_vert:Mwe,meshphong_frag:kwe,meshphysical_vert:Rwe,meshphysical_frag:Pwe,meshtoon_vert:Iwe,meshtoon_frag:Dwe,points_vert:Lwe,points_frag:Nwe,shadow_vert:Owe,shadow_frag:$we,sprite_vert:Fwe,sprite_frag:Bwe},At={common:{diffuse:{value:new gn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Es},uv2Transform:{value:new Es},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new un(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new gn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new gn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Es}},sprite:{diffuse:{value:new gn(16777215)},opacity:{value:1},center:{value:new un(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Es}}},Ml={basic:{uniforms:Ia([At.common,At.specularmap,At.envmap,At.aomap,At.lightmap,At.fog]),vertexShader:Rn.meshbasic_vert,fragmentShader:Rn.meshbasic_frag},lambert:{uniforms:Ia([At.common,At.specularmap,At.envmap,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.fog,At.lights,{emissive:{value:new gn(0)}}]),vertexShader:Rn.meshlambert_vert,fragmentShader:Rn.meshlambert_frag},phong:{uniforms:Ia([At.common,At.specularmap,At.envmap,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.fog,At.lights,{emissive:{value:new gn(0)},specular:{value:new gn(1118481)},shininess:{value:30}}]),vertexShader:Rn.meshphong_vert,fragmentShader:Rn.meshphong_frag},standard:{uniforms:Ia([At.common,At.envmap,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.roughnessmap,At.metalnessmap,At.fog,At.lights,{emissive:{value:new gn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag},toon:{uniforms:Ia([At.common,At.aomap,At.lightmap,At.emissivemap,At.bumpmap,At.normalmap,At.displacementmap,At.gradientmap,At.fog,At.lights,{emissive:{value:new gn(0)}}]),vertexShader:Rn.meshtoon_vert,fragmentShader:Rn.meshtoon_frag},matcap:{uniforms:Ia([At.common,At.bumpmap,At.normalmap,At.displacementmap,At.fog,{matcap:{value:null}}]),vertexShader:Rn.meshmatcap_vert,fragmentShader:Rn.meshmatcap_frag},points:{uniforms:Ia([At.points,At.fog]),vertexShader:Rn.points_vert,fragmentShader:Rn.points_frag},dashed:{uniforms:Ia([At.common,At.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Rn.linedashed_vert,fragmentShader:Rn.linedashed_frag},depth:{uniforms:Ia([At.common,At.displacementmap]),vertexShader:Rn.depth_vert,fragmentShader:Rn.depth_frag},normal:{uniforms:Ia([At.common,At.bumpmap,At.normalmap,At.displacementmap,{opacity:{value:1}}]),vertexShader:Rn.meshnormal_vert,fragmentShader:Rn.meshnormal_frag},sprite:{uniforms:Ia([At.sprite,At.fog]),vertexShader:Rn.sprite_vert,fragmentShader:Rn.sprite_frag},background:{uniforms:{uvTransform:{value:new Es},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Rn.background_vert,fragmentShader:Rn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Rn.backgroundCube_vert,fragmentShader:Rn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Rn.cube_vert,fragmentShader:Rn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Rn.equirect_vert,fragmentShader:Rn.equirect_frag},distanceRGBA:{uniforms:Ia([At.common,At.displacementmap,{referencePosition:{value:new De},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Rn.distanceRGBA_vert,fragmentShader:Rn.distanceRGBA_frag},shadow:{uniforms:Ia([At.lights,At.fog,{color:{value:new gn(0)},opacity:{value:1}}]),vertexShader:Rn.shadow_vert,fragmentShader:Rn.shadow_frag}};Ml.physical={uniforms:Ia([Ml.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new un(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new gn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new un},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new gn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new gn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Rn.meshphysical_vert,fragmentShader:Rn.meshphysical_frag};const eb={r:0,b:0,g:0};function Uwe(n,e,t,r,i,a,s){const o=new gn(0);let l=a===!0?0:1,u,c,f=null,h=0,d=null;function p(g,v){let _=!1,x=v.isScene===!0?v.background:null;x&&x.isTexture&&(x=(v.backgroundBlurriness>0?t:e).get(x));const b=n.xr,S=b.getSession&&b.getSession();S&&S.environmentBlendMode==="additive"&&(x=null),x===null?m(o,l):x&&x.isColor&&(m(x,1),_=!0),(n.autoClear||_)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),x&&(x.isCubeTexture||x.mapping===iT)?(c===void 0&&(c=new ns(new S_(1,1,1),new jl({name:"BackgroundCubeMaterial",uniforms:ig(Ml.backgroundCube.uniforms),vertexShader:Ml.backgroundCube.vertexShader,fragmentShader:Ml.backgroundCube.fragmentShader,side:po,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(T,M,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),c.material.uniforms.envMap.value=x,c.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=x.encoding!==fr,(f!==x||h!==x.version||d!==n.toneMapping)&&(c.material.needsUpdate=!0,f=x,h=x.version,d=n.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null)):x&&x.isTexture&&(u===void 0&&(u=new ns(new nI(2,2),new jl({name:"BackgroundMaterial",uniforms:ig(Ml.background.uniforms),vertexShader:Ml.background.vertexShader,fragmentShader:Ml.background.fragmentShader,side:cf,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=x,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=x.encoding!==fr,x.matrixAutoUpdate===!0&&x.updateMatrix(),u.material.uniforms.uvTransform.value.copy(x.matrix),(f!==x||h!==x.version||d!==n.toneMapping)&&(u.material.needsUpdate=!0,f=x,h=x.version,d=n.toneMapping),u.layers.enableAll(),g.unshift(u,u.geometry,u.material,0,0,null))}function m(g,v){g.getRGB(eb,r7(n)),r.buffers.color.setClear(eb.r,eb.g,eb.b,v,s)}return{getClearColor:function(){return o},setClearColor:function(g,v=1){o.set(g),l=v,m(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,m(o,l)},render:p}}function zwe(n,e,t,r){const i=n.getParameter(34921),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),s=r.isWebGL2||a!==null,o={},l=g(null);let u=l,c=!1;function f(F,O,B,H,j){let K=!1;if(s){const J=m(H,B,O);u!==J&&(u=J,d(u.object)),K=v(F,H,B,j),K&&_(F,H,B,j)}else{const J=O.wireframe===!0;(u.geometry!==H.id||u.program!==B.id||u.wireframe!==J)&&(u.geometry=H.id,u.program=B.id,u.wireframe=J,K=!0)}j!==null&&t.update(j,34963),(K||c)&&(c=!1,C(F,O,B,H),j!==null&&n.bindBuffer(34963,t.get(j).buffer))}function h(){return r.isWebGL2?n.createVertexArray():a.createVertexArrayOES()}function d(F){return r.isWebGL2?n.bindVertexArray(F):a.bindVertexArrayOES(F)}function p(F){return r.isWebGL2?n.deleteVertexArray(F):a.deleteVertexArrayOES(F)}function m(F,O,B){const H=B.wireframe===!0;let j=o[F.id];j===void 0&&(j={},o[F.id]=j);let K=j[O.id];K===void 0&&(K={},j[O.id]=K);let J=K[H];return J===void 0&&(J=g(h()),K[H]=J),J}function g(F){const O=[],B=[],H=[];for(let j=0;j<i;j++)O[j]=0,B[j]=0,H[j]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:O,enabledAttributes:B,attributeDivisors:H,object:F,attributes:{},index:null}}function v(F,O,B,H){const j=u.attributes,K=O.attributes;let J=0;const re=B.getAttributes();for(const se in re)if(re[se].location>=0){const Ee=j[se];let Ne=K[se];if(Ne===void 0&&(se==="instanceMatrix"&&F.instanceMatrix&&(Ne=F.instanceMatrix),se==="instanceColor"&&F.instanceColor&&(Ne=F.instanceColor)),Ee===void 0||Ee.attribute!==Ne||Ne&&Ee.data!==Ne.data)return!0;J++}return u.attributesNum!==J||u.index!==H}function _(F,O,B,H){const j={},K=O.attributes;let J=0;const re=B.getAttributes();for(const se in re)if(re[se].location>=0){let Ee=K[se];Ee===void 0&&(se==="instanceMatrix"&&F.instanceMatrix&&(Ee=F.instanceMatrix),se==="instanceColor"&&F.instanceColor&&(Ee=F.instanceColor));const Ne={};Ne.attribute=Ee,Ee&&Ee.data&&(Ne.data=Ee.data),j[se]=Ne,J++}u.attributes=j,u.attributesNum=J,u.index=H}function x(){const F=u.newAttributes;for(let O=0,B=F.length;O<B;O++)F[O]=0}function b(F){S(F,0)}function S(F,O){const B=u.newAttributes,H=u.enabledAttributes,j=u.attributeDivisors;B[F]=1,H[F]===0&&(n.enableVertexAttribArray(F),H[F]=1),j[F]!==O&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,O),j[F]=O)}function T(){const F=u.newAttributes,O=u.enabledAttributes;for(let B=0,H=O.length;B<H;B++)O[B]!==F[B]&&(n.disableVertexAttribArray(B),O[B]=0)}function M(F,O,B,H,j,K){r.isWebGL2===!0&&(B===5124||B===5125)?n.vertexAttribIPointer(F,O,B,j,K):n.vertexAttribPointer(F,O,B,H,j,K)}function C(F,O,B,H){if(r.isWebGL2===!1&&(F.isInstancedMesh||H.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;x();const j=H.attributes,K=B.getAttributes(),J=O.defaultAttributeValues;for(const re in K){const se=K[re];if(se.location>=0){let Ae=j[re];if(Ae===void 0&&(re==="instanceMatrix"&&F.instanceMatrix&&(Ae=F.instanceMatrix),re==="instanceColor"&&F.instanceColor&&(Ae=F.instanceColor)),Ae!==void 0){const Ee=Ae.normalized,Ne=Ae.itemSize,we=t.get(Ae);if(we===void 0)continue;const me=we.buffer,Se=we.type,Me=we.bytesPerElement;if(Ae.isInterleavedBufferAttribute){const ke=Ae.data,He=ke.stride,ee=Ae.offset;if(ke.isInstancedInterleavedBuffer){for(let ie=0;ie<se.locationSize;ie++)S(se.location+ie,ke.meshPerAttribute);F.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=ke.meshPerAttribute*ke.count)}else for(let ie=0;ie<se.locationSize;ie++)b(se.location+ie);n.bindBuffer(34962,me);for(let ie=0;ie<se.locationSize;ie++)M(se.location+ie,Ne/se.locationSize,Se,Ee,He*Me,(ee+Ne/se.locationSize*ie)*Me)}else{if(Ae.isInstancedBufferAttribute){for(let ke=0;ke<se.locationSize;ke++)S(se.location+ke,Ae.meshPerAttribute);F.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=Ae.meshPerAttribute*Ae.count)}else for(let ke=0;ke<se.locationSize;ke++)b(se.location+ke);n.bindBuffer(34962,me);for(let ke=0;ke<se.locationSize;ke++)M(se.location+ke,Ne/se.locationSize,Se,Ee,Ne*Me,Ne/se.locationSize*ke*Me)}}else if(J!==void 0){const Ee=J[re];if(Ee!==void 0)switch(Ee.length){case 2:n.vertexAttrib2fv(se.location,Ee);break;case 3:n.vertexAttrib3fv(se.location,Ee);break;case 4:n.vertexAttrib4fv(se.location,Ee);break;default:n.vertexAttrib1fv(se.location,Ee)}}}}T()}function k(){N();for(const F in o){const O=o[F];for(const B in O){const H=O[B];for(const j in H)p(H[j].object),delete H[j];delete O[B]}delete o[F]}}function R(F){if(o[F.id]===void 0)return;const O=o[F.id];for(const B in O){const H=O[B];for(const j in H)p(H[j].object),delete H[j];delete O[B]}delete o[F.id]}function P(F){for(const O in o){const B=o[O];if(B[F.id]===void 0)continue;const H=B[F.id];for(const j in H)p(H[j].object),delete H[j];delete B[F.id]}}function N(){L(),c=!0,u!==l&&(u=l,d(u.object))}function L(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:N,resetDefaultState:L,dispose:k,releaseStatesOfGeometry:R,releaseStatesOfProgram:P,initAttributes:x,enableAttribute:b,disableUnusedAttributes:T}}function Vwe(n,e,t,r){const i=r.isWebGL2;let a;function s(u){a=u}function o(u,c){n.drawArrays(a,u,c),t.update(c,a,1)}function l(u,c,f){if(f===0)return;let h,d;if(i)h=n,d="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),d="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[d](a,u,c,f),t.update(c,a,f)}this.setMode=s,this.render=o,this.renderInstances=l}function Hwe(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const M=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(M){if(M==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";M="mediump"}return M==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&n instanceof WebGL2ComputeRenderingContext;let o=t.precision!==void 0?t.precision:"highp";const l=a(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const u=s||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,f=n.getParameter(34930),h=n.getParameter(35660),d=n.getParameter(3379),p=n.getParameter(34076),m=n.getParameter(34921),g=n.getParameter(36347),v=n.getParameter(36348),_=n.getParameter(36349),x=h>0,b=s||e.has("OES_texture_float"),S=x&&b,T=s?n.getParameter(36183):0;return{isWebGL2:s,drawBuffers:u,getMaxAnisotropy:i,getMaxPrecision:a,precision:o,logarithmicDepthBuffer:c,maxTextures:f,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:_,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:S,maxSamples:T}}function Wwe(n){const e=this;let t=null,r=0,i=!1,a=!1;const s=new Th,o=new Es,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,h,d){const p=f.length!==0||h||r!==0||i;return i=h,t=c(f,d,0),r=f.length,p},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1,u()},this.setState=function(f,h,d){const p=f.clippingPlanes,m=f.clipIntersection,g=f.clipShadows,v=n.get(f);if(!i||p===null||p.length===0||a&&!g)a?c(null):u();else{const _=a?0:r,x=_*4;let b=v.clippingState||null;l.value=b,b=c(p,h,x,d);for(let S=0;S!==x;++S)b[S]=t[S];v.clippingState=b,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=_}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(f,h,d,p){const m=f!==null?f.length:0;let g=null;if(m!==0){if(g=l.value,p!==!0||g===null){const v=d+m*4,_=h.matrixWorldInverse;o.getNormalMatrix(_),(g===null||g.length<v)&&(g=new Float32Array(v));for(let x=0,b=d;x!==m;++x,b+=4)s.copy(f[x]).applyMatrix4(_,o),s.normal.toArray(g,b),g[b+3]=s.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}}function Gwe(n){let e=new WeakMap;function t(s,o){return o===bM?s.mapping=Jm:o===wM&&(s.mapping=eg),s}function r(s){if(s&&s.isTexture&&s.isRenderTargetTexture===!1){const o=s.mapping;if(o===bM||o===wM)if(e.has(s)){const l=e.get(s).texture;return t(l,s.mapping)}else{const l=s.image;if(l&&l.height>0){const u=new ibe(l.height/2);return u.fromEquirectangularTexture(n,s),e.set(s,u),s.addEventListener("dispose",i),t(u.texture,s.mapping)}else return null}}return s}function i(s){const o=s.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function a(){e=new WeakMap}return{get:r,dispose:a}}class sT extends i7{constructor(e=-1,t=1,r=1,i=-1,a=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=a,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,a,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=r-e,s=r+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=u*this.view.offsetX,s=a+u*this.view.width,o-=c*this.view.offsetY,l=o-c*this.view.height}this.projectionMatrix.makeOrthographic(a,s,o,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const um=4,P4=[.125,.215,.35,.446,.526,.582],Ih=20,P2=new sT,I4=new gn;let I2=null;const Ch=(1+Math.sqrt(5))/2,kp=1/Ch,D4=[new De(1,1,1),new De(-1,1,1),new De(1,1,-1),new De(-1,1,-1),new De(0,Ch,kp),new De(0,Ch,-kp),new De(kp,0,Ch),new De(-kp,0,Ch),new De(Ch,kp,0),new De(-Ch,kp,0)];class L4{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){I2=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,i,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=$4(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=O4(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(I2),e.scissorTest=!1,tb(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Jm||e.mapping===eg?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),I2=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Ya,minFilter:Ya,generateMipmaps:!1,type:A0,format:eo,encoding:md,depthBuffer:!1},i=N4(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=N4(e,t,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=jwe(a)),this._blurMaterial=qwe(a,e,t)}return i}_compileMaterial(e){const t=new ns(this._lodPlanes[0],e);this._renderer.compile(t,P2)}_sceneToCubeUV(e,t,r,i){const o=new Za(90,1,t,r),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,f=c.autoClear,h=c.toneMapping;c.getClearColor(I4),c.toneMapping=Bu,c.autoClear=!1;const d=new jc({name:"PMREM.Background",side:po,depthWrite:!1,depthTest:!1}),p=new ns(new S_,d);let m=!1;const g=e.background;g?g.isColor&&(d.color.copy(g),e.background=null,m=!0):(d.color.copy(I4),m=!0);for(let v=0;v<6;v++){const _=v%3;_===0?(o.up.set(0,l[v],0),o.lookAt(u[v],0,0)):_===1?(o.up.set(0,0,l[v]),o.lookAt(0,u[v],0)):(o.up.set(0,l[v],0),o.lookAt(0,0,u[v]));const x=this._cubeSize;tb(i,_*x,v>2?x:0,x,x),c.setRenderTarget(i),m&&c.render(p,o),c.render(e,o)}p.geometry.dispose(),p.material.dispose(),c.toneMapping=h,c.autoClear=f,e.background=g}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===Jm||e.mapping===eg;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=$4()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=O4());const a=i?this._cubemapMaterial:this._equirectMaterial,s=new ns(this._lodPlanes[0],a),o=a.uniforms;o.envMap.value=e;const l=this._cubeSize;tb(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(s,P2)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const a=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=D4[(i-1)%D4.length];this._blur(e,i-1,i,a,s)}t.autoClear=r}_blur(e,t,r,i,a){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",a),this._halfBlur(s,e,r,r,i,"longitudinal",a)}_halfBlur(e,t,r,i,a,s,o){const l=this._renderer,u=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,f=new ns(this._lodPlanes[i],u),h=u.uniforms,d=this._sizeLods[r]-1,p=isFinite(a)?Math.PI/(2*d):2*Math.PI/(2*Ih-1),m=a/p,g=isFinite(a)?1+Math.floor(c*m):Ih;g>Ih&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Ih}`);const v=[];let _=0;for(let M=0;M<Ih;++M){const C=M/m,k=Math.exp(-C*C/2);v.push(k),M===0?_+=k:M<g&&(_+=2*k)}for(let M=0;M<v.length;M++)v[M]=v[M]/_;h.envMap.value=e.texture,h.samples.value=g,h.weights.value=v,h.latitudinal.value=s==="latitudinal",o&&(h.poleAxis.value=o);const{_lodMax:x}=this;h.dTheta.value=p,h.mipInt.value=x-r;const b=this._sizeLods[i],S=3*b*(i>x-um?i-x+um:0),T=4*(this._cubeSize-b);tb(t,S,T,3*b,2*b),l.setRenderTarget(t),l.render(f,P2)}}function jwe(n){const e=[],t=[],r=[];let i=n;const a=n-um+1+P4.length;for(let s=0;s<a;s++){const o=Math.pow(2,i);t.push(o);let l=1/o;s>n-um?l=P4[s-n+um-1]:s===0&&(l=0),r.push(l);const u=1/(o-2),c=-u,f=1+u,h=[c,c,f,c,f,f,c,c,f,f,c,f],d=6,p=6,m=3,g=2,v=1,_=new Float32Array(m*p*d),x=new Float32Array(g*p*d),b=new Float32Array(v*p*d);for(let T=0;T<d;T++){const M=T%3*2/3-1,C=T>2?0:-1,k=[M,C,0,M+2/3,C,0,M+2/3,C+1,0,M,C,0,M+2/3,C+1,0,M,C+1,0];_.set(k,m*p*T),x.set(h,g*p*T);const R=[T,T,T,T,T,T];b.set(R,v*p*T)}const S=new xa;S.setAttribute("position",new Yi(_,m)),S.setAttribute("uv",new Yi(x,g)),S.setAttribute("faceIndex",new Yi(b,v)),e.push(S),i>um&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function N4(n,e,t){const r=new ff(n,e,t);return r.texture.mapping=iT,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function tb(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function qwe(n,e,t){const r=new Float32Array(Ih),i=new De(0,1,0);return new jl({name:"SphericalGaussianBlur",defines:{n:Ih,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:rI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:tf,depthTest:!1,depthWrite:!1})}function O4(){return new jl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:rI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:tf,depthTest:!1,depthWrite:!1})}function $4(){return new jl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:rI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:tf,depthTest:!1,depthWrite:!1})}function rI(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Xwe(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const l=o.mapping,u=l===bM||l===wM,c=l===Jm||l===eg;if(u||c)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let f=e.get(o);return t===null&&(t=new L4(n)),f=u?t.fromEquirectangular(o,f):t.fromCubemap(o,f),e.set(o,f),f.texture}else{if(e.has(o))return e.get(o).texture;{const f=o.image;if(u&&f&&f.height>0||c&&f&&i(f)){t===null&&(t=new L4(n));const h=u?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,h),o.addEventListener("dispose",a),h.texture}else return null}}}return o}function i(o){let l=0;const u=6;for(let c=0;c<u;c++)o[c]!==void 0&&l++;return l===u}function a(o){const l=o.target;l.removeEventListener("dispose",a);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:s}}function Kwe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function Ywe(n,e,t,r){const i={},a=new WeakMap;function s(f){const h=f.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);h.removeEventListener("dispose",s),delete i[h.id];const d=a.get(h);d&&(e.remove(d),a.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function o(f,h){return i[h.id]===!0||(h.addEventListener("dispose",s),i[h.id]=!0,t.memory.geometries++),h}function l(f){const h=f.attributes;for(const p in h)e.update(h[p],34962);const d=f.morphAttributes;for(const p in d){const m=d[p];for(let g=0,v=m.length;g<v;g++)e.update(m[g],34962)}}function u(f){const h=[],d=f.index,p=f.attributes.position;let m=0;if(d!==null){const _=d.array;m=d.version;for(let x=0,b=_.length;x<b;x+=3){const S=_[x+0],T=_[x+1],M=_[x+2];h.push(S,T,T,M,M,S)}}else{const _=p.array;m=p.version;for(let x=0,b=_.length/3-1;x<b;x+=3){const S=x+0,T=x+1,M=x+2;h.push(S,T,T,M,M,S)}}const g=new(Yj(h)?n7:t7)(h,1);g.version=m;const v=a.get(f);v&&e.remove(v),a.set(f,g)}function c(f){const h=a.get(f);if(h){const d=f.index;d!==null&&h.version<d.version&&u(f)}else u(f);return a.get(f)}return{get:o,update:l,getWireframeAttribute:c}}function Zwe(n,e,t,r){const i=r.isWebGL2;let a;function s(h){a=h}let o,l;function u(h){o=h.type,l=h.bytesPerElement}function c(h,d){n.drawElements(a,d,o,h*l),t.update(d,a,1)}function f(h,d,p){if(p===0)return;let m,g;if(i)m=n,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](a,d,o,h*l,p),t.update(d,a,p)}this.setMode=s,this.setIndex=u,this.render=c,this.renderInstances=f}function Qwe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,s,o){switch(t.calls++,s){case 4:t.triangles+=o*(a/3);break;case 1:t.lines+=o*(a/2);break;case 3:t.lines+=o*(a-1);break;case 2:t.lines+=o*a;break;case 0:t.points+=o*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s);break}}function i(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function Jwe(n,e){return n[0]-e[0]}function eSe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function tSe(n,e,t){const r={},i=new Float32Array(8),a=new WeakMap,s=new Nr,o=[];for(let u=0;u<8;u++)o[u]=[u,0];function l(u,c,f,h){const d=u.morphTargetInfluences;if(e.isWebGL2===!0){const p=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,m=p!==void 0?p.length:0;let g=a.get(c);if(g===void 0||g.count!==m){let O=function(){L.dispose(),a.delete(c),c.removeEventListener("dispose",O)};g!==void 0&&g.texture.dispose();const x=c.morphAttributes.position!==void 0,b=c.morphAttributes.normal!==void 0,S=c.morphAttributes.color!==void 0,T=c.morphAttributes.position||[],M=c.morphAttributes.normal||[],C=c.morphAttributes.color||[];let k=0;x===!0&&(k=1),b===!0&&(k=2),S===!0&&(k=3);let R=c.attributes.position.count*k,P=1;R>e.maxTextureSize&&(P=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const N=new Float32Array(R*P*4*m),L=new e7(N,R,P,m);L.type=Iu,L.needsUpdate=!0;const F=k*4;for(let B=0;B<m;B++){const H=T[B],j=M[B],K=C[B],J=R*P*4*B;for(let re=0;re<H.count;re++){const se=re*F;x===!0&&(s.fromBufferAttribute(H,re),N[J+se+0]=s.x,N[J+se+1]=s.y,N[J+se+2]=s.z,N[J+se+3]=0),b===!0&&(s.fromBufferAttribute(j,re),N[J+se+4]=s.x,N[J+se+5]=s.y,N[J+se+6]=s.z,N[J+se+7]=0),S===!0&&(s.fromBufferAttribute(K,re),N[J+se+8]=s.x,N[J+se+9]=s.y,N[J+se+10]=s.z,N[J+se+11]=K.itemSize===4?s.w:1)}}g={count:m,texture:L,size:new un(R,P)},a.set(c,g),c.addEventListener("dispose",O)}let v=0;for(let x=0;x<d.length;x++)v+=d[x];const _=c.morphTargetsRelative?1:1-v;h.getUniforms().setValue(n,"morphTargetBaseInfluence",_),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",g.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",g.size)}else{const p=d===void 0?0:d.length;let m=r[c.id];if(m===void 0||m.length!==p){m=[];for(let b=0;b<p;b++)m[b]=[b,0];r[c.id]=m}for(let b=0;b<p;b++){const S=m[b];S[0]=b,S[1]=d[b]}m.sort(eSe);for(let b=0;b<8;b++)b<p&&m[b][1]?(o[b][0]=m[b][0],o[b][1]=m[b][1]):(o[b][0]=Number.MAX_SAFE_INTEGER,o[b][1]=0);o.sort(Jwe);const g=c.morphAttributes.position,v=c.morphAttributes.normal;let _=0;for(let b=0;b<8;b++){const S=o[b],T=S[0],M=S[1];T!==Number.MAX_SAFE_INTEGER&&M?(g&&c.getAttribute("morphTarget"+b)!==g[T]&&c.setAttribute("morphTarget"+b,g[T]),v&&c.getAttribute("morphNormal"+b)!==v[T]&&c.setAttribute("morphNormal"+b,v[T]),i[b]=M,_+=M):(g&&c.hasAttribute("morphTarget"+b)===!0&&c.deleteAttribute("morphTarget"+b),v&&c.hasAttribute("morphNormal"+b)===!0&&c.deleteAttribute("morphNormal"+b),i[b]=0)}const x=c.morphTargetsRelative?1:1-_;h.getUniforms().setValue(n,"morphTargetBaseInfluence",x),h.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function nSe(n,e,t,r){let i=new WeakMap;function a(l){const u=r.render.frame,c=l.geometry,f=e.get(l,c);return i.get(f)!==u&&(e.update(f),i.set(f,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),t.update(l.instanceMatrix,34962),l.instanceColor!==null&&t.update(l.instanceColor,34962)),f}function s(){i=new WeakMap}function o(l){const u=l.target;u.removeEventListener("dispose",o),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:a,dispose:s}}const s7=new Ki,o7=new e7,l7=new Hxe,u7=new eI,F4=[],B4=[],U4=new Float32Array(16),z4=new Float32Array(9),V4=new Float32Array(4);function $g(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let a=F4[i];if(a===void 0&&(a=new Float32Array(i),F4[i]=a),e!==0){r.toArray(a,0);for(let s=1,o=0;s!==e;++s)o+=t,n[s].toArray(a,o)}return a}function ki(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Ri(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function oT(n,e){let t=B4[e];t===void 0&&(t=new Int32Array(e),B4[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function rSe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function iSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ki(t,e))return;n.uniform2fv(this.addr,e),Ri(t,e)}}function aSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ki(t,e))return;n.uniform3fv(this.addr,e),Ri(t,e)}}function sSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ki(t,e))return;n.uniform4fv(this.addr,e),Ri(t,e)}}function oSe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ki(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ri(t,e)}else{if(ki(t,r))return;V4.set(r),n.uniformMatrix2fv(this.addr,!1,V4),Ri(t,r)}}function lSe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ki(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ri(t,e)}else{if(ki(t,r))return;z4.set(r),n.uniformMatrix3fv(this.addr,!1,z4),Ri(t,r)}}function uSe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(ki(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ri(t,e)}else{if(ki(t,r))return;U4.set(r),n.uniformMatrix4fv(this.addr,!1,U4),Ri(t,r)}}function cSe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function fSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ki(t,e))return;n.uniform2iv(this.addr,e),Ri(t,e)}}function hSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ki(t,e))return;n.uniform3iv(this.addr,e),Ri(t,e)}}function dSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ki(t,e))return;n.uniform4iv(this.addr,e),Ri(t,e)}}function pSe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function mSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ki(t,e))return;n.uniform2uiv(this.addr,e),Ri(t,e)}}function gSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ki(t,e))return;n.uniform3uiv(this.addr,e),Ri(t,e)}}function vSe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ki(t,e))return;n.uniform4uiv(this.addr,e),Ri(t,e)}}function ySe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2D(e||s7,i)}function _Se(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||l7,i)}function xSe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||u7,i)}function bSe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||o7,i)}function wSe(n){switch(n){case 5126:return rSe;case 35664:return iSe;case 35665:return aSe;case 35666:return sSe;case 35674:return oSe;case 35675:return lSe;case 35676:return uSe;case 5124:case 35670:return cSe;case 35667:case 35671:return fSe;case 35668:case 35672:return hSe;case 35669:case 35673:return dSe;case 5125:return pSe;case 36294:return mSe;case 36295:return gSe;case 36296:return vSe;case 35678:case 36198:case 36298:case 36306:case 35682:return ySe;case 35679:case 36299:case 36307:return _Se;case 35680:case 36300:case 36308:case 36293:return xSe;case 36289:case 36303:case 36311:case 36292:return bSe}}function SSe(n,e){n.uniform1fv(this.addr,e)}function TSe(n,e){const t=$g(e,this.size,2);n.uniform2fv(this.addr,t)}function CSe(n,e){const t=$g(e,this.size,3);n.uniform3fv(this.addr,t)}function ESe(n,e){const t=$g(e,this.size,4);n.uniform4fv(this.addr,t)}function ASe(n,e){const t=$g(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function MSe(n,e){const t=$g(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function kSe(n,e){const t=$g(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function RSe(n,e){n.uniform1iv(this.addr,e)}function PSe(n,e){n.uniform2iv(this.addr,e)}function ISe(n,e){n.uniform3iv(this.addr,e)}function DSe(n,e){n.uniform4iv(this.addr,e)}function LSe(n,e){n.uniform1uiv(this.addr,e)}function NSe(n,e){n.uniform2uiv(this.addr,e)}function OSe(n,e){n.uniform3uiv(this.addr,e)}function $Se(n,e){n.uniform4uiv(this.addr,e)}function FSe(n,e,t){const r=this.cache,i=e.length,a=oT(t,i);ki(r,a)||(n.uniform1iv(this.addr,a),Ri(r,a));for(let s=0;s!==i;++s)t.setTexture2D(e[s]||s7,a[s])}function BSe(n,e,t){const r=this.cache,i=e.length,a=oT(t,i);ki(r,a)||(n.uniform1iv(this.addr,a),Ri(r,a));for(let s=0;s!==i;++s)t.setTexture3D(e[s]||l7,a[s])}function USe(n,e,t){const r=this.cache,i=e.length,a=oT(t,i);ki(r,a)||(n.uniform1iv(this.addr,a),Ri(r,a));for(let s=0;s!==i;++s)t.setTextureCube(e[s]||u7,a[s])}function zSe(n,e,t){const r=this.cache,i=e.length,a=oT(t,i);ki(r,a)||(n.uniform1iv(this.addr,a),Ri(r,a));for(let s=0;s!==i;++s)t.setTexture2DArray(e[s]||o7,a[s])}function VSe(n){switch(n){case 5126:return SSe;case 35664:return TSe;case 35665:return CSe;case 35666:return ESe;case 35674:return ASe;case 35675:return MSe;case 35676:return kSe;case 5124:case 35670:return RSe;case 35667:case 35671:return PSe;case 35668:case 35672:return ISe;case 35669:case 35673:return DSe;case 5125:return LSe;case 36294:return NSe;case 36295:return OSe;case 36296:return $Se;case 35678:case 36198:case 36298:case 36306:case 35682:return FSe;case 35679:case 36299:case 36307:return BSe;case 35680:case 36300:case 36308:case 36293:return USe;case 36289:case 36303:case 36311:case 36292:return zSe}}class HSe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=wSe(t.type)}}class WSe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=VSe(t.type)}}class GSe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let a=0,s=i.length;a!==s;++a){const o=i[a];o.setValue(e,t[o.id],r)}}}const D2=/(\w+)(\])?(\[|\.)?/g;function H4(n,e){n.seq.push(e),n.map[e.id]=e}function jSe(n,e,t){const r=n.name,i=r.length;for(D2.lastIndex=0;;){const a=D2.exec(r),s=D2.lastIndex;let o=a[1];const l=a[2]==="]",u=a[3];if(l&&(o=o|0),u===void 0||u==="["&&s+2===i){H4(t,u===void 0?new HSe(o,n,e):new WSe(o,n,e));break}else{let f=t.map[o];f===void 0&&(f=new GSe(o),H4(t,f)),t=f}}}class z1{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){const a=e.getActiveUniform(t,i),s=e.getUniformLocation(t,a.name);jSe(a,s,this)}}setValue(e,t,r,i){const a=this.map[t];a!==void 0&&a.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let a=0,s=t.length;a!==s;++a){const o=t[a],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,a=e.length;i!==a;++i){const s=e[i];s.id in t&&r.push(s)}return r}}function W4(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}let qSe=0;function XSe(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let s=i;s<a;s++){const o=s+1;r.push(`${o===e?">":" "} ${o}: ${t[s]}`)}return r.join(`
`)}function KSe(n){switch(n){case md:return["Linear","( value )"];case fr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function G4(n,e,t){const r=n.getShaderParameter(e,35713),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const s=parseInt(a[1]);return t.toUpperCase()+`

`+i+`

`+XSe(n.getShaderSource(e),s)}else return i}function YSe(n,e){const t=KSe(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ZSe(n,e){let t;switch(e){case axe:t="Linear";break;case sxe:t="Reinhard";break;case oxe:t="OptimizedCineon";break;case lxe:t="ACESFilmic";break;case uxe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function QSe(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(my).join(`
`)}function JSe(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function eTe(n,e){const t={},r=n.getProgramParameter(e,35721);for(let i=0;i<r;i++){const a=n.getActiveAttrib(e,i),s=a.name;let o=1;a.type===35674&&(o=2),a.type===35675&&(o=3),a.type===35676&&(o=4),t[s]={type:a.type,location:n.getAttribLocation(e,s),locationSize:o}}return t}function my(n){return n!==""}function j4(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function q4(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const tTe=/^[ \t]*#include +<([\w\d./]+)>/gm;function AM(n){return n.replace(tTe,nTe)}function nTe(n,e){const t=Rn[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return AM(t)}const rTe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function X4(n){return n.replace(rTe,iTe)}function iTe(n,e,t,r){let i="";for(let a=parseInt(e);a<parseInt(t);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function K4(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function aTe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===Uj?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===$_e?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===py&&(e="SHADOWMAP_TYPE_VSM"),e}function sTe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Jm:case eg:e="ENVMAP_TYPE_CUBE";break;case iT:e="ENVMAP_TYPE_CUBE_UV";break}return e}function oTe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case eg:e="ENVMAP_MODE_REFRACTION";break}return e}function lTe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case KP:e="ENVMAP_BLENDING_MULTIPLY";break;case rxe:e="ENVMAP_BLENDING_MIX";break;case ixe:e="ENVMAP_BLENDING_ADD";break}return e}function uTe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function cTe(n,e,t,r){const i=n.getContext(),a=t.defines;let s=t.vertexShader,o=t.fragmentShader;const l=aTe(t),u=sTe(t),c=oTe(t),f=lTe(t),h=uTe(t),d=t.isWebGL2?"":QSe(t),p=JSe(a),m=i.createProgram();let g,v,_=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=[p].filter(my).join(`
`),g.length>0&&(g+=`
`),v=[d,p].filter(my).join(`
`),v.length>0&&(v+=`
`)):(g=[K4(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(my).join(`
`),v=[d,K4(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+f:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Bu?"#define TONE_MAPPING":"",t.toneMapping!==Bu?Rn.tonemapping_pars_fragment:"",t.toneMapping!==Bu?ZSe("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Rn.encodings_pars_fragment,YSe("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(my).join(`
`)),s=AM(s),s=j4(s,t),s=q4(s,t),o=AM(o),o=j4(o,t),o=q4(o,t),s=X4(s),o=X4(o),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",t.glslVersion===_4?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===_4?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const x=_+g+s,b=_+v+o,S=W4(i,35633,x),T=W4(i,35632,b);if(i.attachShader(m,S),i.attachShader(m,T),t.index0AttributeName!==void 0?i.bindAttribLocation(m,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),n.debug.checkShaderErrors){const k=i.getProgramInfoLog(m).trim(),R=i.getShaderInfoLog(S).trim(),P=i.getShaderInfoLog(T).trim();let N=!0,L=!0;if(i.getProgramParameter(m,35714)===!1){N=!1;const F=G4(i,S,"vertex"),O=G4(i,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,35715)+`

Program Info Log: `+k+`
`+F+`
`+O)}else k!==""?console.warn("THREE.WebGLProgram: Program Info Log:",k):(R===""||P==="")&&(L=!1);L&&(this.diagnostics={runnable:N,programLog:k,vertexShader:{log:R,prefix:g},fragmentShader:{log:P,prefix:v}})}i.deleteShader(S),i.deleteShader(T);let M;this.getUniforms=function(){return M===void 0&&(M=new z1(i,m)),M};let C;return this.getAttributes=function(){return C===void 0&&(C=eTe(i,m)),C},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=qSe++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=T,this}let fTe=0;class hTe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),a=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(a)===!1&&(s.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new dTe(e),t.set(e,r)),r}}class dTe{constructor(e){this.id=fTe++,this.code=e,this.usedTimes=0}}function pTe(n,e,t,r,i,a,s){const o=new QP,l=new hTe,u=[],c=i.isWebGL2,f=i.logarithmicDepthBuffer,h=i.vertexTextures;let d=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(C,k,R,P,N){const L=P.fog,F=N.geometry,O=C.isMeshStandardMaterial?P.environment:null,B=(C.isMeshStandardMaterial?t:e).get(C.envMap||O),H=B&&B.mapping===iT?B.image.height:null,j=p[C.type];C.precision!==null&&(d=i.getMaxPrecision(C.precision),d!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",d,"instead."));const K=F.morphAttributes.position||F.morphAttributes.normal||F.morphAttributes.color,J=K!==void 0?K.length:0;let re=0;F.morphAttributes.position!==void 0&&(re=1),F.morphAttributes.normal!==void 0&&(re=2),F.morphAttributes.color!==void 0&&(re=3);let se,Ae,Ee,Ne;if(j){const He=Ml[j];se=He.vertexShader,Ae=He.fragmentShader}else se=C.vertexShader,Ae=C.fragmentShader,l.update(C),Ee=l.getVertexShaderID(C),Ne=l.getFragmentShaderID(C);const we=n.getRenderTarget(),me=C.alphaTest>0,Se=C.clearcoat>0,Me=C.iridescence>0;return{isWebGL2:c,shaderID:j,shaderName:C.type,vertexShader:se,fragmentShader:Ae,defines:C.defines,customVertexShaderID:Ee,customFragmentShaderID:Ne,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:d,instancing:N.isInstancedMesh===!0,instancingColor:N.isInstancedMesh===!0&&N.instanceColor!==null,supportsVertexTextures:h,outputEncoding:we===null?n.outputEncoding:we.isXRRenderTarget===!0?we.texture.encoding:md,map:!!C.map,matcap:!!C.matcap,envMap:!!B,envMapMode:B&&B.mapping,envMapCubeUVHeight:H,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:C.normalMapType===Axe,tangentSpaceNormalMap:C.normalMapType===YP,decodeVideoTexture:!!C.map&&C.map.isVideoTexture===!0&&C.map.encoding===fr,clearcoat:Se,clearcoatMap:Se&&!!C.clearcoatMap,clearcoatRoughnessMap:Se&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:Se&&!!C.clearcoatNormalMap,iridescence:Me,iridescenceMap:Me&&!!C.iridescenceMap,iridescenceThicknessMap:Me&&!!C.iridescenceThicknessMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:C.transparent===!1&&C.blending===Am,alphaMap:!!C.alphaMap,alphaTest:me,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!F.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!F.attributes.color&&F.attributes.color.itemSize===4,vertexUvs:!!C.map||!!C.bumpMap||!!C.normalMap||!!C.specularMap||!!C.alphaMap||!!C.emissiveMap||!!C.roughnessMap||!!C.metalnessMap||!!C.clearcoatMap||!!C.clearcoatRoughnessMap||!!C.clearcoatNormalMap||!!C.iridescenceMap||!!C.iridescenceThicknessMap||!!C.displacementMap||!!C.transmissionMap||!!C.thicknessMap||!!C.specularIntensityMap||!!C.specularColorMap||!!C.sheenColorMap||!!C.sheenRoughnessMap,uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.iridescenceMap||C.iridescenceThicknessMap||C.transmission>0||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheen>0||C.sheenColorMap||C.sheenRoughnessMap)&&!!C.displacementMap,fog:!!L,useFog:C.fog===!0,fogExp2:L&&L.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:f,skinning:N.isSkinnedMesh===!0,morphTargets:F.morphAttributes.position!==void 0,morphNormals:F.morphAttributes.normal!==void 0,morphColors:F.morphAttributes.color!==void 0,morphTargetsCount:J,morphTextureStride:re,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&R.length>0,shadowMapType:n.shadowMap.type,toneMapping:C.toneMapped?n.toneMapping:Bu,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===rT,flipSided:C.side===po,useDepthPacking:!!C.depthPacking,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){const k=[];if(C.shaderID?k.push(C.shaderID):(k.push(C.customVertexShaderID),k.push(C.customFragmentShaderID)),C.defines!==void 0)for(const R in C.defines)k.push(R),k.push(C.defines[R]);return C.isRawShaderMaterial===!1&&(v(k,C),_(k,C),k.push(n.outputEncoding)),k.push(C.customProgramCacheKey),k.join()}function v(C,k){C.push(k.precision),C.push(k.outputEncoding),C.push(k.envMapMode),C.push(k.envMapCubeUVHeight),C.push(k.combine),C.push(k.vertexUvs),C.push(k.fogExp2),C.push(k.sizeAttenuation),C.push(k.morphTargetsCount),C.push(k.morphAttributeCount),C.push(k.numDirLights),C.push(k.numPointLights),C.push(k.numSpotLights),C.push(k.numSpotLightMaps),C.push(k.numHemiLights),C.push(k.numRectAreaLights),C.push(k.numDirLightShadows),C.push(k.numPointLightShadows),C.push(k.numSpotLightShadows),C.push(k.numSpotLightShadowsWithMaps),C.push(k.shadowMapType),C.push(k.toneMapping),C.push(k.numClippingPlanes),C.push(k.numClipIntersection),C.push(k.depthPacking)}function _(C,k){o.disableAll(),k.isWebGL2&&o.enable(0),k.supportsVertexTextures&&o.enable(1),k.instancing&&o.enable(2),k.instancingColor&&o.enable(3),k.map&&o.enable(4),k.matcap&&o.enable(5),k.envMap&&o.enable(6),k.lightMap&&o.enable(7),k.aoMap&&o.enable(8),k.emissiveMap&&o.enable(9),k.bumpMap&&o.enable(10),k.normalMap&&o.enable(11),k.objectSpaceNormalMap&&o.enable(12),k.tangentSpaceNormalMap&&o.enable(13),k.clearcoat&&o.enable(14),k.clearcoatMap&&o.enable(15),k.clearcoatRoughnessMap&&o.enable(16),k.clearcoatNormalMap&&o.enable(17),k.iridescence&&o.enable(18),k.iridescenceMap&&o.enable(19),k.iridescenceThicknessMap&&o.enable(20),k.displacementMap&&o.enable(21),k.specularMap&&o.enable(22),k.roughnessMap&&o.enable(23),k.metalnessMap&&o.enable(24),k.gradientMap&&o.enable(25),k.alphaMap&&o.enable(26),k.alphaTest&&o.enable(27),k.vertexColors&&o.enable(28),k.vertexAlphas&&o.enable(29),k.vertexUvs&&o.enable(30),k.vertexTangents&&o.enable(31),k.uvsVertexOnly&&o.enable(32),C.push(o.mask),o.disableAll(),k.fog&&o.enable(0),k.useFog&&o.enable(1),k.flatShading&&o.enable(2),k.logarithmicDepthBuffer&&o.enable(3),k.skinning&&o.enable(4),k.morphTargets&&o.enable(5),k.morphNormals&&o.enable(6),k.morphColors&&o.enable(7),k.premultipliedAlpha&&o.enable(8),k.shadowMapEnabled&&o.enable(9),k.physicallyCorrectLights&&o.enable(10),k.doubleSided&&o.enable(11),k.flipSided&&o.enable(12),k.useDepthPacking&&o.enable(13),k.dithering&&o.enable(14),k.specularIntensityMap&&o.enable(15),k.specularColorMap&&o.enable(16),k.transmission&&o.enable(17),k.transmissionMap&&o.enable(18),k.thicknessMap&&o.enable(19),k.sheen&&o.enable(20),k.sheenColorMap&&o.enable(21),k.sheenRoughnessMap&&o.enable(22),k.decodeVideoTexture&&o.enable(23),k.opaque&&o.enable(24),C.push(o.mask)}function x(C){const k=p[C.type];let R;if(k){const P=Ml[k];R=JP.clone(P.uniforms)}else R=C.uniforms;return R}function b(C,k){let R;for(let P=0,N=u.length;P<N;P++){const L=u[P];if(L.cacheKey===k){R=L,++R.usedTimes;break}}return R===void 0&&(R=new cTe(n,k,C,a),u.push(R)),R}function S(C){if(--C.usedTimes===0){const k=u.indexOf(C);u[k]=u[u.length-1],u.pop(),C.destroy()}}function T(C){l.remove(C)}function M(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:x,acquireProgram:b,releaseProgram:S,releaseShaderCache:T,programs:u,dispose:M}}function mTe(){let n=new WeakMap;function e(a){let s=n.get(a);return s===void 0&&(s={},n.set(a,s)),s}function t(a){n.delete(a)}function r(a,s,o){n.get(a)[s]=o}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function gTe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Y4(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Z4(){const n=[];let e=0;const t=[],r=[],i=[];function a(){e=0,t.length=0,r.length=0,i.length=0}function s(f,h,d,p,m,g){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:h,material:d,groupOrder:p,renderOrder:f.renderOrder,z:m,group:g},n[e]=v):(v.id=f.id,v.object=f,v.geometry=h,v.material=d,v.groupOrder=p,v.renderOrder=f.renderOrder,v.z=m,v.group=g),e++,v}function o(f,h,d,p,m,g){const v=s(f,h,d,p,m,g);d.transmission>0?r.push(v):d.transparent===!0?i.push(v):t.push(v)}function l(f,h,d,p,m,g){const v=s(f,h,d,p,m,g);d.transmission>0?r.unshift(v):d.transparent===!0?i.unshift(v):t.unshift(v)}function u(f,h){t.length>1&&t.sort(f||gTe),r.length>1&&r.sort(h||Y4),i.length>1&&i.sort(h||Y4)}function c(){for(let f=e,h=n.length;f<h;f++){const d=n[f];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:t,transmissive:r,transparent:i,init:a,push:o,unshift:l,finish:c,sort:u}}function vTe(){let n=new WeakMap;function e(r,i){const a=n.get(r);let s;return a===void 0?(s=new Z4,n.set(r,[s])):i>=a.length?(s=new Z4,a.push(s)):s=a[i],s}function t(){n=new WeakMap}return{get:e,dispose:t}}function yTe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new De,color:new gn};break;case"SpotLight":t={position:new De,direction:new De,color:new gn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new De,color:new gn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new De,skyColor:new gn,groundColor:new gn};break;case"RectAreaLight":t={color:new gn,position:new De,halfWidth:new De,halfHeight:new De};break}return n[e.id]=t,t}}}function _Te(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new un};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new un};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new un,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let xTe=0;function bTe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function wTe(n,e){const t=new yTe,r=_Te(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let c=0;c<9;c++)i.probe.push(new De);const a=new De,s=new Un,o=new Un;function l(c,f){let h=0,d=0,p=0;for(let P=0;P<9;P++)i.probe[P].set(0,0,0);let m=0,g=0,v=0,_=0,x=0,b=0,S=0,T=0,M=0,C=0;c.sort(bTe);const k=f!==!0?Math.PI:1;for(let P=0,N=c.length;P<N;P++){const L=c[P],F=L.color,O=L.intensity,B=L.distance,H=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)h+=F.r*O*k,d+=F.g*O*k,p+=F.b*O*k;else if(L.isLightProbe)for(let j=0;j<9;j++)i.probe[j].addScaledVector(L.sh.coefficients[j],O);else if(L.isDirectionalLight){const j=t.get(L);if(j.color.copy(L.color).multiplyScalar(L.intensity*k),L.castShadow){const K=L.shadow,J=r.get(L);J.shadowBias=K.bias,J.shadowNormalBias=K.normalBias,J.shadowRadius=K.radius,J.shadowMapSize=K.mapSize,i.directionalShadow[m]=J,i.directionalShadowMap[m]=H,i.directionalShadowMatrix[m]=L.shadow.matrix,b++}i.directional[m]=j,m++}else if(L.isSpotLight){const j=t.get(L);j.position.setFromMatrixPosition(L.matrixWorld),j.color.copy(F).multiplyScalar(O*k),j.distance=B,j.coneCos=Math.cos(L.angle),j.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),j.decay=L.decay,i.spot[v]=j;const K=L.shadow;if(L.map&&(i.spotLightMap[M]=L.map,M++,K.updateMatrices(L),L.castShadow&&C++),i.spotLightMatrix[v]=K.matrix,L.castShadow){const J=r.get(L);J.shadowBias=K.bias,J.shadowNormalBias=K.normalBias,J.shadowRadius=K.radius,J.shadowMapSize=K.mapSize,i.spotShadow[v]=J,i.spotShadowMap[v]=H,T++}v++}else if(L.isRectAreaLight){const j=t.get(L);j.color.copy(F).multiplyScalar(O),j.halfWidth.set(L.width*.5,0,0),j.halfHeight.set(0,L.height*.5,0),i.rectArea[_]=j,_++}else if(L.isPointLight){const j=t.get(L);if(j.color.copy(L.color).multiplyScalar(L.intensity*k),j.distance=L.distance,j.decay=L.decay,L.castShadow){const K=L.shadow,J=r.get(L);J.shadowBias=K.bias,J.shadowNormalBias=K.normalBias,J.shadowRadius=K.radius,J.shadowMapSize=K.mapSize,J.shadowCameraNear=K.camera.near,J.shadowCameraFar=K.camera.far,i.pointShadow[g]=J,i.pointShadowMap[g]=H,i.pointShadowMatrix[g]=L.shadow.matrix,S++}i.point[g]=j,g++}else if(L.isHemisphereLight){const j=t.get(L);j.skyColor.copy(L.color).multiplyScalar(O*k),j.groundColor.copy(L.groundColor).multiplyScalar(O*k),i.hemi[x]=j,x++}}_>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=At.LTC_FLOAT_1,i.rectAreaLTC2=At.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=At.LTC_HALF_1,i.rectAreaLTC2=At.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=h,i.ambient[1]=d,i.ambient[2]=p;const R=i.hash;(R.directionalLength!==m||R.pointLength!==g||R.spotLength!==v||R.rectAreaLength!==_||R.hemiLength!==x||R.numDirectionalShadows!==b||R.numPointShadows!==S||R.numSpotShadows!==T||R.numSpotMaps!==M)&&(i.directional.length=m,i.spot.length=v,i.rectArea.length=_,i.point.length=g,i.hemi.length=x,i.directionalShadow.length=b,i.directionalShadowMap.length=b,i.pointShadow.length=S,i.pointShadowMap.length=S,i.spotShadow.length=T,i.spotShadowMap.length=T,i.directionalShadowMatrix.length=b,i.pointShadowMatrix.length=S,i.spotLightMatrix.length=T+M-C,i.spotLightMap.length=M,i.numSpotLightShadowsWithMaps=C,R.directionalLength=m,R.pointLength=g,R.spotLength=v,R.rectAreaLength=_,R.hemiLength=x,R.numDirectionalShadows=b,R.numPointShadows=S,R.numSpotShadows=T,R.numSpotMaps=M,i.version=xTe++)}function u(c,f){let h=0,d=0,p=0,m=0,g=0;const v=f.matrixWorldInverse;for(let _=0,x=c.length;_<x;_++){const b=c[_];if(b.isDirectionalLight){const S=i.directional[h];S.direction.setFromMatrixPosition(b.matrixWorld),a.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(a),S.direction.transformDirection(v),h++}else if(b.isSpotLight){const S=i.spot[p];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),S.direction.setFromMatrixPosition(b.matrixWorld),a.setFromMatrixPosition(b.target.matrixWorld),S.direction.sub(a),S.direction.transformDirection(v),p++}else if(b.isRectAreaLight){const S=i.rectArea[m];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),o.identity(),s.copy(b.matrixWorld),s.premultiply(v),o.extractRotation(s),S.halfWidth.set(b.width*.5,0,0),S.halfHeight.set(0,b.height*.5,0),S.halfWidth.applyMatrix4(o),S.halfHeight.applyMatrix4(o),m++}else if(b.isPointLight){const S=i.point[d];S.position.setFromMatrixPosition(b.matrixWorld),S.position.applyMatrix4(v),d++}else if(b.isHemisphereLight){const S=i.hemi[g];S.direction.setFromMatrixPosition(b.matrixWorld),S.direction.transformDirection(v),g++}}}return{setup:l,setupView:u,state:i}}function Q4(n,e){const t=new wTe(n,e),r=[],i=[];function a(){r.length=0,i.length=0}function s(f){r.push(f)}function o(f){i.push(f)}function l(f){t.setup(r,f)}function u(f){t.setupView(r,f)}return{init:a,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:u,pushLight:s,pushShadow:o}}function STe(n,e){let t=new WeakMap;function r(a,s=0){const o=t.get(a);let l;return o===void 0?(l=new Q4(n,e),t.set(a,[l])):s>=o.length?(l=new Q4(n,e),o.push(l)):l=o[s],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class TTe extends Zo{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Cxe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class CTe extends Zo{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new De,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const ETe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ATe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function MTe(n,e,t){let r=new tI;const i=new un,a=new un,s=new Nr,o=new TTe({depthPacking:Exe}),l=new CTe,u={},c=t.maxTextureSize,f={0:po,1:cf,2:rT},h=new jl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new un},radius:{value:4}},vertexShader:ETe,fragmentShader:ATe}),d=h.clone();d.defines.HORIZONTAL_PASS=1;const p=new xa;p.setAttribute("position",new Yi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new ns(p,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Uj,this.render=function(b,S,T){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;const M=n.getRenderTarget(),C=n.getActiveCubeFace(),k=n.getActiveMipmapLevel(),R=n.state;R.setBlending(tf),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let P=0,N=b.length;P<N;P++){const L=b[P],F=L.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;i.copy(F.mapSize);const O=F.getFrameExtents();if(i.multiply(O),a.copy(F.mapSize),(i.x>c||i.y>c)&&(i.x>c&&(a.x=Math.floor(c/O.x),i.x=a.x*O.x,F.mapSize.x=a.x),i.y>c&&(a.y=Math.floor(c/O.y),i.y=a.y*O.y,F.mapSize.y=a.y)),F.map===null){const H=this.type!==py?{minFilter:Ni,magFilter:Ni}:{};F.map=new ff(i.x,i.y,H),F.map.texture.name=L.name+".shadowMap",F.camera.updateProjectionMatrix()}n.setRenderTarget(F.map),n.clear();const B=F.getViewportCount();for(let H=0;H<B;H++){const j=F.getViewport(H);s.set(a.x*j.x,a.y*j.y,a.x*j.z,a.y*j.w),R.viewport(s),F.updateMatrices(L,H),r=F.getFrustum(),x(S,T,F.camera,L,this.type)}F.isPointLightShadow!==!0&&this.type===py&&v(F,T),F.needsUpdate=!1}g.needsUpdate=!1,n.setRenderTarget(M,C,k)};function v(b,S){const T=e.update(m);h.defines.VSM_SAMPLES!==b.blurSamples&&(h.defines.VSM_SAMPLES=b.blurSamples,d.defines.VSM_SAMPLES=b.blurSamples,h.needsUpdate=!0,d.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new ff(i.x,i.y)),h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(S,null,T,h,m,null),d.uniforms.shadow_pass.value=b.mapPass.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(S,null,T,d,m,null)}function _(b,S,T,M,C,k){let R=null;const P=T.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(P!==void 0)R=P;else if(R=T.isPointLight===!0?l:o,n.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const N=R.uuid,L=S.uuid;let F=u[N];F===void 0&&(F={},u[N]=F);let O=F[L];O===void 0&&(O=R.clone(),F[L]=O),R=O}return R.visible=S.visible,R.wireframe=S.wireframe,k===py?R.side=S.shadowSide!==null?S.shadowSide:S.side:R.side=S.shadowSide!==null?S.shadowSide:f[S.side],R.alphaMap=S.alphaMap,R.alphaTest=S.alphaTest,R.map=S.map,R.clipShadows=S.clipShadows,R.clippingPlanes=S.clippingPlanes,R.clipIntersection=S.clipIntersection,R.displacementMap=S.displacementMap,R.displacementScale=S.displacementScale,R.displacementBias=S.displacementBias,R.wireframeLinewidth=S.wireframeLinewidth,R.linewidth=S.linewidth,T.isPointLight===!0&&R.isMeshDistanceMaterial===!0&&(R.referencePosition.setFromMatrixPosition(T.matrixWorld),R.nearDistance=M,R.farDistance=C),R}function x(b,S,T,M,C){if(b.visible===!1)return;if(b.layers.test(S.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&C===py)&&(!b.frustumCulled||r.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,b.matrixWorld);const P=e.update(b),N=b.material;if(Array.isArray(N)){const L=P.groups;for(let F=0,O=L.length;F<O;F++){const B=L[F],H=N[B.materialIndex];if(H&&H.visible){const j=_(b,H,M,T.near,T.far,C);n.renderBufferDirect(T,null,P,j,b,B)}}}else if(N.visible){const L=_(b,N,M,T.near,T.far,C);n.renderBufferDirect(T,null,P,L,b,null)}}const R=b.children;for(let P=0,N=R.length;P<N;P++)x(R[P],S,T,M,C)}}function kTe(n,e,t){const r=t.isWebGL2;function i(){let Pe=!1;const Je=new Nr;let ot=null;const wt=new Nr(0,0,0,0);return{setMask:function(Bt){ot!==Bt&&!Pe&&(n.colorMask(Bt,Bt,Bt,Bt),ot=Bt)},setLocked:function(Bt){Pe=Bt},setClear:function(Bt,Ln,lr,Xr,Ca){Ca===!0&&(Bt*=Xr,Ln*=Xr,lr*=Xr),Je.set(Bt,Ln,lr,Xr),wt.equals(Je)===!1&&(n.clearColor(Bt,Ln,lr,Xr),wt.copy(Je))},reset:function(){Pe=!1,ot=null,wt.set(-1,0,0,0)}}}function a(){let Pe=!1,Je=null,ot=null,wt=null;return{setTest:function(Bt){Bt?me(2929):Se(2929)},setMask:function(Bt){Je!==Bt&&!Pe&&(n.depthMask(Bt),Je=Bt)},setFunc:function(Bt){if(ot!==Bt){switch(Bt){case Y_e:n.depthFunc(512);break;case Z_e:n.depthFunc(519);break;case Q_e:n.depthFunc(513);break;case xM:n.depthFunc(515);break;case J_e:n.depthFunc(514);break;case exe:n.depthFunc(518);break;case txe:n.depthFunc(516);break;case nxe:n.depthFunc(517);break;default:n.depthFunc(515)}ot=Bt}},setLocked:function(Bt){Pe=Bt},setClear:function(Bt){wt!==Bt&&(n.clearDepth(Bt),wt=Bt)},reset:function(){Pe=!1,Je=null,ot=null,wt=null}}}function s(){let Pe=!1,Je=null,ot=null,wt=null,Bt=null,Ln=null,lr=null,Xr=null,Ca=null;return{setTest:function(tr){Pe||(tr?me(2960):Se(2960))},setMask:function(tr){Je!==tr&&!Pe&&(n.stencilMask(tr),Je=tr)},setFunc:function(tr,Fr,hi){(ot!==tr||wt!==Fr||Bt!==hi)&&(n.stencilFunc(tr,Fr,hi),ot=tr,wt=Fr,Bt=hi)},setOp:function(tr,Fr,hi){(Ln!==tr||lr!==Fr||Xr!==hi)&&(n.stencilOp(tr,Fr,hi),Ln=tr,lr=Fr,Xr=hi)},setLocked:function(tr){Pe=tr},setClear:function(tr){Ca!==tr&&(n.clearStencil(tr),Ca=tr)},reset:function(){Pe=!1,Je=null,ot=null,wt=null,Bt=null,Ln=null,lr=null,Xr=null,Ca=null}}}const o=new i,l=new a,u=new s,c=new WeakMap,f=new WeakMap;let h={},d={},p=new WeakMap,m=[],g=null,v=!1,_=null,x=null,b=null,S=null,T=null,M=null,C=null,k=!1,R=null,P=null,N=null,L=null,F=null;const O=n.getParameter(35661);let B=!1,H=0;const j=n.getParameter(7938);j.indexOf("WebGL")!==-1?(H=parseFloat(/^WebGL (\d)/.exec(j)[1]),B=H>=1):j.indexOf("OpenGL ES")!==-1&&(H=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),B=H>=2);let K=null,J={};const re=n.getParameter(3088),se=n.getParameter(2978),Ae=new Nr().fromArray(re),Ee=new Nr().fromArray(se);function Ne(Pe,Je,ot){const wt=new Uint8Array(4),Bt=n.createTexture();n.bindTexture(Pe,Bt),n.texParameteri(Pe,10241,9728),n.texParameteri(Pe,10240,9728);for(let Ln=0;Ln<ot;Ln++)n.texImage2D(Je+Ln,0,6408,1,1,0,6408,5121,wt);return Bt}const we={};we[3553]=Ne(3553,3553,1),we[34067]=Ne(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),u.setClear(0),me(2929),l.setFunc(xM),Ge(!1),Ze(HB),me(2884),xe(tf);function me(Pe){h[Pe]!==!0&&(n.enable(Pe),h[Pe]=!0)}function Se(Pe){h[Pe]!==!1&&(n.disable(Pe),h[Pe]=!1)}function Me(Pe,Je){return d[Pe]!==Je?(n.bindFramebuffer(Pe,Je),d[Pe]=Je,r&&(Pe===36009&&(d[36160]=Je),Pe===36160&&(d[36009]=Je)),!0):!1}function ke(Pe,Je){let ot=m,wt=!1;if(Pe)if(ot=p.get(Je),ot===void 0&&(ot=[],p.set(Je,ot)),Pe.isWebGLMultipleRenderTargets){const Bt=Pe.texture;if(ot.length!==Bt.length||ot[0]!==36064){for(let Ln=0,lr=Bt.length;Ln<lr;Ln++)ot[Ln]=36064+Ln;ot.length=Bt.length,wt=!0}}else ot[0]!==36064&&(ot[0]=36064,wt=!0);else ot[0]!==1029&&(ot[0]=1029,wt=!0);wt&&(t.isWebGL2?n.drawBuffers(ot):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ot))}function He(Pe){return g!==Pe?(n.useProgram(Pe),g=Pe,!0):!1}const ee={[Jp]:32774,[B_e]:32778,[U_e]:32779};if(r)ee[qB]=32775,ee[XB]=32776;else{const Pe=e.get("EXT_blend_minmax");Pe!==null&&(ee[qB]=Pe.MIN_EXT,ee[XB]=Pe.MAX_EXT)}const ie={[z_e]:0,[V_e]:1,[H_e]:768,[zj]:770,[K_e]:776,[q_e]:774,[G_e]:772,[W_e]:769,[Vj]:771,[X_e]:775,[j_e]:773};function xe(Pe,Je,ot,wt,Bt,Ln,lr,Xr){if(Pe===tf){v===!0&&(Se(3042),v=!1);return}if(v===!1&&(me(3042),v=!0),Pe!==F_e){if(Pe!==_||Xr!==k){if((x!==Jp||T!==Jp)&&(n.blendEquation(32774),x=Jp,T=Jp),Xr)switch(Pe){case Am:n.blendFuncSeparate(1,771,1,771);break;case WB:n.blendFunc(1,1);break;case GB:n.blendFuncSeparate(0,769,0,1);break;case jB:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Pe);break}else switch(Pe){case Am:n.blendFuncSeparate(770,771,1,771);break;case WB:n.blendFunc(770,1);break;case GB:n.blendFuncSeparate(0,769,0,1);break;case jB:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Pe);break}b=null,S=null,M=null,C=null,_=Pe,k=Xr}return}Bt=Bt||Je,Ln=Ln||ot,lr=lr||wt,(Je!==x||Bt!==T)&&(n.blendEquationSeparate(ee[Je],ee[Bt]),x=Je,T=Bt),(ot!==b||wt!==S||Ln!==M||lr!==C)&&(n.blendFuncSeparate(ie[ot],ie[wt],ie[Ln],ie[lr]),b=ot,S=wt,M=Ln,C=lr),_=Pe,k=!1}function Ve(Pe,Je){Pe.side===rT?Se(2884):me(2884);let ot=Pe.side===po;Je&&(ot=!ot),Ge(ot),Pe.blending===Am&&Pe.transparent===!1?xe(tf):xe(Pe.blending,Pe.blendEquation,Pe.blendSrc,Pe.blendDst,Pe.blendEquationAlpha,Pe.blendSrcAlpha,Pe.blendDstAlpha,Pe.premultipliedAlpha),l.setFunc(Pe.depthFunc),l.setTest(Pe.depthTest),l.setMask(Pe.depthWrite),o.setMask(Pe.colorWrite);const wt=Pe.stencilWrite;u.setTest(wt),wt&&(u.setMask(Pe.stencilWriteMask),u.setFunc(Pe.stencilFunc,Pe.stencilRef,Pe.stencilFuncMask),u.setOp(Pe.stencilFail,Pe.stencilZFail,Pe.stencilZPass)),Qe(Pe.polygonOffset,Pe.polygonOffsetFactor,Pe.polygonOffsetUnits),Pe.alphaToCoverage===!0?me(32926):Se(32926)}function Ge(Pe){R!==Pe&&(Pe?n.frontFace(2304):n.frontFace(2305),R=Pe)}function Ze(Pe){Pe!==N_e?(me(2884),Pe!==P&&(Pe===HB?n.cullFace(1029):Pe===O_e?n.cullFace(1028):n.cullFace(1032))):Se(2884),P=Pe}function ut(Pe){Pe!==N&&(B&&n.lineWidth(Pe),N=Pe)}function Qe(Pe,Je,ot){Pe?(me(32823),(L!==Je||F!==ot)&&(n.polygonOffset(Je,ot),L=Je,F=ot)):Se(32823)}function ve(Pe){Pe?me(3089):Se(3089)}function Ke(Pe){Pe===void 0&&(Pe=33984+O-1),K!==Pe&&(n.activeTexture(Pe),K=Pe)}function ne(Pe,Je,ot){ot===void 0&&(K===null?ot=33984+O-1:ot=K);let wt=J[ot];wt===void 0&&(wt={type:void 0,texture:void 0},J[ot]=wt),(wt.type!==Pe||wt.texture!==Je)&&(K!==ot&&(n.activeTexture(ot),K=ot),n.bindTexture(Pe,Je||we[Pe]),wt.type=Pe,wt.texture=Je)}function Z(){const Pe=J[K];Pe!==void 0&&Pe.type!==void 0&&(n.bindTexture(Pe.type,null),Pe.type=void 0,Pe.texture=void 0)}function fe(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function Be(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function Xe(){try{n.texSubImage2D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function st(){try{n.texSubImage3D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function mt(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function ye(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function $e(){try{n.texStorage2D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function vt(){try{n.texStorage3D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function bt(){try{n.texImage2D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function dt(){try{n.texImage3D.apply(n,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}}function $t(Pe){Ae.equals(Pe)===!1&&(n.scissor(Pe.x,Pe.y,Pe.z,Pe.w),Ae.copy(Pe))}function Ct(Pe){Ee.equals(Pe)===!1&&(n.viewport(Pe.x,Pe.y,Pe.z,Pe.w),Ee.copy(Pe))}function Kt(Pe,Je){let ot=f.get(Je);ot===void 0&&(ot=new WeakMap,f.set(Je,ot));let wt=ot.get(Pe);wt===void 0&&(wt=n.getUniformBlockIndex(Je,Pe.name),ot.set(Pe,wt))}function Vt(Pe,Je){const wt=f.get(Je).get(Pe);c.get(Je)!==wt&&(n.uniformBlockBinding(Je,wt,Pe.__bindingPointIndex),c.set(Je,wt))}function Ft(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),r===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},K=null,J={},d={},p=new WeakMap,m=[],g=null,v=!1,_=null,x=null,b=null,S=null,T=null,M=null,C=null,k=!1,R=null,P=null,N=null,L=null,F=null,Ae.set(0,0,n.canvas.width,n.canvas.height),Ee.set(0,0,n.canvas.width,n.canvas.height),o.reset(),l.reset(),u.reset()}return{buffers:{color:o,depth:l,stencil:u},enable:me,disable:Se,bindFramebuffer:Me,drawBuffers:ke,useProgram:He,setBlending:xe,setMaterial:Ve,setFlipSided:Ge,setCullFace:Ze,setLineWidth:ut,setPolygonOffset:Qe,setScissorTest:ve,activeTexture:Ke,bindTexture:ne,unbindTexture:Z,compressedTexImage2D:fe,compressedTexImage3D:Be,texImage2D:bt,texImage3D:dt,updateUBOMapping:Kt,uniformBlockBinding:Vt,texStorage2D:$e,texStorage3D:vt,texSubImage2D:Xe,texSubImage3D:st,compressedTexSubImage2D:mt,compressedTexSubImage3D:ye,scissor:$t,viewport:Ct,reset:Ft}}function RTe(n,e,t,r,i,a,s){const o=i.isWebGL2,l=i.maxTextures,u=i.maxCubemapSize,c=i.maxTextureSize,f=i.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(ne,Z){return v?new OffscreenCanvas(ne,Z):P0("canvas")}function x(ne,Z,fe,Be){let Xe=1;if((ne.width>Be||ne.height>Be)&&(Xe=Be/Math.max(ne.width,ne.height)),Xe<1||Z===!0)if(typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ne instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ne instanceof ImageBitmap){const st=Z?ww:Math.floor,mt=st(Xe*ne.width),ye=st(Xe*ne.height);m===void 0&&(m=_(mt,ye));const $e=fe?_(mt,ye):m;return $e.width=mt,$e.height=ye,$e.getContext("2d").drawImage(ne,0,0,mt,ye),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ne.width+"x"+ne.height+") to ("+mt+"x"+ye+")."),$e}else return"data"in ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ne.width+"x"+ne.height+")."),ne;return ne}function b(ne){return EM(ne.width)&&EM(ne.height)}function S(ne){return o?!1:ne.wrapS!==Js||ne.wrapT!==Js||ne.minFilter!==Ni&&ne.minFilter!==Ya}function T(ne,Z){return ne.generateMipmaps&&Z&&ne.minFilter!==Ni&&ne.minFilter!==Ya}function M(ne){n.generateMipmap(ne)}function C(ne,Z,fe,Be,Xe=!1){if(o===!1)return Z;if(ne!==null){if(n[ne]!==void 0)return n[ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ne+"'")}let st=Z;return Z===6403&&(fe===5126&&(st=33326),fe===5131&&(st=33325),fe===5121&&(st=33321)),Z===33319&&(fe===5126&&(st=33328),fe===5131&&(st=33327),fe===5121&&(st=33323)),Z===6408&&(fe===5126&&(st=34836),fe===5131&&(st=34842),fe===5121&&(st=Be===fr&&Xe===!1?35907:32856),fe===32819&&(st=32854),fe===32820&&(st=32855)),(st===33325||st===33326||st===33327||st===33328||st===34842||st===34836)&&e.get("EXT_color_buffer_float"),st}function k(ne,Z,fe){return T(ne,fe)===!0||ne.isFramebufferTexture&&ne.minFilter!==Ni&&ne.minFilter!==Ya?Math.log2(Math.max(Z.width,Z.height))+1:ne.mipmaps!==void 0&&ne.mipmaps.length>0?ne.mipmaps.length:ne.isCompressedTexture&&Array.isArray(ne.image)?Z.mipmaps.length:1}function R(ne){return ne===Ni||ne===SM||ne===B1?9728:9729}function P(ne){const Z=ne.target;Z.removeEventListener("dispose",P),L(Z),Z.isVideoTexture&&p.delete(Z)}function N(ne){const Z=ne.target;Z.removeEventListener("dispose",N),O(Z)}function L(ne){const Z=r.get(ne);if(Z.__webglInit===void 0)return;const fe=ne.source,Be=g.get(fe);if(Be){const Xe=Be[Z.__cacheKey];Xe.usedTimes--,Xe.usedTimes===0&&F(ne),Object.keys(Be).length===0&&g.delete(fe)}r.remove(ne)}function F(ne){const Z=r.get(ne);n.deleteTexture(Z.__webglTexture);const fe=ne.source,Be=g.get(fe);delete Be[Z.__cacheKey],s.memory.textures--}function O(ne){const Z=ne.texture,fe=r.get(ne),Be=r.get(Z);if(Be.__webglTexture!==void 0&&(n.deleteTexture(Be.__webglTexture),s.memory.textures--),ne.depthTexture&&ne.depthTexture.dispose(),ne.isWebGLCubeRenderTarget)for(let Xe=0;Xe<6;Xe++)n.deleteFramebuffer(fe.__webglFramebuffer[Xe]),fe.__webglDepthbuffer&&n.deleteRenderbuffer(fe.__webglDepthbuffer[Xe]);else{if(n.deleteFramebuffer(fe.__webglFramebuffer),fe.__webglDepthbuffer&&n.deleteRenderbuffer(fe.__webglDepthbuffer),fe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(fe.__webglMultisampledFramebuffer),fe.__webglColorRenderbuffer)for(let Xe=0;Xe<fe.__webglColorRenderbuffer.length;Xe++)fe.__webglColorRenderbuffer[Xe]&&n.deleteRenderbuffer(fe.__webglColorRenderbuffer[Xe]);fe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(fe.__webglDepthRenderbuffer)}if(ne.isWebGLMultipleRenderTargets)for(let Xe=0,st=Z.length;Xe<st;Xe++){const mt=r.get(Z[Xe]);mt.__webglTexture&&(n.deleteTexture(mt.__webglTexture),s.memory.textures--),r.remove(Z[Xe])}r.remove(Z),r.remove(ne)}let B=0;function H(){B=0}function j(){const ne=B;return ne>=l&&console.warn("THREE.WebGLTextures: Trying to use "+ne+" texture units while this GPU supports only "+l),B+=1,ne}function K(ne){const Z=[];return Z.push(ne.wrapS),Z.push(ne.wrapT),Z.push(ne.wrapR||0),Z.push(ne.magFilter),Z.push(ne.minFilter),Z.push(ne.anisotropy),Z.push(ne.internalFormat),Z.push(ne.format),Z.push(ne.type),Z.push(ne.generateMipmaps),Z.push(ne.premultiplyAlpha),Z.push(ne.flipY),Z.push(ne.unpackAlignment),Z.push(ne.encoding),Z.join()}function J(ne,Z){const fe=r.get(ne);if(ne.isVideoTexture&&ve(ne),ne.isRenderTargetTexture===!1&&ne.version>0&&fe.__version!==ne.version){const Be=ne.image;if(Be===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Be.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Se(fe,ne,Z);return}}t.bindTexture(3553,fe.__webglTexture,33984+Z)}function re(ne,Z){const fe=r.get(ne);if(ne.version>0&&fe.__version!==ne.version){Se(fe,ne,Z);return}t.bindTexture(35866,fe.__webglTexture,33984+Z)}function se(ne,Z){const fe=r.get(ne);if(ne.version>0&&fe.__version!==ne.version){Se(fe,ne,Z);return}t.bindTexture(32879,fe.__webglTexture,33984+Z)}function Ae(ne,Z){const fe=r.get(ne);if(ne.version>0&&fe.__version!==ne.version){Me(fe,ne,Z);return}t.bindTexture(34067,fe.__webglTexture,33984+Z)}const Ee={[tg]:10497,[Js]:33071,[bw]:33648},Ne={[Ni]:9728,[SM]:9984,[B1]:9986,[Ya]:9729,[Wj]:9985,[dd]:9987};function we(ne,Z,fe){if(fe?(n.texParameteri(ne,10242,Ee[Z.wrapS]),n.texParameteri(ne,10243,Ee[Z.wrapT]),(ne===32879||ne===35866)&&n.texParameteri(ne,32882,Ee[Z.wrapR]),n.texParameteri(ne,10240,Ne[Z.magFilter]),n.texParameteri(ne,10241,Ne[Z.minFilter])):(n.texParameteri(ne,10242,33071),n.texParameteri(ne,10243,33071),(ne===32879||ne===35866)&&n.texParameteri(ne,32882,33071),(Z.wrapS!==Js||Z.wrapT!==Js)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(ne,10240,R(Z.magFilter)),n.texParameteri(ne,10241,R(Z.minFilter)),Z.minFilter!==Ni&&Z.minFilter!==Ya&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Be=e.get("EXT_texture_filter_anisotropic");if(Z.magFilter===Ni||Z.minFilter!==B1&&Z.minFilter!==dd||Z.type===Iu&&e.has("OES_texture_float_linear")===!1||o===!1&&Z.type===A0&&e.has("OES_texture_half_float_linear")===!1)return;(Z.anisotropy>1||r.get(Z).__currentAnisotropy)&&(n.texParameterf(ne,Be.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Z.anisotropy,i.getMaxAnisotropy())),r.get(Z).__currentAnisotropy=Z.anisotropy)}}function me(ne,Z){let fe=!1;ne.__webglInit===void 0&&(ne.__webglInit=!0,Z.addEventListener("dispose",P));const Be=Z.source;let Xe=g.get(Be);Xe===void 0&&(Xe={},g.set(Be,Xe));const st=K(Z);if(st!==ne.__cacheKey){Xe[st]===void 0&&(Xe[st]={texture:n.createTexture(),usedTimes:0},s.memory.textures++,fe=!0),Xe[st].usedTimes++;const mt=Xe[ne.__cacheKey];mt!==void 0&&(Xe[ne.__cacheKey].usedTimes--,mt.usedTimes===0&&F(Z)),ne.__cacheKey=st,ne.__webglTexture=Xe[st].texture}return fe}function Se(ne,Z,fe){let Be=3553;(Z.isDataArrayTexture||Z.isCompressedArrayTexture)&&(Be=35866),Z.isData3DTexture&&(Be=32879);const Xe=me(ne,Z),st=Z.source;t.bindTexture(Be,ne.__webglTexture,33984+fe);const mt=r.get(st);if(st.version!==mt.__version||Xe===!0){t.activeTexture(33984+fe),n.pixelStorei(37440,Z.flipY),n.pixelStorei(37441,Z.premultiplyAlpha),n.pixelStorei(3317,Z.unpackAlignment),n.pixelStorei(37443,0);const ye=S(Z)&&b(Z.image)===!1;let $e=x(Z.image,ye,!1,c);$e=Ke(Z,$e);const vt=b($e)||o,bt=a.convert(Z.format,Z.encoding);let dt=a.convert(Z.type),$t=C(Z.internalFormat,bt,dt,Z.encoding,Z.isVideoTexture);we(Be,Z,vt);let Ct;const Kt=Z.mipmaps,Vt=o&&Z.isVideoTexture!==!0,Ft=mt.__version===void 0||Xe===!0,Pe=k(Z,$e,vt);if(Z.isDepthTexture)$t=6402,o?Z.type===Iu?$t=36012:Z.type===Bh?$t=33190:Z.type===Mm?$t=35056:$t=33189:Z.type===Iu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Z.format===Zh&&$t===6402&&Z.type!==Gj&&Z.type!==Bh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Z.type=Bh,dt=a.convert(Z.type)),Z.format===ng&&$t===6402&&($t=34041,Z.type!==Mm&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Z.type=Mm,dt=a.convert(Z.type))),Ft&&(Vt?t.texStorage2D(3553,1,$t,$e.width,$e.height):t.texImage2D(3553,0,$t,$e.width,$e.height,0,bt,dt,null));else if(Z.isDataTexture)if(Kt.length>0&&vt){Vt&&Ft&&t.texStorage2D(3553,Pe,$t,Kt[0].width,Kt[0].height);for(let Je=0,ot=Kt.length;Je<ot;Je++)Ct=Kt[Je],Vt?t.texSubImage2D(3553,Je,0,0,Ct.width,Ct.height,bt,dt,Ct.data):t.texImage2D(3553,Je,$t,Ct.width,Ct.height,0,bt,dt,Ct.data);Z.generateMipmaps=!1}else Vt?(Ft&&t.texStorage2D(3553,Pe,$t,$e.width,$e.height),t.texSubImage2D(3553,0,0,0,$e.width,$e.height,bt,dt,$e.data)):t.texImage2D(3553,0,$t,$e.width,$e.height,0,bt,dt,$e.data);else if(Z.isCompressedTexture)if(Z.isCompressedArrayTexture){Vt&&Ft&&t.texStorage3D(35866,Pe,$t,Kt[0].width,Kt[0].height,$e.depth);for(let Je=0,ot=Kt.length;Je<ot;Je++)Ct=Kt[Je],Z.format!==eo?bt!==null?Vt?t.compressedTexSubImage3D(35866,Je,0,0,0,Ct.width,Ct.height,$e.depth,bt,Ct.data,0,0):t.compressedTexImage3D(35866,Je,$t,Ct.width,Ct.height,$e.depth,0,Ct.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Vt?t.texSubImage3D(35866,Je,0,0,0,Ct.width,Ct.height,$e.depth,bt,dt,Ct.data):t.texImage3D(35866,Je,$t,Ct.width,Ct.height,$e.depth,0,bt,dt,Ct.data)}else{Vt&&Ft&&t.texStorage2D(3553,Pe,$t,Kt[0].width,Kt[0].height);for(let Je=0,ot=Kt.length;Je<ot;Je++)Ct=Kt[Je],Z.format!==eo?bt!==null?Vt?t.compressedTexSubImage2D(3553,Je,0,0,Ct.width,Ct.height,bt,Ct.data):t.compressedTexImage2D(3553,Je,$t,Ct.width,Ct.height,0,Ct.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Vt?t.texSubImage2D(3553,Je,0,0,Ct.width,Ct.height,bt,dt,Ct.data):t.texImage2D(3553,Je,$t,Ct.width,Ct.height,0,bt,dt,Ct.data)}else if(Z.isDataArrayTexture)Vt?(Ft&&t.texStorage3D(35866,Pe,$t,$e.width,$e.height,$e.depth),t.texSubImage3D(35866,0,0,0,0,$e.width,$e.height,$e.depth,bt,dt,$e.data)):t.texImage3D(35866,0,$t,$e.width,$e.height,$e.depth,0,bt,dt,$e.data);else if(Z.isData3DTexture)Vt?(Ft&&t.texStorage3D(32879,Pe,$t,$e.width,$e.height,$e.depth),t.texSubImage3D(32879,0,0,0,0,$e.width,$e.height,$e.depth,bt,dt,$e.data)):t.texImage3D(32879,0,$t,$e.width,$e.height,$e.depth,0,bt,dt,$e.data);else if(Z.isFramebufferTexture){if(Ft)if(Vt)t.texStorage2D(3553,Pe,$t,$e.width,$e.height);else{let Je=$e.width,ot=$e.height;for(let wt=0;wt<Pe;wt++)t.texImage2D(3553,wt,$t,Je,ot,0,bt,dt,null),Je>>=1,ot>>=1}}else if(Kt.length>0&&vt){Vt&&Ft&&t.texStorage2D(3553,Pe,$t,Kt[0].width,Kt[0].height);for(let Je=0,ot=Kt.length;Je<ot;Je++)Ct=Kt[Je],Vt?t.texSubImage2D(3553,Je,0,0,bt,dt,Ct):t.texImage2D(3553,Je,$t,bt,dt,Ct);Z.generateMipmaps=!1}else Vt?(Ft&&t.texStorage2D(3553,Pe,$t,$e.width,$e.height),t.texSubImage2D(3553,0,0,0,bt,dt,$e)):t.texImage2D(3553,0,$t,bt,dt,$e);T(Z,vt)&&M(Be),mt.__version=st.version,Z.onUpdate&&Z.onUpdate(Z)}ne.__version=Z.version}function Me(ne,Z,fe){if(Z.image.length!==6)return;const Be=me(ne,Z),Xe=Z.source;t.bindTexture(34067,ne.__webglTexture,33984+fe);const st=r.get(Xe);if(Xe.version!==st.__version||Be===!0){t.activeTexture(33984+fe),n.pixelStorei(37440,Z.flipY),n.pixelStorei(37441,Z.premultiplyAlpha),n.pixelStorei(3317,Z.unpackAlignment),n.pixelStorei(37443,0);const mt=Z.isCompressedTexture||Z.image[0].isCompressedTexture,ye=Z.image[0]&&Z.image[0].isDataTexture,$e=[];for(let Je=0;Je<6;Je++)!mt&&!ye?$e[Je]=x(Z.image[Je],!1,!0,u):$e[Je]=ye?Z.image[Je].image:Z.image[Je],$e[Je]=Ke(Z,$e[Je]);const vt=$e[0],bt=b(vt)||o,dt=a.convert(Z.format,Z.encoding),$t=a.convert(Z.type),Ct=C(Z.internalFormat,dt,$t,Z.encoding),Kt=o&&Z.isVideoTexture!==!0,Vt=st.__version===void 0||Be===!0;let Ft=k(Z,vt,bt);we(34067,Z,bt);let Pe;if(mt){Kt&&Vt&&t.texStorage2D(34067,Ft,Ct,vt.width,vt.height);for(let Je=0;Je<6;Je++){Pe=$e[Je].mipmaps;for(let ot=0;ot<Pe.length;ot++){const wt=Pe[ot];Z.format!==eo?dt!==null?Kt?t.compressedTexSubImage2D(34069+Je,ot,0,0,wt.width,wt.height,dt,wt.data):t.compressedTexImage2D(34069+Je,ot,Ct,wt.width,wt.height,0,wt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Kt?t.texSubImage2D(34069+Je,ot,0,0,wt.width,wt.height,dt,$t,wt.data):t.texImage2D(34069+Je,ot,Ct,wt.width,wt.height,0,dt,$t,wt.data)}}}else{Pe=Z.mipmaps,Kt&&Vt&&(Pe.length>0&&Ft++,t.texStorage2D(34067,Ft,Ct,$e[0].width,$e[0].height));for(let Je=0;Je<6;Je++)if(ye){Kt?t.texSubImage2D(34069+Je,0,0,0,$e[Je].width,$e[Je].height,dt,$t,$e[Je].data):t.texImage2D(34069+Je,0,Ct,$e[Je].width,$e[Je].height,0,dt,$t,$e[Je].data);for(let ot=0;ot<Pe.length;ot++){const Bt=Pe[ot].image[Je].image;Kt?t.texSubImage2D(34069+Je,ot+1,0,0,Bt.width,Bt.height,dt,$t,Bt.data):t.texImage2D(34069+Je,ot+1,Ct,Bt.width,Bt.height,0,dt,$t,Bt.data)}}else{Kt?t.texSubImage2D(34069+Je,0,0,0,dt,$t,$e[Je]):t.texImage2D(34069+Je,0,Ct,dt,$t,$e[Je]);for(let ot=0;ot<Pe.length;ot++){const wt=Pe[ot];Kt?t.texSubImage2D(34069+Je,ot+1,0,0,dt,$t,wt.image[Je]):t.texImage2D(34069+Je,ot+1,Ct,dt,$t,wt.image[Je])}}}T(Z,bt)&&M(34067),st.__version=Xe.version,Z.onUpdate&&Z.onUpdate(Z)}ne.__version=Z.version}function ke(ne,Z,fe,Be,Xe){const st=a.convert(fe.format,fe.encoding),mt=a.convert(fe.type),ye=C(fe.internalFormat,st,mt,fe.encoding);r.get(Z).__hasExternalTextures||(Xe===32879||Xe===35866?t.texImage3D(Xe,0,ye,Z.width,Z.height,Z.depth,0,st,mt,null):t.texImage2D(Xe,0,ye,Z.width,Z.height,0,st,mt,null)),t.bindFramebuffer(36160,ne),Qe(Z)?h.framebufferTexture2DMultisampleEXT(36160,Be,Xe,r.get(fe).__webglTexture,0,ut(Z)):(Xe===3553||Xe>=34069&&Xe<=34074)&&n.framebufferTexture2D(36160,Be,Xe,r.get(fe).__webglTexture,0),t.bindFramebuffer(36160,null)}function He(ne,Z,fe){if(n.bindRenderbuffer(36161,ne),Z.depthBuffer&&!Z.stencilBuffer){let Be=33189;if(fe||Qe(Z)){const Xe=Z.depthTexture;Xe&&Xe.isDepthTexture&&(Xe.type===Iu?Be=36012:Xe.type===Bh&&(Be=33190));const st=ut(Z);Qe(Z)?h.renderbufferStorageMultisampleEXT(36161,st,Be,Z.width,Z.height):n.renderbufferStorageMultisample(36161,st,Be,Z.width,Z.height)}else n.renderbufferStorage(36161,Be,Z.width,Z.height);n.framebufferRenderbuffer(36160,36096,36161,ne)}else if(Z.depthBuffer&&Z.stencilBuffer){const Be=ut(Z);fe&&Qe(Z)===!1?n.renderbufferStorageMultisample(36161,Be,35056,Z.width,Z.height):Qe(Z)?h.renderbufferStorageMultisampleEXT(36161,Be,35056,Z.width,Z.height):n.renderbufferStorage(36161,34041,Z.width,Z.height),n.framebufferRenderbuffer(36160,33306,36161,ne)}else{const Be=Z.isWebGLMultipleRenderTargets===!0?Z.texture:[Z.texture];for(let Xe=0;Xe<Be.length;Xe++){const st=Be[Xe],mt=a.convert(st.format,st.encoding),ye=a.convert(st.type),$e=C(st.internalFormat,mt,ye,st.encoding),vt=ut(Z);fe&&Qe(Z)===!1?n.renderbufferStorageMultisample(36161,vt,$e,Z.width,Z.height):Qe(Z)?h.renderbufferStorageMultisampleEXT(36161,vt,$e,Z.width,Z.height):n.renderbufferStorage(36161,$e,Z.width,Z.height)}}n.bindRenderbuffer(36161,null)}function ee(ne,Z){if(Z&&Z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,ne),!(Z.depthTexture&&Z.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(Z.depthTexture).__webglTexture||Z.depthTexture.image.width!==Z.width||Z.depthTexture.image.height!==Z.height)&&(Z.depthTexture.image.width=Z.width,Z.depthTexture.image.height=Z.height,Z.depthTexture.needsUpdate=!0),J(Z.depthTexture,0);const Be=r.get(Z.depthTexture).__webglTexture,Xe=ut(Z);if(Z.depthTexture.format===Zh)Qe(Z)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,Be,0,Xe):n.framebufferTexture2D(36160,36096,3553,Be,0);else if(Z.depthTexture.format===ng)Qe(Z)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,Be,0,Xe):n.framebufferTexture2D(36160,33306,3553,Be,0);else throw new Error("Unknown depthTexture format")}function ie(ne){const Z=r.get(ne),fe=ne.isWebGLCubeRenderTarget===!0;if(ne.depthTexture&&!Z.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");ee(Z.__webglFramebuffer,ne)}else if(fe){Z.__webglDepthbuffer=[];for(let Be=0;Be<6;Be++)t.bindFramebuffer(36160,Z.__webglFramebuffer[Be]),Z.__webglDepthbuffer[Be]=n.createRenderbuffer(),He(Z.__webglDepthbuffer[Be],ne,!1)}else t.bindFramebuffer(36160,Z.__webglFramebuffer),Z.__webglDepthbuffer=n.createRenderbuffer(),He(Z.__webglDepthbuffer,ne,!1);t.bindFramebuffer(36160,null)}function xe(ne,Z,fe){const Be=r.get(ne);Z!==void 0&&ke(Be.__webglFramebuffer,ne,ne.texture,36064,3553),fe!==void 0&&ie(ne)}function Ve(ne){const Z=ne.texture,fe=r.get(ne),Be=r.get(Z);ne.addEventListener("dispose",N),ne.isWebGLMultipleRenderTargets!==!0&&(Be.__webglTexture===void 0&&(Be.__webglTexture=n.createTexture()),Be.__version=Z.version,s.memory.textures++);const Xe=ne.isWebGLCubeRenderTarget===!0,st=ne.isWebGLMultipleRenderTargets===!0,mt=b(ne)||o;if(Xe){fe.__webglFramebuffer=[];for(let ye=0;ye<6;ye++)fe.__webglFramebuffer[ye]=n.createFramebuffer()}else{if(fe.__webglFramebuffer=n.createFramebuffer(),st)if(i.drawBuffers){const ye=ne.texture;for(let $e=0,vt=ye.length;$e<vt;$e++){const bt=r.get(ye[$e]);bt.__webglTexture===void 0&&(bt.__webglTexture=n.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&ne.samples>0&&Qe(ne)===!1){const ye=st?Z:[Z];fe.__webglMultisampledFramebuffer=n.createFramebuffer(),fe.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,fe.__webglMultisampledFramebuffer);for(let $e=0;$e<ye.length;$e++){const vt=ye[$e];fe.__webglColorRenderbuffer[$e]=n.createRenderbuffer(),n.bindRenderbuffer(36161,fe.__webglColorRenderbuffer[$e]);const bt=a.convert(vt.format,vt.encoding),dt=a.convert(vt.type),$t=C(vt.internalFormat,bt,dt,vt.encoding,ne.isXRRenderTarget===!0),Ct=ut(ne);n.renderbufferStorageMultisample(36161,Ct,$t,ne.width,ne.height),n.framebufferRenderbuffer(36160,36064+$e,36161,fe.__webglColorRenderbuffer[$e])}n.bindRenderbuffer(36161,null),ne.depthBuffer&&(fe.__webglDepthRenderbuffer=n.createRenderbuffer(),He(fe.__webglDepthRenderbuffer,ne,!0)),t.bindFramebuffer(36160,null)}}if(Xe){t.bindTexture(34067,Be.__webglTexture),we(34067,Z,mt);for(let ye=0;ye<6;ye++)ke(fe.__webglFramebuffer[ye],ne,Z,36064,34069+ye);T(Z,mt)&&M(34067),t.unbindTexture()}else if(st){const ye=ne.texture;for(let $e=0,vt=ye.length;$e<vt;$e++){const bt=ye[$e],dt=r.get(bt);t.bindTexture(3553,dt.__webglTexture),we(3553,bt,mt),ke(fe.__webglFramebuffer,ne,bt,36064+$e,3553),T(bt,mt)&&M(3553)}t.unbindTexture()}else{let ye=3553;(ne.isWebGL3DRenderTarget||ne.isWebGLArrayRenderTarget)&&(o?ye=ne.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(ye,Be.__webglTexture),we(ye,Z,mt),ke(fe.__webglFramebuffer,ne,Z,36064,ye),T(Z,mt)&&M(ye),t.unbindTexture()}ne.depthBuffer&&ie(ne)}function Ge(ne){const Z=b(ne)||o,fe=ne.isWebGLMultipleRenderTargets===!0?ne.texture:[ne.texture];for(let Be=0,Xe=fe.length;Be<Xe;Be++){const st=fe[Be];if(T(st,Z)){const mt=ne.isWebGLCubeRenderTarget?34067:3553,ye=r.get(st).__webglTexture;t.bindTexture(mt,ye),M(mt),t.unbindTexture()}}}function Ze(ne){if(o&&ne.samples>0&&Qe(ne)===!1){const Z=ne.isWebGLMultipleRenderTargets?ne.texture:[ne.texture],fe=ne.width,Be=ne.height;let Xe=16384;const st=[],mt=ne.stencilBuffer?33306:36096,ye=r.get(ne),$e=ne.isWebGLMultipleRenderTargets===!0;if($e)for(let vt=0;vt<Z.length;vt++)t.bindFramebuffer(36160,ye.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+vt,36161,null),t.bindFramebuffer(36160,ye.__webglFramebuffer),n.framebufferTexture2D(36009,36064+vt,3553,null,0);t.bindFramebuffer(36008,ye.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ye.__webglFramebuffer);for(let vt=0;vt<Z.length;vt++){st.push(36064+vt),ne.depthBuffer&&st.push(mt);const bt=ye.__ignoreDepthValues!==void 0?ye.__ignoreDepthValues:!1;if(bt===!1&&(ne.depthBuffer&&(Xe|=256),ne.stencilBuffer&&(Xe|=1024)),$e&&n.framebufferRenderbuffer(36008,36064,36161,ye.__webglColorRenderbuffer[vt]),bt===!0&&(n.invalidateFramebuffer(36008,[mt]),n.invalidateFramebuffer(36009,[mt])),$e){const dt=r.get(Z[vt]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,dt,0)}n.blitFramebuffer(0,0,fe,Be,0,0,fe,Be,Xe,9728),d&&n.invalidateFramebuffer(36008,st)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),$e)for(let vt=0;vt<Z.length;vt++){t.bindFramebuffer(36160,ye.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+vt,36161,ye.__webglColorRenderbuffer[vt]);const bt=r.get(Z[vt]).__webglTexture;t.bindFramebuffer(36160,ye.__webglFramebuffer),n.framebufferTexture2D(36009,36064+vt,3553,bt,0)}t.bindFramebuffer(36009,ye.__webglMultisampledFramebuffer)}}function ut(ne){return Math.min(f,ne.samples)}function Qe(ne){const Z=r.get(ne);return o&&ne.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Z.__useRenderToTexture!==!1}function ve(ne){const Z=s.render.frame;p.get(ne)!==Z&&(p.set(ne,Z),ne.update())}function Ke(ne,Z){const fe=ne.encoding,Be=ne.format,Xe=ne.type;return ne.isCompressedTexture===!0||ne.isVideoTexture===!0||ne.format===CM||fe!==md&&(fe===fr?o===!1?e.has("EXT_sRGB")===!0&&Be===eo?(ne.format=CM,ne.minFilter=Ya,ne.generateMipmaps=!1):Z=Qj.sRGBToLinear(Z):(Be!==eo||Xe!==pd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",fe)),Z}this.allocateTextureUnit=j,this.resetTextureUnits=H,this.setTexture2D=J,this.setTexture2DArray=re,this.setTexture3D=se,this.setTextureCube=Ae,this.rebindTextures=xe,this.setupRenderTarget=Ve,this.updateRenderTargetMipmap=Ge,this.updateMultisampleRenderTarget=Ze,this.setupDepthRenderbuffer=ie,this.setupFrameBufferTexture=ke,this.useMultisampledRTT=Qe}function PTe(n,e,t){const r=t.isWebGL2;function i(a,s=null){let o;if(a===pd)return 5121;if(a===dxe)return 32819;if(a===pxe)return 32820;if(a===cxe)return 5120;if(a===fxe)return 5122;if(a===Gj)return 5123;if(a===hxe)return 5124;if(a===Bh)return 5125;if(a===Iu)return 5126;if(a===A0)return r?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(a===mxe)return 6406;if(a===eo)return 6408;if(a===jj)return 6409;if(a===vxe)return 6410;if(a===Zh)return 6402;if(a===ng)return 34041;if(a===gxe)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(a===CM)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(a===qj)return 6403;if(a===yxe)return 36244;if(a===_xe)return 33319;if(a===xxe)return 33320;if(a===bxe)return 36249;if(a===i2||a===a2||a===s2||a===o2)if(s===fr)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(a===i2)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===a2)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===s2)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===o2)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(a===i2)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===a2)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===s2)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===o2)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===KB||a===YB||a===ZB||a===QB)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(a===KB)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===YB)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===ZB)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===QB)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===wxe)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===JB||a===e4)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(a===JB)return s===fr?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(a===e4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===t4||a===n4||a===r4||a===i4||a===a4||a===s4||a===o4||a===l4||a===u4||a===c4||a===f4||a===h4||a===d4||a===p4)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(a===t4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===n4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===r4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===i4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===a4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===s4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===o4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===l4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===u4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===c4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===f4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===h4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===d4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===p4)return s===fr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===m4)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(a===m4)return s===fr?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return a===Mm?r?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):n[a]!==void 0?n[a]:null}return{convert:i}}class ITe extends Za{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let Uh=class extends Hr{constructor(){super(),this.isGroup=!0,this.type="Group"}};const DTe={type:"move"};class L2{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Uh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Uh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new De,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new De),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Uh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new De,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new De),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,a=null,s=null;const o=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){s=!0;for(const m of e.hand.values()){const g=t.getJointPose(m,r),v=this._getHandJoint(u,m);g!==null&&(v.matrix.fromArray(g.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.jointRadius=g.radius),v.visible=g!==null}const c=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],h=c.position.distanceTo(f.position),d=.02,p=.005;u.inputState.pinching&&h>d+p?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=d-p&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,r),a!==null&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&a!==null&&(i=a),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(DTe)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=a!==null),u!==null&&(u.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new Uh;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class LTe extends Ki{constructor(e,t,r,i,a,s,o,l,u,c){if(c=c!==void 0?c:Zh,c!==Zh&&c!==ng)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Zh&&(r=Bh),r===void 0&&c===ng&&(r=Mm),super(null,i,a,s,o,l,c,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:Ni,this.minFilter=l!==void 0?l:Ni,this.flipY=!1,this.generateMipmaps=!1}}class NTe extends Fd{constructor(e,t){super();const r=this;let i=null,a=1,s=null,o="local-floor",l=null,u=null,c=null,f=null,h=null,d=null;const p=t.getContextAttributes();let m=null,g=null;const v=[],_=[],x=new Set,b=new Map,S=new Za;S.layers.enable(1),S.viewport=new Nr;const T=new Za;T.layers.enable(2),T.viewport=new Nr;const M=[S,T],C=new ITe;C.layers.enable(1),C.layers.enable(2);let k=null,R=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(re){let se=v[re];return se===void 0&&(se=new L2,v[re]=se),se.getTargetRaySpace()},this.getControllerGrip=function(re){let se=v[re];return se===void 0&&(se=new L2,v[re]=se),se.getGripSpace()},this.getHand=function(re){let se=v[re];return se===void 0&&(se=new L2,v[re]=se),se.getHandSpace()};function P(re){const se=_.indexOf(re.inputSource);if(se===-1)return;const Ae=v[se];Ae!==void 0&&Ae.dispatchEvent({type:re.type,data:re.inputSource})}function N(){i.removeEventListener("select",P),i.removeEventListener("selectstart",P),i.removeEventListener("selectend",P),i.removeEventListener("squeeze",P),i.removeEventListener("squeezestart",P),i.removeEventListener("squeezeend",P),i.removeEventListener("end",N),i.removeEventListener("inputsourceschange",L);for(let re=0;re<v.length;re++){const se=_[re];se!==null&&(_[re]=null,v[re].disconnect(se))}k=null,R=null,e.setRenderTarget(m),h=null,f=null,c=null,i=null,g=null,J.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(re){a=re,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(re){o=re,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(re){l=re},this.getBaseLayer=function(){return f!==null?f:h},this.getBinding=function(){return c},this.getFrame=function(){return d},this.getSession=function(){return i},this.setSession=async function(re){if(i=re,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",P),i.addEventListener("selectstart",P),i.addEventListener("selectend",P),i.addEventListener("squeeze",P),i.addEventListener("squeezestart",P),i.addEventListener("squeezeend",P),i.addEventListener("end",N),i.addEventListener("inputsourceschange",L),p.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const se={antialias:i.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:a};h=new XRWebGLLayer(i,t,se),i.updateRenderState({baseLayer:h}),g=new ff(h.framebufferWidth,h.framebufferHeight,{format:eo,type:pd,encoding:e.outputEncoding,stencilBuffer:p.stencil})}else{let se=null,Ae=null,Ee=null;p.depth&&(Ee=p.stencil?35056:33190,se=p.stencil?ng:Zh,Ae=p.stencil?Mm:Bh);const Ne={colorFormat:32856,depthFormat:Ee,scaleFactor:a};c=new XRWebGLBinding(i,t),f=c.createProjectionLayer(Ne),i.updateRenderState({layers:[f]}),g=new ff(f.textureWidth,f.textureHeight,{format:eo,type:pd,depthTexture:new LTe(f.textureWidth,f.textureHeight,Ae,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0});const we=e.properties.get(g);we.__ignoreDepthValues=f.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,s=await i.requestReferenceSpace(o),J.setContext(i),J.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function L(re){for(let se=0;se<re.removed.length;se++){const Ae=re.removed[se],Ee=_.indexOf(Ae);Ee>=0&&(_[Ee]=null,v[Ee].disconnect(Ae))}for(let se=0;se<re.added.length;se++){const Ae=re.added[se];let Ee=_.indexOf(Ae);if(Ee===-1){for(let we=0;we<v.length;we++)if(we>=_.length){_.push(Ae),Ee=we;break}else if(_[we]===null){_[we]=Ae,Ee=we;break}if(Ee===-1)break}const Ne=v[Ee];Ne&&Ne.connect(Ae)}}const F=new De,O=new De;function B(re,se,Ae){F.setFromMatrixPosition(se.matrixWorld),O.setFromMatrixPosition(Ae.matrixWorld);const Ee=F.distanceTo(O),Ne=se.projectionMatrix.elements,we=Ae.projectionMatrix.elements,me=Ne[14]/(Ne[10]-1),Se=Ne[14]/(Ne[10]+1),Me=(Ne[9]+1)/Ne[5],ke=(Ne[9]-1)/Ne[5],He=(Ne[8]-1)/Ne[0],ee=(we[8]+1)/we[0],ie=me*He,xe=me*ee,Ve=Ee/(-He+ee),Ge=Ve*-He;se.matrixWorld.decompose(re.position,re.quaternion,re.scale),re.translateX(Ge),re.translateZ(Ve),re.matrixWorld.compose(re.position,re.quaternion,re.scale),re.matrixWorldInverse.copy(re.matrixWorld).invert();const Ze=me+Ve,ut=Se+Ve,Qe=ie-Ge,ve=xe+(Ee-Ge),Ke=Me*Se/ut*Ze,ne=ke*Se/ut*Ze;re.projectionMatrix.makePerspective(Qe,ve,Ke,ne,Ze,ut)}function H(re,se){se===null?re.matrixWorld.copy(re.matrix):re.matrixWorld.multiplyMatrices(se.matrixWorld,re.matrix),re.matrixWorldInverse.copy(re.matrixWorld).invert()}this.updateCamera=function(re){if(i===null)return;C.near=T.near=S.near=re.near,C.far=T.far=S.far=re.far,(k!==C.near||R!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),k=C.near,R=C.far);const se=re.parent,Ae=C.cameras;H(C,se);for(let Ne=0;Ne<Ae.length;Ne++)H(Ae[Ne],se);C.matrixWorld.decompose(C.position,C.quaternion,C.scale),re.matrix.copy(C.matrix),re.matrix.decompose(re.position,re.quaternion,re.scale);const Ee=re.children;for(let Ne=0,we=Ee.length;Ne<we;Ne++)Ee[Ne].updateMatrixWorld(!0);Ae.length===2?B(C,S,T):C.projectionMatrix.copy(S.projectionMatrix)},this.getCamera=function(){return C},this.getFoveation=function(){if(f!==null)return f.fixedFoveation;if(h!==null)return h.fixedFoveation},this.setFoveation=function(re){f!==null&&(f.fixedFoveation=re),h!==null&&h.fixedFoveation!==void 0&&(h.fixedFoveation=re)},this.getPlanes=function(){return x};let j=null;function K(re,se){if(u=se.getViewerPose(l||s),d=se,u!==null){const Ae=u.views;h!==null&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let Ee=!1;Ae.length!==C.cameras.length&&(C.cameras.length=0,Ee=!0);for(let Ne=0;Ne<Ae.length;Ne++){const we=Ae[Ne];let me=null;if(h!==null)me=h.getViewport(we);else{const Me=c.getViewSubImage(f,we);me=Me.viewport,Ne===0&&(e.setRenderTargetTextures(g,Me.colorTexture,f.ignoreDepthValues?void 0:Me.depthStencilTexture),e.setRenderTarget(g))}let Se=M[Ne];Se===void 0&&(Se=new Za,Se.layers.enable(Ne),Se.viewport=new Nr,M[Ne]=Se),Se.matrix.fromArray(we.transform.matrix),Se.projectionMatrix.fromArray(we.projectionMatrix),Se.viewport.set(me.x,me.y,me.width,me.height),Ne===0&&C.matrix.copy(Se.matrix),Ee===!0&&C.cameras.push(Se)}}for(let Ae=0;Ae<v.length;Ae++){const Ee=_[Ae],Ne=v[Ae];Ee!==null&&Ne!==void 0&&Ne.update(Ee,se,l||s)}if(j&&j(re,se),se.detectedPlanes){r.dispatchEvent({type:"planesdetected",data:se.detectedPlanes});let Ae=null;for(const Ee of x)se.detectedPlanes.has(Ee)||(Ae===null&&(Ae=[]),Ae.push(Ee));if(Ae!==null)for(const Ee of Ae)x.delete(Ee),b.delete(Ee),r.dispatchEvent({type:"planeremoved",data:Ee});for(const Ee of se.detectedPlanes)if(!x.has(Ee))x.add(Ee),b.set(Ee,se.lastChangedTime),r.dispatchEvent({type:"planeadded",data:Ee});else{const Ne=b.get(Ee);Ee.lastChangedTime>Ne&&(b.set(Ee,Ee.lastChangedTime),r.dispatchEvent({type:"planechanged",data:Ee}))}}d=null}const J=new a7;J.setAnimationLoop(K),this.setAnimationLoop=function(re){j=re},this.dispose=function(){}}}function OTe(n,e){function t(m,g){g.color.getRGB(m.fogColor.value,r7(n)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function r(m,g,v,_,x){g.isMeshBasicMaterial||g.isMeshLambertMaterial?i(m,g):g.isMeshToonMaterial?(i(m,g),c(m,g)):g.isMeshPhongMaterial?(i(m,g),u(m,g)):g.isMeshStandardMaterial?(i(m,g),f(m,g),g.isMeshPhysicalMaterial&&h(m,g,x)):g.isMeshMatcapMaterial?(i(m,g),d(m,g)):g.isMeshDepthMaterial?i(m,g):g.isMeshDistanceMaterial?(i(m,g),p(m,g)):g.isMeshNormalMaterial?i(m,g):g.isLineBasicMaterial?(a(m,g),g.isLineDashedMaterial&&s(m,g)):g.isPointsMaterial?o(m,g,v,_):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function i(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===po&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===po&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const v=e.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const b=n.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*b}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let _;g.map?_=g.map:g.specularMap?_=g.specularMap:g.displacementMap?_=g.displacementMap:g.normalMap?_=g.normalMap:g.bumpMap?_=g.bumpMap:g.roughnessMap?_=g.roughnessMap:g.metalnessMap?_=g.metalnessMap:g.alphaMap?_=g.alphaMap:g.emissiveMap?_=g.emissiveMap:g.clearcoatMap?_=g.clearcoatMap:g.clearcoatNormalMap?_=g.clearcoatNormalMap:g.clearcoatRoughnessMap?_=g.clearcoatRoughnessMap:g.iridescenceMap?_=g.iridescenceMap:g.iridescenceThicknessMap?_=g.iridescenceThicknessMap:g.specularIntensityMap?_=g.specularIntensityMap:g.specularColorMap?_=g.specularColorMap:g.transmissionMap?_=g.transmissionMap:g.thicknessMap?_=g.thicknessMap:g.sheenColorMap?_=g.sheenColorMap:g.sheenRoughnessMap&&(_=g.sheenRoughnessMap),_!==void 0&&(_.isWebGLRenderTarget&&(_=_.texture),_.matrixAutoUpdate===!0&&_.updateMatrix(),m.uvTransform.value.copy(_.matrix));let x;g.aoMap?x=g.aoMap:g.lightMap&&(x=g.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uv2Transform.value.copy(x.matrix))}function a(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function s(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function o(m,g,v,_){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=_*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let x;g.map?x=g.map:g.alphaMap&&(x=g.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function u(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function c(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function f(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function h(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===po&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function d(m,g){g.matcap&&(m.matcap.value=g.matcap)}function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:r}}function $Te(n,e,t,r){let i={},a={},s=[];const o=t.isWebGL2?n.getParameter(35375):0;function l(_,x){const b=x.program;r.uniformBlockBinding(_,b)}function u(_,x){let b=i[_.id];b===void 0&&(p(_),b=c(_),i[_.id]=b,_.addEventListener("dispose",g));const S=x.program;r.updateUBOMapping(_,S);const T=e.render.frame;a[_.id]!==T&&(h(_),a[_.id]=T)}function c(_){const x=f();_.__bindingPointIndex=x;const b=n.createBuffer(),S=_.__size,T=_.usage;return n.bindBuffer(35345,b),n.bufferData(35345,S,T),n.bindBuffer(35345,null),n.bindBufferBase(35345,x,b),b}function f(){for(let _=0;_<o;_++)if(s.indexOf(_)===-1)return s.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(_){const x=i[_.id],b=_.uniforms,S=_.__cache;n.bindBuffer(35345,x);for(let T=0,M=b.length;T<M;T++){const C=b[T];if(d(C,T,S)===!0){const k=C.__offset,R=Array.isArray(C.value)?C.value:[C.value];let P=0;for(let N=0;N<R.length;N++){const L=R[N],F=m(L);typeof L=="number"?(C.__data[0]=L,n.bufferSubData(35345,k+P,C.__data)):L.isMatrix3?(C.__data[0]=L.elements[0],C.__data[1]=L.elements[1],C.__data[2]=L.elements[2],C.__data[3]=L.elements[0],C.__data[4]=L.elements[3],C.__data[5]=L.elements[4],C.__data[6]=L.elements[5],C.__data[7]=L.elements[0],C.__data[8]=L.elements[6],C.__data[9]=L.elements[7],C.__data[10]=L.elements[8],C.__data[11]=L.elements[0]):(L.toArray(C.__data,P),P+=F.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,k,C.__data)}}n.bindBuffer(35345,null)}function d(_,x,b){const S=_.value;if(b[x]===void 0){if(typeof S=="number")b[x]=S;else{const T=Array.isArray(S)?S:[S],M=[];for(let C=0;C<T.length;C++)M.push(T[C].clone());b[x]=M}return!0}else if(typeof S=="number"){if(b[x]!==S)return b[x]=S,!0}else{const T=Array.isArray(b[x])?b[x]:[b[x]],M=Array.isArray(S)?S:[S];for(let C=0;C<T.length;C++){const k=T[C];if(k.equals(M[C])===!1)return k.copy(M[C]),!0}}return!1}function p(_){const x=_.uniforms;let b=0;const S=16;let T=0;for(let M=0,C=x.length;M<C;M++){const k=x[M],R={boundary:0,storage:0},P=Array.isArray(k.value)?k.value:[k.value];for(let N=0,L=P.length;N<L;N++){const F=P[N],O=m(F);R.boundary+=O.boundary,R.storage+=O.storage}if(k.__data=new Float32Array(R.storage/Float32Array.BYTES_PER_ELEMENT),k.__offset=b,M>0){T=b%S;const N=S-T;T!==0&&N-R.boundary<0&&(b+=S-T,k.__offset=b)}b+=R.storage}return T=b%S,T>0&&(b+=S-T),_.__size=b,_.__cache={},this}function m(_){const x={boundary:0,storage:0};return typeof _=="number"?(x.boundary=4,x.storage=4):_.isVector2?(x.boundary=8,x.storage=8):_.isVector3||_.isColor?(x.boundary=16,x.storage=12):_.isVector4?(x.boundary=16,x.storage=16):_.isMatrix3?(x.boundary=48,x.storage=48):_.isMatrix4?(x.boundary=64,x.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),x}function g(_){const x=_.target;x.removeEventListener("dispose",g);const b=s.indexOf(x.__bindingPointIndex);s.splice(b,1),n.deleteBuffer(i[x.id]),delete i[x.id],delete a[x.id]}function v(){for(const _ in i)n.deleteBuffer(i[_]);s=[],i={},a={}}return{bind:l,update:u,dispose:v}}function FTe(){const n=P0("canvas");return n.style.display="block",n}function BTe(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:FTe(),t=n.context!==void 0?n.context:null,r=n.depth!==void 0?n.depth:!0,i=n.stencil!==void 0?n.stencil:!0,a=n.antialias!==void 0?n.antialias:!1,s=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,o=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,l=n.powerPreference!==void 0?n.powerPreference:"default",u=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let c;t!==null?c=t.getContextAttributes().alpha:c=n.alpha!==void 0?n.alpha:!1;let f=null,h=null;const d=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=md,this.physicallyCorrectLights=!1,this.toneMapping=Bu,this.toneMappingExposure=1;const m=this;let g=!1,v=0,_=0,x=null,b=-1,S=null;const T=new Nr,M=new Nr;let C=null,k=e.width,R=e.height,P=1,N=null,L=null;const F=new Nr(0,0,k,R),O=new Nr(0,0,k,R);let B=!1;const H=new tI;let j=!1,K=!1,J=null;const re=new Un,se=new un,Ae=new De,Ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ne(){return x===null?P:1}let we=t;function me(he,Fe){for(let Ye=0;Ye<he.length;Ye++){const ze=he[Ye],tt=e.getContext(ze,Fe);if(tt!==null)return tt}return null}try{const he={alpha:!0,depth:r,stencil:i,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${XP}`),e.addEventListener("webglcontextlost",$t,!1),e.addEventListener("webglcontextrestored",Ct,!1),e.addEventListener("webglcontextcreationerror",Kt,!1),we===null){const Fe=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&Fe.shift(),we=me(Fe,he),we===null)throw me(Fe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}we.getShaderPrecisionFormat===void 0&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}let Se,Me,ke,He,ee,ie,xe,Ve,Ge,Ze,ut,Qe,ve,Ke,ne,Z,fe,Be,Xe,st,mt,ye,$e,vt;function bt(){Se=new Kwe(we),Me=new Hwe(we,Se,n),Se.init(Me),ye=new PTe(we,Se,Me),ke=new kTe(we,Se,Me),He=new Qwe,ee=new mTe,ie=new RTe(we,Se,ke,ee,Me,ye,He),xe=new Gwe(m),Ve=new Xwe(m),Ge=new obe(we,Me),$e=new zwe(we,Se,Ge,Me),Ze=new Ywe(we,Ge,He,$e),ut=new nSe(we,Ze,Ge,He),Xe=new tSe(we,Me,ie),Z=new Wwe(ee),Qe=new pTe(m,xe,Ve,Se,Me,$e,Z),ve=new OTe(m,ee),Ke=new vTe,ne=new STe(Se,Me),Be=new Uwe(m,xe,Ve,ke,ut,c,s),fe=new MTe(m,ut,Me),vt=new $Te(we,He,Me,ke),st=new Vwe(we,Se,He,Me),mt=new Zwe(we,Se,He,Me),He.programs=Qe.programs,m.capabilities=Me,m.extensions=Se,m.properties=ee,m.renderLists=Ke,m.shadowMap=fe,m.state=ke,m.info=He}bt();const dt=new NTe(m,we);this.xr=dt,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const he=Se.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){const he=Se.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(he){he!==void 0&&(P=he,this.setSize(k,R,!1))},this.getSize=function(he){return he.set(k,R)},this.setSize=function(he,Fe,Ye){if(dt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}k=he,R=Fe,e.width=Math.floor(he*P),e.height=Math.floor(Fe*P),Ye!==!1&&(e.style.width=he+"px",e.style.height=Fe+"px"),this.setViewport(0,0,he,Fe)},this.getDrawingBufferSize=function(he){return he.set(k*P,R*P).floor()},this.setDrawingBufferSize=function(he,Fe,Ye){k=he,R=Fe,P=Ye,e.width=Math.floor(he*Ye),e.height=Math.floor(Fe*Ye),this.setViewport(0,0,he,Fe)},this.getCurrentViewport=function(he){return he.copy(T)},this.getViewport=function(he){return he.copy(F)},this.setViewport=function(he,Fe,Ye,ze){he.isVector4?F.set(he.x,he.y,he.z,he.w):F.set(he,Fe,Ye,ze),ke.viewport(T.copy(F).multiplyScalar(P).floor())},this.getScissor=function(he){return he.copy(O)},this.setScissor=function(he,Fe,Ye,ze){he.isVector4?O.set(he.x,he.y,he.z,he.w):O.set(he,Fe,Ye,ze),ke.scissor(M.copy(O).multiplyScalar(P).floor())},this.getScissorTest=function(){return B},this.setScissorTest=function(he){ke.setScissorTest(B=he)},this.setOpaqueSort=function(he){N=he},this.setTransparentSort=function(he){L=he},this.getClearColor=function(he){return he.copy(Be.getClearColor())},this.setClearColor=function(){Be.setClearColor.apply(Be,arguments)},this.getClearAlpha=function(){return Be.getClearAlpha()},this.setClearAlpha=function(){Be.setClearAlpha.apply(Be,arguments)},this.clear=function(he=!0,Fe=!0,Ye=!0){let ze=0;he&&(ze|=16384),Fe&&(ze|=256),Ye&&(ze|=1024),we.clear(ze)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",$t,!1),e.removeEventListener("webglcontextrestored",Ct,!1),e.removeEventListener("webglcontextcreationerror",Kt,!1),Ke.dispose(),ne.dispose(),ee.dispose(),xe.dispose(),Ve.dispose(),ut.dispose(),$e.dispose(),vt.dispose(),Qe.dispose(),dt.dispose(),dt.removeEventListener("sessionstart",wt),dt.removeEventListener("sessionend",Bt),J&&(J.dispose(),J=null),Ln.stop()};function $t(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ct(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const he=He.autoReset,Fe=fe.enabled,Ye=fe.autoUpdate,ze=fe.needsUpdate,tt=fe.type;bt(),He.autoReset=he,fe.enabled=Fe,fe.autoUpdate=Ye,fe.needsUpdate=ze,fe.type=tt}function Kt(he){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",he.statusMessage)}function Vt(he){const Fe=he.target;Fe.removeEventListener("dispose",Vt),Ft(Fe)}function Ft(he){Pe(he),ee.remove(he)}function Pe(he){const Fe=ee.get(he).programs;Fe!==void 0&&(Fe.forEach(function(Ye){Qe.releaseProgram(Ye)}),he.isShaderMaterial&&Qe.releaseShaderCache(he))}this.renderBufferDirect=function(he,Fe,Ye,ze,tt,Gt){Fe===null&&(Fe=Ee);const Zt=tt.isMesh&&tt.matrixWorld.determinant()<0,fn=zt(he,Fe,Ye,ze,tt);ke.setMaterial(ze,Zt);let hn=Ye.index,Mn=1;ze.wireframe===!0&&(hn=Ze.getWireframeAttribute(Ye),Mn=2);const vn=Ye.drawRange,yn=Ye.attributes.position;let Cr=vn.start*Mn,ur=(vn.start+vn.count)*Mn;Gt!==null&&(Cr=Math.max(Cr,Gt.start*Mn),ur=Math.min(ur,(Gt.start+Gt.count)*Mn)),hn!==null?(Cr=Math.max(Cr,0),ur=Math.min(ur,hn.count)):yn!=null&&(Cr=Math.max(Cr,0),ur=Math.min(ur,yn.count));const Kr=ur-Cr;if(Kr<0||Kr===1/0)return;$e.setup(tt,ze,fn,Ye,hn);let Di,Er=st;if(hn!==null&&(Di=Ge.get(hn),Er=mt,Er.setIndex(Di)),tt.isMesh)ze.wireframe===!0?(ke.setLineWidth(ze.wireframeLinewidth*Ne()),Er.setMode(1)):Er.setMode(4);else if(tt.isLine){let ue=ze.linewidth;ue===void 0&&(ue=1),ke.setLineWidth(ue*Ne()),tt.isLineSegments?Er.setMode(1):tt.isLineLoop?Er.setMode(2):Er.setMode(3)}else tt.isPoints?Er.setMode(0):tt.isSprite&&Er.setMode(4);if(tt.isInstancedMesh)Er.renderInstances(Cr,Kr,tt.count);else if(Ye.isInstancedBufferGeometry){const ue=Ye._maxInstanceCount!==void 0?Ye._maxInstanceCount:1/0,q=Math.min(Ye.instanceCount,ue);Er.renderInstances(Cr,Kr,q)}else Er.render(Cr,Kr)},this.compile=function(he,Fe){function Ye(ze,tt,Gt){ze.transparent===!0&&ze.side===$x?(ze.side=po,ze.needsUpdate=!0,hi(ze,tt,Gt),ze.side=cf,ze.needsUpdate=!0,hi(ze,tt,Gt),ze.side=$x):hi(ze,tt,Gt)}h=ne.get(he),h.init(),p.push(h),he.traverseVisible(function(ze){ze.isLight&&ze.layers.test(Fe.layers)&&(h.pushLight(ze),ze.castShadow&&h.pushShadow(ze))}),h.setupLights(m.physicallyCorrectLights),he.traverse(function(ze){const tt=ze.material;if(tt)if(Array.isArray(tt))for(let Gt=0;Gt<tt.length;Gt++){const Zt=tt[Gt];Ye(Zt,he,ze)}else Ye(tt,he,ze)}),p.pop(),h=null};let Je=null;function ot(he){Je&&Je(he)}function wt(){Ln.stop()}function Bt(){Ln.start()}const Ln=new a7;Ln.setAnimationLoop(ot),typeof self<"u"&&Ln.setContext(self),this.setAnimationLoop=function(he){Je=he,dt.setAnimationLoop(he),he===null?Ln.stop():Ln.start()},dt.addEventListener("sessionstart",wt),dt.addEventListener("sessionend",Bt),this.render=function(he,Fe){if(Fe!==void 0&&Fe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;he.matrixWorldAutoUpdate===!0&&he.updateMatrixWorld(),Fe.parent===null&&Fe.matrixWorldAutoUpdate===!0&&Fe.updateMatrixWorld(),dt.enabled===!0&&dt.isPresenting===!0&&(dt.cameraAutoUpdate===!0&&dt.updateCamera(Fe),Fe=dt.getCamera()),he.isScene===!0&&he.onBeforeRender(m,he,Fe,x),h=ne.get(he,p.length),h.init(),p.push(h),re.multiplyMatrices(Fe.projectionMatrix,Fe.matrixWorldInverse),H.setFromProjectionMatrix(re),K=this.localClippingEnabled,j=Z.init(this.clippingPlanes,K,Fe),f=Ke.get(he,d.length),f.init(),d.push(f),lr(he,Fe,0,m.sortObjects),f.finish(),m.sortObjects===!0&&f.sort(N,L),j===!0&&Z.beginShadows();const Ye=h.state.shadowsArray;if(fe.render(Ye,he,Fe),j===!0&&Z.endShadows(),this.info.autoReset===!0&&this.info.reset(),Be.render(f,he),h.setupLights(m.physicallyCorrectLights),Fe.isArrayCamera){const ze=Fe.cameras;for(let tt=0,Gt=ze.length;tt<Gt;tt++){const Zt=ze[tt];Xr(f,he,Zt,Zt.viewport)}}else Xr(f,he,Fe);x!==null&&(ie.updateMultisampleRenderTarget(x),ie.updateRenderTargetMipmap(x)),he.isScene===!0&&he.onAfterRender(m,he,Fe),$e.resetDefaultState(),b=-1,S=null,p.pop(),p.length>0?h=p[p.length-1]:h=null,d.pop(),d.length>0?f=d[d.length-1]:f=null};function lr(he,Fe,Ye,ze){if(he.visible===!1)return;if(he.layers.test(Fe.layers)){if(he.isGroup)Ye=he.renderOrder;else if(he.isLOD)he.autoUpdate===!0&&he.update(Fe);else if(he.isLight)h.pushLight(he),he.castShadow&&h.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||H.intersectsSprite(he)){ze&&Ae.setFromMatrixPosition(he.matrixWorld).applyMatrix4(re);const Zt=ut.update(he),fn=he.material;fn.visible&&f.push(he,Zt,fn,Ye,Ae.z,null)}}else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==He.render.frame&&(he.skeleton.update(),he.skeleton.frame=He.render.frame),!he.frustumCulled||H.intersectsObject(he))){ze&&Ae.setFromMatrixPosition(he.matrixWorld).applyMatrix4(re);const Zt=ut.update(he),fn=he.material;if(Array.isArray(fn)){const hn=Zt.groups;for(let Mn=0,vn=hn.length;Mn<vn;Mn++){const yn=hn[Mn],Cr=fn[yn.materialIndex];Cr&&Cr.visible&&f.push(he,Zt,Cr,Ye,Ae.z,yn)}}else fn.visible&&f.push(he,Zt,fn,Ye,Ae.z,null)}}const Gt=he.children;for(let Zt=0,fn=Gt.length;Zt<fn;Zt++)lr(Gt[Zt],Fe,Ye,ze)}function Xr(he,Fe,Ye,ze){const tt=he.opaque,Gt=he.transmissive,Zt=he.transparent;h.setupLightsView(Ye),Gt.length>0&&Ca(tt,Fe,Ye),ze&&ke.viewport(T.copy(ze)),tt.length>0&&tr(tt,Fe,Ye),Gt.length>0&&tr(Gt,Fe,Ye),Zt.length>0&&tr(Zt,Fe,Ye),ke.buffers.depth.setTest(!0),ke.buffers.depth.setMask(!0),ke.buffers.color.setMask(!0),ke.setPolygonOffset(!1)}function Ca(he,Fe,Ye){const ze=Me.isWebGL2;J===null&&(J=new ff(1,1,{generateMipmaps:!0,type:Se.has("EXT_color_buffer_half_float")?A0:pd,minFilter:dd,samples:ze&&a===!0?4:0})),m.getDrawingBufferSize(se),ze?J.setSize(se.x,se.y):J.setSize(ww(se.x),ww(se.y));const tt=m.getRenderTarget();m.setRenderTarget(J),m.clear();const Gt=m.toneMapping;m.toneMapping=Bu,tr(he,Fe,Ye),m.toneMapping=Gt,ie.updateMultisampleRenderTarget(J),ie.updateRenderTargetMipmap(J),m.setRenderTarget(tt)}function tr(he,Fe,Ye){const ze=Fe.isScene===!0?Fe.overrideMaterial:null;for(let tt=0,Gt=he.length;tt<Gt;tt++){const Zt=he[tt],fn=Zt.object,hn=Zt.geometry,Mn=ze===null?Zt.material:ze,vn=Zt.group;fn.layers.test(Ye.layers)&&Fr(fn,Fe,Ye,hn,Mn,vn)}}function Fr(he,Fe,Ye,ze,tt,Gt){he.onBeforeRender(m,Fe,Ye,ze,tt,Gt),he.modelViewMatrix.multiplyMatrices(Ye.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),tt.onBeforeRender(m,Fe,Ye,ze,he,Gt),tt.transparent===!0&&tt.side===$x?(tt.side=po,tt.needsUpdate=!0,m.renderBufferDirect(Ye,Fe,ze,tt,he,Gt),tt.side=cf,tt.needsUpdate=!0,m.renderBufferDirect(Ye,Fe,ze,tt,he,Gt),tt.side=$x):m.renderBufferDirect(Ye,Fe,ze,tt,he,Gt),he.onAfterRender(m,Fe,Ye,ze,tt,Gt)}function hi(he,Fe,Ye){Fe.isScene!==!0&&(Fe=Ee);const ze=ee.get(he),tt=h.state.lights,Gt=h.state.shadowsArray,Zt=tt.state.version,fn=Qe.getParameters(he,tt.state,Gt,Fe,Ye),hn=Qe.getProgramCacheKey(fn);let Mn=ze.programs;ze.environment=he.isMeshStandardMaterial?Fe.environment:null,ze.fog=Fe.fog,ze.envMap=(he.isMeshStandardMaterial?Ve:xe).get(he.envMap||ze.environment),Mn===void 0&&(he.addEventListener("dispose",Vt),Mn=new Map,ze.programs=Mn);let vn=Mn.get(hn);if(vn!==void 0){if(ze.currentProgram===vn&&ze.lightsStateVersion===Zt)return ii(he,fn),vn}else fn.uniforms=Qe.getUniforms(he),he.onBuild(Ye,fn,m),he.onBeforeCompile(fn,m),vn=Qe.acquireProgram(fn,hn),Mn.set(hn,vn),ze.uniforms=fn.uniforms;const yn=ze.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||he.clipping===!0)&&(yn.clippingPlanes=Z.uniform),ii(he,fn),ze.needsLights=za(he),ze.lightsStateVersion=Zt,ze.needsLights&&(yn.ambientLightColor.value=tt.state.ambient,yn.lightProbe.value=tt.state.probe,yn.directionalLights.value=tt.state.directional,yn.directionalLightShadows.value=tt.state.directionalShadow,yn.spotLights.value=tt.state.spot,yn.spotLightShadows.value=tt.state.spotShadow,yn.rectAreaLights.value=tt.state.rectArea,yn.ltc_1.value=tt.state.rectAreaLTC1,yn.ltc_2.value=tt.state.rectAreaLTC2,yn.pointLights.value=tt.state.point,yn.pointLightShadows.value=tt.state.pointShadow,yn.hemisphereLights.value=tt.state.hemi,yn.directionalShadowMap.value=tt.state.directionalShadowMap,yn.directionalShadowMatrix.value=tt.state.directionalShadowMatrix,yn.spotShadowMap.value=tt.state.spotShadowMap,yn.spotLightMatrix.value=tt.state.spotLightMatrix,yn.spotLightMap.value=tt.state.spotLightMap,yn.pointShadowMap.value=tt.state.pointShadowMap,yn.pointShadowMatrix.value=tt.state.pointShadowMatrix);const Cr=vn.getUniforms(),ur=z1.seqWithValue(Cr.seq,yn);return ze.currentProgram=vn,ze.uniformsList=ur,vn}function ii(he,Fe){const Ye=ee.get(he);Ye.outputEncoding=Fe.outputEncoding,Ye.instancing=Fe.instancing,Ye.skinning=Fe.skinning,Ye.morphTargets=Fe.morphTargets,Ye.morphNormals=Fe.morphNormals,Ye.morphColors=Fe.morphColors,Ye.morphTargetsCount=Fe.morphTargetsCount,Ye.numClippingPlanes=Fe.numClippingPlanes,Ye.numIntersection=Fe.numClipIntersection,Ye.vertexAlphas=Fe.vertexAlphas,Ye.vertexTangents=Fe.vertexTangents,Ye.toneMapping=Fe.toneMapping}function zt(he,Fe,Ye,ze,tt){Fe.isScene!==!0&&(Fe=Ee),ie.resetTextureUnits();const Gt=Fe.fog,Zt=ze.isMeshStandardMaterial?Fe.environment:null,fn=x===null?m.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:md,hn=(ze.isMeshStandardMaterial?Ve:xe).get(ze.envMap||Zt),Mn=ze.vertexColors===!0&&!!Ye.attributes.color&&Ye.attributes.color.itemSize===4,vn=!!ze.normalMap&&!!Ye.attributes.tangent,yn=!!Ye.morphAttributes.position,Cr=!!Ye.morphAttributes.normal,ur=!!Ye.morphAttributes.color,Kr=ze.toneMapped?m.toneMapping:Bu,Di=Ye.morphAttributes.position||Ye.morphAttributes.normal||Ye.morphAttributes.color,Er=Di!==void 0?Di.length:0,ue=ee.get(ze),q=h.state.lights;if(j===!0&&(K===!0||he!==S)){const ct=he===S&&ze.id===b;Z.setState(ze,he,ct)}let z=!1;ze.version===ue.__version?(ue.needsLights&&ue.lightsStateVersion!==q.state.version||ue.outputEncoding!==fn||tt.isInstancedMesh&&ue.instancing===!1||!tt.isInstancedMesh&&ue.instancing===!0||tt.isSkinnedMesh&&ue.skinning===!1||!tt.isSkinnedMesh&&ue.skinning===!0||ue.envMap!==hn||ze.fog===!0&&ue.fog!==Gt||ue.numClippingPlanes!==void 0&&(ue.numClippingPlanes!==Z.numPlanes||ue.numIntersection!==Z.numIntersection)||ue.vertexAlphas!==Mn||ue.vertexTangents!==vn||ue.morphTargets!==yn||ue.morphNormals!==Cr||ue.morphColors!==ur||ue.toneMapping!==Kr||Me.isWebGL2===!0&&ue.morphTargetsCount!==Er)&&(z=!0):(z=!0,ue.__version=ze.version);let G=ue.currentProgram;z===!0&&(G=hi(ze,Fe,tt));let ae=!1,be=!1,Ie=!1;const Ue=G.getUniforms(),rt=ue.uniforms;if(ke.useProgram(G.program)&&(ae=!0,be=!0,Ie=!0),ze.id!==b&&(b=ze.id,be=!0),ae||S!==he){if(Ue.setValue(we,"projectionMatrix",he.projectionMatrix),Me.logarithmicDepthBuffer&&Ue.setValue(we,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),S!==he&&(S=he,be=!0,Ie=!0),ze.isShaderMaterial||ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshStandardMaterial||ze.envMap){const ct=Ue.map.cameraPosition;ct!==void 0&&ct.setValue(we,Ae.setFromMatrixPosition(he.matrixWorld))}(ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshLambertMaterial||ze.isMeshBasicMaterial||ze.isMeshStandardMaterial||ze.isShaderMaterial)&&Ue.setValue(we,"isOrthographic",he.isOrthographicCamera===!0),(ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshLambertMaterial||ze.isMeshBasicMaterial||ze.isMeshStandardMaterial||ze.isShaderMaterial||ze.isShadowMaterial||tt.isSkinnedMesh)&&Ue.setValue(we,"viewMatrix",he.matrixWorldInverse)}if(tt.isSkinnedMesh){Ue.setOptional(we,tt,"bindMatrix"),Ue.setOptional(we,tt,"bindMatrixInverse");const ct=tt.skeleton;ct&&(Me.floatVertexTextures?(ct.boneTexture===null&&ct.computeBoneTexture(),Ue.setValue(we,"boneTexture",ct.boneTexture,ie),Ue.setValue(we,"boneTextureSize",ct.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const _t=Ye.morphAttributes;if((_t.position!==void 0||_t.normal!==void 0||_t.color!==void 0&&Me.isWebGL2===!0)&&Xe.update(tt,Ye,ze,G),(be||ue.receiveShadow!==tt.receiveShadow)&&(ue.receiveShadow=tt.receiveShadow,Ue.setValue(we,"receiveShadow",tt.receiveShadow)),ze.isMeshGouraudMaterial&&ze.envMap!==null&&(rt.envMap.value=hn,rt.flipEnvMap.value=hn.isCubeTexture&&hn.isRenderTargetTexture===!1?-1:1),be&&(Ue.setValue(we,"toneMappingExposure",m.toneMappingExposure),ue.needsLights&&it(rt,Ie),Gt&&ze.fog===!0&&ve.refreshFogUniforms(rt,Gt),ve.refreshMaterialUniforms(rt,ze,P,R,J),z1.upload(we,ue.uniformsList,rt,ie)),ze.isShaderMaterial&&ze.uniformsNeedUpdate===!0&&(z1.upload(we,ue.uniformsList,rt,ie),ze.uniformsNeedUpdate=!1),ze.isSpriteMaterial&&Ue.setValue(we,"center",tt.center),Ue.setValue(we,"modelViewMatrix",tt.modelViewMatrix),Ue.setValue(we,"normalMatrix",tt.normalMatrix),Ue.setValue(we,"modelMatrix",tt.matrixWorld),ze.isShaderMaterial||ze.isRawShaderMaterial){const ct=ze.uniformsGroups;for(let Lt=0,Ot=ct.length;Lt<Ot;Lt++)if(Me.isWebGL2){const En=ct[Lt];vt.update(En,G),vt.bind(En,G)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return G}function it(he,Fe){he.ambientLightColor.needsUpdate=Fe,he.lightProbe.needsUpdate=Fe,he.directionalLights.needsUpdate=Fe,he.directionalLightShadows.needsUpdate=Fe,he.pointLights.needsUpdate=Fe,he.pointLightShadows.needsUpdate=Fe,he.spotLights.needsUpdate=Fe,he.spotLightShadows.needsUpdate=Fe,he.rectAreaLights.needsUpdate=Fe,he.hemisphereLights.needsUpdate=Fe}function za(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&he.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(he,Fe,Ye){ee.get(he.texture).__webglTexture=Fe,ee.get(he.depthTexture).__webglTexture=Ye;const ze=ee.get(he);ze.__hasExternalTextures=!0,ze.__hasExternalTextures&&(ze.__autoAllocateDepthBuffer=Ye===void 0,ze.__autoAllocateDepthBuffer||Se.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ze.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(he,Fe){const Ye=ee.get(he);Ye.__webglFramebuffer=Fe,Ye.__useDefaultFramebuffer=Fe===void 0},this.setRenderTarget=function(he,Fe=0,Ye=0){x=he,v=Fe,_=Ye;let ze=!0,tt=null,Gt=!1,Zt=!1;if(he){const hn=ee.get(he);hn.__useDefaultFramebuffer!==void 0?(ke.bindFramebuffer(36160,null),ze=!1):hn.__webglFramebuffer===void 0?ie.setupRenderTarget(he):hn.__hasExternalTextures&&ie.rebindTextures(he,ee.get(he.texture).__webglTexture,ee.get(he.depthTexture).__webglTexture);const Mn=he.texture;(Mn.isData3DTexture||Mn.isDataArrayTexture||Mn.isCompressedArrayTexture)&&(Zt=!0);const vn=ee.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?(tt=vn[Fe],Gt=!0):Me.isWebGL2&&he.samples>0&&ie.useMultisampledRTT(he)===!1?tt=ee.get(he).__webglMultisampledFramebuffer:tt=vn,T.copy(he.viewport),M.copy(he.scissor),C=he.scissorTest}else T.copy(F).multiplyScalar(P).floor(),M.copy(O).multiplyScalar(P).floor(),C=B;if(ke.bindFramebuffer(36160,tt)&&Me.drawBuffers&&ze&&ke.drawBuffers(he,tt),ke.viewport(T),ke.scissor(M),ke.setScissorTest(C),Gt){const hn=ee.get(he.texture);we.framebufferTexture2D(36160,36064,34069+Fe,hn.__webglTexture,Ye)}else if(Zt){const hn=ee.get(he.texture),Mn=Fe||0;we.framebufferTextureLayer(36160,36064,hn.__webglTexture,Ye||0,Mn)}b=-1},this.readRenderTargetPixels=function(he,Fe,Ye,ze,tt,Gt,Zt){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let fn=ee.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&Zt!==void 0&&(fn=fn[Zt]),fn){ke.bindFramebuffer(36160,fn);try{const hn=he.texture,Mn=hn.format,vn=hn.type;if(Mn!==eo&&ye.convert(Mn)!==we.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const yn=vn===A0&&(Se.has("EXT_color_buffer_half_float")||Me.isWebGL2&&Se.has("EXT_color_buffer_float"));if(vn!==pd&&ye.convert(vn)!==we.getParameter(35738)&&!(vn===Iu&&(Me.isWebGL2||Se.has("OES_texture_float")||Se.has("WEBGL_color_buffer_float")))&&!yn){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Fe>=0&&Fe<=he.width-ze&&Ye>=0&&Ye<=he.height-tt&&we.readPixels(Fe,Ye,ze,tt,ye.convert(Mn),ye.convert(vn),Gt)}finally{const hn=x!==null?ee.get(x).__webglFramebuffer:null;ke.bindFramebuffer(36160,hn)}}},this.copyFramebufferToTexture=function(he,Fe,Ye=0){const ze=Math.pow(2,-Ye),tt=Math.floor(Fe.image.width*ze),Gt=Math.floor(Fe.image.height*ze);ie.setTexture2D(Fe,0),we.copyTexSubImage2D(3553,Ye,0,0,he.x,he.y,tt,Gt),ke.unbindTexture()},this.copyTextureToTexture=function(he,Fe,Ye,ze=0){const tt=Fe.image.width,Gt=Fe.image.height,Zt=ye.convert(Ye.format),fn=ye.convert(Ye.type);ie.setTexture2D(Ye,0),we.pixelStorei(37440,Ye.flipY),we.pixelStorei(37441,Ye.premultiplyAlpha),we.pixelStorei(3317,Ye.unpackAlignment),Fe.isDataTexture?we.texSubImage2D(3553,ze,he.x,he.y,tt,Gt,Zt,fn,Fe.image.data):Fe.isCompressedTexture?we.compressedTexSubImage2D(3553,ze,he.x,he.y,Fe.mipmaps[0].width,Fe.mipmaps[0].height,Zt,Fe.mipmaps[0].data):we.texSubImage2D(3553,ze,he.x,he.y,Zt,fn,Fe.image),ze===0&&Ye.generateMipmaps&&we.generateMipmap(3553),ke.unbindTexture()},this.copyTextureToTexture3D=function(he,Fe,Ye,ze,tt=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Gt=he.max.x-he.min.x+1,Zt=he.max.y-he.min.y+1,fn=he.max.z-he.min.z+1,hn=ye.convert(ze.format),Mn=ye.convert(ze.type);let vn;if(ze.isData3DTexture)ie.setTexture3D(ze,0),vn=32879;else if(ze.isDataArrayTexture)ie.setTexture2DArray(ze,0),vn=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}we.pixelStorei(37440,ze.flipY),we.pixelStorei(37441,ze.premultiplyAlpha),we.pixelStorei(3317,ze.unpackAlignment);const yn=we.getParameter(3314),Cr=we.getParameter(32878),ur=we.getParameter(3316),Kr=we.getParameter(3315),Di=we.getParameter(32877),Er=Ye.isCompressedTexture?Ye.mipmaps[0]:Ye.image;we.pixelStorei(3314,Er.width),we.pixelStorei(32878,Er.height),we.pixelStorei(3316,he.min.x),we.pixelStorei(3315,he.min.y),we.pixelStorei(32877,he.min.z),Ye.isDataTexture||Ye.isData3DTexture?we.texSubImage3D(vn,tt,Fe.x,Fe.y,Fe.z,Gt,Zt,fn,hn,Mn,Er.data):Ye.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),we.compressedTexSubImage3D(vn,tt,Fe.x,Fe.y,Fe.z,Gt,Zt,fn,hn,Er.data)):we.texSubImage3D(vn,tt,Fe.x,Fe.y,Fe.z,Gt,Zt,fn,hn,Mn,Er),we.pixelStorei(3314,yn),we.pixelStorei(32878,Cr),we.pixelStorei(3316,ur),we.pixelStorei(3315,Kr),we.pixelStorei(32877,Di),tt===0&&ze.generateMipmaps&&we.generateMipmap(vn),ke.unbindTexture()},this.initTexture=function(he){he.isCubeTexture?ie.setTextureCube(he,0):he.isData3DTexture?ie.setTexture3D(he,0):he.isDataArrayTexture||he.isCompressedArrayTexture?ie.setTexture2DArray(he,0):ie.setTexture2D(he,0),ke.unbindTexture()},this.resetState=function(){v=0,_=0,x=null,ke.reset(),$e.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class UTe extends BTe{}UTe.prototype.isWebGL1Renderer=!0;class Urt extends Hr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class zTe{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=TM,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Yo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,a=this.stride;i<a;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Yo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Yo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ka=new De;class iI{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)ka.fromBufferAttribute(this,t),ka.applyMatrix4(e),this.setXYZ(t,ka.x,ka.y,ka.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)ka.fromBufferAttribute(this,t),ka.applyNormalMatrix(e),this.setXYZ(t,ka.x,ka.y,ka.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)ka.fromBufferAttribute(this,t),ka.transformDirection(e),this.setXYZ(t,ka.x,ka.y,ka.z);return this}setX(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Du(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Du(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Du(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Du(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dr(t,this.array),r=Dr(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dr(t,this.array),r=Dr(r,this.array),i=Dr(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dr(t,this.array),r=Dr(r,this.array),i=Dr(i,this.array),a=Dr(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return new Yi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new iI(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const J4=new De,e5=new Nr,t5=new Nr,VTe=new De,n5=new Un;class HTe extends ns{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Un,this.bindMatrixInverse=new Un}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Nr,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const r=this.skeleton,i=this.geometry;e5.fromBufferAttribute(i.attributes.skinIndex,e),t5.fromBufferAttribute(i.attributes.skinWeight,e),J4.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const s=t5.getComponent(a);if(s!==0){const o=e5.getComponent(a);n5.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),t.addScaledVector(VTe.copy(J4).applyMatrix4(n5),s)}}return t.applyMatrix4(this.bindMatrixInverse)}}class c7 extends Hr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class f7 extends Ki{constructor(e=null,t=1,r=1,i,a,s,o,l,u=Ni,c=Ni,f,h){super(null,s,o,l,u,c,i,a,f,h),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const r5=new Un,WTe=new Un;class aI{constructor(e=[],t=[]){this.uuid=Yo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Un)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Un;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let a=0,s=e.length;a<s;a++){const o=e[a]?e[a].matrixWorld:WTe;r5.multiplyMatrices(o,t[a]),r5.toArray(r,a*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new aI(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Kj(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new f7(t,e,e,eo,Iu);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const a=e.bones[r];let s=t[a];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),s=new c7),this.bones.push(s),this.boneInverses.push(new Un().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,a=t.length;i<a;i++){const s=t[i];e.bones.push(s.uuid);const o=r[i];e.boneInverses.push(o.toArray())}return e}}class i5 extends Yi{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const a5=new Un,s5=new Un,nb=[],GTe=new Un,Iv=new ns;class jTe extends ns{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new i5(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1;for(let i=0;i<r;i++)this.setMatrixAt(i,GTe)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(Iv.geometry=this.geometry,Iv.material=this.material,Iv.material!==void 0)for(let a=0;a<i;a++){this.getMatrixAt(a,a5),s5.multiplyMatrices(r,a5),Iv.matrixWorld=s5,Iv.raycast(e,nb);for(let s=0,o=nb.length;s<o;s++){const l=nb[s];l.instanceId=a,l.object=this,t.push(l)}nb.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new i5(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class lT extends Zo{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new gn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const o5=new De,l5=new De,u5=new Un,N2=new aT,rb=new Og;let I0=class extends Hr{constructor(e=new xa,t=new lT){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,a=t.count;i<a;i++)o5.fromBufferAttribute(t,i-1),l5.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=o5.distanceTo(l5);e.setAttribute("lineDistance",new Ei(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,a=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),rb.copy(r.boundingSphere),rb.applyMatrix4(i),rb.radius+=a,e.ray.intersectsSphere(rb)===!1)return;u5.copy(i).invert(),N2.copy(e.ray).applyMatrix4(u5);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=new De,c=new De,f=new De,h=new De,d=this.isLineSegments?2:1,p=r.index,g=r.attributes.position;if(p!==null){const v=Math.max(0,s.start),_=Math.min(p.count,s.start+s.count);for(let x=v,b=_-1;x<b;x+=d){const S=p.getX(x),T=p.getX(x+1);if(u.fromBufferAttribute(g,S),c.fromBufferAttribute(g,T),N2.distanceSqToSegment(u,c,h,f)>l)continue;h.applyMatrix4(this.matrixWorld);const C=e.ray.origin.distanceTo(h);C<e.near||C>e.far||t.push({distance:C,point:f.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,s.start),_=Math.min(g.count,s.start+s.count);for(let x=v,b=_-1;x<b;x+=d){if(u.fromBufferAttribute(g,x),c.fromBufferAttribute(g,x+1),N2.distanceSqToSegment(u,c,h,f)>l)continue;h.applyMatrix4(this.matrixWorld);const T=e.ray.origin.distanceTo(h);T<e.near||T>e.far||t.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}};const c5=new De,f5=new De;class qTe extends I0{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,a=t.count;i<a;i+=2)c5.fromBufferAttribute(t,i),f5.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+c5.distanceTo(f5);e.setAttribute("lineDistance",new Ei(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class XTe extends I0{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class h7 extends Zo{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new gn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const h5=new Un,MM=new aT,ib=new Og,ab=new De;class KTe extends Hr{constructor(e=new xa,t=new h7){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,a=e.params.Points.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),ib.copy(r.boundingSphere),ib.applyMatrix4(i),ib.radius+=a,e.ray.intersectsSphere(ib)===!1)return;h5.copy(i).invert(),MM.copy(e.ray).applyMatrix4(h5);const o=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,u=r.index,f=r.attributes.position;if(u!==null){const h=Math.max(0,s.start),d=Math.min(u.count,s.start+s.count);for(let p=h,m=d;p<m;p++){const g=u.getX(p);ab.fromBufferAttribute(f,g),d5(ab,g,l,i,e,t,this)}}else{const h=Math.max(0,s.start),d=Math.min(f.count,s.start+s.count);for(let p=h,m=d;p<m;p++)ab.fromBufferAttribute(f,p),d5(ab,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,s=i.length;a<s;a++){const o=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}}function d5(n,e,t,r,i,a,s){const o=MM.distanceSqToPoint(n);if(o<t){const l=new De;MM.closestPointToPoint(n,l),l.applyMatrix4(r);const u=i.ray.origin.distanceTo(l);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,object:s})}}class sI extends xa{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const a=[],s=[];o(i),u(r),c(),this.setAttribute("position",new Ei(a,3)),this.setAttribute("normal",new Ei(a.slice(),3)),this.setAttribute("uv",new Ei(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(_){const x=new De,b=new De,S=new De;for(let T=0;T<t.length;T+=3)d(t[T+0],x),d(t[T+1],b),d(t[T+2],S),l(x,b,S,_)}function l(_,x,b,S){const T=S+1,M=[];for(let C=0;C<=T;C++){M[C]=[];const k=_.clone().lerp(b,C/T),R=x.clone().lerp(b,C/T),P=T-C;for(let N=0;N<=P;N++)N===0&&C===T?M[C][N]=k:M[C][N]=k.clone().lerp(R,N/P)}for(let C=0;C<T;C++)for(let k=0;k<2*(T-C)-1;k++){const R=Math.floor(k/2);k%2===0?(h(M[C][R+1]),h(M[C+1][R]),h(M[C][R])):(h(M[C][R+1]),h(M[C+1][R+1]),h(M[C+1][R]))}}function u(_){const x=new De;for(let b=0;b<a.length;b+=3)x.x=a[b+0],x.y=a[b+1],x.z=a[b+2],x.normalize().multiplyScalar(_),a[b+0]=x.x,a[b+1]=x.y,a[b+2]=x.z}function c(){const _=new De;for(let x=0;x<a.length;x+=3){_.x=a[x+0],_.y=a[x+1],_.z=a[x+2];const b=g(_)/2/Math.PI+.5,S=v(_)/Math.PI+.5;s.push(b,1-S)}p(),f()}function f(){for(let _=0;_<s.length;_+=6){const x=s[_+0],b=s[_+2],S=s[_+4],T=Math.max(x,b,S),M=Math.min(x,b,S);T>.9&&M<.1&&(x<.2&&(s[_+0]+=1),b<.2&&(s[_+2]+=1),S<.2&&(s[_+4]+=1))}}function h(_){a.push(_.x,_.y,_.z)}function d(_,x){const b=_*3;x.x=e[b+0],x.y=e[b+1],x.z=e[b+2]}function p(){const _=new De,x=new De,b=new De,S=new De,T=new un,M=new un,C=new un;for(let k=0,R=0;k<a.length;k+=9,R+=6){_.set(a[k+0],a[k+1],a[k+2]),x.set(a[k+3],a[k+4],a[k+5]),b.set(a[k+6],a[k+7],a[k+8]),T.set(s[R+0],s[R+1]),M.set(s[R+2],s[R+3]),C.set(s[R+4],s[R+5]),S.copy(_).add(x).add(b).divideScalar(3);const P=g(S);m(T,R+0,_,P),m(M,R+2,x,P),m(C,R+4,b,P)}}function m(_,x,b,S){S<0&&_.x===1&&(s[x]=_.x-1),b.x===0&&b.z===0&&(s[x]=S/2/Math.PI+.5)}function g(_){return Math.atan2(_.z,-_.x)}function v(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}static fromJSON(e){return new sI(e.vertices,e.indices,e.radius,e.details)}}class oI extends sI{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new oI(e.radius,e.detail)}}class d7 extends xa{constructor(e=1,t=32,r=16,i=0,a=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:a,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(s+o,Math.PI);let u=0;const c=[],f=new De,h=new De,d=[],p=[],m=[],g=[];for(let v=0;v<=r;v++){const _=[],x=v/r;let b=0;v==0&&s==0?b=.5/t:v==r&&l==Math.PI&&(b=-.5/t);for(let S=0;S<=t;S++){const T=S/t;f.x=-e*Math.cos(i+T*a)*Math.sin(s+x*o),f.y=e*Math.cos(s+x*o),f.z=e*Math.sin(i+T*a)*Math.sin(s+x*o),p.push(f.x,f.y,f.z),h.copy(f).normalize(),m.push(h.x,h.y,h.z),g.push(T+b,1-x),_.push(u++)}c.push(_)}for(let v=0;v<r;v++)for(let _=0;_<t;_++){const x=c[v][_+1],b=c[v][_],S=c[v+1][_],T=c[v+1][_+1];(v!==0||s>0)&&d.push(x,b,T),(v!==r-1||l<Math.PI)&&d.push(b,S,T)}this.setIndex(d),this.setAttribute("position",new Ei(p,3)),this.setAttribute("normal",new Ei(m,3)),this.setAttribute("uv",new Ei(g,2))}static fromJSON(e){return new d7(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class lI extends Zo{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new gn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=YP,this.normalScale=new un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bd extends lI{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new un(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ca(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new gn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new gn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new gn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Vrt extends Zo{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new gn(16777215),this.specular=new gn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=YP,this.normalScale=new un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=KP,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Hrt extends lT{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Sc(n,e,t){return p7(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function sb(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function p7(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function YTe(n){function e(i,a){return n[i]-n[a]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function p5(n,e,t){const r=n.length,i=new n.constructor(r);for(let a=0,s=0;s!==r;++a){const o=t[a]*e;for(let l=0;l!==e;++l)i[s++]=n[o+l]}return i}function m7(n,e,t,r){let i=1,a=n[0];for(;a!==void 0&&a[r]===void 0;)a=n[i++];if(a===void 0)return;let s=a[r];if(s!==void 0)if(Array.isArray(s))do s=a[r],s!==void 0&&(e.push(a.time),t.push.apply(t,s)),a=n[i++];while(a!==void 0);else if(s.toArray!==void 0)do s=a[r],s!==void 0&&(e.push(a.time),s.toArray(t,t.length)),a=n[i++];while(a!==void 0);else do s=a[r],s!==void 0&&(e.push(a.time),t.push(s)),a=n[i++];while(a!==void 0)}class T_{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],a=t[r-1];e:{t:{let s;n:{r:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<a)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(a=i,i=t[++r],e<i)break t}s=t.length;break n}if(!(e>=a)){const o=t[1];e<o&&(r=2,a=o);for(let l=r-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=a,a=t[--r-1],e>=a)break t}s=r,r=0;break n}break e}for(;r<s;){const o=r+s>>>1;e<t[o]?s=o:r=o+1}if(i=t[r],a=t[r-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,i)}return this.interpolate_(r,a,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,a=e*i;for(let s=0;s!==i;++s)t[s]=r[a+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ZTe extends T_{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:g4,endingEnd:g4}}intervalChanged_(e,t,r){const i=this.parameterPositions;let a=e-2,s=e+1,o=i[a],l=i[s];if(o===void 0)switch(this.getSettings_().endingStart){case v4:a=e,o=2*t-r;break;case y4:a=i.length-2,o=t+i[a]-i[a+1];break;default:a=e,o=r}if(l===void 0)switch(this.getSettings_().endingEnd){case v4:s=e,l=2*r-t;break;case y4:s=1,l=r+i[1]-i[0];break;default:s=e-1,l=t}const u=(r-t)*.5,c=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(l-r),this._offsetPrev=a*c,this._offsetNext=s*c}interpolate_(e,t,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,l=e*o,u=l-o,c=this._offsetPrev,f=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-t)/(i-t),m=p*p,g=m*p,v=-h*g+2*h*m-h*p,_=(1+h)*g+(-1.5-2*h)*m+(-.5+h)*p+1,x=(-1-d)*g+(1.5+d)*m+.5*p,b=d*g-d*m;for(let S=0;S!==o;++S)a[S]=v*s[c+S]+_*s[u+S]+x*s[l+S]+b*s[f+S];return a}}class QTe extends T_{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,l=e*o,u=l-o,c=(r-t)/(i-t),f=1-c;for(let h=0;h!==o;++h)a[h]=s[u+h]*f+s[l+h]*c;return a}}class JTe extends T_{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class eu{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=sb(t,this.TimeBufferType),this.values=sb(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:sb(e.times,Array),values:sb(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new JTe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new QTe(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ZTe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case M0:t=this.InterpolantFactoryMethodDiscrete;break;case rg:t=this.InterpolantFactoryMethodLinear;break;case l2:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return M0;case this.InterpolantFactoryMethodLinear:return rg;case this.InterpolantFactoryMethodSmooth:return l2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let a=0,s=i-1;for(;a!==i&&r[a]<e;)++a;for(;s!==-1&&r[s]>t;)--s;if(++s,a!==0||s!==i){a>=s&&(s=Math.max(s,1),a=s-1);const o=this.getValueSize();this.times=Sc(r,a,s),this.values=Sc(this.values,a*o,s*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,a=r.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==a;o++){const l=r[o];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(s!==null&&s>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,s),e=!1;break}s=l}if(i!==void 0&&p7(i))for(let o=0,l=i.length;o!==l;++o){const u=i[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),e=!1;break}}return e}optimize(){const e=Sc(this.times),t=Sc(this.values),r=this.getValueSize(),i=this.getInterpolation()===l2,a=e.length-1;let s=1;for(let o=1;o<a;++o){let l=!1;const u=e[o],c=e[o+1];if(u!==c&&(o!==1||u!==e[0]))if(i)l=!0;else{const f=o*r,h=f-r,d=f+r;for(let p=0;p!==r;++p){const m=t[f+p];if(m!==t[h+p]||m!==t[d+p]){l=!0;break}}}if(l){if(o!==s){e[s]=e[o];const f=o*r,h=s*r;for(let d=0;d!==r;++d)t[h+d]=t[f+d]}++s}}if(a>0){e[s]=e[a];for(let o=a*r,l=s*r,u=0;u!==r;++u)t[l+u]=t[o+u];++s}return s!==e.length?(this.times=Sc(e,0,s),this.values=Sc(t,0,s*r)):(this.times=e,this.values=t),this}clone(){const e=Sc(this.times,0),t=Sc(this.values,0),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}eu.prototype.TimeBufferType=Float32Array;eu.prototype.ValueBufferType=Float32Array;eu.prototype.DefaultInterpolation=rg;class Fg extends eu{}Fg.prototype.ValueTypeName="bool";Fg.prototype.ValueBufferType=Array;Fg.prototype.DefaultInterpolation=M0;Fg.prototype.InterpolantFactoryMethodLinear=void 0;Fg.prototype.InterpolantFactoryMethodSmooth=void 0;class g7 extends eu{}g7.prototype.ValueTypeName="color";class D0 extends eu{}D0.prototype.ValueTypeName="number";class eCe extends T_{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,l=(r-t)/(i-t);let u=e*o;for(let c=u+o;u!==c;u+=4)Gl.slerpFlat(a,0,s,u-o,s,u,l);return a}}class gd extends eu{InterpolantFactoryMethodLinear(e){return new eCe(this.times,this.values,this.getValueSize(),e)}}gd.prototype.ValueTypeName="quaternion";gd.prototype.DefaultInterpolation=rg;gd.prototype.InterpolantFactoryMethodSmooth=void 0;class Bg extends eu{}Bg.prototype.ValueTypeName="string";Bg.prototype.ValueBufferType=Array;Bg.prototype.DefaultInterpolation=M0;Bg.prototype.InterpolantFactoryMethodLinear=void 0;Bg.prototype.InterpolantFactoryMethodSmooth=void 0;class L0 extends eu{}L0.prototype.ValueTypeName="vector";class tCe{constructor(e,t=-1,r,i=Sxe){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Yo(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let s=0,o=r.length;s!==o;++s)t.push(rCe(r[s]).scale(i));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,s=r.length;a!==s;++a)t.push(eu.toJSON(r[a]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const a=t.length,s=[];for(let o=0;o<a;o++){let l=[],u=[];l.push((o+a-1)%a,o,(o+1)%a),u.push(0,1,0);const c=YTe(l);l=p5(l,1,c),u=p5(u,1,c),!i&&l[0]===0&&(l.push(a),u.push(u[0])),s.push(new D0(".morphTargetInfluences["+t[o].name+"]",l,u).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},a=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const u=e[o],c=u.name.match(a);if(c&&c.length>1){const f=c[1];let h=i[f];h||(i[f]=h=[]),h.push(u)}}const s=[];for(const o in i)s.push(this.CreateFromMorphTargetSequence(o,i[o],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,h,d,p,m){if(d.length!==0){const g=[],v=[];m7(d,g,v,p),g.length!==0&&m.push(new f(h,g,v))}},i=[],a=e.name||"default",s=e.fps||30,o=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let f=0;f<u.length;f++){const h=u[f].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const d={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let m=0;m<h[p].morphTargets.length;m++)d[h[p].morphTargets[m]]=-1;for(const m in d){const g=[],v=[];for(let _=0;_!==h[p].morphTargets.length;++_){const x=h[p];g.push(x.time),v.push(x.morphTarget===m?1:0)}i.push(new D0(".morphTargetInfluence["+m+"]",g,v))}l=d.length*s}else{const d=".bones["+t[f].name+"]";r(L0,d+".position",h,"pos",i),r(gd,d+".quaternion",h,"rot",i),r(L0,d+".scale",h,"scl",i)}}return i.length===0?null:new this(a,l,i,o)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const a=this.tracks[r];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function nCe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return D0;case"vector":case"vector2":case"vector3":case"vector4":return L0;case"color":return g7;case"quaternion":return gd;case"bool":case"boolean":return Fg;case"string":return Bg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function rCe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=nCe(n.type);if(n.times===void 0){const t=[],r=[];m7(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ag={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class iCe{constructor(e,t,r){const i=this;let a=!1,s=0,o=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){o++,a===!1&&i.onStart!==void 0&&i.onStart(c,s,o),a=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,o),s===o&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,f){return u.push(c,f),this},this.removeHandler=function(c){const f=u.indexOf(c);return f!==-1&&u.splice(f,2),this},this.getHandler=function(c){for(let f=0,h=u.length;f<h;f+=2){const d=u[f],p=u[f+1];if(d.global&&(d.lastIndex=0),d.test(c))return p}return null}}}const aCe=new iCe;class Ug{constructor(e){this.manager=e!==void 0?e:aCe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,a){r.load(e,i,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const vu={};class sCe extends Error{constructor(e,t){super(e),this.response=t}}class v7 extends Ug{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=ag.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(vu[e]!==void 0){vu[e].push({onLoad:t,onProgress:r,onError:i});return}vu[e]=[],vu[e].push({onLoad:t,onProgress:r,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(s).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const c=vu[e],f=u.body.getReader(),h=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0;let m=0;const g=new ReadableStream({start(v){_();function _(){f.read().then(({done:x,value:b})=>{if(x)v.close();else{m+=b.byteLength;const S=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:d});for(let T=0,M=c.length;T<M;T++){const C=c[T];C.onProgress&&C.onProgress(S)}v.enqueue(b),_()}})}}});return new Response(g)}else throw new sCe(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return u.json();default:if(o===void 0)return u.text();{const f=/charset="?([^;"\s]*)"?/i.exec(o),h=f&&f[1]?f[1].toLowerCase():void 0,d=new TextDecoder(h);return u.arrayBuffer().then(p=>d.decode(p))}}}).then(u=>{ag.add(e,u);const c=vu[e];delete vu[e];for(let f=0,h=c.length;f<h;f++){const d=c[f];d.onLoad&&d.onLoad(u)}}).catch(u=>{const c=vu[e];if(c===void 0)throw this.manager.itemError(e),u;delete vu[e];for(let f=0,h=c.length;f<h;f++){const d=c[f];d.onError&&d.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class y7 extends Ug{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,s=ag.get(e);if(s!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(s),a.manager.itemEnd(e)},0),s;const o=P0("img");function l(){c(),ag.add(e,this),t&&t(this),a.manager.itemEnd(e)}function u(f){c(),i&&i(f),a.manager.itemError(e),a.manager.itemEnd(e)}function c(){o.removeEventListener("load",l,!1),o.removeEventListener("error",u,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),a.manager.itemStart(e),o.src=e,o}}class Wrt extends Ug{constructor(e){super(e)}load(e,t,r,i){const a=new eI,s=new y7(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function l(u){s.load(e[u],function(c){a.images[u]=c,o++,o===6&&(a.needsUpdate=!0,t&&t(a))},void 0,i)}for(let u=0;u<e.length;++u)l(u);return a}}class oCe extends Ug{constructor(e){super(e)}load(e,t,r,i){const a=new Ki,s=new y7(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(o){a.image=o,a.needsUpdate=!0,t!==void 0&&t(a)},r,i),a}}class uT extends Hr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new gn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class Grt extends uT{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Hr.DefaultUp),this.updateMatrix(),this.groundColor=new gn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const O2=new Un,m5=new De,g5=new De;class uI{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new un(512,512),this.map=null,this.mapPass=null,this.matrix=new Un,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tI,this._frameExtents=new un(1,1),this._viewportCount=1,this._viewports=[new Nr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;m5.setFromMatrixPosition(e.matrixWorld),t.position.copy(m5),g5.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(g5),t.updateMatrixWorld(),O2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(O2),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(O2)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class lCe extends uI{constructor(){super(new Za(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=R0*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(r!==t.fov||i!==t.aspect||a!==t.far)&&(t.fov=r,t.aspect=i,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class uCe extends uT{constructor(e,t,r=0,i=Math.PI/3,a=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Hr.DefaultUp),this.updateMatrix(),this.target=new Hr,this.distance=r,this.angle=i,this.penumbra=a,this.decay=s,this.map=null,this.shadow=new lCe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const v5=new Un,Dv=new De,$2=new De;class cCe extends uI{constructor(){super(new Za(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new un(4,2),this._viewportCount=6,this._viewports=[new Nr(2,1,1,1),new Nr(0,1,1,1),new Nr(3,1,1,1),new Nr(1,1,1,1),new Nr(3,0,1,1),new Nr(1,0,1,1)],this._cubeDirections=[new De(1,0,0),new De(-1,0,0),new De(0,0,1),new De(0,0,-1),new De(0,1,0),new De(0,-1,0)],this._cubeUps=[new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,1,0),new De(0,0,1),new De(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,a=e.distance||r.far;a!==r.far&&(r.far=a,r.updateProjectionMatrix()),Dv.setFromMatrixPosition(e.matrixWorld),r.position.copy(Dv),$2.copy(r.position),$2.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt($2),r.updateMatrixWorld(),i.makeTranslation(-Dv.x,-Dv.y,-Dv.z),v5.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(v5)}}class fCe extends uT{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new cCe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class hCe extends uI{constructor(){super(new sT(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class dCe extends uT{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Hr.DefaultUp),this.updateMatrix(),this.target=new Hr,this.shadow=new hCe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Jh{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class pCe extends Ug{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,s=ag.get(e);if(s!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(s),a.manager.itemEnd(e)},0),s;const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(l){ag.add(e,l),t&&t(l),a.manager.itemEnd(e)}).catch(function(l){i&&i(l),a.manager.itemError(e),a.manager.itemEnd(e)}),a.manager.itemStart(e)}}class mCe{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=y5(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=y5();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function y5(){return(typeof performance>"u"?Date:performance).now()}const cI="\\[\\]\\.:\\/",gCe=new RegExp("["+cI+"]","g"),fI="[^"+cI+"]",vCe="[^"+cI.replace("\\.","")+"]",yCe=/((?:WC+[\/:])*)/.source.replace("WC",fI),_Ce=/(WCOD+)?/.source.replace("WCOD",vCe),xCe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",fI),bCe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",fI),wCe=new RegExp("^"+yCe+_Ce+xCe+bCe+"$"),SCe=["material","materials","bones","map"];class TCe{constructor(e,t,r){const i=r||br.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=r.length;i!==a;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class br{constructor(e,t,r){this.path=t,this.parsedPath=r||br.parseTrackName(t),this.node=br.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new br.Composite(e,t,r):new br(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(gCe,"")}static parseTrackName(e){const t=wCe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const a=r.nodeName.substring(i+1);SCe.indexOf(a)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=a)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(a){for(let s=0;s<a.length;s++){const o=a[s];if(o.name===t||o.uuid===t)return o;const l=r(o.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,a=r.length;i!==a;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let a=t.propertyIndex;if(e||(e=br.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const s=e[i];if(s===void 0){const u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(a!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=a}else s.fromArray!==void 0&&s.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}br.Composite=TCe;br.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};br.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};br.prototype.GetterByBindingType=[br.prototype._getValue_direct,br.prototype._getValue_array,br.prototype._getValue_arrayElement,br.prototype._getValue_toArray];br.prototype.SetterByBindingTypeAndVersioning=[[br.prototype._setValue_direct,br.prototype._setValue_direct_setNeedsUpdate,br.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[br.prototype._setValue_array,br.prototype._setValue_array_setNeedsUpdate,br.prototype._setValue_array_setMatrixWorldNeedsUpdate],[br.prototype._setValue_arrayElement,br.prototype._setValue_arrayElement_setNeedsUpdate,br.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[br.prototype._setValue_fromArray,br.prototype._setValue_fromArray_setNeedsUpdate,br.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class jrt{constructor(e,t,r=0,i=1/0){this.ray=new aT(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new QP,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return kM(e,this,r,t),r.sort(_5),r}intersectObjects(e,t=!0,r=[]){for(let i=0,a=e.length;i<a;i++)kM(e[i],this,r,t);return r.sort(_5),r}}function _5(n,e){return n.distance-e.distance}function kM(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let a=0,s=i.length;a<s;a++)kM(i[a],e,t,!0)}}class x5{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(ca(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const CCe=new De,b5=new gn,w5=new gn;class qrt extends Hr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new oI(t);i.rotateY(Math.PI*.5),this.material=new jc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=i.getAttribute("position"),s=new Float32Array(a.count*3);i.setAttribute("color",new Yi(s,3)),this.add(new ns(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");b5.copy(this.light.color),w5.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const a=r<i/2?b5:w5;t.setXYZ(r,a.r,a.g,a.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(CCe.setFromMatrixPosition(this.light.matrixWorld).negate())}}const S5=new De,ob=new De,T5=new De;class Xrt extends Hr{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new xa;i.setAttribute("position",new Ei([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new lT({fog:!1,toneMapped:!1});this.lightPlane=new I0(i,a),this.add(this.lightPlane),i=new xa,i.setAttribute("position",new Ei([0,0,0,0,0,1],3)),this.targetLine=new I0(i,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),S5.setFromMatrixPosition(this.light.matrixWorld),ob.setFromMatrixPosition(this.light.target.matrixWorld),T5.subVectors(ob,S5),this.lightPlane.lookAt(ob),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ob),this.targetLine.scale.z=T5.length()}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:XP}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=XP);const C5={type:"change"},F2={type:"start"},E5={type:"end"};class Krt extends Fd{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new De,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:pp.ROTATE,MIDDLE:pp.DOLLY,RIGHT:pp.PAN},this.touches={ONE:mp.ROTATE,TWO:mp.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ye){ye.addEventListener("keydown",Ke),this._domElementKeyEvents=ye},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(C5),r.update(),a=i.NONE},this.update=function(){const ye=new De,$e=new Gl().setFromUnitVectors(e.up,new De(0,1,0)),vt=$e.clone().invert(),bt=new De,dt=new Gl,$t=2*Math.PI;return function(){const Kt=r.object.position;ye.copy(Kt).sub(r.target),ye.applyQuaternion($e),o.setFromVector3(ye),r.autoRotate&&a===i.NONE&&k(M()),r.enableDamping?(o.theta+=l.theta*r.dampingFactor,o.phi+=l.phi*r.dampingFactor):(o.theta+=l.theta,o.phi+=l.phi);let Vt=r.minAzimuthAngle,Ft=r.maxAzimuthAngle;return isFinite(Vt)&&isFinite(Ft)&&(Vt<-Math.PI?Vt+=$t:Vt>Math.PI&&(Vt-=$t),Ft<-Math.PI?Ft+=$t:Ft>Math.PI&&(Ft-=$t),Vt<=Ft?o.theta=Math.max(Vt,Math.min(Ft,o.theta)):o.theta=o.theta>(Vt+Ft)/2?Math.max(Vt,o.theta):Math.min(Ft,o.theta)),o.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=u,o.radius=Math.max(r.minDistance,Math.min(r.maxDistance,o.radius)),r.enableDamping===!0?r.target.addScaledVector(c,r.dampingFactor):r.target.add(c),ye.setFromSpherical(o),ye.applyQuaternion(vt),Kt.copy(r.target).add(ye),r.object.lookAt(r.target),r.enableDamping===!0?(l.theta*=1-r.dampingFactor,l.phi*=1-r.dampingFactor,c.multiplyScalar(1-r.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),u=1,f||bt.distanceToSquared(r.object.position)>s||8*(1-dt.dot(r.object.quaternion))>s?(r.dispatchEvent(C5),bt.copy(r.object.position),dt.copy(r.object.quaternion),f=!1,!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",fe),r.domElement.removeEventListener("pointerdown",xe),r.domElement.removeEventListener("pointercancel",Ze),r.domElement.removeEventListener("wheel",ve),r.domElement.removeEventListener("pointermove",Ve),r.domElement.removeEventListener("pointerup",Ge),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",Ke)};const r=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=i.NONE;const s=1e-6,o=new x5,l=new x5;let u=1;const c=new De;let f=!1;const h=new un,d=new un,p=new un,m=new un,g=new un,v=new un,_=new un,x=new un,b=new un,S=[],T={};function M(){return 2*Math.PI/60/60*r.autoRotateSpeed}function C(){return Math.pow(.95,r.zoomSpeed)}function k(ye){l.theta-=ye}function R(ye){l.phi-=ye}const P=function(){const ye=new De;return function(vt,bt){ye.setFromMatrixColumn(bt,0),ye.multiplyScalar(-vt),c.add(ye)}}(),N=function(){const ye=new De;return function(vt,bt){r.screenSpacePanning===!0?ye.setFromMatrixColumn(bt,1):(ye.setFromMatrixColumn(bt,0),ye.crossVectors(r.object.up,ye)),ye.multiplyScalar(vt),c.add(ye)}}(),L=function(){const ye=new De;return function(vt,bt){const dt=r.domElement;if(r.object.isPerspectiveCamera){const $t=r.object.position;ye.copy($t).sub(r.target);let Ct=ye.length();Ct*=Math.tan(r.object.fov/2*Math.PI/180),P(2*vt*Ct/dt.clientHeight,r.object.matrix),N(2*bt*Ct/dt.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(P(vt*(r.object.right-r.object.left)/r.object.zoom/dt.clientWidth,r.object.matrix),N(bt*(r.object.top-r.object.bottom)/r.object.zoom/dt.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function F(ye){r.object.isPerspectiveCamera?u/=ye:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*ye)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function O(ye){r.object.isPerspectiveCamera?u*=ye:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/ye)),r.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function B(ye){h.set(ye.clientX,ye.clientY)}function H(ye){_.set(ye.clientX,ye.clientY)}function j(ye){m.set(ye.clientX,ye.clientY)}function K(ye){d.set(ye.clientX,ye.clientY),p.subVectors(d,h).multiplyScalar(r.rotateSpeed);const $e=r.domElement;k(2*Math.PI*p.x/$e.clientHeight),R(2*Math.PI*p.y/$e.clientHeight),h.copy(d),r.update()}function J(ye){x.set(ye.clientX,ye.clientY),b.subVectors(x,_),b.y>0?F(C()):b.y<0&&O(C()),_.copy(x),r.update()}function re(ye){g.set(ye.clientX,ye.clientY),v.subVectors(g,m).multiplyScalar(r.panSpeed),L(v.x,v.y),m.copy(g),r.update()}function se(ye){ye.deltaY<0?O(C()):ye.deltaY>0&&F(C()),r.update()}function Ae(ye){let $e=!1;switch(ye.code){case r.keys.UP:ye.ctrlKey||ye.metaKey||ye.shiftKey?R(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(0,r.keyPanSpeed),$e=!0;break;case r.keys.BOTTOM:ye.ctrlKey||ye.metaKey||ye.shiftKey?R(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(0,-r.keyPanSpeed),$e=!0;break;case r.keys.LEFT:ye.ctrlKey||ye.metaKey||ye.shiftKey?k(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(r.keyPanSpeed,0),$e=!0;break;case r.keys.RIGHT:ye.ctrlKey||ye.metaKey||ye.shiftKey?k(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(-r.keyPanSpeed,0),$e=!0;break}$e&&(ye.preventDefault(),r.update())}function Ee(){if(S.length===1)h.set(S[0].pageX,S[0].pageY);else{const ye=.5*(S[0].pageX+S[1].pageX),$e=.5*(S[0].pageY+S[1].pageY);h.set(ye,$e)}}function Ne(){if(S.length===1)m.set(S[0].pageX,S[0].pageY);else{const ye=.5*(S[0].pageX+S[1].pageX),$e=.5*(S[0].pageY+S[1].pageY);m.set(ye,$e)}}function we(){const ye=S[0].pageX-S[1].pageX,$e=S[0].pageY-S[1].pageY,vt=Math.sqrt(ye*ye+$e*$e);_.set(0,vt)}function me(){r.enableZoom&&we(),r.enablePan&&Ne()}function Se(){r.enableZoom&&we(),r.enableRotate&&Ee()}function Me(ye){if(S.length==1)d.set(ye.pageX,ye.pageY);else{const vt=mt(ye),bt=.5*(ye.pageX+vt.x),dt=.5*(ye.pageY+vt.y);d.set(bt,dt)}p.subVectors(d,h).multiplyScalar(r.rotateSpeed);const $e=r.domElement;k(2*Math.PI*p.x/$e.clientHeight),R(2*Math.PI*p.y/$e.clientHeight),h.copy(d)}function ke(ye){if(S.length===1)g.set(ye.pageX,ye.pageY);else{const $e=mt(ye),vt=.5*(ye.pageX+$e.x),bt=.5*(ye.pageY+$e.y);g.set(vt,bt)}v.subVectors(g,m).multiplyScalar(r.panSpeed),L(v.x,v.y),m.copy(g)}function He(ye){const $e=mt(ye),vt=ye.pageX-$e.x,bt=ye.pageY-$e.y,dt=Math.sqrt(vt*vt+bt*bt);x.set(0,dt),b.set(0,Math.pow(x.y/_.y,r.zoomSpeed)),F(b.y),_.copy(x)}function ee(ye){r.enableZoom&&He(ye),r.enablePan&&ke(ye)}function ie(ye){r.enableZoom&&He(ye),r.enableRotate&&Me(ye)}function xe(ye){r.enabled!==!1&&(S.length===0&&(r.domElement.setPointerCapture(ye.pointerId),r.domElement.addEventListener("pointermove",Ve),r.domElement.addEventListener("pointerup",Ge)),Be(ye),ye.pointerType==="touch"?ne(ye):ut(ye))}function Ve(ye){r.enabled!==!1&&(ye.pointerType==="touch"?Z(ye):Qe(ye))}function Ge(ye){Xe(ye),S.length===0&&(r.domElement.releasePointerCapture(ye.pointerId),r.domElement.removeEventListener("pointermove",Ve),r.domElement.removeEventListener("pointerup",Ge)),r.dispatchEvent(E5),a=i.NONE}function Ze(ye){Xe(ye)}function ut(ye){let $e;switch(ye.button){case 0:$e=r.mouseButtons.LEFT;break;case 1:$e=r.mouseButtons.MIDDLE;break;case 2:$e=r.mouseButtons.RIGHT;break;default:$e=-1}switch($e){case pp.DOLLY:if(r.enableZoom===!1)return;H(ye),a=i.DOLLY;break;case pp.ROTATE:if(ye.ctrlKey||ye.metaKey||ye.shiftKey){if(r.enablePan===!1)return;j(ye),a=i.PAN}else{if(r.enableRotate===!1)return;B(ye),a=i.ROTATE}break;case pp.PAN:if(ye.ctrlKey||ye.metaKey||ye.shiftKey){if(r.enableRotate===!1)return;B(ye),a=i.ROTATE}else{if(r.enablePan===!1)return;j(ye),a=i.PAN}break;default:a=i.NONE}a!==i.NONE&&r.dispatchEvent(F2)}function Qe(ye){switch(a){case i.ROTATE:if(r.enableRotate===!1)return;K(ye);break;case i.DOLLY:if(r.enableZoom===!1)return;J(ye);break;case i.PAN:if(r.enablePan===!1)return;re(ye);break}}function ve(ye){r.enabled===!1||r.enableZoom===!1||a!==i.NONE||(ye.preventDefault(),r.dispatchEvent(F2),se(ye),r.dispatchEvent(E5))}function Ke(ye){r.enabled===!1||r.enablePan===!1||Ae(ye)}function ne(ye){switch(st(ye),S.length){case 1:switch(r.touches.ONE){case mp.ROTATE:if(r.enableRotate===!1)return;Ee(),a=i.TOUCH_ROTATE;break;case mp.PAN:if(r.enablePan===!1)return;Ne(),a=i.TOUCH_PAN;break;default:a=i.NONE}break;case 2:switch(r.touches.TWO){case mp.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;me(),a=i.TOUCH_DOLLY_PAN;break;case mp.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Se(),a=i.TOUCH_DOLLY_ROTATE;break;default:a=i.NONE}break;default:a=i.NONE}a!==i.NONE&&r.dispatchEvent(F2)}function Z(ye){switch(st(ye),a){case i.TOUCH_ROTATE:if(r.enableRotate===!1)return;Me(ye),r.update();break;case i.TOUCH_PAN:if(r.enablePan===!1)return;ke(ye),r.update();break;case i.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ee(ye),r.update();break;case i.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;ie(ye),r.update();break;default:a=i.NONE}}function fe(ye){r.enabled!==!1&&ye.preventDefault()}function Be(ye){S.push(ye)}function Xe(ye){delete T[ye.pointerId];for(let $e=0;$e<S.length;$e++)if(S[$e].pointerId==ye.pointerId){S.splice($e,1);return}}function st(ye){let $e=T[ye.pointerId];$e===void 0&&($e=new un,T[ye.pointerId]=$e),$e.set(ye.pageX,ye.pageY)}function mt(ye){const $e=ye.pointerId===S[0].pointerId?S[1]:S[0];return T[$e.pointerId]}r.domElement.addEventListener("contextmenu",fe),r.domElement.addEventListener("pointerdown",xe),r.domElement.addEventListener("pointercancel",Ze),r.domElement.addEventListener("wheel",ve,{passive:!1}),this.update()}}class Yrt extends Ug{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new RCe(t)}),this.register(function(t){return new $Ce(t)}),this.register(function(t){return new FCe(t)}),this.register(function(t){return new ICe(t)}),this.register(function(t){return new DCe(t)}),this.register(function(t){return new LCe(t)}),this.register(function(t){return new NCe(t)}),this.register(function(t){return new kCe(t)}),this.register(function(t){return new OCe(t)}),this.register(function(t){return new PCe(t)}),this.register(function(t){return new ACe(t)}),this.register(function(t){return new BCe(t)}),this.register(function(t){return new UCe(t)})}load(e,t,r,i){const a=this;let s;this.resourcePath!==""?s=this.resourcePath:this.path!==""?s=this.path:s=Jh.extractUrlBase(e),this.manager.itemStart(e);const o=function(u){i?i(u):console.error(u),a.manager.itemError(e),a.manager.itemEnd(e)},l=new v7(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(u){try{a.parse(u,s,function(c){t(c),a.manager.itemEnd(e)},o)}catch(c){o(c)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let a;const s={},o={};if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Jh.decodeText(new Uint8Array(e,0,4))===_7){try{s[rr.KHR_BINARY_GLTF]=new zCe(e)}catch(c){i&&i(c);return}a=JSON.parse(s[rr.KHR_BINARY_GLTF].content)}else a=JSON.parse(Jh.decodeText(new Uint8Array(e)));else a=e;if(a.asset===void 0||a.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new e2e(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const c=this.pluginCallbacks[u](l);o[c.name]=c,s[c.name]=!0}if(a.extensionsUsed)for(let u=0;u<a.extensionsUsed.length;++u){const c=a.extensionsUsed[u],f=a.extensionsRequired||[];switch(c){case rr.KHR_MATERIALS_UNLIT:s[c]=new MCe;break;case rr.KHR_DRACO_MESH_COMPRESSION:s[c]=new VCe(a,this.dracoLoader);break;case rr.KHR_TEXTURE_TRANSFORM:s[c]=new HCe;break;case rr.KHR_MESH_QUANTIZATION:s[c]=new WCe;break;default:f.indexOf(c)>=0&&o[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}l.setExtensions(s),l.setPlugins(o),l.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,a){r.parse(e,t,i,a)})}}function ECe(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const rr={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ACe{constructor(e){this.parser=e,this.name=rr.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const a=t[r];a.extensions&&a.extensions[this.name]&&a.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const a=t.json,l=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let u;const c=new gn(16777215);l.color!==void 0&&c.fromArray(l.color);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":u=new dCe(c),u.target.position.set(0,0,-1),u.add(u.target);break;case"point":u=new fCe(c),u.distance=f;break;case"spot":u=new uCe(c),u.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,u.angle=l.spot.outerConeAngle,u.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,u.target.position.set(0,0,-1),u.add(u.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return u.position.set(0,0,0),u.decay=2,Uc(u,l),l.intensity!==void 0&&(u.intensity=l.intensity),u.name=t.createUniqueName(l.name||"light_"+e),i=Promise.resolve(u),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,a=r.json.nodes[e],o=(a.extensions&&a.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(l){return r._getNodeRef(t.cache,o,l)})}}class MCe{constructor(){this.name=rr.KHR_MATERIALS_UNLIT}getMaterialType(){return jc}extendParams(e,t,r){const i=[];e.color=new gn(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const s=a.baseColorFactor;e.color.fromArray(s),e.opacity=s[3]}a.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",a.baseColorTexture,fr))}return Promise.all(i)}}class kCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name].emissiveStrength;return a!==void 0&&(t.emissiveIntensity=a),Promise.resolve()}}class RCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],s=i.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&a.push(r.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&a.push(r.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(a.push(r.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){const o=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new un(o,o)}return Promise.all(a)}}class PCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],s=i.extensions[this.name];return s.iridescenceFactor!==void 0&&(t.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&a.push(r.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(t.iridescenceIOR=s.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&a.push(r.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(a)}}class ICe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new gn(0,0,0),t.sheenRoughness=0,t.sheen=1;const s=i.extensions[this.name];return s.sheenColorFactor!==void 0&&t.sheenColor.fromArray(s.sheenColorFactor),s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&a.push(r.assignTexture(t,"sheenColorMap",s.sheenColorTexture,fr)),s.sheenRoughnessTexture!==void 0&&a.push(r.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(a)}}class DCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],s=i.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&a.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(a)}}class LCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],s=i.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&a.push(r.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;const o=s.attenuationColor||[1,1,1];return t.attenuationColor=new gn(o[0],o[1],o[2]),Promise.all(a)}}class NCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name];return t.ior=a.ior!==void 0?a.ior:1.5,Promise.resolve()}}class OCe{constructor(e){this.parser=e,this.name=rr.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Bd}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],s=i.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&a.push(r.assignTexture(t,"specularIntensityMap",s.specularTexture));const o=s.specularColorFactor||[1,1,1];return t.specularColor=new gn(o[0],o[1],o[2]),s.specularColorTexture!==void 0&&a.push(r.assignTexture(t,"specularColorMap",s.specularColorTexture,fr)),Promise.all(a)}}class $Ce{constructor(e){this.parser=e,this.name=rr.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const a=i.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,s)}}class FCe{constructor(e){this.parser=e,this.name=rr.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const s=a.extensions[t],o=i.images[s.source];let l=r.textureLoader;if(o.uri){const u=r.options.manager.getHandler(o.uri);u!==null&&(l=u)}return this.detectSupport().then(function(u){if(u)return r.loadTextureImage(e,s.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class BCe{constructor(e){this.name=rr.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],a=this.parser.getDependency("buffer",i.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(o){const l=i.byteOffset||0,u=i.byteLength||0,c=i.count,f=i.byteStride,h=new Uint8Array(o,l,u);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(c,f,h,i.mode,i.filter).then(function(d){return d.buffer}):s.ready.then(function(){const d=new ArrayBuffer(c*f);return s.decodeGltfBuffer(new Uint8Array(d),c,f,h,i.mode,i.filter),d})})}else return null}}class UCe{constructor(e){this.name=rr.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const u of i.primitives)if(u.mode!==Ws.TRIANGLES&&u.mode!==Ws.TRIANGLE_STRIP&&u.mode!==Ws.TRIANGLE_FAN&&u.mode!==void 0)return null;const s=r.extensions[this.name].attributes,o=[],l={};for(const u in s)o.push(this.parser.getDependency("accessor",s[u]).then(c=>(l[u]=c,l[u])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(u=>{const c=u.pop(),f=c.isGroup?c.children:[c],h=u[0].count,d=[];for(const p of f){const m=new Un,g=new De,v=new Gl,_=new De(1,1,1),x=new jTe(p.geometry,p.material,h);for(let b=0;b<h;b++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&v.fromBufferAttribute(l.ROTATION,b),l.SCALE&&_.fromBufferAttribute(l.SCALE,b),x.setMatrixAt(b,m.compose(g,v,_));for(const b in l)b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&p.geometry.setAttribute(b,l[b]);Hr.prototype.copy.call(x,p),x.frustumCulled=!1,this.parser.assignFinalMaterial(x),d.push(x)}return c.isGroup?(c.clear(),c.add(...d),c):d[0]}))}}const _7="glTF",Lv=12,A5={JSON:1313821514,BIN:5130562};class zCe{constructor(e){this.name=rr.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Lv);if(this.header={magic:Jh.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==_7)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Lv,i=new DataView(e,Lv);let a=0;for(;a<r;){const s=i.getUint32(a,!0);a+=4;const o=i.getUint32(a,!0);if(a+=4,o===A5.JSON){const l=new Uint8Array(e,Lv+a,s);this.content=Jh.decodeText(l)}else if(o===A5.BIN){const l=Lv+a;this.body=e.slice(l,l+s)}a+=s}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class VCe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=rr.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,a=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,o={},l={},u={};for(const c in s){const f=RM[c]||c.toLowerCase();o[f]=s[c]}for(const c in e.attributes){const f=RM[c]||c.toLowerCase();if(s[c]!==void 0){const h=r.accessors[e.attributes[c]],d=km[h.componentType];u[f]=d.name,l[f]=h.normalized===!0}}return t.getDependency("bufferView",a).then(function(c){return new Promise(function(f){i.decodeDracoFile(c,function(h){for(const d in h.attributes){const p=h.attributes[d],m=l[d];m!==void 0&&(p.normalized=m)}f(h)},o,u)})})}}class HCe{constructor(){this.name=rr.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class WCe{constructor(){this.name=rr.KHR_MESH_QUANTIZATION}}class x7 extends T_{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,a=e*i*3+i;for(let s=0;s!==i;s++)t[s]=r[a+s];return t}interpolate_(e,t,r,i){const a=this.resultBuffer,s=this.sampleValues,o=this.valueSize,l=o*2,u=o*3,c=i-t,f=(r-t)/c,h=f*f,d=h*f,p=e*u,m=p-u,g=-2*d+3*h,v=d-h,_=1-g,x=v-h+f;for(let b=0;b!==o;b++){const S=s[m+b+o],T=s[m+b+l]*c,M=s[p+b+o],C=s[p+b]*c;a[b]=_*S+x*T+g*M+v*C}return a}}const GCe=new Gl;class jCe extends x7{interpolate_(e,t,r,i){const a=super.interpolate_(e,t,r,i);return GCe.fromArray(a).normalize().toArray(a),a}}const Ws={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},km={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M5={9728:Ni,9729:Ya,9984:SM,9985:Wj,9986:B1,9987:dd},k5={33071:Js,33648:bw,10497:tg},B2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},RM={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Tc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},qCe={CUBICSPLINE:void 0,LINEAR:rg,STEP:M0},U2={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function XCe(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new lI({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:cf})),n.DefaultMaterial}function Nv(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function Uc(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function KCe(n,e,t){let r=!1,i=!1,a=!1;for(let u=0,c=e.length;u<c;u++){const f=e[u];if(f.POSITION!==void 0&&(r=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(a=!0),r&&i&&a)break}if(!r&&!i&&!a)return Promise.resolve(n);const s=[],o=[],l=[];for(let u=0,c=e.length;u<c;u++){const f=e[u];if(r){const h=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):n.attributes.position;s.push(h)}if(i){const h=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):n.attributes.normal;o.push(h)}if(a){const h=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(h)}}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(l)]).then(function(u){const c=u[0],f=u[1],h=u[2];return r&&(n.morphAttributes.position=c),i&&(n.morphAttributes.normal=f),a&&(n.morphAttributes.color=h),n.morphTargetsRelative=!0,n})}function YCe(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ZCe(n){const e=n.extensions&&n.extensions[rr.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+R5(e.attributes):t=n.indices+":"+R5(n.attributes)+":"+n.mode,t}function R5(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function PM(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function QCe(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const JCe=new Un;class e2e{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new ECe,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,a=-1;typeof navigator<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,a=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&a<98?this.textureLoader=new oCe(this.options.manager):this.textureLoader=new pCe(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new v7(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(s){const o={scene:s[0][i.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:i.asset,parser:r,userData:{}};Nv(a,o,i),Uc(o,i),Promise.all(r._invokeAll(function(l){return l.afterRoot&&l.afterRoot(o)})).then(function(){e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,a=t.length;i<a;i++){const s=t[i].joints;for(let o=0,l=s.length;o<l;o++)e[s[o]].isBone=!0}for(let i=0,a=e.length;i<a;i++){const s=e[i];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(r[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),a=(s,o)=>{const l=this.associations.get(s);l!=null&&this.associations.set(o,l);for(const[u,c]of s.children.entries())a(c,o.children[u])};return a(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const a=e(t[i]);a&&r.push(a)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(a){return a.loadNode&&a.loadNode(t)});break;case"mesh":i=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(a,s){return r.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[rr.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(a,s){r.load(Jh.resolveURL(t.uri,i.path),a,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,a=t.byteOffset||0;return r.slice(a,a+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const s=B2[i.type],o=km[i.componentType],l=i.normalized===!0,u=new o(i.count*s);return Promise.resolve(new Yi(u,s,l))}const a=[];return i.bufferView!==void 0?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),i.sparse!==void 0&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(s){const o=s[0],l=B2[i.type],u=km[i.componentType],c=u.BYTES_PER_ELEMENT,f=c*l,h=i.byteOffset||0,d=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,p=i.normalized===!0;let m,g;if(d&&d!==f){const v=Math.floor(h/d),_="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+v+":"+i.count;let x=t.cache.get(_);x||(m=new u(o,v*d,i.count*d/c),x=new zTe(m,d/c),t.cache.add(_,x)),g=new iI(x,l,h%d/c,p)}else o===null?m=new u(i.count*l):m=new u(o,h,i.count*l),g=new Yi(m,l,p);if(i.sparse!==void 0){const v=B2.SCALAR,_=km[i.sparse.indices.componentType],x=i.sparse.indices.byteOffset||0,b=i.sparse.values.byteOffset||0,S=new _(s[1],x,i.sparse.count*v),T=new u(s[2],b,i.sparse.count*l);o!==null&&(g=new Yi(g.array.slice(),g.itemSize,g.normalized));for(let M=0,C=S.length;M<C;M++){const k=S[M];if(g.setX(k,T[M*l]),l>=2&&g.setY(k,T[M*l+1]),l>=3&&g.setZ(k,T[M*l+2]),l>=4&&g.setW(k,T[M*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,r=this.options,a=t.textures[e].source,s=t.images[a];let o=this.textureLoader;if(s.uri){const l=r.manager.getHandler(s.uri);l!==null&&(o=l)}return this.loadTextureImage(e,a,o)}loadTextureImage(e,t,r){const i=this,a=this.json,s=a.textures[e],o=a.images[t],l=(o.uri||o.bufferView)+":"+s.sampler;if(this.textureCache[l])return this.textureCache[l];const u=this.loadImageSource(t,r).then(function(c){c.flipY=!1,c.name=s.name||o.name||"";const h=(a.samplers||{})[s.sampler]||{};return c.magFilter=M5[h.magFilter]||Ya,c.minFilter=M5[h.minFilter]||dd,c.wrapS=k5[h.wrapS]||tg,c.wrapT=k5[h.wrapT]||tg,i.associations.set(c,{textures:e}),c}).catch(function(){return null});return this.textureCache[l]=u,u}loadImageSource(e,t){const r=this,i=this.json,a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const s=i.images[e],o=self.URL||self.webkitURL;let l=s.uri||"",u=!1;if(s.bufferView!==void 0)l=r.getDependency("bufferView",s.bufferView).then(function(f){u=!0;const h=new Blob([f],{type:s.mimeType});return l=o.createObjectURL(h),l});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then(function(f){return new Promise(function(h,d){let p=h;t.isImageBitmapLoader===!0&&(p=function(m){const g=new Ki(m);g.needsUpdate=!0,h(g)}),t.load(Jh.resolveURL(f,a.path),p,void 0,d)})}).then(function(f){return u===!0&&o.revokeObjectURL(l),f.userData.mimeType=s.mimeType||QCe(s.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=c,c}assignTexture(e,t,r,i){const a=this;return this.getDependency("texture",r.index).then(function(s){if(!s)return null;if(r.texCoord!==void 0&&r.texCoord!=0&&!(t==="aoMap"&&r.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),a.extensions[rr.KHR_TEXTURE_TRANSFORM]){const o=r.extensions!==void 0?r.extensions[rr.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const l=a.associations.get(s);s=a.extensions[rr.KHR_TEXTURE_TRANSFORM].extendTexture(s,o),a.associations.set(s,l)}}return i!==void 0&&(s.encoding=i),e[t]=s,s})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,a=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+r.uuid;let l=this.cache.get(o);l||(l=new h7,Zo.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(o,l)),r=l}else if(e.isLine){const o="LineBasicMaterial:"+r.uuid;let l=this.cache.get(o);l||(l=new lT,Zo.prototype.copy.call(l,r),l.color.copy(r.color),this.cache.add(o,l)),r=l}if(i||a||s){let o="ClonedMaterial:"+r.uuid+":";i&&(o+="derivative-tangents:"),a&&(o+="vertex-colors:"),s&&(o+="flat-shading:");let l=this.cache.get(o);l||(l=r.clone(),a&&(l.vertexColors=!0),s&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(o,l),this.associations.set(l,this.associations.get(r))),r=l}r.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=r}getMaterialType(){return lI}loadMaterial(e){const t=this,r=this.json,i=this.extensions,a=r.materials[e];let s;const o={},l=a.extensions||{},u=[];if(l[rr.KHR_MATERIALS_UNLIT]){const f=i[rr.KHR_MATERIALS_UNLIT];s=f.getMaterialType(),u.push(f.extendParams(o,a,t))}else{const f=a.pbrMetallicRoughness||{};if(o.color=new gn(1,1,1),o.opacity=1,Array.isArray(f.baseColorFactor)){const h=f.baseColorFactor;o.color.fromArray(h),o.opacity=h[3]}f.baseColorTexture!==void 0&&u.push(t.assignTexture(o,"map",f.baseColorTexture,fr)),o.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,o.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(u.push(t.assignTexture(o,"metalnessMap",f.metallicRoughnessTexture)),u.push(t.assignTexture(o,"roughnessMap",f.metallicRoughnessTexture))),s=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,o)})))}a.doubleSided===!0&&(o.side=rT);const c=a.alphaMode||U2.OPAQUE;if(c===U2.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,c===U2.MASK&&(o.alphaTest=a.alphaCutoff!==void 0?a.alphaCutoff:.5)),a.normalTexture!==void 0&&s!==jc&&(u.push(t.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new un(1,1),a.normalTexture.scale!==void 0)){const f=a.normalTexture.scale;o.normalScale.set(f,f)}return a.occlusionTexture!==void 0&&s!==jc&&(u.push(t.assignTexture(o,"aoMap",a.occlusionTexture)),a.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=a.occlusionTexture.strength)),a.emissiveFactor!==void 0&&s!==jc&&(o.emissive=new gn().fromArray(a.emissiveFactor)),a.emissiveTexture!==void 0&&s!==jc&&u.push(t.assignTexture(o,"emissiveMap",a.emissiveTexture,fr)),Promise.all(u).then(function(){const f=new s(o);return a.name&&(f.name=a.name),Uc(f,a),t.associations.set(f,{materials:e}),a.extensions&&Nv(i,f,a),f})}createUniqueName(e){const t=br.sanitizeNodeName(e||"");let r=t;for(let i=1;this.nodeNamesUsed[r];++i)r=t+"_"+i;return this.nodeNamesUsed[r]=!0,r}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function a(o){return r[rr.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(l){return P5(l,o,t)})}const s=[];for(let o=0,l=e.length;o<l;o++){const u=e[o],c=ZCe(u),f=i[c];if(f)s.push(f.promise);else{let h;u.extensions&&u.extensions[rr.KHR_DRACO_MESH_COMPRESSION]?h=a(u):h=P5(new xa,u,t),i[c]={primitive:u,promise:h},s.push(h)}}return Promise.all(s)}loadMesh(e){const t=this,r=this.json,i=this.extensions,a=r.meshes[e],s=a.primitives,o=[];for(let l=0,u=s.length;l<u;l++){const c=s[l].material===void 0?XCe(this.cache):this.getDependency("material",s[l].material);o.push(c)}return o.push(t.loadGeometries(s)),Promise.all(o).then(function(l){const u=l.slice(0,l.length-1),c=l[l.length-1],f=[];for(let d=0,p=c.length;d<p;d++){const m=c[d],g=s[d];let v;const _=u[d];if(g.mode===Ws.TRIANGLES||g.mode===Ws.TRIANGLE_STRIP||g.mode===Ws.TRIANGLE_FAN||g.mode===void 0)v=a.isSkinnedMesh===!0?new HTe(m,_):new ns(m,_),v.isSkinnedMesh===!0&&!v.geometry.attributes.skinWeight.normalized&&v.normalizeSkinWeights(),g.mode===Ws.TRIANGLE_STRIP?v.geometry=I5(v.geometry,Txe):g.mode===Ws.TRIANGLE_FAN&&(v.geometry=I5(v.geometry,Xj));else if(g.mode===Ws.LINES)v=new qTe(m,_);else if(g.mode===Ws.LINE_STRIP)v=new I0(m,_);else if(g.mode===Ws.LINE_LOOP)v=new XTe(m,_);else if(g.mode===Ws.POINTS)v=new KTe(m,_);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(v.geometry.morphAttributes).length>0&&YCe(v,a),v.name=t.createUniqueName(a.name||"mesh_"+e),Uc(v,a),g.extensions&&Nv(i,v,g),t.assignFinalMaterial(v),f.push(v)}for(let d=0,p=f.length;d<p;d++)t.associations.set(f[d],{meshes:e,primitives:d});if(f.length===1)return f[0];const h=new Uh;t.associations.set(h,{meshes:e});for(let d=0,p=f.length;d<p;d++)h.add(f[d]);return h})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new Za(bs.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new sT(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Uc(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,a=t.joints.length;i<a;i++)r.push(this.getDependency("node",t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const a=i.pop(),s=i,o=[],l=[];for(let u=0,c=s.length;u<c;u++){const f=s[u];if(f){o.push(f);const h=new Un;a!==null&&h.fromArray(a.array,u*16),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[u])}return new aI(o,l)})}loadAnimation(e){const r=this.json.animations[e],i=[],a=[],s=[],o=[],l=[];for(let u=0,c=r.channels.length;u<c;u++){const f=r.channels[u],h=r.samplers[f.sampler],d=f.target,p=d.node,m=r.parameters!==void 0?r.parameters[h.input]:h.input,g=r.parameters!==void 0?r.parameters[h.output]:h.output;i.push(this.getDependency("node",p)),a.push(this.getDependency("accessor",m)),s.push(this.getDependency("accessor",g)),o.push(h),l.push(d)}return Promise.all([Promise.all(i),Promise.all(a),Promise.all(s),Promise.all(o),Promise.all(l)]).then(function(u){const c=u[0],f=u[1],h=u[2],d=u[3],p=u[4],m=[];for(let v=0,_=c.length;v<_;v++){const x=c[v],b=f[v],S=h[v],T=d[v],M=p[v];if(x===void 0)continue;x.updateMatrix();let C;switch(Tc[M.path]){case Tc.weights:C=D0;break;case Tc.rotation:C=gd;break;case Tc.position:case Tc.scale:default:C=L0;break}const k=x.name?x.name:x.uuid,R=T.interpolation!==void 0?qCe[T.interpolation]:rg,P=[];Tc[M.path]===Tc.weights?x.traverse(function(L){L.morphTargetInfluences&&P.push(L.name?L.name:L.uuid)}):P.push(k);let N=S.array;if(S.normalized){const L=PM(N.constructor),F=new Float32Array(N.length);for(let O=0,B=N.length;O<B;O++)F[O]=N[O]*L;N=F}for(let L=0,F=P.length;L<F;L++){const O=new C(P[L]+"."+Tc[M.path],b.array,N,R);T.interpolation==="CUBICSPLINE"&&(O.createInterpolant=function(H){const j=this instanceof gd?jCe:x7;return new j(this.times,this.values,this.getValueSize()/3,H)},O.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(O)}}const g=r.name?r.name:"animation_"+e;return new tCe(g,void 0,m)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(a){const s=r._getNodeRef(r.meshCache,i.mesh,a);return i.weights!==void 0&&s.traverse(function(o){if(o.isMesh)for(let l=0,u=i.weights.length;l<u;l++)o.morphTargetInfluences[l]=i.weights[l]}),s})}loadNode(e){const t=this.json,r=this.extensions,i=this,a=t.nodes[e],s=a.name?i.createUniqueName(a.name):"";return function(){const o=[],l=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});l&&o.push(l),a.camera!==void 0&&o.push(i.getDependency("camera",a.camera).then(function(h){return i._getNodeRef(i.cameraCache,a.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){o.push(h)});const u=[],c=a.children||[];for(let h=0,d=c.length;h<d;h++)u.push(i.getDependency("node",c[h]));const f=a.skin===void 0?Promise.resolve(null):i.getDependency("skin",a.skin);return Promise.all([Promise.all(o),Promise.all(u),f])}().then(function(o){const l=o[0],u=o[1],c=o[2];let f;if(a.isBone===!0?f=new c7:l.length>1?f=new Uh:l.length===1?f=l[0]:f=new Hr,f!==l[0])for(let h=0,d=l.length;h<d;h++)f.add(l[h]);if(a.name&&(f.userData.name=a.name,f.name=s),Uc(f,a),a.extensions&&Nv(r,f,a),a.matrix!==void 0){const h=new Un;h.fromArray(a.matrix),f.applyMatrix4(h)}else a.translation!==void 0&&f.position.fromArray(a.translation),a.rotation!==void 0&&f.quaternion.fromArray(a.rotation),a.scale!==void 0&&f.scale.fromArray(a.scale);i.associations.has(f)||i.associations.set(f,{}),i.associations.get(f).nodes=e,c!==null&&f.traverse(function(h){h.isSkinnedMesh&&h.bind(c,JCe)});for(let h=0,d=u.length;h<d;h++)f.add(u[h]);return f})}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,a=new Uh;r.name&&(a.name=i.createUniqueName(r.name)),Uc(a,r),r.extensions&&Nv(t,a,r);const s=r.nodes||[],o=[];for(let l=0,u=s.length;l<u;l++)o.push(i.getDependency("node",s[l]));return Promise.all(o).then(function(l){for(let c=0,f=l.length;c<f;c++)a.add(l[c]);const u=c=>{const f=new Map;for(const[h,d]of i.associations)(h instanceof Zo||h instanceof Ki)&&f.set(h,d);return c.traverse(h=>{const d=i.associations.get(h);d!=null&&f.set(h,d)}),f};return i.associations=u(a),a})}}function t2e(n,e,t){const r=e.attributes,i=new Ng;if(r.POSITION!==void 0){const o=t.json.accessors[r.POSITION],l=o.min,u=o.max;if(l!==void 0&&u!==void 0){if(i.set(new De(l[0],l[1],l[2]),new De(u[0],u[1],u[2])),o.normalized){const c=PM(km[o.componentType]);i.min.multiplyScalar(c),i.max.multiplyScalar(c)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const a=e.targets;if(a!==void 0){const o=new De,l=new De;for(let u=0,c=a.length;u<c;u++){const f=a[u];if(f.POSITION!==void 0){const h=t.json.accessors[f.POSITION],d=h.min,p=h.max;if(d!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(d[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(d[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(d[2]),Math.abs(p[2]))),h.normalized){const m=PM(km[h.componentType]);l.multiplyScalar(m)}o.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(o)}n.boundingBox=i;const s=new Og;i.getCenter(s.center),s.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=s}function P5(n,e,t){const r=e.attributes,i=[];function a(s,o){return t.getDependency("accessor",s).then(function(l){n.setAttribute(o,l)})}for(const s in r){const o=RM[s]||s.toLowerCase();o in n.attributes||i.push(a(r[s],o))}if(e.indices!==void 0&&!n.index){const s=t.getDependency("accessor",e.indices).then(function(o){n.setIndex(o)});i.push(s)}return Uc(n,e),t2e(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?KCe(n,e.targets,t):n})}function I5(n,e){let t=n.getIndex();if(t===null){const s=[],o=n.getAttribute("position");if(o!==void 0){for(let l=0;l<o.count;l++)s.push(l);n.setIndex(s),t=n.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(e===Xj)for(let s=1;s<=r;s++)i.push(t.getX(0)),i.push(t.getX(s)),i.push(t.getX(s+1));else for(let s=0;s<r;s++)s%2===0?(i.push(t.getX(s)),i.push(t.getX(s+1)),i.push(t.getX(s+2))):(i.push(t.getX(s+2)),i.push(t.getX(s+1)),i.push(t.getX(s)));i.length/3!==r&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=n.clone();return a.setIndex(i),a}var hI=function(){this._tweens={},this._tweensAddedDuringUpdate={}};hI.prototype={getAll:function(){return Object.keys(this._tweens).map(function(n){return this._tweens[n]}.bind(this))},removeAll:function(){this._tweens={}},add:function(n){this._tweens[n.getId()]=n,this._tweensAddedDuringUpdate[n.getId()]=n},remove:function(n){delete this._tweens[n.getId()],delete this._tweensAddedDuringUpdate[n.getId()]},update:function(n,e){var t=Object.keys(this._tweens);if(t.length===0)return!1;for(n=n!==void 0?n:_r.now();0<t.length;){this._tweensAddedDuringUpdate={};for(var r=0;r<t.length;r++){var i=this._tweens[t[r]];i&&i.update(n)===!1&&(i._isPlaying=!1,e||delete this._tweens[t[r]])}t=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var _r=new hI;_r.Group=hI,_r._nextId=0,_r.nextId=function(){return _r._nextId++},typeof self>"u"&&typeof process<"u"&&process.hrtime?_r.now=function(){var n=process.hrtime();return 1e3*n[0]+n[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?_r.now=self.performance.now.bind(self.performance):Date.now!==void 0?_r.now=Date.now:_r.now=function(){return new Date().getTime()},_r.Tween=function(n,e){this._object=n,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=_r.Easing.Linear.None,this._interpolationFunction=_r.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||_r,this._id=_r.nextId()},_r.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(n,e){return this._valuesEnd=Object.create(n),e!==void 0&&(this._duration=e),this},duration:function(n){return this._duration=n,this},start:function(n){for(var e in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=n!==void 0?typeof n=="string"?_r.now()+parseFloat(n):n:_r.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(this._valuesEnd[e].length===0)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}this._object[e]!==void 0&&(this._valuesStart[e]=this._object[e],!(this._valuesStart[e]instanceof Array)&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,this._onStopCallback!==null&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var n=0,e=this._chainedTweens.length;n<e;n++)this._chainedTweens[n].stop()},group:function(n){return this._group=n,this},delay:function(n){return this._delayTime=n,this},repeat:function(n){return this._repeat=n,this},repeatDelay:function(n){return this._repeatDelayTime=n,this},yoyo:function(n){return this._yoyo=n,this},easing:function(n){return this._easingFunction=n,this},interpolation:function(n){return this._interpolationFunction=n,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(n){return this._onStartCallback=n,this},onUpdate:function(n){return this._onUpdateCallback=n,this},onComplete:function(n){return this._onCompleteCallback=n,this},onStop:function(n){return this._onStopCallback=n,this},update:function(n){var e,t,r;if(n<this._startTime)return!0;for(e in this._onStartCallbackFired===!1&&(this._onStartCallback!==null&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),t=(n-this._startTime)/this._duration,t=this._duration===0||1<t?1:t,r=this._easingFunction(t),this._valuesEnd)if(this._valuesStart[e]!==void 0){var i=this._valuesStart[e]||0,a=this._valuesEnd[e];a instanceof Array?this._object[e]=this._interpolationFunction(a,r):(typeof a=="string"&&(a=a.charAt(0)==="+"||a.charAt(0)==="-"?i+parseFloat(a):parseFloat(a)),typeof a=="number"&&(this._object[e]=i+(a-i)*r))}if(this._onUpdateCallback!==null&&this._onUpdateCallback(this._object),t!==1)return!0;if(0<this._repeat){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if(typeof this._valuesEnd[e]=="string"&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var s=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=s}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=n+this._repeatDelayTime:this._startTime=n+this._delayTime,!0}this._onCompleteCallback!==null&&this._onCompleteCallback(this._object);for(var o=0,l=this._chainedTweens.length;o<l;o++)this._chainedTweens[o].start(this._startTime+this._duration);return!1}},_r.Easing={Linear:{None:function(n){return n}},Quadratic:{In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}},Cubic:{In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}},Quartic:{In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}},Quintic:{In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}},Sinusoidal:{In:function(n){return 1-Math.cos(n*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.cos(Math.PI*n))}},Exponential:{In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(2-Math.pow(2,-10*(n-1)))}},Circular:{In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}},Elastic:{In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin(5*(n-.1)*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?-.5*Math.pow(2,10*(n-1))*Math.sin(5*(n-1.1)*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin(5*(n-1.1)*Math.PI)+1}},Back:{In:function(n){return n*n*(2.70158*n-1.70158)},Out:function(n){return--n*n*(2.70158*n+1.70158)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?n*n*((1+e)*n-e)*.5:.5*((n-=2)*n*((1+e)*n+e)+2)}},Bounce:{In:function(n){return 1-_r.Easing.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?.5*_r.Easing.Bounce.In(2*n):.5*_r.Easing.Bounce.Out(2*n-1)+.5}}},_r.Interpolation={Linear:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),a=_r.Interpolation.Utils.Linear;return e<0?a(n[0],n[1],r):1<e?a(n[t],n[t-1],t-r):a(n[i],n[t<i+1?t:i+1],r-i)},Bezier:function(n,e){for(var t=0,r=n.length-1,i=Math.pow,a=_r.Interpolation.Utils.Bernstein,s=0;s<=r;s++)t+=i(1-e,r-s)*i(e,s)*n[s]*a(r,s);return t},CatmullRom:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),a=_r.Interpolation.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(i=Math.floor(r=t*(1+e))),a(n[(i-1+t)%t],n[i],n[(i+1)%t],n[(i+2)%t],r-i)):e<0?n[0]-(a(n[0],n[0],n[1],n[1],-r)-n[0]):1<e?n[t]-(a(n[t],n[t],n[t-1],n[t-1],r-t)-n[t]):a(n[i?i-1:0],n[i],n[t<i+1?t:i+1],n[t<i+2?t:i+2],r-i)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=_r.Interpolation.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var r=e;1<r;r--)t*=r;return n[e]=t}}(),CatmullRom:function(n,e,t,r,i){var a=.5*(t-n),s=.5*(r-e),o=i*i;return(2*e-2*t+a+s)*(i*o)+(-3*e+3*t-2*a-s)*o+a*i+e}}},function(n){typeof define=="function"&&define.amd?define([],function(){return _r}):typeof module<"u"&&typeof exports=="object"?module.exports=_r:n!==void 0&&(n.TWEEN=_r)}(globalThis);function n2e(n){if(n&&!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function cm(n,e){var t=n.__state.conversionName.toString(),r=Math.round(n.r),i=Math.round(n.g),a=Math.round(n.b),s=n.a,o=Math.round(n.h),l=n.s.toFixed(1),u=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var c=n.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}else{if(t==="CSS_RGB")return"rgb("+r+","+i+","+a+")";if(t==="CSS_RGBA")return"rgba("+r+","+i+","+a+","+s+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+r+","+i+","+a+"]";if(t==="RGBA_ARRAY")return"["+r+","+i+","+a+","+s+"]";if(t==="RGB_OBJ")return"{r:"+r+",g:"+i+",b:"+a+"}";if(t==="RGBA_OBJ")return"{r:"+r+",g:"+i+",b:"+a+",a:"+s+"}";if(t==="HSV_OBJ")return"{h:"+o+",s:"+l+",v:"+u+"}";if(t==="HSVA_OBJ")return"{h:"+o+",s:"+l+",v:"+u+",a:"+s+"}"}return"unknown format"}var D5=Array.prototype.forEach,Ov=Array.prototype.slice,lt={BREAK:{},extend:function(e){return this.each(Ov.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach(function(i){this.isUndefined(t[i])||(e[i]=t[i])}.bind(this))},this),e},defaults:function(e){return this.each(Ov.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach(function(i){this.isUndefined(e[i])&&(e[i]=t[i])}.bind(this))},this),e},compose:function(){var e=Ov.call(arguments);return function(){for(var t=Ov.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e){if(D5&&e.forEach&&e.forEach===D5)e.forEach(t,r);else if(e.length===e.length+0){var i=void 0,a=void 0;for(i=0,a=e.length;i<a;i++)if(i in e&&t.call(r,e[i],i)===this.BREAK)return}else for(var s in e)if(t.call(r,e[s],s)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var i=void 0;return function(){var a=this,s=arguments;function o(){i=null,r||e.apply(a,s)}var l=r||!i;clearTimeout(i),i=setTimeout(o,t),l&&e.apply(a,s)}},toArray:function(e){return e.toArray?e.toArray():Ov.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},r2e=[{litmus:lt.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:cm},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:cm},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:cm},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:cm}}},{litmus:lt.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:lt.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:lt.isObject,conversions:{RGBA_OBJ:{read:function(e){return lt.isNumber(e.r)&&lt.isNumber(e.g)&&lt.isNumber(e.b)&&lt.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return lt.isNumber(e.r)&&lt.isNumber(e.g)&&lt.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return lt.isNumber(e.h)&&lt.isNumber(e.s)&&lt.isNumber(e.v)&&lt.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return lt.isNumber(e.h)&&lt.isNumber(e.s)&&lt.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],$v=void 0,lb=void 0,IM=function(){lb=!1;var e=arguments.length>1?lt.toArray(arguments):arguments[0];return lt.each(r2e,function(t){if(t.litmus(e))return lt.each(t.conversions,function(r,i){if($v=r.read(e),lb===!1&&$v!==!1)return lb=$v,$v.conversionName=i,$v.conversion=r,lt.BREAK}),lt.BREAK}),lb},L5=void 0,Sw={hsv_to_rgb:function(e,t,r){var i=Math.floor(e/60)%6,a=e/60-Math.floor(e/60),s=r*(1-t),o=r*(1-a*t),l=r*(1-(1-a)*t),u=[[r,l,s],[o,r,s],[s,r,l],[s,o,r],[l,s,r],[r,s,o]][i];return{r:u[0]*255,g:u[1]*255,b:u[2]*255}},rgb_to_hsv:function(e,t,r){var i=Math.min(e,t,r),a=Math.max(e,t,r),s=a-i,o=void 0,l=void 0;if(a!==0)l=s/a;else return{h:NaN,s:0,v:0};return e===a?o=(t-r)/s:t===a?o=2+(r-e)/s:o=4+(e-t)/s,o/=6,o<0&&(o+=1),{h:o*360,s:l,v:a/255}},rgb_to_hex:function(e,t,r){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,r),i},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,r){return r<<(L5=t*8)|e&~(255<<L5)}},i2e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},sl=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},ol=function(){function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),hf=function n(e,t,r){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var a=Object.getPrototypeOf(e);return a===null?void 0:n(a,t,r)}else{if("value"in i)return i.value;var s=i.get;return s===void 0?void 0:s.call(r)}},kf=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},Rf=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},Bi=function(){function n(){if(sl(this,n),this.__state=IM.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return ol(n,[{key:"toString",value:function(){return cm(this)}},{key:"toHexString",value:function(){return cm(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function dI(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(Bi.recalculateRGB(this,e,t),this.__state[e])},set:function(i){this.__state.space!=="RGB"&&(Bi.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=i}})}function pI(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(Bi.recalculateHSV(this),this.__state[e])},set:function(r){this.__state.space!=="HSV"&&(Bi.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=r}})}Bi.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=Sw.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")lt.extend(n.__state,Sw.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};Bi.recalculateHSV=function(n){var e=Sw.rgb_to_hsv(n.r,n.g,n.b);lt.extend(n.__state,{s:e.s,v:e.v}),lt.isNaN(e.h)?lt.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};Bi.COMPONENTS=["r","g","b","h","s","v","hex","a"];dI(Bi.prototype,"r",2);dI(Bi.prototype,"g",1);dI(Bi.prototype,"b",0);pI(Bi.prototype,"h");pI(Bi.prototype,"s");pI(Bi.prototype,"v");Object.defineProperty(Bi.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(Bi.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=Sw.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Ud=function(){function n(e,t){sl(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return ol(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),a2e={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},b7={};lt.each(a2e,function(n,e){lt.each(n,function(t){b7[t]=e})});var s2e=/(\d+(\.\d+)?)px/;function xl(n){if(n==="0"||lt.isUndefined(n))return 0;var e=n.match(s2e);return lt.isNull(e)?0:parseFloat(e[1])}var qe={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var i=r,a=t;lt.isUndefined(a)&&(a=!0),lt.isUndefined(i)&&(i=!0),e.style.position="absolute",a&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,i){var a=r||{},s=b7[t];if(!s)throw new Error("Event type "+t+" not supported.");var o=document.createEvent(s);switch(s){case"MouseEvents":{var l=a.x||a.clientX||0,u=a.y||a.clientY||0;o.initMouseEvent(t,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,l,u,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var c=o.initKeyboardEvent||o.initKeyEvent;lt.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break}default:{o.initEvent(t,a.bubbles||!1,a.cancelable||!0);break}}lt.defaults(o,i),e.dispatchEvent(o)},bind:function(e,t,r,i){var a=i||!1;return e.addEventListener?e.addEventListener(t,r,a):e.attachEvent&&e.attachEvent("on"+t,r),qe},unbind:function(e,t,r,i){var a=i||!1;return e.removeEventListener?e.removeEventListener(t,r,a):e.detachEvent&&e.detachEvent("on"+t,r),qe},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);r.indexOf(t)===-1&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return qe},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),i=r.indexOf(t);i!==-1&&(r.splice(i,1),e.className=r.join(" "))}else e.className=void 0;return qe},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return xl(t["border-left-width"])+xl(t["border-right-width"])+xl(t["padding-left"])+xl(t["padding-right"])+xl(t.width)},getHeight:function(e){var t=getComputedStyle(e);return xl(t["border-top-width"])+xl(t["border-bottom-width"])+xl(t["padding-top"])+xl(t["padding-bottom"])+xl(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent;while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},w7=function(n){kf(e,n);function e(t,r){sl(this,e);var i=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=i;i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox");function s(){a.setValue(!a.__prev)}return qe.bind(i.__checkbox,"change",s,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return ol(e,[{key:"setValue",value:function(r){var i=hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Ud),o2e=function(n){kf(e,n);function e(t,r,i){sl(this,e);var a=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=i,o=a;if(a.__select=document.createElement("select"),lt.isArray(s)){var l={};lt.each(s,function(u){l[u]=u}),s=l}return lt.each(s,function(u,c){var f=document.createElement("option");f.innerHTML=c,f.setAttribute("value",u),o.__select.appendChild(f)}),a.updateDisplay(),qe.bind(a.__select,"change",function(){var u=this.options[this.selectedIndex].value;o.setValue(u)}),a.domElement.appendChild(a.__select),a}return ol(e,[{key:"setValue",value:function(r){var i=hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return qe.isActive(this.__select)?this:(this.__select.value=this.getValue(),hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Ud),l2e=function(n){kf(e,n);function e(t,r){sl(this,e);var i=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),a=i;function s(){a.setValue(a.__input.value)}function o(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),qe.bind(i.__input,"keyup",s),qe.bind(i.__input,"change",s),qe.bind(i.__input,"blur",o),qe.bind(i.__input,"keydown",function(l){l.keyCode===13&&this.blur()}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return ol(e,[{key:"updateDisplay",value:function(){return qe.isActive(this.__input)||(this.__input.value=this.getValue()),hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Ud);function N5(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var S7=function(n){kf(e,n);function e(t,r,i){sl(this,e);var a=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=i||{};return a.__min=s.min,a.__max=s.max,a.__step=s.step,lt.isUndefined(a.__step)?a.initialValue===0?a.__impliedStep=1:a.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(a.initialValue))/Math.LN10))/10:a.__impliedStep=a.__step,a.__precision=N5(a.__impliedStep),a}return ol(e,[{key:"setValue",value:function(r){var i=r;return this.__min!==void 0&&i<this.__min?i=this.__min:this.__max!==void 0&&i>this.__max&&(i=this.__max),this.__step!==void 0&&i%this.__step!==0&&(i=Math.round(i/this.__step)*this.__step),hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(r){return this.__min=r,this}},{key:"max",value:function(r){return this.__max=r,this}},{key:"step",value:function(r){return this.__step=r,this.__impliedStep=r,this.__precision=N5(r),this}}]),e}(Ud);function u2e(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var Tw=function(n){kf(e,n);function e(t,r,i){sl(this,e);var a=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,i));a.__truncationSuspended=!1;var s=a,o=void 0;function l(){var p=parseFloat(s.__input.value);lt.isNaN(p)||s.setValue(p)}function u(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function c(){u()}function f(p){var m=o-p.clientY;s.setValue(s.getValue()+m*s.__impliedStep),o=p.clientY}function h(){qe.unbind(window,"mousemove",f),qe.unbind(window,"mouseup",h),u()}function d(p){qe.bind(window,"mousemove",f),qe.bind(window,"mouseup",h),o=p.clientY}return a.__input=document.createElement("input"),a.__input.setAttribute("type","text"),qe.bind(a.__input,"change",l),qe.bind(a.__input,"blur",c),qe.bind(a.__input,"mousedown",d),qe.bind(a.__input,"keydown",function(p){p.keyCode===13&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,u())}),a.updateDisplay(),a.domElement.appendChild(a.__input),a}return ol(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():u2e(this.getValue(),this.__precision),hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(S7);function O5(n,e,t,r,i){return r+(i-r)*((n-e)/(t-e))}var DM=function(n){kf(e,n);function e(t,r,i,a,s){sl(this,e);var o=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:i,max:a,step:s})),l=o;o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),qe.bind(o.__background,"mousedown",u),qe.bind(o.__background,"touchstart",h),qe.addClass(o.__background,"slider"),qe.addClass(o.__foreground,"slider-fg");function u(m){document.activeElement.blur(),qe.bind(window,"mousemove",c),qe.bind(window,"mouseup",f),c(m)}function c(m){m.preventDefault();var g=l.__background.getBoundingClientRect();return l.setValue(O5(m.clientX,g.left,g.right,l.__min,l.__max)),!1}function f(){qe.unbind(window,"mousemove",c),qe.unbind(window,"mouseup",f),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function h(m){m.touches.length===1&&(qe.bind(window,"touchmove",d),qe.bind(window,"touchend",p),d(m))}function d(m){var g=m.touches[0].clientX,v=l.__background.getBoundingClientRect();l.setValue(O5(g,v.left,v.right,l.__min,l.__max))}function p(){qe.unbind(window,"touchmove",d),qe.unbind(window,"touchend",p),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return ol(e,[{key:"updateDisplay",value:function(){var r=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=r*100+"%",hf(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(S7),T7=function(n){kf(e,n);function e(t,r,i){sl(this,e);var a=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=a;return a.__button=document.createElement("div"),a.__button.innerHTML=i===void 0?"Fire":i,qe.bind(a.__button,"click",function(o){return o.preventDefault(),s.fire(),!1}),qe.addClass(a.__button,"button"),a.domElement.appendChild(a.__button),a}return ol(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Ud),LM=function(n){kf(e,n);function e(t,r){sl(this,e);var i=Rf(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));i.__color=new Bi(i.getValue()),i.__temp=new Bi(0);var a=i;i.domElement=document.createElement("div"),qe.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",qe.bind(i.__input,"keydown",function(m){m.keyCode===13&&f.call(this)}),qe.bind(i.__input,"blur",f),qe.bind(i.__selector,"mousedown",function(){qe.addClass(this,"drag").bind(window,"mouseup",function(){qe.removeClass(a.__selector,"drag")})}),qe.bind(i.__selector,"touchstart",function(){qe.addClass(this,"drag").bind(window,"touchend",function(){qe.removeClass(a.__selector,"drag")})});var s=document.createElement("div");lt.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),lt.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),lt.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),lt.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),lt.extend(s.style,{width:"100%",height:"100%",background:"none"}),$5(s,"top","rgba(0,0,0,0)","#000"),lt.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),f2e(i.__hue_field),lt.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),qe.bind(i.__saturation_field,"mousedown",o),qe.bind(i.__saturation_field,"touchstart",o),qe.bind(i.__field_knob,"mousedown",o),qe.bind(i.__field_knob,"touchstart",o),qe.bind(i.__hue_field,"mousedown",l),qe.bind(i.__hue_field,"touchstart",l);function o(m){d(m),qe.bind(window,"mousemove",d),qe.bind(window,"touchmove",d),qe.bind(window,"mouseup",u),qe.bind(window,"touchend",u)}function l(m){p(m),qe.bind(window,"mousemove",p),qe.bind(window,"touchmove",p),qe.bind(window,"mouseup",c),qe.bind(window,"touchend",c)}function u(){qe.unbind(window,"mousemove",d),qe.unbind(window,"touchmove",d),qe.unbind(window,"mouseup",u),qe.unbind(window,"touchend",u),h()}function c(){qe.unbind(window,"mousemove",p),qe.unbind(window,"touchmove",p),qe.unbind(window,"mouseup",c),qe.unbind(window,"touchend",c),h()}function f(){var m=IM(this.value);m!==!1?(a.__color.__state=m,a.setValue(a.__color.toOriginal())):this.value=a.__color.toString()}function h(){a.__onFinishChange&&a.__onFinishChange.call(a,a.__color.toOriginal())}i.__saturation_field.appendChild(s),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay();function d(m){m.type.indexOf("touch")===-1&&m.preventDefault();var g=a.__saturation_field.getBoundingClientRect(),v=m.touches&&m.touches[0]||m,_=v.clientX,x=v.clientY,b=(_-g.left)/(g.right-g.left),S=1-(x-g.top)/(g.bottom-g.top);return S>1?S=1:S<0&&(S=0),b>1?b=1:b<0&&(b=0),a.__color.v=S,a.__color.s=b,a.setValue(a.__color.toOriginal()),!1}function p(m){m.type.indexOf("touch")===-1&&m.preventDefault();var g=a.__hue_field.getBoundingClientRect(),v=m.touches&&m.touches[0]||m,_=v.clientY,x=1-(_-g.top)/(g.bottom-g.top);return x>1?x=1:x<0&&(x=0),a.__color.h=x*360,a.setValue(a.__color.toOriginal()),!1}return i}return ol(e,[{key:"updateDisplay",value:function(){var r=IM(this.getValue());if(r!==!1){var i=!1;lt.each(Bi.COMPONENTS,function(o){if(!lt.isUndefined(r[o])&&!lt.isUndefined(this.__color.__state[o])&&r[o]!==this.__color.__state[o])return i=!0,{}},this),i&&lt.extend(this.__color.__state,r)}lt.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;lt.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,$5(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),lt.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}}]),e}(Ud),c2e=["-moz-","-o-","-webkit-","-ms-",""];function $5(n,e,t,r){n.style.background="",lt.each(c2e,function(i){n.style.cssText+="background: "+i+"linear-gradient("+e+", "+t+" 0%, "+r+" 100%); "})}function f2e(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var h2e={load:function(e,t){var r=t||document,i=r.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,r.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var r=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var a=r.getElementsByTagName("head")[0];try{a.appendChild(i)}catch{}}},d2e=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,p2e=function(e,t){var r=e[t];return lt.isArray(arguments[2])||lt.isObject(arguments[2])?new o2e(e,t,arguments[2]):lt.isNumber(r)?lt.isNumber(arguments[2])&&lt.isNumber(arguments[3])?lt.isNumber(arguments[4])?new DM(e,t,arguments[2],arguments[3],arguments[4]):new DM(e,t,arguments[2],arguments[3]):lt.isNumber(arguments[4])?new Tw(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new Tw(e,t,{min:arguments[2],max:arguments[3]}):lt.isString(r)?new l2e(e,t):lt.isFunction(r)?new T7(e,t,""):lt.isBoolean(r)?new w7(e,t):null};function m2e(n){setTimeout(n,1e3/60)}var g2e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||m2e,v2e=function(){function n(){sl(this,n),this.backgroundElement=document.createElement("div"),lt.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),qe.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),lt.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;qe.bind(this.backgroundElement,"click",function(){e.hide()})}return ol(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),lt.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,r=function i(){t.domElement.style.display="none",t.backgroundElement.style.display="none",qe.unbind(t.domElement,"webkitTransitionEnd",i),qe.unbind(t.domElement,"transitionend",i),qe.unbind(t.domElement,"oTransitionEnd",i)};qe.bind(this.domElement,"webkitTransitionEnd",r),qe.bind(this.domElement,"transitionend",r),qe.bind(this.domElement,"oTransitionEnd",r),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-qe.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-qe.getHeight(this.domElement)/2+"px"}}]),n}(),y2e=n2e(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);h2e.inject(y2e);var F5="dg",B5=72,U5=20,N0="Default",gy=function(){try{return!!window.localStorage}catch{return!1}}(),Wy=void 0,z5=!0,tm=void 0,z2=!1,C7=[],Vr=function n(e){var t=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),qe.addClass(this.domElement,F5),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=lt.defaults(r,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),r=lt.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),lt.isUndefined(r.load)?r.load={preset:N0}:r.preset&&(r.load.preset=r.preset),lt.isUndefined(r.parent)&&r.hideable&&C7.push(this),r.resizable=lt.isUndefined(r.parent)&&r.resizable,r.autoPlace&&lt.isUndefined(r.scrollable)&&(r.scrollable=!0);var i=gy&&localStorage.getItem(nm(this,"isLocal"))==="true",a=void 0,s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:r.load.preset},set:function(h){t.parent?t.getRoot().preset=h:r.load.preset=h,w2e(this),t.revert()}},width:{get:function(){return r.width},set:function(h){r.width=h,$M(t,h)}},name:{get:function(){return r.name},set:function(h){r.name=h,s&&(s.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(h){r.closed=h,r.closed?qe.addClass(t.__ul,n.CLASS_CLOSED):qe.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=h?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return i},set:function(h){gy&&(i=h,h?qe.bind(window,"unload",a):qe.unbind(window,"unload",a),localStorage.setItem(nm(t,"isLocal"),h))}}}),lt.isUndefined(r.parent)){if(this.closed=r.closed||!1,qe.addClass(this.domElement,n.CLASS_MAIN),qe.makeSelectable(this.domElement,!1),gy&&i){t.useLocalStorage=!0;var o=localStorage.getItem(nm(this,"gui"));o&&(r.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,qe.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),r.closeOnTop?(qe.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(qe.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),qe.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{r.closed===void 0&&(r.closed=!0);var l=document.createTextNode(r.name);qe.addClass(l,"controller-name"),s=mI(t,l);var u=function(h){return h.preventDefault(),t.closed=!t.closed,!1};qe.addClass(this.__ul,n.CLASS_CLOSED),qe.addClass(s,"title"),qe.bind(s,"click",u),r.closed||(this.closed=!1)}r.autoPlace&&(lt.isUndefined(r.parent)&&(z5&&(tm=document.createElement("div"),qe.addClass(tm,F5),qe.addClass(tm,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(tm),z5=!1),tm.appendChild(this.domElement),qe.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||$M(t,r.width)),this.__resizeHandler=function(){t.onResizeDebounced()},qe.bind(window,"resize",this.__resizeHandler),qe.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),qe.bind(this.__ul,"transitionend",this.__resizeHandler),qe.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&b2e(this),a=function(){gy&&localStorage.getItem(nm(t,"isLocal"))==="true"&&localStorage.setItem(nm(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=a;function c(){var f=t.getRoot();f.width+=1,lt.defer(function(){f.width-=1})}r.parent||c()};Vr.toggleHide=function(){z2=!z2,lt.each(C7,function(n){n.domElement.style.display=z2?"none":""})};Vr.CLASS_AUTO_PLACE="a";Vr.CLASS_AUTO_PLACE_CONTAINER="ac";Vr.CLASS_MAIN="main";Vr.CLASS_CONTROLLER_ROW="cr";Vr.CLASS_TOO_TALL="taller-than-window";Vr.CLASS_CLOSED="closed";Vr.CLASS_CLOSE_BUTTON="close-button";Vr.CLASS_CLOSE_TOP="close-top";Vr.CLASS_CLOSE_BOTTOM="close-bottom";Vr.CLASS_DRAG="drag";Vr.DEFAULT_WIDTH=245;Vr.TEXT_CLOSED="Close Controls";Vr.TEXT_OPEN="Open Controls";Vr._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===B5||n.keyCode===B5)&&Vr.toggleHide()};qe.bind(window,"keydown",Vr._keydownHandler,!1);lt.extend(Vr.prototype,{add:function(e,t){return Gy(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Gy(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;lt.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&tm.removeChild(this.domElement);var e=this;lt.each(this.__folders,function(t){e.removeFolder(t)}),qe.unbind(window,"keydown",Vr._keydownHandler,!1),V5(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new Vr(t);this.__folders[e]=r;var i=mI(this,r.domElement);return qe.addClass(i,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],V5(e);var t=this;lt.each(e.__folders,function(r){e.removeFolder(r)}),lt.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=qe.getOffset(e.__ul).top,r=0;lt.each(e.__ul.childNodes,function(i){e.autoPlace&&i===e.__save_row||(r+=qe.getHeight(i))}),window.innerHeight-t-U5<r?(qe.addClass(e.domElement,Vr.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-U5+"px"):(qe.removeClass(e.domElement,Vr.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&lt.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:lt.debounce(function(){this.onResize()},50),remember:function(){if(lt.isUndefined(Wy)&&(Wy=new v2e,Wy.domElement.innerHTML=d2e),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;lt.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&x2e(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&$M(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=ub(this)),e.folders={},lt.each(this.__folders,function(t,r){e.folders[r]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=ub(this),NM(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[N0]=ub(this,!0)),this.load.remembered[e]=ub(this),this.preset=e,OM(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){lt.each(this.__controllers,function(t){this.getRoot().load.remembered?E7(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),lt.each(this.__folders,function(t){t.revert(t)}),e||NM(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&A7(this.__listening)},updateDisplay:function(){lt.each(this.__controllers,function(e){e.updateDisplay()}),lt.each(this.__folders,function(e){e.updateDisplay()})}});function mI(n,e,t){var r=document.createElement("li");return e&&r.appendChild(e),t?n.__ul.insertBefore(r,t):n.__ul.appendChild(r),n.onResize(),r}function V5(n){qe.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&qe.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function NM(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function _2e(n,e,t){if(t.__li=e,t.__gui=n,lt.extend(t,{options:function(s){if(arguments.length>1){var o=t.__li.nextElementSibling;return t.remove(),Gy(n,t.object,t.property,{before:o,factoryArgs:[lt.toArray(arguments)]})}if(lt.isArray(s)||lt.isObject(s)){var l=t.__li.nextElementSibling;return t.remove(),Gy(n,t.object,t.property,{before:l,factoryArgs:[s]})}},name:function(s){return t.__li.firstElementChild.firstElementChild.innerHTML=s,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof DM){var r=new Tw(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});lt.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(a){var s=t[a],o=r[a];t[a]=r[a]=function(){var l=Array.prototype.slice.call(arguments);return o.apply(r,l),s.apply(t,l)}}),qe.addClass(e,"has-slider"),t.domElement.insertBefore(r.domElement,t.domElement.firstElementChild)}else if(t instanceof Tw){var i=function(s){if(lt.isNumber(t.__min)&&lt.isNumber(t.__max)){var o=t.__li.firstElementChild.firstElementChild.innerHTML,l=t.__gui.__listening.indexOf(t)>-1;t.remove();var u=Gy(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return u.name(o),l&&u.listen(),u}return s};t.min=lt.compose(i,t.min),t.max=lt.compose(i,t.max)}else t instanceof w7?(qe.bind(e,"click",function(){qe.fakeEvent(t.__checkbox,"click")}),qe.bind(t.__checkbox,"click",function(a){a.stopPropagation()})):t instanceof T7?(qe.bind(e,"click",function(){qe.fakeEvent(t.__button,"click")}),qe.bind(e,"mouseover",function(){qe.addClass(t.__button,"hover")}),qe.bind(e,"mouseout",function(){qe.removeClass(t.__button,"hover")})):t instanceof LM&&(qe.addClass(e,"color"),t.updateDisplay=lt.compose(function(a){return e.style.borderLeftColor=t.__color.toString(),a},t.updateDisplay),t.updateDisplay());t.setValue=lt.compose(function(a){return n.getRoot().__preset_select&&t.isModified()&&NM(n.getRoot(),!0),a},t.setValue)}function E7(n,e){var t=n.getRoot(),r=t.__rememberedObjects.indexOf(e.object);if(r!==-1){var i=t.__rememberedObjectIndecesToControllers[r];if(i===void 0&&(i={},t.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,t.load&&t.load.remembered){var a=t.load.remembered,s=void 0;if(a[n.preset])s=a[n.preset];else if(a[N0])s=a[N0];else return;if(s[r]&&s[r][e.property]!==void 0){var o=s[r][e.property];e.initialValue=o,e.setValue(o)}}}}function Gy(n,e,t,r){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var i=void 0;if(r.color)i=new LM(e,t);else{var a=[e,t].concat(r.factoryArgs);i=p2e.apply(n,a)}r.before instanceof Ud&&(r.before=r.before.__li),E7(n,i),qe.addClass(i.domElement,"c");var s=document.createElement("span");qe.addClass(s,"property-name"),s.innerHTML=i.property;var o=document.createElement("div");o.appendChild(s),o.appendChild(i.domElement);var l=mI(n,o,r.before);return qe.addClass(l,Vr.CLASS_CONTROLLER_ROW),i instanceof LM?qe.addClass(l,"color"):qe.addClass(l,i2e(i.getValue())),_2e(n,l,i),n.__controllers.push(i),i}function nm(n,e){return document.location.href+"."+e}function OM(n,e,t){var r=document.createElement("option");r.innerHTML=e,r.value=e,n.__preset_select.appendChild(r),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function H5(n,e){e.style.display=n.useLocalStorage?"block":"none"}function x2e(n){var e=n.__save_row=document.createElement("li");qe.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),qe.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",qe.addClass(t,"button gears");var r=document.createElement("span");r.innerHTML="Save",qe.addClass(r,"button"),qe.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",qe.addClass(i,"button"),qe.addClass(i,"save-as");var a=document.createElement("span");a.innerHTML="Revert",qe.addClass(a,"button"),qe.addClass(a,"revert");var s=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?lt.each(n.load.remembered,function(f,h){OM(n,h,h===n.preset)}):OM(n,N0,!1),qe.bind(s,"change",function(){for(var f=0;f<n.__preset_select.length;f++)n.__preset_select[f].innerHTML=n.__preset_select[f].value;n.preset=this.value}),e.appendChild(s),e.appendChild(t),e.appendChild(r),e.appendChild(i),e.appendChild(a),gy){var o=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage"),u=document.getElementById("dg-save-locally");u.style.display="block",localStorage.getItem(nm(n,"isLocal"))==="true"&&l.setAttribute("checked","checked"),H5(n,o),qe.bind(l,"change",function(){n.useLocalStorage=!n.useLocalStorage,H5(n,o)})}var c=document.getElementById("dg-new-constructor");qe.bind(c,"keydown",function(f){f.metaKey&&(f.which===67||f.keyCode===67)&&Wy.hide()}),qe.bind(t,"click",function(){c.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),Wy.show(),c.focus(),c.select()}),qe.bind(r,"click",function(){n.save()}),qe.bind(i,"click",function(){var f=prompt("Enter a new preset name.");f&&n.saveAs(f)}),qe.bind(a,"click",function(){n.revert()})}function b2e(n){var e=void 0;n.__resize_handle=document.createElement("div"),lt.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(a){return a.preventDefault(),n.width+=e-a.clientX,n.onResize(),e=a.clientX,!1}function r(){qe.removeClass(n.__closeButton,Vr.CLASS_DRAG),qe.unbind(window,"mousemove",t),qe.unbind(window,"mouseup",r)}function i(a){return a.preventDefault(),e=a.clientX,qe.addClass(n.__closeButton,Vr.CLASS_DRAG),qe.bind(window,"mousemove",t),qe.bind(window,"mouseup",r),!1}qe.bind(n.__resize_handle,"mousedown",i),qe.bind(n.__closeButton,"mousedown",i),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function $M(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function ub(n,e){var t={};return lt.each(n.__rememberedObjects,function(r,i){var a={},s=n.__rememberedObjectIndecesToControllers[i];lt.each(s,function(o,l){a[l]=e?o.initialValue:o.getValue()}),t[i]=a}),t}function w2e(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function A7(n){n.length!==0&&g2e.call(window,function(){A7(n)}),lt.each(n,function(e){e.updateDisplay()})}var Zrt=Vr;function Qrt(n,e=!1){const t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),i=new Set(Object.keys(n[0].morphAttributes)),a={},s={},o=n[0].morphTargetsRelative,l=new xa;let u=0;for(let c=0;c<n.length;++c){const f=n[c];let h=0;if(t!==(f.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const d in f.attributes){if(!r.has(d))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+d+'" attribute exists among all geometries, or in none of them.'),null;a[d]===void 0&&(a[d]=[]),a[d].push(f.attributes[d]),h++}if(h!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(o!==f.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const d in f.morphAttributes){if(!i.has(d))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;s[d]===void 0&&(s[d]=[]),s[d].push(f.morphAttributes[d])}if(e){let d;if(t)d=f.index.count;else if(f.attributes.position!==void 0)d=f.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,d,c),u+=d}}if(t){let c=0;const f=[];for(let h=0;h<n.length;++h){const d=n[h].index;for(let p=0;p<d.count;++p)f.push(d.getX(p)+c);c+=n[h].attributes.position.count}l.setIndex(f)}for(const c in a){const f=W5(a[c]);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,f)}for(const c in s){const f=s[c][0].length;if(f===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let h=0;h<f;++h){const d=[];for(let m=0;m<s[c].length;++m)d.push(s[c][m][h]);const p=W5(d);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(p)}}return l}function W5(n){let e,t,r,i=0;for(let o=0;o<n.length;++o){const l=n[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=l.itemSize),t!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=l.normalized),r!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;i+=l.array.length}const a=new e(i);let s=0;for(let o=0;o<n.length;++o)a.set(n[o].array,s),s+=n[o].array.length;return new Yi(a,t,r)}const S2e={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class C_{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const T2e=new sT(-1,1,1,-1,0,1),gI=new xa;gI.setAttribute("position",new Ei([-1,3,0,-1,-1,0,3,-1,0],3));gI.setAttribute("uv",new Ei([0,2,0,0,2,0],2));class M7{constructor(e){this._mesh=new ns(gI,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,T2e)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class C2e extends C_{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof jl?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=JP.clone(e.uniforms),this.material=new jl({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new M7(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class G5 extends C_{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0);let s,o;this.inverse?(s=0,o=1):(s=1,o=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),a.buffers.stencil.setFunc(i.ALWAYS,s,4294967295),a.buffers.stencil.setClear(o),a.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(i.EQUAL,1,4294967295),a.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),a.buffers.stencil.setLocked(!0)}}class E2e extends C_{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class Jrt{constructor(e,t){if(this.renderer=e,t===void 0){const r=e.getSize(new un);this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,t=new ff(this._width*this._pixelRatio,this._height*this._pixelRatio),t.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new C2e(S2e),this.clock=new mCe}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let i=0,a=this.passes.length;i<a;i++){const s=this.passes[i];if(s.enabled!==!1){if(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),s.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),s.needsSwap){if(r){const o=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}G5!==void 0&&(s instanceof G5?r=!0:s instanceof E2e&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new un);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let a=0;a<this.passes.length;a++)this.passes[a].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class eit extends C_{constructor(e,t,r,i,a){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=a!==void 0?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new gn}render(e,t,r){const i=e.autoClear;e.autoClear=!1;let a,s;this.overrideMaterial!==void 0&&(s=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,a),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=s),e.autoClear=i}}const A2e={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:`

		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		uniform int byp; //should we apply the glitch ?

		uniform sampler2D tDiffuse;
		uniform sampler2D tDisp;

		uniform float amount;
		uniform float angle;
		uniform float seed;
		uniform float seed_x;
		uniform float seed_y;
		uniform float distortion_x;
		uniform float distortion_y;
		uniform float col_s;

		varying vec2 vUv;


		float rand(vec2 co){
			return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
		}

		void main() {
			if(byp<1) {
				vec2 p = vUv;
				float xs = floor(gl_FragCoord.x / 0.5);
				float ys = floor(gl_FragCoord.y / 0.5);
				//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch
				float disp = texture2D(tDisp, p*seed*seed).r;
				if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {
					if(seed_x>0.){
						p.y = 1. - (p.y + distortion_y);
					}
					else {
						p.y = distortion_y;
					}
				}
				if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {
					if(seed_y>0.){
						p.x=distortion_x;
					}
					else {
						p.x = 1. - (p.x + distortion_x);
					}
				}
				p.x+=disp*seed_x*(seed/5.);
				p.y+=disp*seed_y*(seed/5.);
				//base from RGB shift shader
				vec2 offset = amount * vec2( cos(angle), sin(angle));
				vec4 cr = texture2D(tDiffuse, p + offset);
				vec4 cga = texture2D(tDiffuse, p);
				vec4 cb = texture2D(tDiffuse, p - offset);
				gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);
				//add noise
				vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);
				gl_FragColor = gl_FragColor+ snow;
			}
			else {
				gl_FragColor=texture2D (tDiffuse, vUv);
			}
		}`};class tit extends C_{constructor(e=64){super();const t=A2e;this.uniforms=JP.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new jl({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new M7(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,r){e.capabilities.isWebGL2===!1&&(this.uniforms.tDisp.value.format=jj),this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=bs.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=bs.randFloat(-1,1),this.uniforms.seed_y.value=bs.randFloat(-1,1),this.uniforms.distortion_x.value=bs.randFloat(0,1),this.uniforms.distortion_y.value=bs.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=bs.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=bs.randFloat(0,1),this.uniforms.distortion_y.value=bs.randFloat(0,1),this.uniforms.seed_x.value=bs.randFloat(-.3,.3),this.uniforms.seed_y.value=bs.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=bs.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),r=e*e;for(let a=0;a<r;a++){const s=bs.randFloat(0,1);t[a]=s}const i=new f7(t,e,e,qj,Iu);return i.needsUpdate=!0,i}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}function nit(n,e){return n+Math.floor(Math.random()*(e-n+1))}function rit(n,e){return n+Math.random()*(e-n)}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var FM=function(n,e){return FM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},FM(n,e)};function ht(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");FM(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var M2e=function(){function n(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return n}(),k2e=function(){function n(){this.browser=new M2e,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return n}(),Eh=new k2e;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(Eh.wxa=!0,Eh.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?Eh.worker=!0:typeof navigator>"u"?(Eh.node=!0,Eh.svgSupported=!0):R2e(navigator.userAgent,Eh);function R2e(n,e){var t=e.browser,r=n.match(/Firefox\/([\d.]+)/),i=n.match(/MSIE\s([\d.]+)/)||n.match(/Trident\/.+?rv:(([\d.]+))/),a=n.match(/Edge?\/([\d.]+)/),s=/micromessenger/i.test(n);r&&(t.firefox=!0,t.version=r[1]),i&&(t.ie=!0,t.version=i[1]),a&&(t.edge=!0,t.version=a[1],t.newEdge=+a[1].split(".")[0]>18),s&&(t.weChat=!0),e.svgSupported=typeof SVGRect<"u",e.touchEventsSupported="ontouchstart"in window&&!t.ie&&!t.edge,e.pointerEventsSupported="onpointerdown"in window&&(t.edge||t.ie&&+t.version>=11),e.domSupported=typeof document<"u";var o=document.documentElement.style;e.transform3dSupported=(t.ie&&"transition"in o||t.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in o)&&!("OTransition"in o),e.transformSupported=e.transform3dSupported||t.ie&&+t.version>=9}const In=Eh;var vI=12,P2e="sans-serif",vd=vI+"px "+P2e,I2e=20,D2e=100,L2e="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function N2e(n){var e={};if(typeof JSON>"u")return e;for(var t=0;t<n.length;t++){var r=String.fromCharCode(t+32),i=(n.charCodeAt(t)-I2e)/D2e;e[r]=i}return e}var O2e=N2e(L2e),zg={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var n,e;return function(t,r){if(!n){var i=zg.createCanvas();n=i&&i.getContext("2d")}if(n)return e!==r&&(e=n.font=r||vd),n.measureText(t);t=t||"",r=r||vd;var a=/(\d+)px/.exec(r),s=a&&+a[1]||vI,o=0;if(r.indexOf("mono")>=0)o=s*t.length;else for(var l=0;l<t.length;l++){var u=O2e[t[l]];o+=u==null?s:u*s}return{width:o}}}(),loadImage:function(n,e,t){var r=new Image;return r.onload=e,r.onerror=t,r.src=n,r}},k7=df(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(n,e){return n["[object "+e+"]"]=!0,n},{}),R7=df(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(n,e){return n["[object "+e+"Array]"]=!0,n},{}),Vg=Object.prototype.toString,cT=Array.prototype,$2e=cT.forEach,F2e=cT.filter,yI=cT.slice,B2e=cT.map,j5=function(){}.constructor,cb=j5?j5.prototype:null,_I="__proto__",U2e=2311;function P7(){return U2e++}function xI(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];typeof console<"u"&&console.error.apply(console,n)}function wn(n){if(n==null||typeof n!="object")return n;var e=n,t=Vg.call(n);if(t==="[object Array]"){if(!qy(n)){e=[];for(var r=0,i=n.length;r<i;r++)e[r]=wn(n[r])}}else if(R7[t]){if(!qy(n)){var a=n.constructor;if(a.from)e=a.from(n);else{e=new a(n.length);for(var r=0,i=n.length;r<i;r++)e[r]=n[r]}}}else if(!k7[t]&&!qy(n)&&!O0(n)){e={};for(var s in n)n.hasOwnProperty(s)&&s!==_I&&(e[s]=wn(n[s]))}return e}function Dn(n,e,t){if(!Yt(e)||!Yt(n))return t?wn(e):n;for(var r in e)if(e.hasOwnProperty(r)&&r!==_I){var i=n[r],a=e[r];Yt(a)&&Yt(i)&&!Rt(a)&&!Rt(i)&&!O0(a)&&!O0(i)&&!q5(a)&&!q5(i)&&!qy(a)&&!qy(i)?Dn(i,a,t):(t||!(r in n))&&(n[r]=wn(e[r]))}return n}function gt(n,e){if(Object.assign)Object.assign(n,e);else for(var t in e)e.hasOwnProperty(t)&&t!==_I&&(n[t]=e[t]);return n}function ln(n,e,t){for(var r=Wr(e),i=0;i<r.length;i++){var a=r[i];(t?e[a]!=null:n[a]==null)&&(n[a]=e[a])}return n}function Vn(n,e){if(n){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t}return-1}function z2e(n,e){var t=n.prototype;function r(){}r.prototype=e.prototype,n.prototype=new r;for(var i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i]);n.prototype.constructor=n,n.superClass=e}function ll(n,e,t){if(n="prototype"in n?n.prototype:n,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var a=r[i];a!=="constructor"&&(t?e[a]!=null:n[a]==null)&&(n[a]=e[a])}else ln(n,e,t)}function Fa(n){return!n||typeof n=="string"?!1:typeof n.length=="number"}function ce(n,e,t){if(n&&e)if(n.forEach&&n.forEach===$2e)n.forEach(e,t);else if(n.length===+n.length)for(var r=0,i=n.length;r<i;r++)e.call(t,n[r],r,n);else for(var a in n)n.hasOwnProperty(a)&&e.call(t,n[a],a,n)}function Nt(n,e,t){if(!n)return[];if(!e)return bI(n);if(n.map&&n.map===B2e)return n.map(e,t);for(var r=[],i=0,a=n.length;i<a;i++)r.push(e.call(t,n[i],i,n));return r}function df(n,e,t,r){if(n&&e){for(var i=0,a=n.length;i<a;i++)t=e.call(r,t,n[i],i,n);return t}}function si(n,e,t){if(!n)return[];if(!e)return bI(n);if(n.filter&&n.filter===F2e)return n.filter(e,t);for(var r=[],i=0,a=n.length;i<a;i++)e.call(t,n[i],i,n)&&r.push(n[i]);return r}function Wr(n){if(!n)return[];if(Object.keys)return Object.keys(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e}function V2e(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return function(){return n.apply(e,t.concat(yI.call(arguments)))}}var Rr=cb&&pn(cb.bind)?cb.call.bind(cb.bind):V2e;function ir(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){return n.apply(this,e.concat(yI.call(arguments)))}}function Rt(n){return Array.isArray?Array.isArray(n):Vg.call(n)==="[object Array]"}function pn(n){return typeof n=="function"}function jt(n){return typeof n=="string"}function BM(n){return Vg.call(n)==="[object String]"}function gr(n){return typeof n=="number"}function Yt(n){var e=typeof n;return e==="function"||!!n&&e==="object"}function q5(n){return!!k7[Vg.call(n)]}function Rs(n){return!!R7[Vg.call(n)]}function O0(n){return typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.ownerDocument=="object"}function fT(n){return n.colorStops!=null}function H2e(n){return n.image!=null}function W2e(n){return Vg.call(n)==="[object RegExp]"}function Cw(n){return n!==n}function $0(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=0,r=n.length;t<r;t++)if(n[t]!=null)return n[t]}function Hn(n,e){return n??e}function jy(n,e,t){return n??e??t}function bI(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return yI.apply(n,e)}function I7(n){if(typeof n=="number")return[n,n,n,n];var e=n.length;return e===2?[n[0],n[1],n[0],n[1]]:e===3?[n[0],n[1],n[2],n[1]]:n}function ql(n,e){if(!n)throw new Error(e)}function Dl(n){return n==null?null:typeof n.trim=="function"?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var D7="__ec_primitive__";function Ew(n){n[D7]=!0}function qy(n){return n[D7]}var G2e=function(){function n(){this.data={}}return n.prototype.delete=function(e){var t=this.has(e);return t&&delete this.data[e],t},n.prototype.has=function(e){return this.data.hasOwnProperty(e)},n.prototype.get=function(e){return this.data[e]},n.prototype.set=function(e,t){return this.data[e]=t,this},n.prototype.keys=function(){return Wr(this.data)},n.prototype.forEach=function(e){var t=this.data;for(var r in t)t.hasOwnProperty(r)&&e(t[r],r)},n}(),L7=typeof Map=="function";function j2e(){return L7?new Map:new G2e}var q2e=function(){function n(e){var t=Rt(e);this.data=j2e();var r=this;e instanceof n?e.each(i):e&&ce(e,i);function i(a,s){t?r.set(a,s):r.set(s,a)}}return n.prototype.hasKey=function(e){return this.data.has(e)},n.prototype.get=function(e){return this.data.get(e)},n.prototype.set=function(e,t){return this.data.set(e,t),t},n.prototype.each=function(e,t){this.data.forEach(function(r,i){e.call(t,r,i)})},n.prototype.keys=function(){var e=this.data.keys();return L7?Array.from(e):e},n.prototype.removeKey=function(e){this.data.delete(e)},n}();function dn(n){return new q2e(n)}function X2e(n,e){for(var t=new n.constructor(n.length+e.length),r=0;r<n.length;r++)t[r]=n[r];for(var i=n.length,r=0;r<e.length;r++)t[r+i]=e[r];return t}function hT(n,e){var t;if(Object.create)t=Object.create(n);else{var r=function(){};r.prototype=n,t=new r}return e&&gt(t,e),t}function N7(n){var e=n.style;e.webkitUserSelect="none",e.userSelect="none",e.webkitTapHighlightColor="rgba(0,0,0,0)",e["-webkit-touch-callout"]="none"}function ju(n,e){return n.hasOwnProperty(e)}function Oa(){}var K2e=180/Math.PI;function Hg(n,e){return n==null&&(n=0),e==null&&(e=0),[n,e]}function Y2e(n){return[n[0],n[1]]}function X5(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function Z2e(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function Q2e(n){return Math.sqrt(J2e(n))}function J2e(n){return n[0]*n[0]+n[1]*n[1]}function V2(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function eEe(n,e){var t=Q2e(e);return t===0?(n[0]=0,n[1]=0):(n[0]=e[0]/t,n[1]=e[1]/t),n}function UM(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}var zM=UM;function tEe(n,e){return(n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])}var Rm=tEe;function V1(n,e,t,r){return n[0]=e[0]+r*(t[0]-e[0]),n[1]=e[1]+r*(t[1]-e[1]),n}function mo(n,e,t){var r=e[0],i=e[1];return n[0]=t[0]*r+t[2]*i+t[4],n[1]=t[1]*r+t[3]*i+t[5],n}function fm(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n}function hm(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n}var Rp=function(){function n(e,t){this.target=e,this.topTarget=t&&t.topTarget}return n}(),nEe=function(){function n(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return n.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new Rp(t,e),"dragstart",e.event))},n.prototype._drag=function(e){var t=this._draggingTarget;if(t){var r=e.offsetX,i=e.offsetY,a=r-this._x,s=i-this._y;this._x=r,this._y=i,t.drift(a,s,e),this.handler.dispatchToElement(new Rp(t,e),"drag",e.event);var o=this.handler.findHover(r,i,t).target,l=this._dropTarget;this._dropTarget=o,t!==o&&(l&&o!==l&&this.handler.dispatchToElement(new Rp(l,e),"dragleave",e.event),o&&o!==l&&this.handler.dispatchToElement(new Rp(o,e),"dragenter",e.event))}},n.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new Rp(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new Rp(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},n}();const rEe=nEe;var iEe=function(){function n(e){e&&(this._$eventProcessor=e)}return n.prototype.on=function(e,t,r,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof t=="function"&&(i=r,r=t,t=null),!r||!e)return this;var s=this._$eventProcessor;t!=null&&s&&s.normalizeQuery&&(t=s.normalizeQuery(t)),a[e]||(a[e]=[]);for(var o=0;o<a[e].length;o++)if(a[e][o].h===r)return this;var l={h:r,query:t,ctx:i||this,callAtLast:r.zrEventfulCallAtLast},u=a[e].length-1,c=a[e][u];return c&&c.callAtLast?a[e].splice(u,0,l):a[e].push(l),this},n.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},n.prototype.off=function(e,t){var r=this._$handlers;if(!r)return this;if(!e)return this._$handlers={},this;if(t){if(r[e]){for(var i=[],a=0,s=r[e].length;a<s;a++)r[e][a].h!==t&&i.push(r[e][a]);r[e]=i}r[e]&&r[e].length===0&&delete r[e]}else delete r[e];return this},n.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var i=this._$handlers[e],a=this._$eventProcessor;if(i)for(var s=t.length,o=i.length,l=0;l<o;l++){var u=i[l];if(!(a&&a.filter&&u.query!=null&&!a.filter(e,u.query)))switch(s){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,t[0]);break;case 2:u.h.call(u.ctx,t[0],t[1]);break;default:u.h.apply(u.ctx,t);break}}return a&&a.afterTrigger&&a.afterTrigger(e),this},n.prototype.triggerWithContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var i=this._$handlers[e],a=this._$eventProcessor;if(i)for(var s=t.length,o=t[s-1],l=i.length,u=0;u<l;u++){var c=i[u];if(!(a&&a.filter&&c.query!=null&&!a.filter(e,c.query)))switch(s){case 0:c.h.call(o);break;case 1:c.h.call(o,t[0]);break;case 2:c.h.call(o,t[0],t[1]);break;default:c.h.apply(o,t.slice(1,s-1));break}}return a&&a.afterTrigger&&a.afterTrigger(e),this},n}();const ul=iEe;var aEe=Math.log(2);function VM(n,e,t,r,i,a){var s=r+"-"+i,o=n.length;if(a.hasOwnProperty(s))return a[s];if(e===1){var l=Math.round(Math.log((1<<o)-1&~i)/aEe);return n[t][l]}for(var u=r|1<<t,c=t+1;r&1<<c;)c++;for(var f=0,h=0,d=0;h<o;h++){var p=1<<h;p&i||(f+=(d%2?-1:1)*n[t][h]*VM(n,e-1,c,u,i|p,a),d++)}return a[s]=f,f}function K5(n,e){var t=[[n[0],n[1],1,0,0,0,-e[0]*n[0],-e[0]*n[1]],[0,0,0,n[0],n[1],1,-e[1]*n[0],-e[1]*n[1]],[n[2],n[3],1,0,0,0,-e[2]*n[2],-e[2]*n[3]],[0,0,0,n[2],n[3],1,-e[3]*n[2],-e[3]*n[3]],[n[4],n[5],1,0,0,0,-e[4]*n[4],-e[4]*n[5]],[0,0,0,n[4],n[5],1,-e[5]*n[4],-e[5]*n[5]],[n[6],n[7],1,0,0,0,-e[6]*n[6],-e[6]*n[7]],[0,0,0,n[6],n[7],1,-e[7]*n[6],-e[7]*n[7]]],r={},i=VM(t,8,0,0,0,r);if(i!==0){for(var a=[],s=0;s<8;s++)for(var o=0;o<8;o++)a[o]==null&&(a[o]=0),a[o]+=((s+o)%2?-1:1)*VM(t,7,s===0?1:0,1<<s,1<<o,r)/i*e[s];return function(l,u,c){var f=u*a[6]+c*a[7]+1;l[0]=(u*a[0]+c*a[1]+a[2])/f,l[1]=(u*a[3]+c*a[4]+a[5])/f}}}var Y5="___zrEVENTSAVED",H2=[];function sEe(n,e,t,r,i){return HM(H2,e,r,i,!0)&&HM(n,t,H2[0],H2[1])}function HM(n,e,t,r,i){if(e.getBoundingClientRect&&In.domSupported&&!O7(e)){var a=e[Y5]||(e[Y5]={}),s=oEe(e,a),o=lEe(s,a,i);if(o)return o(n,t,r),!0}return!1}function oEe(n,e){var t=e.markers;if(t)return t;t=e.markers=[];for(var r=["left","right"],i=["top","bottom"],a=0;a<4;a++){var s=document.createElement("div"),o=s.style,l=a%2,u=(a>>1)%2;o.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",r[l]+":0",i[u]+":0",r[1-l]+":auto",i[1-u]+":auto",""].join("!important;"),n.appendChild(s),t.push(s)}return t}function lEe(n,e,t){for(var r=t?"invTrans":"trans",i=e[r],a=e.srcCoords,s=[],o=[],l=!0,u=0;u<4;u++){var c=n[u].getBoundingClientRect(),f=2*u,h=c.left,d=c.top;s.push(h,d),l=l&&a&&h===a[f]&&d===a[f+1],o.push(n[u].offsetLeft,n[u].offsetTop)}return l&&i?i:(e.srcCoords=s,e[r]=t?K5(o,s):K5(s,o))}function O7(n){return n.nodeName.toUpperCase()==="CANVAS"}var uEe=/([&<>"'])/g,cEe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Zs(n){return n==null?"":(n+"").replace(uEe,function(e,t){return cEe[t]})}var fEe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,W2=[],hEe=In.browser.firefox&&+In.browser.version.split(".")[0]<39;function WM(n,e,t,r){return t=t||{},r?Z5(n,e,t):hEe&&e.layerX!=null&&e.layerX!==e.offsetX?(t.zrX=e.layerX,t.zrY=e.layerY):e.offsetX!=null?(t.zrX=e.offsetX,t.zrY=e.offsetY):Z5(n,e,t),t}function Z5(n,e,t){if(In.domSupported&&n.getBoundingClientRect){var r=e.clientX,i=e.clientY;if(O7(n)){var a=n.getBoundingClientRect();t.zrX=r-a.left,t.zrY=i-a.top;return}else if(HM(W2,n,r,i)){t.zrX=W2[0],t.zrY=W2[1];return}}t.zrX=t.zrY=0}function wI(n){return n||window.event}function Gs(n,e,t){if(e=wI(e),e.zrX!=null)return e;var r=e.type,i=r&&r.indexOf("touch")>=0;if(i){var s=r!=="touchend"?e.targetTouches[0]:e.changedTouches[0];s&&WM(n,s,e,t)}else{WM(n,e,e,t);var a=dEe(e);e.zrDelta=a?a/120:-(e.detail||0)/3}var o=e.button;return e.which==null&&o!==void 0&&fEe.test(e.type)&&(e.which=o&1?1:o&2?3:o&4?2:0),e}function dEe(n){var e=n.wheelDelta;if(e)return e;var t=n.deltaX,r=n.deltaY;if(t==null||r==null)return e;var i=Math.abs(r!==0?r:t),a=r>0?-1:r<0?1:t>0?-1:1;return 3*i*a}function GM(n,e,t,r){n.addEventListener(e,t,r)}function pEe(n,e,t,r){n.removeEventListener(e,t,r)}var $7=function(n){n.preventDefault(),n.stopPropagation(),n.cancelBubble=!0},mEe=function(){function n(){this._track=[]}return n.prototype.recognize=function(e,t,r){return this._doTrack(e,t,r),this._recognize(e)},n.prototype.clear=function(){return this._track.length=0,this},n.prototype._doTrack=function(e,t,r){var i=e.touches;if(i){for(var a={points:[],touches:[],target:t,event:e},s=0,o=i.length;s<o;s++){var l=i[s],u=WM(r,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},n.prototype._recognize=function(e){for(var t in G2)if(G2.hasOwnProperty(t)){var r=G2[t](this._track,e);if(r)return r}},n}();function Q5(n){var e=n[1][0]-n[0][0],t=n[1][1]-n[0][1];return Math.sqrt(e*e+t*t)}function gEe(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}var G2={pinch:function(n,e){var t=n.length;if(t){var r=(n[t-1]||{}).points,i=(n[t-2]||{}).points||r;if(i&&i.length>1&&r&&r.length>1){var a=Q5(r)/Q5(i);!isFinite(a)&&(a=1),e.pinchScale=a;var s=gEe(r);return e.pinchX=s[0],e.pinchY=s[1],{type:"pinch",target:n[0].target,event:e}}}}};function sg(){return[1,0,0,1,0,0]}function SI(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function vEe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Pm(n,e,t){var r=e[0]*t[0]+e[2]*t[1],i=e[1]*t[0]+e[3]*t[1],a=e[0]*t[2]+e[2]*t[3],s=e[1]*t[2]+e[3]*t[3],o=e[0]*t[4]+e[2]*t[5]+e[4],l=e[1]*t[4]+e[3]*t[5]+e[5];return n[0]=r,n[1]=i,n[2]=a,n[3]=s,n[4]=o,n[5]=l,n}function Aw(n,e,t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4]+t[0],n[5]=e[5]+t[1],n}function dT(n,e,t){var r=e[0],i=e[2],a=e[4],s=e[1],o=e[3],l=e[5],u=Math.sin(t),c=Math.cos(t);return n[0]=r*c+s*u,n[1]=-r*u+s*c,n[2]=i*c+o*u,n[3]=-i*u+c*o,n[4]=c*a+u*l,n[5]=c*l-u*a,n}function yEe(n,e,t){var r=t[0],i=t[1];return n[0]=e[0]*r,n[1]=e[1]*i,n[2]=e[2]*r,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*i,n}function pT(n,e){var t=e[0],r=e[2],i=e[4],a=e[1],s=e[3],o=e[5],l=t*s-a*r;return l?(l=1/l,n[0]=s*l,n[1]=-a*l,n[2]=-r*l,n[3]=t*l,n[4]=(r*o-s*i)*l,n[5]=(a*i-t*o)*l,n):null}var _Ee=function(){function n(e,t){this.x=e||0,this.y=t||0}return n.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set=function(e,t){return this.x=e,this.y=t,this},n.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},n.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},n.prototype.scale=function(e){this.x*=e,this.y*=e},n.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},n.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},n.prototype.dot=function(e){return this.x*e.x+this.y*e.y},n.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},n.prototype.distance=function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},n.prototype.distanceSquare=function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.transform=function(e){if(e){var t=this.x,r=this.y;return this.x=e[0]*t+e[2]*r+e[4],this.y=e[1]*t+e[3]*r+e[5],this}},n.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},n.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},n.set=function(e,t,r){e.x=t,e.y=r},n.copy=function(e,t){e.x=t.x,e.y=t.y},n.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.lenSquare=function(e){return e.x*e.x+e.y*e.y},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.add=function(e,t,r){e.x=t.x+r.x,e.y=t.y+r.y},n.sub=function(e,t,r){e.x=t.x-r.x,e.y=t.y-r.y},n.scale=function(e,t,r){e.x=t.x*r,e.y=t.y*r},n.scaleAndAdd=function(e,t,r,i){e.x=t.x+r.x*i,e.y=t.y+r.y*i},n.lerp=function(e,t,r,i){var a=1-i;e.x=a*t.x+i*r.x,e.y=a*t.y+i*r.y},n}();const nn=_Ee;var fb=Math.min,hb=Math.max,Zf=new nn,Qf=new nn,Jf=new nn,eh=new nn,Fv=new nn,Bv=new nn,xEe=function(){function n(e,t,r,i){r<0&&(e=e+r,r=-r),i<0&&(t=t+i,i=-i),this.x=e,this.y=t,this.width=r,this.height=i}return n.prototype.union=function(e){var t=fb(e.x,this.x),r=fb(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=hb(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=hb(e.y+e.height,this.y+this.height)-r:this.height=e.height,this.x=t,this.y=r},n.prototype.applyTransform=function(e){n.applyTransform(this,this,e)},n.prototype.calculateTransform=function(e){var t=this,r=e.width/t.width,i=e.height/t.height,a=sg();return Aw(a,a,[-t.x,-t.y]),yEe(a,a,[r,i]),Aw(a,a,[e.x,e.y]),a},n.prototype.intersect=function(e,t){if(!e)return!1;e instanceof n||(e=n.create(e));var r=this,i=r.x,a=r.x+r.width,s=r.y,o=r.y+r.height,l=e.x,u=e.x+e.width,c=e.y,f=e.y+e.height,h=!(a<l||u<i||o<c||f<s);if(t){var d=1/0,p=0,m=Math.abs(a-l),g=Math.abs(u-i),v=Math.abs(o-c),_=Math.abs(f-s),x=Math.min(m,g),b=Math.min(v,_);a<l||u<i?x>p&&(p=x,m<g?nn.set(Bv,-m,0):nn.set(Bv,g,0)):x<d&&(d=x,m<g?nn.set(Fv,m,0):nn.set(Fv,-g,0)),o<c||f<s?b>p&&(p=b,v<_?nn.set(Bv,0,-v):nn.set(Bv,0,_)):x<d&&(d=x,v<_?nn.set(Fv,0,v):nn.set(Fv,0,-_))}return t&&nn.copy(t,h?Fv:Bv),h},n.prototype.contain=function(e,t){var r=this;return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copy=function(e){n.copy(this,e)},n.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},n.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.prototype.isZero=function(){return this.width===0||this.height===0},n.create=function(e){return new n(e.x,e.y,e.width,e.height)},n.copy=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},n.applyTransform=function(e,t,r){if(!r){e!==t&&n.copy(e,t);return}if(r[1]<1e-5&&r[1]>-1e-5&&r[2]<1e-5&&r[2]>-1e-5){var i=r[0],a=r[3],s=r[4],o=r[5];e.x=t.x*i+s,e.y=t.y*a+o,e.width=t.width*i,e.height=t.height*a,e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height);return}Zf.x=Jf.x=t.x,Zf.y=eh.y=t.y,Qf.x=eh.x=t.x+t.width,Qf.y=Jf.y=t.y+t.height,Zf.transform(r),eh.transform(r),Qf.transform(r),Jf.transform(r),e.x=fb(Zf.x,Qf.x,Jf.x,eh.x),e.y=fb(Zf.y,Qf.y,Jf.y,eh.y);var l=hb(Zf.x,Qf.x,Jf.x,eh.x),u=hb(Zf.y,Qf.y,Jf.y,eh.y);e.width=l-e.x,e.height=u-e.y},n}();const Xn=xEe;var F7="silent";function bEe(n,e,t){return{type:n,event:t,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:t.zrX,offsetY:t.zrY,gestureEvent:t.gestureEvent,pinchX:t.pinchX,pinchY:t.pinchY,pinchScale:t.pinchScale,wheelDelta:t.zrDelta,zrByTouch:t.zrByTouch,which:t.which,stop:wEe}}function wEe(){$7(this.event)}var SEe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.handler=null,t}return e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(ul),Uv=function(){function n(e,t){this.x=e,this.y=t}return n}(),TEe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],j2=new Xn(0,0,0,0),B7=function(n){ht(e,n);function e(t,r,i,a,s){var o=n.call(this)||this;return o._hovered=new Uv(0,0),o.storage=t,o.painter=r,o.painterRoot=a,o._pointerSize=s,i=i||new SEe,o.proxy=null,o.setHandlerProxy(i),o._draggingMgr=new rEe(o),o}return e.prototype.setHandlerProxy=function(t){this.proxy&&this.proxy.dispose(),t&&(ce(TEe,function(r){t.on&&t.on(r,this[r],this)},this),t.handler=this),this.proxy=t},e.prototype.mousemove=function(t){var r=t.zrX,i=t.zrY,a=U7(this,r,i),s=this._hovered,o=s.target;o&&!o.__zr&&(s=this.findHover(s.x,s.y),o=s.target);var l=this._hovered=a?new Uv(r,i):this.findHover(r,i),u=l.target,c=this.proxy;c.setCursor&&c.setCursor(u?u.cursor:"default"),o&&u!==o&&this.dispatchToElement(s,"mouseout",t),this.dispatchToElement(l,"mousemove",t),u&&u!==o&&this.dispatchToElement(l,"mouseover",t)},e.prototype.mouseout=function(t){var r=t.zrEventControl;r!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",t),r!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:t})},e.prototype.resize=function(){this._hovered=new Uv(0,0)},e.prototype.dispatch=function(t,r){var i=this[t];i&&i.call(this,r)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(t){var r=this.proxy;r.setCursor&&r.setCursor(t)},e.prototype.dispatchToElement=function(t,r,i){t=t||{};var a=t.target;if(!(a&&a.silent)){for(var s="on"+r,o=bEe(r,t,i);a&&(a[s]&&(o.cancelBubble=!!a[s].call(a,o)),a.trigger(r,o),a=a.__hostTarget?a.__hostTarget:a.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(r,o),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[s]=="function"&&l[s].call(l,o),l.trigger&&l.trigger(r,o)}))}},e.prototype.findHover=function(t,r,i){var a=this.storage.getDisplayList(),s=new Uv(t,r);if(J5(a,s,t,r,i),this._pointerSize&&!s.target){for(var o=[],l=this._pointerSize,u=l/2,c=new Xn(t-u,r-u,l,l),f=a.length-1;f>=0;f--){var h=a[f];h!==i&&!h.ignore&&!h.ignoreCoarsePointer&&(!h.parent||!h.parent.ignoreCoarsePointer)&&(j2.copy(h.getBoundingRect()),h.transform&&j2.applyTransform(h.transform),j2.intersect(c)&&o.push(h))}if(o.length)for(var d=4,p=Math.PI/12,m=Math.PI*2,g=0;g<u;g+=d)for(var v=0;v<m;v+=p){var _=t+g*Math.cos(v),x=r+g*Math.sin(v);if(J5(o,s,_,x,i),s.target)return s}}return s},e.prototype.processGesture=function(t,r){this._gestureMgr||(this._gestureMgr=new mEe);var i=this._gestureMgr;r==="start"&&i.clear();var a=i.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if(r==="end"&&i.clear(),a){var s=a.type;t.gestureEvent=s;var o=new Uv;o.target=a.target,this.dispatchToElement(o,s,a.event)}},e}(ul);ce(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){B7.prototype[n]=function(e){var t=e.zrX,r=e.zrY,i=U7(this,t,r),a,s;if((n!=="mouseup"||!i)&&(a=this.findHover(t,r),s=a.target),n==="mousedown")this._downEl=s,this._downPoint=[e.zrX,e.zrY],this._upEl=s;else if(n==="mouseup")this._upEl=s;else if(n==="click"){if(this._downEl!==this._upEl||!this._downPoint||zM(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,n,e)}});function CEe(n,e,t){if(n[n.rectHover?"rectContain":"contain"](e,t)){for(var r=n,i=void 0,a=!1;r;){if(r.ignoreClip&&(a=!0),!a){var s=r.getClipPath();if(s&&!s.contain(e,t))return!1;r.silent&&(i=!0)}var o=r.__hostTarget;r=o||r.parent}return i?F7:!0}return!1}function J5(n,e,t,r,i){for(var a=n.length-1;a>=0;a--){var s=n[a],o=void 0;if(s!==i&&!s.ignore&&(o=CEe(s,t,r))&&(!e.topTarget&&(e.topTarget=s),o!==F7)){e.target=s;break}}}function U7(n,e,t){var r=n.painter;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}const EEe=B7;var z7=32,zv=7;function AEe(n){for(var e=0;n>=z7;)e|=n&1,n>>=1;return n+e}function eU(n,e,t,r){var i=e+1;if(i===t)return 1;if(r(n[i++],n[e])<0){for(;i<t&&r(n[i],n[i-1])<0;)i++;MEe(n,e,i)}else for(;i<t&&r(n[i],n[i-1])>=0;)i++;return i-e}function MEe(n,e,t){for(t--;e<t;){var r=n[e];n[e++]=n[t],n[t--]=r}}function tU(n,e,t,r,i){for(r===e&&r++;r<t;r++){for(var a=n[r],s=e,o=r,l;s<o;)l=s+o>>>1,i(a,n[l])<0?o=l:s=l+1;var u=r-s;switch(u){case 3:n[s+3]=n[s+2];case 2:n[s+2]=n[s+1];case 1:n[s+1]=n[s];break;default:for(;u>0;)n[s+u]=n[s+u-1],u--}n[s]=a}}function q2(n,e,t,r,i,a){var s=0,o=0,l=1;if(a(n,e[t+i])>0){for(o=r-i;l<o&&a(n,e[t+i+l])>0;)s=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o),s+=i,l+=i}else{for(o=i+1;l<o&&a(n,e[t+i-l])<=0;)s=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o);var u=s;s=i-l,l=i-u}for(s++;s<l;){var c=s+(l-s>>>1);a(n,e[t+c])>0?s=c+1:l=c}return l}function X2(n,e,t,r,i,a){var s=0,o=0,l=1;if(a(n,e[t+i])<0){for(o=i+1;l<o&&a(n,e[t+i-l])<0;)s=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o);var u=s;s=i-l,l=i-u}else{for(o=r-i;l<o&&a(n,e[t+i+l])>=0;)s=l,l=(l<<1)+1,l<=0&&(l=o);l>o&&(l=o),s+=i,l+=i}for(s++;s<l;){var c=s+(l-s>>>1);a(n,e[t+c])<0?l=c:s=c+1}return l}function kEe(n,e){var t=zv,r,i,a=0;n.length;var s=[];r=[],i=[];function o(d,p){r[a]=d,i[a]=p,a+=1}function l(){for(;a>1;){var d=a-2;if(d>=1&&i[d-1]<=i[d]+i[d+1]||d>=2&&i[d-2]<=i[d]+i[d-1])i[d-1]<i[d+1]&&d--;else if(i[d]>i[d+1])break;c(d)}}function u(){for(;a>1;){var d=a-2;d>0&&i[d-1]<i[d+1]&&d--,c(d)}}function c(d){var p=r[d],m=i[d],g=r[d+1],v=i[d+1];i[d]=m+v,d===a-3&&(r[d+1]=r[d+2],i[d+1]=i[d+2]),a--;var _=X2(n[g],n,p,m,0,e);p+=_,m-=_,m!==0&&(v=q2(n[p+m-1],n,g,v,v-1,e),v!==0&&(m<=v?f(p,m,g,v):h(p,m,g,v)))}function f(d,p,m,g){var v=0;for(v=0;v<p;v++)s[v]=n[d+v];var _=0,x=m,b=d;if(n[b++]=n[x++],--g===0){for(v=0;v<p;v++)n[b+v]=s[_+v];return}if(p===1){for(v=0;v<g;v++)n[b+v]=n[x+v];n[b+g]=s[_];return}for(var S=t,T,M,C;;){T=0,M=0,C=!1;do if(e(n[x],s[_])<0){if(n[b++]=n[x++],M++,T=0,--g===0){C=!0;break}}else if(n[b++]=s[_++],T++,M=0,--p===1){C=!0;break}while((T|M)<S);if(C)break;do{if(T=X2(n[x],s,_,p,0,e),T!==0){for(v=0;v<T;v++)n[b+v]=s[_+v];if(b+=T,_+=T,p-=T,p<=1){C=!0;break}}if(n[b++]=n[x++],--g===0){C=!0;break}if(M=q2(s[_],n,x,g,0,e),M!==0){for(v=0;v<M;v++)n[b+v]=n[x+v];if(b+=M,x+=M,g-=M,g===0){C=!0;break}}if(n[b++]=s[_++],--p===1){C=!0;break}S--}while(T>=zv||M>=zv);if(C)break;S<0&&(S=0),S+=2}if(t=S,t<1&&(t=1),p===1){for(v=0;v<g;v++)n[b+v]=n[x+v];n[b+g]=s[_]}else{if(p===0)throw new Error;for(v=0;v<p;v++)n[b+v]=s[_+v]}}function h(d,p,m,g){var v=0;for(v=0;v<g;v++)s[v]=n[m+v];var _=d+p-1,x=g-1,b=m+g-1,S=0,T=0;if(n[b--]=n[_--],--p===0){for(S=b-(g-1),v=0;v<g;v++)n[S+v]=s[v];return}if(g===1){for(b-=p,_-=p,T=b+1,S=_+1,v=p-1;v>=0;v--)n[T+v]=n[S+v];n[b]=s[x];return}for(var M=t;;){var C=0,k=0,R=!1;do if(e(s[x],n[_])<0){if(n[b--]=n[_--],C++,k=0,--p===0){R=!0;break}}else if(n[b--]=s[x--],k++,C=0,--g===1){R=!0;break}while((C|k)<M);if(R)break;do{if(C=p-X2(s[x],n,d,p,p-1,e),C!==0){for(b-=C,_-=C,p-=C,T=b+1,S=_+1,v=C-1;v>=0;v--)n[T+v]=n[S+v];if(p===0){R=!0;break}}if(n[b--]=s[x--],--g===1){R=!0;break}if(k=g-q2(n[_],s,0,g,g-1,e),k!==0){for(b-=k,x-=k,g-=k,T=b+1,S=x+1,v=0;v<k;v++)n[T+v]=s[S+v];if(g<=1){R=!0;break}}if(n[b--]=n[_--],--p===0){R=!0;break}M--}while(C>=zv||k>=zv);if(R)break;M<0&&(M=0),M+=2}if(t=M,t<1&&(t=1),g===1){for(b-=p,_-=p,T=b+1,S=_+1,v=p-1;v>=0;v--)n[T+v]=n[S+v];n[b]=s[x]}else{if(g===0)throw new Error;for(S=b-(g-1),v=0;v<g;v++)n[S+v]=s[v]}}return{mergeRuns:l,forceMergeRuns:u,pushRun:o}}function H1(n,e,t,r){t||(t=0),r||(r=n.length);var i=r-t;if(!(i<2)){var a=0;if(i<z7){a=eU(n,t,r,e),tU(n,t,r,t+a,e);return}var s=kEe(n,e),o=AEe(i);do{if(a=eU(n,t,r,e),a<o){var l=i;l>o&&(l=o),tU(n,t,t+l,t+a,e),a=l}s.pushRun(t,a),s.mergeRuns(),i-=a,t+=a}while(i!==0);s.forceMergeRuns()}}var Ts=1,vy=2,rm=4,nU=!1;function K2(){nU||(nU=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function rU(n,e){return n.zlevel===e.zlevel?n.z===e.z?n.z2-e.z2:n.z-e.z:n.zlevel-e.zlevel}var REe=function(){function n(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=rU}return n.prototype.traverse=function(e,t){for(var r=0;r<this._roots.length;r++)this._roots[r].traverse(e,t)},n.prototype.getDisplayList=function(e,t){t=t||!1;var r=this._displayList;return(e||!r.length)&&this.updateDisplayList(t),r},n.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,r=this._displayList,i=0,a=t.length;i<a;i++)this._updateAndAddDisplayable(t[i],null,e);r.length=this._displayListLen,H1(r,rU)},n.prototype._updateAndAddDisplayable=function(e,t,r){if(!(e.ignore&&!r)){e.beforeUpdate(),e.update(),e.afterUpdate();var i=e.getClipPath();if(e.ignoreClip)t=null;else if(i){t?t=t.slice():t=[];for(var a=i,s=e;a;)a.parent=s,a.updateTransform(),t.push(a),s=a,a=a.getClipPath()}if(e.childrenRef){for(var o=e.childrenRef(),l=0;l<o.length;l++){var u=o[l];e.__dirty&&(u.__dirty|=Ts),this._updateAndAddDisplayable(u,t,r)}e.__dirty=0}else{var c=e;t&&t.length?c.__clipPaths=t:c.__clipPaths&&c.__clipPaths.length>0&&(c.__clipPaths=[]),isNaN(c.z)&&(K2(),c.z=0),isNaN(c.z2)&&(K2(),c.z2=0),isNaN(c.zlevel)&&(K2(),c.zlevel=0),this._displayList[this._displayListLen++]=c}var f=e.getDecalElement&&e.getDecalElement();f&&this._updateAndAddDisplayable(f,t,r);var h=e.getTextGuideLine();h&&this._updateAndAddDisplayable(h,t,r);var d=e.getTextContent();d&&this._updateAndAddDisplayable(d,t,r)}},n.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},n.prototype.delRoot=function(e){if(e instanceof Array){for(var t=0,r=e.length;t<r;t++)this.delRoot(e[t]);return}var i=Vn(this._roots,e);i>=0&&this._roots.splice(i,1)},n.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},n.prototype.getRoots=function(){return this._roots},n.prototype.dispose=function(){this._displayList=null,this._roots=null},n}();const PEe=REe;var V7;V7=In.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(n){return setTimeout(n,16)};const jM=V7;var W1={linear:function(n){return n},quadraticIn:function(n){return n*n},quadraticOut:function(n){return n*(2-n)},quadraticInOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)},quarticIn:function(n){return n*n*n*n},quarticOut:function(n){return 1- --n*n*n*n},quarticInOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)},quinticIn:function(n){return n*n*n*n*n},quinticOut:function(n){return--n*n*n*n*n+1},quinticInOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)},sinusoidalIn:function(n){return 1-Math.cos(n*Math.PI/2)},sinusoidalOut:function(n){return Math.sin(n*Math.PI/2)},sinusoidalInOut:function(n){return .5*(1-Math.cos(Math.PI*n))},exponentialIn:function(n){return n===0?0:Math.pow(1024,n-1)},exponentialOut:function(n){return n===1?1:1-Math.pow(2,-10*n)},exponentialInOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)},circularIn:function(n){return 1-Math.sqrt(1-n*n)},circularOut:function(n){return Math.sqrt(1- --n*n)},circularInOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)},elasticIn:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)))},elasticOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*n)*Math.sin((n-e)*(2*Math.PI)/r)+1)},elasticInOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),(n*=2)<1?-.5*(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)):t*Math.pow(2,-10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)*.5+1)},backIn:function(n){var e=1.70158;return n*n*((e+1)*n-e)},backOut:function(n){var e=1.70158;return--n*n*((e+1)*n+e)+1},backInOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)},bounceIn:function(n){return 1-W1.bounceOut(1-n)},bounceOut:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},bounceInOut:function(n){return n<.5?W1.bounceIn(n*2)*.5:W1.bounceOut(n*2-1)*.5+.5}};const H7=W1;var db=Math.pow,nf=Math.sqrt,Mw=1e-8,W7=1e-4,iU=nf(3),pb=1/3,Pl=Hg(),Qs=Hg(),Im=Hg();function qc(n){return n>-Mw&&n<Mw}function G7(n){return n>Mw||n<-Mw}function Si(n,e,t,r,i){var a=1-i;return a*a*(a*n+3*i*e)+i*i*(i*r+3*a*t)}function aU(n,e,t,r,i){var a=1-i;return 3*(((e-n)*a+2*(t-e)*i)*a+(r-t)*i*i)}function kw(n,e,t,r,i,a){var s=r+3*(e-t)-n,o=3*(t-e*2+n),l=3*(e-n),u=n-i,c=o*o-3*s*l,f=o*l-9*s*u,h=l*l-3*o*u,d=0;if(qc(c)&&qc(f))if(qc(o))a[0]=0;else{var p=-l/o;p>=0&&p<=1&&(a[d++]=p)}else{var m=f*f-4*c*h;if(qc(m)){var g=f/c,p=-o/s+g,v=-g/2;p>=0&&p<=1&&(a[d++]=p),v>=0&&v<=1&&(a[d++]=v)}else if(m>0){var _=nf(m),x=c*o+1.5*s*(-f+_),b=c*o+1.5*s*(-f-_);x<0?x=-db(-x,pb):x=db(x,pb),b<0?b=-db(-b,pb):b=db(b,pb);var p=(-o-(x+b))/(3*s);p>=0&&p<=1&&(a[d++]=p)}else{var S=(2*c*o-3*s*f)/(2*nf(c*c*c)),T=Math.acos(S)/3,M=nf(c),C=Math.cos(T),p=(-o-2*M*C)/(3*s),v=(-o+M*(C+iU*Math.sin(T)))/(3*s),k=(-o+M*(C-iU*Math.sin(T)))/(3*s);p>=0&&p<=1&&(a[d++]=p),v>=0&&v<=1&&(a[d++]=v),k>=0&&k<=1&&(a[d++]=k)}}return d}function j7(n,e,t,r,i){var a=6*t-12*e+6*n,s=9*e+3*r-3*n-9*t,o=3*e-3*n,l=0;if(qc(s)){if(G7(a)){var u=-o/a;u>=0&&u<=1&&(i[l++]=u)}}else{var c=a*a-4*s*o;if(qc(c))i[0]=-a/(2*s);else if(c>0){var f=nf(c),u=(-a+f)/(2*s),h=(-a-f)/(2*s);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function pf(n,e,t,r,i,a){var s=(e-n)*i+n,o=(t-e)*i+e,l=(r-t)*i+t,u=(o-s)*i+s,c=(l-o)*i+o,f=(c-u)*i+u;a[0]=n,a[1]=s,a[2]=u,a[3]=f,a[4]=f,a[5]=c,a[6]=l,a[7]=r}function q7(n,e,t,r,i,a,s,o,l,u,c){var f,h=.005,d=1/0,p,m,g,v;Pl[0]=l,Pl[1]=u;for(var _=0;_<1;_+=.05)Qs[0]=Si(n,t,i,s,_),Qs[1]=Si(e,r,a,o,_),g=Rm(Pl,Qs),g<d&&(f=_,d=g);d=1/0;for(var x=0;x<32&&!(h<W7);x++)p=f-h,m=f+h,Qs[0]=Si(n,t,i,s,p),Qs[1]=Si(e,r,a,o,p),g=Rm(Qs,Pl),p>=0&&g<d?(f=p,d=g):(Im[0]=Si(n,t,i,s,m),Im[1]=Si(e,r,a,o,m),v=Rm(Im,Pl),m<=1&&v<d?(f=m,d=v):h*=.5);return c&&(c[0]=Si(n,t,i,s,f),c[1]=Si(e,r,a,o,f)),nf(d)}function IEe(n,e,t,r,i,a,s,o,l){for(var u=n,c=e,f=0,h=1/l,d=1;d<=l;d++){var p=d*h,m=Si(n,t,i,s,p),g=Si(e,r,a,o,p),v=m-u,_=g-c;f+=Math.sqrt(v*v+_*_),u=m,c=g}return f}function aa(n,e,t,r){var i=1-r;return i*(i*n+2*r*e)+r*r*t}function sU(n,e,t,r){return 2*((1-r)*(e-n)+r*(t-e))}function DEe(n,e,t,r,i){var a=n-2*e+t,s=2*(e-n),o=n-r,l=0;if(qc(a)){if(G7(s)){var u=-o/s;u>=0&&u<=1&&(i[l++]=u)}}else{var c=s*s-4*a*o;if(qc(c)){var u=-s/(2*a);u>=0&&u<=1&&(i[l++]=u)}else if(c>0){var f=nf(c),u=(-s+f)/(2*a),h=(-s-f)/(2*a);u>=0&&u<=1&&(i[l++]=u),h>=0&&h<=1&&(i[l++]=h)}}return l}function X7(n,e,t){var r=n+t-2*e;return r===0?.5:(n-e)/r}function Rw(n,e,t,r,i){var a=(e-n)*r+n,s=(t-e)*r+e,o=(s-a)*r+a;i[0]=n,i[1]=a,i[2]=o,i[3]=o,i[4]=s,i[5]=t}function K7(n,e,t,r,i,a,s,o,l){var u,c=.005,f=1/0;Pl[0]=s,Pl[1]=o;for(var h=0;h<1;h+=.05){Qs[0]=aa(n,t,i,h),Qs[1]=aa(e,r,a,h);var d=Rm(Pl,Qs);d<f&&(u=h,f=d)}f=1/0;for(var p=0;p<32&&!(c<W7);p++){var m=u-c,g=u+c;Qs[0]=aa(n,t,i,m),Qs[1]=aa(e,r,a,m);var d=Rm(Qs,Pl);if(m>=0&&d<f)u=m,f=d;else{Im[0]=aa(n,t,i,g),Im[1]=aa(e,r,a,g);var v=Rm(Im,Pl);g<=1&&v<f?(u=g,f=v):c*=.5}}return l&&(l[0]=aa(n,t,i,u),l[1]=aa(e,r,a,u)),nf(f)}function LEe(n,e,t,r,i,a,s){for(var o=n,l=e,u=0,c=1/s,f=1;f<=s;f++){var h=f*c,d=aa(n,t,i,h),p=aa(e,r,a,h),m=d-o,g=p-l;u+=Math.sqrt(m*m+g*g),o=d,l=p}return u}var NEe=/cubic-bezier\(([0-9,\.e ]+)\)/;function Y7(n){var e=n&&NEe.exec(n);if(e){var t=e[1].split(","),r=+Dl(t[0]),i=+Dl(t[1]),a=+Dl(t[2]),s=+Dl(t[3]);if(isNaN(r+i+a+s))return;var o=[];return function(l){return l<=0?0:l>=1?1:kw(0,r,a,1,l,o)&&Si(0,i,s,1,o[0])}}}var OEe=function(){function n(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||Oa,this.ondestroy=e.ondestroy||Oa,this.onrestart=e.onrestart||Oa,e.easing&&this.setEasing(e.easing)}return n.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),this._paused){this._pausedTime+=t;return}var r=this._life,i=e-this._startTime-this._pausedTime,a=i/r;a<0&&(a=0),a=Math.min(a,1);var s=this.easingFunc,o=s?s(a):a;if(this.onframe(o),a===1)if(this.loop){var l=i%r;this._startTime=e-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){this._paused=!1},n.prototype.setEasing=function(e){this.easing=e,this.easingFunc=pn(e)?e:H7[e]||Y7(e)},n}();const $Ee=OEe;var Z7=function(){function n(e){this.value=e}return n}(),FEe=function(){function n(){this._len=0}return n.prototype.insert=function(e){var t=new Z7(e);return this.insertEntry(t),t},n.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},n.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._len--},n.prototype.len=function(){return this._len},n.prototype.clear=function(){this.head=this.tail=null,this._len=0},n}(),BEe=function(){function n(e){this._list=new FEe,this._maxSize=10,this._map={},this._maxSize=e}return n.prototype.put=function(e,t){var r=this._list,i=this._map,a=null;if(i[e]==null){var s=r.len(),o=this._lastRemovedEntry;if(s>=this._maxSize&&s>0){var l=r.head;r.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}o?o.value=t:o=new Z7(t),o.key=e,r.insertEntry(o),i[e]=o}return a},n.prototype.get=function(e){var t=this._map[e],r=this._list;if(t!=null)return t!==r.tail&&(r.remove(t),r.insertEntry(t)),t.value},n.prototype.clear=function(){this._list.clear(),this._map={}},n.prototype.len=function(){return this._list.len()},n}();const E_=BEe;var oU={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function rf(n){return n=Math.round(n),n<0?0:n>255?255:n}function qM(n){return n<0?0:n>1?1:n}function Y2(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?rf(parseFloat(e)/100*255):rf(parseInt(e,10))}function Xy(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?qM(parseFloat(e)/100):qM(parseFloat(e))}function Z2(n,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?n+(e-n)*t*6:t*2<1?e:t*3<2?n+(e-n)*(2/3-t)*6:n}function mb(n,e,t){return n+(e-n)*t}function Vs(n,e,t,r,i){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function XM(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}var Q7=new E_(20),gb=null;function Pp(n,e){gb&&XM(gb,e),gb=Q7.put(n,gb||e.slice())}function Uu(n,e){if(n){e=e||[];var t=Q7.get(n);if(t)return XM(e,t);n=n+"";var r=n.replace(/ /g,"").toLowerCase();if(r in oU)return XM(e,oU[r]),Pp(n,e),e;var i=r.length;if(r.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(r.slice(1,4),16);if(!(a>=0&&a<=4095)){Vs(e,0,0,0,1);return}return Vs(e,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(r.slice(4),16)/15:1),Pp(n,e),e}else if(i===7||i===9){var a=parseInt(r.slice(1,7),16);if(!(a>=0&&a<=16777215)){Vs(e,0,0,0,1);return}return Vs(e,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(r.slice(7),16)/255:1),Pp(n,e),e}return}var s=r.indexOf("("),o=r.indexOf(")");if(s!==-1&&o+1===i){var l=r.substr(0,s),u=r.substr(s+1,o-(s+1)).split(","),c=1;switch(l){case"rgba":if(u.length!==4)return u.length===3?Vs(e,+u[0],+u[1],+u[2],1):Vs(e,0,0,0,1);c=Xy(u.pop());case"rgb":if(u.length>=3)return Vs(e,Y2(u[0]),Y2(u[1]),Y2(u[2]),u.length===3?c:Xy(u[3])),Pp(n,e),e;Vs(e,0,0,0,1);return;case"hsla":if(u.length!==4){Vs(e,0,0,0,1);return}return u[3]=Xy(u[3]),lU(u,e),Pp(n,e),e;case"hsl":if(u.length!==3){Vs(e,0,0,0,1);return}return lU(u,e),Pp(n,e),e;default:return}}Vs(e,0,0,0,1)}}function lU(n,e){var t=(parseFloat(n[0])%360+360)%360/360,r=Xy(n[1]),i=Xy(n[2]),a=i<=.5?i*(r+1):i+r-i*r,s=i*2-a;return e=e||[],Vs(e,rf(Z2(s,a,t+1/3)*255),rf(Z2(s,a,t)*255),rf(Z2(s,a,t-1/3)*255),1),n.length===4&&(e[3]=n[3]),e}function uU(n,e){var t=Uu(n);if(t){for(var r=0;r<3;r++)e<0?t[r]=t[r]*(1-e)|0:t[r]=(255-t[r])*e+t[r]|0,t[r]>255?t[r]=255:t[r]<0&&(t[r]=0);return mT(t,t.length===4?"rgba":"rgb")}}function UEe(n,e,t){if(!(!(e&&e.length)||!(n>=0&&n<=1))){var r=n*(e.length-1),i=Math.floor(r),a=Math.ceil(r),s=Uu(e[i]),o=Uu(e[a]),l=r-i,u=mT([rf(mb(s[0],o[0],l)),rf(mb(s[1],o[1],l)),rf(mb(s[2],o[2],l)),qM(mb(s[3],o[3],l))],"rgba");return t?{color:u,leftIndex:i,rightIndex:a,value:r}:u}}function mT(n,e){if(!(!n||!n.length)){var t=n[0]+","+n[1]+","+n[2];return(e==="rgba"||e==="hsva"||e==="hsla")&&(t+=","+n[3]),e+"("+t+")"}}function Pw(n,e){var t=Uu(n);return t?(.299*t[0]+.587*t[1]+.114*t[2])*t[3]/255+(1-t[3])*e:0}function zEe(n){return n.type==="linear"}function VEe(n){return n.type==="radial"}(function(){return In.hasGlobalWindow&&pn(window.btoa)?function(n){return window.btoa(unescape(encodeURIComponent(n)))}:typeof Buffer<"u"?function(n){return Buffer.from(n).toString("base64")}:function(n){return null}})();var KM=Array.prototype.slice;function Tu(n,e,t){return(e-n)*t+n}function Q2(n,e,t,r){for(var i=e.length,a=0;a<i;a++)n[a]=Tu(e[a],t[a],r);return n}function HEe(n,e,t,r){for(var i=e.length,a=i&&e[0].length,s=0;s<i;s++){n[s]||(n[s]=[]);for(var o=0;o<a;o++)n[s][o]=Tu(e[s][o],t[s][o],r)}return n}function vb(n,e,t,r){for(var i=e.length,a=0;a<i;a++)n[a]=e[a]+t[a]*r;return n}function cU(n,e,t,r){for(var i=e.length,a=i&&e[0].length,s=0;s<i;s++){n[s]||(n[s]=[]);for(var o=0;o<a;o++)n[s][o]=e[s][o]+t[s][o]*r}return n}function WEe(n,e){for(var t=n.length,r=e.length,i=t>r?e:n,a=Math.min(t,r),s=i[a-1]||{color:[0,0,0,0],offset:0},o=a;o<Math.max(t,r);o++)i.push({offset:s.offset,color:s.color.slice()})}function GEe(n,e,t){var r=n,i=e;if(!(!r.push||!i.push)){var a=r.length,s=i.length;if(a!==s){var o=a>s;if(o)r.length=s;else for(var l=a;l<s;l++)r.push(t===1?i[l]:KM.call(i[l]))}for(var u=r[0]&&r[0].length,l=0;l<r.length;l++)if(t===1)isNaN(r[l])&&(r[l]=i[l]);else for(var c=0;c<u;c++)isNaN(r[l][c])&&(r[l][c]=i[l][c])}}function G1(n){if(Fa(n)){var e=n.length;if(Fa(n[0])){for(var t=[],r=0;r<e;r++)t.push(KM.call(n[r]));return t}return KM.call(n)}return n}function j1(n){return n[0]=Math.floor(n[0])||0,n[1]=Math.floor(n[1])||0,n[2]=Math.floor(n[2])||0,n[3]=n[3]==null?1:n[3],"rgba("+n.join(",")+")"}function jEe(n){return Fa(n&&n[0])?2:1}var yb=0,q1=1,J7=2,yy=3,YM=4,ZM=5,fU=6;function hU(n){return n===YM||n===ZM}function _b(n){return n===q1||n===J7}var Vv=[0,0,0,0],qEe=function(){function n(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return n.prototype.isFinished=function(){return this._finished},n.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},n.prototype.needsAnimate=function(){return this.keyframes.length>=1},n.prototype.getAdditiveTrack=function(){return this._additiveTrack},n.prototype.addKeyframe=function(e,t,r){this._needsSort=!0;var i=this.keyframes,a=i.length,s=!1,o=fU,l=t;if(Fa(t)){var u=jEe(t);o=u,(u===1&&!gr(t[0])||u===2&&!gr(t[0][0]))&&(s=!0)}else if(gr(t)&&!Cw(t))o=yb;else if(jt(t))if(!isNaN(+t))o=yb;else{var c=Uu(t);c&&(l=c,o=yy)}else if(fT(t)){var f=gt({},l);f.colorStops=Nt(t.colorStops,function(d){return{offset:d.offset,color:Uu(d.color)}}),zEe(t)?o=YM:VEe(t)&&(o=ZM),l=f}a===0?this.valType=o:(o!==this.valType||o===fU)&&(s=!0),this.discrete=this.discrete||s;var h={time:e,value:l,rawValue:t,percent:0};return r&&(h.easing=r,h.easingFunc=pn(r)?r:H7[r]||Y7(r)),i.push(h),h},n.prototype.prepare=function(e,t){var r=this.keyframes;this._needsSort&&r.sort(function(m,g){return m.time-g.time});for(var i=this.valType,a=r.length,s=r[a-1],o=this.discrete,l=_b(i),u=hU(i),c=0;c<a;c++){var f=r[c],h=f.value,d=s.value;f.percent=f.time/e,o||(l&&c!==a-1?GEe(h,d,i):u&&WEe(h.colorStops,d.colorStops))}if(!o&&i!==ZM&&t&&this.needsAnimate()&&t.needsAnimate()&&i===t.valType&&!t._finished){this._additiveTrack=t;for(var p=r[0].value,c=0;c<a;c++)i===yb?r[c].additiveValue=r[c].value-p:i===yy?r[c].additiveValue=vb([],r[c].value,p,-1):_b(i)&&(r[c].additiveValue=i===q1?vb([],r[c].value,p,-1):cU([],r[c].value,p,-1))}},n.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r=this._additiveTrack!=null,i=r?"additiveValue":"value",a=this.valType,s=this.keyframes,o=s.length,l=this.propName,u=a===yy,c,f=this._lastFr,h=Math.min,d,p;if(o===1)d=p=s[0];else{if(t<0)c=0;else if(t<this._lastFrP){var m=h(f+1,o-1);for(c=m;c>=0&&!(s[c].percent<=t);c--);c=h(c,o-2)}else{for(c=f;c<o&&!(s[c].percent>t);c++);c=h(c-1,o-2)}p=s[c+1],d=s[c]}if(d&&p){this._lastFr=c,this._lastFrP=t;var g=p.percent-d.percent,v=g===0?1:h((t-d.percent)/g,1);p.easingFunc&&(v=p.easingFunc(v));var _=r?this._additiveValue:u?Vv:e[l];if((_b(a)||u)&&!_&&(_=this._additiveValue=[]),this.discrete)e[l]=v<1?d.rawValue:p.rawValue;else if(_b(a))a===q1?Q2(_,d[i],p[i],v):HEe(_,d[i],p[i],v);else if(hU(a)){var x=d[i],b=p[i],S=a===YM;e[l]={type:S?"linear":"radial",x:Tu(x.x,b.x,v),y:Tu(x.y,b.y,v),colorStops:Nt(x.colorStops,function(M,C){var k=b.colorStops[C];return{offset:Tu(M.offset,k.offset,v),color:j1(Q2([],M.color,k.color,v))}}),global:b.global},S?(e[l].x2=Tu(x.x2,b.x2,v),e[l].y2=Tu(x.y2,b.y2,v)):e[l].r=Tu(x.r,b.r,v)}else if(u)Q2(_,d[i],p[i],v),r||(e[l]=j1(_));else{var T=Tu(d[i],p[i],v);r?this._additiveValue=T:e[l]=T}r&&this._addToTarget(e)}}},n.prototype._addToTarget=function(e){var t=this.valType,r=this.propName,i=this._additiveValue;t===yb?e[r]=e[r]+i:t===yy?(Uu(e[r],Vv),vb(Vv,Vv,i,1),e[r]=j1(Vv)):t===q1?vb(e[r],e[r],i,1):t===J7&&cU(e[r],e[r],i,1)},n}(),XEe=function(){function n(e,t,r,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&i){xI("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=r}return n.prototype.getMaxTime=function(){return this._maxTime},n.prototype.getDelay=function(){return this._delay},n.prototype.getLoop=function(){return this._loop},n.prototype.getTarget=function(){return this._target},n.prototype.changeTarget=function(e){this._target=e},n.prototype.when=function(e,t,r){return this.whenWithKeys(e,t,Wr(t),r)},n.prototype.whenWithKeys=function(e,t,r,i){for(var a=this._tracks,s=0;s<r.length;s++){var o=r[s],l=a[o];if(!l){l=a[o]=new qEe(o);var u=void 0,c=this._getAdditiveTrack(o);if(c){var f=c.keyframes,h=f[f.length-1];u=h&&h.value,c.valType===yy&&u&&(u=j1(u))}else u=this._target[o];if(u==null)continue;e>0&&l.addKeyframe(0,G1(u),i),this._trackKeys.push(o)}l.addKeyframe(e,G1(t[o]),i)}return this._maxTime=Math.max(this._maxTime,e),this},n.prototype.pause=function(){this._clip.pause(),this._paused=!0},n.prototype.resume=function(){this._clip.resume(),this._paused=!1},n.prototype.isPaused=function(){return!!this._paused},n.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},n.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,r=0;r<t;r++)e[r].call(this)},n.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var r=0;r<t.length;r++)t[r].call(this)},n.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,r=0;r<t.length;r++)e[t[r]].setFinished()},n.prototype._getAdditiveTrack=function(e){var t,r=this._additiveAnimators;if(r)for(var i=0;i<r.length;i++){var a=r[i].getTrack(e);a&&(t=a)}return t},n.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,r=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var s=this._trackKeys[a],o=this._tracks[s],l=this._getAdditiveTrack(s),u=o.keyframes,c=u.length;if(o.prepare(i,l),o.needsAnimate())if(!this._allowDiscrete&&o.discrete){var f=u[c-1];f&&(t._target[o.propName]=f.rawValue),o.setFinished()}else r.push(o)}if(r.length||this._force){var h=new $Ee({life:i,loop:this._loop,delay:this._delay||0,onframe:function(d){t._started=2;var p=t._additiveAnimators;if(p){for(var m=!1,g=0;g<p.length;g++)if(p[g]._clip){m=!0;break}m||(t._additiveAnimators=null)}for(var g=0;g<r.length;g++)r[g].step(t._target,d);var v=t._onframeCbs;if(v)for(var g=0;g<v.length;g++)v[g](t._target,d)},ondestroy:function(){t._doneCallback()}});this._clip=h,this.animation&&this.animation.addClip(h),e&&h.setEasing(e)}else this._doneCallback();return this}},n.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},n.prototype.delay=function(e){return this._delay=e,this},n.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},n.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},n.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},n.prototype.getClip=function(){return this._clip},n.prototype.getTrack=function(e){return this._tracks[e]},n.prototype.getTracks=function(){var e=this;return Nt(this._trackKeys,function(t){return e._tracks[t]})},n.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var r=this._tracks,i=this._trackKeys,a=0;a<e.length;a++){var s=r[e[a]];s&&!s.isFinished()&&(t?s.step(this._target,1):this._started===1&&s.step(this._target,0),s.setFinished())}for(var o=!0,a=0;a<i.length;a++)if(!r[i[a]].isFinished()){o=!1;break}return o&&this._abortedCallback(),o},n.prototype.saveTo=function(e,t,r){if(e){t=t||this._trackKeys;for(var i=0;i<t.length;i++){var a=t[i],s=this._tracks[a];if(!(!s||s.isFinished())){var o=s.keyframes,l=o[r?0:o.length-1];l&&(e[a]=G1(l.rawValue))}}}},n.prototype.__changeFinalValue=function(e,t){t=t||Wr(e);for(var r=0;r<t.length;r++){var i=t[r],a=this._tracks[i];if(a){var s=a.keyframes;if(s.length>1){var o=s.pop();a.addKeyframe(o.time,e[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},n}();const TI=XEe;function dm(){return new Date().getTime()}var KEe=function(n){ht(e,n);function e(t){var r=n.call(this)||this;return r._running=!1,r._time=0,r._pausedTime=0,r._pauseStart=0,r._paused=!1,t=t||{},r.stage=t.stage||{},r}return e.prototype.addClip=function(t){t.animation&&this.removeClip(t),this._head?(this._tail.next=t,t.prev=this._tail,t.next=null,this._tail=t):this._head=this._tail=t,t.animation=this},e.prototype.addAnimator=function(t){t.animation=this;var r=t.getClip();r&&this.addClip(r)},e.prototype.removeClip=function(t){if(t.animation){var r=t.prev,i=t.next;r?r.next=i:this._head=i,i?i.prev=r:this._tail=r,t.next=t.prev=t.animation=null}},e.prototype.removeAnimator=function(t){var r=t.getClip();r&&this.removeClip(r),t.animation=null},e.prototype.update=function(t){for(var r=dm()-this._pausedTime,i=r-this._time,a=this._head;a;){var s=a.next,o=a.step(r,i);o&&(a.ondestroy(),this.removeClip(a)),a=s}this._time=r,t||(this.trigger("frame",i),this.stage.update&&this.stage.update())},e.prototype._startLoop=function(){var t=this;this._running=!0;function r(){t._running&&(jM(r),!t._paused&&t.update())}jM(r)},e.prototype.start=function(){this._running||(this._time=dm(),this._pausedTime=0,this._startLoop())},e.prototype.stop=function(){this._running=!1},e.prototype.pause=function(){this._paused||(this._pauseStart=dm(),this._paused=!0)},e.prototype.resume=function(){this._paused&&(this._pausedTime+=dm()-this._pauseStart,this._paused=!1)},e.prototype.clear=function(){for(var t=this._head;t;){var r=t.next;t.prev=t.next=t.animation=null,t=r}this._head=this._tail=null},e.prototype.isFinished=function(){return this._head==null},e.prototype.animate=function(t,r){r=r||{},this.start();var i=new TI(t,r.loop);return this.addAnimator(i),i},e}(ul);const YEe=KEe;var ZEe=300,J2=In.domSupported,eE=function(){var n=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],e=["touchstart","touchend","touchmove"],t={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},r=Nt(n,function(i){var a=i.replace("mouse","pointer");return t.hasOwnProperty(a)?a:i});return{mouse:n,touch:e,pointer:r}}(),dU={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},pU=!1;function QM(n){var e=n.pointerType;return e==="pen"||e==="touch"}function QEe(n){n.touching=!0,n.touchTimer!=null&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout(function(){n.touching=!1,n.touchTimer=null},700)}function tE(n){n&&(n.zrByTouch=!0)}function JEe(n,e){return Gs(n.dom,new eAe(n,e),!0)}function eq(n,e){for(var t=e,r=!1;t&&t.nodeType!==9&&!(r=t.domBelongToZr||t!==e&&t===n.painterRoot);)t=t.parentNode;return r}var eAe=function(){function n(e,t){this.stopPropagation=Oa,this.stopImmediatePropagation=Oa,this.preventDefault=Oa,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY}return n}(),Oo={mousedown:function(n){n=Gs(this.dom,n),this.__mayPointerCapture=[n.zrX,n.zrY],this.trigger("mousedown",n)},mousemove:function(n){n=Gs(this.dom,n);var e=this.__mayPointerCapture;e&&(n.zrX!==e[0]||n.zrY!==e[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",n)},mouseup:function(n){n=Gs(this.dom,n),this.__togglePointerCapture(!1),this.trigger("mouseup",n)},mouseout:function(n){n=Gs(this.dom,n);var e=n.toElement||n.relatedTarget;eq(this,e)||(this.__pointerCapturing&&(n.zrEventControl="no_globalout"),this.trigger("mouseout",n))},wheel:function(n){pU=!0,n=Gs(this.dom,n),this.trigger("mousewheel",n)},mousewheel:function(n){pU||(n=Gs(this.dom,n),this.trigger("mousewheel",n))},touchstart:function(n){n=Gs(this.dom,n),tE(n),this.__lastTouchMoment=new Date,this.handler.processGesture(n,"start"),Oo.mousemove.call(this,n),Oo.mousedown.call(this,n)},touchmove:function(n){n=Gs(this.dom,n),tE(n),this.handler.processGesture(n,"change"),Oo.mousemove.call(this,n)},touchend:function(n){n=Gs(this.dom,n),tE(n),this.handler.processGesture(n,"end"),Oo.mouseup.call(this,n),+new Date-+this.__lastTouchMoment<ZEe&&Oo.click.call(this,n)},pointerdown:function(n){Oo.mousedown.call(this,n)},pointermove:function(n){QM(n)||Oo.mousemove.call(this,n)},pointerup:function(n){Oo.mouseup.call(this,n)},pointerout:function(n){QM(n)||Oo.mouseout.call(this,n)}};ce(["click","dblclick","contextmenu"],function(n){Oo[n]=function(e){e=Gs(this.dom,e),this.trigger(n,e)}});var JM={pointermove:function(n){QM(n)||JM.mousemove.call(this,n)},pointerup:function(n){JM.mouseup.call(this,n)},mousemove:function(n){this.trigger("mousemove",n)},mouseup:function(n){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",n),e&&(n.zrEventControl="only_globalout",this.trigger("mouseout",n))}};function tAe(n,e){var t=e.domHandlers;In.pointerEventsSupported?ce(eE.pointer,function(r){X1(e,r,function(i){t[r].call(n,i)})}):(In.touchEventsSupported&&ce(eE.touch,function(r){X1(e,r,function(i){t[r].call(n,i),QEe(e)})}),ce(eE.mouse,function(r){X1(e,r,function(i){i=wI(i),e.touching||t[r].call(n,i)})}))}function nAe(n,e){In.pointerEventsSupported?ce(dU.pointer,t):In.touchEventsSupported||ce(dU.mouse,t);function t(r){function i(a){a=wI(a),eq(n,a.target)||(a=JEe(n,a),e.domHandlers[r].call(n,a))}X1(e,r,i,{capture:!0})}}function X1(n,e,t,r){n.mounted[e]=t,n.listenerOpts[e]=r,GM(n.domTarget,e,t,r)}function nE(n){var e=n.mounted;for(var t in e)e.hasOwnProperty(t)&&pEe(n.domTarget,t,e[t],n.listenerOpts[t]);n.mounted={}}var mU=function(){function n(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t}return n}(),rAe=function(n){ht(e,n);function e(t,r){var i=n.call(this)||this;return i.__pointerCapturing=!1,i.dom=t,i.painterRoot=r,i._localHandlerScope=new mU(t,Oo),J2&&(i._globalHandlerScope=new mU(document,JM)),tAe(i,i._localHandlerScope),i}return e.prototype.dispose=function(){nE(this._localHandlerScope),J2&&nE(this._globalHandlerScope)},e.prototype.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},e.prototype.__togglePointerCapture=function(t){if(this.__mayPointerCapture=null,J2&&+this.__pointerCapturing^+t){this.__pointerCapturing=t;var r=this._globalHandlerScope;t?nAe(this,r):nE(r)}},e}(ul);const iAe=rAe;var tq=1;In.hasGlobalWindow&&(tq=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var Iw=tq,ek=.4,tk="#333",nk="#ccc",aAe="#eee",gU=SI,vU=5e-5;function th(n){return n>vU||n<-vU}var nh=[],Ip=[],rE=sg(),iE=Math.abs,sAe=function(){function n(){}return n.prototype.getLocalTransform=function(e){return n.getLocalTransform(this,e)},n.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},n.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},n.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},n.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},n.prototype.needLocalTransform=function(){return th(this.rotation)||th(this.x)||th(this.y)||th(this.scaleX-1)||th(this.scaleY-1)||th(this.skewX)||th(this.skewY)},n.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),r=this.transform;if(!(t||e)){r&&gU(r);return}r=r||sg(),t?this.getLocalTransform(r):gU(r),e&&(t?Pm(r,e,r):vEe(r,e)),this.transform=r,this._resolveGlobalScaleRatio(r)},n.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(t!=null&&t!==1){this.getGlobalScale(nh);var r=nh[0]<0?-1:1,i=nh[1]<0?-1:1,a=((nh[0]-r)*t+r)/nh[0]||0,s=((nh[1]-i)*t+i)/nh[1]||0;e[0]*=a,e[1]*=a,e[2]*=s,e[3]*=s}this.invTransform=this.invTransform||sg(),pT(this.invTransform,e)},n.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},n.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],r=e[2]*e[2]+e[3]*e[3],i=Math.atan2(e[1],e[0]),a=Math.PI/2+i-Math.atan2(e[3],e[2]);r=Math.sqrt(r)*Math.cos(a),t=Math.sqrt(t),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=r,this.originX=0,this.originY=0}},n.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(Pm(Ip,e.invTransform,t),t=Ip);var r=this.originX,i=this.originY;(r||i)&&(rE[4]=r,rE[5]=i,Pm(Ip,t,rE),Ip[4]-=r,Ip[5]-=i,t=Ip),this.setLocalTransform(t)}},n.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},n.prototype.transformCoordToLocal=function(e,t){var r=[e,t],i=this.invTransform;return i&&mo(r,r,i),r},n.prototype.transformCoordToGlobal=function(e,t){var r=[e,t],i=this.transform;return i&&mo(r,r,i),r},n.prototype.getLineScale=function(){var e=this.transform;return e&&iE(e[0]-1)>1e-10&&iE(e[3]-1)>1e-10?Math.sqrt(iE(e[0]*e[3]-e[2]*e[1])):1},n.prototype.copyTransform=function(e){oAe(this,e)},n.getLocalTransform=function(e,t){t=t||[];var r=e.originX||0,i=e.originY||0,a=e.scaleX,s=e.scaleY,o=e.anchorX,l=e.anchorY,u=e.rotation||0,c=e.x,f=e.y,h=e.skewX?Math.tan(e.skewX):0,d=e.skewY?Math.tan(-e.skewY):0;if(r||i||o||l){var p=r+o,m=i+l;t[4]=-p*a-h*m*s,t[5]=-m*s-d*p*a}else t[4]=t[5]=0;return t[0]=a,t[3]=s,t[1]=d*a,t[2]=h*s,u&&dT(t,t,u),t[4]+=r+c,t[5]+=i+f,t},n.initDefaultProps=function(){var e=n.prototype;e.scaleX=e.scaleY=e.globalScaleRatio=1,e.x=e.y=e.originX=e.originY=e.skewX=e.skewY=e.rotation=e.anchorX=e.anchorY=0}(),n}(),F0=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function oAe(n,e){for(var t=0;t<F0.length;t++){var r=F0[t];n[r]=e[r]}}const A_=sAe;var yU={};function ks(n,e){e=e||vd;var t=yU[e];t||(t=yU[e]=new E_(500));var r=t.get(n);return r==null&&(r=zg.measureText(n,e).width,t.put(n,r)),r}function _U(n,e,t,r){var i=ks(n,e),a=CI(e),s=_y(0,i,t),o=im(0,a,r),l=new Xn(s,o,i,a);return l}function M_(n,e,t,r){var i=((n||"")+"").split(`
`),a=i.length;if(a===1)return _U(i[0],e,t,r);for(var s=new Xn(0,0,0,0),o=0;o<i.length;o++){var l=_U(i[o],e,t,r);o===0?s.copy(l):s.union(l)}return s}function _y(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function im(n,e,t){return t==="middle"?n-=e/2:t==="bottom"&&(n-=e),n}function CI(n){return ks("",n)}function mf(n,e){return typeof n=="string"?n.lastIndexOf("%")>=0?parseFloat(n)/100*e:parseFloat(n):n}function Dw(n,e,t){var r=e.position||"inside",i=e.distance!=null?e.distance:5,a=t.height,s=t.width,o=a/2,l=t.x,u=t.y,c="left",f="top";if(r instanceof Array)l+=mf(r[0],t.width),u+=mf(r[1],t.height),c=null,f=null;else switch(r){case"left":l-=i,u+=o,c="right",f="middle";break;case"right":l+=i+s,u+=o,f="middle";break;case"top":l+=s/2,u-=i,c="center",f="bottom";break;case"bottom":l+=s/2,u+=a+i,c="center";break;case"inside":l+=s/2,u+=o,c="center",f="middle";break;case"insideLeft":l+=i,u+=o,f="middle";break;case"insideRight":l+=s-i,u+=o,c="right",f="middle";break;case"insideTop":l+=s/2,u+=i,c="center";break;case"insideBottom":l+=s/2,u+=a-i,c="center",f="bottom";break;case"insideTopLeft":l+=i,u+=i;break;case"insideTopRight":l+=s-i,u+=i,c="right";break;case"insideBottomLeft":l+=i,u+=a-i,f="bottom";break;case"insideBottomRight":l+=s-i,u+=a-i,c="right",f="bottom";break}return n=n||{},n.x=l,n.y=u,n.align=c,n.verticalAlign=f,n}var aE="__zr_normal__",sE=F0.concat(["ignore"]),lAe=df(F0,function(n,e){return n[e]=!0,n},{ignore:!1}),Dp={},uAe=new Xn(0,0,0,0),EI=function(){function n(e){this.id=P7(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return n.prototype._init=function(e){this.attr(e)},n.prototype.drift=function(e,t,r){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=e,i[5]+=t,this.decomposeTransform(),this.markRedraw()},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},n.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var r=this.textConfig,i=r.local,a=t.innerTransformable,s=void 0,o=void 0,l=!1;a.parent=i?this:null;var u=!1;if(a.copyTransform(t),r.position!=null){var c=uAe;r.layoutRect?c.copy(r.layoutRect):c.copy(this.getBoundingRect()),i||c.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Dp,r,c):Dw(Dp,r,c),a.x=Dp.x,a.y=Dp.y,s=Dp.align,o=Dp.verticalAlign;var f=r.origin;if(f&&r.rotation!=null){var h=void 0,d=void 0;f==="center"?(h=c.width*.5,d=c.height*.5):(h=mf(f[0],c.width),d=mf(f[1],c.height)),u=!0,a.originX=-a.x+h+(i?0:c.x),a.originY=-a.y+d+(i?0:c.y)}}r.rotation!=null&&(a.rotation=r.rotation);var p=r.offset;p&&(a.x+=p[0],a.y+=p[1],u||(a.originX=-p[0],a.originY=-p[1]));var m=r.inside==null?typeof r.position=="string"&&r.position.indexOf("inside")>=0:r.inside,g=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),v=void 0,_=void 0,x=void 0;m&&this.canBeInsideText()?(v=r.insideFill,_=r.insideStroke,(v==null||v==="auto")&&(v=this.getInsideTextFill()),(_==null||_==="auto")&&(_=this.getInsideTextStroke(v),x=!0)):(v=r.outsideFill,_=r.outsideStroke,(v==null||v==="auto")&&(v=this.getOutsideFill()),(_==null||_==="auto")&&(_=this.getOutsideStroke(v),x=!0)),v=v||"#000",(v!==g.fill||_!==g.stroke||x!==g.autoStroke||s!==g.align||o!==g.verticalAlign)&&(l=!0,g.fill=v,g.stroke=_,g.autoStroke=x,g.align=s,g.verticalAlign=o,t.setDefaultTextStyle(g)),t.__dirty|=Ts,l&&t.dirtyStyle(!0)}},n.prototype.canBeInsideText=function(){return!0},n.prototype.getInsideTextFill=function(){return"#fff"},n.prototype.getInsideTextStroke=function(e){return"#000"},n.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?nk:tk},n.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),r=typeof t=="string"&&Uu(t);r||(r=[255,255,255,1]);for(var i=r[3],a=this.__zr.isDarkMode(),s=0;s<3;s++)r[s]=r[s]*i+(a?0:255)*(1-i);return r[3]=1,mT(r,"rgba")},n.prototype.traverse=function(e,t){},n.prototype.attrKV=function(e,t){e==="textConfig"?this.setTextConfig(t):e==="textContent"?this.setTextContent(t):e==="clipPath"?this.setClipPath(t):e==="extra"?(this.extra=this.extra||{},gt(this.extra,t)):this[e]=t},n.prototype.hide=function(){this.ignore=!0,this.markRedraw()},n.prototype.show=function(){this.ignore=!1,this.markRedraw()},n.prototype.attr=function(e,t){if(typeof e=="string")this.attrKV(e,t);else if(Yt(e))for(var r=e,i=Wr(r),a=0;a<i.length;a++){var s=i[a];this.attrKV(s,e[s])}return this.markRedraw(),this},n.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,r=0;r<this.animators.length;r++){var i=this.animators[r],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==aE)){var s=i.targetName,o=s?t[s]:t;i.saveTo(o)}}},n.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,sE)},n.prototype._savePrimaryToNormal=function(e,t,r){for(var i=0;i<r.length;i++){var a=r[i];e[a]!=null&&!(a in t)&&(t[a]=this[a])}},n.prototype.hasState=function(){return this.currentStates.length>0},n.prototype.getState=function(e){return this.states[e]},n.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},n.prototype.clearStates=function(e){this.useState(aE,!1,e)},n.prototype.useState=function(e,t,r,i){var a=e===aE,s=this.hasState();if(!(!s&&a)){var o=this.currentStates,l=this.stateTransition;if(!(Vn(o,e)>=0&&(t||o.length===1))){var u;if(this.stateProxy&&!a&&(u=this.stateProxy(e)),u||(u=this.states&&this.states[e]),!u&&!a){xI("State "+e+" not exists.");return}a||this.saveCurrentToNormalState(u);var c=!!(u&&u.hoverLayer||i);c&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,u,this._normalState,t,!r&&!this.__inHover&&l&&l.duration>0,l);var f=this._textContent,h=this._textGuide;return f&&f.useState(e,t,r,c),h&&h.useState(e,t,r,c),a?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!c&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Ts),u}}},n.prototype.useStates=function(e,t,r){if(!e.length)this.clearStates();else{var i=[],a=this.currentStates,s=e.length,o=s===a.length;if(o){for(var l=0;l<s;l++)if(e[l]!==a[l]){o=!1;break}}if(o)return;for(var l=0;l<s;l++){var u=e[l],c=void 0;this.stateProxy&&(c=this.stateProxy(u,e)),c||(c=this.states[u]),c&&i.push(c)}var f=i[s-1],h=!!(f&&f.hoverLayer||r);h&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(i),p=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(e.join(","),d,this._normalState,!1,!t&&!this.__inHover&&p&&p.duration>0,p);var m=this._textContent,g=this._textGuide;m&&m.useStates(e,t,h),g&&g.useStates(e,t,h),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Ts)}},n.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},n.prototype.removeState=function(e){var t=Vn(this.currentStates,e);if(t>=0){var r=this.currentStates.slice();r.splice(t,1),this.useStates(r)}},n.prototype.replaceState=function(e,t,r){var i=this.currentStates.slice(),a=Vn(i,e),s=Vn(i,t)>=0;a>=0?s?i.splice(a,1):i[a]=t:r&&!s&&i.push(t),this.useStates(i)},n.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},n.prototype._mergeStates=function(e){for(var t={},r,i=0;i<e.length;i++){var a=e[i];gt(t,a),a.textConfig&&(r=r||{},gt(r,a.textConfig))}return r&&(t.textConfig=r),t},n.prototype._applyStateObj=function(e,t,r,i,a,s){var o=!(t&&i);t&&t.textConfig?(this.textConfig=gt({},i?this.textConfig:r.textConfig),gt(this.textConfig,t.textConfig)):o&&r.textConfig&&(this.textConfig=r.textConfig);for(var l={},u=!1,c=0;c<sE.length;c++){var f=sE[c],h=a&&lAe[f];t&&t[f]!=null?h?(u=!0,l[f]=t[f]):this[f]=t[f]:o&&r[f]!=null&&(h?(u=!0,l[f]=r[f]):this[f]=r[f])}if(!a)for(var c=0;c<this.animators.length;c++){var d=this.animators[c],p=d.targetName;d.getLoop()||d.__changeFinalValue(p?(t||r)[p]:t||r)}u&&this._transitionState(e,l,s)},n.prototype._attachComponent=function(e){if(!(e.__zr&&!e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},n.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},n.prototype.getClipPath=function(){return this._clipPath},n.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},n.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},n.prototype.getTextContent=function(){return this._textContent},n.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new A_,this._attachComponent(e),this._textContent=e,this.markRedraw())},n.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),gt(this.textConfig,e),this.markRedraw()},n.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},n.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},n.prototype.getTextGuideLine=function(){return this._textGuide},n.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},n.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},n.prototype.markRedraw=function(){this.__dirty|=Ts;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},n.prototype.dirty=function(){this.markRedraw()},n.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,r=this._textGuide;t&&(t.__inHover=e),r&&(r.__inHover=e)},n.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.addAnimator(t[r]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},n.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.removeAnimator(t[r]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},n.prototype.animate=function(e,t,r){var i=e?this[e]:this,a=new TI(i,t,r);return e&&(a.targetName=e),this.addAnimator(a,e),a},n.prototype.addAnimator=function(e,t){var r=this.__zr,i=this;e.during(function(){i.updateDuringAnimation(t)}).done(function(){var a=i.animators,s=Vn(a,e);s>=0&&a.splice(s,1)}),this.animators.push(e),r&&r.animation.addAnimator(e),r&&r.wakeUp()},n.prototype.updateDuringAnimation=function(e){this.markRedraw()},n.prototype.stopAnimation=function(e,t){for(var r=this.animators,i=r.length,a=[],s=0;s<i;s++){var o=r[s];!e||e===o.scope?o.stop(t):a.push(o)}return this.animators=a,this},n.prototype.animateTo=function(e,t,r){oE(this,e,t,r)},n.prototype.animateFrom=function(e,t,r){oE(this,e,t,r,!0)},n.prototype._transitionState=function(e,t,r,i){for(var a=oE(this,t,r,i),s=0;s<a.length;s++)a[s].__fromStateTransition=e},n.prototype.getBoundingRect=function(){return null},n.prototype.getPaintRect=function(){return null},n.initDefaultProps=function(){var e=n.prototype;e.type="element",e.name="",e.ignore=e.silent=e.isGroup=e.draggable=e.dragging=e.ignoreClip=e.__inHover=!1,e.__dirty=Ts;function t(r,i,a,s){Object.defineProperty(e,r,{get:function(){if(!this[i]){var l=this[i]=[];o(this,l)}return this[i]},set:function(l){this[a]=l[0],this[s]=l[1],this[i]=l,o(this,l)}});function o(l,u){Object.defineProperty(u,0,{get:function(){return l[a]},set:function(c){l[a]=c}}),Object.defineProperty(u,1,{get:function(){return l[s]},set:function(c){l[s]=c}})}}Object.defineProperty&&(t("position","_legacyPos","x","y"),t("scale","_legacyScale","scaleX","scaleY"),t("origin","_legacyOrigin","originX","originY"))}(),n}();ll(EI,ul);ll(EI,A_);function oE(n,e,t,r,i){t=t||{};var a=[];nq(n,"",n,e,t,r,a,i);var s=a.length,o=!1,l=t.done,u=t.aborted,c=function(){o=!0,s--,s<=0&&(o?l&&l():u&&u())},f=function(){s--,s<=0&&(o?l&&l():u&&u())};s||l&&l(),a.length>0&&t.during&&a[0].during(function(p,m){t.during(m)});for(var h=0;h<a.length;h++){var d=a[h];c&&d.done(c),f&&d.aborted(f),t.force&&d.duration(t.duration),d.start(t.easing)}return a}function lE(n,e,t){for(var r=0;r<t;r++)n[r]=e[r]}function cAe(n){return Fa(n[0])}function fAe(n,e,t){if(Fa(e[t]))if(Fa(n[t])||(n[t]=[]),Rs(e[t])){var r=e[t].length;n[t].length!==r&&(n[t]=new e[t].constructor(r),lE(n[t],e[t],r))}else{var i=e[t],a=n[t],s=i.length;if(cAe(i))for(var o=i[0].length,l=0;l<s;l++)a[l]?lE(a[l],i[l],o):a[l]=Array.prototype.slice.call(i[l]);else lE(a,i,s);a.length=i.length}else n[t]=e[t]}function hAe(n,e){return n===e||Fa(n)&&Fa(e)&&dAe(n,e)}function dAe(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function nq(n,e,t,r,i,a,s,o){for(var l=Wr(r),u=i.duration,c=i.delay,f=i.additive,h=i.setToFinal,d=!Yt(a),p=n.animators,m=[],g=0;g<l.length;g++){var v=l[g],_=r[v];if(_!=null&&t[v]!=null&&(d||a[v]))if(Yt(_)&&!Fa(_)&&!fT(_)){if(e){o||(t[v]=_,n.updateDuringAnimation(e));continue}nq(n,v,t[v],_,i,a&&a[v],s,o)}else m.push(v);else o||(t[v]=_,n.updateDuringAnimation(e),m.push(v))}var x=m.length;if(!f&&x)for(var b=0;b<p.length;b++){var S=p[b];if(S.targetName===e){var T=S.stopTracks(m);if(T){var M=Vn(p,S);p.splice(M,1)}}}if(i.force||(m=si(m,function(P){return!hAe(r[P],t[P])}),x=m.length),x>0||i.force&&!s.length){var C=void 0,k=void 0,R=void 0;if(o){k={},h&&(C={});for(var b=0;b<x;b++){var v=m[b];k[v]=t[v],h?C[v]=r[v]:t[v]=r[v]}}else if(h){R={};for(var b=0;b<x;b++){var v=m[b];R[v]=G1(t[v]),fAe(t,r,v)}}var S=new TI(t,!1,!1,f?si(p,function(N){return N.targetName===e}):null);S.targetName=e,i.scope&&(S.scope=i.scope),h&&C&&S.whenWithKeys(0,C,m),R&&S.whenWithKeys(0,R,m),S.whenWithKeys(u??500,o?k:r,m).delay(c||0),n.addAnimator(S,e),s.push(S)}}const rq=EI;var iq=function(n){ht(e,n);function e(t){var r=n.call(this)||this;return r.isGroup=!0,r._children=[],r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.children=function(){return this._children.slice()},e.prototype.childAt=function(t){return this._children[t]},e.prototype.childOfName=function(t){for(var r=this._children,i=0;i<r.length;i++)if(r[i].name===t)return r[i]},e.prototype.childCount=function(){return this._children.length},e.prototype.add=function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},e.prototype.addBefore=function(t,r){if(t&&t!==this&&t.parent!==this&&r&&r.parent===this){var i=this._children,a=i.indexOf(r);a>=0&&(i.splice(a,0,t),this._doAdd(t))}return this},e.prototype.replace=function(t,r){var i=Vn(this._children,t);return i>=0&&this.replaceAt(r,i),this},e.prototype.replaceAt=function(t,r){var i=this._children,a=i[r];if(t&&t!==this&&t.parent!==this&&t!==a){i[r]=t,a.parent=null;var s=this.__zr;s&&a.removeSelfFromZr(s),this._doAdd(t)}return this},e.prototype._doAdd=function(t){t.parent&&t.parent.remove(t),t.parent=this;var r=this.__zr;r&&r!==t.__zr&&t.addSelfToZr(r),r&&r.refresh()},e.prototype.remove=function(t){var r=this.__zr,i=this._children,a=Vn(i,t);return a<0?this:(i.splice(a,1),t.parent=null,r&&t.removeSelfFromZr(r),r&&r.refresh(),this)},e.prototype.removeAll=function(){for(var t=this._children,r=this.__zr,i=0;i<t.length;i++){var a=t[i];r&&a.removeSelfFromZr(r),a.parent=null}return t.length=0,this},e.prototype.eachChild=function(t,r){for(var i=this._children,a=0;a<i.length;a++){var s=i[a];t.call(r,s,a)}return this},e.prototype.traverse=function(t,r){for(var i=0;i<this._children.length;i++){var a=this._children[i],s=t.call(r,a);a.isGroup&&!s&&a.traverse(t,r)}return this},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++){var i=this._children[r];i.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++){var i=this._children[r];i.removeSelfFromZr(t)}},e.prototype.getBoundingRect=function(t){for(var r=new Xn(0,0,0,0),i=t||this._children,a=[],s=null,o=0;o<i.length;o++){var l=i[o];if(!(l.ignore||l.invisible)){var u=l.getBoundingRect(),c=l.getLocalTransform(a);c?(Xn.applyTransform(r,u,c),s=s||r.clone(),s.union(r)):(s=s||u.clone(),s.union(u))}}return s||r},e}(rq);iq.prototype.type="group";const yi=iq;/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var K1={},aq={};function pAe(n){delete aq[n]}function mAe(n){if(!n)return!1;if(typeof n=="string")return Pw(n,1)<ek;if(n.colorStops){for(var e=n.colorStops,t=0,r=e.length,i=0;i<r;i++)t+=Pw(e[i].color,1);return t/=r,t<ek}return!1}var gAe=function(){function n(e,t,r){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,r=r||{},this.dom=t,this.id=e;var a=new PEe,s=r.renderer||"canvas";K1[s]||(s=Wr(K1)[0]),r.useDirtyRect=r.useDirtyRect==null?!1:r.useDirtyRect;var o=new K1[s](t,a,r,e),l=r.ssr||o.ssrOnly;this.storage=a,this.painter=o;var u=!In.node&&!In.worker&&!l?new iAe(o.getViewportRoot(),o.root):null,c=r.useCoarsePointer,f=c==null||c==="auto"?In.touchEventsSupported:!!c,h=44,d;f&&(d=Hn(r.pointerSize,h)),this.handler=new EEe(a,o,u,o.root,d),this.animation=new YEe({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return n.prototype.add=function(e){e&&(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},n.prototype.remove=function(e){e&&(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},n.prototype.configLayer=function(e,t){this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh()},n.prototype.setBackgroundColor=function(e){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=mAe(e)},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.setDarkMode=function(e){this._darkMode=e},n.prototype.isDarkMode=function(){return this._darkMode},n.prototype.refreshImmediately=function(e){e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},n.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},n.prototype.flush=function(){this._flush(!1)},n.prototype._flush=function(e){var t,r=dm();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var i=dm();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-r})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},n.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},n.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},n.prototype.refreshHover=function(){this._needsRefreshHover=!0},n.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover()},n.prototype.resize=function(e){e=e||{},this.painter.resize(e.width,e.height),this.handler.resize()},n.prototype.clearAnimation=function(){this.animation.clear()},n.prototype.getWidth=function(){return this.painter.getWidth()},n.prototype.getHeight=function(){return this.painter.getHeight()},n.prototype.setCursorStyle=function(e){this.handler.setCursorStyle(e)},n.prototype.findHover=function(e,t){return this.handler.findHover(e,t)},n.prototype.on=function(e,t,r){return this.handler.on(e,t,r),this},n.prototype.off=function(e,t){this.handler.off(e,t)},n.prototype.trigger=function(e,t){this.handler.trigger(e,t)},n.prototype.clear=function(){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof yi&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},n.prototype.dispose=function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,pAe(this.id)},n}();function xU(n,e){var t=new gAe(P7(),n,e);return aq[t.id]=t,t}function vAe(n,e){K1[n]=e}var bU=1e-4,sq=20;function yAe(n){return n.replace(/^\s+|\s+$/g,"")}function Vc(n,e,t,r){var i=e[0],a=e[1],s=t[0],o=t[1],l=a-i,u=o-s;if(l===0)return u===0?s:(s+o)/2;if(r)if(l>0){if(n<=i)return s;if(n>=a)return o}else{if(n>=i)return s;if(n<=a)return o}else{if(n===i)return s;if(n===a)return o}return(n-i)/l*u+s}function Jn(n,e){switch(n){case"center":case"middle":n="50%";break;case"left":case"top":n="0%";break;case"right":case"bottom":n="100%";break}return jt(n)?yAe(n).match(/%$/)?parseFloat(n)/100*e:parseFloat(n):n==null?NaN:+n}function vi(n,e,t){return e==null&&(e=10),e=Math.min(Math.max(0,e),sq),n=(+n).toFixed(e),t?n:+n}function _Ae(n){return n.sort(function(e,t){return e-t}),n}function Lu(n){if(n=+n,isNaN(n))return 0;if(n>1e-14){for(var e=1,t=0;t<15;t++,e*=10)if(Math.round(n*e)/e===n)return t}return xAe(n)}function xAe(n){var e=n.toString().toLowerCase(),t=e.indexOf("e"),r=t>0?+e.slice(t+1):0,i=t>0?t:e.length,a=e.indexOf("."),s=a<0?0:i-1-a;return Math.max(0,s-r)}function oq(n,e){var t=Math.log,r=Math.LN10,i=Math.floor(t(n[1]-n[0])/r),a=Math.round(t(Math.abs(e[1]-e[0]))/r),s=Math.min(Math.max(-i+a,0),20);return isFinite(s)?s:20}function bAe(n,e){var t=df(n,function(d,p){return d+(isNaN(p)?0:p)},0);if(t===0)return[];for(var r=Math.pow(10,e),i=Nt(n,function(d){return(isNaN(d)?0:d)/t*r*100}),a=r*100,s=Nt(i,function(d){return Math.floor(d)}),o=df(s,function(d,p){return d+p},0),l=Nt(i,function(d,p){return d-s[p]});o<a;){for(var u=Number.NEGATIVE_INFINITY,c=null,f=0,h=l.length;f<h;++f)l[f]>u&&(u=l[f],c=f);++s[c],l[c]=0,++o}return Nt(s,function(d){return d/r})}function wAe(n,e){var t=Math.max(Lu(n),Lu(e)),r=n+e;return t>sq?r:vi(r,t)}function lq(n){var e=Math.PI*2;return(n%e+e)%e}function Lw(n){return n>-bU&&n<bU}var SAe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function qu(n){if(n instanceof Date)return n;if(jt(n)){var e=SAe.exec(n);if(!e)return new Date(NaN);if(e[8]){var t=+e[4]||0;return e[8].toUpperCase()!=="Z"&&(t-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,t,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}else return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}else if(n==null)return new Date(NaN);return new Date(Math.round(n))}function TAe(n){return Math.pow(10,AI(n))}function AI(n){if(n===0)return 0;var e=Math.floor(Math.log(n)/Math.LN10);return n/Math.pow(10,e)>=10&&e++,e}function uq(n,e){var t=AI(n),r=Math.pow(10,t),i=n/r,a;return e?i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10:i<1?a=1:i<2?a=2:i<3?a=3:i<5?a=5:a=10,n=a*r,t>=-20?+n.toFixed(t<0?-t:0):n}function gf(n){var e=parseFloat(n);return e==n&&(e!==0||!jt(n)||n.indexOf("x")<=0)?e:NaN}function CAe(n){return!isNaN(gf(n))}function cq(){return Math.round(Math.random()*9)}function fq(n,e){return e===0?n:fq(e,n%e)}function wU(n,e){return n==null?e:e==null?n:n*e/fq(n,e)}function Qn(n){throw new Error(n)}function SU(n,e,t){return(e-n)*t+n}var hq="series\0",dq="\0_ec_\0";function ci(n){return n instanceof Array?n:n==null?[]:[n]}function rk(n,e,t){if(n){n[e]=n[e]||{},n.emphasis=n.emphasis||{},n.emphasis[e]=n.emphasis[e]||{};for(var r=0,i=t.length;r<i;r++){var a=t[r];!n.emphasis[e].hasOwnProperty(a)&&n[e].hasOwnProperty(a)&&(n.emphasis[e][a]=n[e][a])}}}var TU=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function k_(n){return Yt(n)&&!Rt(n)&&!(n instanceof Date)?n.value:n}function EAe(n){return Yt(n)&&!(n instanceof Array)}function AAe(n,e,t){var r=t==="normalMerge",i=t==="replaceMerge",a=t==="replaceAll";n=n||[],e=(e||[]).slice();var s=dn();ce(e,function(l,u){if(!Yt(l)){e[u]=null;return}});var o=MAe(n,s,t);return(r||i)&&kAe(o,n,s,e),r&&RAe(o,e),r||i?PAe(o,e,i):a&&IAe(o,e),DAe(o),o}function MAe(n,e,t){var r=[];if(t==="replaceAll")return r;for(var i=0;i<n.length;i++){var a=n[i];a&&a.id!=null&&e.set(a.id,i),r.push({existing:t==="replaceMerge"||B0(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return r}function kAe(n,e,t,r){ce(r,function(i,a){if(!(!i||i.id==null)){var s=Ky(i.id),o=t.get(s);if(o!=null){var l=n[o];ql(!l.newOption,'Duplicated option on id "'+s+'".'),l.newOption=i,l.existing=e[o],r[a]=null}}})}function RAe(n,e){ce(e,function(t,r){if(!(!t||t.name==null))for(var i=0;i<n.length;i++){var a=n[i].existing;if(!n[i].newOption&&a&&(a.id==null||t.id==null)&&!B0(t)&&!B0(a)&&pq("name",a,t)){n[i].newOption=t,e[r]=null;return}}})}function PAe(n,e,t){ce(e,function(r){if(r){for(var i,a=0;(i=n[a])&&(i.newOption||B0(i.existing)||i.existing&&r.id!=null&&!pq("id",r,i.existing));)a++;i?(i.newOption=r,i.brandNew=t):n.push({newOption:r,brandNew:t,existing:null,keyInfo:null}),a++}})}function IAe(n,e){ce(e,function(t){n.push({newOption:t,brandNew:!0,existing:null,keyInfo:null})})}function DAe(n){var e=dn();ce(n,function(t){var r=t.existing;r&&e.set(r.id,t)}),ce(n,function(t){var r=t.newOption;ql(!r||r.id==null||!e.get(r.id)||e.get(r.id)===t,"id duplicates: "+(r&&r.id)),r&&r.id!=null&&e.set(r.id,t),!t.keyInfo&&(t.keyInfo={})}),ce(n,function(t,r){var i=t.existing,a=t.newOption,s=t.keyInfo;if(Yt(a)){if(s.name=a.name!=null?Ky(a.name):i?i.name:hq+r,i)s.id=Ky(i.id);else if(a.id!=null)s.id=Ky(a.id);else{var o=0;do s.id="\0"+s.name+"\0"+o++;while(e.get(s.id))}e.set(s.id,t)}})}function pq(n,e,t){var r=Fl(e[n],null),i=Fl(t[n],null);return r!=null&&i!=null&&r===i}function Ky(n){return Fl(n,"")}function Fl(n,e){return n==null?e:jt(n)?n:gr(n)||BM(n)?n+"":e}function MI(n){var e=n.name;return!!(e&&e.indexOf(hq))}function B0(n){return n&&n.id!=null&&Ky(n.id).indexOf(dq)===0}function LAe(n){return dq+n}function NAe(n,e,t){ce(n,function(r){var i=r.newOption;Yt(i)&&(r.keyInfo.mainType=e,r.keyInfo.subType=OAe(e,i,r.existing,t))})}function OAe(n,e,t,r){var i=e.type?e.type:t?t.subType:r.determineSubType(n,e);return i}function yd(n,e){if(e.dataIndexInside!=null)return e.dataIndexInside;if(e.dataIndex!=null)return Rt(e.dataIndex)?Nt(e.dataIndex,function(t){return n.indexOfRawIndex(t)}):n.indexOfRawIndex(e.dataIndex);if(e.name!=null)return Rt(e.name)?Nt(e.name,function(t){return n.indexOfName(t)}):n.indexOfName(e.name)}function qr(){var n="__ec_inner_"+$Ae++;return function(e){return e[n]||(e[n]={})}}var $Ae=cq();function Yy(n,e,t){var r=kI(e,t),i=r.mainTypeSpecified,a=r.queryOptionMap,s=r.others,o=s,l=t?t.defaultMainType:null;return!i&&l&&a.set(l,{}),a.each(function(u,c){var f=R_(n,c,u,{useDefault:l===c,enableAll:t&&t.enableAll!=null?t.enableAll:!0,enableNone:t&&t.enableNone!=null?t.enableNone:!0});o[c+"Models"]=f.models,o[c+"Model"]=f.models[0]}),o}function kI(n,e){var t;if(jt(n)){var r={};r[n+"Index"]=0,t=r}else t=n;var i=dn(),a={},s=!1;return ce(t,function(o,l){if(l==="dataIndex"||l==="dataIndexInside"){a[l]=o;return}var u=l.match(/^(\w+)(Index|Id|Name)$/)||[],c=u[1],f=(u[2]||"").toLowerCase();if(!(!c||!f||e&&e.includeMainTypes&&Vn(e.includeMainTypes,c)<0)){s=s||!!c;var h=i.get(c)||i.set(c,{});h[f]=o}}),{mainTypeSpecified:s,queryOptionMap:i,others:a}}var qi={useDefault:!0,enableAll:!1,enableNone:!1},FAe={useDefault:!1,enableAll:!0,enableNone:!0};function R_(n,e,t,r){r=r||qi;var i=t.index,a=t.id,s=t.name,o={models:null,specified:i!=null||a!=null||s!=null};if(!o.specified){var l=void 0;return o.models=r.useDefault&&(l=n.getComponent(e))?[l]:[],o}return i==="none"||i===!1?(ql(r.enableNone,'`"none"` or `false` is not a valid value on index option.'),o.models=[],o):(i==="all"&&(ql(r.enableAll,'`"all"` is not a valid value on index option.'),i=a=s=null),o.models=n.queryComponents({mainType:e,index:i,id:a,name:s}),o)}function mq(n,e,t){n.setAttribute?n.setAttribute(e,t):n[e]=t}function BAe(n,e){return n.getAttribute?n.getAttribute(e):n[e]}function UAe(n){return n==="auto"?In.domSupported?"html":"richText":n||"html"}function gq(n,e,t,r,i){var a=e==null||e==="auto";if(r==null)return r;if(gr(r)){var s=SU(t||0,r,i);return vi(s,a?Math.max(Lu(t||0),Lu(r)):e)}else{if(jt(r))return i<1?t:r;for(var o=[],l=t,u=r,c=Math.max(l?l.length:0,u.length),f=0;f<c;++f){var h=n.getDimensionInfo(f);if(h&&h.type==="ordinal")o[f]=(i<1&&l?l:u)[f];else{var d=l&&l[f]?l[f]:0,p=u[f],s=SU(d,p,i);o[f]=vi(s,a?Math.max(Lu(d),Lu(p)):e)}}return o}}var zAe=".",rh="___EC__COMPONENT__CONTAINER___",vq="___EC__EXTENDED_CLASS___";function Ll(n){var e={main:"",sub:""};if(n){var t=n.split(zAe);e.main=t[0]||"",e.sub=t[1]||""}return e}function VAe(n){ql(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n),'componentType "'+n+'" illegal')}function HAe(n){return!!(n&&n[vq])}function RI(n,e){n.$constructor=n,n.extend=function(t){var r=this,i;return WAe(r)?i=function(a){ht(s,a);function s(){return a.apply(this,arguments)||this}return s}(r):(i=function(){(t.$constructor||r).apply(this,arguments)},z2e(i,this)),gt(i.prototype,t),i[vq]=!0,i.extend=this.extend,i.superCall=qAe,i.superApply=XAe,i.superClass=r,i}}function WAe(n){return pn(n)&&/^class\s/.test(Function.prototype.toString.call(n))}function yq(n,e){n.extend=e.extend}var GAe=Math.round(Math.random()*10);function jAe(n){var e=["__\0is_clz",GAe++].join("_");n.prototype[e]=!0,n.isInstance=function(t){return!!(t&&t[e])}}function qAe(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return this.superClass.prototype[e].apply(n,t)}function XAe(n,e,t){return this.superClass.prototype[e].apply(n,t)}function gT(n){var e={};n.registerClass=function(r){var i=r.type||r.prototype.type;if(i){VAe(i),r.prototype.type=i;var a=Ll(i);if(!a.sub)e[a.main]=r;else if(a.sub!==rh){var s=t(a);s[a.sub]=r}}return r},n.getClass=function(r,i,a){var s=e[r];if(s&&s[rh]&&(s=i?s[i]:null),a&&!s)throw new Error(i?"Component "+r+"."+(i||"")+" is used but not imported.":r+".type should be specified.");return s},n.getClassesByMainType=function(r){var i=Ll(r),a=[],s=e[i.main];return s&&s[rh]?ce(s,function(o,l){l!==rh&&a.push(o)}):a.push(s),a},n.hasClass=function(r){var i=Ll(r);return!!e[i.main]},n.getAllClassMainTypes=function(){var r=[];return ce(e,function(i,a){r.push(a)}),r},n.hasSubTypes=function(r){var i=Ll(r),a=e[i.main];return a&&a[rh]};function t(r){var i=e[r.main];return(!i||!i[rh])&&(i=e[r.main]={},i[rh]=!0),i}}function U0(n,e){for(var t=0;t<n.length;t++)n[t][1]||(n[t][1]=n[t][0]);return e=e||!1,function(r,i,a){for(var s={},o=0;o<n.length;o++){var l=n[o][1];if(!(i&&Vn(i,l)>=0||a&&Vn(a,l)<0)){var u=r.getShallow(l,e);u!=null&&(s[n[o][0]]=u)}}return s}}var KAe=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],YAe=U0(KAe),ZAe=function(){function n(){}return n.prototype.getAreaStyle=function(e,t){return YAe(this,e,t)},n}(),ik=new E_(50);function QAe(n){if(typeof n=="string"){var e=ik.get(n);return e&&e.image}else return n}function _q(n,e,t,r,i){if(n)if(typeof n=="string"){if(e&&e.__zrImageSrc===n||!t)return e;var a=ik.get(n),s={hostEl:t,cb:r,cbPayload:i};return a?(e=a.image,!vT(e)&&a.pending.push(s)):(e=zg.loadImage(n,CU,CU),e.__zrImageSrc=n,ik.put(n,e.__cachedImgObj={image:e,pending:[s]})),e}else return n;else return e}function CU(){var n=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<n.pending.length;e++){var t=n.pending[e],r=t.cb;r&&r(this,t.cbPayload),t.hostEl.dirty()}n.pending.length=0}function vT(n){return n&&n.width&&n.height}var uE=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function JAe(n,e,t,r,i){if(!e)return"";var a=(n+"").split(`
`);i=xq(e,t,r,i);for(var s=0,o=a.length;s<o;s++)a[s]=bq(a[s],i);return a.join(`
`)}function xq(n,e,t,r){r=r||{};var i=gt({},r);i.font=e,t=Hn(t,"..."),i.maxIterations=Hn(r.maxIterations,2);var a=i.minChar=Hn(r.minChar,0);i.cnCharWidth=ks("",e);var s=i.ascCharWidth=ks("a",e);i.placeholder=Hn(r.placeholder,"");for(var o=n=Math.max(0,n-1),l=0;l<a&&o>=s;l++)o-=s;var u=ks(t,e);return u>o&&(t="",u=0),o=n-u,i.ellipsis=t,i.ellipsisWidth=u,i.contentWidth=o,i.containerWidth=n,i}function bq(n,e){var t=e.containerWidth,r=e.font,i=e.contentWidth;if(!t)return"";var a=ks(n,r);if(a<=t)return n;for(var s=0;;s++){if(a<=i||s>=e.maxIterations){n+=e.ellipsis;break}var o=s===0?eMe(n,i,e.ascCharWidth,e.cnCharWidth):a>0?Math.floor(n.length*i/a):0;n=n.substr(0,o),a=ks(n,r)}return n===""&&(n=e.placeholder),n}function eMe(n,e,t,r){for(var i=0,a=0,s=n.length;a<s&&i<e;a++){var o=n.charCodeAt(a);i+=0<=o&&o<=127?t:r}return a}function tMe(n,e){n!=null&&(n+="");var t=e.overflow,r=e.padding,i=e.font,a=t==="truncate",s=CI(i),o=Hn(e.lineHeight,s),l=!!e.backgroundColor,u=e.lineOverflow==="truncate",c=e.width,f;c!=null&&(t==="break"||t==="breakAll")?f=n?wq(n,e.font,c,t==="breakAll",0).lines:[]:f=n?n.split(`
`):[];var h=f.length*o,d=Hn(e.height,h);if(h>d&&u){var p=Math.floor(d/o);f=f.slice(0,p)}if(n&&a&&c!=null)for(var m=xq(c,i,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),g=0;g<f.length;g++)f[g]=bq(f[g],m);for(var v=d,_=0,g=0;g<f.length;g++)_=Math.max(ks(f[g],i),_);c==null&&(c=_);var x=_;return r&&(v+=r[0]+r[2],x+=r[1]+r[3],c+=r[1]+r[3]),l&&(x=c),{lines:f,height:d,outerWidth:x,outerHeight:v,lineHeight:o,calculatedLineHeight:s,contentWidth:_,contentHeight:h,width:c}}var nMe=function(){function n(){}return n}(),EU=function(){function n(e){this.tokens=[],e&&(this.tokens=e)}return n}(),rMe=function(){function n(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return n}();function iMe(n,e){var t=new rMe;if(n!=null&&(n+=""),!n)return t;for(var r=e.width,i=e.height,a=e.overflow,s=(a==="break"||a==="breakAll")&&r!=null?{width:r,accumWidth:0,breakAll:a==="breakAll"}:null,o=uE.lastIndex=0,l;(l=uE.exec(n))!=null;){var u=l.index;u>o&&cE(t,n.substring(o,u),e,s),cE(t,l[2],e,s,l[1]),o=uE.lastIndex}o<n.length&&cE(t,n.substring(o,n.length),e,s);var c=[],f=0,h=0,d=e.padding,p=a==="truncate",m=e.lineOverflow==="truncate";function g(j,K,J){j.width=K,j.lineHeight=J,f+=J,h=Math.max(h,K)}e:for(var v=0;v<t.lines.length;v++){for(var _=t.lines[v],x=0,b=0,S=0;S<_.tokens.length;S++){var T=_.tokens[S],M=T.styleName&&e.rich[T.styleName]||{},C=T.textPadding=M.padding,k=C?C[1]+C[3]:0,R=T.font=M.font||e.font;T.contentHeight=CI(R);var P=Hn(M.height,T.contentHeight);if(T.innerHeight=P,C&&(P+=C[0]+C[2]),T.height=P,T.lineHeight=jy(M.lineHeight,e.lineHeight,P),T.align=M&&M.align||e.align,T.verticalAlign=M&&M.verticalAlign||"middle",m&&i!=null&&f+T.lineHeight>i){S>0?(_.tokens=_.tokens.slice(0,S),g(_,b,x),t.lines=t.lines.slice(0,v+1)):t.lines=t.lines.slice(0,v);break e}var N=M.width,L=N==null||N==="auto";if(typeof N=="string"&&N.charAt(N.length-1)==="%")T.percentWidth=N,c.push(T),T.contentWidth=ks(T.text,R);else{if(L){var F=M.backgroundColor,O=F&&F.image;O&&(O=QAe(O),vT(O)&&(T.width=Math.max(T.width,O.width*P/O.height)))}var B=p&&r!=null?r-b:null;B!=null&&B<T.width?!L||B<k?(T.text="",T.width=T.contentWidth=0):(T.text=JAe(T.text,B-k,R,e.ellipsis,{minChar:e.truncateMinChar}),T.width=T.contentWidth=ks(T.text,R)):T.contentWidth=ks(T.text,R)}T.width+=k,b+=T.width,M&&(x=Math.max(x,T.lineHeight))}g(_,b,x)}t.outerWidth=t.width=Hn(r,h),t.outerHeight=t.height=Hn(i,f),t.contentHeight=f,t.contentWidth=h,d&&(t.outerWidth+=d[1]+d[3],t.outerHeight+=d[0]+d[2]);for(var v=0;v<c.length;v++){var T=c[v],H=T.percentWidth;T.width=parseInt(H,10)/100*t.width}return t}function cE(n,e,t,r,i){var a=e==="",s=i&&t.rich[i]||{},o=n.lines,l=s.font||t.font,u=!1,c,f;if(r){var h=s.padding,d=h?h[1]+h[3]:0;if(s.width!=null&&s.width!=="auto"){var p=mf(s.width,r.width)+d;o.length>0&&p+r.accumWidth>r.width&&(c=e.split(`
`),u=!0),r.accumWidth=p}else{var m=wq(e,l,r.width,r.breakAll,r.accumWidth);r.accumWidth=m.accumWidth+d,f=m.linesWidths,c=m.lines}}else c=e.split(`
`);for(var g=0;g<c.length;g++){var v=c[g],_=new nMe;if(_.styleName=i,_.text=v,_.isLineHolder=!v&&!a,typeof s.width=="number"?_.width=s.width:_.width=f?f[g]:ks(v,l),!g&&!u){var x=(o[o.length-1]||(o[0]=new EU)).tokens,b=x.length;b===1&&x[0].isLineHolder?x[0]=_:(v||!b||a)&&x.push(_)}else o.push(new EU([_]))}}function aMe(n){var e=n.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}var sMe=df(",&?/;] ".split(""),function(n,e){return n[e]=!0,n},{});function oMe(n){return aMe(n)?!!sMe[n]:!0}function wq(n,e,t,r,i){for(var a=[],s=[],o="",l="",u=0,c=0,f=0;f<n.length;f++){var h=n.charAt(f);if(h===`
`){l&&(o+=l,c+=u),a.push(o),s.push(c),o="",l="",u=0,c=0;continue}var d=ks(h,e),p=r?!1:!oMe(h);if(a.length?c+d>t:i+c+d>t){c?(o||l)&&(p?(o||(o=l,l="",u=0,c=u),a.push(o),s.push(c-u),l+=h,u+=d,o="",c=u):(l&&(o+=l,l="",u=0),a.push(o),s.push(c),o=h,c=d)):p?(a.push(l),s.push(u),l=h,u=d):(a.push(h),s.push(d));continue}c+=d,p?(l+=h,u+=d):(l&&(o+=l,l="",u=0),o+=h)}return!a.length&&!o&&(o=n,l="",u=0),l&&(o+=l),o&&(a.push(o),s.push(c)),a.length===1&&(c+=i),{accumWidth:c,lines:a,linesWidths:s}}var ak="__zr_style_"+Math.round(Math.random()*10),ed={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},yT={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};ed[ak]=!0;var AU=["z","z2","invisible"],lMe=["invisible"],uMe=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype._init=function(t){for(var r=Wr(t),i=0;i<r.length;i++){var a=r[i];a==="style"?this.useStyle(t[a]):n.prototype.attrKV.call(this,a,t[a])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,r,i,a){var s=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&cMe(this,t,r)||s&&!s[0]&&!s[3])return!1;if(i&&this.__clipPaths){for(var o=0;o<this.__clipPaths.length;++o)if(this.__clipPaths[o].isZeroArea())return!1}if(a&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},e.prototype.contain=function(t,r){return this.rectContain(t,r)},e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.rectContain=function(t,r){var i=this.transformCoordToLocal(t,r),a=this.getBoundingRect();return a.contain(i[0],i[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var r=this.transform,i=this.getBoundingRect(),a=this.style,s=a.shadowBlur||0,o=a.shadowOffsetX||0,l=a.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new Xn(0,0,0,0)),r?Xn.applyTransform(t,i,r):t.copy(i),(s||o||l)&&(t.width+=s*2+Math.abs(o),t.height+=s*2+Math.abs(l),t.x=Math.min(t.x,t.x+o-s),t.y=Math.min(t.y,t.y+l-s));var u=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-u),t.y=Math.floor(t.y-u),t.width=Math.ceil(t.width+1+u*2),t.height=Math.ceil(t.height+1+u*2))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new Xn(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(t,r){t!=="style"?n.prototype.attrKV.call(this,t,r):this.style?this.setStyle(r):this.useStyle(r)},e.prototype.setStyle=function(t,r){return typeof t=="string"?this.style[t]=r:gt(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=vy,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(this.__dirty&vy)},e.prototype.styleUpdated=function(){this.__dirty&=~vy},e.prototype.createStyle=function(t){return hT(ed,t)},e.prototype.useStyle=function(t){t[ak]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[ak]},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.style&&!r.style&&(r.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,r,AU)},e.prototype._applyStateObj=function(t,r,i,a,s,o){n.prototype._applyStateObj.call(this,t,r,i,a,s,o);var l=!(r&&a),u;if(r&&r.style?s?a?u=r.style:(u=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(u,r.style)):(u=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(u,r.style)):l&&(u=i.style),u)if(s){var c=this.style;if(this.style=this.createStyle(l?{}:c),l)for(var f=Wr(c),h=0;h<f.length;h++){var d=f[h];d in u&&(u[d]=u[d],this.style[d]=c[d])}for(var p=Wr(u),h=0;h<p.length;h++){var d=p[h];this.style[d]=this.style[d]}this._transitionState(t,{style:u},o,this.getAnimationStyleProps())}else this.useStyle(u);for(var m=this.__inHover?lMe:AU,h=0;h<m.length;h++){var d=m[h];r&&r[d]!=null?this[d]=r[d]:l&&i[d]!=null&&(this[d]=i[d])}},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),i,a=0;a<t.length;a++){var s=t[a];s.style&&(i=i||{},this._mergeStyle(i,s.style))}return i&&(r.style=i),r},e.prototype._mergeStyle=function(t,r){return gt(t,r),t},e.prototype.getAnimationStyleProps=function(){return yT},e.initDefaultProps=function(){var t=e.prototype;t.type="displayable",t.invisible=!1,t.z=0,t.z2=0,t.zlevel=0,t.culling=!1,t.cursor="pointer",t.rectHover=!1,t.incremental=!1,t._rect=null,t.dirtyRectTolerance=0,t.__dirty=Ts|vy}(),e}(rq),fE=new Xn(0,0,0,0),hE=new Xn(0,0,0,0);function cMe(n,e,t){return fE.copy(n.getBoundingRect()),n.transform&&fE.applyTransform(n.transform),hE.width=e,hE.height=t,!fE.intersect(hE)}const Wg=uMe;var Qa=Math.min,Ja=Math.max,dE=Math.sin,pE=Math.cos,ih=Math.PI*2,xb=Hg(),bb=Hg(),wb=Hg();function Sq(n,e,t){if(n.length!==0){for(var r=n[0],i=r[0],a=r[0],s=r[1],o=r[1],l=1;l<n.length;l++)r=n[l],i=Qa(i,r[0]),a=Ja(a,r[0]),s=Qa(s,r[1]),o=Ja(o,r[1]);e[0]=i,e[1]=s,t[0]=a,t[1]=o}}function MU(n,e,t,r,i,a){i[0]=Qa(n,t),i[1]=Qa(e,r),a[0]=Ja(n,t),a[1]=Ja(e,r)}var kU=[],RU=[];function fMe(n,e,t,r,i,a,s,o,l,u){var c=j7,f=Si,h=c(n,t,i,s,kU);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<h;d++){var p=f(n,t,i,s,kU[d]);l[0]=Qa(p,l[0]),u[0]=Ja(p,u[0])}h=c(e,r,a,o,RU);for(var d=0;d<h;d++){var m=f(e,r,a,o,RU[d]);l[1]=Qa(m,l[1]),u[1]=Ja(m,u[1])}l[0]=Qa(n,l[0]),u[0]=Ja(n,u[0]),l[0]=Qa(s,l[0]),u[0]=Ja(s,u[0]),l[1]=Qa(e,l[1]),u[1]=Ja(e,u[1]),l[1]=Qa(o,l[1]),u[1]=Ja(o,u[1])}function hMe(n,e,t,r,i,a,s,o){var l=X7,u=aa,c=Ja(Qa(l(n,t,i),1),0),f=Ja(Qa(l(e,r,a),1),0),h=u(n,t,i,c),d=u(e,r,a,f);s[0]=Qa(n,i,h),s[1]=Qa(e,a,d),o[0]=Ja(n,i,h),o[1]=Ja(e,a,d)}function dMe(n,e,t,r,i,a,s,o,l){var u=fm,c=hm,f=Math.abs(i-a);if(f%ih<1e-4&&f>1e-4){o[0]=n-t,o[1]=e-r,l[0]=n+t,l[1]=e+r;return}if(xb[0]=pE(i)*t+n,xb[1]=dE(i)*r+e,bb[0]=pE(a)*t+n,bb[1]=dE(a)*r+e,u(o,xb,bb),c(l,xb,bb),i=i%ih,i<0&&(i=i+ih),a=a%ih,a<0&&(a=a+ih),i>a&&!s?a+=ih:i<a&&s&&(i+=ih),s){var h=a;a=i,i=h}for(var d=0;d<a;d+=Math.PI/2)d>i&&(wb[0]=pE(d)*t+n,wb[1]=dE(d)*r+e,u(o,wb,o),c(l,wb,l))}var cr={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},ah=[],sh=[],bl=[],Cc=[],wl=[],Sl=[],mE=Math.min,gE=Math.max,oh=Math.cos,lh=Math.sin,yu=Math.abs,sk=Math.PI,Nc=sk*2,vE=typeof Float32Array<"u",Hv=[];function yE(n){var e=Math.round(n/sk*1e8)/1e8;return e%2*sk}function pMe(n,e){var t=yE(n[0]);t<0&&(t+=Nc);var r=t-n[0],i=n[1];i+=r,!e&&i-t>=Nc?i=t+Nc:e&&t-i>=Nc?i=t-Nc:!e&&t>i?i=t+(Nc-yE(t-i)):e&&t<i&&(i=t-(Nc-yE(i-t))),n[0]=t,n[1]=i}var mMe=function(){function n(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}return n.prototype.increaseVersion=function(){this._version++},n.prototype.getVersion=function(){return this._version},n.prototype.setScale=function(e,t,r){r=r||0,r>0&&(this._ux=yu(r/Iw/e)||0,this._uy=yu(r/Iw/t)||0)},n.prototype.setDPR=function(e){this.dpr=e},n.prototype.setContext=function(e){this._ctx=e},n.prototype.getContext=function(){return this._ctx},n.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},n.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},n.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(cr.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},n.prototype.lineTo=function(e,t){var r=yu(e-this._xi),i=yu(t-this._yi),a=r>this._ux||i>this._uy;if(this.addData(cr.L,e,t),this._ctx&&a&&this._ctx.lineTo(e,t),a)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var s=r*r+i*i;s>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=s)}return this},n.prototype.bezierCurveTo=function(e,t,r,i,a,s){return this._drawPendingPt(),this.addData(cr.C,e,t,r,i,a,s),this._ctx&&this._ctx.bezierCurveTo(e,t,r,i,a,s),this._xi=a,this._yi=s,this},n.prototype.quadraticCurveTo=function(e,t,r,i){return this._drawPendingPt(),this.addData(cr.Q,e,t,r,i),this._ctx&&this._ctx.quadraticCurveTo(e,t,r,i),this._xi=r,this._yi=i,this},n.prototype.arc=function(e,t,r,i,a,s){this._drawPendingPt(),Hv[0]=i,Hv[1]=a,pMe(Hv,s),i=Hv[0],a=Hv[1];var o=a-i;return this.addData(cr.A,e,t,r,r,i,o,0,s?0:1),this._ctx&&this._ctx.arc(e,t,r,i,a,s),this._xi=oh(a)*r+e,this._yi=lh(a)*r+t,this},n.prototype.arcTo=function(e,t,r,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,r,i,a),this},n.prototype.rect=function(e,t,r,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,r,i),this.addData(cr.R,e,t,r,i),this},n.prototype.closePath=function(){this._drawPendingPt(),this.addData(cr.Z);var e=this._ctx,t=this._x0,r=this._y0;return e&&e.closePath(),this._xi=t,this._yi=r,this},n.prototype.fill=function(e){e&&e.fill(),this.toStatic()},n.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},n.prototype.len=function(){return this._len},n.prototype.setData=function(e){var t=e.length;!(this.data&&this.data.length===t)&&vE&&(this.data=new Float32Array(t));for(var r=0;r<t;r++)this.data[r]=e[r];this._len=t},n.prototype.appendPath=function(e){e instanceof Array||(e=[e]);for(var t=e.length,r=0,i=this._len,a=0;a<t;a++)r+=e[a].len();vE&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+r));for(var a=0;a<t;a++)for(var s=e[a].data,o=0;o<s.length;o++)this.data[i++]=s[o];this._len=i},n.prototype.addData=function(e,t,r,i,a,s,o,l,u){if(this._saveData){var c=this.data;this._len+arguments.length>c.length&&(this._expandData(),c=this.data);for(var f=0;f<arguments.length;f++)c[this._len++]=arguments[f]}},n.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},n.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},n.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,vE&&this._len>11&&(this.data=new Float32Array(e)))}},n.prototype.getBoundingRect=function(){bl[0]=bl[1]=wl[0]=wl[1]=Number.MAX_VALUE,Cc[0]=Cc[1]=Sl[0]=Sl[1]=-Number.MAX_VALUE;var e=this.data,t=0,r=0,i=0,a=0,s;for(s=0;s<this._len;){var o=e[s++],l=s===1;switch(l&&(t=e[s],r=e[s+1],i=t,a=r),o){case cr.M:t=i=e[s++],r=a=e[s++],wl[0]=i,wl[1]=a,Sl[0]=i,Sl[1]=a;break;case cr.L:MU(t,r,e[s],e[s+1],wl,Sl),t=e[s++],r=e[s++];break;case cr.C:fMe(t,r,e[s++],e[s++],e[s++],e[s++],e[s],e[s+1],wl,Sl),t=e[s++],r=e[s++];break;case cr.Q:hMe(t,r,e[s++],e[s++],e[s],e[s+1],wl,Sl),t=e[s++],r=e[s++];break;case cr.A:var u=e[s++],c=e[s++],f=e[s++],h=e[s++],d=e[s++],p=e[s++]+d;s+=1;var m=!e[s++];l&&(i=oh(d)*f+u,a=lh(d)*h+c),dMe(u,c,f,h,d,p,m,wl,Sl),t=oh(p)*f+u,r=lh(p)*h+c;break;case cr.R:i=t=e[s++],a=r=e[s++];var g=e[s++],v=e[s++];MU(i,a,i+g,a+v,wl,Sl);break;case cr.Z:t=i,r=a;break}fm(bl,bl,wl),hm(Cc,Cc,Sl)}return s===0&&(bl[0]=bl[1]=Cc[0]=Cc[1]=0),new Xn(bl[0],bl[1],Cc[0]-bl[0],Cc[1]-bl[1])},n.prototype._calculateLength=function(){var e=this.data,t=this._len,r=this._ux,i=this._uy,a=0,s=0,o=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,c=0,f=0,h=0;h<t;){var d=e[h++],p=h===1;p&&(a=e[h],s=e[h+1],o=a,l=s);var m=-1;switch(d){case cr.M:a=o=e[h++],s=l=e[h++];break;case cr.L:{var g=e[h++],v=e[h++],_=g-a,x=v-s;(yu(_)>r||yu(x)>i||h===t-1)&&(m=Math.sqrt(_*_+x*x),a=g,s=v);break}case cr.C:{var b=e[h++],S=e[h++],g=e[h++],v=e[h++],T=e[h++],M=e[h++];m=IEe(a,s,b,S,g,v,T,M,10),a=T,s=M;break}case cr.Q:{var b=e[h++],S=e[h++],g=e[h++],v=e[h++];m=LEe(a,s,b,S,g,v,10),a=g,s=v;break}case cr.A:var C=e[h++],k=e[h++],R=e[h++],P=e[h++],N=e[h++],L=e[h++],F=L+N;h+=1,e[h++],p&&(o=oh(N)*R+C,l=lh(N)*P+k),m=gE(R,P)*mE(Nc,Math.abs(L)),a=oh(F)*R+C,s=lh(F)*P+k;break;case cr.R:{o=a=e[h++],l=s=e[h++];var O=e[h++],B=e[h++];m=O*2+B*2;break}case cr.Z:{var _=o-a,x=l-s;m=Math.sqrt(_*_+x*x),a=o,s=l;break}}m>=0&&(u[f++]=m,c+=m)}return this._pathLen=c,c},n.prototype.rebuildPath=function(e,t){var r=this.data,i=this._ux,a=this._uy,s=this._len,o,l,u,c,f,h,d=t<1,p,m,g=0,v=0,_,x=0,b,S;if(!(d&&(this._pathSegLen||this._calculateLength(),p=this._pathSegLen,m=this._pathLen,_=t*m,!_)))e:for(var T=0;T<s;){var M=r[T++],C=T===1;switch(C&&(u=r[T],c=r[T+1],o=u,l=c),M!==cr.L&&x>0&&(e.lineTo(b,S),x=0),M){case cr.M:o=u=r[T++],l=c=r[T++],e.moveTo(u,c);break;case cr.L:{f=r[T++],h=r[T++];var k=yu(f-u),R=yu(h-c);if(k>i||R>a){if(d){var P=p[v++];if(g+P>_){var N=(_-g)/P;e.lineTo(u*(1-N)+f*N,c*(1-N)+h*N);break e}g+=P}e.lineTo(f,h),u=f,c=h,x=0}else{var L=k*k+R*R;L>x&&(b=f,S=h,x=L)}break}case cr.C:{var F=r[T++],O=r[T++],B=r[T++],H=r[T++],j=r[T++],K=r[T++];if(d){var P=p[v++];if(g+P>_){var N=(_-g)/P;pf(u,F,B,j,N,ah),pf(c,O,H,K,N,sh),e.bezierCurveTo(ah[1],sh[1],ah[2],sh[2],ah[3],sh[3]);break e}g+=P}e.bezierCurveTo(F,O,B,H,j,K),u=j,c=K;break}case cr.Q:{var F=r[T++],O=r[T++],B=r[T++],H=r[T++];if(d){var P=p[v++];if(g+P>_){var N=(_-g)/P;Rw(u,F,B,N,ah),Rw(c,O,H,N,sh),e.quadraticCurveTo(ah[1],sh[1],ah[2],sh[2]);break e}g+=P}e.quadraticCurveTo(F,O,B,H),u=B,c=H;break}case cr.A:var J=r[T++],re=r[T++],se=r[T++],Ae=r[T++],Ee=r[T++],Ne=r[T++],we=r[T++],me=!r[T++],Se=se>Ae?se:Ae,Me=yu(se-Ae)>.001,ke=Ee+Ne,He=!1;if(d){var P=p[v++];g+P>_&&(ke=Ee+Ne*(_-g)/P,He=!0),g+=P}if(Me&&e.ellipse?e.ellipse(J,re,se,Ae,we,Ee,ke,me):e.arc(J,re,Se,Ee,ke,me),He)break e;C&&(o=oh(Ee)*se+J,l=lh(Ee)*Ae+re),u=oh(ke)*se+J,c=lh(ke)*Ae+re;break;case cr.R:o=u=r[T],l=c=r[T+1],f=r[T++],h=r[T++];var ee=r[T++],ie=r[T++];if(d){var P=p[v++];if(g+P>_){var xe=_-g;e.moveTo(f,h),e.lineTo(f+mE(xe,ee),h),xe-=ee,xe>0&&e.lineTo(f+ee,h+mE(xe,ie)),xe-=ie,xe>0&&e.lineTo(f+gE(ee-xe,0),h+ie),xe-=ee,xe>0&&e.lineTo(f,h+gE(ie-xe,0));break e}g+=P}e.rect(f,h,ee,ie);break;case cr.Z:if(d){var P=p[v++];if(g+P>_){var N=(_-g)/P;e.lineTo(u*(1-N)+o*N,c*(1-N)+l*N);break e}g+=P}e.closePath(),u=o,c=l}}},n.prototype.clone=function(){var e=new n,t=this.data;return e.data=t.slice?t.slice():Array.prototype.slice.call(t),e._len=this._len,e},n.CMD=cr,n.initDefaultProps=function(){var e=n.prototype;e._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,e._version=0}(),n}();const Xu=mMe;function Lp(n,e,t,r,i,a,s){if(i===0)return!1;var o=i,l=0,u=n;if(s>e+o&&s>r+o||s<e-o&&s<r-o||a>n+o&&a>t+o||a<n-o&&a<t-o)return!1;if(n!==t)l=(e-r)/(n-t),u=(n*r-t*e)/(n-t);else return Math.abs(a-n)<=o/2;var c=l*a-s+u,f=c*c/(l*l+1);return f<=o/2*o/2}function gMe(n,e,t,r,i,a,s,o,l,u,c){if(l===0)return!1;var f=l;if(c>e+f&&c>r+f&&c>a+f&&c>o+f||c<e-f&&c<r-f&&c<a-f&&c<o-f||u>n+f&&u>t+f&&u>i+f&&u>s+f||u<n-f&&u<t-f&&u<i-f&&u<s-f)return!1;var h=q7(n,e,t,r,i,a,s,o,u,c,null);return h<=f/2}function vMe(n,e,t,r,i,a,s,o,l){if(s===0)return!1;var u=s;if(l>e+u&&l>r+u&&l>a+u||l<e-u&&l<r-u&&l<a-u||o>n+u&&o>t+u&&o>i+u||o<n-u&&o<t-u&&o<i-u)return!1;var c=K7(n,e,t,r,i,a,o,l,null);return c<=u/2}var PU=Math.PI*2;function Xc(n){return n%=PU,n<0&&(n+=PU),n}var Wv=Math.PI*2;function yMe(n,e,t,r,i,a,s,o,l){if(s===0)return!1;var u=s;o-=n,l-=e;var c=Math.sqrt(o*o+l*l);if(c-u>t||c+u<t)return!1;if(Math.abs(r-i)%Wv<1e-4)return!0;if(a){var f=r;r=Xc(i),i=Xc(f)}else r=Xc(r),i=Xc(i);r>i&&(i+=Wv);var h=Math.atan2(l,o);return h<0&&(h+=Wv),h>=r&&h<=i||h+Wv>=r&&h+Wv<=i}function uh(n,e,t,r,i,a){if(a>e&&a>r||a<e&&a<r||r===e)return 0;var s=(a-e)/(r-e),o=r<e?1:-1;(s===1||s===0)&&(o=r<e?.5:-.5);var l=s*(t-n)+n;return l===i?1/0:l>i?o:0}var Ec=Xu.CMD,ch=Math.PI*2,_Me=1e-4;function xMe(n,e){return Math.abs(n-e)<_Me}var Da=[-1,-1,-1],qs=[-1,-1];function bMe(){var n=qs[0];qs[0]=qs[1],qs[1]=n}function wMe(n,e,t,r,i,a,s,o,l,u){if(u>e&&u>r&&u>a&&u>o||u<e&&u<r&&u<a&&u<o)return 0;var c=kw(e,r,a,o,u,Da);if(c===0)return 0;for(var f=0,h=-1,d=void 0,p=void 0,m=0;m<c;m++){var g=Da[m],v=g===0||g===1?.5:1,_=Si(n,t,i,s,g);_<l||(h<0&&(h=j7(e,r,a,o,qs),qs[1]<qs[0]&&h>1&&bMe(),d=Si(e,r,a,o,qs[0]),h>1&&(p=Si(e,r,a,o,qs[1]))),h===2?g<qs[0]?f+=d<e?v:-v:g<qs[1]?f+=p<d?v:-v:f+=o<p?v:-v:g<qs[0]?f+=d<e?v:-v:f+=o<d?v:-v)}return f}function SMe(n,e,t,r,i,a,s,o){if(o>e&&o>r&&o>a||o<e&&o<r&&o<a)return 0;var l=DEe(e,r,a,o,Da);if(l===0)return 0;var u=X7(e,r,a);if(u>=0&&u<=1){for(var c=0,f=aa(e,r,a,u),h=0;h<l;h++){var d=Da[h]===0||Da[h]===1?.5:1,p=aa(n,t,i,Da[h]);p<s||(Da[h]<u?c+=f<e?d:-d:c+=a<f?d:-d)}return c}else{var d=Da[0]===0||Da[0]===1?.5:1,p=aa(n,t,i,Da[0]);return p<s?0:a<e?d:-d}}function TMe(n,e,t,r,i,a,s,o){if(o-=e,o>t||o<-t)return 0;var l=Math.sqrt(t*t-o*o);Da[0]=-l,Da[1]=l;var u=Math.abs(r-i);if(u<1e-4)return 0;if(u>=ch-1e-4){r=0,i=ch;var c=a?1:-1;return s>=Da[0]+n&&s<=Da[1]+n?c:0}if(r>i){var f=r;r=i,i=f}r<0&&(r+=ch,i+=ch);for(var h=0,d=0;d<2;d++){var p=Da[d];if(p+n>s){var m=Math.atan2(o,p),c=a?1:-1;m<0&&(m=ch+m),(m>=r&&m<=i||m+ch>=r&&m+ch<=i)&&(m>Math.PI/2&&m<Math.PI*1.5&&(c=-c),h+=c)}}return h}function Tq(n,e,t,r,i){for(var a=n.data,s=n.len(),o=0,l=0,u=0,c=0,f=0,h,d,p=0;p<s;){var m=a[p++],g=p===1;switch(m===Ec.M&&p>1&&(t||(o+=uh(l,u,c,f,r,i))),g&&(l=a[p],u=a[p+1],c=l,f=u),m){case Ec.M:c=a[p++],f=a[p++],l=c,u=f;break;case Ec.L:if(t){if(Lp(l,u,a[p],a[p+1],e,r,i))return!0}else o+=uh(l,u,a[p],a[p+1],r,i)||0;l=a[p++],u=a[p++];break;case Ec.C:if(t){if(gMe(l,u,a[p++],a[p++],a[p++],a[p++],a[p],a[p+1],e,r,i))return!0}else o+=wMe(l,u,a[p++],a[p++],a[p++],a[p++],a[p],a[p+1],r,i)||0;l=a[p++],u=a[p++];break;case Ec.Q:if(t){if(vMe(l,u,a[p++],a[p++],a[p],a[p+1],e,r,i))return!0}else o+=SMe(l,u,a[p++],a[p++],a[p],a[p+1],r,i)||0;l=a[p++],u=a[p++];break;case Ec.A:var v=a[p++],_=a[p++],x=a[p++],b=a[p++],S=a[p++],T=a[p++];p+=1;var M=!!(1-a[p++]);h=Math.cos(S)*x+v,d=Math.sin(S)*b+_,g?(c=h,f=d):o+=uh(l,u,h,d,r,i);var C=(r-v)*b/x+v;if(t){if(yMe(v,_,b,S,S+T,M,e,C,i))return!0}else o+=TMe(v,_,b,S,S+T,M,C,i);l=Math.cos(S+T)*x+v,u=Math.sin(S+T)*b+_;break;case Ec.R:c=l=a[p++],f=u=a[p++];var k=a[p++],R=a[p++];if(h=c+k,d=f+R,t){if(Lp(c,f,h,f,e,r,i)||Lp(h,f,h,d,e,r,i)||Lp(h,d,c,d,e,r,i)||Lp(c,d,c,f,e,r,i))return!0}else o+=uh(h,f,h,d,r,i),o+=uh(c,d,c,f,r,i);break;case Ec.Z:if(t){if(Lp(l,u,c,f,e,r,i))return!0}else o+=uh(l,u,c,f,r,i);l=c,u=f;break}}return!t&&!xMe(u,f)&&(o+=uh(l,u,c,f,r,i)||0),o!==0}function CMe(n,e,t){return Tq(n,0,!1,e,t)}function EMe(n,e,t,r){return Tq(n,e,!0,t,r)}var Cq=ln({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},ed),AMe={style:ln({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},yT.style)},_E=F0.concat(["invisible","culling","z","z2","zlevel","parent"]),MMe=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.update=function(){var t=this;n.prototype.update.call(this);var r=this.style;if(r.decal){var i=this._decalEl=this._decalEl||new e;i.buildPath===e.prototype.buildPath&&(i.buildPath=function(l){t.buildPath(l,t.shape)}),i.silent=!0;var a=i.style;for(var s in r)a[s]!==r[s]&&(a[s]=r[s]);a.fill=r.fill?r.decal:null,a.decal=null,a.shadowColor=null,r.strokeFirst&&(a.stroke=null);for(var o=0;o<_E.length;++o)i[_E[o]]=this[_E[o]];i.__dirty|=Ts}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(t){var r=Wr(t);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<r.length;a++){var s=r[a],o=t[s];s==="style"?this.style?gt(this.style,o):this.useStyle(o):s==="shape"?gt(this.shape,o):n.prototype.attrKV.call(this,s,o)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if(t!=="none"){if(jt(t)){var r=Pw(t,0);return r>.5?tk:r>.2?aAe:nk}else if(t)return nk}return tk},e.prototype.getInsideTextStroke=function(t){var r=this.style.fill;if(jt(r)){var i=this.__zr,a=!!(i&&i.isDarkMode()),s=Pw(t,0)<ek;if(a===s)return r}},e.prototype.buildPath=function(t,r,i){},e.prototype.pathUpdated=function(){this.__dirty&=~rm},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new Xu(!1)},e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return!(r==null||r==="none"||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.getBoundingRect=function(){var t=this._rect,r=this.style,i=!t;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var s=this.path;(a||this.__dirty&rm)&&(s.beginPath(),this.buildPath(s,this.shape,!1),this.pathUpdated()),t=s.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var o=this._rectStroke||(this._rectStroke=t.clone());if(this.__dirty||i){o.copy(t);var l=r.strokeNoScale?this.getLineScale():1,u=r.lineWidth;if(!this.hasFill()){var c=this.strokeContainThreshold;u=Math.max(u,c??4)}l>1e-10&&(o.width+=u/l,o.height+=u/l,o.x-=u/l/2,o.y-=u/l/2)}return o}return t},e.prototype.contain=function(t,r){var i=this.transformCoordToLocal(t,r),a=this.getBoundingRect(),s=this.style;if(t=i[0],r=i[1],a.contain(t,r)){var o=this.path;if(this.hasStroke()){var l=s.lineWidth,u=s.strokeNoScale?this.getLineScale():1;if(u>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),EMe(o,l/u,t,r)))return!0}if(this.hasFill())return CMe(o,t,r)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=rm,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():t==="shape"?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(t,r){t==="shape"?this.setShape(r):n.prototype.attrKV.call(this,t,r)},e.prototype.setShape=function(t,r){var i=this.shape;return i||(i=this.shape={}),typeof t=="string"?i[t]=r:gt(i,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(this.__dirty&rm)},e.prototype.createStyle=function(t){return hT(Cq,t)},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.shape&&!r.shape&&(r.shape=gt({},this.shape))},e.prototype._applyStateObj=function(t,r,i,a,s,o){n.prototype._applyStateObj.call(this,t,r,i,a,s,o);var l=!(r&&a),u;if(r&&r.shape?s?a?u=r.shape:(u=gt({},i.shape),gt(u,r.shape)):(u=gt({},a?this.shape:i.shape),gt(u,r.shape)):l&&(u=i.shape),u)if(s){this.shape=gt({},this.shape);for(var c={},f=Wr(u),h=0;h<f.length;h++){var d=f[h];typeof u[d]=="object"?this.shape[d]=u[d]:c[d]=u[d]}this._transitionState(t,{shape:c},o)}else this.shape=u,this.dirtyShape()},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),i,a=0;a<t.length;a++){var s=t[a];s.shape&&(i=i||{},this._mergeStyle(i,s.shape))}return i&&(r.shape=i),r},e.prototype.getAnimationStyleProps=function(){return AMe},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var r=function(a){ht(s,a);function s(o){var l=a.call(this,o)||this;return t.init&&t.init.call(l,o),l}return s.prototype.getDefaultStyle=function(){return wn(t.style)},s.prototype.getDefaultShape=function(){return wn(t.shape)},s}(e);for(var i in t)typeof t[i]=="function"&&(r.prototype[i]=t[i]);return r},e.initDefaultProps=function(){var t=e.prototype;t.type="path",t.strokeContainThreshold=5,t.segmentIgnoreThreshold=0,t.subPixelOptimize=!1,t.autoBatch=!1,t.__dirty=Ts|vy|rm}(),e}(Wg);const Wn=MMe;var kMe=ln({strokeFirst:!0,font:vd,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Cq),Eq=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return r!=null&&r!=="none"&&t.lineWidth>0},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.createStyle=function(t){return hT(kMe,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t=this.style;if(!this._rect){var r=t.text;r!=null?r+="":r="";var i=M_(r,t.font,t.textAlign,t.textBaseline);if(i.x+=t.x||0,i.y+=t.y||0,this.hasStroke()){var a=t.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},e.initDefaultProps=function(){var t=e.prototype;t.dirtyRectTolerance=10}(),e}(Wg);Eq.prototype.type="tspan";const ok=Eq;var RMe=ln({x:0,y:0},ed),PMe={style:ln({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},yT.style)};function IMe(n){return!!(n&&typeof n!="string"&&n.width&&n.height)}var Aq=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.createStyle=function(t){return hT(RMe,t)},e.prototype._getSize=function(t){var r=this.style,i=r[t];if(i!=null)return i;var a=IMe(r.image)?r.image:this.__image;if(!a)return 0;var s=t==="width"?"height":"width",o=r[s];return o==null?a[t]:a[t]/a[s]*o},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return PMe},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new Xn(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}(Wg);Aq.prototype.type="image";const zd=Aq;function DMe(n,e){var t=e.x,r=e.y,i=e.width,a=e.height,s=e.r,o,l,u,c;i<0&&(t=t+i,i=-i),a<0&&(r=r+a,a=-a),typeof s=="number"?o=l=u=c=s:s instanceof Array?s.length===1?o=l=u=c=s[0]:s.length===2?(o=u=s[0],l=c=s[1]):s.length===3?(o=s[0],l=c=s[1],u=s[2]):(o=s[0],l=s[1],u=s[2],c=s[3]):o=l=u=c=0;var f;o+l>i&&(f=o+l,o*=i/f,l*=i/f),u+c>i&&(f=u+c,u*=i/f,c*=i/f),l+u>a&&(f=l+u,l*=a/f,u*=a/f),o+c>a&&(f=o+c,o*=a/f,c*=a/f),n.moveTo(t+o,r),n.lineTo(t+i-l,r),l!==0&&n.arc(t+i-l,r+l,l,-Math.PI/2,0),n.lineTo(t+i,r+a-u),u!==0&&n.arc(t+i-u,r+a-u,u,0,Math.PI/2),n.lineTo(t+c,r+a),c!==0&&n.arc(t+c,r+a-c,c,Math.PI/2,Math.PI),n.lineTo(t,r+o),o!==0&&n.arc(t+o,r+o,o,Math.PI,Math.PI*1.5)}var pm=Math.round;function Mq(n,e,t){if(e){var r=e.x1,i=e.x2,a=e.y1,s=e.y2;n.x1=r,n.x2=i,n.y1=a,n.y2=s;var o=t&&t.lineWidth;return o&&(pm(r*2)===pm(i*2)&&(n.x1=n.x2=zh(r,o,!0)),pm(a*2)===pm(s*2)&&(n.y1=n.y2=zh(a,o,!0))),n}}function kq(n,e,t){if(e){var r=e.x,i=e.y,a=e.width,s=e.height;n.x=r,n.y=i,n.width=a,n.height=s;var o=t&&t.lineWidth;return o&&(n.x=zh(r,o,!0),n.y=zh(i,o,!0),n.width=Math.max(zh(r+a,o,!1)-n.x,a===0?0:1),n.height=Math.max(zh(i+s,o,!1)-n.y,s===0?0:1)),n}}function zh(n,e,t){if(!e)return n;var r=pm(n*2);return(r+pm(e))%2===0?r/2:(r+(t?1:-1))/2}var LMe=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0}return n}(),NMe={},Rq=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new LMe},e.prototype.buildPath=function(t,r){var i,a,s,o;if(this.subPixelOptimize){var l=kq(NMe,r,this.style);i=l.x,a=l.y,s=l.width,o=l.height,l.r=r.r,r=l}else i=r.x,a=r.y,s=r.width,o=r.height;r.r?DMe(t,r):t.rect(i,a,s,o)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(Wn);Rq.prototype.type="rect";const oi=Rq;var IU={fill:"#000"},DU=2,OMe={style:ln({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},yT.style)},Pq=function(n){ht(e,n);function e(t){var r=n.call(this)||this;return r.type="text",r._children=[],r._defaultStyle=IU,r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){n.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var r=this._children[t];r.zlevel=this.zlevel,r.z=this.z,r.z2=this.z2,r.culling=this.culling,r.cursor=this.cursor,r.invisible=this.invisible}},e.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):n.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(t){var r=this.innerTransformable;return r?r.getLocalTransform(t):n.prototype.getLocalTransform.call(this,t)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),n.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){this._childCursor=0,zMe(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=t},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new Xn(0,0,0,0),r=this._children,i=[],a=null,s=0;s<r.length;s++){var o=r[s],l=o.getBoundingRect(),u=o.getLocalTransform(i);u?(t.copy(l),t.applyTransform(u),a=a||t.clone(),a.union(t)):(a=a||l.clone(),a.union(l))}this._rect=a||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||IU},e.prototype.setTextContent=function(t){},e.prototype._mergeStyle=function(t,r){if(!r)return t;var i=r.rich,a=t.rich||i&&{};return gt(t,r),i&&a?(this._mergeRich(a,i),t.rich=a):a&&(t.rich=a),t},e.prototype._mergeRich=function(t,r){for(var i=Wr(r),a=0;a<i.length;a++){var s=i[a];t[s]=t[s]||{},gt(t[s],r[s])}},e.prototype.getAnimationStyleProps=function(){return OMe},e.prototype._getOrCreateChild=function(t){var r=this._children[this._childCursor];return(!r||!(r instanceof t))&&(r=new t),this._children[this._childCursor++]=r,r.__zr=this.__zr,r.parent=this,r},e.prototype._updatePlainTexts=function(){var t=this.style,r=t.font||vd,i=t.padding,a=UU(t),s=tMe(a,t),o=xE(t),l=!!t.backgroundColor,u=s.outerHeight,c=s.outerWidth,f=s.contentWidth,h=s.lines,d=s.lineHeight,p=this._defaultStyle,m=t.x||0,g=t.y||0,v=t.align||p.align||"left",_=t.verticalAlign||p.verticalAlign||"top",x=m,b=im(g,s.contentHeight,_);if(o||i){var S=_y(m,c,v),T=im(g,u,_);o&&this._renderBackground(t,t,S,T,c,u)}b+=d/2,i&&(x=BU(m,v,i),_==="top"?b+=i[0]:_==="bottom"&&(b-=i[2]));for(var M=0,C=!1,k=FU("fill"in t?t.fill:(C=!0,p.fill)),R=$U("stroke"in t?t.stroke:!l&&(!p.autoStroke||C)?(M=DU,p.stroke):null),P=t.textShadowBlur>0,N=t.width!=null&&(t.overflow==="truncate"||t.overflow==="break"||t.overflow==="breakAll"),L=s.calculatedLineHeight,F=0;F<h.length;F++){var O=this._getOrCreateChild(ok),B=O.createStyle();O.useStyle(B),B.text=h[F],B.x=x,B.y=b,v&&(B.textAlign=v),B.textBaseline="middle",B.opacity=t.opacity,B.strokeFirst=!0,P&&(B.shadowBlur=t.textShadowBlur||0,B.shadowColor=t.textShadowColor||"transparent",B.shadowOffsetX=t.textShadowOffsetX||0,B.shadowOffsetY=t.textShadowOffsetY||0),B.stroke=R,B.fill=k,R&&(B.lineWidth=t.lineWidth||M,B.lineDash=t.lineDash,B.lineDashOffset=t.lineDashOffset||0),B.font=r,NU(B,t),b+=d,N&&O.setBoundingRect(new Xn(_y(B.x,t.width,B.textAlign),im(B.y,L,B.textBaseline),f,L))}},e.prototype._updateRichTexts=function(){var t=this.style,r=UU(t),i=iMe(r,t),a=i.width,s=i.outerWidth,o=i.outerHeight,l=t.padding,u=t.x||0,c=t.y||0,f=this._defaultStyle,h=t.align||f.align,d=t.verticalAlign||f.verticalAlign,p=_y(u,s,h),m=im(c,o,d),g=p,v=m;l&&(g+=l[3],v+=l[0]);var _=g+a;xE(t)&&this._renderBackground(t,t,p,m,s,o);for(var x=!!t.backgroundColor,b=0;b<i.lines.length;b++){for(var S=i.lines[b],T=S.tokens,M=T.length,C=S.lineHeight,k=S.width,R=0,P=g,N=_,L=M-1,F=void 0;R<M&&(F=T[R],!F.align||F.align==="left");)this._placeToken(F,t,C,v,P,"left",x),k-=F.width,P+=F.width,R++;for(;L>=0&&(F=T[L],F.align==="right");)this._placeToken(F,t,C,v,N,"right",x),k-=F.width,N-=F.width,L--;for(P+=(a-(P-g)-(_-N)-k)/2;R<=L;)F=T[R],this._placeToken(F,t,C,v,P+F.width/2,"center",x),P+=F.width,R++;v+=C}},e.prototype._placeToken=function(t,r,i,a,s,o,l){var u=r.rich[t.styleName]||{};u.text=t.text;var c=t.verticalAlign,f=a+i/2;c==="top"?f=a+t.height/2:c==="bottom"&&(f=a+i-t.height/2);var h=!t.isLineHolder&&xE(u);h&&this._renderBackground(u,r,o==="right"?s-t.width:o==="center"?s-t.width/2:s,f-t.height/2,t.width,t.height);var d=!!u.backgroundColor,p=t.textPadding;p&&(s=BU(s,o,p),f-=t.height/2-p[0]-t.innerHeight/2);var m=this._getOrCreateChild(ok),g=m.createStyle();m.useStyle(g);var v=this._defaultStyle,_=!1,x=0,b=FU("fill"in u?u.fill:"fill"in r?r.fill:(_=!0,v.fill)),S=$U("stroke"in u?u.stroke:"stroke"in r?r.stroke:!d&&!l&&(!v.autoStroke||_)?(x=DU,v.stroke):null),T=u.textShadowBlur>0||r.textShadowBlur>0;g.text=t.text,g.x=s,g.y=f,T&&(g.shadowBlur=u.textShadowBlur||r.textShadowBlur||0,g.shadowColor=u.textShadowColor||r.textShadowColor||"transparent",g.shadowOffsetX=u.textShadowOffsetX||r.textShadowOffsetX||0,g.shadowOffsetY=u.textShadowOffsetY||r.textShadowOffsetY||0),g.textAlign=o,g.textBaseline="middle",g.font=t.font||vd,g.opacity=jy(u.opacity,r.opacity,1),NU(g,u),S&&(g.lineWidth=jy(u.lineWidth,r.lineWidth,x),g.lineDash=Hn(u.lineDash,r.lineDash),g.lineDashOffset=r.lineDashOffset||0,g.stroke=S),b&&(g.fill=b);var M=t.contentWidth,C=t.contentHeight;m.setBoundingRect(new Xn(_y(g.x,M,g.textAlign),im(g.y,C,g.textBaseline),M,C))},e.prototype._renderBackground=function(t,r,i,a,s,o){var l=t.backgroundColor,u=t.borderWidth,c=t.borderColor,f=l&&l.image,h=l&&!f,d=t.borderRadius,p=this,m,g;if(h||t.lineHeight||u&&c){m=this._getOrCreateChild(oi),m.useStyle(m.createStyle()),m.style.fill=null;var v=m.shape;v.x=i,v.y=a,v.width=s,v.height=o,v.r=d,m.dirtyShape()}if(h){var _=m.style;_.fill=l||null,_.fillOpacity=Hn(t.fillOpacity,1)}else if(f){g=this._getOrCreateChild(zd),g.onload=function(){p.dirtyStyle()};var x=g.style;x.image=l.image,x.x=i,x.y=a,x.width=s,x.height=o}if(u&&c){var _=m.style;_.lineWidth=u,_.stroke=c,_.strokeOpacity=Hn(t.strokeOpacity,1),_.lineDash=t.borderDash,_.lineDashOffset=t.borderDashOffset||0,m.strokeContainThreshold=0,m.hasFill()&&m.hasStroke()&&(_.strokeFirst=!0,_.lineWidth*=2)}var b=(m||g).style;b.shadowBlur=t.shadowBlur||0,b.shadowColor=t.shadowColor||"transparent",b.shadowOffsetX=t.shadowOffsetX||0,b.shadowOffsetY=t.shadowOffsetY||0,b.opacity=jy(t.opacity,r.opacity,1)},e.makeFont=function(t){var r="";return UMe(t)&&(r=[t.fontStyle,t.fontWeight,BMe(t.fontSize),t.fontFamily||"sans-serif"].join(" ")),r&&Dl(r)||t.textFont||t.font},e}(Wg),$Me={left:!0,right:1,center:1},FMe={top:1,bottom:1,middle:1},LU=["fontStyle","fontWeight","fontSize","fontFamily"];function BMe(n){return typeof n=="string"&&(n.indexOf("px")!==-1||n.indexOf("rem")!==-1||n.indexOf("em")!==-1)?n:isNaN(+n)?vI+"px":n+"px"}function NU(n,e){for(var t=0;t<LU.length;t++){var r=LU[t],i=e[r];i!=null&&(n[r]=i)}}function UMe(n){return n.fontSize!=null||n.fontFamily||n.fontWeight}function zMe(n){return OU(n),ce(n.rich,OU),n}function OU(n){if(n){n.font=Pq.makeFont(n);var e=n.align;e==="middle"&&(e="center"),n.align=e==null||$Me[e]?e:"left";var t=n.verticalAlign;t==="center"&&(t="middle"),n.verticalAlign=t==null||FMe[t]?t:"top";var r=n.padding;r&&(n.padding=I7(n.padding))}}function $U(n,e){return n==null||e<=0||n==="transparent"||n==="none"?null:n.image||n.colorStops?"#000":n}function FU(n){return n==null||n==="none"?null:n.image||n.colorStops?"#000":n}function BU(n,e,t){return e==="right"?n-t[1]:e==="center"?n+t[3]/2-t[1]/2:n+t[3]}function UU(n){var e=n.text;return e!=null&&(e+=""),e}function xE(n){return!!(n.backgroundColor||n.lineHeight||n.borderWidth&&n.borderColor)}const Pi=Pq;var ar=qr(),VMe=function(n,e,t,r){if(r){var i=ar(r);i.dataIndex=t,i.dataType=e,i.seriesIndex=n,r.type==="group"&&r.traverse(function(a){var s=ar(a);s.seriesIndex=n,s.dataIndex=t,s.dataType=e})}},zU=1,VU={},Iq=qr(),PI=qr(),II=0,_T=1,xT=2,xo=["emphasis","blur","select"],Nw=["normal","emphasis","blur","select"],HMe=10,WMe=9,td="highlight",Y1="downplay",Zy="select",Z1="unselect",Qy="toggleSelect";function Np(n){return n!=null&&n!=="none"}var HU=new E_(100);function WU(n){if(jt(n)){var e=HU.get(n);return e||(e=uU(n,-.1),HU.put(n,e)),e}else if(fT(n)){var t=gt({},n);return t.colorStops=Nt(n.colorStops,function(r){return{offset:r.offset,color:uU(r.color,-.1)}}),t}return n}function bT(n,e,t){n.onHoverStateChange&&(n.hoverState||0)!==t&&n.onHoverStateChange(e),n.hoverState=t}function Dq(n){bT(n,"emphasis",xT)}function Lq(n){n.hoverState===xT&&bT(n,"normal",II)}function DI(n){bT(n,"blur",_T)}function Nq(n){n.hoverState===_T&&bT(n,"normal",II)}function GMe(n){n.selected=!0}function jMe(n){n.selected=!1}function GU(n,e,t){e(n,t)}function nc(n,e,t){GU(n,e,t),n.isGroup&&n.traverse(function(r){GU(r,e,t)})}function jU(n,e){switch(e){case"emphasis":n.hoverState=xT;break;case"normal":n.hoverState=II;break;case"blur":n.hoverState=_T;break;case"select":n.selected=!0}}function qMe(n,e,t,r){for(var i=n.style,a={},s=0;s<e.length;s++){var o=e[s],l=i[o];a[o]=l??(r&&r[o])}for(var s=0;s<n.animators.length;s++){var u=n.animators[s];u.__fromStateTransition&&u.__fromStateTransition.indexOf(t)<0&&u.targetName==="style"&&u.saveTo(a,e)}return a}function XMe(n,e,t,r){var i=t&&Vn(t,"select")>=0,a=!1;if(n instanceof Wn){var s=Iq(n),o=i&&s.selectFill||s.normalFill,l=i&&s.selectStroke||s.normalStroke;if(Np(o)||Np(l)){r=r||{};var u=r.style||{};u.fill==="inherit"?(a=!0,r=gt({},r),u=gt({},u),u.fill=o):!Np(u.fill)&&Np(o)?(a=!0,r=gt({},r),u=gt({},u),u.fill=WU(o)):!Np(u.stroke)&&Np(l)&&(a||(r=gt({},r),u=gt({},u)),u.stroke=WU(l)),r.style=u}}if(r&&r.z2==null){a||(r=gt({},r));var c=n.z2EmphasisLift;r.z2=n.z2+(c??HMe)}return r}function KMe(n,e,t){if(t&&t.z2==null){t=gt({},t);var r=n.z2SelectLift;t.z2=n.z2+(r??WMe)}return t}function YMe(n,e,t){var r=Vn(n.currentStates,e)>=0,i=n.style.opacity,a=r?null:qMe(n,["opacity"],e,{opacity:1});t=t||{};var s=t.style||{};return s.opacity==null&&(t=gt({},t),s=gt({opacity:r?i:a.opacity*.1},s),t.style=s),t}function bE(n,e){var t=this.states[n];if(this.style){if(n==="emphasis")return XMe(this,n,e,t);if(n==="blur")return YMe(this,n,t);if(n==="select")return KMe(this,n,t)}return t}function ZMe(n){n.stateProxy=bE;var e=n.getTextContent(),t=n.getTextGuideLine();e&&(e.stateProxy=bE),t&&(t.stateProxy=bE)}function qU(n,e){!Bq(n,e)&&!n.__highByOuter&&nc(n,Dq)}function XU(n,e){!Bq(n,e)&&!n.__highByOuter&&nc(n,Lq)}function og(n,e){n.__highByOuter|=1<<(e||0),nc(n,Dq)}function lg(n,e){!(n.__highByOuter&=~(1<<(e||0)))&&nc(n,Lq)}function QMe(n){nc(n,DI)}function Oq(n){nc(n,Nq)}function $q(n){nc(n,GMe)}function Fq(n){nc(n,jMe)}function Bq(n,e){return n.__highDownSilentOnTouch&&e.zrByTouch}function Uq(n){var e=n.getModel(),t=[],r=[];e.eachComponent(function(i,a){var s=PI(a),o=i==="series",l=o?n.getViewOfSeriesModel(a):n.getViewOfComponentModel(a);!o&&r.push(l),s.isBlured&&(l.group.traverse(function(u){Nq(u)}),o&&t.push(a)),s.isBlured=!1}),ce(r,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(t,!1,e)})}function lk(n,e,t,r){var i=r.getModel();t=t||"coordinateSystem";function a(u,c){for(var f=0;f<c.length;f++){var h=u.getItemGraphicEl(c[f]);h&&Oq(h)}}if(n!=null&&!(!e||e==="none")){var s=i.getSeriesByIndex(n),o=s.coordinateSystem;o&&o.master&&(o=o.master);var l=[];i.eachSeries(function(u){var c=s===u,f=u.coordinateSystem;f&&f.master&&(f=f.master);var h=f&&o?f===o:c;if(!(t==="series"&&!c||t==="coordinateSystem"&&!h||e==="series"&&c)){var d=r.getViewOfSeriesModel(u);if(d.group.traverse(function(g){DI(g)}),Fa(e))a(u.getData(),e);else if(Yt(e))for(var p=Wr(e),m=0;m<p.length;m++)a(u.getData(p[m]),e[p[m]]);l.push(u),PI(u).isBlured=!0}}),i.eachComponent(function(u,c){if(u!=="series"){var f=r.getViewOfComponentModel(c);f&&f.toggleBlurSeries&&f.toggleBlurSeries(l,!0,i)}})}}function uk(n,e,t){if(!(n==null||e==null)){var r=t.getModel().getComponent(n,e);if(r){PI(r).isBlured=!0;var i=t.getViewOfComponentModel(r);!i||!i.focusBlurEnabled||i.group.traverse(function(a){DI(a)})}}}function JMe(n,e,t){var r=n.seriesIndex,i=n.getData(e.dataType);if(i){var a=yd(i,e);a=(Rt(a)?a[0]:a)||0;var s=i.getItemGraphicEl(a);if(!s)for(var o=i.count(),l=0;!s&&l<o;)s=i.getItemGraphicEl(l++);if(s){var u=ar(s);lk(r,u.focus,u.blurScope,t)}else{var c=n.get(["emphasis","focus"]),f=n.get(["emphasis","blurScope"]);c!=null&&lk(r,c,f,t)}}}function LI(n,e,t,r){var i={focusSelf:!1,dispatchers:null};if(n==null||n==="series"||e==null||t==null)return i;var a=r.getModel().getComponent(n,e);if(!a)return i;var s=r.getViewOfComponentModel(a);if(!s||!s.findHighDownDispatchers)return i;for(var o=s.findHighDownDispatchers(t),l,u=0;u<o.length;u++)if(ar(o[u]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:o}}function eke(n,e,t){var r=ar(n),i=LI(r.componentMainType,r.componentIndex,r.componentHighDownName,t),a=i.dispatchers,s=i.focusSelf;a?(s&&uk(r.componentMainType,r.componentIndex,t),ce(a,function(o){return qU(o,e)})):(lk(r.seriesIndex,r.focus,r.blurScope,t),r.focus==="self"&&uk(r.componentMainType,r.componentIndex,t),qU(n,e))}function tke(n,e,t){Uq(t);var r=ar(n),i=LI(r.componentMainType,r.componentIndex,r.componentHighDownName,t).dispatchers;i?ce(i,function(a){return XU(a,e)}):XU(n,e)}function nke(n,e,t){if(hk(e)){var r=e.dataType,i=n.getData(r),a=yd(i,e);Rt(a)||(a=[a]),n[e.type===Qy?"toggleSelect":e.type===Zy?"select":"unselect"](a,r)}}function KU(n){var e=n.getAllData();ce(e,function(t){var r=t.data,i=t.type;r.eachItemGraphicEl(function(a,s){n.isSelected(s,i)?$q(a):Fq(a)})})}function rke(n){var e=[];return n.eachSeries(function(t){var r=t.getAllData();ce(r,function(i){i.data;var a=i.type,s=t.getSelectedDataIndices();if(s.length>0){var o={dataIndex:s,seriesIndex:t.seriesIndex};a!=null&&(o.dataType=a),e.push(o)}})}),e}function ck(n,e,t){zq(n,!0),nc(n,ZMe),ake(n,e,t)}function ike(n){zq(n,!1)}function z0(n,e,t,r){r?ike(n):ck(n,e,t)}function ake(n,e,t){var r=ar(n);e!=null?(r.focus=e,r.blurScope=t):r.focus&&(r.focus=null)}var YU=["emphasis","blur","select"],ske={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function Ow(n,e,t,r){t=t||"itemStyle";for(var i=0;i<YU.length;i++){var a=YU[i],s=e.getModel([a,t]),o=n.ensureState(a);o.style=r?r(s):s[ske[t]]()}}function zq(n,e){var t=e===!1,r=n;n.highDownSilentOnTouch&&(r.__highDownSilentOnTouch=n.highDownSilentOnTouch),(!t||r.__highDownDispatcher)&&(r.__highByOuter=r.__highByOuter||0,r.__highDownDispatcher=!t)}function fk(n){return!!(n&&n.__highDownDispatcher)}function oke(n){var e=VU[n];return e==null&&zU<=32&&(e=VU[n]=zU++),e}function hk(n){var e=n.type;return e===Zy||e===Z1||e===Qy}function ZU(n){var e=n.type;return e===td||e===Y1}function lke(n){var e=Iq(n);e.normalFill=n.style.fill,e.normalStroke=n.style.stroke;var t=n.states.select||{};e.selectFill=t.style&&t.style.fill||null,e.selectStroke=t.style&&t.style.stroke||null}var Op=Xu.CMD,uke=[[],[],[]],QU=Math.sqrt,cke=Math.atan2;function Vq(n,e){if(e){var t=n.data,r=n.len(),i,a,s,o,l,u,c=Op.M,f=Op.C,h=Op.L,d=Op.R,p=Op.A,m=Op.Q;for(s=0,o=0;s<r;){switch(i=t[s++],o=s,a=0,i){case c:a=1;break;case h:a=1;break;case f:a=3;break;case m:a=2;break;case p:var g=e[4],v=e[5],_=QU(e[0]*e[0]+e[1]*e[1]),x=QU(e[2]*e[2]+e[3]*e[3]),b=cke(-e[1]/x,e[0]/_);t[s]*=_,t[s++]+=g,t[s]*=x,t[s++]+=v,t[s++]*=_,t[s++]*=x,t[s++]+=b,t[s++]+=b,s+=2,o=s;break;case d:u[0]=t[s++],u[1]=t[s++],mo(u,u,e),t[o++]=u[0],t[o++]=u[1],u[0]+=t[s++],u[1]+=t[s++],mo(u,u,e),t[o++]=u[0],t[o++]=u[1]}for(l=0;l<a;l++){var S=uke[l];S[0]=t[s++],S[1]=t[s++],mo(S,S,e),t[o++]=S[0],t[o++]=S[1]}}n.increaseVersion()}}var wE=Math.sqrt,Sb=Math.sin,Tb=Math.cos,Gv=Math.PI;function JU(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function dk(n,e){return(n[0]*e[0]+n[1]*e[1])/(JU(n)*JU(e))}function ez(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(dk(n,e))}function tz(n,e,t,r,i,a,s,o,l,u,c){var f=l*(Gv/180),h=Tb(f)*(n-t)/2+Sb(f)*(e-r)/2,d=-1*Sb(f)*(n-t)/2+Tb(f)*(e-r)/2,p=h*h/(s*s)+d*d/(o*o);p>1&&(s*=wE(p),o*=wE(p));var m=(i===a?-1:1)*wE((s*s*(o*o)-s*s*(d*d)-o*o*(h*h))/(s*s*(d*d)+o*o*(h*h)))||0,g=m*s*d/o,v=m*-o*h/s,_=(n+t)/2+Tb(f)*g-Sb(f)*v,x=(e+r)/2+Sb(f)*g+Tb(f)*v,b=ez([1,0],[(h-g)/s,(d-v)/o]),S=[(h-g)/s,(d-v)/o],T=[(-1*h-g)/s,(-1*d-v)/o],M=ez(S,T);if(dk(S,T)<=-1&&(M=Gv),dk(S,T)>=1&&(M=0),M<0){var C=Math.round(M/Gv*1e6)/1e6;M=Gv*2+C%2*Gv}c.addData(u,_,x,s,o,b,M,f,a)}var fke=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,hke=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function dke(n){var e=new Xu;if(!n)return e;var t=0,r=0,i=t,a=r,s,o=Xu.CMD,l=n.match(fke);if(!l)return e;for(var u=0;u<l.length;u++){for(var c=l[u],f=c.charAt(0),h=void 0,d=c.match(hke)||[],p=d.length,m=0;m<p;m++)d[m]=parseFloat(d[m]);for(var g=0;g<p;){var v=void 0,_=void 0,x=void 0,b=void 0,S=void 0,T=void 0,M=void 0,C=t,k=r,R=void 0,P=void 0;switch(f){case"l":t+=d[g++],r+=d[g++],h=o.L,e.addData(h,t,r);break;case"L":t=d[g++],r=d[g++],h=o.L,e.addData(h,t,r);break;case"m":t+=d[g++],r+=d[g++],h=o.M,e.addData(h,t,r),i=t,a=r,f="l";break;case"M":t=d[g++],r=d[g++],h=o.M,e.addData(h,t,r),i=t,a=r,f="L";break;case"h":t+=d[g++],h=o.L,e.addData(h,t,r);break;case"H":t=d[g++],h=o.L,e.addData(h,t,r);break;case"v":r+=d[g++],h=o.L,e.addData(h,t,r);break;case"V":r=d[g++],h=o.L,e.addData(h,t,r);break;case"C":h=o.C,e.addData(h,d[g++],d[g++],d[g++],d[g++],d[g++],d[g++]),t=d[g-2],r=d[g-1];break;case"c":h=o.C,e.addData(h,d[g++]+t,d[g++]+r,d[g++]+t,d[g++]+r,d[g++]+t,d[g++]+r),t+=d[g-2],r+=d[g-1];break;case"S":v=t,_=r,R=e.len(),P=e.data,s===o.C&&(v+=t-P[R-4],_+=r-P[R-3]),h=o.C,C=d[g++],k=d[g++],t=d[g++],r=d[g++],e.addData(h,v,_,C,k,t,r);break;case"s":v=t,_=r,R=e.len(),P=e.data,s===o.C&&(v+=t-P[R-4],_+=r-P[R-3]),h=o.C,C=t+d[g++],k=r+d[g++],t+=d[g++],r+=d[g++],e.addData(h,v,_,C,k,t,r);break;case"Q":C=d[g++],k=d[g++],t=d[g++],r=d[g++],h=o.Q,e.addData(h,C,k,t,r);break;case"q":C=d[g++]+t,k=d[g++]+r,t+=d[g++],r+=d[g++],h=o.Q,e.addData(h,C,k,t,r);break;case"T":v=t,_=r,R=e.len(),P=e.data,s===o.Q&&(v+=t-P[R-4],_+=r-P[R-3]),t=d[g++],r=d[g++],h=o.Q,e.addData(h,v,_,t,r);break;case"t":v=t,_=r,R=e.len(),P=e.data,s===o.Q&&(v+=t-P[R-4],_+=r-P[R-3]),t+=d[g++],r+=d[g++],h=o.Q,e.addData(h,v,_,t,r);break;case"A":x=d[g++],b=d[g++],S=d[g++],T=d[g++],M=d[g++],C=t,k=r,t=d[g++],r=d[g++],h=o.A,tz(C,k,t,r,T,M,x,b,S,h,e);break;case"a":x=d[g++],b=d[g++],S=d[g++],T=d[g++],M=d[g++],C=t,k=r,t+=d[g++],r+=d[g++],h=o.A,tz(C,k,t,r,T,M,x,b,S,h,e);break}}(f==="z"||f==="Z")&&(h=o.Z,e.addData(h),t=i,r=a),s=h}return e.toStatic(),e}var Hq=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.applyTransform=function(t){},e}(Wn);function Wq(n){return n.setData!=null}function Gq(n,e){var t=dke(n),r=gt({},e);return r.buildPath=function(i){if(Wq(i)){i.setData(t.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;t.rebuildPath(a,1)}},r.applyTransform=function(i){Vq(t,i),this.dirtyShape()},r}function pke(n,e){return new Hq(Gq(n,e))}function mke(n,e){var t=Gq(n,e),r=function(i){ht(a,i);function a(s){var o=i.call(this,s)||this;return o.applyTransform=t.applyTransform,o.buildPath=t.buildPath,o}return a}(Hq);return r}function gke(n,e){for(var t=[],r=n.length,i=0;i<r;i++){var a=n[i];t.push(a.getUpdatedPathProxy(!0))}var s=new Wn(e);return s.createPathProxy(),s.buildPath=function(o){if(Wq(o)){o.appendPath(t);var l=o.getContext();l&&o.rebuildPath(l,1)}},s}function NI(n,e){e=e||{};var t=new Wn;return n.shape&&t.setShape(n.shape),t.setStyle(n.style),e.bakeTransform?Vq(t.path,n.getComputedTransform()):e.toLocal?t.setLocalTransform(n.getComputedTransform()):t.copyTransform(n),t.buildPath=n.buildPath,t.applyTransform=t.applyTransform,t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel,t}var vke=function(){function n(){this.cx=0,this.cy=0,this.r=0}return n}(),jq=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new vke},e.prototype.buildPath=function(t,r){t.moveTo(r.cx+r.r,r.cy),t.arc(r.cx,r.cy,r.r,0,Math.PI*2)},e}(Wn);jq.prototype.type="circle";const ug=jq;var yke=function(){function n(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return n}(),qq=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new yke},e.prototype.buildPath=function(t,r){var i=.5522848,a=r.cx,s=r.cy,o=r.rx,l=r.ry,u=o*i,c=l*i;t.moveTo(a-o,s),t.bezierCurveTo(a-o,s-c,a-u,s-l,a,s-l),t.bezierCurveTo(a+u,s-l,a+o,s-c,a+o,s),t.bezierCurveTo(a+o,s+c,a+u,s+l,a,s+l),t.bezierCurveTo(a-u,s+l,a-o,s+c,a-o,s),t.closePath()},e}(Wn);qq.prototype.type="ellipse";const Xq=qq;var Kq=Math.PI,SE=Kq*2,fh=Math.sin,$p=Math.cos,_ke=Math.acos,ra=Math.atan2,nz=Math.abs,Jy=Math.sqrt,xy=Math.max,Tl=Math.min,No=1e-4;function xke(n,e,t,r,i,a,s,o){var l=t-n,u=r-e,c=s-i,f=o-a,h=f*l-c*u;if(!(h*h<No))return h=(c*(e-a)-f*(n-i))/h,[n+h*l,e+h*u]}function Cb(n,e,t,r,i,a,s){var o=n-t,l=e-r,u=(s?a:-a)/Jy(o*o+l*l),c=u*l,f=-u*o,h=n+c,d=e+f,p=t+c,m=r+f,g=(h+p)/2,v=(d+m)/2,_=p-h,x=m-d,b=_*_+x*x,S=i-a,T=h*m-p*d,M=(x<0?-1:1)*Jy(xy(0,S*S*b-T*T)),C=(T*x-_*M)/b,k=(-T*_-x*M)/b,R=(T*x+_*M)/b,P=(-T*_+x*M)/b,N=C-g,L=k-v,F=R-g,O=P-v;return N*N+L*L>F*F+O*O&&(C=R,k=P),{cx:C,cy:k,x0:-c,y0:-f,x1:C*(i/S-1),y1:k*(i/S-1)}}function bke(n){var e;if(Rt(n)){var t=n.length;if(!t)return n;t===1?e=[n[0],n[0],0,0]:t===2?e=[n[0],n[0],n[1],n[1]]:t===3?e=n.concat(n[2]):e=n}else e=[n,n,n,n];return e}function wke(n,e){var t,r=xy(e.r,0),i=xy(e.r0||0,0),a=r>0,s=i>0;if(!(!a&&!s)){if(a||(r=i,i=0),i>r){var o=r;r=i,i=o}var l=e.startAngle,u=e.endAngle;if(!(isNaN(l)||isNaN(u))){var c=e.cx,f=e.cy,h=!!e.clockwise,d=nz(u-l),p=d>SE&&d%SE;if(p>No&&(d=p),!(r>No))n.moveTo(c,f);else if(d>SE-No)n.moveTo(c+r*$p(l),f+r*fh(l)),n.arc(c,f,r,l,u,!h),i>No&&(n.moveTo(c+i*$p(u),f+i*fh(u)),n.arc(c,f,i,u,l,h));else{var m=void 0,g=void 0,v=void 0,_=void 0,x=void 0,b=void 0,S=void 0,T=void 0,M=void 0,C=void 0,k=void 0,R=void 0,P=void 0,N=void 0,L=void 0,F=void 0,O=r*$p(l),B=r*fh(l),H=i*$p(u),j=i*fh(u),K=d>No;if(K){var J=e.cornerRadius;J&&(t=bke(J),m=t[0],g=t[1],v=t[2],_=t[3]);var re=nz(r-i)/2;if(x=Tl(re,v),b=Tl(re,_),S=Tl(re,m),T=Tl(re,g),k=M=xy(x,b),R=C=xy(S,T),(M>No||C>No)&&(P=r*$p(u),N=r*fh(u),L=i*$p(l),F=i*fh(l),d<Kq)){var se=xke(O,B,L,F,P,N,H,j);if(se){var Ae=O-se[0],Ee=B-se[1],Ne=P-se[0],we=N-se[1],me=1/fh(_ke((Ae*Ne+Ee*we)/(Jy(Ae*Ae+Ee*Ee)*Jy(Ne*Ne+we*we)))/2),Se=Jy(se[0]*se[0]+se[1]*se[1]);k=Tl(M,(r-Se)/(me+1)),R=Tl(C,(i-Se)/(me-1))}}}if(!K)n.moveTo(c+O,f+B);else if(k>No){var Me=Tl(v,k),ke=Tl(_,k),He=Cb(L,F,O,B,r,Me,h),ee=Cb(P,N,H,j,r,ke,h);n.moveTo(c+He.cx+He.x0,f+He.cy+He.y0),k<M&&Me===ke?n.arc(c+He.cx,f+He.cy,k,ra(He.y0,He.x0),ra(ee.y0,ee.x0),!h):(Me>0&&n.arc(c+He.cx,f+He.cy,Me,ra(He.y0,He.x0),ra(He.y1,He.x1),!h),n.arc(c,f,r,ra(He.cy+He.y1,He.cx+He.x1),ra(ee.cy+ee.y1,ee.cx+ee.x1),!h),ke>0&&n.arc(c+ee.cx,f+ee.cy,ke,ra(ee.y1,ee.x1),ra(ee.y0,ee.x0),!h))}else n.moveTo(c+O,f+B),n.arc(c,f,r,l,u,!h);if(!(i>No)||!K)n.lineTo(c+H,f+j);else if(R>No){var Me=Tl(m,R),ke=Tl(g,R),He=Cb(H,j,P,N,i,-ke,h),ee=Cb(O,B,L,F,i,-Me,h);n.lineTo(c+He.cx+He.x0,f+He.cy+He.y0),R<C&&Me===ke?n.arc(c+He.cx,f+He.cy,R,ra(He.y0,He.x0),ra(ee.y0,ee.x0),!h):(ke>0&&n.arc(c+He.cx,f+He.cy,ke,ra(He.y0,He.x0),ra(He.y1,He.x1),!h),n.arc(c,f,i,ra(He.cy+He.y1,He.cx+He.x1),ra(ee.cy+ee.y1,ee.cx+ee.x1),h),Me>0&&n.arc(c+ee.cx,f+ee.cy,Me,ra(ee.y1,ee.x1),ra(ee.y0,ee.x0),!h))}else n.lineTo(c+H,f+j),n.arc(c,f,i,u,l,h)}n.closePath()}}}var Ske=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return n}(),Yq=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new Ske},e.prototype.buildPath=function(t,r){wke(t,r)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(Wn);Yq.prototype.type="sector";const tl=Yq;var Tke=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return n}(),Zq=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new Tke},e.prototype.buildPath=function(t,r){var i=r.cx,a=r.cy,s=Math.PI*2;t.moveTo(i+r.r,a),t.arc(i,a,r.r,0,s,!1),t.moveTo(i+r.r0,a),t.arc(i,a,r.r0,0,s,!0)},e}(Wn);Zq.prototype.type="ring";const OI=Zq;function Cke(n,e,t,r){var i=[],a=[],s=[],o=[],l,u,c,f;if(r){c=[1/0,1/0],f=[-1/0,-1/0];for(var h=0,d=n.length;h<d;h++)fm(c,c,n[h]),hm(f,f,n[h]);fm(c,c,r[0]),hm(f,f,r[1])}for(var h=0,d=n.length;h<d;h++){var p=n[h];if(t)l=n[h?h-1:d-1],u=n[(h+1)%d];else if(h===0||h===d-1){i.push(Y2e(n[h]));continue}else l=n[h-1],u=n[h+1];Z2e(a,u,l),V2(a,a,e);var m=UM(p,l),g=UM(p,u),v=m+g;v!==0&&(m/=v,g/=v),V2(s,a,-m),V2(o,a,g);var _=X5([],p,s),x=X5([],p,o);r&&(hm(_,_,c),fm(_,_,f),hm(x,x,c),fm(x,x,f)),i.push(_),i.push(x)}return t&&i.push(i.shift()),i}function Qq(n,e,t){var r=e.smooth,i=e.points;if(i&&i.length>=2){if(r){var a=Cke(i,r,t,e.smoothConstraint);n.moveTo(i[0][0],i[0][1]);for(var s=i.length,o=0;o<(t?s:s-1);o++){var l=a[o*2],u=a[o*2+1],c=i[(o+1)%s];n.bezierCurveTo(l[0],l[1],u[0],u[1],c[0],c[1])}}else{n.moveTo(i[0][0],i[0][1]);for(var o=1,f=i.length;o<f;o++)n.lineTo(i[o][0],i[o][1])}t&&n.closePath()}}var Eke=function(){function n(){this.points=null,this.smooth=0,this.smoothConstraint=null}return n}(),Jq=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new Eke},e.prototype.buildPath=function(t,r){Qq(t,r,!0)},e}(Wn);Jq.prototype.type="polygon";const wT=Jq;var Ake=function(){function n(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return n}(),eX=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Ake},e.prototype.buildPath=function(t,r){Qq(t,r,!1)},e}(Wn);eX.prototype.type="polyline";const P_=eX;var Mke={},kke=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}(),tX=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new kke},e.prototype.buildPath=function(t,r){var i,a,s,o;if(this.subPixelOptimize){var l=Mq(Mke,r,this.style);i=l.x1,a=l.y1,s=l.x2,o=l.y2}else i=r.x1,a=r.y1,s=r.x2,o=r.y2;var u=r.percent;u!==0&&(t.moveTo(i,a),u<1&&(s=i*(1-u)+s*u,o=a*(1-u)+o*u),t.lineTo(s,o))},e.prototype.pointAt=function(t){var r=this.shape;return[r.x1*(1-t)+r.x2*t,r.y1*(1-t)+r.y2*t]},e}(Wn);tX.prototype.type="line";const Xo=tX;var Wa=[],Rke=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return n}();function rz(n,e,t){var r=n.cpx2,i=n.cpy2;return r!=null||i!=null?[(t?aU:Si)(n.x1,n.cpx1,n.cpx2,n.x2,e),(t?aU:Si)(n.y1,n.cpy1,n.cpy2,n.y2,e)]:[(t?sU:aa)(n.x1,n.cpx1,n.x2,e),(t?sU:aa)(n.y1,n.cpy1,n.y2,e)]}var nX=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Rke},e.prototype.buildPath=function(t,r){var i=r.x1,a=r.y1,s=r.x2,o=r.y2,l=r.cpx1,u=r.cpy1,c=r.cpx2,f=r.cpy2,h=r.percent;h!==0&&(t.moveTo(i,a),c==null||f==null?(h<1&&(Rw(i,l,s,h,Wa),l=Wa[1],s=Wa[2],Rw(a,u,o,h,Wa),u=Wa[1],o=Wa[2]),t.quadraticCurveTo(l,u,s,o)):(h<1&&(pf(i,l,c,s,h,Wa),l=Wa[1],c=Wa[2],s=Wa[3],pf(a,u,f,o,h,Wa),u=Wa[1],f=Wa[2],o=Wa[3]),t.bezierCurveTo(l,u,c,f,s,o)))},e.prototype.pointAt=function(t){return rz(this.shape,t,!1)},e.prototype.tangentAt=function(t){var r=rz(this.shape,t,!0);return eEe(r,r)},e}(Wn);nX.prototype.type="bezier-curve";const rX=nX;var Pke=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),iX=function(n){ht(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Pke},e.prototype.buildPath=function(t,r){var i=r.cx,a=r.cy,s=Math.max(r.r,0),o=r.startAngle,l=r.endAngle,u=r.clockwise,c=Math.cos(o),f=Math.sin(o);t.moveTo(c*s+i,f*s+a),t.arc(i,a,s,o,l,!u)},e}(Wn);iX.prototype.type="arc";const $I=iX;var Ike=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="compound",t}return e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,r=this.shapeChanged(),i=0;i<t.length;i++)r=r||t[i].shapeChanged();r&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],r=this.getGlobalScale(),i=0;i<t.length;i++)t[i].path||t[i].createPathProxy(),t[i].path.setScale(r[0],r[1],t[i].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,r){for(var i=r.paths||[],a=0;a<i.length;a++)i[a].buildPath(t,i[a].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],r=0;r<t.length;r++)t[r].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Wn.prototype.getBoundingRect.call(this)},e}(Wn);const Dke=Ike;var Lke=function(){function n(e){this.colorStops=e||[]}return n.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},n}();const aX=Lke;var Nke=function(n){ht(e,n);function e(t,r,i,a,s,o){var l=n.call(this,s)||this;return l.x=t??0,l.y=r??0,l.x2=i??1,l.y2=a??0,l.type="linear",l.global=o||!1,l}return e}(aX);const sX=Nke;var Oke=function(n){ht(e,n);function e(t,r,i,a,s){var o=n.call(this,a)||this;return o.x=t??.5,o.y=r??.5,o.r=i??.5,o.type="radial",o.global=s||!1,o}return e}(aX);const $ke=Oke;var hh=[0,0],dh=[0,0],Eb=new nn,Ab=new nn,Fke=function(){function n(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var r=0;r<4;r++)this._corners[r]=new nn;for(var r=0;r<2;r++)this._axes[r]=new nn;e&&this.fromBoundingRect(e,t)}return n.prototype.fromBoundingRect=function(e,t){var r=this._corners,i=this._axes,a=e.x,s=e.y,o=a+e.width,l=s+e.height;if(r[0].set(a,s),r[1].set(o,s),r[2].set(o,l),r[3].set(a,l),t)for(var u=0;u<4;u++)r[u].transform(t);nn.sub(i[0],r[1],r[0]),nn.sub(i[1],r[3],r[0]),i[0].normalize(),i[1].normalize();for(var u=0;u<2;u++)this._origin[u]=i[u].dot(r[0])},n.prototype.intersect=function(e,t){var r=!0,i=!t;return Eb.set(1/0,1/0),Ab.set(0,0),!this._intersectCheckOneSide(this,e,Eb,Ab,i,1)&&(r=!1,i)||!this._intersectCheckOneSide(e,this,Eb,Ab,i,-1)&&(r=!1,i)||i||nn.copy(t,r?Eb:Ab),r},n.prototype._intersectCheckOneSide=function(e,t,r,i,a,s){for(var o=!0,l=0;l<2;l++){var u=this._axes[l];if(this._getProjMinMaxOnAxis(l,e._corners,hh),this._getProjMinMaxOnAxis(l,t._corners,dh),hh[1]<dh[0]||hh[0]>dh[1]){if(o=!1,a)return o;var c=Math.abs(dh[0]-hh[1]),f=Math.abs(hh[0]-dh[1]);Math.min(c,f)>i.len()&&(c<f?nn.scale(i,u,-c*s):nn.scale(i,u,f*s))}else if(r){var c=Math.abs(dh[0]-hh[1]),f=Math.abs(hh[0]-dh[1]);Math.min(c,f)<r.len()&&(c<f?nn.scale(r,u,c*s):nn.scale(r,u,-f*s))}}return o},n.prototype._getProjMinMaxOnAxis=function(e,t,r){for(var i=this._axes[e],a=this._origin,s=t[0].dot(i)+a[e],o=s,l=s,u=1;u<t.length;u++){var c=t[u].dot(i)+a[e];o=Math.min(c,o),l=Math.max(c,l)}r[0]=o,r[1]=l},n}();const $w=Fke;var Bke=[],Uke=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,r){r?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,r){r=r||!1;for(var i=0;i<t.length;i++)this.addDisplayable(t[i],r)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var r=this._cursor;r<this._displayables.length;r++)t&&t(this._displayables[r]);for(var r=0;r<this._temporaryDisplayables.length;r++)t&&t(this._temporaryDisplayables[r])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){var r=this._displayables[t];r.parent=this,r.update(),r.parent=null}for(var t=0;t<this._temporaryDisplayables.length;t++){var r=this._temporaryDisplayables[t];r.parent=this,r.update(),r.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new Xn(1/0,1/0,-1/0,-1/0),r=0;r<this._displayables.length;r++){var i=this._displayables[r],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(Bke)),t.union(a)}this._rect=t}return this._rect},e.prototype.contain=function(t,r){var i=this.transformCoordToLocal(t,r),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var s=0;s<this._displayables.length;s++){var o=this._displayables[s];if(o.contain(t,r))return!0}return!1},e}(Wg);const zke=Uke;var oX=qr();function ST(n,e,t,r,i){var a;if(e&&e.ecModel){var s=e.ecModel.getUpdatePayload();a=s&&s.animation}var o=e&&e.isAnimationEnabled(),l=n==="update";if(o){var u=void 0,c=void 0,f=void 0;r?(u=Hn(r.duration,200),c=Hn(r.easing,"cubicOut"),f=0):(u=e.getShallow(l?"animationDurationUpdate":"animationDuration"),c=e.getShallow(l?"animationEasingUpdate":"animationEasing"),f=e.getShallow(l?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(u=a.duration),a.easing!=null&&(c=a.easing),a.delay!=null&&(f=a.delay)),pn(f)&&(f=f(t,i)),pn(u)&&(u=u(t));var h={duration:u||0,delay:f,easing:c};return h}else return null}function FI(n,e,t,r,i,a,s){var o=!1,l;pn(i)?(s=a,a=i,i=null):Yt(i)&&(a=i.cb,s=i.during,o=i.isFrom,l=i.removeOpt,i=i.dataIndex);var u=n==="leave";u||e.stopAnimation("leave");var c=ST(n,r,i,u?l||{}:null,r&&r.getAnimationDelayParams?r.getAnimationDelayParams(e,i):null);if(c&&c.duration>0){var f=c.duration,h=c.delay,d=c.easing,p={duration:f,delay:h||0,easing:d,done:a,force:!!a||!!s,setToFinal:!u,scope:n,during:s};o?e.animateFrom(t,p):e.animateTo(t,p)}else e.stopAnimation(),!o&&e.attr(t),s&&s(1),a&&a()}function Ui(n,e,t,r,i,a){FI("update",n,e,t,r,i,a)}function _a(n,e,t,r,i,a){FI("enter",n,e,t,r,i,a)}function Dm(n){if(!n.__zr)return!0;for(var e=0;e<n.animators.length;e++){var t=n.animators[e];if(t.scope==="leave")return!0}return!1}function Fw(n,e,t,r,i,a){Dm(n)||FI("leave",n,e,t,r,i,a)}function iz(n,e,t,r){n.removeTextContent(),n.removeTextGuideLine(),Fw(n,{style:{opacity:0}},e,t,r)}function Bw(n,e,t){function r(){n.parent&&n.parent.remove(n)}n.isGroup?n.traverse(function(i){i.isGroup||iz(i,e,t,r)}):iz(n,e,t,r)}function BI(n){oX(n).oldStyle=n.style}function Vke(n){return oX(n).oldStyle}var Uw=Math.max,zw=Math.min,pk={};function Hke(n){return Wn.extend(n)}var Wke=mke;function Gke(n,e){return Wke(n,e)}function cl(n,e){pk[n]=e}function jke(n){if(pk.hasOwnProperty(n))return pk[n]}function UI(n,e,t,r){var i=pke(n,e);return t&&(r==="center"&&(t=uX(t,i.getBoundingRect())),cX(i,t)),i}function lX(n,e,t){var r=new zd({style:{image:n,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(i){if(t==="center"){var a={width:i.width,height:i.height};r.setStyle(uX(e,a))}}});return r}function uX(n,e){var t=e.width/e.height,r=n.height*t,i;r<=n.width?i=n.height:(r=n.width,i=r/t);var a=n.x+n.width/2,s=n.y+n.height/2;return{x:a-r/2,y:s-i/2,width:r,height:i}}var Mu=gke;function cX(n,e){if(n.applyTransform){var t=n.getBoundingRect(),r=t.calculateTransform(e);n.applyTransform(r)}}function V0(n,e){return Mq(n,n,{lineWidth:e}),n}function qke(n){return kq(n.shape,n.shape,n.style),n}var Xke=zh;function zI(n,e){for(var t=SI([]);n&&n!==e;)Pm(t,n.getLocalTransform(),t),n=n.parent;return t}function TT(n,e,t){return e&&!Fa(e)&&(e=A_.getLocalTransform(e)),t&&(e=pT([],e)),mo([],n,e)}function fX(n,e,t){var r=e[4]===0||e[5]===0||e[0]===0?1:Math.abs(2*e[4]/e[0]),i=e[4]===0||e[5]===0||e[2]===0?1:Math.abs(2*e[4]/e[2]),a=[n==="left"?-r:n==="right"?r:0,n==="top"?-i:n==="bottom"?i:0];return a=TT(a,e,t),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function az(n){return!n.isGroup}function Kke(n){return n.shape!=null}function VI(n,e,t){if(!n||!e)return;function r(s){var o={};return s.traverse(function(l){az(l)&&l.anid&&(o[l.anid]=l)}),o}function i(s){var o={x:s.x,y:s.y,rotation:s.rotation};return Kke(s)&&(o.shape=gt({},s.shape)),o}var a=r(n);e.traverse(function(s){if(az(s)&&s.anid){var o=a[s.anid];if(o){var l=i(s);s.attr(i(o)),Ui(s,l,t,ar(s).dataIndex)}}})}function hX(n,e){return Nt(n,function(t){var r=t[0];r=Uw(r,e.x),r=zw(r,e.x+e.width);var i=t[1];return i=Uw(i,e.y),i=zw(i,e.y+e.height),[r,i]})}function Yke(n,e){var t=Uw(n.x,e.x),r=zw(n.x+n.width,e.x+e.width),i=Uw(n.y,e.y),a=zw(n.y+n.height,e.y+e.height);if(r>=t&&a>=i)return{x:t,y:i,width:r-t,height:a-i}}function CT(n,e,t){var r=gt({rectHover:!0},e),i=r.style={strokeNoScale:!0};if(t=t||{x:-1,y:-1,width:2,height:2},n)return n.indexOf("image://")===0?(i.image=n.slice(8),ln(i,t),new zd(r)):UI(n.replace("path://",""),r,t,"center")}function Zke(n,e,t,r,i){for(var a=0,s=i[i.length-1];a<i.length;a++){var o=i[a];if(dX(n,e,t,r,o[0],o[1],s[0],s[1]))return!0;s=o}}function dX(n,e,t,r,i,a,s,o){var l=t-n,u=r-e,c=s-i,f=o-a,h=TE(c,f,l,u);if(Qke(h))return!1;var d=n-i,p=e-a,m=TE(d,p,l,u)/h;if(m<0||m>1)return!1;var g=TE(d,p,c,f)/h;return!(g<0||g>1)}function TE(n,e,t,r){return n*r-t*e}function Qke(n){return n<=1e-6&&n>=-1e-6}function ET(n){var e=n.itemTooltipOption,t=n.componentModel,r=n.itemName,i=jt(e)?{formatter:e}:e,a=t.mainType,s=t.componentIndex,o={componentType:a,name:r,$vars:["name"]};o[a+"Index"]=s;var l=n.formatterParamsExtra;l&&ce(Wr(l),function(c){ju(o,c)||(o[c]=l[c],o.$vars.push(c))});var u=ar(n.el);u.componentMainType=a,u.componentIndex=s,u.tooltipConfig={name:r,option:ln({content:r,formatterParams:o},i)}}function sz(n,e){var t;n.isGroup&&(t=e(n)),t||n.traverse(e)}function AT(n,e){if(n)if(Rt(n))for(var t=0;t<n.length;t++)sz(n[t],e);else sz(n,e)}cl("circle",ug);cl("ellipse",Xq);cl("sector",tl);cl("ring",OI);cl("polygon",wT);cl("polyline",P_);cl("rect",oi);cl("line",Xo);cl("bezierCurve",rX);cl("arc",$I);const Jke=Object.freeze(Object.defineProperty({__proto__:null,Arc:$I,BezierCurve:rX,BoundingRect:Xn,Circle:ug,CompoundPath:Dke,Ellipse:Xq,Group:yi,Image:zd,IncrementalDisplayable:zke,Line:Xo,LinearGradient:sX,OrientedBoundingRect:$w,Path:Wn,Point:nn,Polygon:wT,Polyline:P_,RadialGradient:$ke,Rect:oi,Ring:OI,Sector:tl,Text:Pi,applyTransform:TT,clipPointsByRect:hX,clipRectByRect:Yke,createIcon:CT,extendPath:Gke,extendShape:Hke,getShapeClass:jke,getTransform:zI,groupTransition:VI,initProps:_a,isElementRemoved:Dm,lineLineIntersect:dX,linePolygonIntersect:Zke,makeImage:lX,makePath:UI,mergePath:Mu,registerShape:cl,removeElement:Fw,removeElementWithFadeOut:Bw,resizePath:cX,setTooltipConfig:ET,subPixelOptimize:Xke,subPixelOptimizeLine:V0,subPixelOptimizeRect:qke,transformDirection:fX,traverseElements:AT,updateProps:Ui},Symbol.toStringTag,{value:"Module"}));var MT={};function pX(n,e){for(var t=0;t<xo.length;t++){var r=xo[t],i=e[r],a=n.ensureState(r);a.style=a.style||{},a.style.text=i}var s=n.currentStates.slice();n.clearStates(!0),n.setStyle({text:e.normal}),n.useStates(s,!0)}function mk(n,e,t){var r=n.labelFetcher,i=n.labelDataIndex,a=n.labelDimIndex,s=e.normal,o;r&&(o=r.getFormattedLabel(i,"normal",null,a,s&&s.get("formatter"),t!=null?{interpolatedValue:t}:null)),o==null&&(o=pn(n.defaultText)?n.defaultText(i,n,t):n.defaultText);for(var l={normal:o},u=0;u<xo.length;u++){var c=xo[u],f=e[c];l[c]=Hn(r?r.getFormattedLabel(i,c,null,a,f&&f.get("formatter")):null,o)}return l}function I_(n,e,t,r){t=t||MT;for(var i=n instanceof Pi,a=!1,s=0;s<Nw.length;s++){var o=e[Nw[s]];if(o&&o.getShallow("show")){a=!0;break}}var l=i?n:n.getTextContent();if(a){i||(l||(l=new Pi,n.setTextContent(l)),n.stateProxy&&(l.stateProxy=n.stateProxy));var u=mk(t,e),c=e.normal,f=!!c.getShallow("show"),h=Ku(c,r&&r.normal,t,!1,!i);h.text=u.normal,i||n.setTextConfig(oz(c,t,!1));for(var s=0;s<xo.length;s++){var d=xo[s],o=e[d];if(o){var p=l.ensureState(d),m=!!Hn(o.getShallow("show"),f);if(m!==f&&(p.ignore=!m),p.style=Ku(o,r&&r[d],t,!0,!i),p.style.text=u[d],!i){var g=n.ensureState(d);g.textConfig=oz(o,t,!0)}}}l.silent=!!c.getShallow("silent"),l.style.x!=null&&(h.x=l.style.x),l.style.y!=null&&(h.y=l.style.y),l.ignore=!f,l.useStyle(h),l.dirty(),t.enableTextSetter&&(Gg(l).setLabelText=function(v){var _=mk(t,e,v);pX(l,_)})}else l&&(l.ignore=!0);n.dirty()}function D_(n,e){e=e||"label";for(var t={normal:n.getModel(e)},r=0;r<xo.length;r++){var i=xo[r];t[i]=n.getModel([i,e])}return t}function Ku(n,e,t,r,i){var a={};return eRe(a,n,t,r,i),e&&gt(a,e),a}function oz(n,e,t){e=e||{};var r={},i,a=n.getShallow("rotate"),s=Hn(n.getShallow("distance"),t?null:5),o=n.getShallow("offset");return i=n.getShallow("position")||(t?null:"inside"),i==="outside"&&(i=e.defaultOutsidePosition||"top"),i!=null&&(r.position=i),o!=null&&(r.offset=o),a!=null&&(a*=Math.PI/180,r.rotation=a),s!=null&&(r.distance=s),r.outsideFill=n.get("color")==="inherit"?e.inheritColor||null:"auto",r}function eRe(n,e,t,r,i){t=t||MT;var a=e.ecModel,s=a&&a.option.textStyle,o=tRe(e),l;if(o){l={};for(var u in o)if(o.hasOwnProperty(u)){var c=e.getModel(["rich",u]);fz(l[u]={},c,s,t,r,i,!1,!0)}}l&&(n.rich=l);var f=e.get("overflow");f&&(n.overflow=f);var h=e.get("minMargin");h!=null&&(n.margin=h),fz(n,e,s,t,r,i,!0,!1)}function tRe(n){for(var e;n&&n!==n.ecModel;){var t=(n.option||MT).rich;if(t){e=e||{};for(var r=Wr(t),i=0;i<r.length;i++){var a=r[i];e[a]=1}}n=n.parentModel}return e}var lz=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],uz=["align","lineHeight","width","height","tag","verticalAlign"],cz=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function fz(n,e,t,r,i,a,s,o){t=!i&&t||MT;var l=r&&r.inheritColor,u=e.getShallow("color"),c=e.getShallow("textBorderColor"),f=Hn(e.getShallow("opacity"),t.opacity);(u==="inherit"||u==="auto")&&(l?u=l:u=null),(c==="inherit"||c==="auto")&&(l?c=l:c=null),a||(u=u||t.color,c=c||t.textBorderColor),u!=null&&(n.fill=u),c!=null&&(n.stroke=c);var h=Hn(e.getShallow("textBorderWidth"),t.textBorderWidth);h!=null&&(n.lineWidth=h);var d=Hn(e.getShallow("textBorderType"),t.textBorderType);d!=null&&(n.lineDash=d);var p=Hn(e.getShallow("textBorderDashOffset"),t.textBorderDashOffset);p!=null&&(n.lineDashOffset=p),!i&&f==null&&!o&&(f=r&&r.defaultOpacity),f!=null&&(n.opacity=f),!i&&!a&&n.fill==null&&r.inheritColor&&(n.fill=r.inheritColor);for(var m=0;m<lz.length;m++){var g=lz[m],v=Hn(e.getShallow(g),t[g]);v!=null&&(n[g]=v)}for(var m=0;m<uz.length;m++){var g=uz[m],v=e.getShallow(g);v!=null&&(n[g]=v)}if(n.verticalAlign==null){var _=e.getShallow("baseline");_!=null&&(n.verticalAlign=_)}if(!s||!r.disableBox){for(var m=0;m<cz.length;m++){var g=cz[m],v=e.getShallow(g);v!=null&&(n[g]=v)}var x=e.getShallow("borderType");x!=null&&(n.borderDash=x),(n.backgroundColor==="auto"||n.backgroundColor==="inherit")&&l&&(n.backgroundColor=l),(n.borderColor==="auto"||n.borderColor==="inherit")&&l&&(n.borderColor=l)}}function nRe(n,e){var t=e&&e.getModel("textStyle");return Dl([n.fontStyle||t&&t.getShallow("fontStyle")||"",n.fontWeight||t&&t.getShallow("fontWeight")||"",(n.fontSize||t&&t.getShallow("fontSize")||12)+"px",n.fontFamily||t&&t.getShallow("fontFamily")||"sans-serif"].join(" "))}var Gg=qr();function rRe(n,e,t,r){if(n){var i=Gg(n);i.prevValue=i.value,i.value=t;var a=e.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=r,i.statesModels=e)}}function iRe(n,e,t,r,i){var a=Gg(n);if(!a.valueAnimation||a.prevValue===a.value)return;var s=a.defaultInterpolatedText,o=Hn(a.interpolatedValue,a.prevValue),l=a.value;function u(c){var f=gq(t,a.precision,o,l,c);a.interpolatedValue=c===1?null:f;var h=mk({labelDataIndex:e,labelFetcher:i,defaultText:s?s(f):f+""},a.statesModels,f);pX(n,h)}n.percent=0,(a.prevValue==null?_a:Ui)(n,{percent:1},r,e,null,u)}var aRe=["textStyle","color"],CE=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],EE=new Pi,sRe=function(){function n(){}return n.prototype.getTextColor=function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(aRe):null)},n.prototype.getFont=function(){return nRe({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},n.prototype.getTextRect=function(e){for(var t={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},r=0;r<CE.length;r++)t[CE[r]]=this.getShallow(CE[r]);return EE.useStyle(t),EE.update(),EE.getBoundingRect()},n}();const oRe=sRe;var mX=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],lRe=U0(mX),uRe=function(){function n(){}return n.prototype.getLineStyle=function(e){return lRe(this,e)},n}(),gX=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],cRe=U0(gX),fRe=function(){function n(){}return n.prototype.getItemStyle=function(e,t){return cRe(this,e,t)},n}(),Vd=function(){function n(e,t,r){this.parentModel=t,this.ecModel=r,this.option=e}return n.prototype.init=function(e,t,r){},n.prototype.mergeOption=function(e,t){Dn(this.option,e,!0)},n.prototype.get=function(e,t){return e==null?this.option:this._doGet(this.parsePath(e),!t&&this.parentModel)},n.prototype.getShallow=function(e,t){var r=this.option,i=r==null?r:r[e];if(i==null&&!t){var a=this.parentModel;a&&(i=a.getShallow(e))}return i},n.prototype.getModel=function(e,t){var r=e!=null,i=r?this.parsePath(e):null,a=r?this._doGet(i):this.option;return t=t||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new n(a,t,this.ecModel)},n.prototype.isEmpty=function(){return this.option==null},n.prototype.restoreData=function(){},n.prototype.clone=function(){var e=this.constructor;return new e(wn(this.option))},n.prototype.parsePath=function(e){return typeof e=="string"?e.split("."):e},n.prototype.resolveParentPath=function(e){return e},n.prototype.isAnimationEnabled=function(){if(!In.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},n.prototype._doGet=function(e,t){var r=this.option;if(!e)return r;for(var i=0;i<e.length&&!(e[i]&&(r=r&&typeof r=="object"?r[e[i]]:null,r==null));i++);return r==null&&t&&(r=t._doGet(this.resolveParentPath(e),t.parentModel)),r},n}();RI(Vd);jAe(Vd);ll(Vd,uRe);ll(Vd,fRe);ll(Vd,ZAe);ll(Vd,oRe);const Fi=Vd;var hRe=Math.round(Math.random()*10);function L_(n){return[n||"",hRe++].join("_")}function dRe(n){var e={};n.registerSubTypeDefaulter=function(t,r){var i=Ll(t);e[i.main]=r},n.determineSubType=function(t,r){var i=r.type;if(!i){var a=Ll(t).main;n.hasSubTypes(t)&&e[a]&&(i=e[a](r))}return i}}function pRe(n,e){n.topologicalTravel=function(a,s,o,l){if(!a.length)return;var u=t(s),c=u.graph,f=u.noEntryList,h={};for(ce(a,function(_){h[_]=!0});f.length;){var d=f.pop(),p=c[d],m=!!h[d];m&&(o.call(l,d,p.originalDeps.slice()),delete h[d]),ce(p.successor,m?v:g)}ce(h,function(){var _="";throw new Error(_)});function g(_){c[_].entryCount--,c[_].entryCount===0&&f.push(_)}function v(_){h[_]=!0,g(_)}};function t(a){var s={},o=[];return ce(a,function(l){var u=r(s,l),c=u.originalDeps=e(l),f=i(c,a);u.entryCount=f.length,u.entryCount===0&&o.push(l),ce(f,function(h){Vn(u.predecessor,h)<0&&u.predecessor.push(h);var d=r(s,h);Vn(d.successor,h)<0&&d.successor.push(l)})}),{graph:s,noEntryList:o}}function r(a,s){return a[s]||(a[s]={predecessor:[],successor:[]}),a[s]}function i(a,s){var o=[];return ce(a,function(l){Vn(s,l)>=0&&o.push(l)}),o}}function vX(n,e){return Dn(Dn({},n,!0),e,!0)}const mRe={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},gRe={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var Vw="ZH",HI="EN",H0=HI,Q1={},WI={},yX=In.domSupported?function(){var n=(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase();return n.indexOf(Vw)>-1?Vw:H0}():H0;function _X(n,e){n=n.toUpperCase(),WI[n]=new Fi(e),Q1[n]=e}function vRe(n){if(jt(n)){var e=Q1[n.toUpperCase()]||{};return n===Vw||n===HI?wn(e):Dn(wn(e),wn(Q1[H0]),!1)}else return Dn(wn(n),wn(Q1[H0]),!1)}function yRe(n){return WI[n]}function _Re(){return WI[H0]}_X(HI,mRe);_X(Vw,gRe);var GI=1e3,jI=GI*60,e0=jI*60,to=e0*24,hz=to*365,by={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},Mb="{yyyy}-{MM}-{dd}",dz={year:"{yyyy}",month:"{yyyy}-{MM}",day:Mb,hour:Mb+" "+by.hour,minute:Mb+" "+by.minute,second:Mb+" "+by.second,millisecond:by.none},AE=["year","month","day","hour","minute","second","millisecond"],xX=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function ph(n,e){return n+="","0000".substr(0,e-n.length)+n}function Lm(n){switch(n){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return n}}function xRe(n){return n===Lm(n)}function bRe(n){switch(n){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function kT(n,e,t,r){var i=qu(n),a=i[qI(t)](),s=i[Nm(t)]()+1,o=Math.floor((s-1)/3)+1,l=i[RT(t)](),u=i["get"+(t?"UTC":"")+"Day"](),c=i[W0(t)](),f=(c-1)%12+1,h=i[PT(t)](),d=i[IT(t)](),p=i[DT(t)](),m=r instanceof Fi?r:yRe(r||yX)||_Re(),g=m.getModel("time"),v=g.get("month"),_=g.get("monthAbbr"),x=g.get("dayOfWeek"),b=g.get("dayOfWeekAbbr");return(e||"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,a%100+"").replace(/{Q}/g,o+"").replace(/{MMMM}/g,v[s-1]).replace(/{MMM}/g,_[s-1]).replace(/{MM}/g,ph(s,2)).replace(/{M}/g,s+"").replace(/{dd}/g,ph(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,x[u]).replace(/{ee}/g,b[u]).replace(/{e}/g,u+"").replace(/{HH}/g,ph(c,2)).replace(/{H}/g,c+"").replace(/{hh}/g,ph(f+"",2)).replace(/{h}/g,f+"").replace(/{mm}/g,ph(h,2)).replace(/{m}/g,h+"").replace(/{ss}/g,ph(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,ph(p,3)).replace(/{S}/g,p+"")}function wRe(n,e,t,r,i){var a=null;if(jt(t))a=t;else if(pn(t))a=t(n.value,e,{level:n.level});else{var s=gt({},by);if(n.level>0)for(var o=0;o<AE.length;++o)s[AE[o]]="{primary|"+s[AE[o]]+"}";var l=t?t.inherit===!1?t:ln(t,s):s,u=bX(n.value,i);if(l[u])a=l[u];else if(l.inherit){for(var c=xX.indexOf(u),o=c-1;o>=0;--o)if(l[u]){a=l[u];break}a=a||s.none}if(Rt(a)){var f=n.level==null?0:n.level>=0?n.level:a.length+n.level;f=Math.min(f,a.length-1),a=a[f]}}return kT(new Date(n.value),a,i,r)}function bX(n,e){var t=qu(n),r=t[Nm(e)]()+1,i=t[RT(e)](),a=t[W0(e)](),s=t[PT(e)](),o=t[IT(e)](),l=t[DT(e)](),u=l===0,c=u&&o===0,f=c&&s===0,h=f&&a===0,d=h&&i===1,p=d&&r===1;return p?"year":d?"month":h?"day":f?"hour":c?"minute":u?"second":"millisecond"}function pz(n,e,t){var r=gr(n)?qu(n):n;switch(e=e||bX(n,t),e){case"year":return r[qI(t)]();case"half-year":return r[Nm(t)]()>=6?1:0;case"quarter":return Math.floor((r[Nm(t)]()+1)/4);case"month":return r[Nm(t)]();case"day":return r[RT(t)]();case"half-day":return r[W0(t)]()/24;case"hour":return r[W0(t)]();case"minute":return r[PT(t)]();case"second":return r[IT(t)]();case"millisecond":return r[DT(t)]()}}function qI(n){return n?"getUTCFullYear":"getFullYear"}function Nm(n){return n?"getUTCMonth":"getMonth"}function RT(n){return n?"getUTCDate":"getDate"}function W0(n){return n?"getUTCHours":"getHours"}function PT(n){return n?"getUTCMinutes":"getMinutes"}function IT(n){return n?"getUTCSeconds":"getSeconds"}function DT(n){return n?"getUTCMilliseconds":"getMilliseconds"}function SRe(n){return n?"setUTCFullYear":"setFullYear"}function wX(n){return n?"setUTCMonth":"setMonth"}function SX(n){return n?"setUTCDate":"setDate"}function TX(n){return n?"setUTCHours":"setHours"}function CX(n){return n?"setUTCMinutes":"setMinutes"}function EX(n){return n?"setUTCSeconds":"setSeconds"}function AX(n){return n?"setUTCMilliseconds":"setMilliseconds"}function MX(n){if(!CAe(n))return jt(n)?n:"-";var e=(n+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function kX(n,e){return n=(n||"").toLowerCase().replace(/-(.)/g,function(t,r){return r.toUpperCase()}),e&&n&&(n=n.charAt(0).toUpperCase()+n.slice(1)),n}var LT=I7;function gk(n,e,t){var r="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(c){return c&&Dl(c)?c:"-"}function a(c){return!!(c!=null&&!isNaN(c)&&isFinite(c))}var s=e==="time",o=n instanceof Date;if(s||o){var l=s?qu(n):n;if(isNaN(+l)){if(o)return"-"}else return kT(l,r,t)}if(e==="ordinal")return BM(n)?i(n):gr(n)&&a(n)?n+"":"-";var u=gf(n);return a(u)?MX(u):BM(n)?i(n):typeof n=="boolean"?n+"":"-"}var mz=["a","b","c","d","e","f","g"],ME=function(n,e){return"{"+n+(e??"")+"}"};function RX(n,e,t){Rt(e)||(e=[e]);var r=e.length;if(!r)return"";for(var i=e[0].$vars||[],a=0;a<i.length;a++){var s=mz[a];n=n.replace(ME(s),ME(s,0))}for(var o=0;o<r;o++)for(var l=0;l<i.length;l++){var u=e[o][i[l]];n=n.replace(ME(mz[l],o),t?Zs(u):u)}return n}function TRe(n,e){var t=jt(n)?{color:n,extraCssText:e}:n||{},r=t.color,i=t.type;e=t.extraCssText;var a=t.renderMode||"html";if(!r)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Zs(r)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Zs(r)+";"+(e||"")+'"></span>';var s=t.markerId||"markerX";return{renderMode:a,content:"{"+s+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:r}:{width:10,height:10,borderRadius:5,backgroundColor:r}}}function _d(n,e){return e=e||"transparent",jt(n)?n:Yt(n)&&n.colorStops&&(n.colorStops[0]||{}).color||e}function gz(n,e){if(e==="_blank"||e==="blank"){var t=window.open();t.opener=null,t.location.href=n}else window.open(n,e)}var J1=ce,CRe=["left","right","top","bottom","width","height"],kb=[["width","left","right"],["height","top","bottom"]];function XI(n,e,t,r,i){var a=0,s=0;r==null&&(r=1/0),i==null&&(i=1/0);var o=0;e.eachChild(function(l,u){var c=l.getBoundingRect(),f=e.childAt(u+1),h=f&&f.getBoundingRect(),d,p;if(n==="horizontal"){var m=c.width+(h?-h.x+c.x:0);d=a+m,d>r||l.newline?(a=0,d=m,s+=o+t,o=c.height):o=Math.max(o,c.height)}else{var g=c.height+(h?-h.y+c.y:0);p=s+g,p>i||l.newline?(a+=o+t,s=0,p=g,o=c.width):o=Math.max(o,c.width)}l.newline||(l.x=a,l.y=s,l.markRedraw(),n==="horizontal"?a=d+t:s=p+t)})}var Om=XI;ir(XI,"vertical");ir(XI,"horizontal");function vf(n,e,t){t=LT(t||0);var r=e.width,i=e.height,a=Jn(n.left,r),s=Jn(n.top,i),o=Jn(n.right,r),l=Jn(n.bottom,i),u=Jn(n.width,r),c=Jn(n.height,i),f=t[2]+t[0],h=t[1]+t[3],d=n.aspect;switch(isNaN(u)&&(u=r-o-h-a),isNaN(c)&&(c=i-l-f-s),d!=null&&(isNaN(u)&&isNaN(c)&&(d>r/i?u=r*.8:c=i*.8),isNaN(u)&&(u=d*c),isNaN(c)&&(c=u/d)),isNaN(a)&&(a=r-o-u-h),isNaN(s)&&(s=i-l-c-f),n.left||n.right){case"center":a=r/2-u/2-t[3];break;case"right":a=r-u-h;break}switch(n.top||n.bottom){case"middle":case"center":s=i/2-c/2-t[0];break;case"bottom":s=i-c-f;break}a=a||0,s=s||0,isNaN(u)&&(u=r-h-a-(o||0)),isNaN(c)&&(c=i-f-s-(l||0));var p=new Xn(a+t[3],s+t[0],u,c);return p.margin=t,p}function ERe(n,e,t,r,i,a){var s=!i||!i.hv||i.hv[0],o=!i||!i.hv||i.hv[1],l=i&&i.boundingMode||"all";if(a=a||n,a.x=n.x,a.y=n.y,!s&&!o)return!1;var u;if(l==="raw")u=n.type==="group"?new Xn(0,0,+e.width||0,+e.height||0):n.getBoundingRect();else if(u=n.getBoundingRect(),n.needLocalTransform()){var c=n.getLocalTransform();u=u.clone(),u.applyTransform(c)}var f=vf(ln({width:u.width,height:u.height},e),t,r),h=s?f.x-u.x:0,d=o?f.y-u.y:0;return l==="raw"?(a.x=h,a.y=d):(a.x+=h,a.y+=d),a===n&&n.markRedraw(),!0}function G0(n){var e=n.layoutMode||n.constructor.layoutMode;return Yt(e)?e:e?{type:e}:null}function cg(n,e,t){var r=t&&t.ignoreSize;!Rt(r)&&(r=[r,r]);var i=s(kb[0],0),a=s(kb[1],1);u(kb[0],n,i),u(kb[1],n,a);function s(c,f){var h={},d=0,p={},m=0,g=2;if(J1(c,function(x){p[x]=n[x]}),J1(c,function(x){o(e,x)&&(h[x]=p[x]=e[x]),l(h,x)&&d++,l(p,x)&&m++}),r[f])return l(e,c[1])?p[c[2]]=null:l(e,c[2])&&(p[c[1]]=null),p;if(m===g||!d)return p;if(d>=g)return h;for(var v=0;v<c.length;v++){var _=c[v];if(!o(h,_)&&o(n,_)){h[_]=n[_];break}}return h}function o(c,f){return c.hasOwnProperty(f)}function l(c,f){return c[f]!=null&&c[f]!=="auto"}function u(c,f,h){J1(c,function(d){f[d]=h[d]})}}function NT(n){return ARe({},n)}function ARe(n,e){return e&&n&&J1(CRe,function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n}var MRe=qr(),jg=function(n){ht(e,n);function e(t,r,i){var a=n.call(this,t,r,i)||this;return a.uid=L_("ec_cpt_model"),a}return e.prototype.init=function(t,r,i){this.mergeDefaultAndTheme(t,i)},e.prototype.mergeDefaultAndTheme=function(t,r){var i=G0(this),a=i?NT(t):{},s=r.getTheme();Dn(t,s.get(this.mainType)),Dn(t,this.getDefaultOption()),i&&cg(t,a,i)},e.prototype.mergeOption=function(t,r){Dn(this.option,t,!0);var i=G0(this);i&&cg(this.option,t,i)},e.prototype.optionUpdated=function(t,r){},e.prototype.getDefaultOption=function(){var t=this.constructor;if(!HAe(t))return t.defaultOption;var r=MRe(this);if(!r.defaultOption){for(var i=[],a=t;a;){var s=a.prototype.defaultOption;s&&i.push(s),a=a.superClass}for(var o={},l=i.length-1;l>=0;l--)o=Dn(o,i[l],!0);r.defaultOption=o}return r.defaultOption},e.prototype.getReferringComponents=function(t,r){var i=t+"Index",a=t+"Id";return R_(this.ecModel,t,{index:this.get(i,!0),id:this.get(a,!0)},r)},e.prototype.getBoxLayoutParams=function(){var t=this;return{left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")}},e.prototype.getZLevelKey=function(){return""},e.prototype.setZLevel=function(t){this.option.zlevel=t},e.protoInitialize=function(){var t=e.prototype;t.type="component",t.id="",t.name="",t.mainType="",t.subType="",t.componentIndex=0}(),e}(Fi);yq(jg,Fi);gT(jg);dRe(jg);pRe(jg,kRe);function kRe(n){var e=[];return ce(jg.getClassesByMainType(n),function(t){e=e.concat(t.dependencies||t.prototype.dependencies||[])}),e=Nt(e,function(t){return Ll(t).main}),n!=="dataset"&&Vn(e,"dataset")<=0&&e.unshift("dataset"),e}const Sr=jg;var PX="";typeof navigator<"u"&&(PX=navigator.platform||"");var Fp="rgba(0, 0, 0, 0.2)";const RRe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:Fp,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:Fp,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:Fp,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:Fp,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:Fp,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:Fp,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:PX.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var IX=dn(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),wo="original",Ba="arrayRows",So="objectRows",tu="keyedColumns",af="typedArray",DX="unknown",Bl="column",qg="row",Hi={Must:1,Might:2,Not:3},LX=qr();function PRe(n){LX(n).datasetMap=dn()}function IRe(n,e,t){var r={},i=KI(e);if(!i||!n)return r;var a=[],s=[],o=e.ecModel,l=LX(o).datasetMap,u=i.uid+"_"+t.seriesLayoutBy,c,f;n=n.slice(),ce(n,function(m,g){var v=Yt(m)?m:n[g]={name:m};v.type==="ordinal"&&c==null&&(c=g,f=p(v)),r[v.name]=[]});var h=l.get(u)||l.set(u,{categoryWayDim:f,valueWayDim:0});ce(n,function(m,g){var v=m.name,_=p(m);if(c==null){var x=h.valueWayDim;d(r[v],x,_),d(s,x,_),h.valueWayDim+=_}else if(c===g)d(r[v],0,_),d(a,0,_);else{var x=h.categoryWayDim;d(r[v],x,_),d(s,x,_),h.categoryWayDim+=_}});function d(m,g,v){for(var _=0;_<v;_++)m.push(g+_)}function p(m){var g=m.dimsDef;return g?g.length:1}return a.length&&(r.itemName=a),s.length&&(r.seriesName=s),r}function DRe(n,e,t){var r={},i=KI(n);if(!i)return r;var a=e.sourceFormat,s=e.dimensionsDefine,o;(a===So||a===tu)&&ce(s,function(c,f){(Yt(c)?c.name:c)==="name"&&(o=f)});var l=function(){for(var c={},f={},h=[],d=0,p=Math.min(5,t);d<p;d++){var m=OX(e.data,a,e.seriesLayoutBy,s,e.startIndex,d);h.push(m);var g=m===Hi.Not;if(g&&c.v==null&&d!==o&&(c.v=d),(c.n==null||c.n===c.v||!g&&h[c.n]===Hi.Not)&&(c.n=d),v(c)&&h[c.n]!==Hi.Not)return c;g||(m===Hi.Might&&f.v==null&&d!==o&&(f.v=d),(f.n==null||f.n===f.v)&&(f.n=d))}function v(_){return _.v!=null&&_.n!=null}return v(c)?c:v(f)?f:null}();if(l){r.value=[l.v];var u=o??l.n;r.itemName=[u],r.seriesName=[u]}return r}function KI(n){var e=n.get("data",!0);if(!e)return R_(n.ecModel,"dataset",{index:n.get("datasetIndex",!0),id:n.get("datasetId",!0)},qi).models[0]}function LRe(n){return!n.get("transform",!0)&&!n.get("fromTransformResult",!0)?[]:R_(n.ecModel,"dataset",{index:n.get("fromDatasetIndex",!0),id:n.get("fromDatasetId",!0)},qi).models}function NX(n,e){return OX(n.data,n.sourceFormat,n.seriesLayoutBy,n.dimensionsDefine,n.startIndex,e)}function OX(n,e,t,r,i,a){var s,o=5;if(Rs(n))return Hi.Not;var l,u;if(r){var c=r[a];Yt(c)?(l=c.name,u=c.type):jt(c)&&(l=c)}if(u!=null)return u==="ordinal"?Hi.Must:Hi.Not;if(e===Ba){var f=n;if(t===qg){for(var h=f[a],d=0;d<(h||[]).length&&d<o;d++)if((s=b(h[i+d]))!=null)return s}else for(var d=0;d<f.length&&d<o;d++){var p=f[i+d];if(p&&(s=b(p[a]))!=null)return s}}else if(e===So){var m=n;if(!l)return Hi.Not;for(var d=0;d<m.length&&d<o;d++){var g=m[d];if(g&&(s=b(g[l]))!=null)return s}}else if(e===tu){var v=n;if(!l)return Hi.Not;var h=v[l];if(!h||Rs(h))return Hi.Not;for(var d=0;d<h.length&&d<o;d++)if((s=b(h[d]))!=null)return s}else if(e===wo)for(var _=n,d=0;d<_.length&&d<o;d++){var g=_[d],x=k_(g);if(!Rt(x))return Hi.Not;if((s=b(x[a]))!=null)return s}function b(S){var T=jt(S);if(S!=null&&isFinite(S)&&S!=="")return T?Hi.Might:Hi.Not;if(T&&S!=="-")return Hi.Must}return Hi.Not}var vk=dn();function NRe(n,e){ql(vk.get(n)==null&&e),vk.set(n,e)}function ORe(n,e,t){var r=vk.get(e);if(!r)return t;var i=r(n);return i?t.concat(i):t}var vz=qr();qr();var YI=function(){function n(){}return n.prototype.getColorFromPalette=function(e,t,r){var i=ci(this.get("color",!0)),a=this.get("colorLayer",!0);return FRe(this,vz,i,a,e,t,r)},n.prototype.clearColorPalette=function(){BRe(this,vz)},n}();function $Re(n,e){for(var t=n.length,r=0;r<t;r++)if(n[r].length>e)return n[r];return n[t-1]}function FRe(n,e,t,r,i,a,s){a=a||n;var o=e(a),l=o.paletteIdx||0,u=o.paletteNameMap=o.paletteNameMap||{};if(u.hasOwnProperty(i))return u[i];var c=s==null||!r?t:$Re(r,s);if(c=c||t,!(!c||!c.length)){var f=c[l];return i&&(u[i]=f),o.paletteIdx=(l+1)%c.length,f}}function BRe(n,e){e(n).paletteIdx=0,e(n).paletteNameMap={}}var Rb,jv,yz,_z="\0_ec_inner",URe=1,$X=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t,r,i,a,s,o){a=a||{},this.option=null,this._theme=new Fi(a),this._locale=new Fi(s),this._optionManager=o},e.prototype.setOption=function(t,r,i){var a=wz(r);this._optionManager.setOption(t,i,a),this._resetOption(null,a)},e.prototype.resetOption=function(t,r){return this._resetOption(t,wz(r))},e.prototype._resetOption=function(t,r){var i=!1,a=this._optionManager;if(!t||t==="recreate"){var s=a.mountOption(t==="recreate");!this.option||t==="recreate"?yz(this,s):(this.restoreData(),this._mergeOption(s,r)),i=!0}if((t==="timeline"||t==="media")&&this.restoreData(),!t||t==="recreate"||t==="timeline"){var o=a.getTimelineOption(this);o&&(i=!0,this._mergeOption(o,r))}if(!t||t==="recreate"||t==="media"){var l=a.getMediaOption(this);l.length&&ce(l,function(u){i=!0,this._mergeOption(u,r)},this)}return i},e.prototype.mergeOption=function(t){this._mergeOption(t,null)},e.prototype._mergeOption=function(t,r){var i=this.option,a=this._componentsMap,s=this._componentsCount,o=[],l=dn(),u=r&&r.replaceMergeMainTypeMap;PRe(this),ce(t,function(f,h){f!=null&&(Sr.hasClass(h)?h&&(o.push(h),l.set(h,!0)):i[h]=i[h]==null?wn(f):Dn(i[h],f,!0))}),u&&u.each(function(f,h){Sr.hasClass(h)&&!l.get(h)&&(o.push(h),l.set(h,!0))}),Sr.topologicalTravel(o,Sr.getAllClassMainTypes(),c,this);function c(f){var h=ORe(this,f,ci(t[f])),d=a.get(f),p=d?u&&u.get(f)?"replaceMerge":"normalMerge":"replaceAll",m=AAe(d,h,p);NAe(m,f,Sr),i[f]=null,a.set(f,null),s.set(f,0);var g=[],v=[],_=0,x;ce(m,function(b,S){var T=b.existing,M=b.newOption;if(!M)T&&(T.mergeOption({},this),T.optionUpdated({},!1));else{var C=f==="series",k=Sr.getClass(f,b.keyInfo.subType,!C);if(!k)return;if(f==="tooltip"){if(x)return;x=!0}if(T&&T.constructor===k)T.name=b.keyInfo.name,T.mergeOption(M,this),T.optionUpdated(M,!1);else{var R=gt({componentIndex:S},b.keyInfo);T=new k(M,this,this,R),gt(T,R),b.brandNew&&(T.__requireNewView=!0),T.init(M,this,this),T.optionUpdated(null,!0)}}T?(g.push(T.option),v.push(T),_++):(g.push(void 0),v.push(void 0))},this),i[f]=g,a.set(f,v),s.set(f,_),f==="series"&&Rb(this)}this._seriesIndices||Rb(this)},e.prototype.getOption=function(){var t=wn(this.option);return ce(t,function(r,i){if(Sr.hasClass(i)){for(var a=ci(r),s=a.length,o=!1,l=s-1;l>=0;l--)a[l]&&!B0(a[l])?o=!0:(a[l]=null,!o&&s--);a.length=s,t[i]=a}}),delete t[_z],t},e.prototype.getTheme=function(){return this._theme},e.prototype.getLocaleModel=function(){return this._locale},e.prototype.setUpdatePayload=function(t){this._payload=t},e.prototype.getUpdatePayload=function(){return this._payload},e.prototype.getComponent=function(t,r){var i=this._componentsMap.get(t);if(i){var a=i[r||0];if(a)return a;if(r==null){for(var s=0;s<i.length;s++)if(i[s])return i[s]}}},e.prototype.queryComponents=function(t){var r=t.mainType;if(!r)return[];var i=t.index,a=t.id,s=t.name,o=this._componentsMap.get(r);if(!o||!o.length)return[];var l;return i!=null?(l=[],ce(ci(i),function(u){o[u]&&l.push(o[u])})):a!=null?l=xz("id",a,o):s!=null?l=xz("name",s,o):l=si(o,function(u){return!!u}),bz(l,t)},e.prototype.findComponents=function(t){var r=t.query,i=t.mainType,a=o(r),s=a?this.queryComponents(a):si(this._componentsMap.get(i),function(u){return!!u});return l(bz(s,t));function o(u){var c=i+"Index",f=i+"Id",h=i+"Name";return u&&(u[c]!=null||u[f]!=null||u[h]!=null)?{mainType:i,index:u[c],id:u[f],name:u[h]}:null}function l(u){return t.filter?si(u,t.filter):u}},e.prototype.eachComponent=function(t,r,i){var a=this._componentsMap;if(pn(t)){var s=r,o=t;a.each(function(f,h){for(var d=0;f&&d<f.length;d++){var p=f[d];p&&o.call(s,h,p,p.componentIndex)}})}else for(var l=jt(t)?a.get(t):Yt(t)?this.findComponents(t):null,u=0;l&&u<l.length;u++){var c=l[u];c&&r.call(i,c,c.componentIndex)}},e.prototype.getSeriesByName=function(t){var r=Fl(t,null);return si(this._componentsMap.get("series"),function(i){return!!i&&r!=null&&i.name===r})},e.prototype.getSeriesByIndex=function(t){return this._componentsMap.get("series")[t]},e.prototype.getSeriesByType=function(t){return si(this._componentsMap.get("series"),function(r){return!!r&&r.subType===t})},e.prototype.getSeries=function(){return si(this._componentsMap.get("series"),function(t){return!!t})},e.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},e.prototype.eachSeries=function(t,r){jv(this),ce(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];t.call(r,a,i)},this)},e.prototype.eachRawSeries=function(t,r){ce(this._componentsMap.get("series"),function(i){i&&t.call(r,i,i.componentIndex)})},e.prototype.eachSeriesByType=function(t,r,i){jv(this),ce(this._seriesIndices,function(a){var s=this._componentsMap.get("series")[a];s.subType===t&&r.call(i,s,a)},this)},e.prototype.eachRawSeriesByType=function(t,r,i){return ce(this.getSeriesByType(t),r,i)},e.prototype.isSeriesFiltered=function(t){return jv(this),this._seriesIndicesMap.get(t.componentIndex)==null},e.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},e.prototype.filterSeries=function(t,r){jv(this);var i=[];ce(this._seriesIndices,function(a){var s=this._componentsMap.get("series")[a];t.call(r,s,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=dn(i)},e.prototype.restoreData=function(t){Rb(this);var r=this._componentsMap,i=[];r.each(function(a,s){Sr.hasClass(s)&&i.push(s)}),Sr.topologicalTravel(i,Sr.getAllClassMainTypes(),function(a){ce(r.get(a),function(s){s&&(a!=="series"||!zRe(s,t))&&s.restoreData()})})},e.internalField=function(){Rb=function(t){var r=t._seriesIndices=[];ce(t._componentsMap.get("series"),function(i){i&&r.push(i.componentIndex)}),t._seriesIndicesMap=dn(r)},jv=function(t){},yz=function(t,r){t.option={},t.option[_z]=URe,t._componentsMap=dn({series:[]}),t._componentsCount=dn();var i=r.aria;Yt(i)&&i.enabled==null&&(i.enabled=!0),VRe(r,t._theme.option),Dn(r,RRe,!1),t._mergeOption(r,null)}}(),e}(Fi);function zRe(n,e){if(e){var t=e.seriesIndex,r=e.seriesId,i=e.seriesName;return t!=null&&n.componentIndex!==t||r!=null&&n.id!==r||i!=null&&n.name!==i}}function VRe(n,e){var t=n.color&&!n.colorLayer;ce(e,function(r,i){i==="colorLayer"&&t||Sr.hasClass(i)||(typeof r=="object"?n[i]=n[i]?Dn(n[i],r,!1):wn(r):n[i]==null&&(n[i]=r))})}function xz(n,e,t){if(Rt(e)){var r=dn();return ce(e,function(a){if(a!=null){var s=Fl(a,null);s!=null&&r.set(a,!0)}}),si(t,function(a){return a&&r.get(a[n])})}else{var i=Fl(e,null);return si(t,function(a){return a&&i!=null&&a[n]===i})}}function bz(n,e){return e.hasOwnProperty("subType")?si(n,function(t){return t&&t.subType===e.subType}):n}function wz(n){var e=dn();return n&&ce(ci(n.replaceMerge),function(t){e.set(t,!0)}),{replaceMergeMainTypeMap:e}}ll($X,YI);const FX=$X;var HRe=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],WRe=function(){function n(e){ce(HRe,function(t){this[t]=Rr(e[t],e)},this)}return n}();const BX=WRe;var kE={},GRe=function(){function n(){this._coordinateSystems=[]}return n.prototype.create=function(e,t){var r=[];ce(kE,function(i,a){var s=i.create(e,t);r=r.concat(s||[])}),this._coordinateSystems=r},n.prototype.update=function(e,t){ce(this._coordinateSystems,function(r){r.update&&r.update(e,t)})},n.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},n.register=function(e,t){kE[e]=t},n.get=function(e){return kE[e]},n}();const ZI=GRe;var jRe=/^(min|max)?(.+)$/,qRe=function(){function n(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return n.prototype.setOption=function(e,t,r){e&&(ce(ci(e.series),function(s){s&&s.data&&Rs(s.data)&&Ew(s.data)}),ce(ci(e.dataset),function(s){s&&s.source&&Rs(s.source)&&Ew(s.source)})),e=wn(e);var i=this._optionBackup,a=XRe(e,t,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},n.prototype.mountOption=function(e){var t=this._optionBackup;return this._timelineOptions=t.timelineOptions,this._mediaList=t.mediaList,this._mediaDefault=t.mediaDefault,this._currentMediaIndices=[],wn(e?t.baseOption:this._newBaseOption)},n.prototype.getTimelineOption=function(e){var t,r=this._timelineOptions;if(r.length){var i=e.getComponent("timeline");i&&(t=wn(r[i.getCurrentIndex()]))}return t},n.prototype.getMediaOption=function(e){var t=this._api.getWidth(),r=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,s=[],o=[];if(!i.length&&!a)return o;for(var l=0,u=i.length;l<u;l++)KRe(i[l].query,t,r)&&s.push(l);return!s.length&&a&&(s=[-1]),s.length&&!ZRe(s,this._currentMediaIndices)&&(o=Nt(s,function(c){return wn(c===-1?a.option:i[c].option)})),this._currentMediaIndices=s,o},n}();function XRe(n,e,t){var r=[],i,a,s=n.baseOption,o=n.timeline,l=n.options,u=n.media,c=!!n.media,f=!!(l||o||s&&s.timeline);s?(a=s,a.timeline||(a.timeline=o)):((f||c)&&(n.options=n.media=null),a=n),c&&Rt(u)&&ce(u,function(d){d&&d.option&&(d.query?r.push(d):i||(i=d))}),h(a),ce(l,function(d){return h(d)}),ce(r,function(d){return h(d.option)});function h(d){ce(e,function(p){p(d,t)})}return{baseOption:a,timelineOptions:l||[],mediaDefault:i,mediaList:r}}function KRe(n,e,t){var r={width:e,height:t,aspectratio:e/t},i=!0;return ce(n,function(a,s){var o=s.match(jRe);if(!(!o||!o[1]||!o[2])){var l=o[1],u=o[2].toLowerCase();YRe(r[u],a,l)||(i=!1)}}),i}function YRe(n,e,t){return t==="min"?n>=e:t==="max"?n<=e:n===e}function ZRe(n,e){return n.join(",")===e.join(",")}const QRe=qRe;var Io=ce,j0=Yt,Sz=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function RE(n){var e=n&&n.itemStyle;if(e)for(var t=0,r=Sz.length;t<r;t++){var i=Sz[t],a=e.normal,s=e.emphasis;a&&a[i]&&(n[i]=n[i]||{},n[i].normal?Dn(n[i].normal,a[i]):n[i].normal=a[i],a[i]=null),s&&s[i]&&(n[i]=n[i]||{},n[i].emphasis?Dn(n[i].emphasis,s[i]):n[i].emphasis=s[i],s[i]=null)}}function sa(n,e,t){if(n&&n[e]&&(n[e].normal||n[e].emphasis)){var r=n[e].normal,i=n[e].emphasis;r&&(t?(n[e].normal=n[e].emphasis=null,ln(n[e],r)):n[e]=r),i&&(n.emphasis=n.emphasis||{},n.emphasis[e]=i,i.focus&&(n.emphasis.focus=i.focus),i.blurScope&&(n.emphasis.blurScope=i.blurScope))}}function wy(n){sa(n,"itemStyle"),sa(n,"lineStyle"),sa(n,"areaStyle"),sa(n,"label"),sa(n,"labelLine"),sa(n,"upperLabel"),sa(n,"edgeLabel")}function li(n,e){var t=j0(n)&&n[e],r=j0(t)&&t.textStyle;if(r)for(var i=0,a=TU.length;i<a;i++){var s=TU[i];r.hasOwnProperty(s)&&(t[s]=r[s])}}function js(n){n&&(wy(n),li(n,"label"),n.emphasis&&li(n.emphasis,"label"))}function JRe(n){if(j0(n)){RE(n),wy(n),li(n,"label"),li(n,"upperLabel"),li(n,"edgeLabel"),n.emphasis&&(li(n.emphasis,"label"),li(n.emphasis,"upperLabel"),li(n.emphasis,"edgeLabel"));var e=n.markPoint;e&&(RE(e),js(e));var t=n.markLine;t&&(RE(t),js(t));var r=n.markArea;r&&js(r);var i=n.data;if(n.type==="graph"){i=i||n.nodes;var a=n.links||n.edges;if(a&&!Rs(a))for(var s=0;s<a.length;s++)js(a[s]);ce(n.categories,function(u){wy(u)})}if(i&&!Rs(i))for(var s=0;s<i.length;s++)js(i[s]);if(e=n.markPoint,e&&e.data)for(var o=e.data,s=0;s<o.length;s++)js(o[s]);if(t=n.markLine,t&&t.data)for(var l=t.data,s=0;s<l.length;s++)Rt(l[s])?(js(l[s][0]),js(l[s][1])):js(l[s]);n.type==="gauge"?(li(n,"axisLabel"),li(n,"title"),li(n,"detail")):n.type==="treemap"?(sa(n.breadcrumb,"itemStyle"),ce(n.levels,function(u){wy(u)})):n.type==="tree"&&wy(n.leaves)}}function _u(n){return Rt(n)?n:n?[n]:[]}function Tz(n){return(Rt(n)?n[0]:n)||{}}function ePe(n,e){Io(_u(n.series),function(r){j0(r)&&JRe(r)});var t=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&t.push("valueAxis","categoryAxis","logAxis","timeAxis"),Io(t,function(r){Io(_u(n[r]),function(i){i&&(li(i,"axisLabel"),li(i.axisPointer,"label"))})}),Io(_u(n.parallel),function(r){var i=r&&r.parallelAxisDefault;li(i,"axisLabel"),li(i&&i.axisPointer,"label")}),Io(_u(n.calendar),function(r){sa(r,"itemStyle"),li(r,"dayLabel"),li(r,"monthLabel"),li(r,"yearLabel")}),Io(_u(n.radar),function(r){li(r,"name"),r.name&&r.axisName==null&&(r.axisName=r.name,delete r.name),r.nameGap!=null&&r.axisNameGap==null&&(r.axisNameGap=r.nameGap,delete r.nameGap)}),Io(_u(n.geo),function(r){j0(r)&&(js(r),Io(_u(r.regions),function(i){js(i)}))}),Io(_u(n.timeline),function(r){js(r),sa(r,"label"),sa(r,"itemStyle"),sa(r,"controlStyle",!0);var i=r.data;Rt(i)&&ce(i,function(a){Yt(a)&&(sa(a,"label"),sa(a,"itemStyle"))})}),Io(_u(n.toolbox),function(r){sa(r,"iconStyle"),Io(r.feature,function(i){sa(i,"iconStyle")})}),li(Tz(n.axisPointer),"label"),li(Tz(n.tooltip).axisPointer,"label")}function tPe(n,e){for(var t=e.split(","),r=n,i=0;i<t.length&&(r=r&&r[t[i]],r!=null);i++);return r}function nPe(n,e,t,r){for(var i=e.split(","),a=n,s,o=0;o<i.length-1;o++)s=i[o],a[s]==null&&(a[s]={}),a=a[s];(r||a[i[o]]==null)&&(a[i[o]]=t)}function Cz(n){n&&ce(rPe,function(e){e[0]in n&&!(e[1]in n)&&(n[e[1]]=n[e[0]])})}var rPe=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],iPe=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],PE=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function qv(n){var e=n&&n.itemStyle;if(e)for(var t=0;t<PE.length;t++){var r=PE[t][1],i=PE[t][0];e[r]!=null&&(e[i]=e[r])}}function Ez(n){n&&n.alignTo==="edge"&&n.margin!=null&&n.edgeDistance==null&&(n.edgeDistance=n.margin)}function Az(n){n&&n.downplay&&!n.blur&&(n.blur=n.downplay)}function aPe(n){n&&n.focusNodeAdjacency!=null&&(n.emphasis=n.emphasis||{},n.emphasis.focus==null&&(n.emphasis.focus="adjacency"))}function UX(n,e){if(n)for(var t=0;t<n.length;t++)e(n[t]),n[t]&&UX(n[t].children,e)}function zX(n,e){ePe(n,e),n.series=ci(n.series),ce(n.series,function(t){if(Yt(t)){var r=t.type;if(r==="line")t.clipOverflow!=null&&(t.clip=t.clipOverflow);else if(r==="pie"||r==="gauge"){t.clockWise!=null&&(t.clockwise=t.clockWise),Ez(t.label);var i=t.data;if(i&&!Rs(i))for(var a=0;a<i.length;a++)Ez(i[a]);t.hoverOffset!=null&&(t.emphasis=t.emphasis||{},(t.emphasis.scaleSize=null)&&(t.emphasis.scaleSize=t.hoverOffset))}else if(r==="gauge"){var s=tPe(t,"pointer.color");s!=null&&nPe(t,"itemStyle.color",s)}else if(r==="bar"){qv(t),qv(t.backgroundStyle),qv(t.emphasis);var i=t.data;if(i&&!Rs(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(qv(i[a]),qv(i[a]&&i[a].emphasis))}else if(r==="sunburst"){var o=t.highlightPolicy;o&&(t.emphasis=t.emphasis||{},t.emphasis.focus||(t.emphasis.focus=o)),Az(t),UX(t.data,Az)}else r==="graph"||r==="sankey"?aPe(t):r==="map"&&(t.mapType&&!t.map&&(t.map=t.mapType),t.mapLocation&&ln(t,t.mapLocation));t.hoverAnimation!=null&&(t.emphasis=t.emphasis||{},t.emphasis&&t.emphasis.scale==null&&(t.emphasis.scale=t.hoverAnimation)),Cz(t)}}),n.dataRange&&(n.visualMap=n.dataRange),ce(iPe,function(t){var r=n[t];r&&(Rt(r)||(r=[r]),ce(r,function(i){Cz(i)}))})}function sPe(n){var e=dn();n.eachSeries(function(t){var r=t.get("stack");if(r){var i=e.get(r)||e.set(r,[]),a=t.getData(),s={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:t};if(!s.stackedDimension||!(s.isStackedByIndex||s.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(s)}}),e.each(oPe)}function oPe(n){ce(n,function(e,t){var r=[],i=[NaN,NaN],a=[e.stackResultDimension,e.stackedOverDimension],s=e.data,o=e.isStackedByIndex,l=e.seriesModel.get("stackStrategy")||"samesign";s.modify(a,function(u,c,f){var h=s.get(e.stackedDimension,f);if(isNaN(h))return i;var d,p;o?p=s.getRawIndex(f):d=s.get(e.stackedByDimension,f);for(var m=NaN,g=t-1;g>=0;g--){var v=n[g];if(o||(p=v.data.rawIndexOf(v.stackedByDimension,d)),p>=0){var _=v.data.getByRawIndex(v.stackResultDimension,p);if(l==="all"||l==="positive"&&_>0||l==="negative"&&_<0||l==="samesign"&&h>=0&&_>0||l==="samesign"&&h<=0&&_<0){h=wAe(h,_),m=_;break}}}return r[0]=h,r[1]=m,r})})}var OT=function(){function n(e){this.data=e.data||(e.sourceFormat===tu?{}:[]),this.sourceFormat=e.sourceFormat||DX,this.seriesLayoutBy=e.seriesLayoutBy||Bl,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var t=this.dimensionsDefine=e.dimensionsDefine;if(t)for(var r=0;r<t.length;r++){var i=t[r];i.type==null&&NX(this,r)===Hi.Must&&(i.type="ordinal")}}return n}();function QI(n){return n instanceof OT}function yk(n,e,t){t=t||VX(n);var r=e.seriesLayoutBy,i=uPe(n,t,r,e.sourceHeader,e.dimensions),a=new OT({data:n,sourceFormat:t,seriesLayoutBy:r,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:wn(e)});return a}function JI(n){return new OT({data:n,sourceFormat:Rs(n)?af:wo})}function lPe(n){return new OT({data:n.data,sourceFormat:n.sourceFormat,seriesLayoutBy:n.seriesLayoutBy,dimensionsDefine:wn(n.dimensionsDefine),startIndex:n.startIndex,dimensionsDetectedCount:n.dimensionsDetectedCount})}function VX(n){var e=DX;if(Rs(n))e=af;else if(Rt(n)){n.length===0&&(e=Ba);for(var t=0,r=n.length;t<r;t++){var i=n[t];if(i!=null){if(Rt(i)){e=Ba;break}else if(Yt(i)){e=So;break}}}}else if(Yt(n)){for(var a in n)if(ju(n,a)&&Fa(n[a])){e=tu;break}}return e}function uPe(n,e,t,r,i){var a,s;if(!n)return{dimensionsDefine:Mz(i),startIndex:s,dimensionsDetectedCount:a};if(e===Ba){var o=n;r==="auto"||r==null?kz(function(u){u!=null&&u!=="-"&&(jt(u)?s==null&&(s=1):s=0)},t,o,10):s=gr(r)?r:r?1:0,!i&&s===1&&(i=[],kz(function(u,c){i[c]=u!=null?u+"":""},t,o,1/0)),a=i?i.length:t===qg?o.length:o[0]?o[0].length:null}else if(e===So)i||(i=cPe(n));else if(e===tu)i||(i=[],ce(n,function(u,c){i.push(c)}));else if(e===wo){var l=k_(n[0]);a=Rt(l)&&l.length||1}return{startIndex:s,dimensionsDefine:Mz(i),dimensionsDetectedCount:a}}function cPe(n){for(var e=0,t;e<n.length&&!(t=n[e++]););if(t)return Wr(t)}function Mz(n){if(n){var e=dn();return Nt(n,function(t,r){t=Yt(t)?t:{name:t};var i={name:t.name,displayName:t.displayName,type:t.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=e.get(i.name);return a?i.name+="-"+a.count++:e.set(i.name,{count:1}),i})}}function kz(n,e,t,r){if(e===qg)for(var i=0;i<t.length&&i<r;i++)n(t[i]?t[i][0]:null,i);else for(var a=t[0]||[],i=0;i<a.length&&i<r;i++)n(a[i],i)}function HX(n){var e=n.sourceFormat;return e===So||e===tu}var mh,gh,vh,Rz,Pz,WX=function(){function n(e,t){var r=QI(e)?e:JI(e);this._source=r;var i=this._data=r.data;r.sourceFormat===af&&(this._offset=0,this._dimSize=t,this._data=i),Pz(this,i,r)}return n.prototype.getSource=function(){return this._source},n.prototype.count=function(){return 0},n.prototype.getItem=function(e,t){},n.prototype.appendData=function(e){},n.prototype.clean=function(){},n.protoInitialize=function(){var e=n.prototype;e.pure=!1,e.persistent=!0}(),n.internalField=function(){var e;Pz=function(s,o,l){var u=l.sourceFormat,c=l.seriesLayoutBy,f=l.startIndex,h=l.dimensionsDefine,d=Rz[eD(u,c)];if(gt(s,d),u===af)s.getItem=t,s.count=i,s.fillStorage=r;else{var p=GX(u,c);s.getItem=Rr(p,null,o,f,h);var m=jX(u,c);s.count=Rr(m,null,o,f,h)}};var t=function(s,o){s=s-this._offset,o=o||[];for(var l=this._data,u=this._dimSize,c=u*s,f=0;f<u;f++)o[f]=l[c+f];return o},r=function(s,o,l,u){for(var c=this._data,f=this._dimSize,h=0;h<f;h++){for(var d=u[h],p=d[0]==null?1/0:d[0],m=d[1]==null?-1/0:d[1],g=o-s,v=l[h],_=0;_<g;_++){var x=c[_*f+h];v[s+_]=x,x<p&&(p=x),x>m&&(m=x)}d[0]=p,d[1]=m}},i=function(){return this._data?this._data.length/this._dimSize:0};Rz=(e={},e[Ba+"_"+Bl]={pure:!0,appendData:a},e[Ba+"_"+qg]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e[So]={pure:!0,appendData:a},e[tu]={pure:!0,appendData:function(s){var o=this._data;ce(s,function(l,u){for(var c=o[u]||(o[u]=[]),f=0;f<(l||[]).length;f++)c.push(l[f])})}},e[wo]={appendData:a},e[af]={persistent:!1,pure:!0,appendData:function(s){this._data=s},clean:function(){this._offset+=this.count(),this._data=null}},e);function a(s){for(var o=0;o<s.length;o++)this._data.push(s[o])}}(),n}(),Iz=function(n,e,t,r){return n[r]},fPe=(mh={},mh[Ba+"_"+Bl]=function(n,e,t,r){return n[r+e]},mh[Ba+"_"+qg]=function(n,e,t,r,i){r+=e;for(var a=i||[],s=n,o=0;o<s.length;o++){var l=s[o];a[o]=l?l[r]:null}return a},mh[So]=Iz,mh[tu]=function(n,e,t,r,i){for(var a=i||[],s=0;s<t.length;s++){var o=t[s].name,l=n[o];a[s]=l?l[r]:null}return a},mh[wo]=Iz,mh);function GX(n,e){var t=fPe[eD(n,e)];return t}var Dz=function(n,e,t){return n.length},hPe=(gh={},gh[Ba+"_"+Bl]=function(n,e,t){return Math.max(0,n.length-e)},gh[Ba+"_"+qg]=function(n,e,t){var r=n[0];return r?Math.max(0,r.length-e):0},gh[So]=Dz,gh[tu]=function(n,e,t){var r=t[0].name,i=n[r];return i?i.length:0},gh[wo]=Dz,gh);function jX(n,e){var t=hPe[eD(n,e)];return t}var IE=function(n,e,t){return n[e]},dPe=(vh={},vh[Ba]=IE,vh[So]=function(n,e,t){return n[t]},vh[tu]=IE,vh[wo]=function(n,e,t){var r=k_(n);return r instanceof Array?r[e]:r},vh[af]=IE,vh);function qX(n){var e=dPe[n];return e}function eD(n,e){return n===Ba?n+"_"+e:n}function fg(n,e,t){if(n){var r=n.getRawDataItem(e);if(r!=null){var i=n.getStore(),a=i.getSource().sourceFormat;if(t!=null){var s=n.getDimensionIndex(t),o=i.getDimensionProperty(s);return qX(a)(r,s,o)}else{var l=r;return a===wo&&(l=k_(r)),l}}}}var pPe=/\{@(.+?)\}/g,mPe=function(){function n(){}return n.prototype.getDataParams=function(e,t){var r=this.getData(t),i=this.getRawValue(e,t),a=r.getRawIndex(e),s=r.getName(e),o=r.getRawDataItem(e),l=r.getItemVisual(e,"style"),u=l&&l[r.getItemVisual(e,"drawType")||"fill"],c=l&&l.stroke,f=this.mainType,h=f==="series",d=r.userOutput&&r.userOutput.get();return{componentType:f,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:s,dataIndex:a,data:o,dataType:t,value:i,color:u,borderColor:c,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},n.prototype.getFormattedLabel=function(e,t,r,i,a,s){t=t||"normal";var o=this.getData(r),l=this.getDataParams(e,r);if(s&&(l.value=s.interpolatedValue),i!=null&&Rt(l.value)&&(l.value=l.value[i]),!a){var u=o.getItemModel(e);a=u.get(t==="normal"?["label","formatter"]:[t,"label","formatter"])}if(pn(a))return l.status=t,l.dimensionIndex=i,a(l);if(jt(a)){var c=RX(a,l);return c.replace(pPe,function(f,h){var d=h.length,p=h;p.charAt(0)==="["&&p.charAt(d-1)==="]"&&(p=+p.slice(1,d-1));var m=fg(o,e,p);if(s&&Rt(s.interpolatedValue)){var g=o.getDimensionIndex(p);g>=0&&(m=s.interpolatedValue[g])}return m!=null?m+"":""})}},n.prototype.getRawValue=function(e,t){return fg(this.getData(t),e)},n.prototype.formatTooltip=function(e,t,r){},n}();function Lz(n){var e,t;return Yt(n)?n.type&&(t=n):e=n,{text:e,frag:t}}function t0(n){return new gPe(n)}var gPe=function(){function n(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return n.prototype.perform=function(e){var t=this._upstream,r=e&&e.skip;if(this._dirty&&t){var i=this.context;i.data=i.outputData=t.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!r&&(a=this._plan(this.context));var s=c(this._modBy),o=this._modDataCount||0,l=c(e&&e.modBy),u=e&&e.modDataCount||0;(s!==l||o!==u)&&(a="reset");function c(_){return!(_>=1)&&(_=1),_}var f;(this._dirty||a==="reset")&&(this._dirty=!1,f=this._doReset(r)),this._modBy=l,this._modDataCount=u;var h=e&&e.step;if(t?this._dueEnd=t._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,p=Math.min(h!=null?this._dueIndex+h:1/0,this._dueEnd);if(!r&&(f||d<p)){var m=this._progress;if(Rt(m))for(var g=0;g<m.length;g++)this._doProgress(m[g],d,p,l,u);else this._doProgress(m,d,p,l,u)}this._dueIndex=p;var v=this._settedOutputEnd!=null?this._settedOutputEnd:p;this._outputDueEnd=v}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},n.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},n.prototype._doProgress=function(e,t,r,i,a){Nz.reset(t,r,i,a),this._callingProgress=e,this._callingProgress({start:t,end:r,count:r-t,next:Nz.next},this.context)},n.prototype._doReset=function(e){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var t,r;!e&&this._reset&&(t=this._reset(this.context),t&&t.progress&&(r=t.forceFirstProgress,t=t.progress),Rt(t)&&!t.length&&(t=null)),this._progress=t,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),r},n.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},n.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},n.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},n.prototype.getUpstream=function(){return this._upstream},n.prototype.getDownstream=function(){return this._downstream},n.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},n}(),Nz=function(){var n,e,t,r,i,a={reset:function(l,u,c,f){e=l,n=u,t=c,r=f,i=Math.ceil(r/t),a.next=t>1&&r>0?o:s}};return a;function s(){return e<n?e++:null}function o(){var l=e%i*t+Math.ceil(e/i),u=e>=n?null:l<r?l:e;return e++,u}}();function ew(n,e){var t=e&&e.type;return t==="ordinal"?n:(t==="time"&&!gr(n)&&n!=null&&n!=="-"&&(n=+qu(n)),n==null||n===""?NaN:+n)}var vPe=dn({number:function(n){return parseFloat(n)},time:function(n){return+qu(n)},trim:function(n){return jt(n)?Dl(n):n}});function XX(n){return vPe.get(n)}var KX={lt:function(n,e){return n<e},lte:function(n,e){return n<=e},gt:function(n,e){return n>e},gte:function(n,e){return n>=e}},yPe=function(){function n(e,t){if(!gr(t)){var r="";Qn(r)}this._opFn=KX[e],this._rvalFloat=gf(t)}return n.prototype.evaluate=function(e){return gr(e)?this._opFn(e,this._rvalFloat):this._opFn(gf(e),this._rvalFloat)},n}(),YX=function(){function n(e,t){var r=e==="desc";this._resultLT=r?1:-1,t==null&&(t=r?"min":"max"),this._incomparable=t==="min"?-1/0:1/0}return n.prototype.evaluate=function(e,t){var r=gr(e)?e:gf(e),i=gr(t)?t:gf(t),a=isNaN(r),s=isNaN(i);if(a&&(r=this._incomparable),s&&(i=this._incomparable),a&&s){var o=jt(e),l=jt(t);o&&(r=l?e:0),l&&(i=o?t:0)}return r<i?this._resultLT:r>i?-this._resultLT:0},n}(),_Pe=function(){function n(e,t){this._rval=t,this._isEQ=e,this._rvalTypeof=typeof t,this._rvalFloat=gf(t)}return n.prototype.evaluate=function(e){var t=e===this._rval;if(!t){var r=typeof e;r!==this._rvalTypeof&&(r==="number"||this._rvalTypeof==="number")&&(t=gf(e)===this._rvalFloat)}return this._isEQ?t:!t},n}();function xPe(n,e){return n==="eq"||n==="ne"?new _Pe(n==="eq",e):ju(KX,n)?new yPe(n,e):null}var bPe=function(){function n(){}return n.prototype.getRawData=function(){throw new Error("not supported")},n.prototype.getRawDataItem=function(e){throw new Error("not supported")},n.prototype.cloneRawData=function(){},n.prototype.getDimensionInfo=function(e){},n.prototype.cloneAllDimensionInfo=function(){},n.prototype.count=function(){},n.prototype.retrieveValue=function(e,t){},n.prototype.retrieveValueFromItem=function(e,t){},n.prototype.convertValue=function(e,t){return ew(e,t)},n}();function wPe(n,e){var t=new bPe,r=n.data,i=t.sourceFormat=n.sourceFormat,a=n.startIndex,s="";n.seriesLayoutBy!==Bl&&Qn(s);var o=[],l={},u=n.dimensionsDefine;if(u)ce(u,function(m,g){var v=m.name,_={index:g,name:v,displayName:m.displayName};if(o.push(_),v!=null){var x="";ju(l,v)&&Qn(x),l[v]=_}});else for(var c=0;c<n.dimensionsDetectedCount;c++)o.push({index:c});var f=GX(i,Bl);e.__isBuiltIn&&(t.getRawDataItem=function(m){return f(r,a,o,m)},t.getRawData=Rr(SPe,null,n)),t.cloneRawData=Rr(TPe,null,n);var h=jX(i,Bl);t.count=Rr(h,null,r,a,o);var d=qX(i);t.retrieveValue=function(m,g){var v=f(r,a,o,m);return p(v,g)};var p=t.retrieveValueFromItem=function(m,g){if(m!=null){var v=o[g];if(v)return d(m,g,v.name)}};return t.getDimensionInfo=Rr(CPe,null,o,l),t.cloneAllDimensionInfo=Rr(EPe,null,o),t}function SPe(n){var e=n.sourceFormat;if(!tD(e)){var t="";Qn(t)}return n.data}function TPe(n){var e=n.sourceFormat,t=n.data;if(!tD(e)){var r="";Qn(r)}if(e===Ba){for(var i=[],a=0,s=t.length;a<s;a++)i.push(t[a].slice());return i}else if(e===So){for(var i=[],a=0,s=t.length;a<s;a++)i.push(gt({},t[a]));return i}}function CPe(n,e,t){if(t!=null){if(gr(t)||!isNaN(t)&&!ju(e,t))return n[t];if(ju(e,t))return e[t]}}function EPe(n){return wn(n)}var ZX=dn();function APe(n){n=wn(n);var e=n.type,t="";e||Qn(t);var r=e.split(":");r.length!==2&&Qn(t);var i=!1;r[0]==="echarts"&&(e=r[1],i=!0),n.__isBuiltIn=i,ZX.set(e,n)}function MPe(n,e,t){var r=ci(n),i=r.length,a="";i||Qn(a);for(var s=0,o=i;s<o;s++){var l=r[s];e=kPe(l,e),s!==o-1&&(e.length=Math.max(e.length,1))}return e}function kPe(n,e,t,r){var i="";e.length||Qn(i),Yt(n)||Qn(i);var a=n.type,s=ZX.get(a);s||Qn(i);var o=Nt(e,function(u){return wPe(u,s)}),l=ci(s.transform({upstream:o[0],upstreamList:o,config:wn(n.config)}));return Nt(l,function(u,c){var f="";Yt(u)||Qn(f),u.data||Qn(f);var h=VX(u.data);tD(h)||Qn(f);var d,p=e[0];if(p&&c===0&&!u.dimensions){var m=p.startIndex;m&&(u.data=p.data.slice(0,m).concat(u.data)),d={seriesLayoutBy:Bl,sourceHeader:m,dimensions:p.metaRawOption.dimensions}}else d={seriesLayoutBy:Bl,sourceHeader:0,dimensions:u.dimensions};return yk(u.data,d,null)})}function tD(n){return n===Ba||n===So}var $T="undefined",RPe=typeof Uint32Array===$T?Array:Uint32Array,PPe=typeof Uint16Array===$T?Array:Uint16Array,QX=typeof Int32Array===$T?Array:Int32Array,Oz=typeof Float64Array===$T?Array:Float64Array,JX={float:Oz,int:QX,ordinal:Array,number:Array,time:Oz},DE;function Xv(n){return n>65535?RPe:PPe}function Bp(){return[1/0,-1/0]}function IPe(n){var e=n.constructor;return e===Array?n.slice():new e(n)}function $z(n,e,t,r,i){var a=JX[t||"float"];if(i){var s=n[e],o=s&&s.length;if(o!==r){for(var l=new a(r),u=0;u<o;u++)l[u]=s[u];n[e]=l}}else n[e]=new a(r)}var _k=function(){function n(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=dn()}return n.prototype.initData=function(e,t,r){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=e.getSource(),a=this.defaultDimValueGetter=DE[i.sourceFormat];this._dimValueGetter=r||a,this._rawExtent=[],HX(i),this._dimensions=Nt(t,function(s){return{type:s.type,property:s.property}}),this._initDataFromProvider(0,e.count())},n.prototype.getProvider=function(){return this._provider},n.prototype.getSource=function(){return this._provider.getSource()},n.prototype.ensureCalculationDimension=function(e,t){var r=this._calcDimNameToIdx,i=this._dimensions,a=r.get(e);if(a!=null){if(i[a].type===t)return a}else a=i.length;return i[a]={type:t},r.set(e,a),this._chunks[a]=new JX[t||"float"](this._rawCount),this._rawExtent[a]=Bp(),a},n.prototype.collectOrdinalMeta=function(e,t){var r=this._chunks[e],i=this._dimensions[e],a=this._rawExtent,s=i.ordinalOffset||0,o=r.length;s===0&&(a[e]=Bp());for(var l=a[e],u=s;u<o;u++){var c=r[u]=t.parseAndCollect(r[u]);isNaN(c)||(l[0]=Math.min(c,l[0]),l[1]=Math.max(c,l[1]))}i.ordinalMeta=t,i.ordinalOffset=o,i.type="ordinal"},n.prototype.getOrdinalMeta=function(e){var t=this._dimensions[e],r=t.ordinalMeta;return r},n.prototype.getDimensionProperty=function(e){var t=this._dimensions[e];return t&&t.property},n.prototype.appendData=function(e){var t=this._provider,r=this.count();t.appendData(e);var i=t.count();return t.persistent||(i+=r),r<i&&this._initDataFromProvider(r,i,!0),[r,i]},n.prototype.appendValues=function(e,t){for(var r=this._chunks,i=this._dimensions,a=i.length,s=this._rawExtent,o=this.count(),l=o+Math.max(e.length,t||0),u=0;u<a;u++){var c=i[u];$z(r,u,c.type,l,!0)}for(var f=[],h=o;h<l;h++)for(var d=h-o,p=0;p<a;p++){var c=i[p],m=DE.arrayRows.call(this,e[d]||f,c.property,d,p);r[p][h]=m;var g=s[p];m<g[0]&&(g[0]=m),m>g[1]&&(g[1]=m)}return this._rawCount=this._count=l,{start:o,end:l}},n.prototype._initDataFromProvider=function(e,t,r){for(var i=this._provider,a=this._chunks,s=this._dimensions,o=s.length,l=this._rawExtent,u=Nt(s,function(_){return _.property}),c=0;c<o;c++){var f=s[c];l[c]||(l[c]=Bp()),$z(a,c,f.type,t,r)}if(i.fillStorage)i.fillStorage(e,t,a,l);else for(var h=[],d=e;d<t;d++){h=i.getItem(d,h);for(var p=0;p<o;p++){var m=a[p],g=this._dimValueGetter(h,u[p],d,p);m[d]=g;var v=l[p];g<v[0]&&(v[0]=g),g>v[1]&&(v[1]=g)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=t,this._extent=[]},n.prototype.count=function(){return this._count},n.prototype.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var r=this._chunks[e];return r?r[this.getRawIndex(t)]:NaN},n.prototype.getValues=function(e,t){var r=[],i=[];if(t==null){t=e,e=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=e;for(var a=0,s=i.length;a<s;a++)r.push(this.get(i[a],t));return r},n.prototype.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var r=this._chunks[e];return r?r[t]:NaN},n.prototype.getSum=function(e){var t=this._chunks[e],r=0;if(t)for(var i=0,a=this.count();i<a;i++){var s=this.get(e,i);isNaN(s)||(r+=s)}return r},n.prototype.getMedian=function(e){var t=[];this.each([e],function(a){isNaN(a)||t.push(a)});var r=t.sort(function(a,s){return a-s}),i=this.count();return i===0?0:i%2===1?r[(i-1)/2]:(r[i/2]+r[i/2-1])/2},n.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,r=t[e];if(r!=null&&r<this._count&&r===e)return e;for(var i=0,a=this._count-1;i<=a;){var s=(i+a)/2|0;if(t[s]<e)i=s+1;else if(t[s]>e)a=s-1;else return s}return-1},n.prototype.indicesOfNearest=function(e,t,r){var i=this._chunks,a=i[e],s=[];if(!a)return s;r==null&&(r=1/0);for(var o=1/0,l=-1,u=0,c=0,f=this.count();c<f;c++){var h=this.getRawIndex(c),d=t-a[h],p=Math.abs(d);p<=r&&((p<o||p===o&&d>=0&&l<0)&&(o=p,l=d,u=0),d===l&&(s[u++]=c))}return s.length=u,s},n.prototype.getIndices=function(){var e,t=this._indices;if(t){var r=t.constructor,i=this._count;if(r===Array){e=new r(i);for(var a=0;a<i;a++)e[a]=t[a]}else e=new r(t.buffer,0,i)}else{var r=Xv(this._rawCount);e=new r(this.count());for(var a=0;a<e.length;a++)e[a]=a}return e},n.prototype.filter=function(e,t){if(!this._count)return this;for(var r=this.clone(),i=r.count(),a=Xv(r._rawCount),s=new a(i),o=[],l=e.length,u=0,c=e[0],f=r._chunks,h=0;h<i;h++){var d=void 0,p=r.getRawIndex(h);if(l===0)d=t(h);else if(l===1){var m=f[c][p];d=t(m,h)}else{for(var g=0;g<l;g++)o[g]=f[e[g]][p];o[g]=h,d=t.apply(null,o)}d&&(s[u++]=p)}return u<i&&(r._indices=s),r._count=u,r._extent=[],r._updateGetRawIdx(),r},n.prototype.selectRange=function(e){var t=this.clone(),r=t._count;if(!r)return this;var i=Wr(e),a=i.length;if(!a)return this;var s=t.count(),o=Xv(t._rawCount),l=new o(s),u=0,c=i[0],f=e[c][0],h=e[c][1],d=t._chunks,p=!1;if(!t._indices){var m=0;if(a===1){for(var g=d[i[0]],v=0;v<r;v++){var _=g[v];(_>=f&&_<=h||isNaN(_))&&(l[u++]=m),m++}p=!0}else if(a===2){for(var g=d[i[0]],x=d[i[1]],b=e[i[1]][0],S=e[i[1]][1],v=0;v<r;v++){var _=g[v],T=x[v];(_>=f&&_<=h||isNaN(_))&&(T>=b&&T<=S||isNaN(T))&&(l[u++]=m),m++}p=!0}}if(!p)if(a===1)for(var v=0;v<s;v++){var M=t.getRawIndex(v),_=d[i[0]][M];(_>=f&&_<=h||isNaN(_))&&(l[u++]=M)}else for(var v=0;v<s;v++){for(var C=!0,M=t.getRawIndex(v),k=0;k<a;k++){var R=i[k],_=d[R][M];(_<e[R][0]||_>e[R][1])&&(C=!1)}C&&(l[u++]=t.getRawIndex(v))}return u<s&&(t._indices=l),t._count=u,t._extent=[],t._updateGetRawIdx(),t},n.prototype.map=function(e,t){var r=this.clone(e);return this._updateDims(r,e,t),r},n.prototype.modify=function(e,t){this._updateDims(this,e,t)},n.prototype._updateDims=function(e,t,r){for(var i=e._chunks,a=[],s=t.length,o=e.count(),l=[],u=e._rawExtent,c=0;c<t.length;c++)u[t[c]]=Bp();for(var f=0;f<o;f++){for(var h=e.getRawIndex(f),d=0;d<s;d++)l[d]=i[t[d]][h];l[s]=f;var p=r&&r.apply(null,l);if(p!=null){typeof p!="object"&&(a[0]=p,p=a);for(var c=0;c<p.length;c++){var m=t[c],g=p[c],v=u[m],_=i[m];_&&(_[h]=g),g<v[0]&&(v[0]=g),g>v[1]&&(v[1]=g)}}}},n.prototype.lttbDownSample=function(e,t){var r=this.clone([e],!0),i=r._chunks,a=i[e],s=this.count(),o=0,l=Math.floor(1/t),u=this.getRawIndex(0),c,f,h,d=new(Xv(this._rawCount))(Math.min((Math.ceil(s/l)+2)*2,s));d[o++]=u;for(var p=1;p<s-1;p+=l){for(var m=Math.min(p+l,s-1),g=Math.min(p+l*2,s),v=(g+m)/2,_=0,x=m;x<g;x++){var b=this.getRawIndex(x),S=a[b];isNaN(S)||(_+=S)}_/=g-m;var T=p,M=Math.min(p+l,s),C=p-1,k=a[u];c=-1,h=T;for(var R=-1,P=0,x=T;x<M;x++){var b=this.getRawIndex(x),S=a[b];if(isNaN(S)){P++,R<0&&(R=b);continue}f=Math.abs((C-v)*(S-k)-(C-x)*(_-k)),f>c&&(c=f,h=b)}P>0&&P<M-T&&(d[o++]=Math.min(R,h),h=Math.max(R,h)),d[o++]=h,u=h}return d[o++]=this.getRawIndex(s-1),r._count=o,r._indices=d,r.getRawIndex=this._getRawIdx,r},n.prototype.downSample=function(e,t,r,i){for(var a=this.clone([e],!0),s=a._chunks,o=[],l=Math.floor(1/t),u=s[e],c=this.count(),f=a._rawExtent[e]=Bp(),h=new(Xv(this._rawCount))(Math.ceil(c/l)),d=0,p=0;p<c;p+=l){l>c-p&&(l=c-p,o.length=l);for(var m=0;m<l;m++){var g=this.getRawIndex(p+m);o[m]=u[g]}var v=r(o),_=this.getRawIndex(Math.min(p+i(o,v)||0,c-1));u[_]=v,v<f[0]&&(f[0]=v),v>f[1]&&(f[1]=v),h[d++]=_}return a._count=d,a._indices=h,a._updateGetRawIdx(),a},n.prototype.each=function(e,t){if(this._count)for(var r=e.length,i=this._chunks,a=0,s=this.count();a<s;a++){var o=this.getRawIndex(a);switch(r){case 0:t(a);break;case 1:t(i[e[0]][o],a);break;case 2:t(i[e[0]][o],i[e[1]][o],a);break;default:for(var l=0,u=[];l<r;l++)u[l]=i[e[l]][o];u[l]=a,t.apply(null,u)}}},n.prototype.getDataExtent=function(e){var t=this._chunks[e],r=Bp();if(!t)return r;var i=this.count(),a=!this._indices,s;if(a)return this._rawExtent[e].slice();if(s=this._extent[e],s)return s.slice();s=r;for(var o=s[0],l=s[1],u=0;u<i;u++){var c=this.getRawIndex(u),f=t[c];f<o&&(o=f),f>l&&(l=f)}return s=[o,l],this._extent[e]=s,s},n.prototype.getRawDataItem=function(e){var t=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(t);for(var r=[],i=this._chunks,a=0;a<i.length;a++)r.push(i[a][t]);return r},n.prototype.clone=function(e,t){var r=new n,i=this._chunks,a=e&&df(e,function(o,l){return o[l]=!0,o},{});if(a)for(var s=0;s<i.length;s++)r._chunks[s]=a[s]?IPe(i[s]):i[s];else r._chunks=i;return this._copyCommonProps(r),t||(r._indices=this._cloneIndices()),r._updateGetRawIdx(),r},n.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=wn(this._extent),e._rawExtent=wn(this._rawExtent)},n.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,t=void 0;if(e===Array){var r=this._indices.length;t=new e(r);for(var i=0;i<r;i++)t[i]=this._indices[i]}else t=new e(this._indices);return t}return null},n.prototype._getRawIdxIdentity=function(e){return e},n.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},n.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},n.internalField=function(){function e(t,r,i,a){return ew(t[a],this._dimensions[a])}DE={arrayRows:e,objectRows:function(t,r,i,a){return ew(t[r],this._dimensions[a])},keyedColumns:e,original:function(t,r,i,a){var s=t&&(t.value==null?t:t.value);return ew(s instanceof Array?s[a]:s,this._dimensions[a])},typedArray:function(t,r,i,a){return t[a]}}}(),n}(),eK=function(){function n(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return n.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},n.prototype._setLocalSource=function(e,t){this._sourceList=e,this._upstreamSignList=t,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},n.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},n.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},n.prototype._createSource=function(){this._setLocalSource([],[]);var e=this._sourceHost,t=this._getUpstreamSourceManagers(),r=!!t.length,i,a;if(Pb(e)){var s=e,o=void 0,l=void 0,u=void 0;if(r){var c=t[0];c.prepareSource(),u=c.getSource(),o=u.data,l=u.sourceFormat,a=[c._getVersionSign()]}else o=s.get("data",!0),l=Rs(o)?af:wo,a=[];var f=this._getSourceMetaRawOption()||{},h=u&&u.metaRawOption||{},d=Hn(f.seriesLayoutBy,h.seriesLayoutBy)||null,p=Hn(f.sourceHeader,h.sourceHeader),m=Hn(f.dimensions,h.dimensions),g=d!==h.seriesLayoutBy||!!p!=!!h.sourceHeader||m;i=g?[yk(o,{seriesLayoutBy:d,sourceHeader:p,dimensions:m},l)]:[]}else{var v=e;if(r){var _=this._applyTransform(t);i=_.sourceList,a=_.upstreamSignList}else{var x=v.get("source",!0);i=[yk(x,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},n.prototype._applyTransform=function(e){var t=this._sourceHost,r=t.get("transform",!0),i=t.get("fromTransformResult",!0);if(i!=null){var a="";e.length!==1&&Bz(a)}var s,o=[],l=[];return ce(e,function(u){u.prepareSource();var c=u.getSource(i||0),f="";i!=null&&!c&&Bz(f),o.push(c),l.push(u._getVersionSign())}),r?s=MPe(r,o,{datasetIndex:t.componentIndex}):i!=null&&(s=[lPe(o[0])]),{sourceList:s,upstreamSignList:l}},n.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),t=0;t<e.length;t++){var r=e[t];if(r._isDirty()||this._upstreamSignList[t]!==r._getVersionSign())return!0}},n.prototype.getSource=function(e){e=e||0;var t=this._sourceList[e];if(!t){var r=this._getUpstreamSourceManagers();return r[0]&&r[0].getSource(e)}return t},n.prototype.getSharedDataStore=function(e){var t=e.makeStoreSchema();return this._innerGetDataStore(t.dimensions,e.source,t.hash)},n.prototype._innerGetDataStore=function(e,t,r){var i=0,a=this._storeList,s=a[i];s||(s=a[i]={});var o=s[r];if(!o){var l=this._getUpstreamSourceManagers()[0];Pb(this._sourceHost)&&l?o=l._innerGetDataStore(e,t,r):(o=new _k,o.initData(new WX(t,e.length),e)),s[r]=o}return o},n.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if(Pb(e)){var t=KI(e);return t?[t.getSourceManager()]:[]}else return Nt(LRe(e),function(r){return r.getSourceManager()})},n.prototype._getSourceMetaRawOption=function(){var e=this._sourceHost,t,r,i;if(Pb(e))t=e.get("seriesLayoutBy",!0),r=e.get("sourceHeader",!0),i=e.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=e;t=a.get("seriesLayoutBy",!0),r=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:t,sourceHeader:r,dimensions:i}},n}();function Fz(n){var e=n.option.transform;e&&Ew(n.option.transform)}function Pb(n){return n.mainType==="series"}function Bz(n){throw new Error(n)}var tK="line-height:1";function nK(n,e){var t=n.color||"#6e7079",r=n.fontSize||12,i=n.fontWeight||"400",a=n.color||"#464646",s=n.fontSize||14,o=n.fontWeight||"900";return e==="html"?{nameStyle:"font-size:"+Zs(r+"")+"px;color:"+Zs(t)+";font-weight:"+Zs(i+""),valueStyle:"font-size:"+Zs(s+"")+"px;color:"+Zs(a)+";font-weight:"+Zs(o+"")}:{nameStyle:{fontSize:r,fill:t,fontWeight:i},valueStyle:{fontSize:s,fill:a,fontWeight:o}}}var DPe=[0,10,20,30],LPe=["",`
`,`

`,`


`];function q0(n,e){return e.type=n,e}function xk(n){return n.type==="section"}function rK(n){return xk(n)?NPe:OPe}function iK(n){if(xk(n)){var e=0,t=n.blocks.length,r=t>1||t>0&&!n.noHeader;return ce(n.blocks,function(i){var a=iK(i);a>=e&&(e=a+ +(r&&(!a||xk(i)&&!i.noHeader)))}),e}return 0}function NPe(n,e,t,r){var i=e.noHeader,a=$Pe(iK(e)),s=[],o=e.blocks||[];ql(!o||Rt(o)),o=o||[];var l=n.orderMode;if(e.sortBlocks&&l){o=o.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(ju(u,l)){var c=new YX(u[l],null);o.sort(function(p,m){return c.evaluate(p.sortParam,m.sortParam)})}else l==="seriesDesc"&&o.reverse()}ce(o,function(p,m){var g=e.valueFormatter,v=rK(p)(g?gt(gt({},n),{valueFormatter:g}):n,p,m>0?a.html:0,r);v!=null&&s.push(v)});var f=n.renderMode==="richText"?s.join(a.richText):bk(s.join(""),i?t:a.html);if(i)return f;var h=gk(e.header,"ordinal",n.useUTC),d=nK(r,n.renderMode).nameStyle;return n.renderMode==="richText"?aK(n,h,d)+a.richText+f:bk('<div style="'+d+";"+tK+';">'+Zs(h)+"</div>"+f,t)}function OPe(n,e,t,r){var i=n.renderMode,a=e.noName,s=e.noValue,o=!e.markerType,l=e.name,u=n.useUTC,c=e.valueFormatter||n.valueFormatter||function(b){return b=Rt(b)?b:[b],Nt(b,function(S,T){return gk(S,Rt(d)?d[T]:d,u)})};if(!(a&&s)){var f=o?"":n.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||"#333",i),h=a?"":gk(l,"ordinal",u),d=e.valueType,p=s?[]:c(e.value),m=!o||!a,g=!o&&a,v=nK(r,i),_=v.nameStyle,x=v.valueStyle;return i==="richText"?(o?"":f)+(a?"":aK(n,h,_))+(s?"":UPe(n,p,m,g,x)):bk((o?"":f)+(a?"":FPe(h,!o,_))+(s?"":BPe(p,m,g,x)),t)}}function Uz(n,e,t,r,i,a){if(n){var s=rK(n),o={useUTC:i,renderMode:t,orderMode:r,markupStyleCreator:e,valueFormatter:n.valueFormatter};return s(o,n,0,a)}}function $Pe(n){return{html:DPe[n],richText:LPe[n]}}function bk(n,e){var t='<div style="clear:both"></div>',r="margin: "+e+"px 0 0";return'<div style="'+r+";"+tK+';">'+n+t+"</div>"}function FPe(n,e,t){var r=e?"margin-left:2px":"";return'<span style="'+t+";"+r+'">'+Zs(n)+"</span>"}function BPe(n,e,t,r){var i=t?"10px":"20px",a=e?"float:right;margin-left:"+i:"";return n=Rt(n)?n:[n],'<span style="'+a+";"+r+'">'+Nt(n,function(s){return Zs(s)}).join("&nbsp;&nbsp;")+"</span>"}function aK(n,e,t){return n.markupStyleCreator.wrapRichTextStyle(e,t)}function UPe(n,e,t,r,i){var a=[i],s=r?10:20;return t&&a.push({padding:[0,0,0,s],align:"right"}),n.markupStyleCreator.wrapRichTextStyle(Rt(e)?e.join("  "):e,a)}function zPe(n,e){var t=n.getData().getItemVisual(e,"style"),r=t[n.visualDrawType];return _d(r)}function sK(n,e){var t=n.get("padding");return t??(e==="richText"?[8,10]:10)}var LE=function(){function n(){this.richTextStyles={},this._nextStyleNameId=cq()}return n.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},n.prototype.makeTooltipMarker=function(e,t,r){var i=r==="richText"?this._generateStyleName():null,a=TRe({color:t,type:e,renderMode:r,markerId:i});return jt(a)?a:(this.richTextStyles[i]=a.style,a.content)},n.prototype.wrapRichTextStyle=function(e,t){var r={};Rt(t)?ce(t,function(a){return gt(r,a)}):gt(r,t);var i=this._generateStyleName();return this.richTextStyles[i]=r,"{"+i+"|"+e+"}"},n}();function VPe(n){var e=n.series,t=n.dataIndex,r=n.multipleSeries,i=e.getData(),a=i.mapDimensionsAll("defaultedTooltip"),s=a.length,o=e.getRawValue(t),l=Rt(o),u=zPe(e,t),c,f,h,d;if(s>1||l&&!s){var p=HPe(o,e,t,a,u);c=p.inlineValues,f=p.inlineValueTypes,h=p.blocks,d=p.inlineValues[0]}else if(s){var m=i.getDimensionInfo(a[0]);d=c=fg(i,t,a[0]),f=m.type}else d=c=l?o[0]:o;var g=MI(e),v=g&&e.name||"",_=i.getName(t),x=r?v:_;return q0("section",{header:v,noHeader:r||!g,sortParam:d,blocks:[q0("nameValue",{markerType:"item",markerColor:u,name:x,noName:!Dl(x),value:c,valueType:f})].concat(h||[])})}function HPe(n,e,t,r,i){var a=e.getData(),s=df(n,function(f,h,d){var p=a.getDimensionInfo(d);return f=f||p&&p.tooltip!==!1&&p.displayName!=null},!1),o=[],l=[],u=[];r.length?ce(r,function(f){c(fg(a,t,f),f)}):ce(n,c);function c(f,h){var d=a.getDimensionInfo(h);!d||d.otherDims.tooltip===!1||(s?u.push(q0("nameValue",{markerType:"subItem",markerColor:i,name:d.displayName,value:f,valueType:d.type})):(o.push(f),l.push(d.type)))}return{inlineValues:o,inlineValueTypes:l,blocks:u}}var Ac=qr();function Ib(n,e){return n.getName(e)||n.getId(e)}var tw="__universalTransitionEnabled",FT=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._selectedDataIndicesMap={},t}return e.prototype.init=function(t,r,i){this.seriesIndex=this.componentIndex,this.dataTask=t0({count:GPe,reset:jPe}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,i);var a=Ac(this).sourceManager=new eK(this);a.prepareSource();var s=this.getInitialData(t,i);Vz(s,this),this.dataTask.context.data=s,Ac(this).dataBeforeProcessed=s,zz(this),this._initSelectedMapFromData(s)},e.prototype.mergeDefaultAndTheme=function(t,r){var i=G0(this),a=i?NT(t):{},s=this.subType;Sr.hasClass(s)&&(s+="Series"),Dn(t,r.getTheme().get(this.subType)),Dn(t,this.getDefaultOption()),rk(t,"label",["show"]),this.fillDataTextStyle(t.data),i&&cg(t,a,i)},e.prototype.mergeOption=function(t,r){t=Dn(this.option,t,!0),this.fillDataTextStyle(t.data);var i=G0(this);i&&cg(this.option,t,i);var a=Ac(this).sourceManager;a.dirty(),a.prepareSource();var s=this.getInitialData(t,r);Vz(s,this),this.dataTask.dirty(),this.dataTask.context.data=s,Ac(this).dataBeforeProcessed=s,zz(this),this._initSelectedMapFromData(s)},e.prototype.fillDataTextStyle=function(t){if(t&&!Rs(t))for(var r=["show"],i=0;i<t.length;i++)t[i]&&t[i].label&&rk(t[i],"label",r)},e.prototype.getInitialData=function(t,r){},e.prototype.appendData=function(t){var r=this.getRawData();r.appendData(t.data)},e.prototype.getData=function(t){var r=wk(this);if(r){var i=r.context.data;return t==null?i:i.getLinkedData(t)}else return Ac(this).data},e.prototype.getAllData=function(){var t=this.getData();return t&&t.getLinkedDataAll?t.getLinkedDataAll():[{data:t}]},e.prototype.setData=function(t){var r=wk(this);if(r){var i=r.context;i.outputData=t,r!==this.dataTask&&(i.data=t)}Ac(this).data=t},e.prototype.getEncode=function(){var t=this.get("encode",!0);if(t)return dn(t)},e.prototype.getSourceManager=function(){return Ac(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return Ac(this).dataBeforeProcessed},e.prototype.getColorBy=function(){var t=this.get("colorBy");return t||"series"},e.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},e.prototype.getBaseAxis=function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},e.prototype.formatTooltip=function(t,r,i){return VPe({series:this,dataIndex:t,multipleSeries:r})},e.prototype.isAnimationEnabled=function(){var t=this.ecModel;if(In.node&&!(t&&t.ssr))return!1;var r=this.getShallow("animation");return r&&this.getData().count()>this.getShallow("animationThreshold")&&(r=!1),!!r},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(t,r,i){var a=this.ecModel,s=YI.prototype.getColorFromPalette.call(this,t,r,i);return s||(s=a.getColorFromPalette(t,r,i)),s},e.prototype.coordDimToDataDim=function(t){return this.getRawData().mapDimensionsAll(t)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(t,r){this._innerSelect(this.getData(r),t)},e.prototype.unselect=function(t,r){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,s=this.getData(r);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var o=0;o<t.length;o++){var l=t[o],u=Ib(s,l);i[u]=!1,this._selectedDataIndicesMap[u]=-1}}},e.prototype.toggleSelect=function(t,r){for(var i=[],a=0;a<t.length;a++)i[0]=t[a],this.isSelected(t[a],r)?this.unselect(i,r):this.select(i,r)},e.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var t=this._selectedDataIndicesMap,r=Wr(t),i=[],a=0;a<r.length;a++){var s=t[r[a]];s>=0&&i.push(s)}return i},e.prototype.isSelected=function(t,r){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(r);return(i==="all"||i[Ib(a,t)])&&!a.getItemModel(t).get(["select","disabled"])},e.prototype.isUniversalTransitionEnabled=function(){if(this[tw])return!0;var t=this.option.universalTransition;return t?t===!0?!0:t&&t.enabled:!1},e.prototype._innerSelect=function(t,r){var i,a,s=this.option,o=s.selectedMode,l=r.length;if(!(!o||!l)){if(o==="series")s.selectedMap="all";else if(o==="multiple"){Yt(s.selectedMap)||(s.selectedMap={});for(var u=s.selectedMap,c=0;c<l;c++){var f=r[c],h=Ib(t,f);u[h]=!0,this._selectedDataIndicesMap[h]=t.getRawIndex(f)}}else if(o==="single"||o===!0){var d=r[l-1],h=Ib(t,d);s.selectedMap=(i={},i[h]=!0,i),this._selectedDataIndicesMap=(a={},a[h]=t.getRawIndex(d),a)}}},e.prototype._initSelectedMapFromData=function(t){if(!this.option.selectedMap){var r=[];t.hasItemOption&&t.each(function(i){var a=t.getRawDataItem(i);a&&a.selected&&r.push(i)}),r.length>0&&this._innerSelect(t,r)}},e.registerClass=function(t){return Sr.registerClass(t)},e.protoInitialize=function(){var t=e.prototype;t.type="series.__base__",t.seriesIndex=0,t.ignoreStyleOnData=!1,t.hasSymbolVisual=!1,t.defaultSymbol="circle",t.visualStyleAccessPath="itemStyle",t.visualDrawType="fill"}(),e}(Sr);ll(FT,mPe);ll(FT,YI);yq(FT,Sr);function zz(n){var e=n.name;MI(n)||(n.name=WPe(n)||e)}function WPe(n){var e=n.getRawData(),t=e.mapDimensionsAll("seriesName"),r=[];return ce(t,function(i){var a=e.getDimensionInfo(i);a.displayName&&r.push(a.displayName)}),r.join(" ")}function GPe(n){return n.model.getRawData().count()}function jPe(n){var e=n.model;return e.setData(e.getRawData().cloneShallow()),qPe}function qPe(n,e){e.outputData&&n.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function Vz(n,e){ce(X2e(n.CHANGABLE_METHODS,n.DOWNSAMPLE_METHODS),function(t){n.wrapMethod(t,ir(XPe,e))})}function XPe(n,e){var t=wk(n);return t&&t.setOutputEnd((e||this).count()),e}function wk(n){var e=(n.ecModel||{}).scheduler,t=e&&e.getPipeline(n.uid);if(t){var r=t.currentTask;if(r){var i=r.agentStubMap;i&&(r=i.get(n.uid))}return r}}const yf=FT;var nD=function(){function n(){this.group=new yi,this.uid=L_("viewComponent")}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,i){},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,i){},n.prototype.updateLayout=function(e,t,r,i){},n.prototype.updateVisual=function(e,t,r,i){},n.prototype.toggleBlurSeries=function(e,t,r){},n.prototype.eachRendered=function(e){var t=this.group;t&&t.traverse(e)},n}();RI(nD);gT(nD);const Ps=nD;function rD(){var n=qr();return function(e){var t=n(e),r=e.pipelineContext,i=!!t.large,a=!!t.progressiveRender,s=t.large=!!(r&&r.large),o=t.progressiveRender=!!(r&&r.progressiveRender);return(i!==s||a!==o)&&"reset"}}var oK=qr(),KPe=rD(),iD=function(){function n(){this.group=new yi,this.uid=L_("viewChart"),this.renderTask=t0({plan:YPe,reset:ZPe}),this.renderTask.context={view:this}}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,i){},n.prototype.highlight=function(e,t,r,i){var a=e.getData(i&&i.dataType);a&&Wz(a,i,"emphasis")},n.prototype.downplay=function(e,t,r,i){var a=e.getData(i&&i.dataType);a&&Wz(a,i,"normal")},n.prototype.remove=function(e,t){this.group.removeAll()},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.updateLayout=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.updateVisual=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.eachRendered=function(e){AT(this.group,e)},n.markUpdateMethod=function(e,t){oK(e).updateMethod=t},n.protoInitialize=function(){var e=n.prototype;e.type="chart"}(),n}();function Hz(n,e,t){n&&fk(n)&&(e==="emphasis"?og:lg)(n,t)}function Wz(n,e,t){var r=yd(n,e),i=e&&e.highlightKey!=null?oke(e.highlightKey):null;r!=null?ce(ci(r),function(a){Hz(n.getItemGraphicEl(a),t,i)}):n.eachItemGraphicEl(function(a){Hz(a,t,i)})}RI(iD);gT(iD);function YPe(n){return KPe(n.model)}function ZPe(n){var e=n.model,t=n.ecModel,r=n.api,i=n.payload,a=e.pipelineContext.progressiveRender,s=n.view,o=i&&oK(i).updateMethod,l=a?"incrementalPrepareRender":o&&s[o]?o:"render";return l!=="render"&&s[l](e,t,r,i),QPe[l]}var QPe={incrementalPrepareRender:{progress:function(n,e){e.view.incrementalRender(n,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(n,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}};const Ul=iD;var Hw="\0__throttleOriginMethod",Gz="\0__throttleRate",jz="\0__throttleType";function aD(n,e,t){var r,i=0,a=0,s=null,o,l,u,c;e=e||0;function f(){a=new Date().getTime(),s=null,n.apply(l,u||[])}var h=function(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];r=new Date().getTime(),l=this,u=d;var m=c||e,g=c||t;c=null,o=r-(g?i:a)-m,clearTimeout(s),g?s=setTimeout(f,m):o>=0?f():s=setTimeout(f,-o),i=r};return h.clear=function(){s&&(clearTimeout(s),s=null)},h.debounceNextCall=function(d){c=d},h}function lK(n,e,t,r){var i=n[e];if(i){var a=i[Hw]||i,s=i[jz],o=i[Gz];if(o!==t||s!==r){if(t==null||!r)return n[e]=a;i=n[e]=aD(a,t,r==="debounce"),i[Hw]=a,i[jz]=r,i[Gz]=t}return i}}function Sk(n,e){var t=n[e];t&&t[Hw]&&(t.clear&&t.clear(),n[e]=t[Hw])}var qz=qr(),Xz={itemStyle:U0(gX,!0),lineStyle:U0(mX,!0)},JPe={lineStyle:"stroke",itemStyle:"fill"};function uK(n,e){var t=n.visualStyleMapper||Xz[e];return t||(console.warn("Unknown style type '"+e+"'."),Xz.itemStyle)}function cK(n,e){var t=n.visualDrawType||JPe[e];return t||(console.warn("Unknown style type '"+e+"'."),"fill")}var eIe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",i=n.getModel(r),a=uK(n,r),s=a(i),o=i.getShallow("decal");o&&(t.setVisual("decal",o),o.dirty=!0);var l=cK(n,r),u=s[l],c=pn(u)?u:null,f=s.fill==="auto"||s.stroke==="auto";if(!s[l]||c||f){var h=n.getColorFromPalette(n.name,null,e.getSeriesCount());s[l]||(s[l]=h,t.setVisual("colorFromPalette",!0)),s.fill=s.fill==="auto"||pn(s.fill)?h:s.fill,s.stroke=s.stroke==="auto"||pn(s.stroke)?h:s.stroke}if(t.setVisual("style",s),t.setVisual("drawType",l),!e.isSeriesFiltered(n)&&c)return t.setVisual("colorFromPalette",!1),{dataEach:function(d,p){var m=n.getDataParams(p),g=gt({},s);g[l]=c(m),d.setItemVisual(p,"style",g)}}}},Kv=new Fi,tIe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!(n.ignoreStyleOnData||e.isSeriesFiltered(n))){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",i=uK(n,r),a=t.getVisual("drawType");return{dataEach:t.hasItemOption?function(s,o){var l=s.getRawDataItem(o);if(l&&l[r]){Kv.option=l[r];var u=i(Kv),c=s.ensureUniqueItemVisual(o,"style");gt(c,u),Kv.option.decal&&(s.setItemVisual(o,"decal",Kv.option.decal),Kv.option.decal.dirty=!0),a in u&&s.setItemVisual(o,"colorFromPalette",!1)}}:null}}}},nIe={performRawSeries:!0,overallReset:function(n){var e=dn();n.eachSeries(function(t){var r=t.getColorBy();if(!t.isColorBySeries()){var i=t.type+"-"+r,a=e.get(i);a||(a={},e.set(i,a)),qz(t).scope=a}}),n.eachSeries(function(t){if(!(t.isColorBySeries()||n.isSeriesFiltered(t))){var r=t.getRawData(),i={},a=t.getData(),s=qz(t).scope,o=t.visualStyleAccessPath||"itemStyle",l=cK(t,o);a.each(function(u){var c=a.getRawIndex(u);i[c]=u}),r.each(function(u){var c=i[u],f=a.getItemVisual(c,"colorFromPalette");if(f){var h=a.ensureUniqueItemVisual(c,"style"),d=r.getName(u)||u+"",p=r.count();h[l]=t.getColorFromPalette(d,s,p)}})}})}},Db=Math.PI;function rIe(n,e){e=e||{},ln(e,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var t=new yi,r=new oi({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});t.add(r);var i=new Pi({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),a=new oi({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});t.add(a);var s;return e.showSpinner&&(s=new $I({shape:{startAngle:-Db/2,endAngle:-Db/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001}),s.animateShape(!0).when(1e3,{endAngle:Db*3/2}).start("circularInOut"),s.animateShape(!0).when(1e3,{startAngle:Db*3/2}).delay(300).start("circularInOut"),t.add(s)),t.resize=function(){var o=i.getBoundingRect().width,l=e.showSpinner?e.spinnerRadius:0,u=(n.getWidth()-l*2-(e.showSpinner&&o?10:0)-o)/2-(e.showSpinner&&o?0:5+o/2)+(e.showSpinner?0:o/2)+(o?0:l),c=n.getHeight()/2;e.showSpinner&&s.setShape({cx:u,cy:c}),a.setShape({x:u-l,y:c-l,width:l*2,height:l*2}),r.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()})},t.resize(),t}var iIe=function(){function n(e,t,r,i){this._stageTaskMap=dn(),this.ecInstance=e,this.api=t,r=this._dataProcessorHandlers=r.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=r.concat(i)}return n.prototype.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each(function(r){var i=r.overallTask;i&&i.dirty()})},n.prototype.getPerformArgs=function(e,t){if(e.__pipeline){var r=this._pipelineMap.get(e.__pipeline.id),i=r.context,a=!t&&r.progressiveEnabled&&(!i||i.progressiveRender)&&e.__idxInPipeline>r.blockIndex,s=a?r.step:null,o=i&&i.modDataCount,l=o!=null?Math.ceil(o/s):null;return{step:s,modBy:l,modDataCount:o}}},n.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},n.prototype.updateStreamModes=function(e,t){var r=this._pipelineMap.get(e.uid),i=e.getData(),a=i.count(),s=r.progressiveEnabled&&t.incrementalPrepareRender&&a>=r.threshold,o=e.get("large")&&a>=e.get("largeThreshold"),l=e.get("progressiveChunkMode")==="mod"?a:null;e.pipelineContext=r.context={progressiveRender:s,modDataCount:l,large:o}},n.prototype.restorePipelines=function(e){var t=this,r=t._pipelineMap=dn();e.eachSeries(function(i){var a=i.getProgressive(),s=i.uid;r.set(s,{id:s,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),t._pipe(i,i.dataTask)})},n.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.api.getModel(),r=this.api;ce(this._allHandlers,function(i){var a=e.get(i.uid)||e.set(i.uid,{}),s="";ql(!(i.reset&&i.overallReset),s),i.reset&&this._createSeriesStageTask(i,a,t,r),i.overallReset&&this._createOverallStageTask(i,a,t,r)},this)},n.prototype.prepareView=function(e,t,r,i){var a=e.renderTask,s=a.context;s.model=t,s.ecModel=r,s.api=i,a.__block=!e.incrementalPrepareRender,this._pipe(t,a)},n.prototype.performDataProcessorTasks=function(e,t){this._performStageTasks(this._dataProcessorHandlers,e,t,{block:!0})},n.prototype.performVisualTasks=function(e,t,r){this._performStageTasks(this._visualHandlers,e,t,r)},n.prototype._performStageTasks=function(e,t,r,i){i=i||{};var a=!1,s=this;ce(e,function(l,u){if(!(i.visualType&&i.visualType!==l.visualType)){var c=s._stageTaskMap.get(l.uid),f=c.seriesTaskMap,h=c.overallTask;if(h){var d,p=h.agentStubMap;p.each(function(g){o(i,g)&&(g.dirty(),d=!0)}),d&&h.dirty(),s.updatePayload(h,r);var m=s.getPerformArgs(h,i.block);p.each(function(g){g.perform(m)}),h.perform(m)&&(a=!0)}else f&&f.each(function(g,v){o(i,g)&&g.dirty();var _=s.getPerformArgs(g,i.block);_.skip=!l.performRawSeries&&t.isSeriesFiltered(g.context.model),s.updatePayload(g,r),g.perform(_)&&(a=!0)})}});function o(l,u){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(u.__pipeline.id))}this.unfinished=a||this.unfinished},n.prototype.performSeriesTasks=function(e){var t;e.eachSeries(function(r){t=r.dataTask.perform()||t}),this.unfinished=t||this.unfinished},n.prototype.plan=function(){this._pipelineMap.each(function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)})},n.prototype.updatePayload=function(e,t){t!=="remain"&&(e.context.payload=t)},n.prototype._createSeriesStageTask=function(e,t,r,i){var a=this,s=t.seriesTaskMap,o=t.seriesTaskMap=dn(),l=e.seriesType,u=e.getTargetSeries;e.createOnAllSeries?r.eachRawSeries(c):l?r.eachRawSeriesByType(l,c):u&&u(r,i).each(c);function c(f){var h=f.uid,d=o.set(h,s&&s.get(h)||t0({plan:uIe,reset:cIe,count:hIe}));d.context={model:f,ecModel:r,api:i,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:a},a._pipe(f,d)}},n.prototype._createOverallStageTask=function(e,t,r,i){var a=this,s=t.overallTask=t.overallTask||t0({reset:aIe});s.context={ecModel:r,api:i,overallReset:e.overallReset,scheduler:a};var o=s.agentStubMap,l=s.agentStubMap=dn(),u=e.seriesType,c=e.getTargetSeries,f=!0,h=!1,d="";ql(!e.createOnAllSeries,d),u?r.eachRawSeriesByType(u,p):c?c(r,i).each(p):(f=!1,ce(r.getSeries(),p));function p(m){var g=m.uid,v=l.set(g,o&&o.get(g)||(h=!0,t0({reset:sIe,onDirty:lIe})));v.context={model:m,overallProgress:f},v.agent=s,v.__block=f,a._pipe(m,v)}h&&s.dirty()},n.prototype._pipe=function(e,t){var r=e.uid,i=this._pipelineMap.get(r);!i.head&&(i.head=t),i.tail&&i.tail.pipe(t),i.tail=t,t.__idxInPipeline=i.count++,t.__pipeline=i},n.wrapStageHandler=function(e,t){return pn(e)&&(e={overallReset:e,seriesType:dIe(e)}),e.uid=L_("stageHandler"),t&&(e.visualType=t),e},n}();function aIe(n){n.overallReset(n.ecModel,n.api,n.payload)}function sIe(n){return n.overallProgress&&oIe}function oIe(){this.agent.dirty(),this.getDownstream().dirty()}function lIe(){this.agent&&this.agent.dirty()}function uIe(n){return n.plan?n.plan(n.model,n.ecModel,n.api,n.payload):null}function cIe(n){n.useClearVisual&&n.data.clearAllVisual();var e=n.resetDefines=ci(n.reset(n.model,n.ecModel,n.api,n.payload));return e.length>1?Nt(e,function(t,r){return fK(r)}):fIe}var fIe=fK(0);function fK(n){return function(e,t){var r=t.data,i=t.resetDefines[n];if(i&&i.dataEach)for(var a=e.start;a<e.end;a++)i.dataEach(r,a);else i&&i.progress&&i.progress(e,r)}}function hIe(n){return n.data.count()}function dIe(n){Ww=null;try{n(X0,hK)}catch{}return Ww}var X0={},hK={},Ww;dK(X0,FX);dK(hK,BX);X0.eachSeriesByType=X0.eachRawSeriesByType=function(n){Ww=n};X0.eachComponent=function(n){n.mainType==="series"&&n.subType&&(Ww=n.subType)};function dK(n,e){for(var t in e.prototype)n[t]=Oa}const pK=iIe;var Kz=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const pIe={color:Kz,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],Kz]};var Pa="#B9B8CE",Yz="#100C2A",Lb=function(){return{axisLine:{lineStyle:{color:Pa}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},Zz=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],mK={darkMode:!0,color:Zz,backgroundColor:Yz,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:Pa}},textStyle:{color:Pa},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:Pa}},dataZoom:{borderColor:"#71708A",textStyle:{color:Pa},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:Pa}},timeline:{lineStyle:{color:Pa},label:{color:Pa},controlStyle:{color:Pa,borderColor:Pa}},calendar:{itemStyle:{color:Yz},dayLabel:{color:Pa},monthLabel:{color:Pa},yearLabel:{color:Pa}},timeAxis:Lb(),logAxis:Lb(),valueAxis:Lb(),categoryAxis:Lb(),line:{symbol:"circle"},graph:{color:Zz},gauge:{title:{color:Pa},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:Pa},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};mK.categoryAxis.splitLine.show=!1;const mIe=mK;var gIe=function(){function n(){}return n.prototype.normalizeQuery=function(e){var t={},r={},i={};if(jt(e)){var a=Ll(e);t.mainType=a.main||null,t.subType=a.sub||null}else{var s=["Index","Name","Id"],o={name:1,dataIndex:1,dataType:1};ce(e,function(l,u){for(var c=!1,f=0;f<s.length;f++){var h=s[f],d=u.lastIndexOf(h);if(d>0&&d===u.length-h.length){var p=u.slice(0,d);p!=="data"&&(t.mainType=p,t[h.toLowerCase()]=l,c=!0)}}o.hasOwnProperty(u)&&(r[u]=l,c=!0),c||(i[u]=l)})}return{cptQuery:t,dataQuery:r,otherQuery:i}},n.prototype.filter=function(e,t){var r=this.eventInfo;if(!r)return!0;var i=r.targetEl,a=r.packedEvent,s=r.model,o=r.view;if(!s||!o)return!0;var l=t.cptQuery,u=t.dataQuery;return c(l,s,"mainType")&&c(l,s,"subType")&&c(l,s,"index","componentIndex")&&c(l,s,"name")&&c(l,s,"id")&&c(u,a,"name")&&c(u,a,"dataIndex")&&c(u,a,"dataType")&&(!o.filterForExposedEvent||o.filterForExposedEvent(e,t.otherQuery,i,a));function c(f,h,d,p){return f[d]==null||h[p||d]===f[d]}},n.prototype.afterTrigger=function(){this.eventInfo=null},n}(),Tk=["symbol","symbolSize","symbolRotate","symbolOffset"],Qz=Tk.concat(["symbolKeepAspect"]),vIe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData();if(n.legendIcon&&t.setVisual("legendIcon",n.legendIcon),!n.hasSymbolVisual)return;for(var r={},i={},a=!1,s=0;s<Tk.length;s++){var o=Tk[s],l=n.get(o);pn(l)?(a=!0,i[o]=l):r[o]=l}if(r.symbol=r.symbol||n.defaultSymbol,t.setVisual(gt({legendIcon:n.legendIcon||r.symbol,symbolKeepAspect:n.get("symbolKeepAspect")},r)),e.isSeriesFiltered(n))return;var u=Wr(i);function c(f,h){for(var d=n.getRawValue(h),p=n.getDataParams(h),m=0;m<u.length;m++){var g=u[m];f.setItemVisual(h,g,i[g](d,p))}}return{dataEach:a?c:null}}},yIe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!n.hasSymbolVisual||e.isSeriesFiltered(n))return;var t=n.getData();function r(i,a){for(var s=i.getItemModel(a),o=0;o<Qz.length;o++){var l=Qz[o],u=s.getShallow(l,!0);u!=null&&i.setItemVisual(a,l,u)}}return{dataEach:t.hasItemOption?r:null}}};function _Ie(n,e,t){switch(t){case"color":var r=n.getItemVisual(e,"style");return r[n.getVisual("drawType")];case"opacity":return n.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getItemVisual(e,t)}}function xIe(n,e){switch(e){case"color":var t=n.getVisual("style");return t[n.getVisual("drawType")];case"opacity":return n.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getVisual(e)}}function bIe(n,e){function t(r,i){var a=[];return r.eachComponent({mainType:"series",subType:n,query:i},function(s){a.push(s.seriesIndex)}),a}ce([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(r){e(r[0],function(i,a,s){i=gt({},i),s.dispatchAction(gt(i,{type:r[1],seriesIndex:t(a,i)}))})})}function Up(n,e,t,r,i){var a=n+e;t.isSilent(a)||r.eachComponent({mainType:"series",subType:"pie"},function(s){for(var o=s.seriesIndex,l=s.option.selectedMap,u=i.selected,c=0;c<u.length;c++)if(u[c].seriesIndex===o){var f=s.getData(),h=yd(f,i.fromActionPayload);t.trigger(a,{type:a,seriesId:s.id,name:Rt(h)?f.getName(h[0]):f.getName(h),selected:jt(l)?l:gt({},l)})}})}function wIe(n,e,t){n.on("selectchanged",function(r){var i=t.getModel();r.isFromClick?(Up("map","selectchanged",e,i,r),Up("pie","selectchanged",e,i,r)):r.fromAction==="select"?(Up("map","selected",e,i,r),Up("pie","selected",e,i,r)):r.fromAction==="unselect"&&(Up("map","unselected",e,i,r),Up("pie","unselected",e,i,r))})}function Sy(n,e,t){for(var r;n&&!(e(n)&&(r=n,t));)n=n.__hostTarget||n.parent;return r}var SIe=Math.round(Math.random()*9),TIe=typeof Object.defineProperty=="function",CIe=function(){function n(){this._id="__ec_inner_"+SIe++}return n.prototype.get=function(e){return this._guard(e)[this._id]},n.prototype.set=function(e,t){var r=this._guard(e);return TIe?Object.defineProperty(r,this._id,{value:t,enumerable:!1,configurable:!0}):r[this._id]=t,this},n.prototype.delete=function(e){return this.has(e)?(delete this._guard(e)[this._id],!0):!1},n.prototype.has=function(e){return!!this._guard(e)[this._id]},n.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},n}();const EIe=CIe;var AIe=Wn.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,i=e.width/2,a=e.height/2;n.moveTo(t,r-a),n.lineTo(t+i,r+a),n.lineTo(t-i,r+a),n.closePath()}}),MIe=Wn.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,i=e.width/2,a=e.height/2;n.moveTo(t,r-a),n.lineTo(t+i,r),n.lineTo(t,r+a),n.lineTo(t-i,r),n.closePath()}}),kIe=Wn.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.x,r=e.y,i=e.width/5*3,a=Math.max(i,e.height),s=i/2,o=s*s/(a-s),l=r-a+s+o,u=Math.asin(o/s),c=Math.cos(u)*s,f=Math.sin(u),h=Math.cos(u),d=s*.6,p=s*.7;n.moveTo(t-c,l+o),n.arc(t,l,s,Math.PI-u,Math.PI*2+u),n.bezierCurveTo(t+c-f*d,l+o+h*d,t,r-p,t,r),n.bezierCurveTo(t,r-p,t-c+f*d,l+o+h*d,t-c,l+o),n.closePath()}}),RIe=Wn.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.height,r=e.width,i=e.x,a=e.y,s=r/3*2;n.moveTo(i,a),n.lineTo(i+s,a+t),n.lineTo(i,a+t/4*3),n.lineTo(i-s,a+t),n.lineTo(i,a),n.closePath()}}),PIe={line:Xo,rect:oi,roundRect:oi,square:oi,circle:ug,diamond:MIe,pin:kIe,arrow:RIe,triangle:AIe},IIe={line:function(n,e,t,r,i){i.x1=n,i.y1=e+r/2,i.x2=n+t,i.y2=e+r/2},rect:function(n,e,t,r,i){i.x=n,i.y=e,i.width=t,i.height=r},roundRect:function(n,e,t,r,i){i.x=n,i.y=e,i.width=t,i.height=r,i.r=Math.min(t,r)/4},square:function(n,e,t,r,i){var a=Math.min(t,r);i.x=n,i.y=e,i.width=a,i.height=a},circle:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.r=Math.min(t,r)/2},diamond:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.width=t,i.height=r},pin:function(n,e,t,r,i){i.x=n+t/2,i.y=e+r/2,i.width=t,i.height=r},arrow:function(n,e,t,r,i){i.x=n+t/2,i.y=e+r/2,i.width=t,i.height=r},triangle:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.width=t,i.height=r}},Ck={};ce(PIe,function(n,e){Ck[e]=new n});var DIe=Wn.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(n,e,t){var r=Dw(n,e,t),i=this.shape;return i&&i.symbolType==="pin"&&e.position==="inside"&&(r.y=t.y+t.height*.4),r},buildPath:function(n,e,t){var r=e.symbolType;if(r!=="none"){var i=Ck[r];i||(r="rect",i=Ck[r]),IIe[r](e.x,e.y,e.width,e.height,i.shape),i.buildPath(n,i.shape,t)}}});function LIe(n,e){if(this.type!=="image"){var t=this.style;this.__isEmptyBrush?(t.stroke=n,t.fill=e||"#fff",t.lineWidth=2):this.shape.symbolType==="line"?t.stroke=n:t.fill=n,this.markRedraw()}}function hg(n,e,t,r,i,a,s){var o=n.indexOf("empty")===0;o&&(n=n.substr(5,1).toLowerCase()+n.substr(6));var l;return n.indexOf("image://")===0?l=lX(n.slice(8),new Xn(e,t,r,i),s?"center":"cover"):n.indexOf("path://")===0?l=UI(n.slice(7),{},new Xn(e,t,r,i),s?"center":"cover"):l=new DIe({shape:{symbolType:n,x:e,y:t,width:r,height:i}}),l.__isEmptyBrush=o,l.setColor=LIe,a&&l.setColor(a),l}function NIe(n){return Rt(n)||(n=[+n,+n]),[n[0]||0,n[1]||0]}function gK(n,e){if(n!=null)return Rt(n)||(n=[n,n]),[Jn(n[0],e[0])||0,Jn(Hn(n[1],n[0]),e[1])||0]}function Vh(n){return isFinite(n)}function OIe(n,e,t){var r=e.x==null?0:e.x,i=e.x2==null?1:e.x2,a=e.y==null?0:e.y,s=e.y2==null?0:e.y2;e.global||(r=r*t.width+t.x,i=i*t.width+t.x,a=a*t.height+t.y,s=s*t.height+t.y),r=Vh(r)?r:0,i=Vh(i)?i:1,a=Vh(a)?a:0,s=Vh(s)?s:0;var o=n.createLinearGradient(r,a,i,s);return o}function $Ie(n,e,t){var r=t.width,i=t.height,a=Math.min(r,i),s=e.x==null?.5:e.x,o=e.y==null?.5:e.y,l=e.r==null?.5:e.r;e.global||(s=s*r+t.x,o=o*i+t.y,l=l*a),s=Vh(s)?s:.5,o=Vh(o)?o:.5,l=l>=0&&Vh(l)?l:.5;var u=n.createRadialGradient(s,o,0,s,o,l);return u}function Ek(n,e,t){for(var r=e.type==="radial"?$Ie(n,e,t):OIe(n,e,t),i=e.colorStops,a=0;a<i.length;a++)r.addColorStop(i[a].offset,i[a].color);return r}function FIe(n,e){if(n===e||!n&&!e)return!1;if(!n||!e||n.length!==e.length)return!0;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!0;return!1}function Nb(n){return parseInt(n,10)}function Ob(n,e,t){var r=["width","height"][e],i=["clientWidth","clientHeight"][e],a=["paddingLeft","paddingTop"][e],s=["paddingRight","paddingBottom"][e];if(t[r]!=null&&t[r]!=="auto")return parseFloat(t[r]);var o=document.defaultView.getComputedStyle(n);return(n[i]||Nb(o[r])||Nb(n.style[r]))-(Nb(o[a])||0)-(Nb(o[s])||0)|0}function BIe(n,e){return!n||n==="solid"||!(e>0)?null:n==="dashed"?[4*e,2*e]:n==="dotted"?[e]:gr(n)?[n]:Rt(n)?n:null}function vK(n){var e=n.style,t=e.lineDash&&e.lineWidth>0&&BIe(e.lineDash,e.lineWidth),r=e.lineDashOffset;if(t){var i=e.strokeNoScale&&n.getLineScale?n.getLineScale():1;i&&i!==1&&(t=Nt(t,function(a){return a/i}),r/=i)}return[t,r]}var UIe=new Xu(!0);function Gw(n){var e=n.stroke;return!(e==null||e==="none"||!(n.lineWidth>0))}function Jz(n){return typeof n=="string"&&n!=="none"}function jw(n){var e=n.fill;return e!=null&&e!=="none"}function eV(n,e){if(e.fillOpacity!=null&&e.fillOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.fillOpacity*e.opacity,n.fill(),n.globalAlpha=t}else n.fill()}function tV(n,e){if(e.strokeOpacity!=null&&e.strokeOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.strokeOpacity*e.opacity,n.stroke(),n.globalAlpha=t}else n.stroke()}function Ak(n,e,t){var r=_q(e.image,e.__image,t);if(vT(r)){var i=n.createPattern(r,e.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(e.x||0,e.y||0),a.rotateSelf(0,0,(e.rotation||0)*K2e),a.scaleSelf(e.scaleX||1,e.scaleY||1),i.setTransform(a)}return i}}function zIe(n,e,t,r){var i,a=Gw(t),s=jw(t),o=t.strokePercent,l=o<1,u=!e.path;(!e.silent||l)&&u&&e.createPathProxy();var c=e.path||UIe,f=e.__dirty;if(!r){var h=t.fill,d=t.stroke,p=s&&!!h.colorStops,m=a&&!!d.colorStops,g=s&&!!h.image,v=a&&!!d.image,_=void 0,x=void 0,b=void 0,S=void 0,T=void 0;(p||m)&&(T=e.getBoundingRect()),p&&(_=f?Ek(n,h,T):e.__canvasFillGradient,e.__canvasFillGradient=_),m&&(x=f?Ek(n,d,T):e.__canvasStrokeGradient,e.__canvasStrokeGradient=x),g&&(b=f||!e.__canvasFillPattern?Ak(n,h,e):e.__canvasFillPattern,e.__canvasFillPattern=b),v&&(S=f||!e.__canvasStrokePattern?Ak(n,d,e):e.__canvasStrokePattern,e.__canvasStrokePattern=b),p?n.fillStyle=_:g&&(b?n.fillStyle=b:s=!1),m?n.strokeStyle=x:v&&(S?n.strokeStyle=S:a=!1)}var M=e.getGlobalScale();c.setScale(M[0],M[1],e.segmentIgnoreThreshold);var C,k;n.setLineDash&&t.lineDash&&(i=vK(e),C=i[0],k=i[1]);var R=!0;(u||f&rm)&&(c.setDPR(n.dpr),l?c.setContext(null):(c.setContext(n),R=!1),c.reset(),e.buildPath(c,e.shape,r),c.toStatic(),e.pathUpdated()),R&&c.rebuildPath(n,l?o:1),C&&(n.setLineDash(C),n.lineDashOffset=k),r||(t.strokeFirst?(a&&tV(n,t),s&&eV(n,t)):(s&&eV(n,t),a&&tV(n,t))),C&&n.setLineDash([])}function VIe(n,e,t){var r=e.__image=_q(t.image,e.__image,e,e.onload);if(!(!r||!vT(r))){var i=t.x||0,a=t.y||0,s=e.getWidth(),o=e.getHeight(),l=r.width/r.height;if(s==null&&o!=null?s=o*l:o==null&&s!=null?o=s/l:s==null&&o==null&&(s=r.width,o=r.height),t.sWidth&&t.sHeight){var u=t.sx||0,c=t.sy||0;n.drawImage(r,u,c,t.sWidth,t.sHeight,i,a,s,o)}else if(t.sx&&t.sy){var u=t.sx,c=t.sy,f=s-u,h=o-c;n.drawImage(r,u,c,f,h,i,a,s,o)}else n.drawImage(r,i,a,s,o)}}function HIe(n,e,t){var r,i=t.text;if(i!=null&&(i+=""),i){n.font=t.font||vd,n.textAlign=t.textAlign,n.textBaseline=t.textBaseline;var a=void 0,s=void 0;n.setLineDash&&t.lineDash&&(r=vK(e),a=r[0],s=r[1]),a&&(n.setLineDash(a),n.lineDashOffset=s),t.strokeFirst?(Gw(t)&&n.strokeText(i,t.x,t.y),jw(t)&&n.fillText(i,t.x,t.y)):(jw(t)&&n.fillText(i,t.x,t.y),Gw(t)&&n.strokeText(i,t.x,t.y)),a&&n.setLineDash([])}}var nV=["shadowBlur","shadowOffsetX","shadowOffsetY"],rV=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function yK(n,e,t,r,i){var a=!1;if(!r&&(t=t||{},e===t))return!1;if(r||e.opacity!==t.opacity){ts(n,i),a=!0;var s=Math.max(Math.min(e.opacity,1),0);n.globalAlpha=isNaN(s)?ed.opacity:s}(r||e.blend!==t.blend)&&(a||(ts(n,i),a=!0),n.globalCompositeOperation=e.blend||ed.blend);for(var o=0;o<nV.length;o++){var l=nV[o];(r||e[l]!==t[l])&&(a||(ts(n,i),a=!0),n[l]=n.dpr*(e[l]||0))}return(r||e.shadowColor!==t.shadowColor)&&(a||(ts(n,i),a=!0),n.shadowColor=e.shadowColor||ed.shadowColor),a}function iV(n,e,t,r,i){var a=K0(e,i.inHover),s=r?null:t&&K0(t,i.inHover)||{};if(a===s)return!1;var o=yK(n,a,s,r,i);if((r||a.fill!==s.fill)&&(o||(ts(n,i),o=!0),Jz(a.fill)&&(n.fillStyle=a.fill)),(r||a.stroke!==s.stroke)&&(o||(ts(n,i),o=!0),Jz(a.stroke)&&(n.strokeStyle=a.stroke)),(r||a.opacity!==s.opacity)&&(o||(ts(n,i),o=!0),n.globalAlpha=a.opacity==null?1:a.opacity),e.hasStroke()){var l=a.lineWidth,u=l/(a.strokeNoScale&&e.getLineScale?e.getLineScale():1);n.lineWidth!==u&&(o||(ts(n,i),o=!0),n.lineWidth=u)}for(var c=0;c<rV.length;c++){var f=rV[c],h=f[0];(r||a[h]!==s[h])&&(o||(ts(n,i),o=!0),n[h]=a[h]||f[1])}return o}function WIe(n,e,t,r,i){return yK(n,K0(e,i.inHover),t&&K0(t,i.inHover),r,i)}function _K(n,e){var t=e.transform,r=n.dpr||1;t?n.setTransform(r*t[0],r*t[1],r*t[2],r*t[3],r*t[4],r*t[5]):n.setTransform(r,0,0,r,0,0)}function GIe(n,e,t){for(var r=!1,i=0;i<n.length;i++){var a=n[i];r=r||a.isZeroArea(),_K(e,a),e.beginPath(),a.buildPath(e,a.shape),e.clip()}t.allClipped=r}function jIe(n,e){return n&&e?n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]||n[4]!==e[4]||n[5]!==e[5]:!(!n&&!e)}var aV=1,sV=2,oV=3,lV=4;function qIe(n){var e=jw(n),t=Gw(n);return!(n.lineDash||!(+e^+t)||e&&typeof n.fill!="string"||t&&typeof n.stroke!="string"||n.strokePercent<1||n.strokeOpacity<1||n.fillOpacity<1)}function ts(n,e){e.batchFill&&n.fill(),e.batchStroke&&n.stroke(),e.batchFill="",e.batchStroke=""}function K0(n,e){return e&&n.__hoverStyle||n.style}function xK(n,e){Hh(n,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Hh(n,e,t,r){var i=e.transform;if(!e.shouldBePainted(t.viewWidth,t.viewHeight,!1,!1)){e.__dirty&=~Ts,e.__isRendered=!1;return}var a=e.__clipPaths,s=t.prevElClipPaths,o=!1,l=!1;if((!s||FIe(a,s))&&(s&&s.length&&(ts(n,t),n.restore(),l=o=!0,t.prevElClipPaths=null,t.allClipped=!1,t.prevEl=null),a&&a.length&&(ts(n,t),n.save(),GIe(a,n,t),o=!0),t.prevElClipPaths=a),t.allClipped){e.__isRendered=!1;return}e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var u=t.prevEl;u||(l=o=!0);var c=e instanceof Wn&&e.autoBatch&&qIe(e.style);o||jIe(i,u.transform)?(ts(n,t),_K(n,e)):c||ts(n,t);var f=K0(e,t.inHover);e instanceof Wn?(t.lastDrawType!==aV&&(l=!0,t.lastDrawType=aV),iV(n,e,u,l,t),(!c||!t.batchFill&&!t.batchStroke)&&n.beginPath(),zIe(n,e,f,c),c&&(t.batchFill=f.fill||"",t.batchStroke=f.stroke||"")):e instanceof ok?(t.lastDrawType!==oV&&(l=!0,t.lastDrawType=oV),iV(n,e,u,l,t),HIe(n,e,f)):e instanceof zd?(t.lastDrawType!==sV&&(l=!0,t.lastDrawType=sV),WIe(n,e,u,l,t),VIe(n,e,f)):e.getTemporalDisplayables&&(t.lastDrawType!==lV&&(l=!0,t.lastDrawType=lV),XIe(n,e,t)),c&&r&&ts(n,t),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),t.prevEl=e,e.__dirty=0,e.__isRendered=!0}function XIe(n,e,t){var r=e.getDisplayables(),i=e.getTemporalDisplayables();n.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:t.viewWidth,viewHeight:t.viewHeight,inHover:t.inHover},s,o;for(s=e.getCursor(),o=r.length;s<o;s++){var l=r[s];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Hh(n,l,a,s===o-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}for(var u=0,c=i.length;u<c;u++){var l=i[u];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),Hh(n,l,a,u===c-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}e.clearTemporalDisplayables(),e.notClear=!0,n.restore()}var NE=new EIe,uV=new E_(100),cV=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function Mk(n,e){if(n==="none")return null;var t=e.getDevicePixelRatio(),r=e.getZr(),i=r.painter.type==="svg";n.dirty&&NE.delete(n);var a=NE.get(n);if(a)return a;var s=ln(n,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});s.backgroundColor==="none"&&(s.backgroundColor=null);var o={repeat:"repeat"};return l(o),o.rotation=s.rotation,o.scaleX=o.scaleY=i?1:1/t,NE.set(n,o),n.dirty=!1,o;function l(u){for(var c=[t],f=!0,h=0;h<cV.length;++h){var d=s[cV[h]];if(d!=null&&!Rt(d)&&!jt(d)&&!gr(d)&&typeof d!="boolean"){f=!1;break}c.push(d)}var p;if(f){p=c.join(",")+(i?"-svg":"");var m=uV.get(p);m&&(i?u.svgElement=m:u.image=m)}var g=wK(s.dashArrayX),v=KIe(s.dashArrayY),_=bK(s.symbol),x=YIe(g),b=SK(v),S=!i&&zg.createCanvas(),T=i&&{tag:"g",attrs:{},key:"dcl",children:[]},M=k(),C;S&&(S.width=M.width*t,S.height=M.height*t,C=S.getContext("2d")),R(),f&&uV.put(p,S||T),u.image=S,u.svgElement=T,u.svgWidth=M.width,u.svgHeight=M.height;function k(){for(var P=1,N=0,L=x.length;N<L;++N)P=wU(P,x[N]);for(var F=1,N=0,L=_.length;N<L;++N)F=wU(F,_[N].length);P*=F;var O=b*x.length*_.length;return{width:Math.max(1,Math.min(P,s.maxTileWidth)),height:Math.max(1,Math.min(O,s.maxTileHeight))}}function R(){C&&(C.clearRect(0,0,S.width,S.height),s.backgroundColor&&(C.fillStyle=s.backgroundColor,C.fillRect(0,0,S.width,S.height)));for(var P=0,N=0;N<v.length;++N)P+=v[N];if(P<=0)return;for(var L=-b,F=0,O=0,B=0;L<M.height;){if(F%2===0){for(var H=O/2%_.length,j=0,K=0,J=0;j<M.width*2;){for(var re=0,N=0;N<g[B].length;++N)re+=g[B][N];if(re<=0)break;if(K%2===0){var se=(1-s.symbolSize)*.5,Ae=j+g[B][K]*se,Ee=L+v[F]*se,Ne=g[B][K]*s.symbolSize,we=v[F]*s.symbolSize,me=J/2%_[H].length;Se(Ae,Ee,Ne,we,_[H][me])}j+=g[B][K],++J,++K,K===g[B].length&&(K=0)}++B,B===g.length&&(B=0)}L+=v[F],++O,++F,F===v.length&&(F=0)}function Se(Me,ke,He,ee,ie){var xe=i?1:t,Ve=hg(ie,Me*xe,ke*xe,He*xe,ee*xe,s.color,s.symbolKeepAspect);if(i){var Ge=r.painter.renderOneToVNode(Ve);Ge&&T.children.push(Ge)}else xK(C,Ve)}}}}function bK(n){if(!n||n.length===0)return[["rect"]];if(jt(n))return[[n]];for(var e=!0,t=0;t<n.length;++t)if(!jt(n[t])){e=!1;break}if(e)return bK([n]);for(var r=[],t=0;t<n.length;++t)jt(n[t])?r.push([n[t]]):r.push(n[t]);return r}function wK(n){if(!n||n.length===0)return[[0,0]];if(gr(n)){var e=Math.ceil(n);return[[e,e]]}for(var t=!0,r=0;r<n.length;++r)if(!gr(n[r])){t=!1;break}if(t)return wK([n]);for(var i=[],r=0;r<n.length;++r)if(gr(n[r])){var e=Math.ceil(n[r]);i.push([e,e])}else{var e=Nt(n[r],function(o){return Math.ceil(o)});e.length%2===1?i.push(e.concat(e)):i.push(e)}return i}function KIe(n){if(!n||typeof n=="object"&&n.length===0)return[0,0];if(gr(n)){var e=Math.ceil(n);return[e,e]}var t=Nt(n,function(r){return Math.ceil(r)});return n.length%2?t.concat(t):t}function YIe(n){return Nt(n,function(e){return SK(e)})}function SK(n){for(var e=0,t=0;t<n.length;++t)e+=n[t];return n.length%2===1?e*2:e}function ZIe(n,e){n.eachRawSeries(function(t){if(!n.isSeriesFiltered(t)){var r=t.getData();r.hasItemVisual()&&r.each(function(s){var o=r.getItemVisual(s,"decal");if(o){var l=r.ensureUniqueItemVisual(s,"style");l.decal=Mk(o,e)}});var i=r.getVisual("decal");if(i){var a=r.getVisual("style");a.decal=Mk(i,e)}}})}var QIe=new ul;const $o=QIe;var TK={};function JIe(n,e){TK[n]=e}function eDe(n){return TK[n]}var tDe=1,nDe=800,rDe=900,iDe=1e3,aDe=2e3,sDe=5e3,CK=1e3,oDe=1100,sD=2e3,EK=3e3,lDe=4e3,BT=4500,uDe=4600,cDe=5e3,fDe=6e3,AK=7e3,hDe={PROCESSOR:{FILTER:iDe,SERIES_FILTER:nDe,STATISTIC:sDe},VISUAL:{LAYOUT:CK,PROGRESSIVE_LAYOUT:oDe,GLOBAL:sD,CHART:EK,POST_CHART_LAYOUT:uDe,COMPONENT:lDe,BRUSH:cDe,CHART_ITEM:BT,ARIA:fDe,DECAL:AK}},ia="__flagInMainProcess",Ga="__pendingUpdate",OE="__needsUpdateStatus",fV=/^[a-zA-Z0-9_]+$/,$E="__connectUpdateStatus",hV=0,dDe=1,pDe=2;function MK(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.isDisposed()){this.id;return}return RK(this,n,e)}}function kK(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RK(this,n,e)}}function RK(n,e,t){return t[0]=t[0]&&t[0].toLowerCase(),ul.prototype[e].apply(n,t)}var PK=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(ul),IK=PK.prototype;IK.on=kK("on");IK.off=kK("off");var zp,FE,$b,Mc,BE,UE,zE,Yv,Zv,dV,pV,VE,mV,Fb,gV,DK,Bs,vV,LK=function(n){ht(e,n);function e(t,r,i){var a=n.call(this,new gIe)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},jt(r)&&(r=NK[r]),a._dom=t;var s="canvas",o="auto",l=!1,u=a._zr=xU(t,{renderer:i.renderer||s,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:Hn(i.useDirtyRect,l),useCoarsePointer:Hn(i.useCoarsePointer,o),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=aD(Rr(u.flush,u),17),r=wn(r),r&&zX(r,!0),a._theme=r,a._locale=vRe(i.locale||yX),a._coordSysMgr=new ZI;var c=a._api=gV(a);function f(h,d){return h.__prio-d.__prio}return H1(Xw,f),H1(kk,f),a._scheduler=new pK(a,c,kk,Xw),a._messageCenter=new PK,a._initEvents(),a.resize=Rr(a.resize,a),u.animation.on("frame",a._onframe,a),dV(u,a),pV(u,a),Ew(a),a}return e.prototype._onframe=function(){if(!this._disposed){vV(this);var t=this._scheduler;if(this[Ga]){var r=this[Ga].silent;this[ia]=!0;try{zp(this),Mc.update.call(this,null,this[Ga].updateParams)}catch(l){throw this[ia]=!1,this[Ga]=null,l}this._zr.flush(),this[ia]=!1,this[Ga]=null,Yv.call(this,r),Zv.call(this,r)}else if(t.unfinished){var i=tDe,a=this._model,s=this._api;t.unfinished=!1;do{var o=+new Date;t.performSeriesTasks(a),t.performDataProcessorTasks(a),UE(this,a),t.performVisualTasks(a),Fb(this,this._model,s,"remain",{}),i-=+new Date-o}while(i>0&&t.unfinished);t.unfinished||this._zr.flush()}}},e.prototype.getDom=function(){return this._dom},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this._zr},e.prototype.isSSR=function(){return this._ssr},e.prototype.setOption=function(t,r,i){if(!this[ia]){if(this._disposed){this.id;return}var a,s,o;if(Yt(r)&&(i=r.lazyUpdate,a=r.silent,s=r.replaceMerge,o=r.transition,r=r.notMerge),this[ia]=!0,!this._model||r){var l=new QRe(this._api),u=this._theme,c=this._model=new FX;c.scheduler=this._scheduler,c.ssr=this._ssr,c.init(null,null,null,u,this._locale,l)}this._model.setOption(t,{replaceMerge:s},Rk);var f={seriesTransition:o,optionChanged:!0};if(i)this[Ga]={silent:a,updateParams:f},this[ia]=!1,this.getZr().wakeUp();else{try{zp(this),Mc.update.call(this,null,f)}catch(h){throw this[Ga]=null,this[ia]=!1,h}this._ssr||this._zr.flush(),this[Ga]=null,this[ia]=!1,Yv.call(this,a),Zv.call(this,a)}}},e.prototype.setTheme=function(){},e.prototype.getModel=function(){return this._model},e.prototype.getOption=function(){return this._model&&this._model.getOption()},e.prototype.getWidth=function(){return this._zr.getWidth()},e.prototype.getHeight=function(){return this._zr.getHeight()},e.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||In.hasGlobalWindow&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(t){return this.renderToCanvas(t)},e.prototype.renderToCanvas=function(t){t=t||{};var r=this._zr.painter;return r.getRenderedCanvas({backgroundColor:t.backgroundColor||this._model.get("backgroundColor"),pixelRatio:t.pixelRatio||this.getDevicePixelRatio()})},e.prototype.renderToSVGString=function(t){t=t||{};var r=this._zr.painter;return r.renderToString({useViewBox:t.useViewBox})},e.prototype.getSvgDataURL=function(){if(In.svgSupported){var t=this._zr,r=t.storage.getDisplayList();return ce(r,function(i){i.stopAnimation(null,!0)}),t.painter.toDataURL()}},e.prototype.getDataURL=function(t){if(this._disposed){this.id;return}t=t||{};var r=t.excludeComponents,i=this._model,a=[],s=this;ce(r,function(l){i.eachComponent({mainType:l},function(u){var c=s._componentsMap[u.__viewId];c.group.ignore||(a.push(c),c.group.ignore=!0)})});var o=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return ce(a,function(l){l.group.ignore=!1}),o},e.prototype.getConnectedDataURL=function(t){if(this._disposed){this.id;return}var r=t.type==="svg",i=this.group,a=Math.min,s=Math.max,o=1/0;if(yV[i]){var l=o,u=o,c=-o,f=-o,h=[],d=t&&t.pixelRatio||this.getDevicePixelRatio();ce(r0,function(x,b){if(x.group===i){var S=r?x.getZr().painter.getSvgDom().innerHTML:x.renderToCanvas(wn(t)),T=x.getDom().getBoundingClientRect();l=a(T.left,l),u=a(T.top,u),c=s(T.right,c),f=s(T.bottom,f),h.push({dom:S,left:T.left,top:T.top})}}),l*=d,u*=d,c*=d,f*=d;var p=c-l,m=f-u,g=zg.createCanvas(),v=xU(g,{renderer:r?"svg":"canvas"});if(v.resize({width:p,height:m}),r){var _="";return ce(h,function(x){var b=x.left-l,S=x.top-u;_+='<g transform="translate('+b+","+S+')">'+x.dom+"</g>"}),v.painter.getSvgRoot().innerHTML=_,t.connectedBackgroundColor&&v.painter.setBackgroundColor(t.connectedBackgroundColor),v.refreshImmediately(),v.painter.toDataURL()}else return t.connectedBackgroundColor&&v.add(new oi({shape:{x:0,y:0,width:p,height:m},style:{fill:t.connectedBackgroundColor}})),ce(h,function(x){var b=new zd({style:{x:x.left*d-l,y:x.top*d-u,image:x.dom}});v.add(b)}),v.refreshImmediately(),g.toDataURL("image/"+(t&&t.type||"png"))}else return this.getDataURL(t)},e.prototype.convertToPixel=function(t,r){return BE(this,"convertToPixel",t,r)},e.prototype.convertFromPixel=function(t,r){return BE(this,"convertFromPixel",t,r)},e.prototype.containPixel=function(t,r){if(this._disposed){this.id;return}var i=this._model,a,s=Yy(i,t);return ce(s,function(o,l){l.indexOf("Models")>=0&&ce(o,function(u){var c=u.coordinateSystem;if(c&&c.containPoint)a=a||!!c.containPoint(r);else if(l==="seriesModels"){var f=this._chartsMap[u.__viewId];f&&f.containPoint&&(a=a||f.containPoint(r,u))}},this)},this),!!a},e.prototype.getVisual=function(t,r){var i=this._model,a=Yy(i,t,{defaultMainType:"series"}),s=a.seriesModel,o=s.getData(),l=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?o.indexOfRawIndex(a.dataIndex):null;return l!=null?_Ie(o,l,r):xIe(o,r)},e.prototype.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},e.prototype.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]},e.prototype._initEvents=function(){var t=this;ce(mDe,function(r){var i=function(a){var s=t.getModel(),o=a.target,l,u=r==="globalout";if(u?l={}:o&&Sy(o,function(p){var m=ar(p);if(m&&m.dataIndex!=null){var g=m.dataModel||s.getSeriesByIndex(m.seriesIndex);return l=g&&g.getDataParams(m.dataIndex,m.dataType)||{},!0}else if(m.eventData)return l=gt({},m.eventData),!0},!0),l){var c=l.componentType,f=l.componentIndex;(c==="markLine"||c==="markPoint"||c==="markArea")&&(c="series",f=l.seriesIndex);var h=c&&f!=null&&s.getComponent(c,f),d=h&&t[h.mainType==="series"?"_chartsMap":"_componentsMap"][h.__viewId];l.event=a,l.type=r,t._$eventProcessor.eventInfo={targetEl:o,packedEvent:l,model:h,view:d},t.trigger(r,l)}};i.zrEventfulCallAtLast=!0,t._zr.on(r,i,t)}),ce(n0,function(r,i){t._messageCenter.on(i,function(a){this.trigger(i,a)},t)}),ce(["selectchanged"],function(r){t._messageCenter.on(r,function(i){this.trigger(r,i)},t)}),wIe(this._messageCenter,this,this._api)},e.prototype.isDisposed=function(){return this._disposed},e.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var t=this.getDom();t&&mq(this.getDom(),lD,"");var r=this,i=r._api,a=r._model;ce(r._componentsViews,function(s){s.dispose(a,i)}),ce(r._chartsViews,function(s){s.dispose(a,i)}),r._zr.dispose(),r._dom=r._model=r._chartsMap=r._componentsMap=r._chartsViews=r._componentsViews=r._scheduler=r._api=r._zr=r._throttledZrFlush=r._theme=r._coordSysMgr=r._messageCenter=null,delete r0[r.id]},e.prototype.resize=function(t){if(!this[ia]){if(this._disposed){this.id;return}this._zr.resize(t);var r=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!r){var i=r.resetOption("media"),a=t&&t.silent;this[Ga]&&(a==null&&(a=this[Ga].silent),i=!0,this[Ga]=null),this[ia]=!0;try{i&&zp(this),Mc.update.call(this,{type:"resize",animation:gt({duration:0},t&&t.animation)})}catch(s){throw this[ia]=!1,s}this[ia]=!1,Yv.call(this,a),Zv.call(this,a)}}},e.prototype.showLoading=function(t,r){if(this._disposed){this.id;return}if(Yt(t)&&(r=t,t=""),t=t||"default",this.hideLoading(),!!Pk[t]){var i=Pk[t](this._api,r),a=this._zr;this._loadingFX=i,a.add(i)}},e.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},e.prototype.makeActionFromEvent=function(t){var r=gt({},t);return r.type=n0[t.type],r},e.prototype.dispatchAction=function(t,r){if(this._disposed){this.id;return}if(Yt(r)||(r={silent:!!r}),!!qw[t.type]&&this._model){if(this[ia]){this._pendingActions.push(t);return}var i=r.silent;zE.call(this,t,i);var a=r.flush;a?this._zr.flush():a!==!1&&In.browser.weChat&&this._throttledZrFlush(),Yv.call(this,i),Zv.call(this,i)}},e.prototype.updateLabelLayout=function(){$o.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},e.prototype.appendData=function(t){if(this._disposed){this.id;return}var r=t.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(r);a.appendData(t),this._scheduler.unfinished=!0,this.getZr().wakeUp()},e.internalField=function(){zp=function(f){var h=f._scheduler;h.restorePipelines(f._model),h.prepareStageTasks(),FE(f,!0),FE(f,!1),h.plan()},FE=function(f,h){for(var d=f._model,p=f._scheduler,m=h?f._componentsViews:f._chartsViews,g=h?f._componentsMap:f._chartsMap,v=f._zr,_=f._api,x=0;x<m.length;x++)m[x].__alive=!1;h?d.eachComponent(function(T,M){T!=="series"&&b(M)}):d.eachSeries(b);function b(T){var M=T.__requireNewView;T.__requireNewView=!1;var C="_ec_"+T.id+"_"+T.type,k=!M&&g[C];if(!k){var R=Ll(T.type),P=h?Ps.getClass(R.main,R.sub):Ul.getClass(R.sub);k=new P,k.init(d,_),g[C]=k,m.push(k),v.add(k.group)}T.__viewId=k.__id=C,k.__alive=!0,k.__model=T,k.group.__ecComponentInfo={mainType:T.mainType,index:T.componentIndex},!h&&p.prepareView(k,T,d,_)}for(var x=0;x<m.length;){var S=m[x];S.__alive?x++:(!h&&S.renderTask.dispose(),v.remove(S.group),S.dispose(d,_),m.splice(x,1),g[S.__id]===S&&delete g[S.__id],S.__id=S.group.__ecComponentInfo=null)}},$b=function(f,h,d,p,m){var g=f._model;if(g.setUpdatePayload(d),!p){ce([].concat(f._componentsViews).concat(f._chartsViews),S);return}var v={};v[p+"Id"]=d[p+"Id"],v[p+"Index"]=d[p+"Index"],v[p+"Name"]=d[p+"Name"];var _={mainType:p,query:v};m&&(_.subType=m);var x=d.excludeSeriesId,b;x!=null&&(b=dn(),ce(ci(x),function(T){var M=Fl(T,null);M!=null&&b.set(M,!0)})),g&&g.eachComponent(_,function(T){var M=b&&b.get(T.id)!=null;if(!M)if(ZU(d))if(T instanceof yf)d.type===td&&!d.notBlur&&!T.get(["emphasis","disabled"])&&JMe(T,d,f._api);else{var C=LI(T.mainType,T.componentIndex,d.name,f._api),k=C.focusSelf,R=C.dispatchers;d.type===td&&k&&!d.notBlur&&uk(T.mainType,T.componentIndex,f._api),R&&ce(R,function(P){d.type===td?og(P):lg(P)})}else hk(d)&&T instanceof yf&&(nke(T,d,f._api),KU(T),Bs(f))},f),g&&g.eachComponent(_,function(T){var M=b&&b.get(T.id)!=null;M||S(f[p==="series"?"_chartsMap":"_componentsMap"][T.__viewId])},f);function S(T){T&&T.__alive&&T[h]&&T[h](T.__model,g,f._api,d)}},Mc={prepareAndUpdate:function(f){zp(this),Mc.update.call(this,f,{optionChanged:f.newOption!=null})},update:function(f,h){var d=this._model,p=this._api,m=this._zr,g=this._coordSysMgr,v=this._scheduler;if(d){d.setUpdatePayload(f),v.restoreData(d,f),v.performSeriesTasks(d),g.create(d,p),v.performDataProcessorTasks(d,f),UE(this,d),g.update(d,p),t(d),v.performVisualTasks(d,f),VE(this,d,p,f,h);var _=d.get("backgroundColor")||"transparent",x=d.get("darkMode");m.setBackgroundColor(_),x!=null&&x!=="auto"&&m.setDarkMode(x),$o.trigger("afterupdate",d,p)}},updateTransform:function(f){var h=this,d=this._model,p=this._api;if(d){d.setUpdatePayload(f);var m=[];d.eachComponent(function(v,_){if(v!=="series"){var x=h.getViewOfComponentModel(_);if(x&&x.__alive)if(x.updateTransform){var b=x.updateTransform(_,d,p,f);b&&b.update&&m.push(x)}else m.push(x)}});var g=dn();d.eachSeries(function(v){var _=h._chartsMap[v.__viewId];if(_.updateTransform){var x=_.updateTransform(v,d,p,f);x&&x.update&&g.set(v.uid,1)}else g.set(v.uid,1)}),t(d),this._scheduler.performVisualTasks(d,f,{setDirty:!0,dirtyMap:g}),Fb(this,d,p,f,{},g),$o.trigger("afterupdate",d,p)}},updateView:function(f){var h=this._model;h&&(h.setUpdatePayload(f),Ul.markUpdateMethod(f,"updateView"),t(h),this._scheduler.performVisualTasks(h,f,{setDirty:!0}),VE(this,h,this._api,f,{}),$o.trigger("afterupdate",h,this._api))},updateVisual:function(f){var h=this,d=this._model;d&&(d.setUpdatePayload(f),d.eachSeries(function(p){p.getData().clearAllVisual()}),Ul.markUpdateMethod(f,"updateVisual"),t(d),this._scheduler.performVisualTasks(d,f,{visualType:"visual",setDirty:!0}),d.eachComponent(function(p,m){if(p!=="series"){var g=h.getViewOfComponentModel(m);g&&g.__alive&&g.updateVisual(m,d,h._api,f)}}),d.eachSeries(function(p){var m=h._chartsMap[p.__viewId];m.updateVisual(p,d,h._api,f)}),$o.trigger("afterupdate",d,this._api))},updateLayout:function(f){Mc.update.call(this,f)}},BE=function(f,h,d,p){if(f._disposed){f.id;return}for(var m=f._model,g=f._coordSysMgr.getCoordinateSystems(),v,_=Yy(m,d),x=0;x<g.length;x++){var b=g[x];if(b[h]&&(v=b[h](m,_,p))!=null)return v}},UE=function(f,h){var d=f._chartsMap,p=f._scheduler;h.eachSeries(function(m){p.updateStreamModes(m,d[m.__viewId])})},zE=function(f,h){var d=this,p=this.getModel(),m=f.type,g=f.escapeConnect,v=qw[m],_=v.actionInfo,x=(_.update||"update").split(":"),b=x.pop(),S=x[0]!=null&&Ll(x[0]);this[ia]=!0;var T=[f],M=!1;f.batch&&(M=!0,T=Nt(f.batch,function(F){return F=ln(gt({},F),f),F.batch=null,F}));var C=[],k,R=hk(f),P=ZU(f);if(P&&Uq(this._api),ce(T,function(F){if(k=v.action(F,d._model,d._api),k=k||gt({},F),k.type=_.event||k.type,C.push(k),P){var O=kI(f),B=O.queryOptionMap,H=O.mainTypeSpecified,j=H?B.keys()[0]:"series";$b(d,b,F,j),Bs(d)}else R?($b(d,b,F,"series"),Bs(d)):S&&$b(d,b,F,S.main,S.sub)}),b!=="none"&&!P&&!R&&!S)try{this[Ga]?(zp(this),Mc.update.call(this,f),this[Ga]=null):Mc[b].call(this,f)}catch(F){throw this[ia]=!1,F}if(M?k={type:_.event||m,escapeConnect:g,batch:C}:k=C[0],this[ia]=!1,!h){var N=this._messageCenter;if(N.trigger(k.type,k),R){var L={type:"selectchanged",escapeConnect:g,selected:rke(p),isFromClick:f.isFromClick||!1,fromAction:f.type,fromActionPayload:f};N.trigger(L.type,L)}}},Yv=function(f){for(var h=this._pendingActions;h.length;){var d=h.shift();zE.call(this,d,f)}},Zv=function(f){!f&&this.trigger("updated")},dV=function(f,h){f.on("rendered",function(d){h.trigger("rendered",d),f.animation.isFinished()&&!h[Ga]&&!h._scheduler.unfinished&&!h._pendingActions.length&&h.trigger("finished")})},pV=function(f,h){f.on("mouseover",function(d){var p=d.target,m=Sy(p,fk);m&&(eke(m,d,h._api),Bs(h))}).on("mouseout",function(d){var p=d.target,m=Sy(p,fk);m&&(tke(m,d,h._api),Bs(h))}).on("click",function(d){var p=d.target,m=Sy(p,function(_){return ar(_).dataIndex!=null},!0);if(m){var g=m.selected?"unselect":"select",v=ar(m);h._api.dispatchAction({type:g,dataType:v.dataType,dataIndexInside:v.dataIndex,seriesIndex:v.seriesIndex,isFromClick:!0})}})};function t(f){f.clearColorPalette(),f.eachSeries(function(h){h.clearColorPalette()})}function r(f){var h=[],d=[],p=!1;if(f.eachComponent(function(_,x){var b=x.get("zlevel")||0,S=x.get("z")||0,T=x.getZLevelKey();p=p||!!T,(_==="series"?d:h).push({zlevel:b,z:S,idx:x.componentIndex,type:_,key:T})}),p){var m=h.concat(d),g,v;H1(m,function(_,x){return _.zlevel===x.zlevel?_.z-x.z:_.zlevel-x.zlevel}),ce(m,function(_){var x=f.getComponent(_.type,_.idx),b=_.zlevel,S=_.key;g!=null&&(b=Math.max(g,b)),S?(b===g&&S!==v&&b++,v=S):v&&(b===g&&b++,v=""),g=b,x.setZLevel(b)})}}VE=function(f,h,d,p,m){r(h),mV(f,h,d,p,m),ce(f._chartsViews,function(g){g.__alive=!1}),Fb(f,h,d,p,m),ce(f._chartsViews,function(g){g.__alive||g.remove(h,d)})},mV=function(f,h,d,p,m,g){ce(g||f._componentsViews,function(v){var _=v.__model;u(_,v),v.render(_,h,d,p),o(_,v),c(_,v)})},Fb=function(f,h,d,p,m,g){var v=f._scheduler;m=gt(m||{},{updatedSeries:h.getSeries()}),$o.trigger("series:beforeupdate",h,d,m);var _=!1;h.eachSeries(function(x){var b=f._chartsMap[x.__viewId];b.__alive=!0;var S=b.renderTask;v.updatePayload(S,p),u(x,b),g&&g.get(x.uid)&&S.dirty(),S.perform(v.getPerformArgs(S))&&(_=!0),b.group.silent=!!x.get("silent"),s(x,b),KU(x)}),v.unfinished=_||v.unfinished,$o.trigger("series:layoutlabels",h,d,m),$o.trigger("series:transition",h,d,m),h.eachSeries(function(x){var b=f._chartsMap[x.__viewId];o(x,b),c(x,b)}),a(f,h),$o.trigger("series:afterupdate",h,d,m)},Bs=function(f){f[OE]=!0,f.getZr().wakeUp()},vV=function(f){f[OE]&&(f.getZr().storage.traverse(function(h){Dm(h)||i(h)}),f[OE]=!1)};function i(f){for(var h=[],d=f.currentStates,p=0;p<d.length;p++){var m=d[p];m==="emphasis"||m==="blur"||m==="select"||h.push(m)}f.selected&&f.states.select&&h.push("select"),f.hoverState===xT&&f.states.emphasis?h.push("emphasis"):f.hoverState===_T&&f.states.blur&&h.push("blur"),f.useStates(h)}function a(f,h){var d=f._zr,p=d.storage,m=0;p.traverse(function(g){g.isGroup||m++}),m>h.get("hoverLayerThreshold")&&!In.node&&!In.worker&&h.eachSeries(function(g){if(!g.preventUsingHoverLayer){var v=f._chartsMap[g.__viewId];v.__alive&&v.eachRendered(function(_){_.states.emphasis&&(_.states.emphasis.hoverLayer=!0)})}})}function s(f,h){var d=f.get("blendMode")||null;h.eachRendered(function(p){p.isGroup||(p.style.blend=d)})}function o(f,h){if(!f.preventAutoZ){var d=f.get("z")||0,p=f.get("zlevel")||0;h.eachRendered(function(m){return l(m,d,p,-1/0),!0})}}function l(f,h,d,p){var m=f.getTextContent(),g=f.getTextGuideLine(),v=f.isGroup;if(v)for(var _=f.childrenRef(),x=0;x<_.length;x++)p=Math.max(l(_[x],h,d,p),p);else f.z=h,f.zlevel=d,p=Math.max(f.z2,p);if(m&&(m.z=h,m.zlevel=d,isFinite(p)&&(m.z2=p+2)),g){var b=f.textGuideLineConfig;g.z=h,g.zlevel=d,isFinite(p)&&(g.z2=p+(b&&b.showAbove?1:-1))}return p}function u(f,h){h.eachRendered(function(d){if(!Dm(d)){var p=d.getTextContent(),m=d.getTextGuideLine();d.stateTransition&&(d.stateTransition=null),p&&p.stateTransition&&(p.stateTransition=null),m&&m.stateTransition&&(m.stateTransition=null),d.hasState()?(d.prevStates=d.currentStates,d.clearStates()):d.prevStates&&(d.prevStates=null)}})}function c(f,h){var d=f.getModel("stateAnimation"),p=f.isAnimationEnabled(),m=d.get("duration"),g=m>0?{duration:m,delay:d.get("delay"),easing:d.get("easing")}:null;h.eachRendered(function(v){if(v.states&&v.states.emphasis){if(Dm(v))return;if(v instanceof Wn&&lke(v),v.__dirty){var _=v.prevStates;_&&v.useStates(_)}if(p){v.stateTransition=g;var x=v.getTextContent(),b=v.getTextGuideLine();x&&(x.stateTransition=g),b&&(b.stateTransition=g)}v.__dirty&&i(v)}})}gV=function(f){return new(function(h){ht(d,h);function d(){return h!==null&&h.apply(this,arguments)||this}return d.prototype.getCoordinateSystems=function(){return f._coordSysMgr.getCoordinateSystems()},d.prototype.getComponentByElement=function(p){for(;p;){var m=p.__ecComponentInfo;if(m!=null)return f._model.getComponent(m.mainType,m.index);p=p.parent}},d.prototype.enterEmphasis=function(p,m){og(p,m),Bs(f)},d.prototype.leaveEmphasis=function(p,m){lg(p,m),Bs(f)},d.prototype.enterBlur=function(p){QMe(p),Bs(f)},d.prototype.leaveBlur=function(p){Oq(p),Bs(f)},d.prototype.enterSelect=function(p){$q(p),Bs(f)},d.prototype.leaveSelect=function(p){Fq(p),Bs(f)},d.prototype.getModel=function(){return f.getModel()},d.prototype.getViewOfComponentModel=function(p){return f.getViewOfComponentModel(p)},d.prototype.getViewOfSeriesModel=function(p){return f.getViewOfSeriesModel(p)},d}(BX))(f)},DK=function(f){function h(d,p){for(var m=0;m<d.length;m++){var g=d[m];g[$E]=p}}ce(n0,function(d,p){f._messageCenter.on(p,function(m){if(yV[f.group]&&f[$E]!==hV){if(m&&m.escapeConnect)return;var g=f.makeActionFromEvent(m),v=[];ce(r0,function(_){_!==f&&_.group===f.group&&v.push(_)}),h(v,hV),ce(v,function(_){_[$E]!==dDe&&_.dispatchAction(g)}),h(v,pDe)}})})}}(),e}(ul),oD=LK.prototype;oD.on=MK("on");oD.off=MK("off");oD.one=function(n,e,t){var r=this;function i(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];e&&e.apply&&e.apply(this,a),r.off(n,i)}this.on.call(this,n,i,t)};var mDe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var qw={},n0={},kk=[],Rk=[],Xw=[],NK={},Pk={},r0={},yV={},gDe=+new Date-0,lD="_echarts_instance_";function iit(n,e,t){var r=!(t&&t.ssr);if(r){var i=vDe(n);if(i)return i}var a=new LK(n,e,t);return a.id="ec_"+gDe++,r0[a.id]=a,r&&mq(n,lD,a.id),DK(a),$o.trigger("afterinit",a),a}function vDe(n){return r0[BAe(n,lD)]}function OK(n,e){NK[n]=e}function $K(n){Vn(Rk,n)<0&&Rk.push(n)}function FK(n,e){cD(kk,n,e,aDe)}function yDe(n){uD("afterinit",n)}function _De(n){uD("afterupdate",n)}function uD(n,e){$o.on(n,e)}function nu(n,e,t){pn(e)&&(t=e,e="");var r=Yt(n)?n.type:[n,n={event:e}][0];n.event=(n.event||r).toLowerCase(),e=n.event,!n0[e]&&(ql(fV.test(r)&&fV.test(e)),qw[r]||(qw[r]={action:t,actionInfo:n}),n0[e]=r)}function xDe(n,e){ZI.register(n,e)}function bDe(n,e){cD(Xw,n,e,CK,"layout")}function Hd(n,e){cD(Xw,n,e,EK,"visual")}var _V=[];function cD(n,e,t,r,i){if((pn(e)||Yt(e))&&(t=e,e=r),!(Vn(_V,t)>=0)){_V.push(t);var a=pK.wrapStageHandler(t,i);a.__prio=e,a.__raw=t,n.push(a)}}function BK(n,e){Pk[n]=e}function wDe(n,e,t){var r=eDe("registerMap");r&&r(n,e,t)}var SDe=APe;Hd(sD,eIe);Hd(BT,tIe);Hd(BT,nIe);Hd(sD,vIe);Hd(BT,yIe);Hd(AK,ZIe);$K(zX);FK(rDe,sPe);BK("default",rIe);nu({type:td,event:td,update:td},Oa);nu({type:Y1,event:Y1,update:Y1},Oa);nu({type:Zy,event:Zy,update:Zy},Oa);nu({type:Z1,event:Z1,update:Z1},Oa);nu({type:Qy,event:Qy,update:Qy},Oa);OK("light",pIe);OK("dark",mIe);function Qv(n){return n==null?0:n.length||1}function xV(n){return n}var TDe=function(){function n(e,t,r,i,a,s){this._old=e,this._new=t,this._oldKeyGetter=r||xV,this._newKeyGetter=i||xV,this.context=a,this._diffModeMultiple=s==="multiple"}return n.prototype.add=function(e){return this._add=e,this},n.prototype.update=function(e){return this._update=e,this},n.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},n.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},n.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},n.prototype.remove=function(e){return this._remove=e,this},n.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},n.prototype._executeOneToOne=function(){var e=this._old,t=this._new,r={},i=new Array(e.length),a=new Array(t.length);this._initIndexMap(e,null,i,"_oldKeyGetter"),this._initIndexMap(t,r,a,"_newKeyGetter");for(var s=0;s<e.length;s++){var o=i[s],l=r[o],u=Qv(l);if(u>1){var c=l.shift();l.length===1&&(r[o]=l[0]),this._update&&this._update(c,s)}else u===1?(r[o]=null,this._update&&this._update(l,s)):this._remove&&this._remove(s)}this._performRestAdd(a,r)},n.prototype._executeMultiple=function(){var e=this._old,t=this._new,r={},i={},a=[],s=[];this._initIndexMap(e,r,a,"_oldKeyGetter"),this._initIndexMap(t,i,s,"_newKeyGetter");for(var o=0;o<a.length;o++){var l=a[o],u=r[l],c=i[l],f=Qv(u),h=Qv(c);if(f>1&&h===1)this._updateManyToOne&&this._updateManyToOne(c,u),i[l]=null;else if(f===1&&h>1)this._updateOneToMany&&this._updateOneToMany(c,u),i[l]=null;else if(f===1&&h===1)this._update&&this._update(c,u),i[l]=null;else if(f>1&&h>1)this._updateManyToMany&&this._updateManyToMany(c,u),i[l]=null;else if(f>1)for(var d=0;d<f;d++)this._remove&&this._remove(u[d]);else this._remove&&this._remove(u)}this._performRestAdd(s,i)},n.prototype._performRestAdd=function(e,t){for(var r=0;r<e.length;r++){var i=e[r],a=t[i],s=Qv(a);if(s>1)for(var o=0;o<s;o++)this._add&&this._add(a[o]);else s===1&&this._add&&this._add(a);t[i]=null}},n.prototype._initIndexMap=function(e,t,r,i){for(var a=this._diffModeMultiple,s=0;s<e.length;s++){var o="_ec_"+this[i](e[s],s);if(a||(r[s]=o),!!t){var l=t[o],u=Qv(l);u===0?(t[o]=s,a&&r.push(o)):u===1?t[o]=[l,s]:l.push(s)}}},n}();const Y0=TDe;var CDe=function(){function n(e,t){this._encode=e,this._schema=t}return n.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},n.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},n}();function EDe(n,e){var t={},r=t.encode={},i=dn(),a=[],s=[],o={};ce(n.dimensions,function(h){var d=n.getDimensionInfo(h),p=d.coordDim;if(p){var m=d.coordDimIndex;HE(r,p)[m]=h,d.isExtraCoord||(i.set(p,1),MDe(d.type)&&(a[0]=h),HE(o,p)[m]=n.getDimensionIndex(d.name)),d.defaultTooltip&&s.push(h)}IX.each(function(g,v){var _=HE(r,v),x=d.otherDims[v];x!=null&&x!==!1&&(_[x]=d.name)})});var l=[],u={};i.each(function(h,d){var p=r[d];u[d]=p[0],l=l.concat(p)}),t.dataDimsOnCoord=l,t.dataDimIndicesOnCoord=Nt(l,function(h){return n.getDimensionInfo(h).storeDimIndex}),t.encodeFirstDimNotExtra=u;var c=r.label;c&&c.length&&(a=c.slice());var f=r.tooltip;return f&&f.length?s=f.slice():s.length||(s=a.slice()),r.defaultedLabel=a,r.defaultedTooltip=s,t.userOutput=new CDe(o,e),t}function HE(n,e){return n.hasOwnProperty(e)||(n[e]=[]),n[e]}function ADe(n){return n==="category"?"ordinal":n==="time"?"time":"float"}function MDe(n){return!(n==="ordinal"||n==="time")}var kDe=function(){function n(e){this.otherDims={},e!=null&&gt(this,e)}return n}();const nw=kDe;var RDe=qr(),PDe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},UK=function(){function n(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return n.prototype.isDimensionOmitted=function(){return this._dimOmitted},n.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=HK(this.source)))},n.prototype.getSourceDimensionIndex=function(e){return Hn(this._dimNameMap.get(e),-1)},n.prototype.getSourceDimension=function(e){var t=this.source.dimensionsDefine;if(t)return t[e]},n.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,t=HX(this.source),r=!WK(e),i="",a=[],s=0,o=0;s<e;s++){var l=void 0,u=void 0,c=void 0,f=this.dimensions[o];if(f&&f.storeDimIndex===s)l=t?f.name:null,u=f.type,c=f.ordinalMeta,o++;else{var h=this.getSourceDimension(s);h&&(l=t?h.name:null,u=h.type)}a.push({property:l,type:u,ordinalMeta:c}),t&&l!=null&&(!f||!f.isCalculationCoord)&&(i+=r?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),i+="$",i+=PDe[u]||"f",c&&(i+=c.uid),i+="$"}var d=this.source,p=[d.seriesLayoutBy,d.startIndex,i].join("$$");return{dimensions:a,hash:p}},n.prototype.makeOutputDimensionNames=function(){for(var e=[],t=0,r=0;t<this._fullDimCount;t++){var i=void 0,a=this.dimensions[r];if(a&&a.storeDimIndex===t)a.isCalculationCoord||(i=a.name),r++;else{var s=this.getSourceDimension(t);s&&(i=s.name)}e.push(i)}return e},n.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},n}();function zK(n){return n instanceof UK}function VK(n){for(var e=dn(),t=0;t<(n||[]).length;t++){var r=n[t],i=Yt(r)?r.name:r;i!=null&&e.get(i)==null&&e.set(i,t)}return e}function HK(n){var e=RDe(n);return e.dimNameMap||(e.dimNameMap=VK(n.dimensionsDefine))}function WK(n){return n>30}var Jv=Yt,kc=Nt,IDe=typeof Int32Array>"u"?Array:Int32Array,DDe="e\0\0",bV=-1,LDe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],NDe=["_approximateExtent"],wV,Bb,ey,ty,WE,Ub,GE,ODe=function(){function n(e,t){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var r,i=!1;zK(e)?(r=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(i=!0,r=e),r=r||["x","y"];for(var a={},s=[],o={},l=!1,u={},c=0;c<r.length;c++){var f=r[c],h=jt(f)?new nw({name:f}):f instanceof nw?f:new nw(f),d=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=d,h.coordDimIndex=0);var p=h.otherDims=h.otherDims||{};s.push(d),a[d]=h,u[d]!=null&&(l=!0),h.createInvertedIndices&&(o[d]=[]),p.itemName===0&&(this._nameDimIdx=c),p.itemId===0&&(this._idDimIdx=c),i&&(h.storeDimIndex=c)}if(this.dimensions=s,this._dimInfos=a,this._initGetDimensionInfo(l),this.hostModel=t,this._invertedIndicesMap=o,this._dimOmitted){var m=this._dimIdxToName=dn();ce(s,function(g){m.set(a[g].storeDimIndex,g)})}}return n.prototype.getDimension=function(e){var t=this._recognizeDimIndex(e);if(t==null)return e;if(t=e,!this._dimOmitted)return this.dimensions[t];var r=this._dimIdxToName.get(t);if(r!=null)return r;var i=this._schema.getSourceDimension(t);if(i)return i.name},n.prototype.getDimensionIndex=function(e){var t=this._recognizeDimIndex(e);if(t!=null)return t;if(e==null)return-1;var r=this._getDimInfo(e);return r?r.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},n.prototype._recognizeDimIndex=function(e){if(gr(e)||e!=null&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},n.prototype._getStoreDimIndex=function(e){var t=this.getDimensionIndex(e);return t},n.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},n.prototype._initGetDimensionInfo=function(e){var t=this._dimInfos;this._getDimInfo=e?function(r){return t.hasOwnProperty(r)?t[r]:void 0}:function(r){return t[r]}},n.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},n.prototype.mapDimension=function(e,t){var r=this._dimSummary;if(t==null)return r.encodeFirstDimNotExtra[e];var i=r.encode[e];return i?i[t]:null},n.prototype.mapDimensionsAll=function(e){var t=this._dimSummary,r=t.encode[e];return(r||[]).slice()},n.prototype.getStore=function(){return this._store},n.prototype.initData=function(e,t,r){var i=this,a;if(e instanceof _k&&(a=e),!a){var s=this.dimensions,o=QI(e)||Fa(e)?new WX(e,s.length):e;a=new _k;var l=kc(s,function(u){return{type:i._dimInfos[u].type,property:u}});a.initData(o,l,r)}this._store=a,this._nameList=(t||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=EDe(this,this._schema),this.userOutput=this._dimSummary.userOutput},n.prototype.appendData=function(e){var t=this._store.appendData(e);this._doInit(t[0],t[1])},n.prototype.appendValues=function(e,t){var r=this._store.appendValues(e,t.length),i=r.start,a=r.end,s=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),t)for(var o=i;o<a;o++){var l=o-i;this._nameList[o]=t[l],s&&GE(this,o)}},n.prototype._updateOrdinalMeta=function(){for(var e=this._store,t=this.dimensions,r=0;r<t.length;r++){var i=this._dimInfos[t[r]];i.ordinalMeta&&e.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},n.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return this._idDimIdx==null&&e.getSource().sourceFormat!==af&&!e.fillStorage},n.prototype._doInit=function(e,t){if(!(e>=t)){var r=this._store,i=r.getProvider();this._updateOrdinalMeta();var a=this._nameList,s=this._idList,o=i.getSource().sourceFormat,l=o===wo;if(l&&!i.pure)for(var u=[],c=e;c<t;c++){var f=i.getItem(c,u);if(!this.hasItemOption&&EAe(f)&&(this.hasItemOption=!0),f){var h=f.name;a[c]==null&&h!=null&&(a[c]=Fl(h,null));var d=f.id;s[c]==null&&d!=null&&(s[c]=Fl(d,null))}}if(this._shouldMakeIdFromName())for(var c=e;c<t;c++)GE(this,c);wV(this)}},n.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},n.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},n.prototype.setCalculationInfo=function(e,t){Jv(e)?gt(this._calculationInfo,e):this._calculationInfo[e]=t},n.prototype.getName=function(e){var t=this.getRawIndex(e),r=this._nameList[t];return r==null&&this._nameDimIdx!=null&&(r=ey(this,this._nameDimIdx,t)),r==null&&(r=""),r},n.prototype._getCategory=function(e,t){var r=this._store.get(e,t),i=this._store.getOrdinalMeta(e);return i?i.categories[r]:r},n.prototype.getId=function(e){return Bb(this,this.getRawIndex(e))},n.prototype.count=function(){return this._store.count()},n.prototype.get=function(e,t){var r=this._store,i=this._dimInfos[e];if(i)return r.get(i.storeDimIndex,t)},n.prototype.getByRawIndex=function(e,t){var r=this._store,i=this._dimInfos[e];if(i)return r.getByRawIndex(i.storeDimIndex,t)},n.prototype.getIndices=function(){return this._store.getIndices()},n.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},n.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},n.prototype.getValues=function(e,t){var r=this,i=this._store;return Rt(e)?i.getValues(kc(e,function(a){return r._getStoreDimIndex(a)}),t):i.getValues(e)},n.prototype.hasValue=function(e){for(var t=this._dimSummary.dataDimIndicesOnCoord,r=0,i=t.length;r<i;r++)if(isNaN(this._store.get(t[r],e)))return!1;return!0},n.prototype.indexOfName=function(e){for(var t=0,r=this._store.count();t<r;t++)if(this.getName(t)===e)return t;return-1},n.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},n.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},n.prototype.rawIndexOf=function(e,t){var r=e&&this._invertedIndicesMap[e],i=r[t];return i==null||isNaN(i)?bV:i},n.prototype.indicesOfNearest=function(e,t,r){return this._store.indicesOfNearest(this._getStoreDimIndex(e),t,r)},n.prototype.each=function(e,t,r){pn(e)&&(r=t,t=e,e=[]);var i=r||this,a=kc(ty(e),this._getStoreDimIndex,this);this._store.each(a,i?Rr(t,i):t)},n.prototype.filterSelf=function(e,t,r){pn(e)&&(r=t,t=e,e=[]);var i=r||this,a=kc(ty(e),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?Rr(t,i):t),this},n.prototype.selectRange=function(e){var t=this,r={},i=Wr(e);return ce(i,function(a){var s=t._getStoreDimIndex(a);r[s]=e[a]}),this._store=this._store.selectRange(r),this},n.prototype.mapArray=function(e,t,r){pn(e)&&(r=t,t=e,e=[]),r=r||this;var i=[];return this.each(e,function(){i.push(t&&t.apply(this,arguments))},r),i},n.prototype.map=function(e,t,r,i){var a=r||i||this,s=kc(ty(e),this._getStoreDimIndex,this),o=Ub(this);return o._store=this._store.map(s,a?Rr(t,a):t),o},n.prototype.modify=function(e,t,r,i){var a=r||i||this,s=kc(ty(e),this._getStoreDimIndex,this);this._store.modify(s,a?Rr(t,a):t)},n.prototype.downSample=function(e,t,r,i){var a=Ub(this);return a._store=this._store.downSample(this._getStoreDimIndex(e),t,r,i),a},n.prototype.lttbDownSample=function(e,t){var r=Ub(this);return r._store=this._store.lttbDownSample(this._getStoreDimIndex(e),t),r},n.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},n.prototype.getItemModel=function(e){var t=this.hostModel,r=this.getRawDataItem(e);return new Fi(r,t,t&&t.ecModel)},n.prototype.diff=function(e){var t=this;return new Y0(e?e.getStore().getIndices():[],this.getStore().getIndices(),function(r){return Bb(e,r)},function(r){return Bb(t,r)})},n.prototype.getVisual=function(e){var t=this._visual;return t&&t[e]},n.prototype.setVisual=function(e,t){this._visual=this._visual||{},Jv(e)?gt(this._visual,e):this._visual[e]=t},n.prototype.getItemVisual=function(e,t){var r=this._itemVisuals[e],i=r&&r[t];return i??this.getVisual(t)},n.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},n.prototype.ensureUniqueItemVisual=function(e,t){var r=this._itemVisuals,i=r[e];i||(i=r[e]={});var a=i[t];return a==null&&(a=this.getVisual(t),Rt(a)?a=a.slice():Jv(a)&&(a=gt({},a)),i[t]=a),a},n.prototype.setItemVisual=function(e,t,r){var i=this._itemVisuals[e]||{};this._itemVisuals[e]=i,Jv(t)?gt(i,t):i[t]=r},n.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},n.prototype.setLayout=function(e,t){Jv(e)?gt(this._layout,e):this._layout[e]=t},n.prototype.getLayout=function(e){return this._layout[e]},n.prototype.getItemLayout=function(e){return this._itemLayouts[e]},n.prototype.setItemLayout=function(e,t,r){this._itemLayouts[e]=r?gt(this._itemLayouts[e]||{},t):t},n.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},n.prototype.setItemGraphicEl=function(e,t){var r=this.hostModel&&this.hostModel.seriesIndex;VMe(r,this.dataType,e,t),this._graphicEls[e]=t},n.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},n.prototype.eachItemGraphicEl=function(e,t){ce(this._graphicEls,function(r,i){r&&e&&e.call(t,r,i)})},n.prototype.cloneShallow=function(e){return e||(e=new n(this._schema?this._schema:kc(this.dimensions,this._getDimInfo,this),this.hostModel)),WE(e,this),e._store=this._store,e},n.prototype.wrapMethod=function(e,t){var r=this[e];pn(r)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var i=r.apply(this,arguments);return t.apply(this,[i].concat(bI(arguments)))})},n.internalField=function(){wV=function(e){var t=e._invertedIndicesMap;ce(t,function(r,i){var a=e._dimInfos[i],s=a.ordinalMeta,o=e._store;if(s){r=t[i]=new IDe(s.categories.length);for(var l=0;l<r.length;l++)r[l]=bV;for(var l=0;l<o.count();l++)r[o.get(a.storeDimIndex,l)]=l}})},ey=function(e,t,r){return Fl(e._getCategory(t,r),null)},Bb=function(e,t){var r=e._idList[t];return r==null&&e._idDimIdx!=null&&(r=ey(e,e._idDimIdx,t)),r==null&&(r=DDe+t),r},ty=function(e){return Rt(e)||(e=e!=null?[e]:[]),e},Ub=function(e){var t=new n(e._schema?e._schema:kc(e.dimensions,e._getDimInfo,e),e.hostModel);return WE(t,e),t},WE=function(e,t){ce(LDe.concat(t.__wrappedMethods||[]),function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e.__wrappedMethods=t.__wrappedMethods,ce(NDe,function(r){e[r]=wn(t[r])}),e._calculationInfo=gt({},t._calculationInfo)},GE=function(e,t){var r=e._nameList,i=e._idList,a=e._nameDimIdx,s=e._idDimIdx,o=r[t],l=i[t];if(o==null&&a!=null&&(r[t]=o=ey(e,a,t)),l==null&&s!=null&&(i[t]=l=ey(e,s,t)),l==null&&o!=null){var u=e._nameRepeatCount,c=u[o]=(u[o]||0)+1;l=o,c>1&&(l+="__ec__"+c),i[t]=l}}}(),n}();const GK=ODe;function jK(n,e){QI(n)||(n=JI(n)),e=e||{};var t=e.coordDimensions||[],r=e.dimensionsDefine||n.dimensionsDefine||[],i=dn(),a=[],s=FDe(n,t,r,e.dimensionsCount),o=e.canOmitUnusedDimensions&&WK(s),l=r===n.dimensionsDefine,u=l?HK(n):VK(r),c=e.encodeDefine;!c&&e.encodeDefaulter&&(c=e.encodeDefaulter(n,s));for(var f=dn(c),h=new QX(s),d=0;d<h.length;d++)h[d]=-1;function p(k){var R=h[k];if(R<0){var P=r[k],N=Yt(P)?P:{name:P},L=new nw,F=N.name;F!=null&&u.get(F)!=null&&(L.name=L.displayName=F),N.type!=null&&(L.type=N.type),N.displayName!=null&&(L.displayName=N.displayName);var O=a.length;return h[k]=O,L.storeDimIndex=k,a.push(L),L}return a[R]}if(!o)for(var d=0;d<s;d++)p(d);f.each(function(k,R){var P=ci(k).slice();if(P.length===1&&!jt(P[0])&&P[0]<0){f.set(R,!1);return}var N=f.set(R,[]);ce(P,function(L,F){var O=jt(L)?u.get(L):L;O!=null&&O<s&&(N[F]=O,g(p(O),R,F))})});var m=0;ce(t,function(k){var R,P,N,L;if(jt(k))R=k,L={};else{L=k,R=L.name;var F=L.ordinalMeta;L.ordinalMeta=null,L=gt({},L),L.ordinalMeta=F,P=L.dimsDef,N=L.otherDims,L.name=L.coordDim=L.coordDimIndex=L.dimsDef=L.otherDims=null}var O=f.get(R);if(O!==!1){if(O=ci(O),!O.length)for(var B=0;B<(P&&P.length||1);B++){for(;m<s&&p(m).coordDim!=null;)m++;m<s&&O.push(m++)}ce(O,function(H,j){var K=p(H);if(l&&L.type!=null&&(K.type=L.type),g(ln(K,L),R,j),K.name==null&&P){var J=P[j];!Yt(J)&&(J={name:J}),K.name=K.displayName=J.name,K.defaultTooltip=J.defaultTooltip}N&&ln(K.otherDims,N)})}});function g(k,R,P){IX.get(R)!=null?k.otherDims[R]=P:(k.coordDim=R,k.coordDimIndex=P,i.set(R,!0))}var v=e.generateCoord,_=e.generateCoordCount,x=_!=null;_=v?_||1:0;var b=v||"value";function S(k){k.name==null&&(k.name=k.coordDim)}if(o)ce(a,function(k){S(k)}),a.sort(function(k,R){return k.storeDimIndex-R.storeDimIndex});else for(var T=0;T<s;T++){var M=p(T),C=M.coordDim;C==null&&(M.coordDim=BDe(b,i,x),M.coordDimIndex=0,(!v||_<=0)&&(M.isExtraCoord=!0),_--),S(M),M.type==null&&(NX(n,T)===Hi.Must||M.isExtraCoord&&(M.otherDims.itemName!=null||M.otherDims.seriesName!=null))&&(M.type="ordinal")}return $De(a),new UK({source:n,dimensions:a,fullDimensionCount:s,dimensionOmitted:o})}function $De(n){for(var e=dn(),t=0;t<n.length;t++){var r=n[t],i=r.name,a=e.get(i)||0;a>0&&(r.name=i+(a-1)),a++,e.set(i,a)}}function FDe(n,e,t,r){var i=Math.max(n.dimensionsDetectedCount||1,e.length,t.length,r||0);return ce(e,function(a){var s;Yt(a)&&(s=a.dimsDef)&&(i=Math.max(i,s.length))}),i}function BDe(n,e,t){if(t||e.hasKey(n)){for(var r=0;e.hasKey(n+r);)r++;n+=r}return e.set(n,!0),n}var UDe=function(){function n(e){this.coordSysDims=[],this.axisMap=dn(),this.categoryAxisMap=dn(),this.coordSysName=e}return n}();function zDe(n){var e=n.get("coordinateSystem"),t=new UDe(e),r=VDe[e];if(r)return r(n,t,t.axisMap,t.categoryAxisMap),t}var VDe={cartesian2d:function(n,e,t,r){var i=n.getReferringComponents("xAxis",qi).models[0],a=n.getReferringComponents("yAxis",qi).models[0];e.coordSysDims=["x","y"],t.set("x",i),t.set("y",a),Vp(i)&&(r.set("x",i),e.firstCategoryDimIndex=0),Vp(a)&&(r.set("y",a),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(n,e,t,r){var i=n.getReferringComponents("singleAxis",qi).models[0];e.coordSysDims=["single"],t.set("single",i),Vp(i)&&(r.set("single",i),e.firstCategoryDimIndex=0)},polar:function(n,e,t,r){var i=n.getReferringComponents("polar",qi).models[0],a=i.findAxisModel("radiusAxis"),s=i.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],t.set("radius",a),t.set("angle",s),Vp(a)&&(r.set("radius",a),e.firstCategoryDimIndex=0),Vp(s)&&(r.set("angle",s),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(n,e,t,r){e.coordSysDims=["lng","lat"]},parallel:function(n,e,t,r){var i=n.ecModel,a=i.getComponent("parallel",n.get("parallelIndex")),s=e.coordSysDims=a.dimensions.slice();ce(a.parallelAxisIndex,function(o,l){var u=i.getComponent("parallelAxis",o),c=s[l];t.set(c,u),Vp(u)&&(r.set(c,u),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=l))})}};function Vp(n){return n.get("type")==="category"}function HDe(n,e,t){t=t||{};var r=t.byIndex,i=t.stackedCoordDimension,a,s,o;WDe(e)?a=e:(s=e.schema,a=s.dimensions,o=e.store);var l=!!(n&&n.get("stack")),u,c,f,h;if(ce(a,function(_,x){jt(_)&&(a[x]=_={name:_}),l&&!_.isExtraCoord&&(!r&&!u&&_.ordinalMeta&&(u=_),!c&&_.type!=="ordinal"&&_.type!=="time"&&(!i||i===_.coordDim)&&(c=_))}),c&&!r&&!u&&(r=!0),c){f="__\0ecstackresult_"+n.id,h="__\0ecstackedover_"+n.id,u&&(u.createInvertedIndices=!0);var d=c.coordDim,p=c.type,m=0;ce(a,function(_){_.coordDim===d&&m++});var g={name:f,coordDim:d,coordDimIndex:m,type:p,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},v={name:h,coordDim:h,coordDimIndex:m+1,type:p,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};s?(o&&(g.storeDimIndex=o.ensureCalculationDimension(h,p),v.storeDimIndex=o.ensureCalculationDimension(f,p)),s.appendCalculationDimension(g),s.appendCalculationDimension(v)):(a.push(g),a.push(v))}return{stackedDimension:c&&c.name,stackedByDimension:u&&u.name,isStackedByIndex:r,stackedOverDimension:h,stackResultDimension:f}}function WDe(n){return!zK(n.schema)}function xd(n,e){return!!e&&e===n.getCalculationInfo("stackedDimension")}function GDe(n,e){return xd(n,e)?n.getCalculationInfo("stackResultDimension"):e}function jDe(n,e){var t=n.get("coordinateSystem"),r=ZI.get(t),i;return e&&e.coordSysDims&&(i=Nt(e.coordSysDims,function(a){var s={name:a},o=e.axisMap.get(a);if(o){var l=o.get("type");s.type=ADe(l)}return s})),i||(i=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),i}function qDe(n,e,t){var r,i;return t&&ce(n,function(a,s){var o=a.coordDim,l=t.categoryAxisMap.get(o);l&&(r==null&&(r=s),a.ordinalMeta=l.getOrdinalMeta(),e&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&r!=null&&(n[r].otherDims.itemName=0),r}function fD(n,e,t){t=t||{};var r=e.getSourceManager(),i,a=!1;n?(a=!0,i=JI(n)):(i=r.getSource(),a=i.sourceFormat===wo);var s=zDe(e),o=jDe(e,s),l=t.useEncodeDefaulter,u=pn(l)?l:l?ir(IRe,o,e):null,c={coordDimensions:o,generateCoord:t.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!a},f=jK(i,c),h=qDe(f.dimensions,t.createInvertedIndices,s),d=a?null:r.getSharedDataStore(f),p=HDe(e,{schema:f,store:d}),m=new GK(f,e);m.setCalculationInfo(p);var g=h!=null&&XDe(i)?function(v,_,x,b){return b===h?x:this.defaultDimValueGetter(v,_,x,b)}:null;return m.hasItemOption=!1,m.initData(a?i:d,null,g),m}function XDe(n){if(n.sourceFormat===wo){var e=KDe(n.data||[]);return!Rt(k_(e))}}function KDe(n){for(var e=0;e<n.length&&n[e]==null;)e++;return n[e]}var qK=function(){function n(e){this._setting=e||{},this._extent=[1/0,-1/0]}return n.prototype.getSetting=function(e){return this._setting[e]},n.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},n.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.setExtent=function(e,t){var r=this._extent;isNaN(e)||(r[0]=e),isNaN(t)||(r[1]=t)},n.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},n.prototype.isBlank=function(){return this._isBlank},n.prototype.setBlank=function(e){this._isBlank=e},n}();gT(qK);const rc=qK;var YDe=0,ZDe=function(){function n(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++YDe}return n.createByAxisModel=function(e){var t=e.option,r=t.data,i=r&&Nt(r,QDe);return new n({categories:i,needCollect:!i,deduplication:t.dedplication!==!1})},n.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},n.prototype.parseAndCollect=function(e){var t,r=this._needCollect;if(!jt(e)&&!r)return e;if(r&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var i=this._getOrCreateMap();return t=i.get(e),t==null&&(r?(t=this.categories.length,this.categories[t]=e,i.set(e,t)):t=NaN),t},n.prototype._getOrCreateMap=function(){return this._map||(this._map=dn(this.categories))},n}();function QDe(n){return Yt(n)&&n.value!=null?n.value:n+""}const Ik=ZDe;function Dk(n){return n.type==="interval"||n.type==="log"}function JDe(n,e,t,r){var i={},a=n[1]-n[0],s=i.interval=uq(a/e,!0);t!=null&&s<t&&(s=i.interval=t),r!=null&&s>r&&(s=i.interval=r);var o=i.intervalPrecision=XK(s),l=i.niceTickExtent=[vi(Math.ceil(n[0]/s)*s,o),vi(Math.floor(n[1]/s)*s,o)];return eLe(l,n),i}function jE(n){var e=Math.pow(10,AI(n)),t=n/e;return t?t===2?t=3:t===3?t=5:t*=2:t=1,vi(t*e)}function XK(n){return Lu(n)+2}function SV(n,e,t){n[e]=Math.max(Math.min(n[e],t[1]),t[0])}function eLe(n,e){!isFinite(n[0])&&(n[0]=e[0]),!isFinite(n[1])&&(n[1]=e[1]),SV(n,0,e),SV(n,1,e),n[0]>n[1]&&(n[0]=n[1])}function UT(n,e){return n>=e[0]&&n<=e[1]}function zT(n,e){return e[1]===e[0]?.5:(n-e[0])/(e[1]-e[0])}function VT(n,e){return n*(e[1]-e[0])+e[0]}var KK=function(n){ht(e,n);function e(t){var r=n.call(this,t)||this;r.type="ordinal";var i=r.getSetting("ordinalMeta");return i||(i=new Ik({})),Rt(i)&&(i=new Ik({categories:Nt(i,function(a){return Yt(a)?a.value:a})})),r._ordinalMeta=i,r._extent=r.getSetting("extent")||[0,i.categories.length-1],r}return e.prototype.parse=function(t){return t==null?NaN:jt(t)?this._ordinalMeta.getOrdinal(t):Math.round(t)},e.prototype.contain=function(t){return t=this.parse(t),UT(t,this._extent)&&this._ordinalMeta.categories[t]!=null},e.prototype.normalize=function(t){return t=this._getTickNumber(this.parse(t)),zT(t,this._extent)},e.prototype.scale=function(t){return t=Math.round(VT(t,this._extent)),this.getRawOrdinalNumber(t)},e.prototype.getTicks=function(){for(var t=[],r=this._extent,i=r[0];i<=r[1];)t.push({value:i}),i++;return t},e.prototype.getMinorTicks=function(t){},e.prototype.setSortInfo=function(t){if(t==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var r=t.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],s=0,o=this._ordinalMeta.categories.length,l=Math.min(o,r.length);s<l;++s){var u=r[s];i[s]=u,a[u]=s}for(var c=0;s<o;++s){for(;a[c]!=null;)c++;i.push(c),a[c]=s}},e.prototype._getTickNumber=function(t){var r=this._ticksByOrdinalNumber;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getRawOrdinalNumber=function(t){var r=this._ordinalNumbersByTick;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getLabel=function(t){if(!this.isBlank()){var r=this.getRawOrdinalNumber(t.value),i=this._ordinalMeta.categories[r];return i==null?"":i+""}},e.prototype.count=function(){return this._extent[1]-this._extent[0]+1},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.isInExtentRange=function(t){return t=this._getTickNumber(t),this._extent[0]<=t&&this._extent[1]>=t},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e.prototype.calcNiceTicks=function(){},e.prototype.calcNiceExtent=function(){},e.type="ordinal",e}(rc);rc.registerClass(KK);const YK=KK;var yh=vi,ZK=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="interval",t._interval=0,t._intervalPrecision=2,t}return e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return UT(t,this._extent)},e.prototype.normalize=function(t){return zT(t,this._extent)},e.prototype.scale=function(t){return VT(t,this._extent)},e.prototype.setExtent=function(t,r){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(r)||(i[1]=parseFloat(r))},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1]),this.setExtent(r[0],r[1])},e.prototype.getInterval=function(){return this._interval},e.prototype.setInterval=function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=XK(t)},e.prototype.getTicks=function(t){var r=this._interval,i=this._extent,a=this._niceExtent,s=this._intervalPrecision,o=[];if(!r)return o;var l=1e4;i[0]<a[0]&&(t?o.push({value:yh(a[0]-r,s)}):o.push({value:i[0]}));for(var u=a[0];u<=a[1]&&(o.push({value:u}),u=yh(u+r,s),u!==o[o.length-1].value);)if(o.length>l)return[];var c=o.length?o[o.length-1].value:a[1];return i[1]>c&&(t?o.push({value:yh(c+r,s)}):o.push({value:i[1]})),o},e.prototype.getMinorTicks=function(t){for(var r=this.getTicks(!0),i=[],a=this.getExtent(),s=1;s<r.length;s++){for(var o=r[s],l=r[s-1],u=0,c=[],f=o.value-l.value,h=f/t;u<t-1;){var d=yh(l.value+(u+1)*h);d>a[0]&&d<a[1]&&c.push(d),u++}i.push(c)}return i},e.prototype.getLabel=function(t,r){if(t==null)return"";var i=r&&r.precision;i==null?i=Lu(t.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=yh(t.value,i,!0);return MX(a)},e.prototype.calcNiceTicks=function(t,r,i){t=t||5;var a=this._extent,s=a[1]-a[0];if(isFinite(s)){s<0&&(s=-s,a.reverse());var o=JDe(a,t,r,i);this._intervalPrecision=o.intervalPrecision,this._interval=o.interval,this._niceExtent=o.niceTickExtent}},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1])if(r[0]!==0){var i=Math.abs(r[0]);t.fixMax||(r[1]+=i/2),r[0]-=i/2}else r[1]=1;var a=r[1]-r[0];isFinite(a)||(r[0]=0,r[1]=1),this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval);var s=this._interval;t.fixMin||(r[0]=yh(Math.floor(r[0]/s)*s)),t.fixMax||(r[1]=yh(Math.ceil(r[1]/s)*s))},e.prototype.setNiceExtent=function(t,r){this._niceExtent=[t,r]},e.type="interval",e}(rc);rc.registerClass(ZK);const N_=ZK;var QK=typeof Float32Array<"u",tLe=QK?Float32Array:Array;function Nu(n){return Rt(n)?QK?new Float32Array(n):n:new tLe(n)}var nLe="__ec_stack_";function hD(n){return n.get("stack")||nLe+n.seriesIndex}function dD(n){return n.dim+n.index}function JK(n,e){var t=[];return e.eachSeriesByType(n,function(r){tY(r)&&t.push(r)}),t}function rLe(n){var e={};ce(n,function(l){var u=l.coordinateSystem,c=u.getBaseAxis();if(!(c.type!=="time"&&c.type!=="value"))for(var f=l.getData(),h=c.dim+"_"+c.index,d=f.getDimensionIndex(f.mapDimension(c.dim)),p=f.getStore(),m=0,g=p.count();m<g;++m){var v=p.get(d,m);e[h]?e[h].push(v):e[h]=[v]}});var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(i){i.sort(function(l,u){return l-u});for(var a=null,s=1;s<i.length;++s){var o=i[s]-i[s-1];o>0&&(a=a===null?o:Math.min(a,o))}t[r]=a}}return t}function eY(n){var e=rLe(n),t=[];return ce(n,function(r){var i=r.coordinateSystem,a=i.getBaseAxis(),s=a.getExtent(),o;if(a.type==="category")o=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var l=a.dim+"_"+a.index,u=e[l],c=Math.abs(s[1]-s[0]),f=a.scale.getExtent(),h=Math.abs(f[1]-f[0]);o=u?c/h*u:c}else{var d=r.getData();o=Math.abs(s[1]-s[0])/d.count()}var p=Jn(r.get("barWidth"),o),m=Jn(r.get("barMaxWidth"),o),g=Jn(r.get("barMinWidth")||(nY(r)?.5:1),o),v=r.get("barGap"),_=r.get("barCategoryGap");t.push({bandWidth:o,barWidth:p,barMaxWidth:m,barMinWidth:g,barGap:v,barCategoryGap:_,axisKey:dD(a),stackId:hD(r)})}),iLe(t)}function iLe(n){var e={};ce(n,function(r,i){var a=r.axisKey,s=r.bandWidth,o=e[a]||{bandWidth:s,remainedWidth:s,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=o.stacks;e[a]=o;var u=r.stackId;l[u]||o.autoWidthCount++,l[u]=l[u]||{width:0,maxWidth:0};var c=r.barWidth;c&&!l[u].width&&(l[u].width=c,c=Math.min(o.remainedWidth,c),o.remainedWidth-=c);var f=r.barMaxWidth;f&&(l[u].maxWidth=f);var h=r.barMinWidth;h&&(l[u].minWidth=h);var d=r.barGap;d!=null&&(o.gap=d);var p=r.barCategoryGap;p!=null&&(o.categoryGap=p)});var t={};return ce(e,function(r,i){t[i]={};var a=r.stacks,s=r.bandWidth,o=r.categoryGap;if(o==null){var l=Wr(a).length;o=Math.max(35-l*4,15)+"%"}var u=Jn(o,s),c=Jn(r.gap,1),f=r.remainedWidth,h=r.autoWidthCount,d=(f-u)/(h+(h-1)*c);d=Math.max(d,0),ce(a,function(v){var _=v.maxWidth,x=v.minWidth;if(v.width){var b=v.width;_&&(b=Math.min(b,_)),x&&(b=Math.max(b,x)),v.width=b,f-=b+c*b,h--}else{var b=d;_&&_<b&&(b=Math.min(_,f)),x&&x>b&&(b=x),b!==d&&(v.width=b,f-=b+c*b,h--)}}),d=(f-u)/(h+(h-1)*c),d=Math.max(d,0);var p=0,m;ce(a,function(v,_){v.width||(v.width=d),m=v,p+=v.width*(1+c)}),m&&(p-=m.width*c);var g=-p/2;ce(a,function(v,_){t[i][_]=t[i][_]||{bandWidth:s,offset:g,width:v.width},g+=v.width*(1+c)})}),t}function aLe(n,e,t){if(n&&e){var r=n[dD(e)];return r!=null&&t!=null?r[hD(t)]:r}}function sLe(n,e){var t=JK(n,e),r=eY(t);ce(t,function(i){var a=i.getData(),s=i.coordinateSystem,o=s.getBaseAxis(),l=hD(i),u=r[dD(o)][l],c=u.offset,f=u.width;a.setLayout({bandWidth:u.bandWidth,offset:c,size:f})})}function oLe(n){return{seriesType:n,plan:rD(),reset:function(e){if(tY(e)){var t=e.getData(),r=e.coordinateSystem,i=r.getBaseAxis(),a=r.getOtherAxis(i),s=t.getDimensionIndex(t.mapDimension(a.dim)),o=t.getDimensionIndex(t.mapDimension(i.dim)),l=e.get("showBackground",!0),u=t.mapDimension(a.dim),c=t.getCalculationInfo("stackResultDimension"),f=xd(t,u)&&!!t.getCalculationInfo("stackedOnSeries"),h=a.isHorizontal(),d=lLe(i,a),p=nY(e),m=e.get("barMinHeight")||0,g=c&&t.getDimensionIndex(c),v=t.getLayout("size"),_=t.getLayout("offset");return{progress:function(x,b){for(var S=x.count,T=p&&Nu(S*3),M=p&&l&&Nu(S*3),C=p&&Nu(S),k=r.master.getRect(),R=h?k.width:k.height,P,N=b.getStore(),L=0;(P=x.next())!=null;){var F=N.get(f?g:s,P),O=N.get(o,P),B=d,H=void 0;f&&(H=+F-N.get(s,P));var j=void 0,K=void 0,J=void 0,re=void 0;if(h){var se=r.dataToPoint([F,O]);if(f){var Ae=r.dataToPoint([H,O]);B=Ae[0]}j=B,K=se[1]+_,J=se[0]-B,re=v,Math.abs(J)<m&&(J=(J<0?-1:1)*m)}else{var se=r.dataToPoint([O,F]);if(f){var Ae=r.dataToPoint([O,H]);B=Ae[1]}j=se[0]+_,K=B,J=v,re=se[1]-B,Math.abs(re)<m&&(re=(re<=0?-1:1)*m)}p?(T[L]=j,T[L+1]=K,T[L+2]=h?J:re,M&&(M[L]=h?k.x:j,M[L+1]=h?K:k.y,M[L+2]=R),C[P]=P):b.setItemLayout(P,{x:j,y:K,width:J,height:re}),L+=3}p&&b.setLayout({largePoints:T,largeDataIndices:C,largeBackgroundPoints:M,valueAxisHorizontal:h})}}}}}}function tY(n){return n.coordinateSystem&&n.coordinateSystem.type==="cartesian2d"}function nY(n){return n.pipelineContext&&n.pipelineContext.large}function lLe(n,e){return e.toGlobalCoord(e.dataToCoord(e.type==="log"?1:0))}var uLe=function(n,e,t,r){for(;t<r;){var i=t+r>>>1;n[i][1]<e?t=i+1:r=i}return t},rY=function(n){ht(e,n);function e(t){var r=n.call(this,t)||this;return r.type="time",r}return e.prototype.getLabel=function(t){var r=this.getSetting("useUTC");return kT(t.value,dz[bRe(Lm(this._minLevelUnit))]||dz.second,r,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(t,r,i){var a=this.getSetting("useUTC"),s=this.getSetting("locale");return wRe(t,r,i,s,a)},e.prototype.getTicks=function(){var t=this._interval,r=this._extent,i=[];if(!t)return i;i.push({value:r[0],level:0});var a=this.getSetting("useUTC"),s=gLe(this._minLevelUnit,this._approxInterval,a,r);return i=i.concat(s),i.push({value:r[1],level:0}),i},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1]&&(r[0]-=to,r[1]+=to),r[1]===-1/0&&r[0]===1/0){var i=new Date;r[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),r[0]=r[1]-to}this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval)},e.prototype.calcNiceTicks=function(t,r,i){t=t||10;var a=this._extent,s=a[1]-a[0];this._approxInterval=s/t,r!=null&&this._approxInterval<r&&(this._approxInterval=r),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var o=zb.length,l=Math.min(uLe(zb,this._approxInterval,0,o),o-1);this._interval=zb[l][1],this._minLevelUnit=zb[Math.max(l-1,0)][0]},e.prototype.parse=function(t){return gr(t)?t:+qu(t)},e.prototype.contain=function(t){return UT(this.parse(t),this._extent)},e.prototype.normalize=function(t){return zT(this.parse(t),this._extent)},e.prototype.scale=function(t){return VT(t,this._extent)},e.type="time",e}(N_),zb=[["second",GI],["minute",jI],["hour",e0],["quarter-day",e0*6],["half-day",e0*12],["day",to*1.2],["half-week",to*3.5],["week",to*7],["month",to*31],["quarter",to*95],["half-year",hz/2],["year",hz]];function cLe(n,e,t,r){var i=qu(e),a=qu(t),s=function(p){return pz(i,p,r)===pz(a,p,r)},o=function(){return s("year")},l=function(){return o()&&s("month")},u=function(){return l()&&s("day")},c=function(){return u()&&s("hour")},f=function(){return c()&&s("minute")},h=function(){return f()&&s("second")},d=function(){return h()&&s("millisecond")};switch(n){case"year":return o();case"month":return l();case"day":return u();case"hour":return c();case"minute":return f();case"second":return h();case"millisecond":return d()}}function fLe(n,e){return n/=to,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}function hLe(n){var e=30*to;return n/=e,n>6?6:n>3?3:n>2?2:1}function dLe(n){return n/=e0,n>12?12:n>6?6:n>3.5?4:n>2?2:1}function TV(n,e){return n/=e?jI:GI,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}function pLe(n){return uq(n,!0)}function mLe(n,e,t){var r=new Date(n);switch(Lm(e)){case"year":case"month":r[wX(t)](0);case"day":r[SX(t)](1);case"hour":r[TX(t)](0);case"minute":r[CX(t)](0);case"second":r[EX(t)](0),r[AX(t)](0)}return r.getTime()}function gLe(n,e,t,r){var i=1e4,a=xX,s=0;function o(R,P,N,L,F,O,B){for(var H=new Date(P),j=P,K=H[L]();j<N&&j<=r[1];)B.push({value:j}),K+=R,H[F](K),j=H.getTime();B.push({value:j,notAdd:!0})}function l(R,P,N){var L=[],F=!P.length;if(!cLe(Lm(R),r[0],r[1],t)){F&&(P=[{value:mLe(new Date(r[0]),R,t)},{value:r[1]}]);for(var O=0;O<P.length-1;O++){var B=P[O].value,H=P[O+1].value;if(B!==H){var j=void 0,K=void 0,J=void 0,re=!1;switch(R){case"year":j=Math.max(1,Math.round(e/to/365)),K=qI(t),J=SRe(t);break;case"half-year":case"quarter":case"month":j=hLe(e),K=Nm(t),J=wX(t);break;case"week":case"half-week":case"day":j=fLe(e),K=RT(t),J=SX(t),re=!0;break;case"half-day":case"quarter-day":case"hour":j=dLe(e),K=W0(t),J=TX(t);break;case"minute":j=TV(e,!0),K=PT(t),J=CX(t);break;case"second":j=TV(e,!1),K=IT(t),J=EX(t);break;case"millisecond":j=pLe(e),K=DT(t),J=AX(t);break}o(j,B,H,K,J,re,L),R==="year"&&N.length>1&&O===0&&N.unshift({value:N[0].value-j})}}for(var O=0;O<L.length;O++)N.push(L[O]);return L}}for(var u=[],c=[],f=0,h=0,d=0;d<a.length&&s++<i;++d){var p=Lm(a[d]);if(xRe(a[d])){l(a[d],u[u.length-1]||[],c);var m=a[d+1]?Lm(a[d+1]):null;if(p!==m){if(c.length){h=f,c.sort(function(R,P){return R.value-P.value});for(var g=[],v=0;v<c.length;++v){var _=c[v].value;(v===0||c[v-1].value!==_)&&(g.push(c[v]),_>=r[0]&&_<=r[1]&&f++)}var x=(r[1]-r[0])/e;if(f>x*1.5&&h>x/1.5||(u.push(g),f>x||n===a[d]))break}c=[]}}}for(var b=si(Nt(u,function(R){return si(R,function(P){return P.value>=r[0]&&P.value<=r[1]&&!P.notAdd})}),function(R){return R.length>0}),S=[],T=b.length-1,d=0;d<b.length;++d)for(var M=b[d],C=0;C<M.length;++C)S.push({value:M[C].value,level:T-d});S.sort(function(R,P){return R.value-P.value});for(var k=[],d=0;d<S.length;++d)(d===0||S[d].value!==S[d-1].value)&&k.push(S[d]);return k}rc.registerClass(rY);const vLe=rY;var CV=rc.prototype,i0=N_.prototype,yLe=vi,_Le=Math.floor,xLe=Math.ceil,Vb=Math.pow,Do=Math.log,pD=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="log",t.base=10,t._originalScale=new N_,t._interval=0,t}return e.prototype.getTicks=function(t){var r=this._originalScale,i=this._extent,a=r.getExtent(),s=i0.getTicks.call(this,t);return Nt(s,function(o){var l=o.value,u=vi(Vb(this.base,l));return u=l===i[0]&&this._fixMin?Hb(u,a[0]):u,u=l===i[1]&&this._fixMax?Hb(u,a[1]):u,{value:u}},this)},e.prototype.setExtent=function(t,r){var i=Do(this.base);t=Do(Math.max(0,t))/i,r=Do(Math.max(0,r))/i,i0.setExtent.call(this,t,r)},e.prototype.getExtent=function(){var t=this.base,r=CV.getExtent.call(this);r[0]=Vb(t,r[0]),r[1]=Vb(t,r[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(r[0]=Hb(r[0],a[0])),this._fixMax&&(r[1]=Hb(r[1],a[1])),r},e.prototype.unionExtent=function(t){this._originalScale.unionExtent(t);var r=this.base;t[0]=Do(t[0])/Do(r),t[1]=Do(t[1])/Do(r),CV.unionExtent.call(this,t)},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.calcNiceTicks=function(t){t=t||10;var r=this._extent,i=r[1]-r[0];if(!(i===1/0||i<=0)){var a=TAe(i),s=t/i*a;for(s<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var o=[vi(xLe(r[0]/a)*a),vi(_Le(r[1]/a)*a)];this._interval=a,this._niceExtent=o}},e.prototype.calcNiceExtent=function(t){i0.calcNiceExtent.call(this,t),this._fixMin=t.fixMin,this._fixMax=t.fixMax},e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return t=Do(t)/Do(this.base),UT(t,this._extent)},e.prototype.normalize=function(t){return t=Do(t)/Do(this.base),zT(t,this._extent)},e.prototype.scale=function(t){return t=VT(t,this._extent),Vb(this.base,t)},e.type="log",e}(rc),iY=pD.prototype;iY.getMinorTicks=i0.getMinorTicks;iY.getLabel=i0.getLabel;function Hb(n,e){return yLe(n,Lu(e))}rc.registerClass(pD);const bLe=pD;var wLe=function(){function n(e,t,r){this._prepareParams(e,t,r)}return n.prototype._prepareParams=function(e,t,r){r[1]<r[0]&&(r=[NaN,NaN]),this._dataMin=r[0],this._dataMax=r[1];var i=this._isOrdinal=e.type==="ordinal";this._needCrossZero=e.type==="interval"&&t.getNeedCrossZero&&t.getNeedCrossZero();var a=this._modelMinRaw=t.get("min",!0);pn(a)?this._modelMinNum=Wb(e,a({min:r[0],max:r[1]})):a!=="dataMin"&&(this._modelMinNum=Wb(e,a));var s=this._modelMaxRaw=t.get("max",!0);if(pn(s)?this._modelMaxNum=Wb(e,s({min:r[0],max:r[1]})):s!=="dataMax"&&(this._modelMaxNum=Wb(e,s)),i)this._axisDataLen=t.getCategories().length;else{var o=t.get("boundaryGap"),l=Rt(o)?o:[o||0,o||0];typeof l[0]=="boolean"||typeof l[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[mf(l[0],1),mf(l[1],1)]}},n.prototype.calculate=function(){var e=this._isOrdinal,t=this._dataMin,r=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,s=e?null:r-t||Math.abs(t),o=this._modelMinRaw==="dataMin"?t:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?r:this._modelMaxNum,u=o!=null,c=l!=null;o==null&&(o=e?i?0:NaN:t-a[0]*s),l==null&&(l=e?i?i-1:NaN:r+a[1]*s),(o==null||!isFinite(o))&&(o=NaN),(l==null||!isFinite(l))&&(l=NaN);var f=Cw(o)||Cw(l)||e&&!i;this._needCrossZero&&(o>0&&l>0&&!u&&(o=0),o<0&&l<0&&!c&&(l=0));var h=this._determinedMin,d=this._determinedMax;return h!=null&&(o=h,u=!0),d!=null&&(l=d,c=!0),{min:o,max:l,minFixed:u,maxFixed:c,isBlank:f}},n.prototype.modifyDataMinMax=function(e,t){this[TLe[e]]=t},n.prototype.setDeterminedMinMax=function(e,t){var r=SLe[e];this[r]=t},n.prototype.freeze=function(){this.frozen=!0},n}(),SLe={min:"_determinedMin",max:"_determinedMax"},TLe={min:"_dataMin",max:"_dataMax"};function aY(n,e,t){var r=n.rawExtentInfo;return r||(r=new wLe(n,e,t),n.rawExtentInfo=r,r)}function Wb(n,e){return e==null?null:Cw(e)?NaN:n.parse(e)}function sY(n,e){var t=n.type,r=aY(n,e,n.getExtent()).calculate();n.setBlank(r.isBlank);var i=r.min,a=r.max,s=e.ecModel;if(s&&t==="time"){var o=JK("bar",s),l=!1;if(ce(o,function(f){l=l||f.getBaseAxis()===e.axis}),l){var u=eY(o),c=CLe(i,a,e,u);i=c.min,a=c.max}}return{extent:[i,a],fixMin:r.minFixed,fixMax:r.maxFixed}}function CLe(n,e,t,r){var i=t.axis.getExtent(),a=i[1]-i[0],s=aLe(r,t.axis);if(s===void 0)return{min:n,max:e};var o=1/0;ce(s,function(d){o=Math.min(d.offset,o)});var l=-1/0;ce(s,function(d){l=Math.max(d.offset+d.width,l)}),o=Math.abs(o),l=Math.abs(l);var u=o+l,c=e-n,f=1-(o+l)/a,h=c/f-c;return e+=h*(l/u),n-=h*(o/u),{min:n,max:e}}function Kw(n,e){var t=e,r=sY(n,t),i=r.extent,a=t.get("splitNumber");n instanceof bLe&&(n.base=t.get("logBase"));var s=n.type,o=t.get("interval"),l=s==="interval"||s==="time";n.setExtent(i[0],i[1]),n.calcNiceExtent({splitNumber:a,fixMin:r.fixMin,fixMax:r.fixMax,minInterval:l?t.get("minInterval"):null,maxInterval:l?t.get("maxInterval"):null}),o!=null&&n.setInterval&&n.setInterval(o)}function oY(n,e){if(e=e||n.get("type"),e)switch(e){case"category":return new YK({ordinalMeta:n.getOrdinalMeta?n.getOrdinalMeta():n.getCategories(),extent:[1/0,-1/0]});case"time":return new vLe({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new(rc.getClass(e)||N_)}}function ELe(n){var e=n.scale.getExtent(),t=e[0],r=e[1];return!(t>0&&r>0||t<0&&r<0)}function O_(n){var e=n.getLabelModel().get("formatter"),t=n.type==="category"?n.scale.getExtent()[0]:null;return n.scale.type==="time"?function(r){return function(i,a){return n.scale.getFormattedLabel(i,a,r)}}(e):jt(e)?function(r){return function(i){var a=n.scale.getLabel(i),s=r.replace("{value}",a??"");return s}}(e):pn(e)?function(r){return function(i,a){return t!=null&&(a=i.value-t),r(mD(n,i),a,i.level!=null?{level:i.level}:null)}}(e):function(r){return n.scale.getLabel(r)}}function mD(n,e){return n.type==="category"?n.scale.getLabel(e):e.value}function ALe(n){var e=n.model,t=n.scale;if(!(!e.get(["axisLabel","show"])||t.isBlank())){var r,i,a=t.getExtent();t instanceof YK?i=t.count():(r=t.getTicks(),i=r.length);var s=n.getLabelModel(),o=O_(n),l,u=1;i>40&&(u=Math.ceil(i/40));for(var c=0;c<i;c+=u){var f=r?r[c]:{value:a[0]+c},h=o(f,c),d=s.getTextRect(h),p=MLe(d,s.get("rotate")||0);l?l.union(p):l=p}return l}}function MLe(n,e){var t=e*Math.PI/180,r=n.width,i=n.height,a=r*Math.abs(Math.cos(t))+Math.abs(i*Math.sin(t)),s=r*Math.abs(Math.sin(t))+Math.abs(i*Math.cos(t)),o=new Xn(n.x,n.y,a,s);return o}function gD(n){var e=n.get("interval");return e??"auto"}function lY(n){return n.type==="category"&&gD(n.getLabelModel())===0}function Yw(n,e){var t={};return ce(n.mapDimensionsAll(e),function(r){t[GDe(n,r)]=!0}),Wr(t)}function kLe(n,e,t){e&&ce(Yw(e,t),function(r){var i=e.getApproximateExtent(r);i[0]<n[0]&&(n[0]=i[0]),i[1]>n[1]&&(n[1]=i[1])})}var uY=function(){function n(){}return n.prototype.getNeedCrossZero=function(){var e=this.option;return!e.scale},n.prototype.getCoordSysModel=function(){},n}(),EV=[],RLe={registerPreprocessor:$K,registerProcessor:FK,registerPostInit:yDe,registerPostUpdate:_De,registerUpdateLifecycle:uD,registerAction:nu,registerCoordinateSystem:xDe,registerLayout:bDe,registerVisual:Hd,registerTransform:SDe,registerLoading:BK,registerMap:wDe,registerImpl:JIe,PRIORITY:hDe,ComponentModel:Sr,ComponentView:Ps,SeriesModel:yf,ChartView:Ul,registerComponentModel:function(n){Sr.registerClass(n)},registerComponentView:function(n){Ps.registerClass(n)},registerSeriesModel:function(n){yf.registerClass(n)},registerChartView:function(n){Ul.registerClass(n)},registerSubTypeDefaulter:function(n,e){Sr.registerSubTypeDefaulter(n,e)},registerPainter:function(n,e){vAe(n,e)}};function Yu(n){if(Rt(n)){ce(n,function(e){Yu(e)});return}Vn(EV,n)>=0||(EV.push(n),pn(n)&&(n={install:n}),n.install(RLe))}var Z0=qr();function PLe(n){return n.type==="category"?DLe(n):NLe(n)}function ILe(n,e){return n.type==="category"?LLe(n,e):{ticks:Nt(n.scale.getTicks(),function(t){return t.value})}}function DLe(n){var e=n.getLabelModel(),t=cY(n,e);return!e.get("show")||n.scale.isBlank()?{labels:[],labelCategoryInterval:t.labelCategoryInterval}:t}function cY(n,e){var t=fY(n,"labels"),r=gD(e),i=hY(t,r);if(i)return i;var a,s;return pn(r)?a=mY(n,r):(s=r==="auto"?OLe(n):r,a=pY(n,s)),dY(t,r,{labels:a,labelCategoryInterval:s})}function LLe(n,e){var t=fY(n,"ticks"),r=gD(e),i=hY(t,r);if(i)return i;var a,s;if((!e.get("show")||n.scale.isBlank())&&(a=[]),pn(r))a=mY(n,r,!0);else if(r==="auto"){var o=cY(n,n.getLabelModel());s=o.labelCategoryInterval,a=Nt(o.labels,function(l){return l.tickValue})}else s=r,a=pY(n,s,!0);return dY(t,r,{ticks:a,tickCategoryInterval:s})}function NLe(n){var e=n.scale.getTicks(),t=O_(n);return{labels:Nt(e,function(r,i){return{level:r.level,formattedLabel:t(r,i),rawLabel:n.scale.getLabel(r),tickValue:r.value}})}}function fY(n,e){return Z0(n)[e]||(Z0(n)[e]=[])}function hY(n,e){for(var t=0;t<n.length;t++)if(n[t].key===e)return n[t].value}function dY(n,e,t){return n.push({key:e,value:t}),t}function OLe(n){var e=Z0(n).autoInterval;return e??(Z0(n).autoInterval=n.calculateCategoryInterval())}function $Le(n){var e=FLe(n),t=O_(n),r=(e.axisRotate-e.labelRotate)/180*Math.PI,i=n.scale,a=i.getExtent(),s=i.count();if(a[1]-a[0]<1)return 0;var o=1;s>40&&(o=Math.max(1,Math.floor(s/40)));for(var l=a[0],u=n.dataToCoord(l+1)-n.dataToCoord(l),c=Math.abs(u*Math.cos(r)),f=Math.abs(u*Math.sin(r)),h=0,d=0;l<=a[1];l+=o){var p=0,m=0,g=M_(t({value:l}),e.font,"center","top");p=g.width*1.3,m=g.height*1.3,h=Math.max(h,p,7),d=Math.max(d,m,7)}var v=h/c,_=d/f;isNaN(v)&&(v=1/0),isNaN(_)&&(_=1/0);var x=Math.max(0,Math.floor(Math.min(v,_))),b=Z0(n.model),S=n.getExtent(),T=b.lastAutoInterval,M=b.lastTickCount;return T!=null&&M!=null&&Math.abs(T-x)<=1&&Math.abs(M-s)<=1&&T>x&&b.axisExtent0===S[0]&&b.axisExtent1===S[1]?x=T:(b.lastTickCount=s,b.lastAutoInterval=x,b.axisExtent0=S[0],b.axisExtent1=S[1]),x}function FLe(n){var e=n.getLabelModel();return{axisRotate:n.getRotate?n.getRotate():n.isHorizontal&&!n.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}function pY(n,e,t){var r=O_(n),i=n.scale,a=i.getExtent(),s=n.getLabelModel(),o=[],l=Math.max((e||0)+1,1),u=a[0],c=i.count();u!==0&&l>1&&c/l>2&&(u=Math.round(Math.ceil(u/l)*l));var f=lY(n),h=s.get("showMinLabel")||f,d=s.get("showMaxLabel")||f;h&&u!==a[0]&&m(a[0]);for(var p=u;p<=a[1];p+=l)m(p);d&&p-l!==a[1]&&m(a[1]);function m(g){var v={value:g};o.push(t?g:{formattedLabel:r(v),rawLabel:i.getLabel(v),tickValue:g})}return o}function mY(n,e,t){var r=n.scale,i=O_(n),a=[];return ce(r.getTicks(),function(s){var o=r.getLabel(s),l=s.value;e(s.value,o)&&a.push(t?l:{formattedLabel:i(s),rawLabel:o,tickValue:l})}),a}var AV=[0,1],BLe=function(){function n(e,t,r){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=t,this._extent=r||[0,0]}return n.prototype.contain=function(e){var t=this._extent,r=Math.min(t[0],t[1]),i=Math.max(t[0],t[1]);return e>=r&&e<=i},n.prototype.containData=function(e){return this.scale.contain(e)},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.getPixelPrecision=function(e){return oq(e||this.scale.getExtent(),this._extent)},n.prototype.setExtent=function(e,t){var r=this._extent;r[0]=e,r[1]=t},n.prototype.dataToCoord=function(e,t){var r=this._extent,i=this.scale;return e=i.normalize(e),this.onBand&&i.type==="ordinal"&&(r=r.slice(),MV(r,i.count())),Vc(e,AV,r,t)},n.prototype.coordToData=function(e,t){var r=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(r=r.slice(),MV(r,i.count()));var a=Vc(e,r,AV,t);return this.scale.scale(a)},n.prototype.pointToData=function(e,t){},n.prototype.getTicksCoords=function(e){e=e||{};var t=e.tickModel||this.getTickModel(),r=ILe(this,t),i=r.ticks,a=Nt(i,function(o){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(o):o),tickValue:o}},this),s=t.get("alignWithLabel");return ULe(this,a,s,e.clamp),a},n.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var e=this.model.getModel("minorTick"),t=e.get("splitNumber");t>0&&t<100||(t=5);var r=this.scale.getMinorTicks(t),i=Nt(r,function(a){return Nt(a,function(s){return{coord:this.dataToCoord(s),tickValue:s}},this)},this);return i},n.prototype.getViewLabels=function(){return PLe(this).labels},n.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},n.prototype.getTickModel=function(){return this.model.getModel("axisTick")},n.prototype.getBandWidth=function(){var e=this._extent,t=this.scale.getExtent(),r=t[1]-t[0]+(this.onBand?1:0);r===0&&(r=1);var i=Math.abs(e[1]-e[0]);return Math.abs(i)/r},n.prototype.calculateCategoryInterval=function(){return $Le(this)},n}();function MV(n,e){var t=n[1]-n[0],r=e,i=t/r/2;n[0]+=i,n[1]-=i}function ULe(n,e,t,r){var i=e.length;if(!n.onBand||t||!i)return;var a=n.getExtent(),s,o;if(i===1)e[0].coord=a[0],s=e[1]={coord:a[0]};else{var l=e[i-1].tickValue-e[0].tickValue,u=(e[i-1].coord-e[0].coord)/l;ce(e,function(d){d.coord-=u/2});var c=n.scale.getExtent();o=1+c[1]-e[i-1].tickValue,s={coord:e[i-1].coord+u*o},e.push(s)}var f=a[0]>a[1];h(e[0].coord,a[0])&&(r?e[0].coord=a[0]:e.shift()),r&&h(a[0],e[0].coord)&&e.unshift({coord:a[0]}),h(a[1],s.coord)&&(r?s.coord=a[1]:e.pop()),r&&h(s.coord,a[1])&&e.push({coord:a[1]});function h(d,p){return d=vi(d),p=vi(p),f?d>p:d<p}}const Wd=BLe;var ny=Math.PI*2,_h=Xu.CMD,zLe=["top","right","bottom","left"];function VLe(n,e,t,r,i){var a=t.width,s=t.height;switch(n){case"top":r.set(t.x+a/2,t.y-e),i.set(0,-1);break;case"bottom":r.set(t.x+a/2,t.y+s+e),i.set(0,1);break;case"left":r.set(t.x-e,t.y+s/2),i.set(-1,0);break;case"right":r.set(t.x+a+e,t.y+s/2),i.set(1,0);break}}function HLe(n,e,t,r,i,a,s,o,l){s-=n,o-=e;var u=Math.sqrt(s*s+o*o);s/=u,o/=u;var c=s*t+n,f=o*t+e;if(Math.abs(r-i)%ny<1e-4)return l[0]=c,l[1]=f,u-t;if(a){var h=r;r=Xc(i),i=Xc(h)}else r=Xc(r),i=Xc(i);r>i&&(i+=ny);var d=Math.atan2(o,s);if(d<0&&(d+=ny),d>=r&&d<=i||d+ny>=r&&d+ny<=i)return l[0]=c,l[1]=f,u-t;var p=t*Math.cos(r)+n,m=t*Math.sin(r)+e,g=t*Math.cos(i)+n,v=t*Math.sin(i)+e,_=(p-s)*(p-s)+(m-o)*(m-o),x=(g-s)*(g-s)+(v-o)*(v-o);return _<x?(l[0]=p,l[1]=m,Math.sqrt(_)):(l[0]=g,l[1]=v,Math.sqrt(x))}function Zw(n,e,t,r,i,a,s,o){var l=i-n,u=a-e,c=t-n,f=r-e,h=Math.sqrt(c*c+f*f);c/=h,f/=h;var d=l*c+u*f,p=d/h;o&&(p=Math.min(Math.max(p,0),1)),p*=h;var m=s[0]=n+p*c,g=s[1]=e+p*f;return Math.sqrt((m-i)*(m-i)+(g-a)*(g-a))}function gY(n,e,t,r,i,a,s){t<0&&(n=n+t,t=-t),r<0&&(e=e+r,r=-r);var o=n+t,l=e+r,u=s[0]=Math.min(Math.max(i,n),o),c=s[1]=Math.min(Math.max(a,e),l);return Math.sqrt((u-i)*(u-i)+(c-a)*(c-a))}var Fo=[];function WLe(n,e,t){var r=gY(e.x,e.y,e.width,e.height,n.x,n.y,Fo);return t.set(Fo[0],Fo[1]),r}function GLe(n,e,t){for(var r=0,i=0,a=0,s=0,o,l,u=1/0,c=e.data,f=n.x,h=n.y,d=0;d<c.length;){var p=c[d++];d===1&&(r=c[d],i=c[d+1],a=r,s=i);var m=u;switch(p){case _h.M:a=c[d++],s=c[d++],r=a,i=s;break;case _h.L:m=Zw(r,i,c[d],c[d+1],f,h,Fo,!0),r=c[d++],i=c[d++];break;case _h.C:m=q7(r,i,c[d++],c[d++],c[d++],c[d++],c[d],c[d+1],f,h,Fo),r=c[d++],i=c[d++];break;case _h.Q:m=K7(r,i,c[d++],c[d++],c[d],c[d+1],f,h,Fo),r=c[d++],i=c[d++];break;case _h.A:var g=c[d++],v=c[d++],_=c[d++],x=c[d++],b=c[d++],S=c[d++];d+=1;var T=!!(1-c[d++]);o=Math.cos(b)*_+g,l=Math.sin(b)*x+v,d<=1&&(a=o,s=l);var M=(f-g)*x/_+g;m=HLe(g,v,x,b,b+S,T,M,h,Fo),r=Math.cos(b+S)*_+g,i=Math.sin(b+S)*x+v;break;case _h.R:a=r=c[d++],s=i=c[d++];var C=c[d++],k=c[d++];m=gY(a,s,C,k,f,h,Fo);break;case _h.Z:m=Zw(r,i,a,s,f,h,Fo,!0),r=a,i=s;break}m<u&&(u=m,t.set(Fo[0],Fo[1]))}return u}var Ko=new nn,wr=new nn,ai=new nn,Nl=new nn,Il=new nn;function kV(n,e){if(n){var t=n.getTextGuideLine(),r=n.getTextContent();if(r&&t){var i=n.textGuideLineConfig||{},a=[[0,0],[0,0],[0,0]],s=i.candidates||zLe,o=r.getBoundingRect().clone();o.applyTransform(r.getComputedTransform());var l=1/0,u=i.anchor,c=n.getComputedTransform(),f=c&&pT([],c),h=e.get("length2")||0;u&&ai.copy(u);for(var d=0;d<s.length;d++){var p=s[d];VLe(p,0,o,Ko,Nl),nn.scaleAndAdd(wr,Ko,Nl,h),wr.transform(f);var m=n.getBoundingRect(),g=u?u.distance(wr):n instanceof Wn?GLe(wr,n.path,ai):WLe(wr,m,ai);g<l&&(l=g,wr.transform(c),ai.transform(c),ai.toArray(a[0]),wr.toArray(a[1]),Ko.toArray(a[2]))}vY(a,e.get("minTurnAngle")),t.setShape({points:a})}}}var Qw=[],La=new nn;function vY(n,e){if(e<=180&&e>0){e=e/180*Math.PI,Ko.fromArray(n[0]),wr.fromArray(n[1]),ai.fromArray(n[2]),nn.sub(Nl,Ko,wr),nn.sub(Il,ai,wr);var t=Nl.len(),r=Il.len();if(!(t<.001||r<.001)){Nl.scale(1/t),Il.scale(1/r);var i=Nl.dot(Il),a=Math.cos(e);if(a<i){var s=Zw(wr.x,wr.y,ai.x,ai.y,Ko.x,Ko.y,Qw,!1);La.fromArray(Qw),La.scaleAndAdd(Il,s/Math.tan(Math.PI-e));var o=ai.x!==wr.x?(La.x-wr.x)/(ai.x-wr.x):(La.y-wr.y)/(ai.y-wr.y);if(isNaN(o))return;o<0?nn.copy(La,wr):o>1&&nn.copy(La,ai),La.toArray(n[1])}}}}function jLe(n,e,t){if(t<=180&&t>0){t=t/180*Math.PI,Ko.fromArray(n[0]),wr.fromArray(n[1]),ai.fromArray(n[2]),nn.sub(Nl,wr,Ko),nn.sub(Il,ai,wr);var r=Nl.len(),i=Il.len();if(!(r<.001||i<.001)){Nl.scale(1/r),Il.scale(1/i);var a=Nl.dot(e),s=Math.cos(t);if(a<s){var o=Zw(wr.x,wr.y,ai.x,ai.y,Ko.x,Ko.y,Qw,!1);La.fromArray(Qw);var l=Math.PI/2,u=Math.acos(Il.dot(e)),c=l+u-t;if(c>=l)nn.copy(La,ai);else{La.scaleAndAdd(Il,o/Math.tan(Math.PI/2-c));var f=ai.x!==wr.x?(La.x-wr.x)/(ai.x-wr.x):(La.y-wr.y)/(ai.y-wr.y);if(isNaN(f))return;f<0?nn.copy(La,wr):f>1&&nn.copy(La,ai)}La.toArray(n[1])}}}}function RV(n,e,t,r){var i=t==="normal",a=i?n:n.ensureState(t);a.ignore=e;var s=r.get("smooth");s&&s===!0&&(s=.3),a.shape=a.shape||{},s>0&&(a.shape.smooth=s);var o=r.getModel("lineStyle").getLineStyle();i?n.useStyle(o):a.style=o}function qLe(n,e){var t=e.smooth,r=e.points;if(r)if(n.moveTo(r[0][0],r[0][1]),t>0&&r.length>=3){var i=zM(r[0],r[1]),a=zM(r[1],r[2]);if(!i||!a){n.lineTo(r[1][0],r[1][1]),n.lineTo(r[2][0],r[2][1]);return}var s=Math.min(i,a)*t,o=V1([],r[1],r[0],s/i),l=V1([],r[1],r[2],s/a),u=V1([],o,l,.5);n.bezierCurveTo(o[0],o[1],o[0],o[1],u[0],u[1]),n.bezierCurveTo(l[0],l[1],l[0],l[1],r[2][0],r[2][1])}else for(var c=1;c<r.length;c++)n.lineTo(r[c][0],r[c][1])}function yY(n,e,t){var r=n.getTextGuideLine(),i=n.getTextContent();if(!i){r&&n.removeTextGuideLine();return}for(var a=e.normal,s=a.get("show"),o=i.ignore,l=0;l<Nw.length;l++){var u=Nw[l],c=e[u],f=u==="normal";if(c){var h=c.get("show"),d=f?o:Hn(i.states[u]&&i.states[u].ignore,o);if(d||!Hn(h,s)){var p=f?r:r&&r.states[u];p&&(p.ignore=!0);continue}r||(r=new P_,n.setTextGuideLine(r),!f&&(o||!s)&&RV(r,!0,"normal",e.normal),n.stateProxy&&(r.stateProxy=n.stateProxy)),RV(r,!1,u,c)}}if(r){ln(r.style,t),r.style.fill=null;var m=a.get("showAbove"),g=n.textGuideLineConfig=n.textGuideLineConfig||{};g.showAbove=m||!1,r.buildPath=qLe}}function _Y(n,e){e=e||"labelLine";for(var t={normal:n.getModel(e)},r=0;r<xo.length;r++){var i=xo[r];t[i]=n.getModel([i,e])}return t}function xY(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.defaultAttr.ignore){var i=r.label,a=i.getComputedTransform(),s=i.getBoundingRect(),o=!a||a[1]<1e-5&&a[2]<1e-5,l=i.style.margin||0,u=s.clone();u.applyTransform(a),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var c=o?new $w(s,a):null;e.push({label:i,labelLine:r.labelLine,rect:u,localRect:s,obb:c,priority:r.priority,defaultAttr:r.defaultAttr,layoutOption:r.computedLayoutOption,axisAligned:o,transform:a})}}return e}function bY(n,e,t,r,i,a){var s=n.length;if(s<2)return;n.sort(function(C,k){return C.rect[e]-k.rect[e]});for(var o=0,l,u=!1,c=0,f=0;f<s;f++){var h=n[f],d=h.rect;l=d[e]-o,l<0&&(d[e]-=l,h.label[e]-=l,u=!0);var p=Math.max(-l,0);c+=p,o=d[e]+d[t]}c>0&&a&&S(-c/s,0,s);var m=n[0],g=n[s-1],v,_;x(),v<0&&T(-v,.8),_<0&&T(_,.8),x(),b(v,_,1),b(_,v,-1),x(),v<0&&M(-v),_<0&&M(_);function x(){v=m.rect[e]-r,_=i-g.rect[e]-g.rect[t]}function b(C,k,R){if(C<0){var P=Math.min(k,-C);if(P>0){S(P*R,0,s);var N=P+C;N<0&&T(-N*R,1)}else T(-C*R,1)}}function S(C,k,R){C!==0&&(u=!0);for(var P=k;P<R;P++){var N=n[P],L=N.rect;L[e]+=C,N.label[e]+=C}}function T(C,k){for(var R=[],P=0,N=1;N<s;N++){var L=n[N-1].rect,F=Math.max(n[N].rect[e]-L[e]-L[t],0);R.push(F),P+=F}if(P){var O=Math.min(Math.abs(C)/P,k);if(C>0)for(var N=0;N<s-1;N++){var B=R[N]*O;S(B,0,N+1)}else for(var N=s-1;N>0;N--){var B=R[N-1]*O;S(-B,N,s)}}}function M(C){var k=C<0?-1:1;C=Math.abs(C);for(var R=Math.ceil(C/(s-1)),P=0;P<s-1;P++)if(k>0?S(R,0,P+1):S(-R,s-P-1,s),C-=R,C<=0)return}return u}function XLe(n,e,t,r){return bY(n,"x","width",e,t,r)}function wY(n,e,t,r){return bY(n,"y","height",e,t,r)}function SY(n){var e=[];n.sort(function(m,g){return g.priority-m.priority});var t=new Xn(0,0,0,0);function r(m){if(!m.ignore){var g=m.ensureState("emphasis");g.ignore==null&&(g.ignore=!1)}m.ignore=!0}for(var i=0;i<n.length;i++){var a=n[i],s=a.axisAligned,o=a.localRect,l=a.transform,u=a.label,c=a.labelLine;t.copy(a.rect),t.width-=.1,t.height-=.1,t.x+=.05,t.y+=.05;for(var f=a.obb,h=!1,d=0;d<e.length;d++){var p=e[d];if(t.intersect(p.rect)){if(s&&p.axisAligned){h=!0;break}if(p.obb||(p.obb=new $w(p.localRect,p.transform)),f||(f=new $w(o,l)),f.intersect(p.obb)){h=!0;break}}}h?(r(u),c&&r(c)):(u.attr("ignore",a.defaultAttr.ignore),c&&c.attr("ignore",a.defaultAttr.labelGuideIgnore),e.push(a))}}function KLe(n){if(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t].slice());return e}}function YLe(n,e){var t=n.label,r=e&&e.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:t.style.align,verticalAlign:t.style.verticalAlign,labelLinePoints:KLe(r&&r.shape.points)}}var PV=["align","verticalAlign","width","height","fontSize"],ys=new A_,qE=qr(),ZLe=qr();function Gb(n,e,t){for(var r=0;r<t.length;r++){var i=t[r];e[i]!=null&&(n[i]=e[i])}}var jb=["x","y","rotation"],QLe=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(e,t,r,i,a){var s=i.style,o=i.__hostTarget,l=o.textConfig||{},u=i.getComputedTransform(),c=i.getBoundingRect().plain();Xn.applyTransform(c,c,u),u?ys.setLocalTransform(u):(ys.x=ys.y=ys.rotation=ys.originX=ys.originY=0,ys.scaleX=ys.scaleY=1);var f=i.__hostTarget,h;if(f){h=f.getBoundingRect().plain();var d=f.getComputedTransform();Xn.applyTransform(h,h,d)}var p=h&&f.getTextGuideLine();this._labelList.push({label:i,labelLine:p,seriesModel:r,dataIndex:e,dataType:t,layoutOption:a,computedLayoutOption:null,rect:c,hostRect:h,priority:h?h.width*h.height:0,defaultAttr:{ignore:i.ignore,labelGuideIgnore:p&&p.ignore,x:ys.x,y:ys.y,scaleX:ys.scaleX,scaleY:ys.scaleY,rotation:ys.rotation,style:{x:s.x,y:s.y,align:s.align,verticalAlign:s.verticalAlign,width:s.width,height:s.height,fontSize:s.fontSize},cursor:i.cursor,attachedPos:l.position,attachedRot:l.rotation}})},n.prototype.addLabelsOfSeries=function(e){var t=this;this._chartViewList.push(e);var r=e.__model,i=r.get("labelLayout");(pn(i)||Wr(i).length)&&e.group.traverse(function(a){if(a.ignore)return!0;var s=a.getTextContent(),o=ar(a);s&&!s.disableLabelLayout&&t._addLabel(o.dataIndex,o.dataType,r,s,i)})},n.prototype.updateLayoutConfig=function(e){var t=e.getWidth(),r=e.getHeight();function i(x,b){return function(){kV(x,b)}}for(var a=0;a<this._labelList.length;a++){var s=this._labelList[a],o=s.label,l=o.__hostTarget,u=s.defaultAttr,c=void 0;pn(s.layoutOption)?c=s.layoutOption(YLe(s,l)):c=s.layoutOption,c=c||{},s.computedLayoutOption=c;var f=Math.PI/180;l&&l.setTextConfig({local:!1,position:c.x!=null||c.y!=null?null:u.attachedPos,rotation:c.rotate!=null?c.rotate*f:u.attachedRot,offset:[c.dx||0,c.dy||0]});var h=!1;if(c.x!=null?(o.x=Jn(c.x,t),o.setStyle("x",0),h=!0):(o.x=u.x,o.setStyle("x",u.style.x)),c.y!=null?(o.y=Jn(c.y,r),o.setStyle("y",0),h=!0):(o.y=u.y,o.setStyle("y",u.style.y)),c.labelLinePoints){var d=l.getTextGuideLine();d&&(d.setShape({points:c.labelLinePoints}),h=!1)}var p=qE(o);p.needsUpdateLabelLine=h,o.rotation=c.rotate!=null?c.rotate*f:u.rotation,o.scaleX=u.scaleX,o.scaleY=u.scaleY;for(var m=0;m<PV.length;m++){var g=PV[m];o.setStyle(g,c[g]!=null?c[g]:u.style[g])}if(c.draggable){if(o.draggable=!0,o.cursor="move",l){var v=s.seriesModel;if(s.dataIndex!=null){var _=s.seriesModel.getData(s.dataType);v=_.getItemModel(s.dataIndex)}o.on("drag",i(l,v.getModel("labelLine")))}}else o.off("drag"),o.cursor=u.cursor}},n.prototype.layout=function(e){var t=e.getWidth(),r=e.getHeight(),i=xY(this._labelList),a=si(i,function(l){return l.layoutOption.moveOverlap==="shiftX"}),s=si(i,function(l){return l.layoutOption.moveOverlap==="shiftY"});XLe(a,0,t),wY(s,0,r);var o=si(i,function(l){return l.layoutOption.hideOverlap});SY(o)},n.prototype.processLabelsOverall=function(){var e=this;ce(this._chartViewList,function(t){var r=t.__model,i=t.ignoreLabelLineUpdate,a=r.isAnimationEnabled();t.group.traverse(function(s){if(s.ignore&&!s.forceLabelAnimation)return!0;var o=!i,l=s.getTextContent();!o&&l&&(o=qE(l).needsUpdateLabelLine),o&&e._updateLabelLine(s,r),a&&e._animateLabels(s,r)})})},n.prototype._updateLabelLine=function(e,t){var r=e.getTextContent(),i=ar(e),a=i.dataIndex;if(r&&a!=null){var s=t.getData(i.dataType),o=s.getItemModel(a),l={},u=s.getItemVisual(a,"style"),c=s.getVisual("drawType");l.stroke=u[c];var f=o.getModel("labelLine");yY(e,_Y(o),l),kV(e,f)}},n.prototype._animateLabels=function(e,t){var r=e.getTextContent(),i=e.getTextGuideLine();if(r&&(e.forceLabelAnimation||!r.ignore&&!r.invisible&&!e.disableLabelAnimation&&!Dm(e))){var a=qE(r),s=a.oldLayout,o=ar(e),l=o.dataIndex,u={x:r.x,y:r.y,rotation:r.rotation},c=t.getData(o.dataType);if(s){r.attr(s);var h=e.prevStates;h&&(Vn(h,"select")>=0&&r.attr(a.oldLayoutSelect),Vn(h,"emphasis")>=0&&r.attr(a.oldLayoutEmphasis)),Ui(r,u,t,l)}else if(r.attr(u),!Gg(r).valueAnimation){var f=Hn(r.style.opacity,1);r.style.opacity=0,_a(r,{style:{opacity:f}},t,l)}if(a.oldLayout=u,r.states.select){var d=a.oldLayoutSelect={};Gb(d,u,jb),Gb(d,r.states.select,jb)}if(r.states.emphasis){var p=a.oldLayoutEmphasis={};Gb(p,u,jb),Gb(p,r.states.emphasis,jb)}iRe(r,l,c,t,t)}if(i&&!i.ignore&&!i.invisible){var a=ZLe(i),s=a.oldLayout,m={points:i.shape.points};s?(i.attr({shape:s}),Ui(i,{shape:m},t)):(i.setShape(m),i.style.strokePercent=0,_a(i,{style:{strokePercent:1}},t)),a.oldLayout=m}},n}();const JLe=QLe;var XE=qr();function ait(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){var i=XE(t).labelManager;i||(i=XE(t).labelManager=new JLe),i.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(e,t,r){var i=XE(t).labelManager;r.updatedSeries.forEach(function(a){i.addLabelsOfSeries(t.getViewOfSeriesModel(a))}),i.updateLayoutConfig(t),i.layout(t),i.processLabelsOverall()})}var eNe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.hasSymbolVisual=!0,t}return e.prototype.getInitialData=function(t){return fD(null,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(t){var r=new yi,i=hg("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);r.add(i),i.setStyle(t.lineStyle);var a=this.getData().getVisual("symbol"),s=this.getData().getVisual("symbolRotate"),o=a==="none"?"circle":a,l=t.itemHeight*.8,u=hg(o,(t.itemWidth-l)/2,(t.itemHeight-l)/2,l,l,t.itemStyle.fill);r.add(u),u.setStyle(t.itemStyle);var c=t.iconRotate==="inherit"?s:t.iconRotate||0;return u.rotation=c*Math.PI/180,u.setOrigin([t.itemWidth/2,t.itemHeight/2]),o.indexOf("empty")>-1&&(u.style.stroke=u.style.fill,u.style.fill="#fff",u.style.lineWidth=2),r},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(yf);const tNe=eNe;function vD(n,e){var t=n.mapDimensionsAll("defaultedLabel"),r=t.length;if(r===1){var i=fg(n,e,t[0]);return i!=null?i+"":null}else if(r){for(var a=[],s=0;s<t.length;s++)a.push(fg(n,e,t[s]));return a.join(" ")}}function TY(n,e){var t=n.mapDimensionsAll("defaultedLabel");if(!Rt(e))return e+"";for(var r=[],i=0;i<t.length;i++){var a=n.getDimensionIndex(t[i]);a>=0&&r.push(e[a])}return r.join(" ")}var nNe=function(n){ht(e,n);function e(t,r,i,a){var s=n.call(this)||this;return s.updateData(t,r,i,a),s}return e.prototype._createSymbol=function(t,r,i,a,s){this.removeAll();var o=hg(t,-1,-1,2,2,null,s);o.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),o.drift=rNe,this._symbolType=t,this.add(o)},e.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},e.prototype.getSymbolType=function(){return this._symbolType},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){og(this.childAt(0))},e.prototype.downplay=function(){lg(this.childAt(0))},e.prototype.setZ=function(t,r){var i=this.childAt(0);i.zlevel=t,i.z=r},e.prototype.setDraggable=function(t,r){var i=this.childAt(0);i.draggable=t,i.cursor=!r&&t?"move":i.cursor},e.prototype.updateData=function(t,r,i,a){this.silent=!1;var s=t.getItemVisual(r,"symbol")||"circle",o=t.hostModel,l=e.getSymbolSize(t,r),u=s!==this._symbolType,c=a&&a.disableAnimation;if(u){var f=t.getItemVisual(r,"symbolKeepAspect");this._createSymbol(s,t,r,l,f)}else{var h=this.childAt(0);h.silent=!1;var d={scaleX:l[0]/2,scaleY:l[1]/2};c?h.attr(d):Ui(h,d,o,r),BI(h)}if(this._updateCommon(t,r,l,i,a),u){var h=this.childAt(0);if(!c){var d={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:h.style.opacity}};h.scaleX=h.scaleY=0,h.style.opacity=0,_a(h,d,o,r)}}c&&this.childAt(0).stopAnimation("leave")},e.prototype._updateCommon=function(t,r,i,a,s){var o=this.childAt(0),l=t.hostModel,u,c,f,h,d,p,m,g,v;if(a&&(u=a.emphasisItemStyle,c=a.blurItemStyle,f=a.selectItemStyle,h=a.focus,d=a.blurScope,m=a.labelStatesModels,g=a.hoverScale,v=a.cursorStyle,p=a.emphasisDisabled),!a||t.hasItemOption){var _=a&&a.itemModel?a.itemModel:t.getItemModel(r),x=_.getModel("emphasis");u=x.getModel("itemStyle").getItemStyle(),f=_.getModel(["select","itemStyle"]).getItemStyle(),c=_.getModel(["blur","itemStyle"]).getItemStyle(),h=x.get("focus"),d=x.get("blurScope"),p=x.get("disabled"),m=D_(_),g=x.getShallow("scale"),v=_.getShallow("cursor")}var b=t.getItemVisual(r,"symbolRotate");o.attr("rotation",(b||0)*Math.PI/180||0);var S=gK(t.getItemVisual(r,"symbolOffset"),i);S&&(o.x=S[0],o.y=S[1]),v&&o.attr("cursor",v);var T=t.getItemVisual(r,"style"),M=T.fill;if(o instanceof zd){var C=o.style;o.useStyle(gt({image:C.image,x:C.x,y:C.y,width:C.width,height:C.height},T))}else o.__isEmptyBrush?o.useStyle(gt({},T)):o.useStyle(T),o.style.decal=null,o.setColor(M,s&&s.symbolInnerColor),o.style.strokeNoScale=!0;var k=t.getItemVisual(r,"liftZ"),R=this._z2;k!=null?R==null&&(this._z2=o.z2,o.z2+=k):R!=null&&(o.z2=R,this._z2=null);var P=s&&s.useNameLabel;I_(o,m,{labelFetcher:l,labelDataIndex:r,defaultText:N,inheritColor:M,defaultOpacity:T.opacity});function N(O){return P?t.getName(O):vD(t,O)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var L=o.ensureState("emphasis");L.style=u,o.ensureState("select").style=f,o.ensureState("blur").style=c;var F=g==null||g===!0?Math.max(1.1,3/this._sizeY):isFinite(g)&&g>0?+g:1;L.scaleX=this._sizeX*F,L.scaleY=this._sizeY*F,this.setSymbolScale(1),z0(this,h,d,p)},e.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},e.prototype.fadeOut=function(t,r,i){var a=this.childAt(0),s=ar(this).dataIndex,o=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var l=a.getTextContent();l&&Fw(l,{style:{opacity:0}},r,{dataIndex:s,removeOpt:o,cb:function(){a.removeTextContent()}})}else a.removeTextContent();Fw(a,{style:{opacity:0},scaleX:0,scaleY:0},r,{dataIndex:s,cb:t,removeOpt:o})},e.getSymbolSize=function(t,r){return NIe(t.getItemVisual(r,"symbolSize"))},e}(yi);function rNe(n,e){this.parent.drift(n,e)}const yD=nNe;function KE(n,e,t,r){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(r.isIgnore&&r.isIgnore(t))&&!(r.clipShape&&!r.clipShape.contain(e[0],e[1]))&&n.getItemVisual(t,"symbol")!=="none"}function IV(n){return n!=null&&!Yt(n)&&(n={isIgnore:n}),n||{}}function DV(n){var e=n.hostModel,t=e.getModel("emphasis");return{emphasisItemStyle:t.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:t.get("focus"),blurScope:t.get("blurScope"),emphasisDisabled:t.get("disabled"),hoverScale:t.get("scale"),labelStatesModels:D_(e),cursorStyle:e.get("cursor")}}var iNe=function(){function n(e){this.group=new yi,this._SymbolCtor=e||yD}return n.prototype.updateData=function(e,t){this._progressiveEls=null,t=IV(t);var r=this.group,i=e.hostModel,a=this._data,s=this._SymbolCtor,o=t.disableAnimation,l=DV(e),u={disableAnimation:o},c=t.getSymbolPoint||function(f){return e.getItemLayout(f)};a||r.removeAll(),e.diff(a).add(function(f){var h=c(f);if(KE(e,h,f,t)){var d=new s(e,f,l,u);d.setPosition(h),e.setItemGraphicEl(f,d),r.add(d)}}).update(function(f,h){var d=a.getItemGraphicEl(h),p=c(f);if(!KE(e,p,f,t)){r.remove(d);return}var m=e.getItemVisual(f,"symbol")||"circle",g=d&&d.getSymbolType&&d.getSymbolType();if(!d||g&&g!==m)r.remove(d),d=new s(e,f,l,u),d.setPosition(p);else{d.updateData(e,f,l,u);var v={x:p[0],y:p[1]};o?d.attr(v):Ui(d,v,i)}r.add(d),e.setItemGraphicEl(f,d)}).remove(function(f){var h=a.getItemGraphicEl(f);h&&h.fadeOut(function(){r.remove(h)},i)}).execute(),this._getSymbolPoint=c,this._data=e},n.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl(function(r,i){var a=e._getSymbolPoint(i);r.setPosition(a),r.markRedraw()})},n.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=DV(e),this._data=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(e,t,r){this._progressiveEls=[],r=IV(r);function i(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var a=e.start;a<e.end;a++){var s=t.getItemLayout(a);if(KE(t,s,a,r)){var o=new this._SymbolCtor(t,a,this._seriesScope);o.traverse(i),o.setPosition(s),this.group.add(o),t.setItemGraphicEl(a,o),this._progressiveEls.push(o)}}},n.prototype.eachRendered=function(e){AT(this._progressiveEls||this.group,e)},n.prototype.remove=function(e){var t=this.group,r=this._data;r&&e?r.eachItemGraphicEl(function(i){i.fadeOut(function(){t.remove(i)},r.hostModel)}):t.removeAll()},n}();const aNe=iNe;function CY(n,e,t){var r=n.getBaseAxis(),i=n.getOtherAxis(r),a=sNe(i,t),s=r.dim,o=i.dim,l=e.mapDimension(o),u=e.mapDimension(s),c=o==="x"||o==="radius"?1:0,f=Nt(n.dimensions,function(p){return e.mapDimension(p)}),h=!1,d=e.getCalculationInfo("stackResultDimension");return xd(e,f[0])&&(h=!0,f[0]=d),xd(e,f[1])&&(h=!0,f[1]=d),{dataDimsForPoint:f,valueStart:a,valueAxisDim:o,baseAxisDim:s,stacked:!!h,valueDim:l,baseDim:u,baseDataOffset:c,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function sNe(n,e){var t=0,r=n.scale.getExtent();return e==="start"?t=r[0]:e==="end"?t=r[1]:gr(e)&&!isNaN(e)?t=e:r[0]>0?t=r[0]:r[1]<0&&(t=r[1]),t}function EY(n,e,t,r){var i=NaN;n.stacked&&(i=t.get(t.getCalculationInfo("stackedOverDimension"),r)),isNaN(i)&&(i=n.valueStart);var a=n.baseDataOffset,s=[];return s[a]=t.get(n.baseDim,r),s[1-a]=i,e.dataToPoint(s)}function oNe(n,e){var t=[];return e.diff(n).add(function(r){t.push({cmd:"+",idx:r})}).update(function(r,i){t.push({cmd:"=",idx:i,idx1:r})}).remove(function(r){t.push({cmd:"-",idx:r})}).execute(),t}function lNe(n,e,t,r,i,a,s,o){for(var l=oNe(n,e),u=[],c=[],f=[],h=[],d=[],p=[],m=[],g=CY(i,e,s),v=n.getLayout("points")||[],_=e.getLayout("points")||[],x=0;x<l.length;x++){var b=l[x],S=!0,T=void 0,M=void 0;switch(b.cmd){case"=":T=b.idx*2,M=b.idx1*2;var C=v[T],k=v[T+1],R=_[M],P=_[M+1];(isNaN(C)||isNaN(k))&&(C=R,k=P),u.push(C,k),c.push(R,P),f.push(t[T],t[T+1]),h.push(r[M],r[M+1]),m.push(e.getRawIndex(b.idx1));break;case"+":var N=b.idx,L=g.dataDimsForPoint,F=i.dataToPoint([e.get(L[0],N),e.get(L[1],N)]);M=N*2,u.push(F[0],F[1]),c.push(_[M],_[M+1]);var O=EY(g,i,e,N);f.push(O[0],O[1]),h.push(r[M],r[M+1]),m.push(e.getRawIndex(N));break;case"-":S=!1}S&&(d.push(b),p.push(p.length))}p.sort(function(Ne,we){return m[Ne]-m[we]});for(var B=u.length,H=Nu(B),j=Nu(B),K=Nu(B),J=Nu(B),re=[],x=0;x<p.length;x++){var se=p[x],Ae=x*2,Ee=se*2;H[Ae]=u[Ee],H[Ae+1]=u[Ee+1],j[Ae]=c[Ee],j[Ae+1]=c[Ee+1],K[Ae]=f[Ee],K[Ae+1]=f[Ee+1],J[Ae]=h[Ee],J[Ae+1]=h[Ee+1],re[x]=d[se]}return{current:H,next:j,stackedOnCurrent:K,stackedOnNext:J,status:re}}var Rc=Math.min,Pc=Math.max;function nd(n,e){return isNaN(n)||isNaN(e)}function Lk(n,e,t,r,i,a,s,o,l){for(var u,c,f,h,d,p,m=t,g=0;g<r;g++){var v=e[m*2],_=e[m*2+1];if(m>=i||m<0)break;if(nd(v,_)){if(l){m+=a;continue}break}if(m===t)n[a>0?"moveTo":"lineTo"](v,_),f=v,h=_;else{var x=v-u,b=_-c;if(x*x+b*b<.5){m+=a;continue}if(s>0){for(var S=m+a,T=e[S*2],M=e[S*2+1];T===v&&M===_&&g<r;)g++,S+=a,m+=a,T=e[S*2],M=e[S*2+1],v=e[m*2],_=e[m*2+1],x=v-u,b=_-c;var C=g+1;if(l)for(;nd(T,M)&&C<r;)C++,S+=a,T=e[S*2],M=e[S*2+1];var k=.5,R=0,P=0,N=void 0,L=void 0;if(C>=r||nd(T,M))d=v,p=_;else{R=T-u,P=M-c;var F=v-u,O=T-v,B=_-c,H=M-_,j=void 0,K=void 0;if(o==="x"){j=Math.abs(F),K=Math.abs(O);var J=R>0?1:-1;d=v-J*j*s,p=_,N=v+J*K*s,L=_}else if(o==="y"){j=Math.abs(B),K=Math.abs(H);var re=P>0?1:-1;d=v,p=_-re*j*s,N=v,L=_+re*K*s}else j=Math.sqrt(F*F+B*B),K=Math.sqrt(O*O+H*H),k=K/(K+j),d=v-R*s*(1-k),p=_-P*s*(1-k),N=v+R*s*k,L=_+P*s*k,N=Rc(N,Pc(T,v)),L=Rc(L,Pc(M,_)),N=Pc(N,Rc(T,v)),L=Pc(L,Rc(M,_)),R=N-v,P=L-_,d=v-R*j/K,p=_-P*j/K,d=Rc(d,Pc(u,v)),p=Rc(p,Pc(c,_)),d=Pc(d,Rc(u,v)),p=Pc(p,Rc(c,_)),R=v-d,P=_-p,N=v+R*K/j,L=_+P*K/j}n.bezierCurveTo(f,h,d,p,v,_),f=N,h=L}else n.lineTo(v,_)}u=v,c=_,m+=a}return g}var AY=function(){function n(){this.smooth=0,this.smoothConstraint=!0}return n}(),uNe=function(n){ht(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polyline",r}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new AY},e.prototype.buildPath=function(t,r){var i=r.points,a=0,s=i.length/2;if(r.connectNulls){for(;s>0&&nd(i[s*2-2],i[s*2-1]);s--);for(;a<s&&nd(i[a*2],i[a*2+1]);a++);}for(;a<s;)a+=Lk(t,i,a,s,s,1,r.smooth,r.smoothMonotone,r.connectNulls)+1},e.prototype.getPointOn=function(t,r){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,s=Xu.CMD,o,l,u=r==="x",c=[],f=0;f<a.length;){var h=a[f++],d=void 0,p=void 0,m=void 0,g=void 0,v=void 0,_=void 0,x=void 0;switch(h){case s.M:o=a[f++],l=a[f++];break;case s.L:if(d=a[f++],p=a[f++],x=u?(t-o)/(d-o):(t-l)/(p-l),x<=1&&x>=0){var b=u?(p-l)*x+l:(d-o)*x+o;return u?[t,b]:[b,t]}o=d,l=p;break;case s.C:d=a[f++],p=a[f++],m=a[f++],g=a[f++],v=a[f++],_=a[f++];var S=u?kw(o,d,m,v,t,c):kw(l,p,g,_,t,c);if(S>0)for(var T=0;T<S;T++){var M=c[T];if(M<=1&&M>=0){var b=u?Si(l,p,g,_,M):Si(o,d,m,v,M);return u?[t,b]:[b,t]}}o=v,l=_;break}}},e}(Wn),cNe=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(AY),fNe=function(n){ht(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polygon",r}return e.prototype.getDefaultShape=function(){return new cNe},e.prototype.buildPath=function(t,r){var i=r.points,a=r.stackedOnPoints,s=0,o=i.length/2,l=r.smoothMonotone;if(r.connectNulls){for(;o>0&&nd(i[o*2-2],i[o*2-1]);o--);for(;s<o&&nd(i[s*2],i[s*2+1]);s++);}for(;s<o;){var u=Lk(t,i,s,o,o,1,r.smooth,l,r.connectNulls);Lk(t,a,s+u-1,u,o,-1,r.stackedOnSmooth,l,r.connectNulls),s+=u+1,t.closePath()}},e}(Wn);function MY(n,e,t,r,i){var a=n.getArea(),s=a.x,o=a.y,l=a.width,u=a.height,c=t.get(["lineStyle","width"])||2;s-=c/2,o-=c/2,l+=c,u+=c,s=Math.floor(s),l=Math.round(l);var f=new oi({shape:{x:s,y:o,width:l,height:u}});if(e){var h=n.getBaseAxis(),d=h.isHorizontal(),p=h.inverse;d?(p&&(f.shape.x+=l),f.shape.width=0):(p||(f.shape.y+=u),f.shape.height=0);var m=pn(i)?function(g){i(g,f)}:null;_a(f,{shape:{width:l,height:u,x:s,y:o}},t,null,r,m)}return f}function kY(n,e,t){var r=n.getArea(),i=vi(r.r0,1),a=vi(r.r,1),s=new tl({shape:{cx:vi(n.cx,1),cy:vi(n.cy,1),r0:i,r:a,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});if(e){var o=n.getBaseAxis().dim==="angle";o?s.shape.endAngle=r.startAngle:s.shape.r=i,_a(s,{shape:{endAngle:r.endAngle,r:a}},t)}return s}function hNe(n,e,t,r,i){if(n){if(n.type==="polar")return kY(n,e,t);if(n.type==="cartesian2d")return MY(n,e,t,r,i)}else return null;return null}function _D(n,e){return n.type===e}function LV(n,e){if(n.length===e.length){for(var t=0;t<n.length;t++)if(n[t]!==e[t])return;return!0}}function NV(n){for(var e=1/0,t=1/0,r=-1/0,i=-1/0,a=0;a<n.length;){var s=n[a++],o=n[a++];isNaN(s)||(e=Math.min(s,e),r=Math.max(s,r)),isNaN(o)||(t=Math.min(o,t),i=Math.max(o,i))}return[[e,t],[r,i]]}function OV(n,e){var t=NV(n),r=t[0],i=t[1],a=NV(e),s=a[0],o=a[1];return Math.max(Math.abs(r[0]-s[0]),Math.abs(r[1]-s[1]),Math.abs(i[0]-o[0]),Math.abs(i[1]-o[1]))}function $V(n){return gr(n)?n:n?.5:0}function dNe(n,e,t){if(!t.valueDim)return[];for(var r=e.count(),i=Nu(r*2),a=0;a<r;a++){var s=EY(t,n,e,a);i[a*2]=s[0],i[a*2+1]=s[1]}return i}function Ic(n,e,t,r){var i=e.getBaseAxis(),a=i.dim==="x"||i.dim==="radius"?0:1,s=[],o=0,l=[],u=[],c=[],f=[];if(r){for(o=0;o<n.length;o+=2)!isNaN(n[o])&&!isNaN(n[o+1])&&f.push(n[o],n[o+1]);n=f}for(o=0;o<n.length-2;o+=2)switch(c[0]=n[o+2],c[1]=n[o+3],u[0]=n[o],u[1]=n[o+1],s.push(u[0],u[1]),t){case"end":l[a]=c[a],l[1-a]=u[1-a],s.push(l[0],l[1]);break;case"middle":var h=(u[a]+c[a])/2,d=[];l[a]=d[a]=h,l[1-a]=u[1-a],d[1-a]=c[1-a],s.push(l[0],l[1]),s.push(d[0],d[1]);break;default:l[a]=u[a],l[1-a]=c[1-a],s.push(l[0],l[1])}return s.push(n[o++],n[o++]),s}function pNe(n,e){var t=[],r=n.length,i,a;function s(c,f,h){var d=c.coord,p=(h-d)/(f.coord-d),m=UEe(p,[c.color,f.color]);return{coord:h,color:m}}for(var o=0;o<r;o++){var l=n[o],u=l.coord;if(u<0)i=l;else if(u>e){a?t.push(s(a,l,e)):i&&t.push(s(i,l,0),s(i,l,e));break}else i&&(t.push(s(i,l,0)),i=null),t.push(l),a=l}return t}function mNe(n,e,t){var r=n.getVisual("visualMeta");if(!(!r||!r.length||!n.count())&&e.type==="cartesian2d"){for(var i,a,s=r.length-1;s>=0;s--){var o=n.getDimensionInfo(r[s].dimension);if(i=o&&o.coordDim,i==="x"||i==="y"){a=r[s];break}}if(a){var l=e.getAxis(i),u=Nt(a.stops,function(x){return{coord:l.toGlobalCoord(l.dataToCoord(x.value)),color:x.color}}),c=u.length,f=a.outerColors.slice();c&&u[0].coord>u[c-1].coord&&(u.reverse(),f.reverse());var h=pNe(u,i==="x"?t.getWidth():t.getHeight()),d=h.length;if(!d&&c)return u[0].coord<0?f[1]?f[1]:u[c-1].color:f[0]?f[0]:u[0].color;var p=10,m=h[0].coord-p,g=h[d-1].coord+p,v=g-m;if(v<.001)return"transparent";ce(h,function(x){x.offset=(x.coord-m)/v}),h.push({offset:d?h[d-1].offset:.5,color:f[1]||"transparent"}),h.unshift({offset:d?h[0].offset:.5,color:f[0]||"transparent"});var _=new sX(0,0,0,0,h,!0);return _[i]=m,_[i+"2"]=g,_}}}function gNe(n,e,t){var r=n.get("showAllSymbol"),i=r==="auto";if(!(r&&!i)){var a=t.getAxesByScale("ordinal")[0];if(a&&!(i&&vNe(a,e))){var s=e.mapDimension(a.dim),o={};return ce(a.getViewLabels(),function(l){var u=a.scale.getRawOrdinalNumber(l.tickValue);o[u]=1}),function(l){return!o.hasOwnProperty(e.get(s,l))}}}}function vNe(n,e){var t=n.getExtent(),r=Math.abs(t[1]-t[0])/n.scale.count();isNaN(r)&&(r=0);for(var i=e.count(),a=Math.max(1,Math.round(i/5)),s=0;s<i;s+=a)if(yD.getSymbolSize(e,s)[n.isHorizontal()?1:0]*1.5>r)return!1;return!0}function yNe(n,e){return isNaN(n)||isNaN(e)}function _Ne(n){for(var e=n.length/2;e>0&&yNe(n[e*2-2],n[e*2-1]);e--);return e-1}function FV(n,e){return[n[e*2],n[e*2+1]]}function xNe(n,e,t){for(var r=n.length/2,i=t==="x"?0:1,a,s,o=0,l=-1,u=0;u<r;u++)if(s=n[u*2+i],!(isNaN(s)||isNaN(n[u*2+1-i]))){if(u===0){a=s;continue}if(a<=e&&s>=e||a>=e&&s<=e){l=u;break}o=u,a=s}return{range:[o,l],t:(e-a)/(s-a)}}function RY(n){if(n.get(["endLabel","show"]))return!0;for(var e=0;e<xo.length;e++)if(n.get([xo[e],"endLabel","show"]))return!0;return!1}function YE(n,e,t,r){if(_D(e,"cartesian2d")){var i=r.getModel("endLabel"),a=i.get("valueAnimation"),s=r.getData(),o={lastFrameIndex:0},l=RY(r)?function(d,p){n._endLabelOnDuring(d,p,s,o,a,i,e)}:null,u=e.getBaseAxis().isHorizontal(),c=MY(e,t,r,function(){var d=n._endLabel;d&&t&&o.originalX!=null&&d.attr({x:o.originalX,y:o.originalY})},l);if(!r.get("clip",!0)){var f=c.shape,h=Math.max(f.width,f.height);u?(f.y-=h,f.height+=h*2):(f.x-=h,f.width+=h*2)}return l&&l(1,c),c}else return kY(e,t,r)}function bNe(n,e){var t=e.getBaseAxis(),r=t.isHorizontal(),i=t.inverse,a=r?i?"right":"left":"center",s=r?"middle":i?"top":"bottom";return{normal:{align:n.get("align")||a,verticalAlign:n.get("verticalAlign")||s}}}var wNe=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(){var t=new yi,r=new aNe;this.group.add(r.group),this._symbolDraw=r,this._lineGroup=t},e.prototype.render=function(t,r,i){var a=this,s=t.coordinateSystem,o=this.group,l=t.getData(),u=t.getModel("lineStyle"),c=t.getModel("areaStyle"),f=l.getLayout("points")||[],h=s.type==="polar",d=this._coordSys,p=this._symbolDraw,m=this._polyline,g=this._polygon,v=this._lineGroup,_=!r.ssr&&t.isAnimationEnabled(),x=!c.isEmpty(),b=c.get("origin"),S=CY(s,l,b),T=x&&dNe(s,l,S),M=t.get("showSymbol"),C=t.get("connectNulls"),k=M&&!h&&gNe(t,l,s),R=this._data;R&&R.eachItemGraphicEl(function(we,me){we.__temp&&(o.remove(we),R.setItemGraphicEl(me,null))}),M||p.remove(),o.add(v);var P=h?!1:t.get("step"),N;s&&s.getArea&&t.get("clip",!0)&&(N=s.getArea(),N.width!=null?(N.x-=.1,N.y-=.1,N.width+=.2,N.height+=.2):N.r0&&(N.r0-=.5,N.r+=.5)),this._clipShapeForSymbol=N;var L=mNe(l,s,i)||l.getVisual("style")[l.getVisual("drawType")];if(!(m&&d.type===s.type&&P===this._step))M&&p.updateData(l,{isIgnore:k,clipShape:N,disableAnimation:!0,getSymbolPoint:function(we){return[f[we*2],f[we*2+1]]}}),_&&this._initSymbolLabelAnimation(l,s,N),P&&(f=Ic(f,s,P,C),T&&(T=Ic(T,s,P,C))),m=this._newPolyline(f),x?g=this._newPolygon(f,T):g&&(v.remove(g),g=this._polygon=null),h||this._initOrUpdateEndLabel(t,s,_d(L)),v.setClipPath(YE(this,s,!0,t));else{x&&!g?g=this._newPolygon(f,T):g&&!x&&(v.remove(g),g=this._polygon=null),h||this._initOrUpdateEndLabel(t,s,_d(L));var F=v.getClipPath();if(F){var O=YE(this,s,!1,t);_a(F,{shape:O.shape},t)}else v.setClipPath(YE(this,s,!0,t));M&&p.updateData(l,{isIgnore:k,clipShape:N,disableAnimation:!0,getSymbolPoint:function(we){return[f[we*2],f[we*2+1]]}}),(!LV(this._stackedOnPoints,T)||!LV(this._points,f))&&(_?this._doUpdateAnimation(l,T,s,i,P,b,C):(P&&(f=Ic(f,s,P,C),T&&(T=Ic(T,s,P,C))),m.setShape({points:f}),g&&g.setShape({points:f,stackedOnPoints:T})))}var B=t.getModel("emphasis"),H=B.get("focus"),j=B.get("blurScope"),K=B.get("disabled");if(m.useStyle(ln(u.getLineStyle(),{fill:"none",stroke:L,lineJoin:"bevel"})),Ow(m,t,"lineStyle"),m.style.lineWidth>0&&t.get(["emphasis","lineStyle","width"])==="bolder"){var J=m.getState("emphasis").style;J.lineWidth=+m.style.lineWidth+1}ar(m).seriesIndex=t.seriesIndex,z0(m,H,j,K);var re=$V(t.get("smooth")),se=t.get("smoothMonotone");if(m.setShape({smooth:re,smoothMonotone:se,connectNulls:C}),g){var Ae=l.getCalculationInfo("stackedOnSeries"),Ee=0;g.useStyle(ln(c.getAreaStyle(),{fill:L,opacity:.7,lineJoin:"bevel",decal:l.getVisual("style").decal})),Ae&&(Ee=$V(Ae.get("smooth"))),g.setShape({smooth:re,stackedOnSmooth:Ee,smoothMonotone:se,connectNulls:C}),Ow(g,t,"areaStyle"),ar(g).seriesIndex=t.seriesIndex,z0(g,H,j,K)}var Ne=function(we){a._changePolyState(we)};l.eachItemGraphicEl(function(we){we&&(we.onHoverStateChange=Ne)}),this._polyline.onHoverStateChange=Ne,this._data=l,this._coordSys=s,this._stackedOnPoints=T,this._points=f,this._step=P,this._valueOrigin=b,t.get("triggerLineEvent")&&(this.packEventData(t,m),g&&this.packEventData(t,g))},e.prototype.packEventData=function(t,r){ar(r).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},e.prototype.highlight=function(t,r,i,a){var s=t.getData(),o=yd(s,a);if(this._changePolyState("emphasis"),!(o instanceof Array)&&o!=null&&o>=0){var l=s.getLayout("points"),u=s.getItemGraphicEl(o);if(!u){var c=l[o*2],f=l[o*2+1];if(isNaN(c)||isNaN(f)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(c,f))return;var h=t.get("zlevel")||0,d=t.get("z")||0;u=new yD(s,o),u.x=c,u.y=f,u.setZ(h,d);var p=u.getSymbolPath().getTextContent();p&&(p.zlevel=h,p.z=d,p.z2=this._polyline.z2+1),u.__temp=!0,s.setItemGraphicEl(o,u),u.stopSymbolAnimation(!0),this.group.add(u)}u.highlight()}else Ul.prototype.highlight.call(this,t,r,i,a)},e.prototype.downplay=function(t,r,i,a){var s=t.getData(),o=yd(s,a);if(this._changePolyState("normal"),o!=null&&o>=0){var l=s.getItemGraphicEl(o);l&&(l.__temp?(s.setItemGraphicEl(o,null),this.group.remove(l)):l.downplay())}else Ul.prototype.downplay.call(this,t,r,i,a)},e.prototype._changePolyState=function(t){var r=this._polygon;jU(this._polyline,t),r&&jU(r,t)},e.prototype._newPolyline=function(t){var r=this._polyline;return r&&this._lineGroup.remove(r),r=new uNe({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(r),this._polyline=r,r},e.prototype._newPolygon=function(t,r){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new fNe({shape:{points:t,stackedOnPoints:r},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},e.prototype._initSymbolLabelAnimation=function(t,r,i){var a,s,o=r.getBaseAxis(),l=o.inverse;r.type==="cartesian2d"?(a=o.isHorizontal(),s=!1):r.type==="polar"&&(a=o.dim==="angle",s=!0);var u=t.hostModel,c=u.get("animationDuration");pn(c)&&(c=c(null));var f=u.get("animationDelay")||0,h=pn(f)?f(null):f;t.eachItemGraphicEl(function(d,p){var m=d;if(m){var g=[d.x,d.y],v=void 0,_=void 0,x=void 0;if(i)if(s){var b=i,S=r.pointToCoord(g);a?(v=b.startAngle,_=b.endAngle,x=-S[1]/180*Math.PI):(v=b.r0,_=b.r,x=S[0])}else{var T=i;a?(v=T.x,_=T.x+T.width,x=d.x):(v=T.y+T.height,_=T.y,x=d.y)}var M=_===v?0:(x-v)/(_-v);l&&(M=1-M);var C=pn(f)?f(p):c*M+h,k=m.getSymbolPath(),R=k.getTextContent();m.attr({scaleX:0,scaleY:0}),m.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:C}),R&&R.animateFrom({style:{opacity:0}},{duration:300,delay:C}),k.disableLabelAnimation=!0}})},e.prototype._initOrUpdateEndLabel=function(t,r,i){var a=t.getModel("endLabel");if(RY(t)){var s=t.getData(),o=this._polyline,l=s.getLayout("points");if(!l){o.removeTextContent(),this._endLabel=null;return}var u=this._endLabel;u||(u=this._endLabel=new Pi({z2:200}),u.ignoreClip=!0,o.setTextContent(this._endLabel),o.disableLabelAnimation=!0);var c=_Ne(l);c>=0&&(I_(o,D_(t,"endLabel"),{inheritColor:i,labelFetcher:t,labelDataIndex:c,defaultText:function(f,h,d){return d!=null?TY(s,d):vD(s,f)},enableTextSetter:!0},bNe(a,r)),o.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},e.prototype._endLabelOnDuring=function(t,r,i,a,s,o,l){var u=this._endLabel,c=this._polyline;if(u){t<1&&a.originalX==null&&(a.originalX=u.x,a.originalY=u.y);var f=i.getLayout("points"),h=i.hostModel,d=h.get("connectNulls"),p=o.get("precision"),m=o.get("distance")||0,g=l.getBaseAxis(),v=g.isHorizontal(),_=g.inverse,x=r.shape,b=_?v?x.x:x.y+x.height:v?x.x+x.width:x.y,S=(v?m:0)*(_?-1:1),T=(v?0:-m)*(_?-1:1),M=v?"x":"y",C=xNe(f,b,M),k=C.range,R=k[1]-k[0],P=void 0;if(R>=1){if(R>1&&!d){var N=FV(f,k[0]);u.attr({x:N[0]+S,y:N[1]+T}),s&&(P=h.getRawValue(k[0]))}else{var N=c.getPointOn(b,M);N&&u.attr({x:N[0]+S,y:N[1]+T});var L=h.getRawValue(k[0]),F=h.getRawValue(k[1]);s&&(P=gq(i,p,L,F,C.t))}a.lastFrameIndex=k[0]}else{var O=t===1||a.lastFrameIndex>0?k[0]:0,N=FV(f,O);s&&(P=h.getRawValue(O)),u.attr({x:N[0]+S,y:N[1]+T})}s&&Gg(u).setLabelText(P)}},e.prototype._doUpdateAnimation=function(t,r,i,a,s,o,l){var u=this._polyline,c=this._polygon,f=t.hostModel,h=lNe(this._data,t,this._stackedOnPoints,r,this._coordSys,i,this._valueOrigin),d=h.current,p=h.stackedOnCurrent,m=h.next,g=h.stackedOnNext;if(s&&(d=Ic(h.current,i,s,l),p=Ic(h.stackedOnCurrent,i,s,l),m=Ic(h.next,i,s,l),g=Ic(h.stackedOnNext,i,s,l)),OV(d,m)>3e3||c&&OV(p,g)>3e3){u.stopAnimation(),u.setShape({points:m}),c&&(c.stopAnimation(),c.setShape({points:m,stackedOnPoints:g}));return}u.shape.__points=h.current,u.shape.points=d;var v={shape:{points:m}};h.current!==d&&(v.shape.__points=h.next),u.stopAnimation(),Ui(u,v,f),c&&(c.setShape({points:d,stackedOnPoints:p}),c.stopAnimation(),Ui(c,{shape:{stackedOnPoints:g}},f),u.shape.points!==c.shape.points&&(c.shape.points=u.shape.points));for(var _=[],x=h.status,b=0;b<x.length;b++){var S=x[b].cmd;if(S==="="){var T=t.getItemGraphicEl(x[b].idx1);T&&_.push({el:T,ptIdx:b})}}u.animators&&u.animators.length&&u.animators[0].during(function(){c&&c.dirtyShape();for(var M=u.shape.__points,C=0;C<_.length;C++){var k=_[C].el,R=_[C].ptIdx*2;k.x=M[R],k.y=M[R+1],k.markRedraw()}})},e.prototype.remove=function(t){var r=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,s){a.__temp&&(r.remove(a),i.setItemGraphicEl(s,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},e.type="line",e}(Ul);const SNe=wNe;function TNe(n,e){return{seriesType:n,plan:rD(),reset:function(t){var r=t.getData(),i=t.coordinateSystem,a=t.pipelineContext,s=e||a.large;if(i){var o=Nt(i.dimensions,function(d){return r.mapDimension(d)}).slice(0,2),l=o.length,u=r.getCalculationInfo("stackResultDimension");xd(r,o[0])&&(o[0]=u),xd(r,o[1])&&(o[1]=u);var c=r.getStore(),f=r.getDimensionIndex(o[0]),h=r.getDimensionIndex(o[1]);return l&&{progress:function(d,p){for(var m=d.end-d.start,g=s&&Nu(m*l),v=[],_=[],x=d.start,b=0;x<d.end;x++){var S=void 0;if(l===1){var T=c.get(f,x);S=i.dataToPoint(T,null,_)}else v[0]=c.get(f,x),v[1]=c.get(h,x),S=i.dataToPoint(v,null,_);s?(g[b++]=S[0],g[b++]=S[1]):p.setItemLayout(x,S.slice())}s&&p.setLayout("points",g)}}}}}}var CNe={average:function(n){for(var e=0,t=0,r=0;r<n.length;r++)isNaN(n[r])||(e+=n[r],t++);return t===0?NaN:e/t},sum:function(n){for(var e=0,t=0;t<n.length;t++)e+=n[t]||0;return e},max:function(n){for(var e=-1/0,t=0;t<n.length;t++)n[t]>e&&(e=n[t]);return isFinite(e)?e:NaN},min:function(n){for(var e=1/0,t=0;t<n.length;t++)n[t]<e&&(e=n[t]);return isFinite(e)?e:NaN},nearest:function(n){return n[0]}},ENe=function(n){return Math.round(n.length/2)};function PY(n){return{seriesType:n,reset:function(e,t,r){var i=e.getData(),a=e.get("sampling"),s=e.coordinateSystem,o=i.count();if(o>10&&s.type==="cartesian2d"&&a){var l=s.getBaseAxis(),u=s.getOtherAxis(l),c=l.getExtent(),f=r.getDevicePixelRatio(),h=Math.abs(c[1]-c[0])*(f||1),d=Math.round(o/h);if(isFinite(d)&&d>1){a==="lttb"&&e.setData(i.lttbDownSample(i.mapDimension(u.dim),1/d));var p=void 0;jt(a)?p=CNe[a]:pn(a)&&(p=a),p&&e.setData(i.downSample(i.mapDimension(u.dim),1/d,p,ENe))}}}}}function sit(n){n.registerChartView(SNe),n.registerSeriesModel(tNe),n.registerLayout(TNe("line",!0)),n.registerVisual({seriesType:"line",reset:function(e){var t=e.getData(),r=e.getModel("lineStyle").getLineStyle();r&&!r.stroke&&(r.stroke=t.getVisual("style").fill),t.setVisual("legendLineStyle",r)}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,PY("line"))}var IY=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(t,r){return fD(null,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t,r,i){var a=this.coordinateSystem;if(a&&a.clampData){var s=a.clampData(t),o=a.dataToPoint(s);if(i)ce(a.getAxes(),function(h,d){if(h.type==="category"&&r!=null){var p=h.getTicksCoords(),m=s[d],g=r[d]==="x1"||r[d]==="y1";if(g&&(m+=1),p.length<2)return;if(p.length===2){o[d]=h.toGlobalCoord(h.getExtent()[g?1:0]);return}for(var v=void 0,_=void 0,x=1,b=0;b<p.length;b++){var S=p[b].coord,T=b===p.length-1?p[b-1].tickValue+x:p[b].tickValue;if(T===m){_=S;break}else if(T<m)v=S;else if(v!=null&&T>m){_=(S+v)/2;break}b===1&&(x=T-p[0].tickValue)}_==null&&(v?v&&(_=p[p.length-1].coord):_=p[0].coord),o[d]=h.toGlobalCoord(_)}});else{var l=this.getData(),u=l.getLayout("offset"),c=l.getLayout("size"),f=a.getBaseAxis().isHorizontal()?0:1;o[f]+=u+c/2}return o}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(yf);yf.registerClass(IY);const BV=IY;var ANe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(){return fD(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),r=this.get("largeThreshold");return r>t&&(t=r),t},e.prototype.brushSelector=function(t,r,i){return i.rect(r.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=vX(BV.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(BV);const MNe=ANe;var kNe=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),RNe=function(n){ht(e,n);function e(t){var r=n.call(this,t)||this;return r.type="sausage",r}return e.prototype.getDefaultShape=function(){return new kNe},e.prototype.buildPath=function(t,r){var i=r.cx,a=r.cy,s=Math.max(r.r0||0,0),o=Math.max(r.r,0),l=(o-s)*.5,u=s+l,c=r.startAngle,f=r.endAngle,h=r.clockwise,d=Math.PI*2,p=h?f-c<d:c-f<d;p||(c=f-(h?d:-d));var m=Math.cos(c),g=Math.sin(c),v=Math.cos(f),_=Math.sin(f);p?(t.moveTo(m*s+i,g*s+a),t.arc(m*u+i,g*u+a,l,-Math.PI+c,c,!h)):t.moveTo(m*o+i,g*o+a),t.arc(i,a,o,c,f,!h),t.arc(v*u+i,_*u+a,l,f-Math.PI*2,f-Math.PI,!h),s!==0&&t.arc(i,a,s,f,c,h)},e}(Wn);const UV=RNe;function PNe(n,e){e=e||{};var t=e.isRoundCap;return function(r,i,a){var s=i.position;if(!s||s instanceof Array)return Dw(r,i,a);var o=n(s),l=i.distance!=null?i.distance:5,u=this.shape,c=u.cx,f=u.cy,h=u.r,d=u.r0,p=(h+d)/2,m=u.startAngle,g=u.endAngle,v=(m+g)/2,_=t?Math.abs(h-d)/2:0,x=Math.cos,b=Math.sin,S=c+h*x(m),T=f+h*b(m),M="left",C="top";switch(o){case"startArc":S=c+(d-l)*x(v),T=f+(d-l)*b(v),M="center",C="top";break;case"insideStartArc":S=c+(d+l)*x(v),T=f+(d+l)*b(v),M="center",C="bottom";break;case"startAngle":S=c+p*x(m)+qb(m,l+_,!1),T=f+p*b(m)+Xb(m,l+_,!1),M="right",C="middle";break;case"insideStartAngle":S=c+p*x(m)+qb(m,-l+_,!1),T=f+p*b(m)+Xb(m,-l+_,!1),M="left",C="middle";break;case"middle":S=c+p*x(v),T=f+p*b(v),M="center",C="middle";break;case"endArc":S=c+(h+l)*x(v),T=f+(h+l)*b(v),M="center",C="bottom";break;case"insideEndArc":S=c+(h-l)*x(v),T=f+(h-l)*b(v),M="center",C="top";break;case"endAngle":S=c+p*x(g)+qb(g,l+_,!0),T=f+p*b(g)+Xb(g,l+_,!0),M="left",C="middle";break;case"insideEndAngle":S=c+p*x(g)+qb(g,-l+_,!0),T=f+p*b(g)+Xb(g,-l+_,!0),M="right",C="middle";break;default:return Dw(r,i,a)}return r=r||{},r.x=S,r.y=T,r.align=M,r.verticalAlign=C,r}}function INe(n,e,t,r){if(gr(r)){n.setTextConfig({rotation:r});return}else if(Rt(e)){n.setTextConfig({rotation:0});return}var i=n.shape,a=i.clockwise?i.startAngle:i.endAngle,s=i.clockwise?i.endAngle:i.startAngle,o=(a+s)/2,l,u=t(e);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=o;break;case"startAngle":case"insideStartAngle":l=a;break;case"endAngle":case"insideEndAngle":l=s;break;default:n.setTextConfig({rotation:0});return}var c=Math.PI*1.5-l;u==="middle"&&c>Math.PI/2&&c<Math.PI*1.5&&(c-=Math.PI),n.setTextConfig({rotation:c})}function qb(n,e,t){return e*Math.sin(n)*(t?-1:1)}function Xb(n,e,t){return e*Math.cos(n)*(t?1:-1)}function Ty(n,e,t){var r=n.get("borderRadius");if(r==null)return t?{cornerRadius:0}:null;Rt(r)||(r=[r,r,r,r]);var i=Math.abs(e.r||0-e.r0||0);return{cornerRadius:Nt(r,function(a){return mf(a,i)})}}var ZE=Math.max,QE=Math.min;function DNe(n,e){var t=n.getArea&&n.getArea();if(_D(n,"cartesian2d")){var r=n.getBaseAxis();if(r.type!=="category"||!r.onBand){var i=e.getLayout("bandWidth");r.isHorizontal()?(t.x-=i,t.width+=i*2):(t.y-=i,t.height+=i*2)}}return t}var LNe=function(n){ht(e,n);function e(){var t=n.call(this)||this;return t.type=e.type,t._isFirstFrame=!0,t}return e.prototype.render=function(t,r,i,a){this._model=t,this._removeOnRenderedListener(i),this._updateDrawMode(t);var s=t.get("coordinateSystem");(s==="cartesian2d"||s==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(t,r,i):this._renderNormal(t,r,i,a))},e.prototype.incrementalPrepareRender=function(t){this._clear(),this._updateDrawMode(t),this._updateLargeClip(t)},e.prototype.incrementalRender=function(t,r){this._progressiveEls=[],this._incrementalRenderLarge(t,r)},e.prototype.eachRendered=function(t){AT(this._progressiveEls||this.group,t)},e.prototype._updateDrawMode=function(t){var r=t.pipelineContext.large;(this._isLargeDraw==null||r!==this._isLargeDraw)&&(this._isLargeDraw=r,this._clear())},e.prototype._renderNormal=function(t,r,i,a){var s=this.group,o=t.getData(),l=this._data,u=t.coordinateSystem,c=u.getBaseAxis(),f;u.type==="cartesian2d"?f=c.isHorizontal():u.type==="polar"&&(f=c.dim==="angle");var h=t.isAnimationEnabled()?t:null,d=NNe(t,u);d&&this._enableRealtimeSort(d,o,i);var p=t.get("clip",!0)||d,m=DNe(u,o);s.removeClipPath();var g=t.get("roundCap",!0),v=t.get("showBackground",!0),_=t.getModel("backgroundStyle"),x=_.get("borderRadius")||0,b=[],S=this._backgroundEls,T=a&&a.isInitSort,M=a&&a.type==="changeAxisOrder";function C(P){var N=Kb[u.type](o,P),L=VNe(u,f,N);return L.useStyle(_.getItemStyle()),u.type==="cartesian2d"?L.setShape("r",x):L.setShape("cornerRadius",x),b[P]=L,L}o.diff(l).add(function(P){var N=o.getItemModel(P),L=Kb[u.type](o,P,N);if(v&&C(P),!(!o.hasValue(P)||!GV[u.type](L))){var F=!1;p&&(F=zV[u.type](m,L));var O=VV[u.type](t,o,P,L,f,h,c.model,!1,g);d&&(O.forceLabelAnimation=!0),jV(O,o,P,N,L,t,f,u.type==="polar"),T?O.attr({shape:L}):d?HV(d,h,O,L,P,f,!1,!1):_a(O,{shape:L},t,P),o.setItemGraphicEl(P,O),s.add(O),O.ignore=F}}).update(function(P,N){var L=o.getItemModel(P),F=Kb[u.type](o,P,L);if(v){var O=void 0;S.length===0?O=C(N):(O=S[N],O.useStyle(_.getItemStyle()),u.type==="cartesian2d"?O.setShape("r",x):O.setShape("cornerRadius",x),b[P]=O);var B=Kb[u.type](o,P),H=LY(f,B,u);Ui(O,{shape:H},h,P)}var j=l.getItemGraphicEl(N);if(!o.hasValue(P)||!GV[u.type](F)){s.remove(j);return}var K=!1;if(p&&(K=zV[u.type](m,F),K&&s.remove(j)),j?BI(j):j=VV[u.type](t,o,P,F,f,h,c.model,!!j,g),d&&(j.forceLabelAnimation=!0),M){var J=j.getTextContent();if(J){var re=Gg(J);re.prevValue!=null&&(re.prevValue=re.value)}}else jV(j,o,P,L,F,t,f,u.type==="polar");T?j.attr({shape:F}):d?HV(d,h,j,F,P,f,!0,M):Ui(j,{shape:F},t,P,null),o.setItemGraphicEl(P,j),j.ignore=K,s.add(j)}).remove(function(P){var N=l.getItemGraphicEl(P);N&&Bw(N,t,P)}).execute();var k=this._backgroundGroup||(this._backgroundGroup=new yi);k.removeAll();for(var R=0;R<b.length;++R)k.add(b[R]);s.add(k),this._backgroundEls=b,this._data=o},e.prototype._renderLarge=function(t,r,i){this._clear(),XV(t,this.group),this._updateLargeClip(t)},e.prototype._incrementalRenderLarge=function(t,r){this._removeBackground(),XV(r,this.group,this._progressiveEls,!0)},e.prototype._updateLargeClip=function(t){var r=t.get("clip",!0)&&hNe(t.coordinateSystem,!1,t),i=this.group;r?i.setClipPath(r):i.removeClipPath()},e.prototype._enableRealtimeSort=function(t,r,i){var a=this;if(r.count()){var s=t.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(r,t,i),this._isFirstFrame=!1;else{var o=function(l){var u=r.getItemGraphicEl(l),c=u&&u.shape;return c&&Math.abs(s.isHorizontal()?c.height:c.width)||0};this._onRendered=function(){a._updateSortWithinSameData(r,o,s,i)},i.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(t,r,i){var a=[];return t.each(t.mapDimension(r.dim),function(s,o){var l=i(o);l=l??NaN,a.push({dataIndex:o,mappedValue:l,ordinalNumber:s})}),a.sort(function(s,o){return o.mappedValue-s.mappedValue}),{ordinalNumbers:Nt(a,function(s){return s.ordinalNumber})}},e.prototype._isOrderChangedWithinSameData=function(t,r,i){for(var a=i.scale,s=t.mapDimension(i.dim),o=Number.MAX_VALUE,l=0,u=a.getOrdinalMeta().categories.length;l<u;++l){var c=t.rawIndexOf(s,a.getRawOrdinalNumber(l)),f=c<0?Number.MIN_VALUE:r(t.indexOfRawIndex(c));if(f>o)return!0;o=f}return!1},e.prototype._isOrderDifferentInView=function(t,r){for(var i=r.scale,a=i.getExtent(),s=Math.max(0,a[0]),o=Math.min(a[1],i.getOrdinalMeta().categories.length-1);s<=o;++s)if(t.ordinalNumbers[s]!==i.getRawOrdinalNumber(s))return!0},e.prototype._updateSortWithinSameData=function(t,r,i,a){if(this._isOrderChangedWithinSameData(t,r,i)){var s=this._dataSort(t,i,r);this._isOrderDifferentInView(s,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:s}))}},e.prototype._dispatchInitSort=function(t,r,i){var a=r.baseAxis,s=this._dataSort(t,a,function(o){return t.get(t.mapDimension(r.otherAxis.dim),o)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:s})},e.prototype.remove=function(t,r){this._clear(this._model),this._removeOnRenderedListener(r)},e.prototype.dispose=function(t,r){this._removeOnRenderedListener(r)},e.prototype._removeOnRenderedListener=function(t){this._onRendered&&(t.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(t){var r=this.group,i=this._data;t&&t.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){Bw(a,t,ar(a).dataIndex)})):r.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(Ul),zV={cartesian2d:function(n,e){var t=e.width<0?-1:1,r=e.height<0?-1:1;t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height);var i=n.x+n.width,a=n.y+n.height,s=ZE(e.x,n.x),o=QE(e.x+e.width,i),l=ZE(e.y,n.y),u=QE(e.y+e.height,a),c=o<s,f=u<l;return e.x=c&&s>i?o:s,e.y=f&&l>a?u:l,e.width=c?0:o-s,e.height=f?0:u-l,t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height),c||f},polar:function(n,e){var t=e.r0<=e.r?1:-1;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}var i=QE(e.r,n.r),a=ZE(e.r0,n.r0);e.r=i,e.r0=a;var s=i-a<0;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}return s}},VV={cartesian2d:function(n,e,t,r,i,a,s,o,l){var u=new oi({shape:gt({},r),z2:1});if(u.__dataIndex=t,u.name="item",a){var c=u.shape,f=i?"height":"width";c[f]=0}return u},polar:function(n,e,t,r,i,a,s,o,l){var u=!i&&l?UV:tl,c=new u({shape:r,z2:1});c.name="item";var f=DY(i);if(c.calculateTextPosition=PNe(f,{isRoundCap:u===UV}),a){var h=c.shape,d=i?"r":"endAngle",p={};h[d]=i?r.r0:r.startAngle,p[d]=r[d],(o?Ui:_a)(c,{shape:p},a)}return c}};function NNe(n,e){var t=n.get("realtimeSort",!0),r=e.getBaseAxis();if(t&&r.type==="category"&&e.type==="cartesian2d")return{baseAxis:r,otherAxis:e.getOtherAxis(r)}}function HV(n,e,t,r,i,a,s,o){var l,u;a?(u={x:r.x,width:r.width},l={y:r.y,height:r.height}):(u={y:r.y,height:r.height},l={x:r.x,width:r.width}),o||(s?Ui:_a)(t,{shape:l},e,i,null);var c=e?n.baseAxis.model:null;(s?Ui:_a)(t,{shape:u},c,i)}function WV(n,e){for(var t=0;t<e.length;t++)if(!isFinite(n[e[t]]))return!0;return!1}var ONe=["x","y","width","height"],$Ne=["cx","cy","r","startAngle","endAngle"],GV={cartesian2d:function(n){return!WV(n,ONe)},polar:function(n){return!WV(n,$Ne)}},Kb={cartesian2d:function(n,e,t){var r=n.getItemLayout(e),i=t?BNe(t,r):0,a=r.width>0?1:-1,s=r.height>0?1:-1;return{x:r.x+a*i/2,y:r.y+s*i/2,width:r.width-a*i,height:r.height-s*i}},polar:function(n,e,t){var r=n.getItemLayout(e);return{cx:r.cx,cy:r.cy,r0:r.r0,r:r.r,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}}};function FNe(n){return n.startAngle!=null&&n.endAngle!=null&&n.startAngle===n.endAngle}function DY(n){return function(e){var t=e?"Arc":"Angle";return function(r){switch(r){case"start":case"insideStart":case"end":case"insideEnd":return r+t;default:return r}}}(n)}function jV(n,e,t,r,i,a,s,o){var l=e.getItemVisual(t,"style");if(o){if(!a.get("roundCap")){var c=n.shape,f=Ty(r.getModel("itemStyle"),c,!0);gt(c,f),n.setShape(c)}}else{var u=r.get(["itemStyle","borderRadius"])||0;n.setShape("r",u)}n.useStyle(l);var h=r.getShallow("cursor");h&&n.attr("cursor",h);var d=o?s?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":s?i.height>=0?"bottom":"top":i.width>=0?"right":"left",p=D_(r);I_(n,p,{labelFetcher:a,labelDataIndex:t,defaultText:vD(a.getData(),t),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var m=n.getTextContent();if(o&&m){var g=r.get(["label","position"]);n.textConfig.inside=g==="middle"?!0:null,INe(n,g==="outside"?d:g,DY(s),r.get(["label","rotate"]))}rRe(m,p,a.getRawValue(t),function(_){return TY(e,_)});var v=r.getModel(["emphasis"]);z0(n,v.get("focus"),v.get("blurScope"),v.get("disabled")),Ow(n,r),FNe(i)&&(n.style.fill="none",n.style.stroke="none",ce(n.states,function(_){_.style&&(_.style.fill=_.style.stroke="none")}))}function BNe(n,e){var t=n.get(["itemStyle","borderColor"]);if(!t||t==="none")return 0;var r=n.get(["itemStyle","borderWidth"])||0,i=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),a=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(r,i,a)}var UNe=function(){function n(){}return n}(),qV=function(n){ht(e,n);function e(t){var r=n.call(this,t)||this;return r.type="largeBar",r}return e.prototype.getDefaultShape=function(){return new UNe},e.prototype.buildPath=function(t,r){for(var i=r.points,a=this.baseDimIdx,s=1-this.baseDimIdx,o=[],l=[],u=this.barWidth,c=0;c<i.length;c+=3)l[a]=u,l[s]=i[c+2],o[a]=i[c+a],o[s]=i[c+s],t.rect(o[0],o[1],l[0],l[1])},e}(Wn);function XV(n,e,t,r){var i=n.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,s=i.getLayout("largeDataIndices"),o=i.getLayout("size"),l=n.getModel("backgroundStyle"),u=i.getLayout("largeBackgroundPoints");if(u){var c=new qV({shape:{points:u},incremental:!!r,silent:!0,z2:0});c.baseDimIdx=a,c.largeDataIndices=s,c.barWidth=o,c.useStyle(l.getItemStyle()),e.add(c),t&&t.push(c)}var f=new qV({shape:{points:i.getLayout("largePoints")},incremental:!!r,ignoreCoarsePointer:!0,z2:1});f.baseDimIdx=a,f.largeDataIndices=s,f.barWidth=o,e.add(f),f.useStyle(i.getVisual("style")),ar(f).seriesIndex=n.seriesIndex,n.get("silent")||(f.on("mousedown",KV),f.on("mousemove",KV)),t&&t.push(f)}var KV=aD(function(n){var e=this,t=zNe(e,n.offsetX,n.offsetY);ar(e).dataIndex=t>=0?t:null},30,!1);function zNe(n,e,t){for(var r=n.baseDimIdx,i=1-r,a=n.shape.points,s=n.largeDataIndices,o=[],l=[],u=n.barWidth,c=0,f=a.length/3;c<f;c++){var h=c*3;if(l[r]=u,l[i]=a[h+2],o[r]=a[h+r],o[i]=a[h+i],l[i]<0&&(o[i]+=l[i],l[i]=-l[i]),e>=o[0]&&e<=o[0]+l[0]&&t>=o[1]&&t<=o[1]+l[1])return s[c]}return-1}function LY(n,e,t){if(_D(t,"cartesian2d")){var r=e,i=t.getArea();return{x:n?r.x:i.x,y:n?i.y:r.y,width:n?r.width:i.width,height:n?i.height:r.height}}else{var i=t.getArea(),a=e;return{cx:i.cx,cy:i.cy,r0:n?i.r0:a.r0,r:n?i.r:a.r,startAngle:n?a.startAngle:0,endAngle:n?a.endAngle:Math.PI*2}}}function VNe(n,e,t){var r=n.type==="polar"?tl:oi;return new r({shape:LY(e,t,n),silent:!0,z2:0})}const HNe=LNe;function oit(n){n.registerChartView(HNe),n.registerSeriesModel(MNe),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,ir(sLe,"bar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,oLe("bar")),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,PY("bar")),n.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(e,t){var r=e.componentType||"series";t.eachComponent({mainType:r,query:e},function(i){e.sortInfo&&i.axis.setCategorySortInfo(e.sortInfo)})})}var Yb=Math.PI*2,YV=Math.PI/180;function NY(n,e){return vf(n.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function OY(n,e){var t=NY(n,e),r=n.get("center"),i=n.get("radius");Rt(i)||(i=[0,i]);var a=Jn(t.width,e.getWidth()),s=Jn(t.height,e.getHeight()),o=Math.min(a,s),l=Jn(i[0],o/2),u=Jn(i[1],o/2),c,f,h=n.coordinateSystem;if(h){var d=h.dataToPoint(r);c=d[0]||0,f=d[1]||0}else Rt(r)||(r=[r,r]),c=Jn(r[0],a)+t.x,f=Jn(r[1],s)+t.y;return{cx:c,cy:f,r0:l,r:u}}function WNe(n,e,t){e.eachSeriesByType(n,function(r){var i=r.getData(),a=i.mapDimension("value"),s=NY(r,t),o=OY(r,t),l=o.cx,u=o.cy,c=o.r,f=o.r0,h=-r.get("startAngle")*YV,d=r.get("minAngle")*YV,p=0;i.each(a,function(R){!isNaN(R)&&p++});var m=i.getSum(a),g=Math.PI/(m||p)*2,v=r.get("clockwise"),_=r.get("roseType"),x=r.get("stillShowZeroSum"),b=i.getDataExtent(a);b[0]=0;var S=Yb,T=0,M=h,C=v?1:-1;if(i.setLayout({viewRect:s,r:c}),i.each(a,function(R,P){var N;if(isNaN(R)){i.setItemLayout(P,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:v,cx:l,cy:u,r0:f,r:_?NaN:c});return}_!=="area"?N=m===0&&x?g:R*g:N=Yb/p,N<d?(N=d,S-=d):T+=R;var L=M+C*N;i.setItemLayout(P,{angle:N,startAngle:M,endAngle:L,clockwise:v,cx:l,cy:u,r0:f,r:_?Vc(R,b,[f,c]):c}),M=L}),S<Yb&&p)if(S<=.001){var k=Yb/p;i.each(a,function(R,P){if(!isNaN(R)){var N=i.getItemLayout(P);N.angle=k,N.startAngle=h+C*P*k,N.endAngle=h+C*(P+1)*k}})}else g=S/T,M=h,i.each(a,function(R,P){if(!isNaN(R)){var N=i.getItemLayout(P),L=N.angle===d?d:R*g;N.startAngle=M,N.endAngle=M+C*L,M+=C*L}})})}function GNe(n){return{seriesType:n,reset:function(e,t){var r=t.findComponents({mainType:"legend"});if(!(!r||!r.length)){var i=e.getData();i.filterSelf(function(a){for(var s=i.getName(a),o=0;o<r.length;o++)if(!r[o].isSelected(s))return!1;return!0})}}}}var jNe=Math.PI/180;function ZV(n,e,t,r,i,a,s,o,l,u){if(n.length<2)return;function c(m){for(var g=m.rB,v=g*g,_=0;_<m.list.length;_++){var x=m.list[_],b=Math.abs(x.label.y-t),S=r+x.len,T=S*S,M=Math.sqrt((1-Math.abs(b*b/v))*T),C=e+(M+x.len2)*i,k=C-x.label.x,R=x.targetTextWidth-k*i;$Y(x,R,!0),x.label.x=C}}function f(m){for(var g={list:[],maxY:0},v={list:[],maxY:0},_=0;_<m.length;_++)if(m[_].labelAlignTo==="none"){var x=m[_],b=x.label.y>t?v:g,S=Math.abs(x.label.y-t);if(S>=b.maxY){var T=x.label.x-e-x.len2*i,M=r+x.len,C=Math.abs(T)<M?Math.sqrt(S*S/(1-T*T/M/M)):M;b.rB=C,b.maxY=S}b.list.push(x)}c(g),c(v)}for(var h=n.length,d=0;d<h;d++)if(n[d].position==="outer"&&n[d].labelAlignTo==="labelLine"){var p=n[d].label.x-u;n[d].linePoints[1][0]+=p,n[d].label.x=u}wY(n,l,l+s)&&f(n)}function qNe(n,e,t,r,i,a,s,o){for(var l=[],u=[],c=Number.MAX_VALUE,f=-Number.MAX_VALUE,h=0;h<n.length;h++){var d=n[h].label;JE(n[h])||(d.x<e?(c=Math.min(c,d.x),l.push(n[h])):(f=Math.max(f,d.x),u.push(n[h])))}for(var h=0;h<n.length;h++){var p=n[h];if(!JE(p)&&p.linePoints){if(p.labelStyleWidth!=null)continue;var d=p.label,m=p.linePoints,g=void 0;p.labelAlignTo==="edge"?d.x<e?g=m[2][0]-p.labelDistance-s-p.edgeDistance:g=s+i-p.edgeDistance-m[2][0]-p.labelDistance:p.labelAlignTo==="labelLine"?d.x<e?g=c-s-p.bleedMargin:g=s+i-f-p.bleedMargin:d.x<e?g=d.x-s-p.bleedMargin:g=s+i-d.x-p.bleedMargin,p.targetTextWidth=g,$Y(p,g)}}ZV(u,e,t,r,1,i,a,s,o,f),ZV(l,e,t,r,-1,i,a,s,o,c);for(var h=0;h<n.length;h++){var p=n[h];if(!JE(p)&&p.linePoints){var d=p.label,m=p.linePoints,v=p.labelAlignTo==="edge",_=d.style.padding,x=_?_[1]+_[3]:0,b=d.style.backgroundColor?0:x,S=p.rect.width+b,T=m[1][0]-m[2][0];v?d.x<e?m[2][0]=s+p.edgeDistance+S+p.labelDistance:m[2][0]=s+i-p.edgeDistance-S-p.labelDistance:(d.x<e?m[2][0]=d.x+p.labelDistance:m[2][0]=d.x-p.labelDistance,m[1][0]=m[2][0]+T),m[1][1]=m[2][1]=d.y}}}function $Y(n,e,t){if(t===void 0&&(t=!1),n.labelStyleWidth==null){var r=n.label,i=r.style,a=n.rect,s=i.backgroundColor,o=i.padding,l=o?o[1]+o[3]:0,u=i.overflow,c=a.width+(s?0:l);if(e<c||t){var f=a.height;if(u&&u.match("break")){r.setStyle("backgroundColor",null),r.setStyle("width",e-l);var h=r.getBoundingRect();r.setStyle("width",Math.ceil(h.width)),r.setStyle("backgroundColor",s)}else{var d=e-l,p=e<c?d:t?d>n.unconstrainedWidth?null:d:null;r.setStyle("width",p)}var m=r.getBoundingRect();a.width=m.width;var g=(r.style.margin||0)+2.1;a.height=m.height+g,a.y-=(a.height-f)/2}}}function JE(n){return n.position==="center"}function XNe(n){var e=n.getData(),t=[],r,i,a=!1,s=(n.get("minShowLabelAngle")||0)*jNe,o=e.getLayout("viewRect"),l=e.getLayout("r"),u=o.width,c=o.x,f=o.y,h=o.height;function d(T){T.ignore=!0}function p(T){if(!T.ignore)return!0;for(var M in T.states)if(T.states[M].ignore===!1)return!0;return!1}e.each(function(T){var M=e.getItemGraphicEl(T),C=M.shape,k=M.getTextContent(),R=M.getTextGuideLine(),P=e.getItemModel(T),N=P.getModel("label"),L=N.get("position")||P.get(["emphasis","label","position"]),F=N.get("distanceToLabelLine"),O=N.get("alignTo"),B=Jn(N.get("edgeDistance"),u),H=N.get("bleedMargin"),j=P.getModel("labelLine"),K=j.get("length");K=Jn(K,u);var J=j.get("length2");if(J=Jn(J,u),Math.abs(C.endAngle-C.startAngle)<s){ce(k.states,d),k.ignore=!0,R&&(ce(R.states,d),R.ignore=!0);return}if(p(k)){var re=(C.startAngle+C.endAngle)/2,se=Math.cos(re),Ae=Math.sin(re),Ee,Ne,we,me;r=C.cx,i=C.cy;var Se=L==="inside"||L==="inner";if(L==="center")Ee=C.cx,Ne=C.cy,me="center";else{var Me=(Se?(C.r+C.r0)/2*se:C.r*se)+r,ke=(Se?(C.r+C.r0)/2*Ae:C.r*Ae)+i;if(Ee=Me+se*3,Ne=ke+Ae*3,!Se){var He=Me+se*(K+l-C.r),ee=ke+Ae*(K+l-C.r),ie=He+(se<0?-1:1)*J,xe=ee;O==="edge"?Ee=se<0?c+B:c+u-B:Ee=ie+(se<0?-F:F),Ne=xe,we=[[Me,ke],[He,ee],[ie,xe]]}me=Se?"center":O==="edge"?se>0?"right":"left":se>0?"left":"right"}var Ve=Math.PI,Ge=0,Ze=N.get("rotate");if(gr(Ze))Ge=Ze*(Ve/180);else if(L==="center")Ge=0;else if(Ze==="radial"||Ze===!0){var ut=se<0?-re+Ve:-re;Ge=ut}else if(Ze==="tangential"&&L!=="outside"&&L!=="outer"){var Qe=Math.atan2(se,Ae);Qe<0&&(Qe=Ve*2+Qe);var ve=Ae>0;ve&&(Qe=Ve+Qe),Ge=Qe-Ve}if(a=!!Ge,k.x=Ee,k.y=Ne,k.rotation=Ge,k.setStyle({verticalAlign:"middle"}),Se){k.setStyle({align:me});var Z=k.states.select;Z&&(Z.x+=k.x,Z.y+=k.y)}else{var Ke=k.getBoundingRect().clone();Ke.applyTransform(k.getComputedTransform());var ne=(k.style.margin||0)+2.1;Ke.y-=ne/2,Ke.height+=ne,t.push({label:k,labelLine:R,position:L,len:K,len2:J,minTurnAngle:j.get("minTurnAngle"),maxSurfaceAngle:j.get("maxSurfaceAngle"),surfaceNormal:new nn(se,Ae),linePoints:we,textAlign:me,labelDistance:F,labelAlignTo:O,edgeDistance:B,bleedMargin:H,rect:Ke,unconstrainedWidth:Ke.width,labelStyleWidth:k.style.width})}M.setTextConfig({inside:Se})}}),!a&&n.get("avoidLabelOverlap")&&qNe(t,r,i,l,u,h,c,f);for(var m=0;m<t.length;m++){var g=t[m],v=g.label,_=g.labelLine,x=isNaN(v.x)||isNaN(v.y);if(v){v.setStyle({align:g.textAlign}),x&&(ce(v.states,d),v.ignore=!0);var b=v.states.select;b&&(b.x+=v.x,b.y+=v.y)}if(_){var S=g.linePoints;x||!S?(ce(_.states,d),_.ignore=!0):(vY(S,g.minTurnAngle),jLe(S,g.surfaceNormal,g.maxSurfaceAngle),_.setShape({points:S}),v.__hostTarget.textGuideLineConfig={anchor:new nn(S[0][0],S[0][1])})}}}var KNe=function(n){ht(e,n);function e(t,r,i){var a=n.call(this)||this;a.z2=2;var s=new Pi;return a.setTextContent(s),a.updateData(t,r,i,!0),a}return e.prototype.updateData=function(t,r,i,a){var s=this,o=t.hostModel,l=t.getItemModel(r),u=l.getModel("emphasis"),c=t.getItemLayout(r),f=gt(Ty(l.getModel("itemStyle"),c,!0),c);if(isNaN(f.startAngle)){s.setShape(f);return}if(a){s.setShape(f);var h=o.getShallow("animationType");o.ecModel.ssr?(_a(s,{scaleX:0,scaleY:0},o,{dataIndex:r,isFrom:!0}),s.originX=f.cx,s.originY=f.cy):h==="scale"?(s.shape.r=c.r0,_a(s,{shape:{r:c.r}},o,r)):i!=null?(s.setShape({startAngle:i,endAngle:i}),_a(s,{shape:{startAngle:c.startAngle,endAngle:c.endAngle}},o,r)):(s.shape.endAngle=c.startAngle,Ui(s,{shape:{endAngle:c.endAngle}},o,r))}else BI(s),Ui(s,{shape:f},o,r);s.useStyle(t.getItemVisual(r,"style")),Ow(s,l);var d=(c.startAngle+c.endAngle)/2,p=o.get("selectedOffset"),m=Math.cos(d)*p,g=Math.sin(d)*p,v=l.getShallow("cursor");v&&s.attr("cursor",v),this._updateLabel(o,t,r),s.ensureState("emphasis").shape=gt({r:c.r+(u.get("scale")&&u.get("scaleSize")||0)},Ty(u.getModel("itemStyle"),c)),gt(s.ensureState("select"),{x:m,y:g,shape:Ty(l.getModel(["select","itemStyle"]),c)}),gt(s.ensureState("blur"),{shape:Ty(l.getModel(["blur","itemStyle"]),c)});var _=s.getTextGuideLine(),x=s.getTextContent();_&&gt(_.ensureState("select"),{x:m,y:g}),gt(x.ensureState("select"),{x:m,y:g}),z0(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},e.prototype._updateLabel=function(t,r,i){var a=this,s=r.getItemModel(i),o=s.getModel("labelLine"),l=r.getItemVisual(i,"style"),u=l&&l.fill,c=l&&l.opacity;I_(a,D_(s),{labelFetcher:r.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:c,defaultText:t.getFormattedLabel(i,"normal")||r.getName(i)});var f=a.getTextContent();a.setTextConfig({position:null,rotation:null}),f.attr({z2:10});var h=t.get(["label","position"]);if(h!=="outside"&&h!=="outer")a.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new P_,this.setTextGuideLine(d)),yY(this,_Y(s),{stroke:u,opacity:jy(o.get(["lineStyle","opacity"]),c,1)})}},e}(tl),YNe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return e.prototype.render=function(t,r,i,a){var s=t.getData(),o=this._data,l=this.group,u;if(!o&&s.count()>0){for(var c=s.getItemLayout(0),f=1;isNaN(c&&c.startAngle)&&f<s.count();++f)c=s.getItemLayout(f);c&&(u=c.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),s.count()===0&&t.get("showEmptyCircle")){var h=new tl({shape:OY(t,i)});h.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=h,l.add(h)}s.diff(o).add(function(d){var p=new KNe(s,d,u);s.setItemGraphicEl(d,p),l.add(p)}).update(function(d,p){var m=o.getItemGraphicEl(p);m.updateData(s,d,u),m.off("click"),l.add(m),s.setItemGraphicEl(d,m)}).remove(function(d){var p=o.getItemGraphicEl(d);Bw(p,t,d)}).execute(),XNe(t),t.get("animationTypeUpdate")!=="expansion"&&(this._data=s)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,r){var i=r.getData(),a=i.getItemLayout(0);if(a){var s=t[0]-a.cx,o=t[1]-a.cy,l=Math.sqrt(s*s+o*o);return l<=a.r&&l>=a.r0}},e.type="pie",e}(Ul);const ZNe=YNe;function QNe(n,e,t){e=Rt(e)&&{coordDimensions:e}||gt({encodeDefine:n.getEncode()},e);var r=n.getSource(),i=jK(r,e).dimensions,a=new GK(i,n);return a.initData(r,t),a}var JNe=function(){function n(e,t){this._getDataWithEncodedVisual=e,this._getRawData=t}return n.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},n.prototype.containName=function(e){var t=this._getRawData();return t.indexOfName(e)>=0},n.prototype.indexOfName=function(e){var t=this._getDataWithEncodedVisual();return t.indexOfName(e)},n.prototype.getItemVisual=function(e,t){var r=this._getDataWithEncodedVisual();return r.getItemVisual(e,t)},n}();const eOe=JNe;var tOe=qr(),nOe=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new eOe(Rr(this.getData,this),Rr(this.getRawData,this)),this._defaultLabelLine(t)},e.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return QNe(this,{coordDimensions:["value"],encodeDefaulter:ir(DRe,this)})},e.prototype.getDataParams=function(t){var r=this.getData(),i=tOe(r),a=i.seats;if(!a){var s=[];r.each(r.mapDimension("value"),function(l){s.push(l)}),a=i.seats=bAe(s,r.hostModel.get("percentPrecision"))}var o=n.prototype.getDataParams.call(this,t);return o.percent=a[t]||0,o.$vars.push("percent"),o},e.prototype._defaultLabelLine=function(t){rk(t,"labelLine",["show"]);var r=t.labelLine,i=t.emphasis.labelLine;r.show=r.show&&t.label.show,i.show=i.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(yf);const rOe=nOe;function iOe(n){return{seriesType:n,reset:function(e,t){var r=e.getData();r.filterSelf(function(i){var a=r.mapDimension("value"),s=r.get(a,i);return!(gr(s)&&!isNaN(s)&&s<0)})}}}function lit(n){n.registerChartView(ZNe),n.registerSeriesModel(rOe),bIe("pie",n.registerAction),n.registerLayout(ir(WNe,"pie")),n.registerProcessor(GNe("pie")),n.registerProcessor(iOe("pie"))}var aOe=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}(Sr);const sOe=aOe;var Nk=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",qi).models[0]},e.type="cartesian2dAxis",e}(Sr);ll(Nk,uY);var FY={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},oOe=Dn({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},FY),xD=Dn({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},FY),lOe=Dn({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},xD),uOe=ln({logBase:10},xD);const cOe={category:oOe,value:xD,time:lOe,log:uOe};var fOe={value:1,category:1,time:1,log:1};function Jw(n,e,t,r){ce(fOe,function(i,a){var s=Dn(Dn({},cOe[a],!0),r,!0),o=function(l){ht(u,l);function u(){var c=l!==null&&l.apply(this,arguments)||this;return c.type=e+"Axis."+a,c}return u.prototype.mergeDefaultAndTheme=function(c,f){var h=G0(this),d=h?NT(c):{},p=f.getTheme();Dn(c,p.get(a+"Axis")),Dn(c,this.getDefaultOption()),c.type=QV(c),h&&cg(c,d,h)},u.prototype.optionUpdated=function(){var c=this.option;c.type==="category"&&(this.__ordinalMeta=Ik.createByAxisModel(this))},u.prototype.getCategories=function(c){var f=this.option;if(f.type==="category")return c?f.data:this.__ordinalMeta.categories},u.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},u.type=e+"Axis."+a,u.defaultOption=s,u}(t);n.registerComponentModel(o)}),n.registerSubTypeDefaulter(e+"Axis",QV)}function QV(n){return n.type||(n.data?"category":"value")}var hOe=function(){function n(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return n.prototype.getAxis=function(e){return this._axes[e]},n.prototype.getAxes=function(){return Nt(this._dimList,function(e){return this._axes[e]},this)},n.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),si(this.getAxes(),function(t){return t.scale.type===e})},n.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},n}();const dOe=hOe;var Ok=["x","y"];function JV(n){return n.type==="interval"||n.type==="time"}var pOe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=Ok,t}return e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var t=this.getAxis("x").scale,r=this.getAxis("y").scale;if(!(!JV(t)||!JV(r))){var i=t.getExtent(),a=r.getExtent(),s=this.dataToPoint([i[0],a[0]]),o=this.dataToPoint([i[1],a[1]]),l=i[1]-i[0],u=a[1]-a[0];if(!(!l||!u)){var c=(o[0]-s[0])/l,f=(o[1]-s[1])/u,h=s[0]-i[0]*c,d=s[1]-a[0]*f,p=this._transform=[c,0,0,f,h,d];this._invTransform=pT([],p)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var r=this.getAxis("x"),i=this.getAxis("y");return r.contain(r.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.containZone=function(t,r){var i=this.dataToPoint(t),a=this.dataToPoint(r),s=this.getArea(),o=new Xn(i[0],i[1],a[0]-i[0],a[1]-i[1]);return s.intersect(o)},e.prototype.dataToPoint=function(t,r,i){i=i||[];var a=t[0],s=t[1];if(this._transform&&a!=null&&isFinite(a)&&s!=null&&isFinite(s))return mo(i,t,this._transform);var o=this.getAxis("x"),l=this.getAxis("y");return i[0]=o.toGlobalCoord(o.dataToCoord(a,r)),i[1]=l.toGlobalCoord(l.dataToCoord(s,r)),i},e.prototype.clampData=function(t,r){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,s=i.getExtent(),o=a.getExtent(),l=i.parse(t[0]),u=a.parse(t[1]);return r=r||[],r[0]=Math.min(Math.max(Math.min(s[0],s[1]),l),Math.max(s[0],s[1])),r[1]=Math.min(Math.max(Math.min(o[0],o[1]),u),Math.max(o[0],o[1])),r},e.prototype.pointToData=function(t,r){var i=[];if(this._invTransform)return mo(i,t,this._invTransform);var a=this.getAxis("x"),s=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(t[0]),r),i[1]=s.coordToData(s.toLocalCoord(t[1]),r),i},e.prototype.getOtherAxis=function(t){return this.getAxis(t.dim==="x"?"y":"x")},e.prototype.getArea=function(){var t=this.getAxis("x").getGlobalExtent(),r=this.getAxis("y").getGlobalExtent(),i=Math.min(t[0],t[1]),a=Math.min(r[0],r[1]),s=Math.max(t[0],t[1])-i,o=Math.max(r[0],r[1])-a;return new Xn(i,a,s,o)},e}(dOe),mOe=function(n){ht(e,n);function e(t,r,i,a,s){var o=n.call(this,t,r,i)||this;return o.index=0,o.type=a||"value",o.position=s||"bottom",o}return e.prototype.isHorizontal=function(){var t=this.position;return t==="top"||t==="bottom"},e.prototype.getGlobalExtent=function(t){var r=this.getExtent();return r[0]=this.toGlobalCoord(r[0]),r[1]=this.toGlobalCoord(r[1]),t&&r[0]>r[1]&&r.reverse(),r},e.prototype.pointToData=function(t,r){return this.coordToData(this.toLocalCoord(t[this.dim==="x"?0:1]),r)},e.prototype.setCategorySortInfo=function(t){if(this.type!=="category")return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}(Wd);const gOe=mOe;function $k(n,e,t){t=t||{};var r=n.coordinateSystem,i=e.axis,a={},s=i.getAxesOnZeroOf()[0],o=i.position,l=s?"onZero":o,u=i.dim,c=r.getRect(),f=[c.x,c.x+c.width,c.y,c.y+c.height],h={left:0,right:1,top:0,bottom:1,onZero:2},d=e.get("offset")||0,p=u==="x"?[f[2]-d,f[3]+d]:[f[0]-d,f[1]+d];if(s){var m=s.toGlobalCoord(s.dataToCoord(0));p[h.onZero]=Math.max(Math.min(m,p[1]),p[0])}a.position=[u==="y"?p[h[l]]:f[0],u==="x"?p[h[l]]:f[3]],a.rotation=Math.PI/2*(u==="x"?0:1);var g={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=g[o],a.labelOffset=s?p[h[o]]-p[h.onZero]:0,e.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),$0(t.labelInside,e.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var v=e.get(["axisLabel","rotate"]);return a.labelRotate=l==="top"?-v:v,a.z2=1,a}function e6(n){return n.get("coordinateSystem")==="cartesian2d"}function t6(n){var e={xAxisModel:null,yAxisModel:null};return ce(e,function(t,r){var i=r.replace(/Model$/,""),a=n.getReferringComponents(i,qi).models[0];e[r]=a}),e}var eA=Math.log;function vOe(n,e,t){var r=N_.prototype,i=r.getTicks.call(t),a=r.getTicks.call(t,!0),s=i.length-1,o=r.getInterval.call(t),l=sY(n,e),u=l.extent,c=l.fixMin,f=l.fixMax;if(n.type==="log"){var h=eA(n.base);u=[eA(u[0])/h,eA(u[1])/h]}n.setExtent(u[0],u[1]),n.calcNiceExtent({splitNumber:s,fixMin:c,fixMax:f});var d=r.getExtent.call(n);c&&(u[0]=d[0]),f&&(u[1]=d[1]);var p=r.getInterval.call(n),m=u[0],g=u[1];if(c&&f)p=(g-m)/s;else if(c)for(g=u[0]+p*s;g<u[1]&&isFinite(g)&&isFinite(u[1]);)p=jE(p),g=u[0]+p*s;else if(f)for(m=u[1]-p*s;m>u[0]&&isFinite(m)&&isFinite(u[0]);)p=jE(p),m=u[1]-p*s;else{var v=n.getTicks().length-1;v>s&&(p=jE(p));var _=p*s;g=Math.ceil(u[1]/p)*p,m=vi(g-_),m<0&&u[0]>=0?(m=0,g=vi(_)):g>0&&u[1]<=0&&(g=0,m=-vi(_))}var x=(i[0].value-a[0].value)/o,b=(i[s].value-a[s].value)/o;r.setExtent.call(n,m+p*x,g+p*b),r.setInterval.call(n,p),(x||b)&&r.setNiceExtent.call(n,m+p,g-p)}var yOe=function(){function n(e,t,r){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=Ok,this._initCartesian(e,t,r),this.model=e}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(e,t){var r=this._axesMap;this._updateScale(e,this.model);function i(s){var o,l=Wr(s),u=l.length;if(u){for(var c=[],f=u-1;f>=0;f--){var h=+l[f],d=s[h],p=d.model,m=d.scale;Dk(m)&&p.get("alignTicks")&&p.get("interval")==null?c.push(d):(Kw(m,p),Dk(m)&&(o=d))}c.length&&(o||(o=c.pop(),Kw(o.scale,o.model)),ce(c,function(g){vOe(g.scale,g.model,o.scale)}))}}i(r.x),i(r.y);var a={};ce(r.x,function(s){n6(r,"y",s,a)}),ce(r.y,function(s){n6(r,"x",s,a)}),this.resize(this.model,t)},n.prototype.resize=function(e,t,r){var i=e.getBoxLayoutParams(),a=!r&&e.get("containLabel"),s=vf(i,{width:t.getWidth(),height:t.getHeight()});this._rect=s;var o=this._axesList;l(),a&&(ce(o,function(u){if(!u.model.get(["axisLabel","inside"])){var c=ALe(u);if(c){var f=u.isHorizontal()?"height":"width",h=u.model.get(["axisLabel","margin"]);s[f]-=c[f]+h,u.position==="top"?s.y+=c.height+h:u.position==="left"&&(s.x+=c.width+h)}}}),l()),ce(this._coordsList,function(u){u.calcAffineTransform()});function l(){ce(o,function(u){var c=u.isHorizontal(),f=c?[0,s.width]:[0,s.height],h=u.inverse?1:0;u.setExtent(f[h],f[1-h]),_Oe(u,c?s.x:s.y)})}},n.prototype.getAxis=function(e,t){var r=this._axesMap[e];if(r!=null)return r[t||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(e,t){if(e!=null&&t!=null){var r="x"+e+"y"+t;return this._coordsMap[r]}Yt(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===e||a[i].getAxis("y").index===t)return a[i]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(e,t,r){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.dataToPoint(r):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(r)):null},n.prototype.convertFromPixel=function(e,t,r){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.pointToData(r):i.axis?i.axis.coordToData(i.axis.toLocalCoord(r)):null},n.prototype._findConvertTarget=function(e){var t=e.seriesModel,r=e.xAxisModel||t&&t.getReferringComponents("xAxis",qi).models[0],i=e.yAxisModel||t&&t.getReferringComponents("yAxis",qi).models[0],a=e.gridModel,s=this._coordsList,o,l;if(t)o=t.coordinateSystem,Vn(s,o)<0&&(o=null);else if(r&&i)o=this.getCartesian(r.componentIndex,i.componentIndex);else if(r)l=this.getAxis("x",r.componentIndex);else if(i)l=this.getAxis("y",i.componentIndex);else if(a){var u=a.coordinateSystem;u===this&&(o=this._coordsList[0])}return{cartesian:o,axis:l}},n.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},n.prototype._initCartesian=function(e,t,r){var i=this,a=this,s={left:!1,right:!1,top:!1,bottom:!1},o={x:{},y:{}},l={x:0,y:0};if(t.eachComponent("xAxis",u("x"),this),t.eachComponent("yAxis",u("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=o,ce(o.x,function(c,f){ce(o.y,function(h,d){var p="x"+f+"y"+d,m=new pOe(p);m.master=i,m.model=e,i._coordsMap[p]=m,i._coordsList.push(m),m.addAxis(c),m.addAxis(h)})});function u(c){return function(f,h){if(tA(f,e)){var d=f.get("position");c==="x"?d!=="top"&&d!=="bottom"&&(d=s.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=s.left?"right":"left"),s[d]=!0;var p=new gOe(c,oY(f),[0,0],f.get("type"),d),m=p.type==="category";p.onBand=m&&f.get("boundaryGap"),p.inverse=f.get("inverse"),f.axis=p,p.model=f,p.grid=a,p.index=h,a._axesList.push(p),o[c][h]=p,l[c]++}}}},n.prototype._updateScale=function(e,t){ce(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),e.eachSeries(function(i){if(e6(i)){var a=t6(i),s=a.xAxisModel,o=a.yAxisModel;if(!tA(s,t)||!tA(o,t))return;var l=this.getCartesian(s.componentIndex,o.componentIndex),u=i.getData(),c=l.getAxis("x"),f=l.getAxis("y");r(u,c),r(u,f)}},this);function r(i,a){ce(Yw(i,a.dim),function(s){a.scale.unionExtentFromData(i,s)})}},n.prototype.getTooltipAxes=function(e){var t=[],r=[];return ce(this.getCartesians(),function(i){var a=e!=null&&e!=="auto"?i.getAxis(e):i.getBaseAxis(),s=i.getOtherAxis(a);Vn(t,a)<0&&t.push(a),Vn(r,s)<0&&r.push(s)}),{baseAxes:t,otherAxes:r}},n.create=function(e,t){var r=[];return e.eachComponent("grid",function(i,a){var s=new n(i,e,t);s.name="grid_"+a,s.resize(i,t,!0),i.coordinateSystem=s,r.push(s)}),e.eachSeries(function(i){if(e6(i)){var a=t6(i),s=a.xAxisModel,o=a.yAxisModel,l=s.getCoordSysModel(),u=l.coordinateSystem;i.coordinateSystem=u.getCartesian(s.componentIndex,o.componentIndex)}}),r},n.dimensions=Ok,n}();function tA(n,e){return n.getCoordSysModel()===e}function n6(n,e,t,r){t.getAxesOnZeroOf=function(){return a?[a]:[]};var i=n[e],a,s=t.model,o=s.get(["axisLine","onZero"]),l=s.get(["axisLine","onZeroAxisIndex"]);if(!o)return;if(l!=null)r6(i[l])&&(a=i[l]);else for(var u in i)if(i.hasOwnProperty(u)&&r6(i[u])&&!r[c(i[u])]){a=i[u];break}a&&(r[c(a)]=!0);function c(f){return f.dim+"_"+f.index}}function r6(n){return n&&n.type!=="category"&&n.type!=="time"&&ELe(n)}function _Oe(n,e){var t=n.getExtent(),r=t[0]+t[1];n.toGlobalCoord=n.dim==="x"?function(i){return i+e}:function(i){return r-i+e},n.toLocalCoord=n.dim==="x"?function(i){return i-e}:function(i){return r-i+e}}const xOe=yOe;var Kc=Math.PI,rd=function(){function n(e,t){this.group=new yi,this.opt=t,this.axisModel=e,ln(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var r=new yi({x:t.position[0],y:t.position[1],rotation:t.rotation});r.updateTransform(),this._transformGroup=r}return n.prototype.hasBuilder=function(e){return!!i6[e]},n.prototype.add=function(e){i6[e](this.opt,this.axisModel,this.group,this._transformGroup)},n.prototype.getGroup=function(){return this.group},n.innerTextLayout=function(e,t,r){var i=lq(t-e),a,s;return Lw(i)?(s=r>0?"top":"bottom",a="center"):Lw(i-Kc)?(s=r>0?"bottom":"top",a="center"):(s="middle",i>0&&i<Kc?a=r>0?"right":"left":a=r>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:s}},n.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},n.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},n}(),i6={axisLine:function(n,e,t,r){var i=e.get(["axisLine","show"]);if(i==="auto"&&n.handleAutoShown&&(i=n.handleAutoShown("axisLine")),!!i){var a=e.axis.getExtent(),s=r.transform,o=[a[0],0],l=[a[1],0],u=o[0]>l[0];s&&(mo(o,o,s),mo(l,l,s));var c=gt({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),f=new Xo({shape:{x1:o[0],y1:o[1],x2:l[0],y2:l[1]},style:c,strokeContainThreshold:n.strokeContainThreshold||5,silent:!0,z2:1});V0(f.shape,f.style.lineWidth),f.anid="line",t.add(f);var h=e.get(["axisLine","symbol"]);if(h!=null){var d=e.get(["axisLine","symbolSize"]);jt(h)&&(h=[h,h]),(jt(d)||gr(d))&&(d=[d,d]);var p=gK(e.get(["axisLine","symbolOffset"])||0,d),m=d[0],g=d[1];ce([{rotate:n.rotation+Math.PI/2,offset:p[0],r:0},{rotate:n.rotation-Math.PI/2,offset:p[1],r:Math.sqrt((o[0]-l[0])*(o[0]-l[0])+(o[1]-l[1])*(o[1]-l[1]))}],function(v,_){if(h[_]!=="none"&&h[_]!=null){var x=hg(h[_],-m/2,-g/2,m,g,c.stroke,!0),b=v.r+v.offset,S=u?l:o;x.attr({rotation:v.rotate,x:S[0]+b*Math.cos(n.rotation),y:S[1]-b*Math.sin(n.rotation),silent:!0,z2:11}),t.add(x)}})}}},axisTickLabel:function(n,e,t,r){var i=SOe(t,r,e,n),a=COe(t,r,e,n);if(wOe(e,a,i),TOe(t,r,e,n.tickDirection),e.get(["axisLabel","hideOverlap"])){var s=xY(Nt(a,function(o){return{label:o,priority:o.z2,defaultAttr:{ignore:o.ignore}}}));SY(s)}},axisName:function(n,e,t,r){var i=$0(n.axisName,e.get("name"));if(i){var a=e.get("nameLocation"),s=n.nameDirection,o=e.getModel("nameTextStyle"),l=e.get("nameGap")||0,u=e.axis.getExtent(),c=u[0]>u[1]?-1:1,f=[a==="start"?u[0]-c*l:a==="end"?u[1]+c*l:(u[0]+u[1])/2,s6(a)?n.labelOffset+s*l:0],h,d=e.get("nameRotate");d!=null&&(d=d*Kc/180);var p;s6(a)?h=rd.innerTextLayout(n.rotation,d??n.rotation,s):(h=bOe(n.rotation,a,d||0,u),p=n.axisNameAvailableWidth,p!=null&&(p=Math.abs(p/Math.sin(h.rotation)),!isFinite(p)&&(p=null)));var m=o.getFont(),g=e.get("nameTruncate",!0)||{},v=g.ellipsis,_=$0(n.nameTruncateMaxWidth,g.maxWidth,p),x=new Pi({x:f[0],y:f[1],rotation:h.rotation,silent:rd.isLabelSilent(e),style:Ku(o,{text:i,font:m,overflow:"truncate",width:_,ellipsis:v,fill:o.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:o.get("align")||h.textAlign,verticalAlign:o.get("verticalAlign")||h.textVerticalAlign}),z2:1});if(ET({el:x,componentModel:e,itemName:i}),x.__fullText=i,x.anid="name",e.get("triggerEvent")){var b=rd.makeAxisEventDataBase(e);b.targetType="axisName",b.name=i,ar(x).eventData=b}r.add(x),x.updateTransform(),t.add(x),x.decomposeTransform()}}};function bOe(n,e,t,r){var i=lq(t-n),a,s,o=r[0]>r[1],l=e==="start"&&!o||e!=="start"&&o;return Lw(i-Kc/2)?(s=l?"bottom":"top",a="center"):Lw(i-Kc*1.5)?(s=l?"top":"bottom",a="center"):(s="middle",i<Kc*1.5&&i>Kc/2?a=l?"left":"right":a=l?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:s}}function wOe(n,e,t){if(!lY(n.axis)){var r=n.get(["axisLabel","showMinLabel"]),i=n.get(["axisLabel","showMaxLabel"]);e=e||[],t=t||[];var a=e[0],s=e[1],o=e[e.length-1],l=e[e.length-2],u=t[0],c=t[1],f=t[t.length-1],h=t[t.length-2];r===!1?(Us(a),Us(u)):a6(a,s)&&(r?(Us(s),Us(c)):(Us(a),Us(u))),i===!1?(Us(o),Us(f)):a6(l,o)&&(i?(Us(l),Us(h)):(Us(o),Us(f)))}}function Us(n){n&&(n.ignore=!0)}function a6(n,e){var t=n&&n.getBoundingRect().clone(),r=e&&e.getBoundingRect().clone();if(!(!t||!r)){var i=SI([]);return dT(i,i,-n.rotation),t.applyTransform(Pm([],i,n.getLocalTransform())),r.applyTransform(Pm([],i,e.getLocalTransform())),t.intersect(r)}}function s6(n){return n==="middle"||n==="center"}function BY(n,e,t,r,i){for(var a=[],s=[],o=[],l=0;l<n.length;l++){var u=n[l].coord;s[0]=u,s[1]=0,o[0]=u,o[1]=t,e&&(mo(s,s,e),mo(o,o,e));var c=new Xo({shape:{x1:s[0],y1:s[1],x2:o[0],y2:o[1]},style:r,z2:2,autoBatch:!0,silent:!0});V0(c.shape,c.style.lineWidth),c.anid=i+"_"+n[l].tickValue,a.push(c)}return a}function SOe(n,e,t,r){var i=t.axis,a=t.getModel("axisTick"),s=a.get("show");if(s==="auto"&&r.handleAutoShown&&(s=r.handleAutoShown("axisTick")),!(!s||i.scale.isBlank())){for(var o=a.getModel("lineStyle"),l=r.tickDirection*a.get("length"),u=i.getTicksCoords(),c=BY(u,e.transform,l,ln(o.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}),"ticks"),f=0;f<c.length;f++)n.add(c[f]);return c}}function TOe(n,e,t,r){var i=t.axis,a=t.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var s=i.getMinorTicksCoords();if(s.length)for(var o=a.getModel("lineStyle"),l=r*a.get("length"),u=ln(o.getLineStyle(),ln(t.getModel("axisTick").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})),c=0;c<s.length;c++)for(var f=BY(s[c],e.transform,l,u,"minorticks_"+c),h=0;h<f.length;h++)n.add(f[h])}}function COe(n,e,t,r){var i=t.axis,a=$0(r.axisLabelShow,t.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var s=t.getModel("axisLabel"),o=s.get("margin"),l=i.getViewLabels(),u=($0(r.labelRotate,s.get("rotate"))||0)*Kc/180,c=rd.innerTextLayout(r.rotation,u,r.labelDirection),f=t.getCategories&&t.getCategories(!0),h=[],d=rd.isLabelSilent(t),p=t.get("triggerEvent");return ce(l,function(m,g){var v=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(m.tickValue):m.tickValue,_=m.formattedLabel,x=m.rawLabel,b=s;if(f&&f[v]){var S=f[v];Yt(S)&&S.textStyle&&(b=new Fi(S.textStyle,s,t.ecModel))}var T=b.getTextColor()||t.get(["axisLine","lineStyle","color"]),M=i.dataToCoord(v),C=new Pi({x:M,y:r.labelOffset+r.labelDirection*o,rotation:c.rotation,silent:d,z2:10+(m.level||0),style:Ku(b,{text:_,align:b.getShallow("align",!0)||c.textAlign,verticalAlign:b.getShallow("verticalAlign",!0)||b.getShallow("baseline",!0)||c.textVerticalAlign,fill:pn(T)?T(i.type==="category"?x:i.type==="value"?v+"":v,g):T})});if(C.anid="label_"+v,p){var k=rd.makeAxisEventDataBase(t);k.targetType="axisLabel",k.value=x,k.tickIndex=g,i.type==="category"&&(k.dataIndex=v),ar(C).eventData=k}e.add(C),C.updateTransform(),h.push(C),n.add(C),C.decomposeTransform()}),h}}const dg=rd;function EOe(n,e){var t={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return AOe(t,n,e),t.seriesInvolved&&kOe(t,n),t}function AOe(n,e,t){var r=e.getComponent("tooltip"),i=e.getComponent("axisPointer"),a=i.get("link",!0)||[],s=[];ce(t.getCoordinateSystems(),function(o){if(!o.axisPointerEnabled)return;var l=Q0(o.model),u=n.coordSysAxesInfo[l]={};n.coordSysMap[l]=o;var c=o.model,f=c.getModel("tooltip",r);if(ce(o.getAxes(),ir(m,!1,null)),o.getTooltipAxes&&r&&f.get("show")){var h=f.get("trigger")==="axis",d=f.get(["axisPointer","type"])==="cross",p=o.getTooltipAxes(f.get(["axisPointer","axis"]));(h||d)&&ce(p.baseAxes,ir(m,d?"cross":!0,h)),d&&ce(p.otherAxes,ir(m,"cross",!1))}function m(g,v,_){var x=_.model.getModel("axisPointer",i),b=x.get("show");if(!(!b||b==="auto"&&!g&&!Fk(x))){v==null&&(v=x.get("triggerTooltip")),x=g?MOe(_,f,i,e,g,v):x;var S=x.get("snap"),T=Q0(_.model),M=v||S||_.type==="category",C=n.axesInfo[T]={key:T,axis:_,coordSys:o,axisPointerModel:x,triggerTooltip:v,involveSeries:M,snap:S,useHandle:Fk(x),seriesModels:[],linkGroup:null};u[T]=C,n.seriesInvolved=n.seriesInvolved||M;var k=ROe(a,_);if(k!=null){var R=s[k]||(s[k]={axesInfo:{}});R.axesInfo[T]=C,R.mapper=a[k].mapper,C.linkGroup=R}}}})}function MOe(n,e,t,r,i,a){var s=e.getModel("axisPointer"),o=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};ce(o,function(h){l[h]=wn(s.get(h))}),l.snap=n.type!=="category"&&!!a,s.get("type")==="cross"&&(l.type="line");var u=l.label||(l.label={});if(u.show==null&&(u.show=!1),i==="cross"){var c=s.get(["label","show"]);if(u.show=c??!0,!a){var f=l.lineStyle=s.get("crossStyle");f&&ln(u,f.textStyle)}}return n.model.getModel("axisPointer",new Fi(l,t,r))}function kOe(n,e){e.eachSeries(function(t){var r=t.coordinateSystem,i=t.get(["tooltip","trigger"],!0),a=t.get(["tooltip","show"],!0);!r||i==="none"||i===!1||i==="item"||a===!1||t.get(["axisPointer","show"],!0)===!1||ce(n.coordSysAxesInfo[Q0(r.model)],function(s){var o=s.axis;r.getAxis(o.dim)===o&&(s.seriesModels.push(t),s.seriesDataCount==null&&(s.seriesDataCount=0),s.seriesDataCount+=t.getData().count())})})}function ROe(n,e){for(var t=e.model,r=e.dim,i=0;i<n.length;i++){var a=n[i]||{};if(nA(a[r+"AxisId"],t.id)||nA(a[r+"AxisIndex"],t.componentIndex)||nA(a[r+"AxisName"],t.name))return i}}function nA(n,e){return n==="all"||Rt(n)&&Vn(n,e)>=0||n===e}function POe(n){var e=bD(n);if(e){var t=e.axisPointerModel,r=e.axis.scale,i=t.option,a=t.get("status"),s=t.get("value");s!=null&&(s=r.parse(s));var o=Fk(t);a==null&&(i.status=o?"show":"hide");var l=r.getExtent().slice();l[0]>l[1]&&l.reverse(),(s==null||s>l[1])&&(s=l[1]),s<l[0]&&(s=l[0]),i.value=s,o&&(i.status=e.axis.scale.isBlank()?"hide":"show")}}function bD(n){var e=(n.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[Q0(n)]}function IOe(n){var e=bD(n);return e&&e.axisPointerModel}function Fk(n){return!!n.get(["handle","show"])}function Q0(n){return n.type+"||"+n.id}var o6={},DOe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i,a){this.axisPointerClass&&POe(t),n.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,i,!0)},e.prototype.updateAxisPointer=function(t,r,i,a){this._doUpdateAxisPointerClass(t,i,!1)},e.prototype.remove=function(t,r){var i=this._axisPointer;i&&i.remove(r)},e.prototype.dispose=function(t,r){this._disposeAxisPointer(r),n.prototype.dispose.apply(this,arguments)},e.prototype._doUpdateAxisPointerClass=function(t,r,i){var a=e.getAxisPointerClass(this.axisPointerClass);if(a){var s=IOe(t);s?(this._axisPointer||(this._axisPointer=new a)).render(t,s,r,i):this._disposeAxisPointer(r)}},e.prototype._disposeAxisPointer=function(t){this._axisPointer&&this._axisPointer.dispose(t),this._axisPointer=null},e.registerAxisPointerClass=function(t,r){o6[t]=r},e.getAxisPointerClass=function(t){return t&&o6[t]},e.type="axis",e}(Ps);const $_=DOe;var Bk=qr();function LOe(n,e,t,r){var i=t.axis;if(!i.scale.isBlank()){var a=t.getModel("splitArea"),s=a.getModel("areaStyle"),o=s.get("color"),l=r.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var c=o.length,f=Bk(n).splitAreaColors,h=dn(),d=0;if(f)for(var p=0;p<u.length;p++){var m=f.get(u[p].tickValue);if(m!=null){d=(m+(c-1)*p)%c;break}}var g=i.toGlobalCoord(u[0].coord),v=s.getAreaStyle();o=Rt(o)?o:[o];for(var p=1;p<u.length;p++){var _=i.toGlobalCoord(u[p].coord),x=void 0,b=void 0,S=void 0,T=void 0;i.isHorizontal()?(x=g,b=l.y,S=_-x,T=l.height,g=x+S):(x=l.x,b=g,S=l.width,T=_-b,g=b+T);var M=u[p-1].tickValue;M!=null&&h.set(M,d),e.add(new oi({anid:M!=null?"area_"+M:null,shape:{x,y:b,width:S,height:T},style:ln({fill:o[d]},v),autoBatch:!0,silent:!0})),d=(d+1)%c}Bk(n).splitAreaColors=h}}}function NOe(n){Bk(n).splitAreaColors=null}var OOe=["axisLine","axisTickLabel","axisName"],$Oe=["splitArea","splitLine","minorSplitLine"],UY=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="CartesianAxisPointer",t}return e.prototype.render=function(t,r,i,a){this.group.removeAll();var s=this._axisGroup;if(this._axisGroup=new yi,this.group.add(this._axisGroup),!!t.get("show")){var o=t.getCoordSysModel(),l=$k(o,t),u=new dg(t,gt({handleAutoShown:function(f){for(var h=o.coordinateSystem.getCartesians(),d=0;d<h.length;d++)if(Dk(h[d].getOtherAxis(t.axis).scale))return!0;return!1}},l));ce(OOe,u.add,u),this._axisGroup.add(u.getGroup()),ce($Oe,function(f){t.get([f,"show"])&&FOe[f](this,this._axisGroup,t,o)},this);var c=a&&a.type==="changeAxisOrder"&&a.isInitSort;c||VI(s,this._axisGroup,t),n.prototype.render.call(this,t,r,i,a)}},e.prototype.remove=function(){NOe(this)},e.type="cartesianAxis",e}($_),FOe={splitLine:function(n,e,t,r){var i=t.axis;if(!i.scale.isBlank()){var a=t.getModel("splitLine"),s=a.getModel("lineStyle"),o=s.get("color");o=Rt(o)?o:[o];for(var l=r.coordinateSystem.getRect(),u=i.isHorizontal(),c=0,f=i.getTicksCoords({tickModel:a}),h=[],d=[],p=s.getLineStyle(),m=0;m<f.length;m++){var g=i.toGlobalCoord(f[m].coord);u?(h[0]=g,h[1]=l.y,d[0]=g,d[1]=l.y+l.height):(h[0]=l.x,h[1]=g,d[0]=l.x+l.width,d[1]=g);var v=c++%o.length,_=f[m].tickValue,x=new Xo({anid:_!=null?"line_"+f[m].tickValue:null,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:d[0],y2:d[1]},style:ln({stroke:o[v]},p),silent:!0});V0(x.shape,p.lineWidth),e.add(x)}}},minorSplitLine:function(n,e,t,r){var i=t.axis,a=t.getModel("minorSplitLine"),s=a.getModel("lineStyle"),o=r.coordinateSystem.getRect(),l=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var c=[],f=[],h=s.getLineStyle(),d=0;d<u.length;d++)for(var p=0;p<u[d].length;p++){var m=i.toGlobalCoord(u[d][p].coord);l?(c[0]=m,c[1]=o.y,f[0]=m,f[1]=o.y+o.height):(c[0]=o.x,c[1]=m,f[0]=o.x+o.width,f[1]=m);var g=new Xo({anid:"minor_line_"+u[d][p].tickValue,autoBatch:!0,shape:{x1:c[0],y1:c[1],x2:f[0],y2:f[1]},style:h,silent:!0});V0(g.shape,h.lineWidth),e.add(g)}},splitArea:function(n,e,t,r){LOe(n,e,t,r)}},zY=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="xAxis",e}(UY),BOe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=zY.type,t}return e.type="yAxis",e}(UY),UOe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="grid",t}return e.prototype.render=function(t,r){this.group.removeAll(),t.get("show")&&this.group.add(new oi({shape:t.coordinateSystem.getRect(),style:ln({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}(Ps),l6={offset:0};function zOe(n){n.registerComponentView(UOe),n.registerComponentModel(sOe),n.registerCoordinateSystem("cartesian2d",xOe),Jw(n,"x",Nk,l6),Jw(n,"y",Nk,l6),n.registerComponentView(zY),n.registerComponentView(BOe),n.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}var u6="\0_ec_interaction_mutex";function VOe(n,e,t){var r=VY(n);r[e]=t}function HOe(n,e,t){var r=VY(n),i=r[e];i===t&&(r[e]=null)}function VY(n){return n[u6]||(n[u6]={})}nu({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Oa);var WOe={axisPointer:1,tooltip:1,brush:1};function GOe(n,e,t){var r=e.getComponentByElement(n.topTarget),i=r&&r.coordinateSystem;return r&&r!==t&&!WOe.hasOwnProperty(r.mainType)&&i&&i.model!==t}function HY(n,e,t,r,i,a){n=n||0;var s=t[1]-t[0];if(i!=null&&(i=Hp(i,[0,s])),a!=null&&(a=Math.max(a,i??0)),r==="all"){var o=Math.abs(e[1]-e[0]);o=Hp(o,[0,s]),i=a=Hp(o,[i,a]),r=0}e[0]=Hp(e[0],t),e[1]=Hp(e[1],t);var l=rA(e,r);e[r]+=n;var u=i||0,c=t.slice();l.sign<0?c[0]+=u:c[1]-=u,e[r]=Hp(e[r],c);var f;return f=rA(e,r),i!=null&&(f.sign!==l.sign||f.span<i)&&(e[1-r]=e[r]+l.sign*i),f=rA(e,r),a!=null&&f.span>a&&(e[1-r]=e[r]+f.sign*a),e}function rA(n,e){var t=n[e]-n[1-e];return{span:Math.abs(t),sign:t>0?-1:t<0?1:e?-1:1}}function Hp(n,e){return Math.min(e[1]!=null?e[1]:1/0,Math.max(e[0]!=null?e[0]:-1/0,n))}var bd=!0,J0=Math.min,pg=Math.max,jOe=Math.pow,qOe=1e4,XOe=6,KOe=6,c6="globalPan",YOe={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},ZOe={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},f6={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},QOe=0,JOe=function(n){ht(e,n);function e(t){var r=n.call(this)||this;return r._track=[],r._covers=[],r._handlers={},r._zr=t,r.group=new yi,r._uid="brushController_"+QOe++,ce(s3e,function(i,a){this._handlers[a]=Rr(i,this)},r),r}return e.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},e.prototype._doEnableBrush=function(t){var r=this._zr;this._enableGlobalPan||VOe(r,c6,this._uid),ce(this._handlers,function(i,a){r.on(a,i)}),this._brushType=t.brushType,this._brushOption=Dn(wn(f6),t,!0)},e.prototype._doDisableBrush=function(){var t=this._zr;HOe(t,c6,this._uid),ce(this._handlers,function(r,i){t.off(i,r)}),this._brushType=this._brushOption=null},e.prototype.setPanels=function(t){if(t&&t.length){var r=this._panels={};ce(t,function(i){r[i.panelId]=wn(i)})}else this._panels=null;return this},e.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var r=this.group;return this._zr.add(r),r.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=r.getLocalTransform(),this},e.prototype.updateCovers=function(t){t=Nt(t,function(h){return Dn(wn(f6),h,!0)});var r="\0-brush-index-",i=this._covers,a=this._covers=[],s=this,o=this._creatingCover;return new Y0(i,t,u,l).add(c).update(c).remove(f).execute(),this;function l(h,d){return(h.id!=null?h.id:r+d)+"-"+h.brushType}function u(h,d){return l(h.__brushOption,d)}function c(h,d){var p=t[h];if(d!=null&&i[d]===o)a[h]=i[d];else{var m=a[h]=d!=null?(i[d].__brushOption=p,i[d]):GY(s,WY(s,p));wD(s,m)}}function f(h){i[h]!==o&&s.group.remove(i[h])}},e.prototype.unmount=function(){return this.enableBrush(!1),Uk(this),this._zr.remove(this.group),this},e.prototype.dispose=function(){this.unmount(),this.off()},e}(ul);function WY(n,e){var t=HT[e.brushType].createCover(n,e);return t.__brushOption=e,qY(t,e),n.group.add(t),t}function GY(n,e){var t=SD(e);return t.endCreating&&(t.endCreating(n,e),qY(e,e.__brushOption)),e}function jY(n,e){var t=e.__brushOption;SD(e).updateCoverShape(n,e,t.range,t)}function qY(n,e){var t=e.z;t==null&&(t=qOe),n.traverse(function(r){r.z=t,r.z2=t})}function wD(n,e){SD(e).updateCommon(n,e),jY(n,e)}function SD(n){return HT[n.__brushOption.brushType]}function TD(n,e,t){var r=n._panels;if(!r)return bd;var i,a=n._transform;return ce(r,function(s){s.isTargetByCursor(e,t,a)&&(i=s)}),i}function XY(n,e){var t=n._panels;if(!t)return bd;var r=e.__brushOption.panelId;return r!=null?t[r]:bd}function Uk(n){var e=n._covers,t=e.length;return ce(e,function(r){n.group.remove(r)},n),e.length=0,!!t}function wd(n,e){var t=Nt(n._covers,function(r){var i=r.__brushOption,a=wn(i.range);return{brushType:i.brushType,panelId:i.panelId,range:a}});n.trigger("brush",{areas:t,isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function e3e(n){var e=n._track;if(!e.length)return!1;var t=e[e.length-1],r=e[0],i=t[0]-r[0],a=t[1]-r[1],s=jOe(i*i+a*a,.5);return s>XOe}function KY(n){var e=n.length-1;return e<0&&(e=0),[n[0],n[e]]}function YY(n,e,t,r){var i=new yi;return i.add(new oi({name:"main",style:CD(t),silent:!0,draggable:!0,cursor:"move",drift:ir(h6,n,e,i,["n","s","w","e"]),ondragend:ir(wd,e,{isEnd:!0})})),ce(r,function(a){i.add(new oi({name:a.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:ir(h6,n,e,i,a),ondragend:ir(wd,e,{isEnd:!0})}))}),i}function ZY(n,e,t,r){var i=r.brushStyle.lineWidth||0,a=pg(i,KOe),s=t[0][0],o=t[1][0],l=s-i/2,u=o-i/2,c=t[0][1],f=t[1][1],h=c-a+i/2,d=f-a+i/2,p=c-s,m=f-o,g=p+i,v=m+i;xu(n,e,"main",s,o,p,m),r.transformable&&(xu(n,e,"w",l,u,a,v),xu(n,e,"e",h,u,a,v),xu(n,e,"n",l,u,g,a),xu(n,e,"s",l,d,g,a),xu(n,e,"nw",l,u,a,a),xu(n,e,"ne",h,u,a,a),xu(n,e,"sw",l,d,a,a),xu(n,e,"se",h,d,a,a))}function zk(n,e){var t=e.__brushOption,r=t.transformable,i=e.childAt(0);i.useStyle(CD(t)),i.attr({silent:!r,cursor:r?"move":"default"}),ce([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(a){var s=e.childOfName(a.join("")),o=a.length===1?Vk(n,a[0]):n3e(n,a);s&&s.attr({silent:!r,invisible:!r,cursor:r?ZOe[o]+"-resize":null})})}function xu(n,e,t,r,i,a,s){var o=e.childOfName(t);o&&o.setShape(i3e(ED(n,e,[[r,i],[r+a,i+s]])))}function CD(n){return ln({strokeNoScale:!0},n.brushStyle)}function QY(n,e,t,r){var i=[J0(n,t),J0(e,r)],a=[pg(n,t),pg(e,r)];return[[i[0],a[0]],[i[1],a[1]]]}function t3e(n){return zI(n.group)}function Vk(n,e){var t={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"},i=fX(t[e],t3e(n));return r[i]}function n3e(n,e){var t=[Vk(n,e[0]),Vk(n,e[1])];return(t[0]==="e"||t[0]==="w")&&t.reverse(),t.join("")}function h6(n,e,t,r,i,a){var s=t.__brushOption,o=n.toRectRange(s.range),l=JY(e,i,a);ce(r,function(u){var c=YOe[u];o[c[0]][c[1]]+=l[c[0]]}),s.range=n.fromRectRange(QY(o[0][0],o[1][0],o[0][1],o[1][1])),wD(e,t),wd(e,{isEnd:!1})}function r3e(n,e,t,r){var i=e.__brushOption.range,a=JY(n,t,r);ce(i,function(s){s[0]+=a[0],s[1]+=a[1]}),wD(n,e),wd(n,{isEnd:!1})}function JY(n,e,t){var r=n.group,i=r.transformCoordToLocal(e,t),a=r.transformCoordToLocal(0,0);return[i[0]-a[0],i[1]-a[1]]}function ED(n,e,t){var r=XY(n,e);return r&&r!==bd?r.clipPath(t,n._transform):wn(t)}function i3e(n){var e=J0(n[0][0],n[1][0]),t=J0(n[0][1],n[1][1]),r=pg(n[0][0],n[1][0]),i=pg(n[0][1],n[1][1]);return{x:e,y:t,width:r-e,height:i-t}}function a3e(n,e,t){if(!(!n._brushType||o3e(n,e.offsetX,e.offsetY))){var r=n._zr,i=n._covers,a=TD(n,e,t);if(!n._dragging)for(var s=0;s<i.length;s++){var o=i[s].__brushOption;if(a&&(a===bd||o.panelId===a.panelId)&&HT[o.brushType].contain(i[s],t[0],t[1]))return}a&&r.setCursorStyle("crosshair")}}function Hk(n){var e=n.event;e.preventDefault&&e.preventDefault()}function Wk(n,e,t){return n.childOfName("main").contain(e,t)}function eZ(n,e,t,r){var i=n._creatingCover,a=n._creatingPanel,s=n._brushOption,o;if(n._track.push(t.slice()),e3e(n)||i){if(a&&!i){s.brushMode==="single"&&Uk(n);var l=wn(s);l.brushType=d6(l.brushType,a),l.panelId=a===bd?null:a.panelId,i=n._creatingCover=WY(n,l),n._covers.push(i)}if(i){var u=HT[d6(n._brushType,a)],c=i.__brushOption;c.range=u.getCreatingRange(ED(n,i,n._track)),r&&(GY(n,i),u.updateCommon(n,i)),jY(n,i),o={isEnd:r}}}else r&&s.brushMode==="single"&&s.removeOnClick&&TD(n,e,t)&&Uk(n)&&(o={isEnd:r,removeOnClick:!0});return o}function d6(n,e){return n==="auto"?e.defaultBrushType:n}var s3e={mousedown:function(n){if(this._dragging)p6(this,n);else if(!n.target||!n.target.draggable){Hk(n);var e=this.group.transformCoordToLocal(n.offsetX,n.offsetY);this._creatingCover=null;var t=this._creatingPanel=TD(this,n,e);t&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(n){var e=n.offsetX,t=n.offsetY,r=this.group.transformCoordToLocal(e,t);if(a3e(this,n,r),this._dragging){Hk(n);var i=eZ(this,n,r,!1);i&&wd(this,i)}},mouseup:function(n){p6(this,n)}};function p6(n,e){if(n._dragging){Hk(e);var t=e.offsetX,r=e.offsetY,i=n.group.transformCoordToLocal(t,r),a=eZ(n,e,i,!0);n._dragging=!1,n._track=[],n._creatingCover=null,a&&wd(n,a)}}function o3e(n,e,t){var r=n._zr;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var HT={lineX:m6(0),lineY:m6(1),rect:{createCover:function(n,e){function t(r){return r}return YY({toRectRange:t,fromRectRange:t},n,e,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(n){var e=KY(n);return QY(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(n,e,t,r){ZY(n,e,t,r)},updateCommon:zk,contain:Wk},polygon:{createCover:function(n,e){var t=new yi;return t.add(new P_({name:"main",style:CD(e),silent:!0})),t},getCreatingRange:function(n){return n},endCreating:function(n,e){e.remove(e.childAt(0)),e.add(new wT({name:"main",draggable:!0,drift:ir(r3e,n,e),ondragend:ir(wd,n,{isEnd:!0})}))},updateCoverShape:function(n,e,t,r){e.childAt(0).setShape({points:ED(n,e,t)})},updateCommon:zk,contain:Wk}};function m6(n){return{createCover:function(e,t){return YY({toRectRange:function(r){var i=[r,[0,100]];return n&&i.reverse(),i},fromRectRange:function(r){return r[n]}},e,t,[[["w"],["e"]],[["n"],["s"]]][n])},getCreatingRange:function(e){var t=KY(e),r=J0(t[0][n],t[1][n]),i=pg(t[0][n],t[1][n]);return[r,i]},updateCoverShape:function(e,t,r,i){var a,s=XY(e,t);if(s!==bd&&s.getLinearBrushOtherExtent)a=s.getLinearBrushOtherExtent(n);else{var o=e._zr;a=[0,[o.getWidth(),o.getHeight()][1-n]]}var l=[r,a];n&&l.reverse(),ZY(e,t,l,i)},updateCommon:zk,contain:Wk}}const l3e=JOe;function u3e(n){return n=AD(n),function(e){return hX(e,n)}}function c3e(n,e){return n=AD(n),function(t){var r=e??t,i=r?n.width:n.height,a=r?n.x:n.y;return[a,a+(i||0)]}}function f3e(n,e,t){var r=AD(n);return function(i,a){return r.contain(a[0],a[1])&&!GOe(i,e,t)}}function AD(n){return Xn.create(n)}var Dh=qr(),g6=wn,iA=Rr,h3e=function(){function n(){this._dragging=!1,this.animationThreshold=15}return n.prototype.render=function(e,t,r,i){var a=t.get("value"),s=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=r,!(!i&&this._lastValue===a&&this._lastStatus===s)){this._lastValue=a,this._lastStatus=s;var o=this._group,l=this._handle;if(!s||s==="hide"){o&&o.hide(),l&&l.hide();return}o&&o.show(),l&&l.show();var u={};this.makeElOption(u,a,e,t,r);var c=u.graphicKey;c!==this._lastGraphicKey&&this.clear(r),this._lastGraphicKey=c;var f=this._moveAnimation=this.determineAnimation(e,t);if(!o)o=this._group=new yi,this.createPointerEl(o,u,e,t),this.createLabelEl(o,u,e,t),r.getZr().add(o);else{var h=ir(v6,t,f);this.updatePointerEl(o,u,h),this.updateLabelEl(o,u,h,t)}_6(o,t,!0),this._renderHandle(a)}},n.prototype.remove=function(e){this.clear(e)},n.prototype.dispose=function(e){this.clear(e)},n.prototype.determineAnimation=function(e,t){var r=t.get("animation"),i=e.axis,a=i.type==="category",s=t.get("snap");if(!s&&!a)return!1;if(r==="auto"||r==null){var o=this.animationThreshold;if(a&&i.getBandWidth()>o)return!0;if(s){var l=bD(e).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>o}return!1}return r===!0},n.prototype.makeElOption=function(e,t,r,i,a){},n.prototype.createPointerEl=function(e,t,r,i){var a=t.pointer;if(a){var s=Dh(e).pointerEl=new Jke[a.type](g6(t.pointer));e.add(s)}},n.prototype.createLabelEl=function(e,t,r,i){if(t.label){var a=Dh(e).labelEl=new Pi(g6(t.label));e.add(a),y6(a,i)}},n.prototype.updatePointerEl=function(e,t,r){var i=Dh(e).pointerEl;i&&t.pointer&&(i.setStyle(t.pointer.style),r(i,{shape:t.pointer.shape}))},n.prototype.updateLabelEl=function(e,t,r,i){var a=Dh(e).labelEl;a&&(a.setStyle(t.label.style),r(a,{x:t.label.x,y:t.label.y}),y6(a,i))},n.prototype._renderHandle=function(e){if(!(this._dragging||!this.updateHandleTransform)){var t=this._axisPointerModel,r=this._api.getZr(),i=this._handle,a=t.getModel("handle"),s=t.get("status");if(!a.get("show")||!s||s==="hide"){i&&r.remove(i),this._handle=null;return}var o;this._handle||(o=!0,i=this._handle=CT(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(u){$7(u.event)},onmousedown:iA(this._onHandleDragMove,this,0,0),drift:iA(this._onHandleDragMove,this),ondragend:iA(this._onHandleDragEnd,this)}),r.add(i)),_6(i,t,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=a.get("size");Rt(l)||(l=[l,l]),i.scaleX=l[0]/2,i.scaleY=l[1]/2,lK(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,o)}},n.prototype._moveHandleToValue=function(e,t){v6(this._axisPointerModel,!t&&this._moveAnimation,this._handle,aA(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},n.prototype._onHandleDragMove=function(e,t){var r=this._handle;if(r){this._dragging=!0;var i=this.updateHandleTransform(aA(r),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=i,r.stopAnimation(),r.attr(aA(i)),Dh(r).lastProp=null,this._doDispatchAxisPointer()}},n.prototype._doDispatchAxisPointer=function(){var e=this._handle;if(e){var t=this._payloadInfo,r=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:r.axis.dim,axisIndex:r.componentIndex}]})}},n.prototype._onHandleDragEnd=function(){this._dragging=!1;var e=this._handle;if(e){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},n.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),r=this._group,i=this._handle;t&&r&&(this._lastGraphicKey=null,r&&t.remove(r),i&&t.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),Sk(this,"_doDispatchAxisPointer")},n.prototype.doClear=function(){},n.prototype.buildLabel=function(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}},n}();function v6(n,e,t,r){tZ(Dh(t).lastProp,r)||(Dh(t).lastProp=r,e?Ui(t,r,n):(t.stopAnimation(),t.attr(r)))}function tZ(n,e){if(Yt(n)&&Yt(e)){var t=!0;return ce(e,function(r,i){t=t&&tZ(n[i],r)}),!!t}else return n===e}function y6(n,e){n[e.get(["label","show"])?"show":"hide"]()}function aA(n){return{x:n.x||0,y:n.y||0,rotation:n.rotation||0}}function _6(n,e,t){var r=e.get("z"),i=e.get("zlevel");n&&n.traverse(function(a){a.type!=="group"&&(r!=null&&(a.z=r),i!=null&&(a.zlevel=i),a.silent=t)})}const nZ=h3e;function rZ(n){var e=n.get("type"),t=n.getModel(e+"Style"),r;return e==="line"?(r=t.getLineStyle(),r.fill=null):e==="shadow"&&(r=t.getAreaStyle(),r.stroke=null),r}function iZ(n,e,t,r,i){var a=t.get("value"),s=aZ(a,e.axis,e.ecModel,t.get("seriesDataIndices"),{precision:t.get(["label","precision"]),formatter:t.get(["label","formatter"])}),o=t.getModel("label"),l=LT(o.get("padding")||0),u=o.getFont(),c=M_(s,u),f=i.position,h=c.width+l[1]+l[3],d=c.height+l[0]+l[2],p=i.align;p==="right"&&(f[0]-=h),p==="center"&&(f[0]-=h/2);var m=i.verticalAlign;m==="bottom"&&(f[1]-=d),m==="middle"&&(f[1]-=d/2),d3e(f,h,d,r);var g=o.get("backgroundColor");(!g||g==="auto")&&(g=e.get(["axisLine","lineStyle","color"])),n.label={x:f[0],y:f[1],style:Ku(o,{text:s,font:u,fill:o.getTextColor(),padding:l,backgroundColor:g}),z2:10}}function d3e(n,e,t,r){var i=r.getWidth(),a=r.getHeight();n[0]=Math.min(n[0]+e,i)-e,n[1]=Math.min(n[1]+t,a)-t,n[0]=Math.max(n[0],0),n[1]=Math.max(n[1],0)}function aZ(n,e,t,r,i){n=e.scale.parse(n);var a=e.scale.getLabel({value:n},{precision:i.precision}),s=i.formatter;if(s){var o={value:mD(e,{value:n}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};ce(r,function(l){var u=t.getSeriesByIndex(l.seriesIndex),c=l.dataIndexInside,f=u&&u.getDataParams(c);f&&o.seriesData.push(f)}),jt(s)?a=s.replace("{value}",a):pn(s)&&(a=s(o))}return a}function sZ(n,e,t){var r=sg();return dT(r,r,t.rotation),Aw(r,r,t.position),TT([n.dataToCoord(e),(t.labelOffset||0)+(t.labelDirection||1)*(t.labelMargin||0)],r)}function p3e(n,e,t,r,i,a){var s=dg.innerTextLayout(t.rotation,0,t.labelDirection);t.labelMargin=i.get(["label","margin"]),iZ(e,r,i,a,{position:sZ(r.axis,n,t),align:s.textAlign,verticalAlign:s.textVerticalAlign})}function oZ(n,e,t){return t=t||0,{x1:n[t],y1:n[1-t],x2:e[t],y2:e[1-t]}}function m3e(n,e,t){return t=t||0,{x:n[t],y:n[1-t],width:e[t],height:e[1-t]}}function x6(n,e,t,r,i,a){return{cx:n,cy:e,r0:t,r,startAngle:i,endAngle:a,clockwise:!0}}var g3e=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,i,a,s){var o=i.axis,l=o.grid,u=a.get("type"),c=b6(l,o).getOtherAxis(o).getGlobalExtent(),f=o.toGlobalCoord(o.dataToCoord(r,!0));if(u&&u!=="none"){var h=rZ(a),d=v3e[u](o,f,c);d.style=h,t.graphicKey=d.type,t.pointer=d}var p=$k(l.model,i);p3e(r,t,p,i,a,s)},e.prototype.getHandleTransform=function(t,r,i){var a=$k(r.axis.grid.model,r,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var s=sZ(r.axis,t,a);return{x:s[0],y:s[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,r,i,a){var s=i.axis,o=s.grid,l=s.getGlobalExtent(!0),u=b6(o,s).getOtherAxis(s).getGlobalExtent(),c=s.dim==="x"?0:1,f=[t.x,t.y];f[c]+=r[c],f[c]=Math.min(l[1],f[c]),f[c]=Math.max(l[0],f[c]);var h=(u[1]+u[0])/2,d=[h,h];d[c]=f[c];var p=[{verticalAlign:"middle"},{align:"center"}];return{x:f[0],y:f[1],rotation:t.rotation,cursorPoint:d,tooltipOption:p[c]}},e}(nZ);function b6(n,e){var t={};return t[e.dim+"AxisIndex"]=e.index,n.getCartesian(t)}var v3e={line:function(n,e,t){var r=oZ([e,t[0]],[e,t[1]],w6(n));return{type:"Line",subPixelOptimize:!0,shape:r}},shadow:function(n,e,t){var r=Math.max(1,n.getBandWidth()),i=t[1]-t[0];return{type:"Rect",shape:m3e([e-r/2,t[0]],[r,i],w6(n))}}};function w6(n){return n.dim==="x"?0:1}const y3e=g3e;var _3e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="axisPointer",e.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},e}(Sr);const x3e=_3e;var Ou=qr(),b3e=ce;function lZ(n,e,t){if(!In.node){var r=e.getZr();Ou(r).records||(Ou(r).records={}),w3e(r,e);var i=Ou(r).records[n]||(Ou(r).records[n]={});i.handler=t}}function w3e(n,e){if(Ou(n).initialized)return;Ou(n).initialized=!0,t("click",ir(S6,"click")),t("mousemove",ir(S6,"mousemove")),t("globalout",T3e);function t(r,i){n.on(r,function(a){var s=C3e(e);b3e(Ou(n).records,function(o){o&&i(o,a,s.dispatchAction)}),S3e(s.pendings,e)})}}function S3e(n,e){var t=n.showTip.length,r=n.hideTip.length,i;t?i=n.showTip[t-1]:r&&(i=n.hideTip[r-1]),i&&(i.dispatchAction=null,e.dispatchAction(i))}function T3e(n,e,t){n.handler("leave",null,t)}function S6(n,e,t,r){e.handler(n,t,r)}function C3e(n){var e={showTip:[],hideTip:[]},t=function(r){var i=e[r.type];i?i.push(r):(r.dispatchAction=t,n.dispatchAction(r))};return{dispatchAction:t,pendings:e}}function Gk(n,e){if(!In.node){var t=e.getZr(),r=(Ou(t).records||{})[n];r&&(Ou(t).records[n]=null)}}var E3e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i){var a=r.getComponent("tooltip"),s=t.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";lZ("axisPointer",i,function(o,l,u){s!=="none"&&(o==="leave"||s.indexOf(o)>=0)&&u({type:"updateAxisPointer",currTrigger:o,x:l&&l.offsetX,y:l&&l.offsetY})})},e.prototype.remove=function(t,r){Gk("axisPointer",r)},e.prototype.dispose=function(t,r){Gk("axisPointer",r)},e.type="axisPointer",e}(Ps);const A3e=E3e;function uZ(n,e){var t=[],r=n.seriesIndex,i;if(r==null||!(i=e.getSeriesByIndex(r)))return{point:[]};var a=i.getData(),s=yd(a,n);if(s==null||s<0||Rt(s))return{point:[]};var o=a.getItemGraphicEl(s),l=i.coordinateSystem;if(i.getTooltipPosition)t=i.getTooltipPosition(s)||[];else if(l&&l.dataToPoint)if(n.isStacked){var u=l.getBaseAxis(),c=l.getOtherAxis(u),f=c.dim,h=u.dim,d=f==="x"||f==="radius"?1:0,p=a.mapDimension(h),m=[];m[d]=a.get(p,s),m[1-d]=a.get(a.getCalculationInfo("stackResultDimension"),s),t=l.dataToPoint(m)||[]}else t=l.dataToPoint(a.getValues(Nt(l.dimensions,function(v){return a.mapDimension(v)}),s))||[];else if(o){var g=o.getBoundingRect().clone();g.applyTransform(o.transform),t=[g.x+g.width/2,g.y+g.height/2]}return{point:t,el:o}}var T6=qr();function M3e(n,e,t){var r=n.currTrigger,i=[n.x,n.y],a=n,s=n.dispatchAction||Rr(t.dispatchAction,t),o=e.getComponent("axisPointer").coordSysAxesInfo;if(o){rw(i)&&(i=uZ({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},e).point);var l=rw(i),u=a.axesInfo,c=o.axesInfo,f=r==="leave"||rw(i),h={},d={},p={list:[],map:{}},m={showPointer:ir(R3e,d),showTooltip:ir(P3e,p)};ce(o.coordSysMap,function(v,_){var x=l||v.containPoint(i);ce(o.coordSysAxesInfo[_],function(b,S){var T=b.axis,M=N3e(u,b);if(!f&&x&&(!u||M)){var C=M&&M.value;C==null&&!l&&(C=T.pointToData(i)),C!=null&&C6(b,C,m,!1,h)}})});var g={};return ce(c,function(v,_){var x=v.linkGroup;x&&!d[_]&&ce(x.axesInfo,function(b,S){var T=d[S];if(b!==v&&T){var M=T.value;x.mapper&&(M=v.axis.scale.parse(x.mapper(M,E6(b),E6(v)))),g[v.key]=M}})}),ce(g,function(v,_){C6(c[_],v,m,!0,h)}),I3e(d,c,h),D3e(p,i,n,s),L3e(c,s,t),h}}function C6(n,e,t,r,i){var a=n.axis;if(!(a.scale.isBlank()||!a.containData(e))){if(!n.involveSeries){t.showPointer(n,e);return}var s=k3e(e,n),o=s.payloadBatch,l=s.snapToValue;o[0]&&i.seriesIndex==null&&gt(i,o[0]),!r&&n.snap&&a.containData(l)&&l!=null&&(e=l),t.showPointer(n,e,o),t.showTooltip(n,s,l)}}function k3e(n,e){var t=e.axis,r=t.dim,i=n,a=[],s=Number.MAX_VALUE,o=-1;return ce(e.seriesModels,function(l,u){var c=l.getData().mapDimensionsAll(r),f,h;if(l.getAxisTooltipData){var d=l.getAxisTooltipData(c,n,t);h=d.dataIndices,f=d.nestestValue}else{if(h=l.getData().indicesOfNearest(c[0],n,t.type==="category"?.5:null),!h.length)return;f=l.getData().get(c[0],h[0])}if(!(f==null||!isFinite(f))){var p=n-f,m=Math.abs(p);m<=s&&((m<s||p>=0&&o<0)&&(s=m,o=p,i=f,a.length=0),ce(h,function(g){a.push({seriesIndex:l.seriesIndex,dataIndexInside:g,dataIndex:l.getData().getRawIndex(g)})}))}}),{payloadBatch:a,snapToValue:i}}function R3e(n,e,t,r){n[e.key]={value:t,payloadBatch:r}}function P3e(n,e,t,r){var i=t.payloadBatch,a=e.axis,s=a.model,o=e.axisPointerModel;if(!(!e.triggerTooltip||!i.length)){var l=e.coordSys.model,u=Q0(l),c=n.map[u];c||(c=n.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},n.list.push(c)),c.dataByAxis.push({axisDim:a.dim,axisIndex:s.componentIndex,axisType:s.type,axisId:s.id,value:r,valueLabelOpt:{precision:o.get(["label","precision"]),formatter:o.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function I3e(n,e,t){var r=t.axesInfo=[];ce(e,function(i,a){var s=i.axisPointerModel.option,o=n[a];o?(!i.useHandle&&(s.status="show"),s.value=o.value,s.seriesDataIndices=(o.payloadBatch||[]).slice()):!i.useHandle&&(s.status="hide"),s.status==="show"&&r.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:s.value})})}function D3e(n,e,t,r){if(rw(e)||!n.list.length){r({type:"hideTip"});return}var i=((n.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};r({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:t.tooltipOption,position:t.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:n.list})}function L3e(n,e,t){var r=t.getZr(),i="axisPointerLastHighlights",a=T6(r)[i]||{},s=T6(r)[i]={};ce(n,function(u,c){var f=u.axisPointerModel.option;f.status==="show"&&ce(f.seriesDataIndices,function(h){var d=h.seriesIndex+" | "+h.dataIndex;s[d]=h})});var o=[],l=[];ce(a,function(u,c){!s[c]&&l.push(u)}),ce(s,function(u,c){!a[c]&&o.push(u)}),l.length&&t.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),o.length&&t.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:o})}function N3e(n,e){for(var t=0;t<(n||[]).length;t++){var r=n[t];if(e.axis.dim===r.axisDim&&e.axis.model.componentIndex===r.axisIndex)return r}}function E6(n){var e=n.axis.model,t={},r=t.axisDim=n.axis.dim;return t.axisIndex=t[r+"AxisIndex"]=e.componentIndex,t.axisName=t[r+"AxisName"]=e.name,t.axisId=t[r+"AxisId"]=e.id,t}function rw(n){return!n||n[0]==null||isNaN(n[0])||n[1]==null||isNaN(n[1])}function MD(n){$_.registerAxisPointerClass("CartesianAxisPointer",y3e),n.registerComponentModel(x3e),n.registerComponentView(A3e),n.registerPreprocessor(function(e){if(e){(!e.axisPointer||e.axisPointer.length===0)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!Rt(t)&&(e.axisPointer.link=[t])}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=EOe(e,t)}),n.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},M3e)}function uit(n){Yu(zOe),Yu(MD)}var O3e=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,i,a,s){var o=i.axis;o.dim==="angle"&&(this.animationThreshold=Math.PI/18);var l=o.polar,u=l.getOtherAxis(o),c=u.getExtent(),f=o.dataToCoord(r),h=a.get("type");if(h&&h!=="none"){var d=rZ(a),p=F3e[h](o,l,f,c);p.style=d,t.graphicKey=p.type,t.pointer=p}var m=a.get(["label","margin"]),g=$3e(r,i,a,l,m);iZ(t,i,a,s,g)},e}(nZ);function $3e(n,e,t,r,i){var a=e.axis,s=a.dataToCoord(n),o=r.getAngleAxis().getExtent()[0];o=o/180*Math.PI;var l=r.getRadiusAxis().getExtent(),u,c,f;if(a.dim==="radius"){var h=sg();dT(h,h,o),Aw(h,h,[r.cx,r.cy]),u=TT([s,-i],h);var d=e.getModel("axisLabel").get("rotate")||0,p=dg.innerTextLayout(o,d*Math.PI/180,-1);c=p.textAlign,f=p.textVerticalAlign}else{var m=l[1];u=r.coordToPoint([m+i,s]);var g=r.cx,v=r.cy;c=Math.abs(u[0]-g)/m<.3?"center":u[0]>g?"left":"right",f=Math.abs(u[1]-v)/m<.3?"middle":u[1]>v?"top":"bottom"}return{position:u,align:c,verticalAlign:f}}var F3e={line:function(n,e,t,r){return n.dim==="angle"?{type:"Line",shape:oZ(e.coordToPoint([r[0],t]),e.coordToPoint([r[1],t]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:t}}},shadow:function(n,e,t,r){var i=Math.max(1,n.getBandWidth()),a=Math.PI/180;return n.dim==="angle"?{type:"Sector",shape:x6(e.cx,e.cy,r[0],r[1],(-t-i/2)*a,(-t+i/2)*a)}:{type:"Sector",shape:x6(e.cx,e.cy,t-i/2,t+i/2,0,Math.PI*2)}}};const B3e=O3e;var U3e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.findAxisModel=function(t){var r,i=this.ecModel;return i.eachComponent(t,function(a){a.getCoordSysModel()===this&&(r=a)},this),r},e.type="polar",e.dependencies=["radiusAxis","angleAxis"],e.defaultOption={z:0,center:["50%","50%"],radius:"80%"},e}(Sr);const z3e=U3e;var kD=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",qi).models[0]},e.type="polarAxis",e}(Sr);ll(kD,uY);var V3e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="angleAxis",e}(kD),H3e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="radiusAxis",e}(kD),RD=function(n){ht(e,n);function e(t,r){return n.call(this,"radius",t,r)||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e}(Wd);RD.prototype.dataToRadius=Wd.prototype.dataToCoord;RD.prototype.radiusToData=Wd.prototype.coordToData;const W3e=RD;var G3e=qr(),PD=function(n){ht(e,n);function e(t,r){return n.call(this,"angle",t,r||[0,360])||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e.prototype.calculateCategoryInterval=function(){var t=this,r=t.getLabelModel(),i=t.scale,a=i.getExtent(),s=i.count();if(a[1]-a[0]<1)return 0;var o=a[0],l=t.dataToCoord(o+1)-t.dataToCoord(o),u=Math.abs(l),c=M_(o==null?"":o+"",r.getFont(),"center","top"),f=Math.max(c.height,7),h=f/u;isNaN(h)&&(h=1/0);var d=Math.max(0,Math.floor(h)),p=G3e(t.model),m=p.lastAutoInterval,g=p.lastTickCount;return m!=null&&g!=null&&Math.abs(m-d)<=1&&Math.abs(g-s)<=1&&m>d?d=m:(p.lastTickCount=s,p.lastAutoInterval=d),d},e}(Wd);PD.prototype.dataToAngle=Wd.prototype.dataToCoord;PD.prototype.angleToData=Wd.prototype.coordToData;const j3e=PD;var cZ=["radius","angle"],q3e=function(){function n(e){this.dimensions=cZ,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new W3e,this._angleAxis=new j3e,this.axisPointerEnabled=!0,this.name=e||"",this._radiusAxis.polar=this._angleAxis.polar=this}return n.prototype.containPoint=function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},n.prototype.containData=function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},n.prototype.getAxis=function(e){var t="_"+e+"Axis";return this[t]},n.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},n.prototype.getAxesByScale=function(e){var t=[],r=this._angleAxis,i=this._radiusAxis;return r.scale.type===e&&t.push(r),i.scale.type===e&&t.push(i),t},n.prototype.getAngleAxis=function(){return this._angleAxis},n.prototype.getRadiusAxis=function(){return this._radiusAxis},n.prototype.getOtherAxis=function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},n.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},n.prototype.getTooltipAxes=function(e){var t=e!=null&&e!=="auto"?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},n.prototype.dataToPoint=function(e,t){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)])},n.prototype.pointToData=function(e,t){var r=this.pointToCoord(e);return[this._radiusAxis.radiusToData(r[0],t),this._angleAxis.angleToData(r[1],t)]},n.prototype.pointToCoord=function(e){var t=e[0]-this.cx,r=e[1]-this.cy,i=this.getAngleAxis(),a=i.getExtent(),s=Math.min(a[0],a[1]),o=Math.max(a[0],a[1]);i.inverse?s=o-360:o=s+360;var l=Math.sqrt(t*t+r*r);t/=l,r/=l;for(var u=Math.atan2(-r,t)/Math.PI*180,c=u<s?1:-1;u<s||u>o;)u+=c*360;return[l,u]},n.prototype.coordToPoint=function(e){var t=e[0],r=e[1]/180*Math.PI,i=Math.cos(r)*t+this.cx,a=-Math.sin(r)*t+this.cy;return[i,a]},n.prototype.getArea=function(){var e=this.getAngleAxis(),t=this.getRadiusAxis(),r=t.getExtent().slice();r[0]>r[1]&&r.reverse();var i=e.getExtent(),a=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:r[0],r:r[1],startAngle:-i[0]*a,endAngle:-i[1]*a,clockwise:e.inverse,contain:function(s,o){var l=s-this.cx,u=o-this.cy,c=l*l+u*u-1e-4,f=this.r,h=this.r0;return c<=f*f&&c>=h*h}}},n.prototype.convertToPixel=function(e,t,r){var i=A6(t);return i===this?this.dataToPoint(r):null},n.prototype.convertFromPixel=function(e,t,r){var i=A6(t);return i===this?this.pointToData(r):null},n}();function A6(n){var e=n.seriesModel,t=n.polarModel;return t&&t.coordinateSystem||e&&e.coordinateSystem}const X3e=q3e;function K3e(n,e,t){var r=e.get("center"),i=t.getWidth(),a=t.getHeight();n.cx=Jn(r[0],i),n.cy=Jn(r[1],a);var s=n.getRadiusAxis(),o=Math.min(i,a)/2,l=e.get("radius");l==null?l=[0,"100%"]:Rt(l)||(l=[0,l]);var u=[Jn(l[0],o),Jn(l[1],o)];s.inverse?s.setExtent(u[1],u[0]):s.setExtent(u[0],u[1])}function Y3e(n,e){var t=this,r=t.getAngleAxis(),i=t.getRadiusAxis();if(r.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),n.eachSeries(function(o){if(o.coordinateSystem===t){var l=o.getData();ce(Yw(l,"radius"),function(u){i.scale.unionExtentFromData(l,u)}),ce(Yw(l,"angle"),function(u){r.scale.unionExtentFromData(l,u)})}}),Kw(r.scale,r.model),Kw(i.scale,i.model),r.type==="category"&&!r.onBand){var a=r.getExtent(),s=360/r.scale.count();r.inverse?a[1]+=s:a[1]-=s,r.setExtent(a[0],a[1])}}function Z3e(n){return n.mainType==="angleAxis"}function M6(n,e){if(n.type=e.get("type"),n.scale=oY(e),n.onBand=e.get("boundaryGap")&&n.type==="category",n.inverse=e.get("inverse"),Z3e(e)){n.inverse=n.inverse!==e.get("clockwise");var t=e.get("startAngle");n.setExtent(t,t+(n.inverse?-360:360))}e.axis=n,n.model=e}var Q3e={dimensions:cZ,create:function(n,e){var t=[];return n.eachComponent("polar",function(r,i){var a=new X3e(i+"");a.update=Y3e;var s=a.getRadiusAxis(),o=a.getAngleAxis(),l=r.findAxisModel("radiusAxis"),u=r.findAxisModel("angleAxis");M6(s,l),M6(o,u),K3e(a,r,e),t.push(a),r.coordinateSystem=a,a.model=r}),n.eachSeries(function(r){if(r.get("coordinateSystem")==="polar"){var i=r.getReferringComponents("polar",qi).models[0];r.coordinateSystem=i.coordinateSystem}}),t}};const J3e=Q3e;var e$e=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function Zb(n,e,t){e[1]>e[0]&&(e=e.slice().reverse());var r=n.coordToPoint([e[0],t]),i=n.coordToPoint([e[1],t]);return{x1:r[0],y1:r[1],x2:i[0],y2:i[1]}}function Qb(n){var e=n.getRadiusAxis();return e.inverse?0:1}function k6(n){var e=n[0],t=n[n.length-1];e&&t&&Math.abs(Math.abs(e.coord-t.coord)-360)<1e-4&&n.pop()}var t$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var i=t.axis,a=i.polar,s=a.getRadiusAxis().getExtent(),o=i.getTicksCoords(),l=i.getMinorTicksCoords(),u=Nt(i.getViewLabels(),function(c){c=wn(c);var f=i.scale,h=f.type==="ordinal"?f.getRawOrdinalNumber(c.tickValue):c.tickValue;return c.coord=i.dataToCoord(h),c});k6(u),k6(o),ce(e$e,function(c){t.get([c,"show"])&&(!i.scale.isBlank()||c==="axisLine")&&n$e[c](this.group,t,a,o,l,s,u)},this)}},e.type="angleAxis",e}($_),n$e={axisLine:function(n,e,t,r,i,a){var s=e.getModel(["axisLine","lineStyle"]),o=Qb(t),l=o?0:1,u;a[l]===0?u=new ug({shape:{cx:t.cx,cy:t.cy,r:a[o]},style:s.getLineStyle(),z2:1,silent:!0}):u=new OI({shape:{cx:t.cx,cy:t.cy,r:a[o],r0:a[l]},style:s.getLineStyle(),z2:1,silent:!0}),u.style.fill=null,n.add(u)},axisTick:function(n,e,t,r,i,a){var s=e.getModel("axisTick"),o=(s.get("inside")?-1:1)*s.get("length"),l=a[Qb(t)],u=Nt(r,function(c){return new Xo({shape:Zb(t,[l,l+o],c.coord)})});n.add(Mu(u,{style:ln(s.getModel("lineStyle").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})}))},minorTick:function(n,e,t,r,i,a){if(i.length){for(var s=e.getModel("axisTick"),o=e.getModel("minorTick"),l=(s.get("inside")?-1:1)*o.get("length"),u=a[Qb(t)],c=[],f=0;f<i.length;f++)for(var h=0;h<i[f].length;h++)c.push(new Xo({shape:Zb(t,[u,u+l],i[f][h].coord)}));n.add(Mu(c,{style:ln(o.getModel("lineStyle").getLineStyle(),ln(s.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(n,e,t,r,i,a,s){var o=e.getCategories(!0),l=e.getModel("axisLabel"),u=l.get("margin"),c=e.get("triggerEvent");ce(s,function(f,h){var d=l,p=f.tickValue,m=a[Qb(t)],g=t.coordToPoint([m+u,f.coord]),v=t.cx,_=t.cy,x=Math.abs(g[0]-v)/m<.3?"center":g[0]>v?"left":"right",b=Math.abs(g[1]-_)/m<.3?"middle":g[1]>_?"top":"bottom";if(o&&o[p]){var S=o[p];Yt(S)&&S.textStyle&&(d=new Fi(S.textStyle,l,l.ecModel))}var T=new Pi({silent:dg.isLabelSilent(e),style:Ku(d,{x:g[0],y:g[1],fill:d.getTextColor()||e.get(["axisLine","lineStyle","color"]),text:f.formattedLabel,align:x,verticalAlign:b})});if(n.add(T),c){var M=dg.makeAxisEventDataBase(e);M.targetType="axisLabel",M.value=f.rawLabel,ar(T).eventData=M}},this)},splitLine:function(n,e,t,r,i,a){var s=e.getModel("splitLine"),o=s.getModel("lineStyle"),l=o.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],f=0;f<r.length;f++){var h=u++%l.length;c[h]=c[h]||[],c[h].push(new Xo({shape:Zb(t,a,r[f].coord)}))}for(var f=0;f<c.length;f++)n.add(Mu(c[f],{style:ln({stroke:l[f%l.length]},o.getLineStyle()),silent:!0,z:e.get("z")}))},minorSplitLine:function(n,e,t,r,i,a){if(i.length){for(var s=e.getModel("minorSplitLine"),o=s.getModel("lineStyle"),l=[],u=0;u<i.length;u++)for(var c=0;c<i[u].length;c++)l.push(new Xo({shape:Zb(t,a,i[u][c].coord)}));n.add(Mu(l,{style:o.getLineStyle(),silent:!0,z:e.get("z")}))}},splitArea:function(n,e,t,r,i,a){if(r.length){var s=e.getModel("splitArea"),o=s.getModel("areaStyle"),l=o.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],f=Math.PI/180,h=-r[0].coord*f,d=Math.min(a[0],a[1]),p=Math.max(a[0],a[1]),m=e.get("clockwise"),g=1,v=r.length;g<=v;g++){var _=g===v?r[0].coord:r[g].coord,x=u++%l.length;c[x]=c[x]||[],c[x].push(new tl({shape:{cx:t.cx,cy:t.cy,r0:d,r:p,startAngle:h,endAngle:-_*f,clockwise:m},silent:!0})),h=-_*f}for(var g=0;g<c.length;g++)n.add(Mu(c[g],{style:ln({fill:l[g%l.length]},o.getAreaStyle()),silent:!0}))}}};const r$e=t$e;var i$e=["axisLine","axisTickLabel","axisName"],a$e=["splitLine","splitArea","minorSplitLine"],s$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var i=this._axisGroup,a=this._axisGroup=new yi;this.group.add(a);var s=t.axis,o=s.polar,l=o.getAngleAxis(),u=s.getTicksCoords(),c=s.getMinorTicksCoords(),f=l.getExtent()[0],h=s.getExtent(),d=l$e(o,t,f),p=new dg(t,d);ce(i$e,p.add,p),a.add(p.getGroup()),VI(i,a,t),ce(a$e,function(m){t.get([m,"show"])&&!s.scale.isBlank()&&o$e[m](this.group,t,o,f,h,u,c)},this)}},e.type="radiusAxis",e}($_),o$e={splitLine:function(n,e,t,r,i,a){var s=e.getModel("splitLine"),o=s.getModel("lineStyle"),l=o.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],f=0;f<a.length;f++){var h=u++%l.length;c[h]=c[h]||[],c[h].push(new ug({shape:{cx:t.cx,cy:t.cy,r:Math.max(a[f].coord,0)}}))}for(var f=0;f<c.length;f++)n.add(Mu(c[f],{style:ln({stroke:l[f%l.length],fill:null},o.getLineStyle()),silent:!0}))},minorSplitLine:function(n,e,t,r,i,a,s){if(s.length){for(var o=e.getModel("minorSplitLine"),l=o.getModel("lineStyle"),u=[],c=0;c<s.length;c++)for(var f=0;f<s[c].length;f++)u.push(new ug({shape:{cx:t.cx,cy:t.cy,r:s[c][f].coord}}));n.add(Mu(u,{style:ln({fill:null},l.getLineStyle()),silent:!0}))}},splitArea:function(n,e,t,r,i,a){if(a.length){var s=e.getModel("splitArea"),o=s.getModel("areaStyle"),l=o.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],f=a[0].coord,h=1;h<a.length;h++){var d=u++%l.length;c[d]=c[d]||[],c[d].push(new tl({shape:{cx:t.cx,cy:t.cy,r0:f,r:a[h].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),f=a[h].coord}for(var h=0;h<c.length;h++)n.add(Mu(c[h],{style:ln({fill:l[h%l.length]},o.getAreaStyle()),silent:!0}))}}};function l$e(n,e,t){return{position:[n.cx,n.cy],rotation:t/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}const u$e=s$e;function fZ(n){return n.get("stack")||"__ec_stack_"+n.seriesIndex}function hZ(n,e){return e.dim+n.model.componentIndex}function c$e(n,e,t){var r={},i=f$e(si(e.getSeriesByType(n),function(a){return!e.isSeriesFiltered(a)&&a.coordinateSystem&&a.coordinateSystem.type==="polar"}));e.eachSeriesByType(n,function(a){if(a.coordinateSystem.type==="polar"){var s=a.getData(),o=a.coordinateSystem,l=o.getBaseAxis(),u=hZ(o,l),c=fZ(a),f=i[u][c],h=f.offset,d=f.width,p=o.getOtherAxis(l),m=a.coordinateSystem.cx,g=a.coordinateSystem.cy,v=a.get("barMinHeight")||0,_=a.get("barMinAngle")||0;r[c]=r[c]||[];for(var x=s.mapDimension(p.dim),b=s.mapDimension(l.dim),S=xd(s,x),T=l.dim!=="radius"||!a.get("roundCap",!0),M=p.dataToCoord(0),C=0,k=s.count();C<k;C++){var R=s.get(x,C),P=s.get(b,C),N=R>=0?"p":"n",L=M;S&&(r[c][P]||(r[c][P]={p:M,n:M}),L=r[c][P][N]);var F=void 0,O=void 0,B=void 0,H=void 0;if(p.dim==="radius"){var j=p.dataToCoord(R)-M,K=l.dataToCoord(P);Math.abs(j)<v&&(j=(j<0?-1:1)*v),F=L,O=L+j,B=K-h,H=B-d,S&&(r[c][P][N]=O)}else{var J=p.dataToCoord(R,T)-M,re=l.dataToCoord(P);Math.abs(J)<_&&(J=(J<0?-1:1)*_),F=re+h,O=F+d,B=L,H=L+J,S&&(r[c][P][N]=H)}s.setItemLayout(C,{cx:m,cy:g,r0:F,r:O,startAngle:-B*Math.PI/180,endAngle:-H*Math.PI/180,clockwise:B>=H})}}})}function f$e(n){var e={};ce(n,function(r,i){var a=r.getData(),s=r.coordinateSystem,o=s.getBaseAxis(),l=hZ(s,o),u=o.getExtent(),c=o.type==="category"?o.getBandWidth():Math.abs(u[1]-u[0])/a.count(),f=e[l]||{bandWidth:c,remainedWidth:c,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},h=f.stacks;e[l]=f;var d=fZ(r);h[d]||f.autoWidthCount++,h[d]=h[d]||{width:0,maxWidth:0};var p=Jn(r.get("barWidth"),c),m=Jn(r.get("barMaxWidth"),c),g=r.get("barGap"),v=r.get("barCategoryGap");p&&!h[d].width&&(p=Math.min(f.remainedWidth,p),h[d].width=p,f.remainedWidth-=p),m&&(h[d].maxWidth=m),g!=null&&(f.gap=g),v!=null&&(f.categoryGap=v)});var t={};return ce(e,function(r,i){t[i]={};var a=r.stacks,s=r.bandWidth,o=Jn(r.categoryGap,s),l=Jn(r.gap,1),u=r.remainedWidth,c=r.autoWidthCount,f=(u-o)/(c+(c-1)*l);f=Math.max(f,0),ce(a,function(m,g){var v=m.maxWidth;v&&v<f&&(v=Math.min(v,u),m.width&&(v=Math.min(v,m.width)),u-=v,m.width=v,c--)}),f=(u-o)/(c+(c-1)*l),f=Math.max(f,0);var h=0,d;ce(a,function(m,g){m.width||(m.width=f),d=m,h+=m.width*(1+l)}),d&&(h-=d.width*l);var p=-h/2;ce(a,function(m,g){t[i][g]=t[i][g]||{offset:p,width:m.width},p+=m.width*(1+l)})}),t}var h$e={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},d$e={splitNumber:5},p$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="polar",e}(Ps);function cit(n){Yu(MD),$_.registerAxisPointerClass("PolarAxisPointer",B3e),n.registerCoordinateSystem("polar",J3e),n.registerComponentModel(z3e),n.registerComponentView(p$e),Jw(n,"angle",V3e,h$e),Jw(n,"radius",H3e,d$e),n.registerComponentView(r$e),n.registerComponentView(u$e),n.registerLayout(ir(c$e,"bar"))}var R6=["x","y","radius","angle","single"],m$e=["cartesian2d","polar","singleAxis"];function g$e(n){var e=n.get("coordinateSystem");return Vn(m$e,e)>=0}function mm(n){return n+"Axis"}function v$e(n,e){var t=dn(),r=[],i=dn();n.eachComponent({mainType:"dataZoom",query:e},function(c){i.get(c.uid)||o(c)});var a;do a=!1,n.eachComponent("dataZoom",s);while(a);function s(c){!i.get(c.uid)&&l(c)&&(o(c),a=!0)}function o(c){i.set(c.uid,!0),r.push(c),u(c)}function l(c){var f=!1;return c.eachTargetAxis(function(h,d){var p=t.get(h);p&&p[d]&&(f=!0)}),f}function u(c){c.eachTargetAxis(function(f,h){(t.get(f)||t.set(f,[]))[h]=!0})}return r}var sA=function(){function n(){this.indexList=[],this.indexMap=[]}return n.prototype.add=function(e){this.indexMap[e]||(this.indexList.push(e),this.indexMap[e]=!0)},n}(),y$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t._autoThrottle=!0,t._noTarget=!0,t._rangePropMode=["percent","percent"],t}return e.prototype.init=function(t,r,i){var a=P6(t);this.settledOption=a,this.mergeDefaultAndTheme(t,i),this._doInit(a)},e.prototype.mergeOption=function(t){var r=P6(t);Dn(this.option,t,!0),Dn(this.settledOption,r,!0),this._doInit(r)},e.prototype._doInit=function(t){var r=this.option;this._setDefaultThrottle(t),this._updateRangeUse(t);var i=this.settledOption;ce([["start","startValue"],["end","endValue"]],function(a,s){this._rangePropMode[s]==="value"&&(r[a[0]]=i[a[0]]=null)},this),this._resetTarget()},e.prototype._resetTarget=function(){var t=this.get("orient",!0),r=this._targetAxisInfoMap=dn(),i=this._fillSpecifiedTargetAxis(r);i?this._orient=t||this._makeAutoOrientByTargetAxis():(this._orient=t||"horizontal",this._fillAutoTargetAxisByOrient(r,this._orient)),this._noTarget=!0,r.each(function(a){a.indexList.length&&(this._noTarget=!1)},this)},e.prototype._fillSpecifiedTargetAxis=function(t){var r=!1;return ce(R6,function(i){var a=this.getReferringComponents(mm(i),FAe);if(a.specified){r=!0;var s=new sA;ce(a.models,function(o){s.add(o.componentIndex)}),t.set(i,s)}},this),r},e.prototype._fillAutoTargetAxisByOrient=function(t,r){var i=this.ecModel,a=!0;if(a){var s=r==="vertical"?"y":"x",o=i.findComponents({mainType:s+"Axis"});l(o,s)}if(a){var o=i.findComponents({mainType:"singleAxis",filter:function(c){return c.get("orient",!0)===r}});l(o,"single")}function l(u,c){var f=u[0];if(f){var h=new sA;if(h.add(f.componentIndex),t.set(c,h),a=!1,c==="x"||c==="y"){var d=f.getReferringComponents("grid",qi).models[0];d&&ce(u,function(p){f.componentIndex!==p.componentIndex&&d===p.getReferringComponents("grid",qi).models[0]&&h.add(p.componentIndex)})}}}a&&ce(R6,function(u){if(a){var c=i.findComponents({mainType:mm(u),filter:function(h){return h.get("type",!0)==="category"}});if(c[0]){var f=new sA;f.add(c[0].componentIndex),t.set(u,f),a=!1}}},this)},e.prototype._makeAutoOrientByTargetAxis=function(){var t;return this.eachTargetAxis(function(r){!t&&(t=r)},this),t==="y"?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var r=this.ecModel.option;this.option.throttle=r.animation&&r.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(t){var r=this._rangePropMode,i=this.get("rangeMode");ce([["start","startValue"],["end","endValue"]],function(a,s){var o=t[a[0]]!=null,l=t[a[1]]!=null;o&&!l?r[s]="percent":!o&&l?r[s]="value":i?r[s]=i[s]:o&&(r[s]="percent")})},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var t;return this.eachTargetAxis(function(r,i){t==null&&(t=this.ecModel.getComponent(mm(r),i))},this),t},e.prototype.eachTargetAxis=function(t,r){this._targetAxisInfoMap.each(function(i,a){ce(i.indexList,function(s){t.call(r,a,s)})})},e.prototype.getAxisProxy=function(t,r){var i=this.getAxisModel(t,r);if(i)return i.__dzAxisProxy},e.prototype.getAxisModel=function(t,r){var i=this._targetAxisInfoMap.get(t);if(i&&i.indexMap[r])return this.ecModel.getComponent(mm(t),r)},e.prototype.setRawRange=function(t){var r=this.option,i=this.settledOption;ce([["start","startValue"],["end","endValue"]],function(a){(t[a[0]]!=null||t[a[1]]!=null)&&(r[a[0]]=i[a[0]]=t[a[0]],r[a[1]]=i[a[1]]=t[a[1]])},this),this._updateRangeUse(t)},e.prototype.setCalculatedRange=function(t){var r=this.option;ce(["start","startValue","end","endValue"],function(i){r[i]=t[i]})},e.prototype.getPercentRange=function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},e.prototype.getValueRange=function(t,r){if(t==null&&r==null){var i=this.findRepresentativeAxisProxy();if(i)return i.getDataValueWindow()}else return this.getAxisProxy(t,r).getDataValueWindow()},e.prototype.findRepresentativeAxisProxy=function(t){if(t)return t.__dzAxisProxy;for(var r,i=this._targetAxisInfoMap.keys(),a=0;a<i.length;a++)for(var s=i[a],o=this._targetAxisInfoMap.get(s),l=0;l<o.indexList.length;l++){var u=this.getAxisProxy(s,o.indexList[l]);if(u.hostedBy(this))return u;r||(r=u)}return r},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={z:4,filterMode:"filter",start:0,end:100},e}(Sr);function P6(n){var e={};return ce(["start","end","startValue","endValue","throttle"],function(t){n.hasOwnProperty(t)&&(e[t]=n[t])}),e}const _$e=y$e;var x$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(_$e);const b$e=x$e;var w$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i,a){this.dataZoomModel=t,this.ecModel=r,this.api=i},e.type="dataZoom",e}(Ps);const S$e=w$e;var T$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(S$e);const C$e=T$e;var am=ce,I6=_Ae,E$e=function(){function n(e,t,r,i){this._dimName=e,this._axisIndex=t,this.ecModel=i,this._dataZoomModel=r}return n.prototype.hostedBy=function(e){return this._dataZoomModel===e},n.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},n.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},n.prototype.getTargetSeriesModels=function(){var e=[];return this.ecModel.eachSeries(function(t){if(g$e(t)){var r=mm(this._dimName),i=t.getReferringComponents(r,qi).models[0];i&&this._axisIndex===i.componentIndex&&e.push(t)}},this),e},n.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},n.prototype.getMinMaxSpan=function(){return wn(this._minMaxSpan)},n.prototype.calculateDataWindow=function(e){var t=this._dataExtent,r=this.getAxisModel(),i=r.axis.scale,a=this._dataZoomModel.getRangePropMode(),s=[0,100],o=[],l=[],u;am(["start","end"],function(h,d){var p=e[h],m=e[h+"Value"];a[d]==="percent"?(p==null&&(p=s[d]),m=i.parse(Vc(p,s,t))):(u=!0,m=m==null?t[d]:i.parse(m),p=Vc(m,t,s)),l[d]=m==null||isNaN(m)?t[d]:m,o[d]=p==null||isNaN(p)?s[d]:p}),I6(l),I6(o);var c=this._minMaxSpan;u?f(l,o,t,s,!1):f(o,l,s,t,!0);function f(h,d,p,m,g){var v=g?"Span":"ValueSpan";HY(0,h,p,"all",c["min"+v],c["max"+v]);for(var _=0;_<2;_++)d[_]=Vc(h[_],p,m,!0),g&&(d[_]=i.parse(d[_]))}return{valueWindow:l,percentWindow:o}},n.prototype.reset=function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=A$e(this,this._dimName,t),this._updateMinMaxSpan();var r=this.calculateDataWindow(e.settledOption);this._valueWindow=r.valueWindow,this._percentWindow=r.percentWindow,this._setAxisModel()}},n.prototype.filterData=function(e,t){if(e!==this._dataZoomModel)return;var r=this._dimName,i=this.getTargetSeriesModels(),a=e.get("filterMode"),s=this._valueWindow;if(a==="none")return;am(i,function(l){var u=l.getData(),c=u.mapDimensionsAll(r);if(c.length){if(a==="weakFilter"){var f=u.getStore(),h=Nt(c,function(d){return u.getDimensionIndex(d)},u);u.filterSelf(function(d){for(var p,m,g,v=0;v<c.length;v++){var _=f.get(h[v],d),x=!isNaN(_),b=_<s[0],S=_>s[1];if(x&&!b&&!S)return!0;x&&(g=!0),b&&(p=!0),S&&(m=!0)}return g&&p&&m})}else am(c,function(d){if(a==="empty")l.setData(u=u.map(d,function(m){return o(m)?m:NaN}));else{var p={};p[d]=s,u.selectRange(p)}});am(c,function(d){u.setApproximateExtent(s,d)})}});function o(l){return l>=s[0]&&l<=s[1]}},n.prototype._updateMinMaxSpan=function(){var e=this._minMaxSpan={},t=this._dataZoomModel,r=this._dataExtent;am(["min","max"],function(i){var a=t.get(i+"Span"),s=t.get(i+"ValueSpan");s!=null&&(s=this.getAxisModel().axis.scale.parse(s)),s!=null?a=Vc(r[0]+s,r,[0,100],!0):a!=null&&(s=Vc(a,[0,100],r,!0)-r[0]),e[i+"Span"]=a,e[i+"ValueSpan"]=s},this)},n.prototype._setAxisModel=function(){var e=this.getAxisModel(),t=this._percentWindow,r=this._valueWindow;if(t){var i=oq(r,[0,500]);i=Math.min(i,20);var a=e.axis.scale.rawExtentInfo;t[0]!==0&&a.setDeterminedMinMax("min",+r[0].toFixed(i)),t[1]!==100&&a.setDeterminedMinMax("max",+r[1].toFixed(i)),a.freeze()}},n}();function A$e(n,e,t){var r=[1/0,-1/0];am(t,function(s){kLe(r,s.getData(),e)});var i=n.getAxisModel(),a=aY(i.axis.scale,i,r).calculate();return[a.min,a.max]}const M$e=E$e;var k$e={getTargetSeries:function(n){function e(i){n.eachComponent("dataZoom",function(a){a.eachTargetAxis(function(s,o){var l=n.getComponent(mm(s),o);i(s,o,l,a)})})}e(function(i,a,s,o){s.__dzAxisProxy=null});var t=[];e(function(i,a,s,o){s.__dzAxisProxy||(s.__dzAxisProxy=new M$e(i,a,o,n),t.push(s.__dzAxisProxy))});var r=dn();return ce(t,function(i){ce(i.getTargetSeriesModels(),function(a){r.set(a.uid,a)})}),r},overallReset:function(n,e){n.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(r,i){t.getAxisProxy(r,i).reset(t)}),t.eachTargetAxis(function(r,i){t.getAxisProxy(r,i).filterData(t,e)})}),n.eachComponent("dataZoom",function(t){var r=t.findRepresentativeAxisProxy();if(r){var i=r.getDataPercentWindow(),a=r.getDataValueWindow();t.setCalculatedRange({start:i[0],end:i[1],startValue:a[0],endValue:a[1]})}})}};const R$e=k$e;function P$e(n){n.registerAction("dataZoom",function(e,t){var r=v$e(t,e);ce(r,function(i){i.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})}var D6=!1;function I$e(n){D6||(D6=!0,n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,R$e),P$e(n),n.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function D$e(n){n.registerComponentModel(b$e),n.registerComponentView(C$e),I$e(n)}var Uo=function(){function n(){}return n}(),dZ={};function ry(n,e){dZ[n]=e}function pZ(n){return dZ[n]}var L$e=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.optionUpdated=function(){n.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;ce(this.option.feature,function(r,i){var a=pZ(i);a&&(a.getDefaultOption&&(a.defaultOption=a.getDefaultOption(t)),Dn(r,a.defaultOption))})},e.type="toolbox",e.layoutMode={type:"box",ignoreSize:!0},e.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},e}(Sr);const N$e=L$e;function O$e(n,e,t){var r=e.getBoxLayoutParams(),i=e.get("padding"),a={width:t.getWidth(),height:t.getHeight()},s=vf(r,a,i);Om(e.get("orient"),n,e.get("itemGap"),s.width,s.height),ERe(n,r,a,i)}function mZ(n,e){var t=LT(e.get("padding")),r=e.getItemStyle(["color","opacity"]);return r.fill=e.get("backgroundColor"),n=new oi({shape:{x:n.x-t[3],y:n.y-t[0],width:n.width+t[1]+t[3],height:n.height+t[0]+t[2],r:e.get("borderRadius")},style:r,silent:!0,z2:-1}),n}var $$e=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,i,a){var s=this.group;if(s.removeAll(),!t.get("show"))return;var o=+t.get("itemSize"),l=t.get("orient")==="vertical",u=t.get("feature")||{},c=this._features||(this._features={}),f=[];ce(u,function(p,m){f.push(m)}),new Y0(this._featureNames||[],f).add(h).update(h).remove(ir(h,null)).execute(),this._featureNames=f;function h(p,m){var g=f[p],v=f[m],_=u[g],x=new Fi(_,t,t.ecModel),b;if(a&&a.newTitle!=null&&a.featureName===g&&(_.title=a.newTitle),g&&!v){if(F$e(g))b={onclick:x.option.onclick,featureName:g};else{var S=pZ(g);if(!S)return;b=new S}c[g]=b}else if(b=c[v],!b)return;b.uid=L_("toolbox-feature"),b.model=x,b.ecModel=r,b.api=i;var T=b instanceof Uo;if(!g&&v){T&&b.dispose&&b.dispose(r,i);return}if(!x.get("show")||T&&b.unusable){T&&b.remove&&b.remove(r,i);return}d(x,b,g),x.setIconStatus=function(M,C){var k=this.option,R=this.iconPaths;k.iconStatus=k.iconStatus||{},k.iconStatus[M]=C,R[M]&&(C==="emphasis"?og:lg)(R[M])},b instanceof Uo&&b.render&&b.render(x,r,i,a)}function d(p,m,g){var v=p.getModel("iconStyle"),_=p.getModel(["emphasis","iconStyle"]),x=m instanceof Uo&&m.getIcons?m.getIcons():p.get("icon"),b=p.get("title")||{},S,T;jt(x)?(S={},S[g]=x):S=x,jt(b)?(T={},T[g]=b):T=b;var M=p.iconPaths={};ce(S,function(C,k){var R=CT(C,{},{x:-o/2,y:-o/2,width:o,height:o});R.setStyle(v.getItemStyle());var P=R.ensureState("emphasis");P.style=_.getItemStyle();var N=new Pi({style:{text:T[k],align:_.get("textAlign"),borderRadius:_.get("textBorderRadius"),padding:_.get("textPadding"),fill:null},ignore:!0});R.setTextContent(N),ET({el:R,componentModel:t,itemName:k,formatterParamsExtra:{title:T[k]}}),R.__title=T[k],R.on("mouseover",function(){var L=_.getItemStyle(),F=l?t.get("right")==null&&t.get("left")!=="right"?"right":"left":t.get("bottom")==null&&t.get("top")!=="bottom"?"bottom":"top";N.setStyle({fill:_.get("textFill")||L.fill||L.stroke||"#000",backgroundColor:_.get("textBackgroundColor")}),R.setTextConfig({position:_.get("textPosition")||F}),N.ignore=!t.get("showTitle"),i.enterEmphasis(this)}).on("mouseout",function(){p.get(["iconStatus",k])!=="emphasis"&&i.leaveEmphasis(this),N.hide()}),(p.get(["iconStatus",k])==="emphasis"?og:lg)(R),s.add(R),R.on("click",Rr(m.onclick,m,r,i,k)),M[k]=R})}O$e(s,t,i),s.add(mZ(s.getBoundingRect(),t)),l||s.eachChild(function(p){var m=p.__title,g=p.ensureState("emphasis"),v=g.textConfig||(g.textConfig={}),_=p.getTextContent(),x=_&&_.ensureState("emphasis");if(x&&!pn(x)&&m){var b=x.style||(x.style={}),S=M_(m,Pi.makeFont(b)),T=p.x+s.x,M=p.y+s.y+o,C=!1;M+S.height>i.getHeight()&&(v.position="top",C=!0);var k=C?-5-S.height:o+10;T+S.width/2>i.getWidth()?(v.position=["100%",k],b.align="right"):T-S.width/2<0&&(v.position=[0,k],b.align="left")}})},e.prototype.updateView=function(t,r,i,a){ce(this._features,function(s){s instanceof Uo&&s.updateView&&s.updateView(s.model,r,i,a)})},e.prototype.remove=function(t,r){ce(this._features,function(i){i instanceof Uo&&i.remove&&i.remove(t,r)}),this.group.removeAll()},e.prototype.dispose=function(t,r){ce(this._features,function(i){i instanceof Uo&&i.dispose&&i.dispose(t,r)})},e.type="toolbox",e}(Ps);function F$e(n){return n.indexOf("my")===0}const B$e=$$e;var U$e=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){var i=this.model,a=i.get("name")||t.get("title.0.text")||"echarts",s=r.getZr().painter.getType()==="svg",o=s?"svg":i.get("type",!0)||"png",l=r.getConnectedDataURL({type:o,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")}),u=In.browser;if(pn(MouseEvent)&&(u.newEdge||!u.ie&&!u.edge)){var c=document.createElement("a");c.download=a+"."+o,c.target="_blank",c.href=l;var f=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});c.dispatchEvent(f)}else if(window.navigator.msSaveOrOpenBlob||s){var h=l.split(","),d=h[0].indexOf("base64")>-1,p=s?decodeURIComponent(h[1]):h[1];d&&(p=window.atob(p));var m=a+"."+o;if(window.navigator.msSaveOrOpenBlob){for(var g=p.length,v=new Uint8Array(g);g--;)v[g]=p.charCodeAt(g);var _=new Blob([v]);window.navigator.msSaveOrOpenBlob(_,m)}else{var x=document.createElement("iframe");document.body.appendChild(x);var b=x.contentWindow,S=b.document;S.open("image/svg+xml","replace"),S.write(p),S.close(),b.focus(),S.execCommand("SaveAs",!0,m),document.body.removeChild(x)}}else{var T=i.get("lang"),M='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(T&&T[0]||"")+'" /></body>',C=window.open();C.document.write(M),C.document.title=a}},e.getDefaultOption=function(t){var r={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return r},e}(Uo);const z$e=U$e;var L6="__ec_magicType_stack__",V$e=[["line","bar"],["stack"]],H$e=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getIcons=function(){var t=this.model,r=t.get("icon"),i={};return ce(t.get("type"),function(a){r[a]&&(i[a]=r[a])}),i},e.getDefaultOption=function(t){var r={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return r},e.prototype.onclick=function(t,r,i){var a=this.model,s=a.get(["seriesIndex",i]);if(N6[i]){var o={series:[]},l=function(f){var h=f.subType,d=f.id,p=N6[i](h,d,f,a);p&&(ln(p,f.option),o.series.push(p));var m=f.coordinateSystem;if(m&&m.type==="cartesian2d"&&(i==="line"||i==="bar")){var g=m.getAxesByScale("ordinal")[0];if(g){var v=g.dim,_=v+"Axis",x=f.getReferringComponents(_,qi).models[0],b=x.componentIndex;o[_]=o[_]||[];for(var S=0;S<=b;S++)o[_][b]=o[_][b]||{};o[_][b].boundaryGap=i==="bar"}}};ce(V$e,function(f){Vn(f,i)>=0&&ce(f,function(h){a.setIconStatus(h,"normal")})}),a.setIconStatus(i,"emphasis"),t.eachComponent({mainType:"series",query:s==null?null:{seriesIndex:s}},l);var u,c=i;i==="stack"&&(u=Dn({stack:a.option.title.tiled,tiled:a.option.title.stack},a.option.title),a.get(["iconStatus",i])!=="emphasis"&&(c="tiled")),r.dispatchAction({type:"changeMagicType",currentType:c,newOption:o,newTitle:u,featureName:"magicType"})}},e}(Uo),N6={line:function(n,e,t,r){if(n==="bar")return Dn({id:e,type:"line",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","line"])||{},!0)},bar:function(n,e,t,r){if(n==="line")return Dn({id:e,type:"bar",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","bar"])||{},!0)},stack:function(n,e,t,r){var i=t.get("stack")===L6;if(n==="line"||n==="bar")return r.setIconStatus("stack",i?"normal":"emphasis"),Dn({id:e,stack:i?"":L6},r.get(["option","stack"])||{},!0)}};nu({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(n,e){e.mergeOption(n.newOption)});const W$e=H$e;var WT=new Array(60).join("-"),mg="	";function G$e(n){var e={},t=[],r=[];return n.eachRawSeries(function(i){var a=i.coordinateSystem;if(a&&(a.type==="cartesian2d"||a.type==="polar")){var s=a.getBaseAxis();if(s.type==="category"){var o=s.dim+"_"+s.index;e[o]||(e[o]={categoryAxis:s,valueAxis:a.getOtherAxis(s),series:[]},r.push({axisDim:s.dim,axisIndex:s.index})),e[o].series.push(i)}else t.push(i)}else t.push(i)}),{seriesGroupByCategoryAxis:e,other:t,meta:r}}function j$e(n){var e=[];return ce(n,function(t,r){var i=t.categoryAxis,a=t.valueAxis,s=a.dim,o=[" "].concat(Nt(t.series,function(d){return d.name})),l=[i.model.getCategories()];ce(t.series,function(d){var p=d.getRawData();l.push(d.getRawData().mapArray(p.mapDimension(s),function(m){return m}))});for(var u=[o.join(mg)],c=0;c<l[0].length;c++){for(var f=[],h=0;h<l.length;h++)f.push(l[h][c]);u.push(f.join(mg))}e.push(u.join(`
`))}),e.join(`

`+WT+`

`)}function q$e(n){return Nt(n,function(e){var t=e.getRawData(),r=[e.name],i=[];return t.each(t.dimensions,function(){for(var a=arguments.length,s=arguments[a-1],o=t.getName(s),l=0;l<a-1;l++)i[l]=arguments[l];r.push((o?o+mg:"")+i.join(mg))}),r.join(`
`)}).join(`

`+WT+`

`)}function X$e(n){var e=G$e(n);return{value:si([j$e(e.seriesGroupByCategoryAxis),q$e(e.other)],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join(`

`+WT+`

`),meta:e.meta}}function eS(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function K$e(n){var e=n.slice(0,n.indexOf(`
`));if(e.indexOf(mg)>=0)return!0}var jk=new RegExp("["+mg+"]+","g");function Y$e(n){for(var e=n.split(/\n+/g),t=eS(e.shift()).split(jk),r=[],i=Nt(t,function(l){return{name:l,data:[]}}),a=0;a<e.length;a++){var s=eS(e[a]).split(jk);r.push(s.shift());for(var o=0;o<s.length;o++)i[o]&&(i[o].data[a]=s[o])}return{series:i,categories:r}}function Z$e(n){for(var e=n.split(/\n+/g),t=eS(e.shift()),r=[],i=0;i<e.length;i++){var a=eS(e[i]);if(a){var s=a.split(jk),o="",l=void 0,u=!1;isNaN(s[0])?(u=!0,o=s[0],s=s.slice(1),r[i]={name:o,value:[]},l=r[i].value):l=r[i]=[];for(var c=0;c<s.length;c++)l.push(+s[c]);l.length===1&&(u?r[i].value=l[0]:r[i]=l[0])}}return{name:t,data:r}}function Q$e(n,e){var t=n.split(new RegExp(`
*`+WT+`
*`,"g")),r={series:[]};return ce(t,function(i,a){if(K$e(i)){var s=Y$e(i),o=e[a],l=o.axisDim+"Axis";o&&(r[l]=r[l]||[],r[l][o.axisIndex]={data:s.categories},r.series=r.series.concat(s.series))}else{var s=Z$e(i);r.series.push(s)}}),r}var J$e=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){setTimeout(function(){r.dispatchAction({type:"hideTip"})});var i=r.getDom(),a=this.model;this._dom&&i.removeChild(this._dom);var s=document.createElement("div");s.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",s.style.backgroundColor=a.get("backgroundColor")||"#fff";var o=document.createElement("h4"),l=a.get("lang")||[];o.innerHTML=l[0]||a.get("title"),o.style.cssText="margin:10px 20px",o.style.color=a.get("textColor");var u=document.createElement("div"),c=document.createElement("textarea");u.style.cssText="overflow:auto";var f=a.get("optionToContent"),h=a.get("contentToOption"),d=X$e(t);if(pn(f)){var p=f(r.getOption());jt(p)?u.innerHTML=p:O0(p)&&u.appendChild(p)}else{c.readOnly=a.get("readOnly");var m=c.style;m.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",m.color=a.get("textColor"),m.borderColor=a.get("textareaBorderColor"),m.backgroundColor=a.get("textareaColor"),c.value=d.value,u.appendChild(c)}var g=d.meta,v=document.createElement("div");v.style.cssText="position:absolute;bottom:5px;left:0;right:0";var _="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",x=document.createElement("div"),b=document.createElement("div");_+=";background-color:"+a.get("buttonColor"),_+=";color:"+a.get("buttonTextColor");var S=this;function T(){i.removeChild(s),S._dom=null}GM(x,"click",T),GM(b,"click",function(){if(h==null&&f!=null||h!=null&&f==null){T();return}var M;try{pn(h)?M=h(u,r.getOption()):M=Q$e(c.value,g)}catch(C){throw T(),new Error("Data view format error "+C)}M&&r.dispatchAction({type:"changeDataView",newOption:M}),T()}),x.innerHTML=l[1],b.innerHTML=l[2],b.style.cssText=x.style.cssText=_,!a.get("readOnly")&&v.appendChild(b),v.appendChild(x),s.appendChild(o),s.appendChild(u),s.appendChild(v),u.style.height=i.clientHeight-80+"px",i.appendChild(s),this._dom=s},e.prototype.remove=function(t,r){this._dom&&r.getDom().removeChild(this._dom)},e.prototype.dispose=function(t,r){this.remove(t,r)},e.getDefaultOption=function(t){var r={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return r},e}(Uo);function eFe(n,e){return Nt(n,function(t,r){var i=e&&e[r];if(Yt(i)&&!Rt(i)){var a=Yt(t)&&!Rt(t);a||(t={value:t});var s=i.name!=null&&t.name==null;return t=ln(t,i),s&&delete t.name,t}else return t})}nu({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(n,e){var t=[];ce(n.newOption.series,function(r){var i=e.getSeriesByName(r.name)[0];if(!i)t.push(gt({type:"scatter"},r));else{var a=i.get("data");t.push({name:r.name,data:eFe(r.data,a)})}}),e.mergeOption(ln({series:t},n.newOption))});const tFe=J$e;var gZ=ce,vZ=qr();function nFe(n,e){var t=ID(n);gZ(e,function(r,i){for(var a=t.length-1;a>=0;a--){var s=t[a];if(s[i])break}if(a<0){var o=n.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(o){var l=o.getPercentRange();t[0][i]={dataZoomId:i,start:l[0],end:l[1]}}}}),t.push(e)}function rFe(n){var e=ID(n),t=e[e.length-1];e.length>1&&e.pop();var r={};return gZ(t,function(i,a){for(var s=e.length-1;s>=0;s--)if(i=e[s][a],i){r[a]=i;break}}),r}function iFe(n){vZ(n).snapshots=null}function aFe(n){return ID(n).length}function ID(n){var e=vZ(n);return e.snapshots||(e.snapshots=[{}]),e.snapshots}var sFe=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){iFe(t),r.dispatchAction({type:"restore",from:this.uid})},e.getDefaultOption=function(t){var r={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])};return r},e}(Uo);nu({type:"restore",event:"restore",update:"prepareAndUpdate"},function(n,e){e.resetOption("recreate")});const oFe=sFe;var lFe=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],uFe=function(){function n(e,t,r){var i=this;this._targetInfoList=[];var a=O6(t,e);ce(cFe,function(s,o){(!r||!r.include||Vn(r.include,o)>=0)&&s(a,i._targetInfoList)})}return n.prototype.setOutputRanges=function(e,t){return this.matchOutputRanges(e,t,function(r,i,a){if((r.coordRanges||(r.coordRanges=[])).push(i),!r.coordRange){r.coordRange=i;var s=oA[r.brushType](0,a,i);r.__rangeOffset={offset:U6[r.brushType](s.values,r.range,[1,1]),xyMinMax:s.xyMinMax}}}),e},n.prototype.matchOutputRanges=function(e,t,r){ce(e,function(i){var a=this.findTargetInfo(i,t);a&&a!==!0&&ce(a.coordSyses,function(s){var o=oA[i.brushType](1,s,i.range,!0);r(i,o.values,s,t)})},this)},n.prototype.setInputRanges=function(e,t){ce(e,function(r){var i=this.findTargetInfo(r,t);if(r.range=r.range||[],i&&i!==!0){r.panelId=i.panelId;var a=oA[r.brushType](0,i.coordSys,r.coordRange),s=r.__rangeOffset;r.range=s?U6[r.brushType](a.values,s.offset,fFe(a.xyMinMax,s.xyMinMax)):a.values}},this)},n.prototype.makePanelOpts=function(e,t){return Nt(this._targetInfoList,function(r){var i=r.getPanelRect();return{panelId:r.panelId,defaultBrushType:t?t(r):null,clipPath:u3e(i),isTargetByCursor:f3e(i,e,r.coordSysModel),getLinearBrushOtherExtent:c3e(i)}})},n.prototype.controlSeries=function(e,t,r){var i=this.findTargetInfo(e,r);return i===!0||i&&Vn(i.coordSyses,t.coordinateSystem)>=0},n.prototype.findTargetInfo=function(e,t){for(var r=this._targetInfoList,i=O6(t,e),a=0;a<r.length;a++){var s=r[a],o=e.panelId;if(o){if(s.panelId===o)return s}else for(var l=0;l<$6.length;l++)if($6[l](i,s))return s}return!0},n}();function qk(n){return n[0]>n[1]&&n.reverse(),n}function O6(n,e){return Yy(n,e,{includeMainTypes:lFe})}var cFe={grid:function(n,e){var t=n.xAxisModels,r=n.yAxisModels,i=n.gridModels,a=dn(),s={},o={};!t&&!r&&!i||(ce(t,function(l){var u=l.axis.grid.model;a.set(u.id,u),s[u.id]=!0}),ce(r,function(l){var u=l.axis.grid.model;a.set(u.id,u),o[u.id]=!0}),ce(i,function(l){a.set(l.id,l),s[l.id]=!0,o[l.id]=!0}),a.each(function(l){var u=l.coordinateSystem,c=[];ce(u.getCartesians(),function(f,h){(Vn(t,f.getAxis("x").model)>=0||Vn(r,f.getAxis("y").model)>=0)&&c.push(f)}),e.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:c[0],coordSyses:c,getPanelRect:F6.grid,xAxisDeclared:s[l.id],yAxisDeclared:o[l.id]})}))},geo:function(n,e){ce(n.geoModels,function(t){var r=t.coordinateSystem;e.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:r,coordSyses:[r],getPanelRect:F6.geo})})}},$6=[function(n,e){var t=n.xAxisModel,r=n.yAxisModel,i=n.gridModel;return!i&&t&&(i=t.axis.grid.model),!i&&r&&(i=r.axis.grid.model),i&&i===e.gridModel},function(n,e){var t=n.geoModel;return t&&t===e.geoModel}],F6={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,e=n.getBoundingRect().clone();return e.applyTransform(zI(n)),e}},oA={lineX:ir(B6,0),lineY:ir(B6,1),rect:function(n,e,t,r){var i=n?e.pointToData([t[0][0],t[1][0]],r):e.dataToPoint([t[0][0],t[1][0]],r),a=n?e.pointToData([t[0][1],t[1][1]],r):e.dataToPoint([t[0][1],t[1][1]],r),s=[qk([i[0],a[0]]),qk([i[1],a[1]])];return{values:s,xyMinMax:s}},polygon:function(n,e,t,r){var i=[[1/0,-1/0],[1/0,-1/0]],a=Nt(t,function(s){var o=n?e.pointToData(s,r):e.dataToPoint(s,r);return i[0][0]=Math.min(i[0][0],o[0]),i[1][0]=Math.min(i[1][0],o[1]),i[0][1]=Math.max(i[0][1],o[0]),i[1][1]=Math.max(i[1][1],o[1]),o});return{values:a,xyMinMax:i}}};function B6(n,e,t,r){var i=t.getAxis(["x","y"][n]),a=qk(Nt([0,1],function(o){return e?i.coordToData(i.toLocalCoord(r[o]),!0):i.toGlobalCoord(i.dataToCoord(r[o]))})),s=[];return s[n]=a,s[1-n]=[NaN,NaN],{values:a,xyMinMax:s}}var U6={lineX:ir(z6,0),lineY:ir(z6,1),rect:function(n,e,t){return[[n[0][0]-t[0]*e[0][0],n[0][1]-t[0]*e[0][1]],[n[1][0]-t[1]*e[1][0],n[1][1]-t[1]*e[1][1]]]},polygon:function(n,e,t){return Nt(n,function(r,i){return[r[0]-t[0]*e[i][0],r[1]-t[1]*e[i][1]]})}};function z6(n,e,t,r){return[e[0]-r[n]*t[0],e[1]-r[n]*t[1]]}function fFe(n,e){var t=V6(n),r=V6(e),i=[t[0]/r[0],t[1]/r[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}function V6(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}const yZ=uFe;var Xk=ce,hFe=LAe("toolbox-dataZoom_"),dFe=function(n){ht(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,i,a){this._brushController||(this._brushController=new l3e(i.getZr()),this._brushController.on("brush",Rr(this._onBrush,this)).mount()),gFe(t,r,this,a,i),mFe(t,r)},e.prototype.onclick=function(t,r,i){pFe[i].call(this)},e.prototype.remove=function(t,r){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(t,r){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(t){var r=t.areas;if(!t.isEnd||!r.length)return;var i={},a=this.ecModel;this._brushController.updateCovers([]);var s=new yZ(DD(this.model),a,{include:["grid"]});s.matchOutputRanges(r,a,function(u,c,f){if(f.type==="cartesian2d"){var h=u.brushType;h==="rect"?(o("x",f,c[0]),o("y",f,c[1])):o({lineX:"x",lineY:"y"}[h],f,c)}}),nFe(a,i),this._dispatchZoomAction(i);function o(u,c,f){var h=c.getAxis(u),d=h.model,p=l(u,d,a),m=p.findRepresentativeAxisProxy(d).getMinMaxSpan();(m.minValueSpan!=null||m.maxValueSpan!=null)&&(f=HY(0,f.slice(),h.scale.getExtent(),0,m.minValueSpan,m.maxValueSpan)),p&&(i[p.id]={dataZoomId:p.id,startValue:f[0],endValue:f[1]})}function l(u,c,f){var h;return f.eachComponent({mainType:"dataZoom",subType:"select"},function(d){var p=d.getAxisModel(u,c.componentIndex);p&&(h=d)}),h}},e.prototype._dispatchZoomAction=function(t){var r=[];Xk(t,function(i,a){r.push(wn(i))}),r.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:r})},e.getDefaultOption=function(t){var r={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return r},e}(Uo),pFe={zoom:function(){var n=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:n})},back:function(){this._dispatchZoomAction(rFe(this.ecModel))}};function DD(n){var e={xAxisIndex:n.get("xAxisIndex",!0),yAxisIndex:n.get("yAxisIndex",!0),xAxisId:n.get("xAxisId",!0),yAxisId:n.get("yAxisId",!0)};return e.xAxisIndex==null&&e.xAxisId==null&&(e.xAxisIndex="all"),e.yAxisIndex==null&&e.yAxisId==null&&(e.yAxisIndex="all"),e}function mFe(n,e){n.setIconStatus("back",aFe(e)>1?"emphasis":"normal")}function gFe(n,e,t,r,i){var a=t._isZoomActive;r&&r.type==="takeGlobalCursor"&&(a=r.key==="dataZoomSelect"?r.dataZoomSelectActive:!1),t._isZoomActive=a,n.setIconStatus("zoom",a?"emphasis":"normal");var s=new yZ(DD(n),e,{include:["grid"]}),o=s.makePanelOpts(i,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});t._brushController.setPanels(o).enableBrush(a&&o.length?{brushType:"auto",brushStyle:n.getModel("brushStyle").getItemStyle()}:!1)}NRe("dataZoom",function(n){var e=n.getComponent("toolbox",0),t=["feature","dataZoom"];if(!e||e.get(t)==null)return;var r=e.getModel(t),i=[],a=DD(r),s=Yy(n,a);Xk(s.xAxisModels,function(l){return o(l,"xAxis","xAxisIndex")}),Xk(s.yAxisModels,function(l){return o(l,"yAxis","yAxisIndex")});function o(l,u,c){var f=l.componentIndex,h={type:"select",$fromToolbox:!0,filterMode:r.get("filterMode",!0)||"filter",id:hFe+u+f};h[c]=f,i.push(h)}return i});const vFe=dFe;function fit(n){n.registerComponentModel(N$e),n.registerComponentView(B$e),ry("saveAsImage",z$e),ry("magicType",W$e),ry("dataView",tFe),ry("dataZoom",vFe),ry("restore",oFe),Yu(D$e)}var yFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}(Sr);const _Fe=yFe;function _Z(n){var e=n.get("confine");return e!=null?!!e:n.get("renderMode")==="richText"}function xZ(n){if(In.domSupported){for(var e=document.documentElement.style,t=0,r=n.length;t<r;t++)if(n[t]in e)return n[t]}}var bZ=xZ(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xFe=xZ(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function wZ(n,e){if(!n)return e;e=kX(e,!0);var t=n.indexOf(e);return n=t===-1?e:"-"+n.slice(0,t)+"-"+e,n.toLowerCase()}function bFe(n,e){var t=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return t?e?t[e]:t:null}var wFe=wZ(xFe,"transition"),LD=wZ(bZ,"transform"),SFe="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(In.transform3dSupported?"will-change:transform;":"");function TFe(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function CFe(n,e,t){if(!jt(t)||t==="inside")return"";var r=n.get("backgroundColor"),i=n.get("borderWidth");e=_d(e);var a=TFe(t),s=Math.max(Math.round(i)*1.5,6),o="",l=LD+":",u;Vn(["left","right"],a)>-1?(o+="top:50%",l+="translateY(-50%) rotate("+(u=a==="left"?-225:-45)+"deg)"):(o+="left:50%",l+="translateX(-50%) rotate("+(u=a==="top"?225:45)+"deg)");var c=u*Math.PI/180,f=s+i,h=f*Math.abs(Math.cos(c))+f*Math.abs(Math.sin(c)),d=Math.round(((h-Math.SQRT2*i)/2+Math.SQRT2*i-(h-f)/2)*100)/100;o+=";"+a+":-"+d+"px";var p=e+" solid "+i+"px;",m=["position:absolute;width:"+s+"px;height:"+s+"px;z-index:-1;",o+";"+l+";","border-bottom:"+p,"border-right:"+p,"background-color:"+r+";"];return'<div style="'+m.join("")+'"></div>'}function EFe(n,e){var t="cubic-bezier(0.23,1,0.32,1)",r=" "+n/2+"s "+t,i="opacity"+r+",visibility"+r;return e||(r=" "+n+"s "+t,i+=In.transformSupported?","+LD+r:",left"+r+",top"+r),wFe+":"+i}function H6(n,e,t){var r=n.toFixed(0)+"px",i=e.toFixed(0)+"px";if(!In.transformSupported)return t?"top:"+i+";left:"+r+";":[["top",i],["left",r]];var a=In.transform3dSupported,s="translate"+(a?"3d":"")+"("+r+","+i+(a?",0":"")+")";return t?"top:0;left:0;"+LD+":"+s+";":[["top",0],["left",0],[bZ,s]]}function AFe(n){var e=[],t=n.get("fontSize"),r=n.getTextColor();r&&e.push("color:"+r),e.push("font:"+n.getFont()),t&&e.push("line-height:"+Math.round(t*3/2)+"px");var i=n.get("textShadowColor"),a=n.get("textShadowBlur")||0,s=n.get("textShadowOffsetX")||0,o=n.get("textShadowOffsetY")||0;return i&&a&&e.push("text-shadow:"+s+"px "+o+"px "+a+"px "+i),ce(["decoration","align"],function(l){var u=n.get(l);u&&e.push("text-"+l+":"+u)}),e.join(";")}function MFe(n,e,t){var r=[],i=n.get("transitionDuration"),a=n.get("backgroundColor"),s=n.get("shadowBlur"),o=n.get("shadowColor"),l=n.get("shadowOffsetX"),u=n.get("shadowOffsetY"),c=n.getModel("textStyle"),f=sK(n,"html"),h=l+"px "+u+"px "+s+"px "+o;return r.push("box-shadow:"+h),e&&i&&r.push(EFe(i,t)),a&&r.push("background-color:"+a),ce(["width","color","radius"],function(d){var p="border-"+d,m=kX(p),g=n.get(m);g!=null&&r.push(p+":"+g+(d==="color"?"":"px"))}),r.push(AFe(c)),f!=null&&r.push("padding:"+LT(f).join("px ")+"px"),r.join(";")+";"}function W6(n,e,t,r,i){var a=e&&e.painter;if(t){var s=a&&a.getViewportRoot();s&&sEe(n,s,document.body,r,i)}else{n[0]=r,n[1]=i;var o=a&&a.getViewportRootOffset();o&&(n[0]+=o.offsetLeft,n[1]+=o.offsetTop)}n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var kFe=function(){function n(e,t,r){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,In.wxa)return null;var i=document.createElement("div");i.domBelongToZr=!0,this.el=i;var a=this._zr=t.getZr(),s=this._appendToBody=r&&r.appendToBody;W6(this._styleCoord,a,s,t.getWidth()/2,t.getHeight()/2),s?document.body.appendChild(i):e.appendChild(i),this._container=e;var o=this;i.onmouseenter=function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0},i.onmousemove=function(l){if(l=l||window.event,!o._enterable){var u=a.handler,c=a.painter.getViewportRoot();Gs(c,l,!0),u.dispatch("mousemove",l)}},i.onmouseleave=function(){o._inContent=!1,o._enterable&&o._show&&o.hideLater(o._hideDelay)}}return n.prototype.update=function(e){var t=this._container,r=bFe(t,"position"),i=t.style;i.position!=="absolute"&&r!=="absolute"&&(i.position="relative");var a=e.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=e.get("className")||""},n.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var r=this.el,i=r.style,a=this._styleCoord;r.innerHTML?i.cssText=SFe+MFe(e,!this._firstShow,this._longHide)+H6(a[0],a[1],!0)+("border-color:"+_d(t)+";")+(e.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(e,t,r,i,a){var s=this.el;if(e==null){s.innerHTML="";return}var o="";if(jt(a)&&r.get("trigger")==="item"&&!_Z(r)&&(o=CFe(r,i,a)),jt(e))s.innerHTML=e+o;else if(e){s.innerHTML="",Rt(e)||(e=[e]);for(var l=0;l<e.length;l++)O0(e[l])&&e[l].parentNode!==s&&s.appendChild(e[l]);if(o&&s.childNodes.length){var u=document.createElement("div");u.innerHTML=o,s.appendChild(u)}}},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},n.prototype.moveTo=function(e,t){var r=this._styleCoord;if(W6(r,this._zr,this._appendToBody,e,t),r[0]!=null&&r[1]!=null){var i=this.el.style,a=H6(r[0],r[1]);ce(a,function(s){i[s[0]]=s[1]})}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){var e=this,t=this.el.style;t.visibility="hidden",t.opacity="0",In.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(Rr(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},n}();const RFe=kFe;var PFe=function(){function n(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),j6(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return n.prototype.update=function(e){var t=e.get("alwaysShowContent");t&&this._moveIfResized(),this._alwaysShowContent=t},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(e,t,r,i,a){var s=this;Yt(e)&&Qn(""),this.el&&this._zr.remove(this.el);var o=r.getModel("textStyle");this.el=new Pi({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:o.get("textShadowColor"),fill:r.get(["textStyle","color"]),padding:sK(r,"richText"),verticalAlign:"top",align:"left"},z:r.get("z")}),ce(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(u){s.el.style[u]=r.get(u)}),ce(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(u){s.el.style[u]=o.get(u)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),r=G6(e.style);return[t.width+r.left+r.right,t.height+r.top+r.bottom]},n.prototype.moveTo=function(e,t){var r=this.el;if(r){var i=this._styleCoord;j6(i,this._zr,e,t),e=i[0],t=i[1];var a=r.style,s=Oc(a.borderWidth||0),o=G6(a);r.x=e+s+o.left,r.y=t+s+o.top,r.markRedraw()}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(Rr(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function Oc(n){return Math.max(0,n)}function G6(n){var e=Oc(n.shadowBlur||0),t=Oc(n.shadowOffsetX||0),r=Oc(n.shadowOffsetY||0);return{left:Oc(e-t),right:Oc(e+t),top:Oc(e-r),bottom:Oc(e+r)}}function j6(n,e,t,r){n[0]=t,n[1]=r,n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}const IFe=PFe;var DFe=new oi({shape:{x:-1,y:-1,width:2,height:2}}),LFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.init=function(t,r){if(!(In.node||!r.getDom())){var i=t.getComponent("tooltip"),a=this._renderMode=UAe(i.get("renderMode"));this._tooltipContent=a==="richText"?new IFe(r):new RFe(r.getDom(),r,{appendToBody:i.get("appendToBody",!0)})}},e.prototype.render=function(t,r,i){if(!(In.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=t,this._ecModel=r,this._api=i;var a=this._tooltipContent;a.update(t),a.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&t.get("transitionDuration")?lK(this,"_updatePosition",50,"fixRate"):Sk(this,"_updatePosition")}},e.prototype._initGlobalListener=function(){var t=this._tooltipModel,r=t.get("triggerOn");lZ("itemTooltip",this._api,Rr(function(i,a,s){r!=="none"&&(r.indexOf(i)>=0?this._tryShow(a,s):i==="leave"&&this._hide(s))},this))},e.prototype._keepShow=function(){var t=this._tooltipModel,r=this._ecModel,i=this._api,a=t.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var s=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&s.manuallyShowTip(t,r,i,{x:s._lastX,y:s._lastY,dataByCoordSys:s._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(t,r,i,a){if(!(a.from===this.uid||In.node||!i.getDom())){var s=q6(a,i);this._ticket="";var o=a.dataByCoordSys,l=FFe(a,r,i);if(l){var u=l.el.getBoundingRect().clone();u.applyTransform(l.el.transform),this._tryShow({offsetX:u.x+u.width/2,offsetY:u.y+u.height/2,target:l.el,position:a.position,positionDefault:"bottom"},s)}else if(a.tooltip&&a.x!=null&&a.y!=null){var c=DFe;c.x=a.x,c.y=a.y,c.update(),ar(c).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:c},s)}else if(o)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:o,tooltipOption:a.tooltipOption},s);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(t,r,i,a))return;var f=uZ(a,r),h=f.point[0],d=f.point[1];h!=null&&d!=null&&this._tryShow({offsetX:h,offsetY:d,target:f.el,position:a.position,positionDefault:"bottom"},s)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},s))}},e.prototype.manuallyHideTip=function(t,r,i,a){var s=this._tooltipContent;this._tooltipModel&&s.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(q6(a,i))},e.prototype._manuallyAxisShowTip=function(t,r,i,a){var s=a.seriesIndex,o=a.dataIndex,l=r.getComponent("axisPointer").coordSysAxesInfo;if(!(s==null||o==null||l==null)){var u=r.getSeriesByIndex(s);if(u){var c=u.getData(),f=iy([c.getItemModel(o),u,(u.coordinateSystem||{}).model],this._tooltipModel);if(f.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:s,dataIndex:o,position:a.position}),!0}}},e.prototype._tryShow=function(t,r){var i=t.target,a=this._tooltipModel;if(a){this._lastX=t.offsetX,this._lastY=t.offsetY;var s=t.dataByCoordSys;if(s&&s.length)this._showAxisTooltip(s,t);else if(i){this._lastDataByCoordSys=null;var o,l;Sy(i,function(u){if(ar(u).dataIndex!=null)return o=u,!0;if(ar(u).tooltipConfig!=null)return l=u,!0},!0),o?this._showSeriesItemTooltip(t,o,r):l?this._showComponentItemTooltip(t,l,r):this._hide(r)}else this._lastDataByCoordSys=null,this._hide(r)}},e.prototype._showOrMove=function(t,r){var i=t.get("showDelay");r=Rr(r,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(r,i):r()},e.prototype._showAxisTooltip=function(t,r){var i=this._ecModel,a=this._tooltipModel,s=[r.offsetX,r.offsetY],o=iy([r.tooltipOption],a),l=this._renderMode,u=[],c=q0("section",{blocks:[],noHeader:!0}),f=[],h=new LE;ce(t,function(_){ce(_.dataByAxis,function(x){var b=i.getComponent(x.axisDim+"Axis",x.axisIndex),S=x.value;if(!(!b||S==null)){var T=aZ(S,b.axis,i,x.seriesDataIndices,x.valueLabelOpt),M=q0("section",{header:T,noHeader:!Dl(T),sortBlocks:!0,blocks:[]});c.blocks.push(M),ce(x.seriesDataIndices,function(C){var k=i.getSeriesByIndex(C.seriesIndex),R=C.dataIndexInside,P=k.getDataParams(R);if(!(P.dataIndex<0)){P.axisDim=x.axisDim,P.axisIndex=x.axisIndex,P.axisType=x.axisType,P.axisId=x.axisId,P.axisValue=mD(b.axis,{value:S}),P.axisValueLabel=T,P.marker=h.makeTooltipMarker("item",_d(P.color),l);var N=Lz(k.formatTooltip(R,!0,null)),L=N.frag;if(L){var F=iy([k],a).get("valueFormatter");M.blocks.push(F?gt({valueFormatter:F},L):L)}N.text&&f.push(N.text),u.push(P)}})}})}),c.blocks.reverse(),f.reverse();var d=r.position,p=o.get("order"),m=Uz(c,h,l,p,i.get("useUTC"),o.get("textStyle"));m&&f.unshift(m);var g=l==="richText"?`

`:"<br/>",v=f.join(g);this._showOrMove(o,function(){this._updateContentNotChangedOnAxis(t,u)?this._updatePosition(o,d,s[0],s[1],this._tooltipContent,u):this._showTooltipContent(o,v,u,Math.random()+"",s[0],s[1],d,null,h)})},e.prototype._showSeriesItemTooltip=function(t,r,i){var a=this._ecModel,s=ar(r),o=s.seriesIndex,l=a.getSeriesByIndex(o),u=s.dataModel||l,c=s.dataIndex,f=s.dataType,h=u.getData(f),d=this._renderMode,p=t.positionDefault,m=iy([h.getItemModel(c),u,l&&(l.coordinateSystem||{}).model],this._tooltipModel,p?{position:p}:null),g=m.get("trigger");if(!(g!=null&&g!=="item")){var v=u.getDataParams(c,f),_=new LE;v.marker=_.makeTooltipMarker("item",_d(v.color),d);var x=Lz(u.formatTooltip(c,!1,f)),b=m.get("order"),S=m.get("valueFormatter"),T=x.frag,M=T?Uz(S?gt({valueFormatter:S},T):T,_,d,b,a.get("useUTC"),m.get("textStyle")):x.text,C="item_"+u.name+"_"+c;this._showOrMove(m,function(){this._showTooltipContent(m,M,v,C,t.offsetX,t.offsetY,t.position,t.target,_)}),i({type:"showTip",dataIndexInside:c,dataIndex:h.getRawIndex(c),seriesIndex:o,from:this.uid})}},e.prototype._showComponentItemTooltip=function(t,r,i){var a=ar(r),s=a.tooltipConfig,o=s.option||{};if(jt(o)){var l=o;o={content:l,formatter:l}}var u=[o],c=this._ecModel.getComponent(a.componentMainType,a.componentIndex);c&&u.push(c),u.push({formatter:o.content});var f=t.positionDefault,h=iy(u,this._tooltipModel,f?{position:f}:null),d=h.get("content"),p=Math.random()+"",m=new LE;this._showOrMove(h,function(){var g=wn(h.get("formatterParams")||{});this._showTooltipContent(h,d,g,p,t.offsetX,t.offsetY,t.position,r,m)}),i({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(t,r,i,a,s,o,l,u,c){if(this._ticket="",!(!t.get("showContent")||!t.get("show"))){var f=this._tooltipContent;f.setEnterable(t.get("enterable"));var h=t.get("formatter");l=l||t.get("position");var d=r,p=this._getNearestPoint([s,o],i,t.get("trigger"),t.get("borderColor")),m=p.color;if(h)if(jt(h)){var g=t.ecModel.get("useUTC"),v=Rt(i)?i[0]:i,_=v&&v.axisType&&v.axisType.indexOf("time")>=0;d=h,_&&(d=kT(v.axisValue,d,g)),d=RX(d,i,!0)}else if(pn(h)){var x=Rr(function(b,S){b===this._ticket&&(f.setContent(S,c,t,m,l),this._updatePosition(t,l,s,o,f,i,u))},this);this._ticket=a,d=h(i,a,x)}else d=h;f.setContent(d,c,t,m,l),f.show(t,m),this._updatePosition(t,l,s,o,f,i,u)}},e.prototype._getNearestPoint=function(t,r,i,a){if(i==="axis"||Rt(r))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!Rt(r))return{color:a||r.color||r.borderColor}},e.prototype._updatePosition=function(t,r,i,a,s,o,l){var u=this._api.getWidth(),c=this._api.getHeight();r=r||t.get("position");var f=s.getSize(),h=t.get("align"),d=t.get("verticalAlign"),p=l&&l.getBoundingRect().clone();if(l&&p.applyTransform(l.transform),pn(r)&&(r=r([i,a],o,s.el,p,{viewSize:[u,c],contentSize:f.slice()})),Rt(r))i=Jn(r[0],u),a=Jn(r[1],c);else if(Yt(r)){var m=r;m.width=f[0],m.height=f[1];var g=vf(m,{width:u,height:c});i=g.x,a=g.y,h=null,d=null}else if(jt(r)&&l){var v=$Fe(r,p,f,t.get("borderWidth"));i=v[0],a=v[1]}else{var v=NFe(i,a,s,u,c,h?null:20,d?null:20);i=v[0],a=v[1]}if(h&&(i-=X6(h)?f[0]/2:h==="right"?f[0]:0),d&&(a-=X6(d)?f[1]/2:d==="bottom"?f[1]:0),_Z(t)){var v=OFe(i,a,s,u,c);i=v[0],a=v[1]}s.moveTo(i,a)},e.prototype._updateContentNotChangedOnAxis=function(t,r){var i=this._lastDataByCoordSys,a=this._cbParamsList,s=!!i&&i.length===t.length;return s&&ce(i,function(o,l){var u=o.dataByAxis||[],c=t[l]||{},f=c.dataByAxis||[];s=s&&u.length===f.length,s&&ce(u,function(h,d){var p=f[d]||{},m=h.seriesDataIndices||[],g=p.seriesDataIndices||[];s=s&&h.value===p.value&&h.axisType===p.axisType&&h.axisId===p.axisId&&m.length===g.length,s&&ce(m,function(v,_){var x=g[_];s=s&&v.seriesIndex===x.seriesIndex&&v.dataIndex===x.dataIndex}),a&&ce(h.seriesDataIndices,function(v){var _=v.seriesIndex,x=r[_],b=a[_];x&&b&&b.data!==x.data&&(s=!1)})})}),this._lastDataByCoordSys=t,this._cbParamsList=r,!!s},e.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,r){In.node||!r.getDom()||(Sk(this,"_updatePosition"),this._tooltipContent.dispose(),Gk("itemTooltip",r))},e.type="tooltip",e}(Ps);function iy(n,e,t){var r=e.ecModel,i;t?(i=new Fi(t,r,r),i=new Fi(e.option,i,r)):i=e;for(var a=n.length-1;a>=0;a--){var s=n[a];s&&(s instanceof Fi&&(s=s.get("tooltip",!0)),jt(s)&&(s={formatter:s}),s&&(i=new Fi(s,i,r)))}return i}function q6(n,e){return n.dispatchAction||Rr(e.dispatchAction,e)}function NFe(n,e,t,r,i,a,s){var o=t.getSize(),l=o[0],u=o[1];return a!=null&&(n+l+a+2>r?n-=l+a:n+=a),s!=null&&(e+u+s>i?e-=u+s:e+=s),[n,e]}function OFe(n,e,t,r,i){var a=t.getSize(),s=a[0],o=a[1];return n=Math.min(n+s,r)-s,e=Math.min(e+o,i)-o,n=Math.max(n,0),e=Math.max(e,0),[n,e]}function $Fe(n,e,t,r){var i=t[0],a=t[1],s=Math.ceil(Math.SQRT2*r)+8,o=0,l=0,u=e.width,c=e.height;switch(n){case"inside":o=e.x+u/2-i/2,l=e.y+c/2-a/2;break;case"top":o=e.x+u/2-i/2,l=e.y-a-s;break;case"bottom":o=e.x+u/2-i/2,l=e.y+c+s;break;case"left":o=e.x-i-s,l=e.y+c/2-a/2;break;case"right":o=e.x+u+s,l=e.y+c/2-a/2}return[o,l]}function X6(n){return n==="center"||n==="middle"}function FFe(n,e,t){var r=kI(n).queryOptionMap,i=r.keys()[0];if(!(!i||i==="series")){var a=R_(e,i,r.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),s=a.models[0];if(s){var o=t.getViewOfComponentModel(s),l;if(o.group.traverse(function(u){var c=ar(u).tooltipConfig;if(c&&c.name===n.name)return l=u,!0}),l)return{componentMainType:i,componentIndex:s.componentIndex,el:l}}}}const BFe=LFe;function hit(n){Yu(MD),n.registerComponentModel(_Fe),n.registerComponentView(BFe),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Oa),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Oa)}var UFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.type="title",e.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},e}(Sr),zFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i){if(this.group.removeAll(),!!t.get("show")){var a=this.group,s=t.getModel("textStyle"),o=t.getModel("subtextStyle"),l=t.get("textAlign"),u=Hn(t.get("textBaseline"),t.get("textVerticalAlign")),c=new Pi({style:Ku(s,{text:t.get("text"),fill:s.getTextColor()},{disableBox:!0}),z2:10}),f=c.getBoundingRect(),h=t.get("subtext"),d=new Pi({style:Ku(o,{text:h,fill:o.getTextColor(),y:f.height+t.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),p=t.get("link"),m=t.get("sublink"),g=t.get("triggerEvent",!0);c.silent=!p&&!g,d.silent=!m&&!g,p&&c.on("click",function(){gz(p,"_"+t.get("target"))}),m&&d.on("click",function(){gz(m,"_"+t.get("subtarget"))}),ar(c).eventData=ar(d).eventData=g?{componentType:"title",componentIndex:t.componentIndex}:null,a.add(c),h&&a.add(d);var v=a.getBoundingRect(),_=t.getBoxLayoutParams();_.width=v.width,_.height=v.height;var x=vf(_,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));l||(l=t.get("left")||t.get("right"),l==="middle"&&(l="center"),l==="right"?x.x+=x.width:l==="center"&&(x.x+=x.width/2)),u||(u=t.get("top")||t.get("bottom"),u==="center"&&(u="middle"),u==="bottom"?x.y+=x.height:u==="middle"&&(x.y+=x.height/2),u=u||"top"),a.x=x.x,a.y=x.y,a.markRedraw();var b={align:l,verticalAlign:u};c.setStyle(b),d.setStyle(b),v=a.getBoundingRect();var S=x.margin,T=t.getItemStyle(["color","opacity"]);T.fill=t.get("backgroundColor");var M=new oi({shape:{x:v.x-S[3],y:v.y-S[0],width:v.width+S[1]+S[3],height:v.height+S[0]+S[2],r:t.get("borderRadius")},style:T,subPixelOptimize:!0,silent:!0});a.add(M)}},e.type="title",e}(Ps);function dit(n){n.registerComponentModel(UFe),n.registerComponentView(zFe)}var VFe=function(n,e){if(e==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(e==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},HFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.prototype.init=function(t,r,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),this._updateSelector(t)},e.prototype._updateSelector=function(t){var r=t.selector,i=this.ecModel;r===!0&&(r=t.selector=["all","inverse"]),Rt(r)&&ce(r,function(a,s){jt(a)&&(a={type:a}),r[s]=Dn(a,VFe(i,a.type))})},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&this.get("selectedMode")==="single"){for(var r=!1,i=0;i<t.length;i++){var a=t[i].get("name");if(this.isSelected(a)){this.select(a),r=!0;break}}!r&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var r=[],i=[];t.eachRawSeries(function(l){var u=l.name;i.push(u);var c;if(l.legendVisualProvider){var f=l.legendVisualProvider,h=f.getAllNames();t.isSeriesFiltered(l)||(i=i.concat(h)),h.length?r=r.concat(h):c=!0}else c=!0;c&&MI(l)&&r.push(l.name)}),this._availableNames=i;var a=this.get("data")||r,s=dn(),o=Nt(a,function(l){return(jt(l)||gr(l))&&(l={name:l}),s.get(l.name)?null:(s.set(l.name,!0),new Fi(l,this,this.ecModel))},this);this._data=si(o,function(l){return!!l})},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var r=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;ce(a,function(s){r[s.get("name")]=!1})}r[t]=!0},e.prototype.unSelect=function(t){this.get("selectedMode")!=="single"&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var r=this.option.selected;r.hasOwnProperty(t)||(r[t]=!0),this[r[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,r=this.option.selected;ce(t,function(i){r[i.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var t=this._data,r=this.option.selected;ce(t,function(i){var a=i.get("name",!0);r.hasOwnProperty(a)||(r[a]=!0),r[a]=!r[a]})},e.prototype.isSelected=function(t){var r=this.option.selected;return!(r.hasOwnProperty(t)&&!r[t])&&Vn(this._availableNames,t)>=0},e.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(Sr);const Kk=HFe;var Wp=ir,Yk=ce,Jb=yi,WFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!1,t}return e.prototype.init=function(){this.group.add(this._contentGroup=new Jb),this.group.add(this._selectorGroup=new Jb),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,r,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!t.get("show",!0)){var s=t.get("align"),o=t.get("orient");(!s||s==="auto")&&(s=t.get("left")==="right"&&o==="vertical"?"right":"left");var l=t.get("selector",!0),u=t.get("selectorPosition",!0);l&&(!u||u==="auto")&&(u=o==="horizontal"?"end":"start"),this.renderInner(s,t,r,i,l,o,u);var c=t.getBoxLayoutParams(),f={width:i.getWidth(),height:i.getHeight()},h=t.get("padding"),d=vf(c,f,h),p=this.layoutInner(t,s,d,a,l,u),m=vf(ln({width:p.width,height:p.height},c),f,h);this.group.x=m.x-p.x,this.group.y=m.y-p.y,this.group.markRedraw(),this.group.add(this._backgroundEl=mZ(p,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,r,i,a,s,o,l){var u=this.getContentGroup(),c=dn(),f=r.get("selectedMode"),h=[];i.eachRawSeries(function(d){!d.get("legendHoverLink")&&h.push(d.id)}),Yk(r.getData(),function(d,p){var m=d.get("name");if(!this.newlineDisabled&&(m===""||m===`
`)){var g=new Jb;g.newline=!0,u.add(g);return}var v=i.getSeriesByName(m)[0];if(!c.get(m))if(v){var _=v.getData(),x=_.getVisual("legendLineStyle")||{},b=_.getVisual("legendIcon"),S=_.getVisual("style"),T=this._createItem(v,m,p,d,r,t,x,S,b,f,a);T.on("click",Wp(K6,m,null,a,h)).on("mouseover",Wp(Zk,v.name,null,a,h)).on("mouseout",Wp(Qk,v.name,null,a,h)),c.set(m,!0)}else i.eachRawSeries(function(M){if(!c.get(m)&&M.legendVisualProvider){var C=M.legendVisualProvider;if(!C.containName(m))return;var k=C.indexOfName(m),R=C.getItemVisual(k,"style"),P=C.getItemVisual(k,"legendIcon"),N=Uu(R.fill);N&&N[3]===0&&(N[3]=.2,R=gt(gt({},R),{fill:mT(N,"rgba")}));var L=this._createItem(M,m,p,d,r,t,{},R,P,f,a);L.on("click",Wp(K6,null,m,a,h)).on("mouseover",Wp(Zk,null,m,a,h)).on("mouseout",Wp(Qk,null,m,a,h)),c.set(m,!0)}},this)},this),s&&this._createSelector(s,r,a,o,l)},e.prototype._createSelector=function(t,r,i,a,s){var o=this.getSelectorGroup();Yk(t,function(u){var c=u.type,f=new Pi({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:c==="all"?"legendAllSelect":"legendInverseSelect"})}});o.add(f);var h=r.getModel("selectorLabel"),d=r.getModel(["emphasis","selectorLabel"]);I_(f,{normal:h,emphasis:d},{defaultText:u.title}),ck(f)})},e.prototype._createItem=function(t,r,i,a,s,o,l,u,c,f,h){var d=t.visualDrawType,p=s.get("itemWidth"),m=s.get("itemHeight"),g=s.isSelected(r),v=a.get("symbolRotate"),_=a.get("symbolKeepAspect"),x=a.get("icon");c=x||c||"roundRect";var b=GFe(c,a,l,u,d,g,h),S=new Jb,T=a.getModel("textStyle");if(pn(t.getLegendIcon)&&(!x||x==="inherit"))S.add(t.getLegendIcon({itemWidth:p,itemHeight:m,icon:c,iconRotate:v,itemStyle:b.itemStyle,lineStyle:b.lineStyle,symbolKeepAspect:_}));else{var M=x==="inherit"&&t.getData().getVisual("symbol")?v==="inherit"?t.getData().getVisual("symbolRotate"):v:0;S.add(jFe({itemWidth:p,itemHeight:m,icon:c,iconRotate:M,itemStyle:b.itemStyle,lineStyle:b.lineStyle,symbolKeepAspect:_}))}var C=o==="left"?p+5:-5,k=o,R=s.get("formatter"),P=r;jt(R)&&R?P=R.replace("{name}",r??""):pn(R)&&(P=R(r));var N=a.get("inactiveColor");S.add(new Pi({style:Ku(T,{text:P,x:C,y:m/2,fill:g?T.getTextColor():N,align:k,verticalAlign:"middle"})}));var L=new oi({shape:S.getBoundingRect(),invisible:!0}),F=a.getModel("tooltip");return F.get("show")&&ET({el:L,componentModel:s,itemName:r,itemTooltipOption:F.option}),S.add(L),S.eachChild(function(O){O.silent=!0}),L.silent=!f,this.getContentGroup().add(S),ck(S),S.__legendDataIndex=i,S},e.prototype.layoutInner=function(t,r,i,a,s,o){var l=this.getContentGroup(),u=this.getSelectorGroup();Om(t.get("orient"),l,t.get("itemGap"),i.width,i.height);var c=l.getBoundingRect(),f=[-c.x,-c.y];if(u.markRedraw(),l.markRedraw(),s){Om("horizontal",u,t.get("selectorItemGap",!0));var h=u.getBoundingRect(),d=[-h.x,-h.y],p=t.get("selectorButtonGap",!0),m=t.getOrient().index,g=m===0?"width":"height",v=m===0?"height":"width",_=m===0?"y":"x";o==="end"?d[m]+=c[g]+p:f[m]+=h[g]+p,d[1-m]+=c[v]/2-h[v]/2,u.x=d[0],u.y=d[1],l.x=f[0],l.y=f[1];var x={x:0,y:0};return x[g]=c[g]+p+h[g],x[v]=Math.max(c[v],h[v]),x[_]=Math.min(0,h[_]+d[1-m]),x}else return l.x=f[0],l.y=f[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(Ps);function GFe(n,e,t,r,i,a,s){function o(g,v){g.lineWidth==="auto"&&(g.lineWidth=v.lineWidth>0?2:0),Yk(g,function(_,x){g[x]==="inherit"&&(g[x]=v[x])})}var l=e.getModel("itemStyle"),u=l.getItemStyle(),c=n.lastIndexOf("empty",0)===0?"fill":"stroke",f=l.getShallow("decal");u.decal=!f||f==="inherit"?r.decal:Mk(f,s),u.fill==="inherit"&&(u.fill=r[i]),u.stroke==="inherit"&&(u.stroke=r[c]),u.opacity==="inherit"&&(u.opacity=(i==="fill"?r:t).opacity),o(u,r);var h=e.getModel("lineStyle"),d=h.getLineStyle();if(o(d,t),u.fill==="auto"&&(u.fill=r.fill),u.stroke==="auto"&&(u.stroke=r.fill),d.stroke==="auto"&&(d.stroke=r.fill),!a){var p=e.get("inactiveBorderWidth"),m=u[c];u.lineWidth=p==="auto"?r.lineWidth>0&&m?2:0:u.lineWidth,u.fill=e.get("inactiveColor"),u.stroke=e.get("inactiveBorderColor"),d.stroke=h.get("inactiveColor"),d.lineWidth=h.get("inactiveWidth")}return{itemStyle:u,lineStyle:d}}function jFe(n){var e=n.icon||"roundRect",t=hg(e,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return t.setStyle(n.itemStyle),t.rotation=(n.iconRotate||0)*Math.PI/180,t.setOrigin([n.itemWidth/2,n.itemHeight/2]),e.indexOf("empty")>-1&&(t.style.stroke=t.style.fill,t.style.fill="#fff",t.style.lineWidth=2),t}function K6(n,e,t,r){Qk(n,e,t,r),t.dispatchAction({type:"legendToggleSelect",name:n??e}),Zk(n,e,t,r)}function SZ(n){for(var e=n.getZr().storage.getDisplayList(),t,r=0,i=e.length;r<i&&!(t=e[r].states.emphasis);)r++;return t&&t.hoverLayer}function Zk(n,e,t,r){SZ(t)||t.dispatchAction({type:"highlight",seriesName:n,name:e,excludeSeriesId:r})}function Qk(n,e,t,r){SZ(t)||t.dispatchAction({type:"downplay",seriesName:n,name:e,excludeSeriesId:r})}const TZ=WFe;function qFe(n){var e=n.findComponents({mainType:"legend"});e&&e.length&&n.filterSeries(function(t){for(var r=0;r<e.length;r++)if(!e[r].isSelected(t.name))return!1;return!0})}function ay(n,e,t){var r={},i=n==="toggleSelected",a;return t.eachComponent("legend",function(s){i&&a!=null?s[a?"select":"unSelect"](e.name):n==="allSelect"||n==="inverseSelect"?s[n]():(s[n](e.name),a=s.isSelected(e.name));var o=s.getData();ce(o,function(l){var u=l.get("name");if(!(u===`
`||u==="")){var c=s.isSelected(u);r.hasOwnProperty(u)?r[u]=r[u]&&c:r[u]=c}})}),n==="allSelect"||n==="inverseSelect"?{selected:r}:{name:e.name,selected:r}}function XFe(n){n.registerAction("legendToggleSelect","legendselectchanged",ir(ay,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",ir(ay,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",ir(ay,"inverseSelect")),n.registerAction("legendSelect","legendselected",ir(ay,"select")),n.registerAction("legendUnSelect","legendunselected",ir(ay,"unSelect"))}function CZ(n){n.registerComponentModel(Kk),n.registerComponentView(TZ),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,qFe),n.registerSubTypeDefaulter("legend",function(){return"plain"}),XFe(n)}var KFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(t,r,i){var a=NT(t);n.prototype.init.call(this,t,r,i),Y6(this,t,a)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),Y6(this,this.option,t)},e.type="legend.scroll",e.defaultOption=vX(Kk.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(Kk);function Y6(n,e,t){var r=n.getOrient(),i=[1,1];i[r.index]=0,cg(e,t,{type:"box",ignoreSize:!!i})}const YFe=KFe;var Z6=yi,lA=["width","height"],uA=["x","y"],ZFe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!0,t._currentIndex=0,t}return e.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new Z6),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new Z6)},e.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(t,r,i,a,s,o,l){var u=this;n.prototype.renderInner.call(this,t,r,i,a,s,o,l);var c=this._controllerGroup,f=r.get("pageIconSize",!0),h=Rt(f)?f:[f,f];p("pagePrev",0);var d=r.getModel("pageTextStyle");c.add(new Pi({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),p("pageNext",1);function p(m,g){var v=m+"DataIndex",_=CT(r.get("pageIcons",!0)[r.getOrient().name][g],{onclick:Rr(u._pageGo,u,v,r,a)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});_.name=m,c.add(_)}},e.prototype.layoutInner=function(t,r,i,a,s,o){var l=this.getSelectorGroup(),u=t.getOrient().index,c=lA[u],f=uA[u],h=lA[1-u],d=uA[1-u];s&&Om("horizontal",l,t.get("selectorItemGap",!0));var p=t.get("selectorButtonGap",!0),m=l.getBoundingRect(),g=[-m.x,-m.y],v=wn(i);s&&(v[c]=i[c]-m[c]-p);var _=this._layoutContentAndController(t,a,v,u,c,h,d,f);if(s){if(o==="end")g[u]+=_[c]+p;else{var x=m[c]+p;g[u]-=x,_[f]-=x}_[c]+=m[c]+p,g[1-u]+=_[d]+_[h]/2-m[h]/2,_[h]=Math.max(_[h],m[h]),_[d]=Math.min(_[d],m[d]+g[1-u]),l.x=g[0],l.y=g[1],l.markRedraw()}return _},e.prototype._layoutContentAndController=function(t,r,i,a,s,o,l,u){var c=this.getContentGroup(),f=this._containerGroup,h=this._controllerGroup;Om(t.get("orient"),c,t.get("itemGap"),a?i.width:null,a?null:i.height),Om("horizontal",h,t.get("pageButtonItemGap",!0));var d=c.getBoundingRect(),p=h.getBoundingRect(),m=this._showController=d[s]>i[s],g=[-d.x,-d.y];r||(g[a]=c[u]);var v=[0,0],_=[-p.x,-p.y],x=Hn(t.get("pageButtonGap",!0),t.get("itemGap",!0));if(m){var b=t.get("pageButtonPosition",!0);b==="end"?_[a]+=i[s]-p[s]:v[a]+=p[s]+x}_[1-a]+=d[o]/2-p[o]/2,c.setPosition(g),f.setPosition(v),h.setPosition(_);var S={x:0,y:0};if(S[s]=m?i[s]:d[s],S[o]=Math.max(d[o],p[o]),S[l]=Math.min(0,p[l]+_[1-a]),f.__rectSize=i[s],m){var T={x:0,y:0};T[s]=Math.max(i[s]-p[s]-x,0),T[o]=S[o],f.setClipPath(new oi({shape:T})),f.__rectSize=T[s]}else h.eachChild(function(C){C.attr({invisible:!0,silent:!0})});var M=this._getPageInfo(t);return M.pageIndex!=null&&Ui(c,{x:M.contentPosition[0],y:M.contentPosition[1]},m?t:null),this._updatePageInfoView(t,M),S},e.prototype._pageGo=function(t,r,i){var a=this._getPageInfo(r)[t];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:r.id})},e.prototype._updatePageInfoView=function(t,r){var i=this._controllerGroup;ce(["pagePrev","pageNext"],function(c){var f=c+"DataIndex",h=r[f]!=null,d=i.childOfName(c);d&&(d.setStyle("fill",h?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),d.cursor=h?"pointer":"default")});var a=i.childOfName("pageText"),s=t.get("pageFormatter"),o=r.pageIndex,l=o!=null?o+1:0,u=r.pageCount;a&&s&&a.setStyle("text",jt(s)?s.replace("{current}",l==null?"":l+"").replace("{total}",u==null?"":u+""):s({current:l,total:u}))},e.prototype._getPageInfo=function(t){var r=t.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,s=t.getOrient().index,o=lA[s],l=uA[s],u=this._findTargetItemIndex(r),c=i.children(),f=c[u],h=c.length,d=h?1:0,p={contentPosition:[i.x,i.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!f)return p;var m=b(f);p.contentPosition[s]=-m.s;for(var g=u+1,v=m,_=m,x=null;g<=h;++g)x=b(c[g]),(!x&&_.e>v.s+a||x&&!S(x,v.s))&&(_.i>v.i?v=_:v=x,v&&(p.pageNextDataIndex==null&&(p.pageNextDataIndex=v.i),++p.pageCount)),_=x;for(var g=u-1,v=m,_=m,x=null;g>=-1;--g)x=b(c[g]),(!x||!S(_,x.s))&&v.i<_.i&&(_=v,p.pagePrevDataIndex==null&&(p.pagePrevDataIndex=v.i),++p.pageCount,++p.pageIndex),v=x;return p;function b(T){if(T){var M=T.getBoundingRect(),C=M[l]+T[l];return{s:C,e:C+M[o],i:T.__legendDataIndex}}}function S(T,M){return T.e>=M&&T.s<=M+a}},e.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var r,i=this.getContentGroup(),a;return i.eachChild(function(s,o){var l=s.__legendDataIndex;a==null&&l!=null&&(a=o),l===t&&(r=o)}),r??a},e.type="legend.scroll",e}(TZ);const QFe=ZFe;function JFe(n){n.registerAction("legendScroll","legendscroll",function(e,t){var r=e.scrollDataIndex;r!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(i){i.setScrollDataIndex(r)})})}function eBe(n){Yu(CZ),n.registerComponentModel(YFe),n.registerComponentView(QFe),JFe(n)}function pit(n){Yu(CZ),Yu(eBe)}var Q6={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},tBe=function(){function n(e){var t=this._condVal=jt(e)?new RegExp(e):W2e(e)?e:null;if(t==null){var r="";Qn(r)}}return n.prototype.evaluate=function(e){var t=typeof e;return jt(t)?this._condVal.test(e):gr(t)?this._condVal.test(e+""):!1},n}(),nBe=function(){function n(){}return n.prototype.evaluate=function(){return this.value},n}(),rBe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(!e[t].evaluate())return!1;return!0},n}(),iBe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(e[t].evaluate())return!0;return!1},n}(),aBe=function(){function n(){}return n.prototype.evaluate=function(){return!this.child.evaluate()},n}(),sBe=function(){function n(){}return n.prototype.evaluate=function(){for(var e=!!this.valueParser,t=this.getValue,r=t(this.valueGetterParam),i=e?this.valueParser(r):null,a=0;a<this.subCondList.length;a++)if(!this.subCondList[a].evaluate(e?i:r))return!1;return!0},n}();function ND(n,e){if(n===!0||n===!1){var t=new nBe;return t.value=n,t}var r="";return EZ(n)||Qn(r),n.and?J6("and",n,e):n.or?J6("or",n,e):n.not?oBe(n,e):lBe(n,e)}function J6(n,e,t){var r=e[n],i="";Rt(r)||Qn(i),r.length||Qn(i);var a=n==="and"?new rBe:new iBe;return a.children=Nt(r,function(s){return ND(s,t)}),a.children.length||Qn(i),a}function oBe(n,e){var t=n.not,r="";EZ(t)||Qn(r);var i=new aBe;return i.child=ND(t,e),i.child||Qn(r),i}function lBe(n,e){for(var t="",r=e.prepareGetValue(n),i=[],a=Wr(n),s=n.parser,o=s?XX(s):null,l=0;l<a.length;l++){var u=a[l];if(!(u==="parser"||e.valueGetterAttrMap.get(u))){var c=ju(Q6,u)?Q6[u]:u,f=n[u],h=o?o(f):f,d=xPe(c,h)||c==="reg"&&new tBe(h);d||Qn(t),i.push(d)}}i.length||Qn(t);var p=new sBe;return p.valueGetterParam=r,p.valueParser=o,p.getValue=e.getValue,p.subCondList=i,p}function EZ(n){return Yt(n)&&!Fa(n)}var uBe=function(){function n(e,t){this._cond=ND(e,t)}return n.prototype.evaluate=function(){return this._cond.evaluate()},n}();function cBe(n,e){return new uBe(n,e)}var fBe={type:"echarts:filter",transform:function(n){for(var e=n.upstream,t,r=cBe(n.config,{valueGetterAttrMap:dn({dimension:!0}),prepareGetValue:function(o){var l="",u=o.dimension;ju(o,"dimension")||Qn(l);var c=e.getDimensionInfo(u);return c||Qn(l),{dimIdx:c.index}},getValue:function(o){return e.retrieveValueFromItem(t,o.dimIdx)}}),i=[],a=0,s=e.count();a<s;a++)t=e.getRawDataItem(a),r.evaluate()&&i.push(t);return{data:i}}},hBe={type:"echarts:sort",transform:function(n){var e=n.upstream,t=n.config,r="",i=ci(t);i.length||Qn(r);var a=[];ce(i,function(c){var f=c.dimension,h=c.order,d=c.parser,p=c.incomparable;if(f==null&&Qn(r),h!=="asc"&&h!=="desc"&&Qn(r),p&&p!=="min"&&p!=="max"){var m="";Qn(m)}if(h!=="asc"&&h!=="desc"){var g="";Qn(g)}var v=e.getDimensionInfo(f);v||Qn(r);var _=d?XX(d):null;d&&!_&&Qn(r),a.push({dimIdx:v.index,parser:_,comparator:new YX(h,p)})});var s=e.sourceFormat;s!==Ba&&s!==So&&Qn(r);for(var o=[],l=0,u=e.count();l<u;l++)o.push(e.getRawDataItem(l));return o.sort(function(c,f){for(var h=0;h<a.length;h++){var d=a[h],p=e.retrieveValueFromItem(c,d.dimIdx),m=e.retrieveValueFromItem(f,d.dimIdx);d.parser&&(p=d.parser(p),m=d.parser(m));var g=d.comparator.evaluate(p,m);if(g!==0)return g}return 0}),{data:o}}};function mit(n){n.registerTransform(fBe),n.registerTransform(hBe)}var dBe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.prototype.init=function(t,r,i){n.prototype.init.call(this,t,r,i),this._sourceManager=new eK(this),Fz(this)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),Fz(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:Bl},e}(Sr),pBe=function(n){ht(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.type="dataset",e}(Ps);function git(n){n.registerComponentModel(dBe),n.registerComponentView(pBe)}var Cl=Xu.CMD;function gm(n,e){return Math.abs(n-e)<1e-5}function Jk(n){var e=n.data,t=n.len(),r=[],i,a=0,s=0,o=0,l=0;function u(L,F){i&&i.length>2&&r.push(i),i=[L,F]}function c(L,F,O,B){gm(L,O)&&gm(F,B)||i.push(L,F,O,B,O,B)}function f(L,F,O,B,H,j){var K=Math.abs(F-L),J=Math.tan(K/4)*4/3,re=F<L?-1:1,se=Math.cos(L),Ae=Math.sin(L),Ee=Math.cos(F),Ne=Math.sin(F),we=se*H+O,me=Ae*j+B,Se=Ee*H+O,Me=Ne*j+B,ke=H*J*re,He=j*J*re;i.push(we-ke*Ae,me+He*se,Se+ke*Ne,Me-He*Ee,Se,Me)}for(var h,d,p,m,g=0;g<t;){var v=e[g++],_=g===1;switch(_&&(a=e[g],s=e[g+1],o=a,l=s,(v===Cl.L||v===Cl.C||v===Cl.Q)&&(i=[o,l])),v){case Cl.M:a=o=e[g++],s=l=e[g++],u(o,l);break;case Cl.L:h=e[g++],d=e[g++],c(a,s,h,d),a=h,s=d;break;case Cl.C:i.push(e[g++],e[g++],e[g++],e[g++],a=e[g++],s=e[g++]);break;case Cl.Q:h=e[g++],d=e[g++],p=e[g++],m=e[g++],i.push(a+2/3*(h-a),s+2/3*(d-s),p+2/3*(h-p),m+2/3*(d-m),p,m),a=p,s=m;break;case Cl.A:var x=e[g++],b=e[g++],S=e[g++],T=e[g++],M=e[g++],C=e[g++]+M;g+=1;var k=!e[g++];h=Math.cos(M)*S+x,d=Math.sin(M)*T+b,_?(o=h,l=d,u(o,l)):c(a,s,h,d),a=Math.cos(C)*S+x,s=Math.sin(C)*T+b;for(var R=(k?-1:1)*Math.PI/2,P=M;k?P>C:P<C;P+=R){var N=k?Math.max(P+R,C):Math.min(P+R,C);f(P,N,x,b,S,T)}break;case Cl.R:o=a=e[g++],l=s=e[g++],h=o+e[g++],d=l+e[g++],u(h,l),c(h,l,h,d),c(h,d,o,d),c(o,d,o,l),c(o,l,h,l);break;case Cl.Z:i&&c(a,s,o,l),a=o,s=l;break}}return i&&i.length>2&&r.push(i),r}function eR(n,e,t,r,i,a,s,o,l,u){if(gm(n,t)&&gm(e,r)&&gm(i,s)&&gm(a,o)){l.push(s,o);return}var c=2/u,f=c*c,h=s-n,d=o-e,p=Math.sqrt(h*h+d*d);h/=p,d/=p;var m=t-n,g=r-e,v=i-s,_=a-o,x=m*m+g*g,b=v*v+_*_;if(x<f&&b<f){l.push(s,o);return}var S=h*m+d*g,T=-h*v-d*_,M=x-S*S,C=b-T*T;if(M<f&&S>=0&&C<f&&T>=0){l.push(s,o);return}var k=[],R=[];pf(n,t,i,s,.5,k),pf(e,r,a,o,.5,R),eR(k[0],R[0],k[1],R[1],k[2],R[2],k[3],R[3],l,u),eR(k[4],R[4],k[5],R[5],k[6],R[6],k[7],R[7],l,u)}function mBe(n,e){var t=Jk(n),r=[];e=e||1;for(var i=0;i<t.length;i++){var a=t[i],s=[],o=a[0],l=a[1];s.push(o,l);for(var u=2;u<a.length;){var c=a[u++],f=a[u++],h=a[u++],d=a[u++],p=a[u++],m=a[u++];eR(o,l,c,f,h,d,p,m,s,e),o=p,l=m}r.push(s)}return r}function AZ(n,e,t){var r=n[e],i=n[1-e],a=Math.abs(r/i),s=Math.ceil(Math.sqrt(a*t)),o=Math.floor(t/s);o===0&&(o=1,s=t);for(var l=[],u=0;u<s;u++)l.push(o);var c=s*o,f=t-c;if(f>0)for(var u=0;u<f;u++)l[u%s]+=1;return l}function eH(n,e,t){for(var r=n.r0,i=n.r,a=n.startAngle,s=n.endAngle,o=Math.abs(s-a),l=o*i,u=i-r,c=l>Math.abs(u),f=AZ([l,u],c?0:1,e),h=(c?o:u)/f.length,d=0;d<f.length;d++)for(var p=(c?u:o)/f[d],m=0;m<f[d];m++){var g={};c?(g.startAngle=a+h*d,g.endAngle=a+h*(d+1),g.r0=r+p*m,g.r=r+p*(m+1)):(g.startAngle=a+p*m,g.endAngle=a+p*(m+1),g.r0=r+h*d,g.r=r+h*(d+1)),g.clockwise=n.clockwise,g.cx=n.cx,g.cy=n.cy,t.push(g)}}function gBe(n,e,t){for(var r=n.width,i=n.height,a=r>i,s=AZ([r,i],a?0:1,e),o=a?"width":"height",l=a?"height":"width",u=a?"x":"y",c=a?"y":"x",f=n[o]/s.length,h=0;h<s.length;h++)for(var d=n[l]/s[h],p=0;p<s[h];p++){var m={};m[u]=h*f,m[c]=p*d,m[o]=f,m[l]=d,m.x+=n.x,m.y+=n.y,t.push(m)}}function tH(n,e,t,r){return n*r-t*e}function vBe(n,e,t,r,i,a,s,o){var l=t-n,u=r-e,c=s-i,f=o-a,h=tH(c,f,l,u);if(Math.abs(h)<1e-6)return null;var d=n-i,p=e-a,m=tH(d,p,c,f)/h;return m<0||m>1?null:new nn(m*l+n,m*u+e)}function yBe(n,e,t){var r=new nn;nn.sub(r,t,e),r.normalize();var i=new nn;nn.sub(i,n,e);var a=i.dot(r);return a}function Gp(n,e){var t=n[n.length-1];t&&t[0]===e[0]&&t[1]===e[1]||n.push(e)}function _Be(n,e,t){for(var r=n.length,i=[],a=0;a<r;a++){var s=n[a],o=n[(a+1)%r],l=vBe(s[0],s[1],o[0],o[1],e.x,e.y,t.x,t.y);l&&i.push({projPt:yBe(l,e,t),pt:l,idx:a})}if(i.length<2)return[{points:n},{points:n}];i.sort(function(g,v){return g.projPt-v.projPt});var u=i[0],c=i[i.length-1];if(c.idx<u.idx){var f=u;u=c,c=f}for(var h=[u.pt.x,u.pt.y],d=[c.pt.x,c.pt.y],p=[h],m=[d],a=u.idx+1;a<=c.idx;a++)Gp(p,n[a].slice());Gp(p,d),Gp(p,h);for(var a=c.idx+1;a<=u.idx+r;a++)Gp(m,n[a%r].slice());return Gp(m,h),Gp(m,d),[{points:p},{points:m}]}function nH(n){var e=n.points,t=[],r=[];Sq(e,t,r);var i=new Xn(t[0],t[1],r[0]-t[0],r[1]-t[1]),a=i.width,s=i.height,o=i.x,l=i.y,u=new nn,c=new nn;return a>s?(u.x=c.x=o+a/2,u.y=l,c.y=l+s):(u.y=c.y=l+s/2,u.x=o,c.x=o+a),_Be(e,u,c)}function tS(n,e,t,r){if(t===1)r.push(e);else{var i=Math.floor(t/2),a=n(e);tS(n,a[0],i,r),tS(n,a[1],t-i,r)}return r}function xBe(n,e){for(var t=[],r=0;r<e;r++)t.push(NI(n));return t}function bBe(n,e){e.setStyle(n.style),e.z=n.z,e.z2=n.z2,e.zlevel=n.zlevel}function wBe(n){for(var e=[],t=0;t<n.length;)e.push([n[t++],n[t++]]);return e}function SBe(n,e){var t=[],r=n.shape,i;switch(n.type){case"rect":gBe(r,e,t),i=oi;break;case"sector":eH(r,e,t),i=tl;break;case"circle":eH({r0:0,r:r.r,startAngle:0,endAngle:Math.PI*2,cx:r.cx,cy:r.cy},e,t),i=tl;break;default:var a=n.getComputedTransform(),s=a?Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1],a[2]*a[2]+a[3]*a[3])):1,o=Nt(mBe(n.getUpdatedPathProxy(),s),function(v){return wBe(v)}),l=o.length;if(l===0)tS(nH,{points:o[0]},e,t);else if(l===e)for(var u=0;u<l;u++)t.push({points:o[u]});else{var c=0,f=Nt(o,function(v){var _=[],x=[];Sq(v,_,x);var b=(x[1]-_[1])*(x[0]-_[0]);return c+=b,{poly:v,area:b}});f.sort(function(v,_){return _.area-v.area});for(var h=e,u=0;u<l;u++){var d=f[u];if(h<=0)break;var p=u===l-1?h:Math.ceil(d.area/c*e);p<0||(tS(nH,{points:d.poly},p,t),h-=p)}}i=wT;break}if(!i)return xBe(n,e);for(var m=[],u=0;u<t.length;u++){var g=new i;g.setShape(t[u]),bBe(n,g),m.push(g)}return m}function TBe(n,e){var t=n.length,r=e.length;if(t===r)return[n,e];for(var i=[],a=[],s=t<r?n:e,o=Math.min(t,r),l=Math.abs(r-t)/6,u=(o-2)/6,c=Math.ceil(l/u)+1,f=[s[0],s[1]],h=l,d=2;d<o;){var p=s[d-2],m=s[d-1],g=s[d++],v=s[d++],_=s[d++],x=s[d++],b=s[d++],S=s[d++];if(h<=0){f.push(g,v,_,x,b,S);continue}for(var T=Math.min(h,c-1)+1,M=1;M<=T;M++){var C=M/T;pf(p,g,_,b,C,i),pf(m,v,x,S,C,a),p=i[3],m=a[3],f.push(i[1],a[1],i[2],a[2],p,m),g=i[5],v=a[5],_=i[6],x=a[6]}h-=T-1}return s===n?[f,e]:[n,f]}function rH(n,e){for(var t=n.length,r=n[t-2],i=n[t-1],a=[],s=0;s<e.length;)a[s++]=r,a[s++]=i;return a}function CBe(n,e){for(var t,r,i,a=[],s=[],o=0;o<Math.max(n.length,e.length);o++){var l=n[o],u=e[o],c=void 0,f=void 0;l?u?(t=TBe(l,u),c=t[0],f=t[1],r=c,i=f):(f=rH(i||l,l),c=l):(c=rH(r||u,u),f=u),a.push(c),s.push(f)}return[a,s]}function iH(n){for(var e=0,t=0,r=0,i=n.length,a=0,s=i-2;a<i;s=a,a+=2){var o=n[s],l=n[s+1],u=n[a],c=n[a+1],f=o*c-u*l;e+=f,t+=(o+u)*f,r+=(l+c)*f}return e===0?[n[0]||0,n[1]||0]:[t/e/3,r/e/3,e]}function EBe(n,e,t,r){for(var i=(n.length-2)/6,a=1/0,s=0,o=n.length,l=o-2,u=0;u<i;u++){for(var c=u*6,f=0,h=0;h<o;h+=2){var d=h===0?c:(c+h-2)%l+2,p=n[d]-t[0],m=n[d+1]-t[1],g=e[h]-r[0],v=e[h+1]-r[1],_=g-p,x=v-m;f+=_*_+x*x}f<a&&(a=f,s=u)}return s}function ABe(n){for(var e=[],t=n.length,r=0;r<t;r+=2)e[r]=n[t-r-2],e[r+1]=n[t-r-1];return e}function MBe(n,e,t,r){for(var i=[],a,s=0;s<n.length;s++){var o=n[s],l=e[s],u=iH(o),c=iH(l);a==null&&(a=u[2]<0!=c[2]<0);var f=[],h=[],d=0,p=1/0,m=[],g=o.length;a&&(o=ABe(o));for(var v=EBe(o,l,u,c)*6,_=g-2,x=0;x<_;x+=2){var b=(v+x)%_+2;f[x+2]=o[b]-u[0],f[x+3]=o[b+1]-u[1]}if(f[0]=o[v]-u[0],f[1]=o[v+1]-u[1],t>0)for(var S=r/t,T=-r/2;T<=r/2;T+=S){for(var M=Math.sin(T),C=Math.cos(T),k=0,x=0;x<o.length;x+=2){var R=f[x],P=f[x+1],N=l[x]-c[0],L=l[x+1]-c[1],F=N*C-L*M,O=N*M+L*C;m[x]=F,m[x+1]=O;var B=F-R,H=O-P;k+=B*B+H*H}if(k<p){p=k,d=T;for(var j=0;j<m.length;j++)h[j]=m[j]}}else for(var K=0;K<g;K+=2)h[K]=l[K]-c[0],h[K+1]=l[K+1]-c[1];i.push({from:f,to:h,fromCp:u,toCp:c,rotation:-d})}return i}function nS(n){return n.__isCombineMorphing}var MZ="__mOriginal_";function rS(n,e,t){var r=MZ+e,i=n[r]||n[e];n[r]||(n[r]=n[e]);var a=t.replace,s=t.after,o=t.before;n[e]=function(){var l=arguments,u;return o&&o.apply(this,l),a?u=a.apply(this,l):u=i.apply(this,l),s&&s.apply(this,l),u}}function a0(n,e){var t=MZ+e;n[t]&&(n[e]=n[t],n[t]=null)}function aH(n,e){for(var t=0;t<n.length;t++)for(var r=n[t],i=0;i<r.length;){var a=r[i],s=r[i+1];r[i++]=e[0]*a+e[2]*s+e[4],r[i++]=e[1]*a+e[3]*s+e[5]}}function kZ(n,e){var t=n.getUpdatedPathProxy(),r=e.getUpdatedPathProxy(),i=CBe(Jk(t),Jk(r)),a=i[0],s=i[1],o=n.getComputedTransform(),l=e.getComputedTransform();function u(){this.transform=null}o&&aH(a,o),l&&aH(s,l),rS(e,"updateTransform",{replace:u}),e.transform=null;var c=MBe(a,s,10,Math.PI),f=[];rS(e,"buildPath",{replace:function(h){for(var d=e.__morphT,p=1-d,m=[],g=0;g<c.length;g++){var v=c[g],_=v.from,x=v.to,b=v.rotation*d,S=v.fromCp,T=v.toCp,M=Math.sin(b),C=Math.cos(b);V1(m,S,T,d);for(var k=0;k<_.length;k+=2){var R=_[k],P=_[k+1],N=x[k],L=x[k+1],F=R*p+N*d,O=P*p+L*d;f[k]=F*C-O*M+m[0],f[k+1]=F*M+O*C+m[1]}var B=f[0],H=f[1];h.moveTo(B,H);for(var k=2;k<_.length;){var N=f[k++],L=f[k++],j=f[k++],K=f[k++],J=f[k++],re=f[k++];B===N&&H===L&&j===J&&K===re?h.lineTo(J,re):h.bezierCurveTo(N,L,j,K,J,re),B=J,H=re}}}})}function OD(n,e,t){if(!n||!e)return e;var r=t.done,i=t.during;kZ(n,e),e.__morphT=0;function a(){a0(e,"buildPath"),a0(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape()}return e.animateTo({__morphT:1},ln({during:function(s){e.dirtyShape(),i&&i(s)},done:function(){a(),r&&r()}},t)),e}function kBe(n,e,t,r,i,a){var s=16;n=i===t?0:Math.round(32767*(n-t)/(i-t)),e=a===r?0:Math.round(32767*(e-r)/(a-r));for(var o=0,l,u=(1<<s)/2;u>0;u/=2){var c=0,f=0;(n&u)>0&&(c=1),(e&u)>0&&(f=1),o+=u*u*(3*c^f),f===0&&(c===1&&(n=u-1-n,e=u-1-e),l=n,n=e,e=l)}return o}function iS(n){var e=1/0,t=1/0,r=-1/0,i=-1/0,a=Nt(n,function(o){var l=o.getBoundingRect(),u=o.getComputedTransform(),c=l.x+l.width/2+(u?u[4]:0),f=l.y+l.height/2+(u?u[5]:0);return e=Math.min(c,e),t=Math.min(f,t),r=Math.max(c,r),i=Math.max(f,i),[c,f]}),s=Nt(a,function(o,l){return{cp:o,z:kBe(o[0],o[1],e,t,r,i),path:n[l]}});return s.sort(function(o,l){return o.z-l.z}).map(function(o){return o.path})}function RZ(n){return SBe(n.path,n.count)}function tR(){return{fromIndividuals:[],toIndividuals:[],count:0}}function RBe(n,e,t){var r=[];function i(S){for(var T=0;T<S.length;T++){var M=S[T];nS(M)?i(M.childrenRef()):M instanceof Wn&&r.push(M)}}i(n);var a=r.length;if(!a)return tR();var s=t.dividePath||RZ,o=s({path:e,count:a});if(o.length!==a)return console.error("Invalid morphing: unmatched splitted path"),tR();r=iS(r),o=iS(o);for(var l=t.done,u=t.during,c=t.individualDelay,f=new A_,h=0;h<a;h++){var d=r[h],p=o[h];p.parent=e,p.copyTransform(f),c||kZ(d,p)}e.__isCombineMorphing=!0,e.childrenRef=function(){return o};function m(S){for(var T=0;T<o.length;T++)o[T].addSelfToZr(S)}rS(e,"addSelfToZr",{after:function(S){m(S)}}),rS(e,"removeSelfFromZr",{after:function(S){for(var T=0;T<o.length;T++)o[T].removeSelfFromZr(S)}});function g(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,a0(e,"addSelfToZr"),a0(e,"removeSelfFromZr")}var v=o.length;if(c)for(var _=v,x=function(){_--,_===0&&(g(),l&&l())},h=0;h<v;h++){var b=c?ln({delay:(t.delay||0)+c(h,v,r[h],o[h]),done:x},t):t;OD(r[h],o[h],b)}else e.__morphT=0,e.animateTo({__morphT:1},ln({during:function(S){for(var T=0;T<v;T++){var M=o[T];M.__morphT=e.__morphT,M.dirtyShape()}u&&u(S)},done:function(){g();for(var S=0;S<n.length;S++)a0(n[S],"updateTransform");l&&l()}},t));return e.__zr&&m(e.__zr),{fromIndividuals:r,toIndividuals:o,count:v}}function PBe(n,e,t){var r=e.length,i=[],a=t.dividePath||RZ;function s(d){for(var p=0;p<d.length;p++){var m=d[p];nS(m)?s(m.childrenRef()):m instanceof Wn&&i.push(m)}}if(nS(n)){s(n.childrenRef());var o=i.length;if(o<r)for(var l=0,u=o;u<r;u++)i.push(NI(i[l++%o]));i.length=r}else{i=a({path:n,count:r});for(var c=n.getComputedTransform(),u=0;u<i.length;u++)i[u].setLocalTransform(c);if(i.length!==r)return console.error("Invalid morphing: unmatched splitted path"),tR()}i=iS(i),e=iS(e);for(var f=t.individualDelay,u=0;u<r;u++){var h=f?ln({delay:(t.delay||0)+f(u,r,i[u],e[u])},t):t;OD(i[u],e[u],h)}return{fromIndividuals:i,toIndividuals:e,count:e.length}}function sH(n){return Rt(n[0])}function oH(n,e){for(var t=[],r=n.length,i=0;i<r;i++)t.push({one:n[i],many:[]});for(var i=0;i<e.length;i++){var a=e[i].length,s=void 0;for(s=0;s<a;s++)t[s%r].many.push(e[i][s])}for(var o=0,i=r-1;i>=0;i--)if(!t[i].many.length){var l=t[o].many;if(l.length<=1)if(o)o=0;else return t;var a=l.length,u=Math.ceil(a/2);t[i].many=l.slice(u,a),t[o].many=l.slice(0,u),o++}return t}var IBe={clone:function(n){for(var e=[],t=1-Math.pow(1-n.path.style.opacity,1/n.count),r=0;r<n.count;r++){var i=NI(n.path);i.setStyle("opacity",t),e.push(i)}return e},split:null};function cA(n,e,t,r,i,a){if(!n.length||!e.length)return;var s=ST("update",r,i);if(!(s&&s.duration>0))return;var o=r.getModel("universalTransition").get("delay"),l=Object.assign({setToFinal:!0},s),u,c;sH(n)&&(u=n,c=e),sH(e)&&(u=e,c=n);function f(v,_,x,b,S){var T=v.many,M=v.one;if(T.length===1&&!S){var C=_?T[0]:M,k=_?M:T[0];if(nS(C))f({many:[C],one:k},!0,x,b,!0);else{var R=o?ln({delay:o(x,b)},l):l;OD(C,k,R),a(C,k,C,k,R)}}else for(var P=ln({dividePath:IBe[t],individualDelay:o&&function(H,j,K,J){return o(H+x,b)}},l),N=_?RBe(T,M,P):PBe(M,T,P),L=N.fromIndividuals,F=N.toIndividuals,O=L.length,B=0;B<O;B++){var R=o?ln({delay:o(B,O)},l):l;a(L[B],F[B],_?T[B]:v.one,_?v.one:T[B],R)}}for(var h=u?u===n:n.length>e.length,d=u?oH(c,u):oH(h?e:n,[h?n:e]),p=0,m=0;m<d.length;m++)p+=d[m].many.length;for(var g=0,m=0;m<d.length;m++)f(d[m],h,g,p),g+=d[m].many.length}function Ah(n){if(!n)return[];if(Rt(n)){for(var e=[],t=0;t<n.length;t++)e.push(Ah(n[t]));return e}var r=[];return n.traverse(function(i){i instanceof Wn&&!i.disableMorphing&&!i.invisible&&!i.ignore&&r.push(i)}),r}var PZ=1e4,DBe=qr();function LBe(n){for(var e=n.dimensions,t=0;t<e.length;t++){var r=n.getDimensionInfo(e[t]);if(r&&r.otherDims.itemGroupId===0)return e[t]}}function lH(n){var e=[];return ce(n,function(t){var r=t.data;if(!(r.count()>PZ))for(var i=r.getIndices(),a=LBe(r),s=0;s<i.length;s++)e.push({dataGroupId:t.dataGroupId,data:r,dim:t.dim||a,divide:t.divide,dataIndex:s})}),e}function fA(n,e,t){n.traverse(function(r){r instanceof Wn&&_a(r,{style:{opacity:0}},e,{dataIndex:t,isFrom:!0})})}function hA(n){if(n.parent){var e=n.getComputedTransform();n.setLocalTransform(e),n.parent.remove(n)}}function jp(n){n.stopAnimation(),n.isGroup&&n.traverse(function(e){e.stopAnimation()})}function NBe(n,e,t){var r=ST("update",t,e);r&&n.traverse(function(i){if(i instanceof Wg){var a=Vke(i);a&&i.animateFrom({style:a},r)}})}function OBe(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++){var i=n[r],a=e[r];if(i.data.getId(i.dataIndex)!==a.data.getId(a.dataIndex))return!1}return!0}function IZ(n,e,t){var r=lH(n),i=lH(e);function a(v,_,x,b,S){(x||v)&&_.animateFrom({style:x&&x!==v?gt(gt({},x.style),v.style):v.style},S)}function s(v){for(var _=0;_<v.length;_++)if(v[_].dim)return v[_].dim}var o=s(r),l=s(i),u=!1;function c(v,_){return function(x){var b=x.data,S=x.dataIndex;if(_)return b.getId(S);var T=x.dataGroupId,M=v?o||l:l||o,C=M&&b.getDimensionInfo(M),k=C&&C.ordinalMeta;if(C){var R=b.get(C.name,S);return k&&k.categories[R]||R+""}var P=b.getRawDataItem(S);return P&&P.groupId?P.groupId+"":T||b.getId(S)}}var f=OBe(r,i),h={};if(!f)for(var d=0;d<i.length;d++){var p=i[d],m=p.data.getItemGraphicEl(p.dataIndex);m&&(h[m.id]=!0)}function g(v,_){var x=r[_],b=i[v],S=b.data.hostModel,T=x.data.getItemGraphicEl(x.dataIndex),M=b.data.getItemGraphicEl(b.dataIndex);if(T===M){M&&NBe(M,b.dataIndex,S);return}T&&h[T.id]||M&&(jp(M),T?(jp(T),hA(T),u=!0,cA(Ah(T),Ah(M),b.divide,S,v,a)):fA(M,S,v))}new Y0(r,i,c(!0,f),c(!1,f),null,"multiple").update(g).updateManyToOne(function(v,_){var x=i[v],b=x.data,S=b.hostModel,T=b.getItemGraphicEl(x.dataIndex),M=si(Nt(_,function(C){return r[C].data.getItemGraphicEl(r[C].dataIndex)}),function(C){return C&&C!==T&&!h[C.id]});T&&(jp(T),M.length?(ce(M,function(C){jp(C),hA(C)}),u=!0,cA(Ah(M),Ah(T),x.divide,S,v,a)):fA(T,S,x.dataIndex))}).updateOneToMany(function(v,_){var x=r[_],b=x.data.getItemGraphicEl(x.dataIndex);if(!(b&&h[b.id])){var S=si(Nt(v,function(M){return i[M].data.getItemGraphicEl(i[M].dataIndex)}),function(M){return M&&M!==b}),T=i[v[0]].data.hostModel;S.length&&(ce(S,function(M){return jp(M)}),b?(jp(b),hA(b),u=!0,cA(Ah(b),Ah(S),x.divide,T,v[0],a)):ce(S,function(M){return fA(M,T,v[0])}))}}).updateManyToMany(function(v,_){new Y0(_,v,function(x){return r[x].data.getId(r[x].dataIndex)},function(x){return i[x].data.getId(i[x].dataIndex)}).update(function(x,b){g(v[x],_[b])}).execute()}).execute(),u&&ce(e,function(v){var _=v.data,x=_.hostModel,b=x&&t.getViewOfSeriesModel(x),S=ST("update",x,0);b&&x.isAnimationEnabled()&&S&&S.duration>0&&b.group.traverse(function(T){T instanceof Wn&&!T.animators.length&&T.animateFrom({style:{opacity:0}},S)})})}function uH(n){var e=n.getModel("universalTransition").get("seriesKey");return e||n.id}function cH(n){return Rt(n)?n.sort().join(","):n}function zc(n){if(n.hostModel)return n.hostModel.getModel("universalTransition").get("divideShape")}function $Be(n,e){var t=dn(),r=dn(),i=dn();return ce(n.oldSeries,function(a,s){var o=n.oldDataGroupIds[s],l=n.oldData[s],u=uH(a),c=cH(u);r.set(c,{dataGroupId:o,data:l}),Rt(u)&&ce(u,function(f){i.set(f,{key:c,dataGroupId:o,data:l})})}),ce(e.updatedSeries,function(a){if(a.isUniversalTransitionEnabled()&&a.isAnimationEnabled()){var s=a.get("dataGroupId"),o=a.getData(),l=uH(a),u=cH(l),c=r.get(u);if(c)t.set(u,{oldSeries:[{dataGroupId:c.dataGroupId,divide:zc(c.data),data:c.data}],newSeries:[{dataGroupId:s,divide:zc(o),data:o}]});else if(Rt(l)){var f=[];ce(l,function(p){var m=r.get(p);m.data&&f.push({dataGroupId:m.dataGroupId,divide:zc(m.data),data:m.data})}),f.length&&t.set(u,{oldSeries:f,newSeries:[{dataGroupId:s,data:o,divide:zc(o)}]})}else{var h=i.get(l);if(h){var d=t.get(h.key);d||(d={oldSeries:[{dataGroupId:h.dataGroupId,data:h.data,divide:zc(h.data)}],newSeries:[]},t.set(h.key,d)),d.newSeries.push({dataGroupId:s,data:o,divide:zc(o)})}}}}),t}function fH(n,e){for(var t=0;t<n.length;t++){var r=e.seriesIndex!=null&&e.seriesIndex===n[t].seriesIndex||e.seriesId!=null&&e.seriesId===n[t].id;if(r)return t}}function FBe(n,e,t,r){var i=[],a=[];ce(ci(n.from),function(s){var o=fH(e.oldSeries,s);o>=0&&i.push({dataGroupId:e.oldDataGroupIds[o],data:e.oldData[o],divide:zc(e.oldData[o]),dim:s.dimension})}),ce(ci(n.to),function(s){var o=fH(t.updatedSeries,s);if(o>=0){var l=t.updatedSeries[o].getData();a.push({dataGroupId:e.oldDataGroupIds[o],data:l,divide:zc(l),dim:s.dimension})}}),i.length>0&&a.length>0&&IZ(i,a,r)}function vit(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){ce(ci(r.seriesTransition),function(i){ce(ci(i.to),function(a){for(var s=r.updatedSeries,o=0;o<s.length;o++)(a.seriesIndex!=null&&a.seriesIndex===s[o].seriesIndex||a.seriesId!=null&&a.seriesId===s[o].id)&&(s[o][tw]=!0)})})}),n.registerUpdateLifecycle("series:transition",function(e,t,r){var i=DBe(t);if(i.oldSeries&&r.updatedSeries&&r.optionChanged){var a=r.seriesTransition;if(a)ce(ci(a),function(d){FBe(d,i,r,t)});else{var s=$Be(i,r);ce(s.keys(),function(d){var p=s.get(d);IZ(p.oldSeries,p.newSeries,t)})}ce(r.updatedSeries,function(d){d[tw]&&(d[tw]=!1)})}for(var o=e.getSeries(),l=i.oldSeries=[],u=i.oldDataGroupIds=[],c=i.oldData=[],f=0;f<o.length;f++){var h=o[f].getData();h.count()<PZ&&(l.push(o[f]),u.push(o[f].get("dataGroupId")),c.push(h))}})}function hH(n,e,t){var r=zg.createCanvas(),i=e.getWidth(),a=e.getHeight(),s=r.style;return s&&(s.position="absolute",s.left="0",s.top="0",s.width=i+"px",s.height=a+"px",r.setAttribute("data-zr-dom-id",n)),r.width=i*t,r.height=a*t,r}var BBe=function(n){ht(e,n);function e(t,r,i){var a=n.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var s;i=i||Iw,typeof t=="string"?s=hH(t,r,i):Yt(t)&&(s=t,t=s.id),a.id=t,a.dom=s;var o=s.style;return o&&(N7(s),s.onselectstart=function(){return!1},o.padding="0",o.margin="0",o.borderWidth="0"),a.painter=r,a.dpr=i,a}return e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var t=this.dpr;this.domBack=hH("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),t!==1&&this.ctxBack.scale(t,t)},e.prototype.createRepaintRects=function(t,r,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var s=[],o=this.maxRepaintRectCount,l=!1,u=new Xn(0,0,0,0);function c(_){if(!(!_.isFinite()||_.isZero()))if(s.length===0){var x=new Xn(0,0,0,0);x.copy(_),s.push(x)}else{for(var b=!1,S=1/0,T=0,M=0;M<s.length;++M){var C=s[M];if(C.intersect(_)){var k=new Xn(0,0,0,0);k.copy(C),k.union(_),s[M]=k,b=!0;break}else if(l){u.copy(_),u.union(C);var R=_.width*_.height,P=C.width*C.height,N=u.width*u.height,L=N-R-P;L<S&&(S=L,T=M)}}if(l&&(s[T].union(_),b=!0),!b){var x=new Xn(0,0,0,0);x.copy(_),s.push(x)}l||(l=s.length>=o)}}for(var f=this.__startIndex;f<this.__endIndex;++f){var h=t[f];if(h){var d=h.shouldBePainted(i,a,!0,!0),p=h.__isRendered&&(h.__dirty&Ts||!d)?h.getPrevPaintRect():null;p&&c(p);var m=d&&(h.__dirty&Ts||!h.__isRendered)?h.getPaintRect():null;m&&c(m)}}for(var f=this.__prevStartIndex;f<this.__prevEndIndex;++f){var h=r[f],d=h.shouldBePainted(i,a,!0,!0);if(h&&(!d||!h.__zr)&&h.__isRendered){var p=h.getPrevPaintRect();p&&c(p)}}var g;do{g=!1;for(var f=0;f<s.length;){if(s[f].isZero()){s.splice(f,1);continue}for(var v=f+1;v<s.length;)s[f].intersect(s[v])?(g=!0,s[f].union(s[v]),s.splice(v,1)):v++;f++}}while(g);return this._paintRects=s,s},e.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},e.prototype.resize=function(t,r){var i=this.dpr,a=this.dom,s=a.style,o=this.domBack;s&&(s.width=t+"px",s.height=r+"px"),a.width=t*i,a.height=r*i,o&&(o.width=t*i,o.height=r*i,i!==1&&this.ctxBack.scale(i,i))},e.prototype.clear=function(t,r,i){var a=this.dom,s=this.ctx,o=a.width,l=a.height;r=r||this.clearColor;var u=this.motionBlur&&!t,c=this.lastFrameAlpha,f=this.dpr,h=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,o/f,l/f));var d=this.domBack;function p(m,g,v,_){if(s.clearRect(m,g,v,_),r&&r!=="transparent"){var x=void 0;if(fT(r)){var b=r.global||r.__width===v&&r.__height===_;x=b&&r.__canvasGradient||Ek(s,r,{x:0,y:0,width:v,height:_}),r.__canvasGradient=x,r.__width=v,r.__height=_}else H2e(r)&&(r.scaleX=r.scaleX||f,r.scaleY=r.scaleY||f,x=Ak(s,r,{dirty:function(){h.setUnpainted(),h.__painter.refresh()}}));s.save(),s.fillStyle=x||r,s.fillRect(m,g,v,_),s.restore()}u&&(s.save(),s.globalAlpha=c,s.drawImage(d,m,g,v,_),s.restore())}!i||u?p(0,0,o,l):i.length&&ce(i,function(m){p(m.x*f,m.y*f,m.width*f,m.height*f)})},e}(ul);const dA=BBe;var dH=1e5,xh=314159,e1=.01,UBe=.001;function zBe(n){return n?n.__builtin__?!0:!(typeof n.resize!="function"||typeof n.refresh!="function"):!1}function VBe(n,e){var t=document.createElement("div");return t.style.cssText=["position:relative","width:"+n+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",t}var HBe=function(){function n(e,t,r,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!e.nodeName||e.nodeName.toUpperCase()==="CANVAS";this._opts=r=gt({},r||{}),this.dpr=r.devicePixelRatio||Iw,this._singleCanvas=a,this.root=e;var s=e.style;s&&(N7(e),e.innerHTML=""),this.storage=t;var o=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(a){var c=e,f=c.width,h=c.height;r.width!=null&&(f=r.width),r.height!=null&&(h=r.height),this.dpr=r.devicePixelRatio||1,c.width=f*this.dpr,c.height=h*this.dpr,this._width=f,this._height=h;var d=new dA(c,this,this.dpr);d.__builtin__=!0,d.initContext(),l[xh]=d,d.zlevel=xh,o.push(xh),this._domRoot=e}else{this._width=Ob(e,0,r),this._height=Ob(e,1,r);var u=this._domRoot=VBe(this._width,this._height);e.appendChild(u)}}return n.prototype.getType=function(){return"canvas"},n.prototype.isSingleCanvas=function(){return this._singleCanvas},n.prototype.getViewportRoot=function(){return this._domRoot},n.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},n.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),r=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,r,e,this._redrawId);for(var a=0;a<i.length;a++){var s=i[a],o=this._layers[s];if(!o.__builtin__&&o.refresh){var l=a===0?this._backgroundColor:null;o.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},n.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},n.prototype._paintHoverList=function(e){var t=e.length,r=this._hoverlayer;if(r&&r.clear(),!!t){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,s=0;s<t;s++){var o=e[s];o.__inHover&&(r||(r=this._hoverlayer=this.getLayer(dH)),a||(a=r.ctx,a.save()),Hh(a,o,i,s===t-1))}a&&a.restore()}},n.prototype.getHoverLayer=function(){return this.getLayer(dH)},n.prototype.paintOne=function(e,t){xK(e,t)},n.prototype._paintList=function(e,t,r,i){if(this._redrawId===i){r=r||!1,this._updateLayerStatus(e);var a=this._doPaintList(e,t,r),s=a.finished,o=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),o&&this._paintHoverList(e),s)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var l=this;jM(function(){l._paintList(e,t,r,i)})}}},n.prototype._compositeManually=function(){var e=this.getLayer(xh).ctx,t=this._domRoot.width,r=this._domRoot.height;e.clearRect(0,0,t,r),this.eachBuiltinLayer(function(i){i.virtual&&e.drawImage(i.dom,0,0,t,r)})},n.prototype._doPaintList=function(e,t,r){for(var i=this,a=[],s=this._opts.useDirtyRect,o=0;o<this._zlevelList.length;o++){var l=this._zlevelList[o],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||r)&&a.push(u)}for(var c=!0,f=!1,h=function(m){var g=a[m],v=g.ctx,_=s&&g.createRepaintRects(e,t,d._width,d._height),x=r?g.__startIndex:g.__drawIndex,b=!r&&g.incremental&&Date.now,S=b&&Date.now(),T=g.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(g.__startIndex===g.__endIndex)g.clear(!1,T,_);else if(x===g.__startIndex){var M=e[x];(!M.incremental||!M.notClear||r)&&g.clear(!1,T,_)}x===-1&&(console.error("For some unknown reason. drawIndex is -1"),x=g.__startIndex);var C,k=function(L){var F={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(C=x;C<g.__endIndex;C++){var O=e[C];if(O.__inHover&&(f=!0),i._doPaintEl(O,g,s,L,F,C===g.__endIndex-1),b){var B=Date.now()-S;if(B>15)break}}F.prevElClipPaths&&v.restore()};if(_)if(_.length===0)C=g.__endIndex;else for(var R=d.dpr,P=0;P<_.length;++P){var N=_[P];v.save(),v.beginPath(),v.rect(N.x*R,N.y*R,N.width*R,N.height*R),v.clip(),k(N),v.restore()}else v.save(),k(),v.restore();g.__drawIndex=C,g.__drawIndex<g.__endIndex&&(c=!1)},d=this,p=0;p<a.length;p++)h(p);return In.wxa&&ce(this._layers,function(m){m&&m.ctx&&m.ctx.draw&&m.ctx.draw()}),{finished:c,needsRefreshHover:f}},n.prototype._doPaintEl=function(e,t,r,i,a,s){var o=t.ctx;if(r){var l=e.getPaintRect();(!i||l&&l.intersect(i))&&(Hh(o,e,a,s),e.setPrevPaintRect(l))}else Hh(o,e,a,s)},n.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=xh);var r=this._layers[e];return r||(r=new dA("zr_"+e,this,this.dpr),r.zlevel=e,r.__builtin__=!0,this._layerConfig[e]?Dn(r,this._layerConfig[e],!0):this._layerConfig[e-e1]&&Dn(r,this._layerConfig[e-e1],!0),t&&(r.virtual=t),this.insertLayer(e,r),r.initContext()),r},n.prototype.insertLayer=function(e,t){var r=this._layers,i=this._zlevelList,a=i.length,s=this._domRoot,o=null,l=-1;if(!r[e]&&zBe(t)){if(a>0&&e>i[0]){for(l=0;l<a-1&&!(i[l]<e&&i[l+1]>e);l++);o=r[i[l]]}if(i.splice(l+1,0,e),r[e]=t,!t.virtual)if(o){var u=o.dom;u.nextSibling?s.insertBefore(t.dom,u.nextSibling):s.appendChild(t.dom)}else s.firstChild?s.insertBefore(t.dom,s.firstChild):s.appendChild(t.dom);t.__painter=this}},n.prototype.eachLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var a=r[i];e.call(t,this._layers[a],a)}},n.prototype.eachBuiltinLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var a=r[i],s=this._layers[a];s.__builtin__&&e.call(t,s,a)}},n.prototype.eachOtherLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var a=r[i],s=this._layers[a];s.__builtin__||e.call(t,s,a)}},n.prototype.getLayers=function(){return this._layers},n.prototype._updateLayerStatus=function(e){this.eachBuiltinLayer(function(f,h){f.__dirty=f.__used=!1});function t(f){a&&(a.__endIndex!==f&&(a.__dirty=!0),a.__endIndex=f)}if(this._singleCanvas)for(var r=1;r<e.length;r++){var i=e[r];if(i.zlevel!==e[r-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,s=0,o,l;for(l=0;l<e.length;l++){var i=e[l],u=i.zlevel,c=void 0;o!==u&&(o=u,s=0),i.incremental?(c=this.getLayer(u+UBe,this._needsManuallyCompositing),c.incremental=!0,s=1):c=this.getLayer(u+(s>0?e1:0),this._needsManuallyCompositing),c.__builtin__||xI("ZLevel "+u+" has been used by unkown layer "+c.id),c!==a&&(c.__used=!0,c.__startIndex!==l&&(c.__dirty=!0),c.__startIndex=l,c.incremental?c.__drawIndex=-1:c.__drawIndex=l,t(l),a=c),i.__dirty&Ts&&!i.__inHover&&(c.__dirty=!0,c.incremental&&c.__drawIndex<0&&(c.__drawIndex=l))}t(l),this.eachBuiltinLayer(function(f,h){!f.__used&&f.getElementCount()>0&&(f.__dirty=!0,f.__startIndex=f.__endIndex=f.__drawIndex=0),f.__dirty&&f.__drawIndex<0&&(f.__drawIndex=f.__startIndex)})},n.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},n.prototype._clearLayer=function(e){e.clear()},n.prototype.setBackgroundColor=function(e){this._backgroundColor=e,ce(this._layers,function(t){t.setUnpainted()})},n.prototype.configLayer=function(e,t){if(t){var r=this._layerConfig;r[e]?Dn(r[e],t,!0):r[e]=t;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===e||a===e+e1){var s=this._layers[a];Dn(s,r[e],!0)}}}},n.prototype.delLayer=function(e){var t=this._layers,r=this._zlevelList,i=t[e];i&&(i.dom.parentNode.removeChild(i.dom),delete t[e],r.splice(Vn(r,e),1))},n.prototype.resize=function(e,t){if(this._domRoot.style){var r=this._domRoot;r.style.display="none";var i=this._opts,a=this.root;if(e!=null&&(i.width=e),t!=null&&(i.height=t),e=Ob(a,0,i),t=Ob(a,1,i),r.style.display="",this._width!==e||t!==this._height){r.style.width=e+"px",r.style.height=t+"px";for(var s in this._layers)this._layers.hasOwnProperty(s)&&this._layers[s].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(e==null||t==null)return;this._width=e,this._height=t,this.getLayer(xh).resize(e,t)}return this},n.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},n.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},n.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[xh].dom;var t=new dA("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var r=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var i=t.dom.width,a=t.dom.height;this.eachLayer(function(f){f.__builtin__?r.drawImage(f.dom,0,0,i,a):f.renderToCanvas&&(r.save(),f.renderToCanvas(r),r.restore())})}else for(var s={inHover:!1,viewWidth:this._width,viewHeight:this._height},o=this.storage.getDisplayList(!0),l=0,u=o.length;l<u;l++){var c=o[l];Hh(r,c,s,l===u-1)}return t.dom},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n}();const WBe=HBe;function yit(n){n.registerPainter("canvas",WBe)}var DZ={exports:{}};/*! GoldPlay built @6/28/2020, 11:46:42 AM */(function(n,e){(function(t,r){n.exports=r()})(window,function(){return function(t){var r={};function i(a){if(r[a])return r[a].exports;var s=r[a]={i:a,l:!1,exports:{}};return t[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=r,i.d=function(a,s,o){i.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:o})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,s){if(1&s&&(a=i(a)),8&s||4&s&&typeof a=="object"&&a&&a.__esModule)return a;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:a}),2&s&&typeof a!="string")for(var l in a)i.d(o,l,function(u){return a[u]}.bind(null,l));return o},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s=162)}([function(t,r){t.exports=function(i,a,s){return a in i?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s,i}},function(t,r){t.exports=function(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}},function(t,r){t.exports=function(i,a){if(!(i instanceof a))throw new TypeError("Cannot call a class as a function")}},function(t,r){function i(a,s){for(var o=0;o<s.length;o++){var l=s[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(a,l.key,l)}}t.exports=function(a,s,o){return s&&i(a.prototype,s),o&&i(a,o),a}},function(t,r){function i(a){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(s){return s.__proto__||Object.getPrototypeOf(s)},i(a)}t.exports=i},function(t,r,i){var a=i(11),s=i(1);t.exports=function(o,l){return!l||a(l)!=="object"&&typeof l!="function"?s(o):l}},function(t,r,i){var a=i(48);t.exports=function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(o&&o.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),o&&a(s,o)}},,function(t,r){t.exports=function(i,a){return a||(a=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(a)}}))}},function(t,r,i){i.d(r,"c",function(){return a}),i.d(r,"b",function(){return s}),i.d(r,"a",function(){return o}),i.d(r,"d",function(){return l});var a={projectName:"GOLDPLAY",projectAbbreviation:"GP",mode:"production",basePath:"./",get distPath(){var u="";return(this.mode=="development"||this.mode=="test")&&(u="/dist/"),u},get libPath(){return this.distPath+"lib/"},hideBarBoxTime:300,speedList:[{name:"0.5X",value:.5},{name:"1.0X",value:1},{name:"1.5X",value:1.5},{name:"2.0X",value:2},{name:"3.0X",value:3}]},s={maxDuration:30,maxSize:1024e6,maxRetryCount:3},o=1/9e4,l={READYBUFFERLENGTH:1e3,MAXBUFFERLENGTH:5e3}},function(t,r,i){var a=i(2),s=i.n(a),o=i(3),l=i.n(o),u=i(0),c=i.n(u),f=i(9),h=console||{};function d(m,g){if(h[m]){if(this.disabled||this.level<0||f.c.mode==="production"&&(m!=="error"||m!=="warn")||this.level===1&&["info"].includes(m)||this.level===2&&["log","info"].includes(m)||this.level>2&&m!=="error")return;for(var v=new Date().toLocaleString(),_=arguments.length,x=new Array(_>2?_-2:0),b=2;b<_;b++)x[b-2]=arguments[b];var S=["\x1B[32m".concat(g,"\x1B[39m")].concat(x,[v]);m!=="error"&&m!=="warn"||(S=[g].concat(x,[v])),typeof h[m]=="function"&&h[m].apply(h,S)}}var p=function(){function m(g){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s()(this,m),c()(this,"prefix",f.c.projectName),c()(this,"joiner",">"),c()(this,"left","["),c()(this,"right","]"),c()(this,"disabled",!1),c()(this,"level",0),Object.assign(this,v),typeof g=="string"?this.file=g:g&&g.constructor&&(this.file=g.constructor.name)}return l()(m,[{key:"setDisabled",value:function(g){this.disabled=g}},{key:"setLevel",value:function(g){this.level=g}}],[{key:"get",value:function(g,v){return new m(g,v)}}]),m}();["info","log","debug","warn","error"].forEach(function(m){p.prototype[m]=function(g,v){v=v===void 0?"":this.joiner+v;for(var _=this.left+g+v+this.right,x=this.left+this.prefix+" "+this.file+this.right+_,b=arguments.length,S=new Array(b>2?b-2:0),T=2;T<b;T++)S[T-2]=arguments[T];d.apply(this,[m,x].concat(S))}}),r.a=p},function(t,r){function i(a){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t.exports=i=function(s){return typeof s}:t.exports=i=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},i(a)}t.exports=i},,,,,,,function(t,r,i){t.exports=i(88)},,,,,function(t,r,i){i.d(r,"a",function(){return p});var a=i(2),s=i.n(a),o=i(3),l=i.n(o),u=i(0),c=i.n(u),f=i(9),h={eval:EvalError,range:RangeError,reference:ReferenceError,syntax:SyntaxError,type:TypeError,uri:URIError,default:Error},d=null,p=(d||(d=new(function(){function m(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"default",v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1001;return s()(this,m),c()(this,"type",""),c()(this,"errorName","DefaultError"),c()(this,"code",null),c()(this,"message",""),c()(this,"stack",""),this.type=g,this.code=v,this.throws.bind(this)}return l()(m,[{key:"throws",value:function(g){for(var v="",_=Error,x=arguments.length,b=new Array(x>1?x-1:0),S=1;S<x;S++)b[S-1]=arguments[S];if(g instanceof Error){for(var T in h)if(g instanceof h[T]){this.errorName=h[T].name,_=g.constructor;break}this.stack=g.stack,b&&b.splice&&(v=b[0],b.splice(0,1))}else v=g.toString();this.message="[".concat(f.c.projectName," ERROR:")+this.type+"-"+this.code+"]"+v;try{throw new _(this.message,"[args]:",b)}catch(M){this.stack=this.stack||M.stack,console.error(M,"[message]:",v,"[args]:",b)}}}]),m}())),d)},function(t,r){t.exports=function(i,a){var s=a.get(i);if(!s)throw new TypeError("attempted to get private field on non-instance");return s.get?s.get.call(i):s.value}},,,function(t,r,i){var a=i(48),s=i(86);function o(l,u,c){return s()?t.exports=o=Reflect.construct:t.exports=o=function(f,h,d){var p=[null];p.push.apply(p,h);var m=new(Function.bind.apply(f,p));return d&&a(m,d.prototype),m},o.apply(null,arguments)}t.exports=o},function(t,r){function i(a,s,o,l,u,c,f){try{var h=a[c](f),d=h.value}catch(p){return void o(p)}h.done?s(d):Promise.resolve(d).then(l,u)}t.exports=function(a){return function(){var s=this,o=arguments;return new Promise(function(l,u){var c=a.apply(s,o);function f(d){i(c,l,u,f,h,"next",d)}function h(d){i(c,l,u,f,h,"throw",d)}f(void 0)})}}},function(t,r){t.exports=function(i,a,s){var o=a.get(i);if(!o)throw new TypeError("attempted to set private field on non-instance");if(o.set)o.set.call(i,s);else{if(!o.writable)throw new TypeError("attempted to set read only private field");o.value=s}return s}},,,,,function(t,r,i){var a=i(4),s=i(48),o=i(87),l=i(27);function u(c){var f=typeof Map=="function"?new Map:void 0;return t.exports=u=function(h){if(h===null||!o(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(f!==void 0){if(f.has(h))return f.get(h);f.set(h,d)}function d(){return l(h,arguments,a(this).constructor)}return d.prototype=Object.create(h.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),s(d,h)},u(c)}t.exports=u},,,,,,,,,,function(t,r,i){function a(c){var f={};function h(p){if(f[p])return f[p].exports;var m=f[p]={i:p,l:!1,exports:{}};return c[p].call(m.exports,m,m.exports,h),m.l=!0,m.exports}h.m=c,h.c=f,h.i=function(p){return p},h.d=function(p,m,g){h.o(p,m)||Object.defineProperty(p,m,{configurable:!1,enumerable:!0,get:g})},h.r=function(p){Object.defineProperty(p,"__esModule",{value:!0})},h.n=function(p){var m=p&&p.__esModule?function(){return p.default}:function(){return p};return h.d(m,"a",m),m},h.o=function(p,m){return Object.prototype.hasOwnProperty.call(p,m)},h.p="/",h.oe=function(p){throw console.error(p),p};var d=h(h.s=ENTRY_MODULE);return d.default||d}var s="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function o(c){return(c+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function l(c,f,h){var d={};d[h]=[];var p=f.toString(),m=p.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!m)return d;for(var g,v=m[1],_=new RegExp("(\\\\n|\\W)"+o(v)+s,"g");g=_.exec(p);)g[3]!=="dll-reference"&&d[h].push(g[3]);for(_=new RegExp("\\("+o(v)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+s,"g");g=_.exec(p);)c[g[2]]||(d[h].push(g[1]),c[g[2]]=i(g[1]).m),d[g[2]]=d[g[2]]||[],d[g[2]].push(g[4]);for(var x,b=Object.keys(d),S=0;S<b.length;S++)for(var T=0;T<d[b[S]].length;T++)x=d[b[S]][T],isNaN(1*x)||(d[b[S]][T]=1*d[b[S]][T]);return d}function u(c){return Object.keys(c).reduce(function(f,h){return f||c[h].length>0},!1)}t.exports=function(c,f){f=f||{};var h={main:i.m},d=f.all?{main:Object.keys(h.main)}:function(_,x){for(var b={main:[x]},S={main:[]},T={main:{}};u(b);)for(var M=Object.keys(b),C=0;C<M.length;C++){var k=M[C],R=b[k].pop();if(T[k]=T[k]||{},!T[k][R]&&_[k][R]){T[k][R]=!0,S[k]=S[k]||[],S[k].push(R);for(var P=l(_,_[k][R],k),N=Object.keys(P),L=0;L<N.length;L++)b[N[L]]=b[N[L]]||[],b[N[L]]=b[N[L]].concat(P[N[L]])}}return S}(h,c),p="";Object.keys(d).filter(function(_){return _!=="main"}).forEach(function(_){for(var x=0;d[_][x];)x++;d[_].push(x),h[_][x]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",p=p+"var "+_+" = ("+a.toString().replace("ENTRY_MODULE",JSON.stringify(x))+")({"+d[_].map(function(b){return JSON.stringify(b)+": "+h[_][b].toString()}).join(",")+`});
`}),p=p+"new (("+a.toString().replace("ENTRY_MODULE",JSON.stringify(c))+")({"+d.main.map(function(_){return JSON.stringify(_)+": "+h.main[_].toString()}).join(",")+"}))(self);";var m=new window.Blob([p],{type:"text/javascript"});if(f.bare)return m;var g=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(m),v=new window.Worker(g);return v.objectURL=g,v}},function(t,r,i){var a,s,o;s=[],(o=typeof(a=function(){var l=function(){},u={},c={},f={};function h(g,v){if(g){var _=f[g];if(c[g]=v,_)for(;_.length;)_[0](g,v),_.splice(0,1)}}function d(g,v){g.call&&(g={success:g}),v.length?(g.error||l)(v):(g.success||l)(g)}function p(g,v,_,x){var b,S,T=document,M=_.async,C=(_.numRetries||0)+1,k=_.before||l,R=g.replace(/[\?|#].*$/,""),P=g.replace(/^(css|img)!/,"");x=x||0,/(^css!|\.css$)/.test(R)?((S=T.createElement("link")).rel="stylesheet",S.href=P,(b="hideFocus"in S)&&S.relList&&(b=0,S.rel="preload",S.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(R)?(S=T.createElement("img")).src=P:((S=T.createElement("script")).src=g,S.async=M===void 0||M),S.onload=S.onerror=S.onbeforeload=function(N){var L=N.type[0];if(b)try{S.sheet.cssText.length||(L="e")}catch(F){F.code!=18&&(L="e")}if(L=="e"){if((x+=1)<C)return p(g,v,_,x)}else if(S.rel=="preload"&&S.as=="style")return S.rel="stylesheet";v(g,L,N.defaultPrevented)},k(g,S)!==!1&&T.head.appendChild(S)}function m(g,v,_){var x,b;if(v&&v.trim&&(x=v),b=(x?_:v)||{},x){if(x in u)throw"LoadJS";u[x]=!0}function S(T,M){(function(C,k,R){var P,N,L=(C=C.push?C:[C]).length,F=L,O=[];for(P=function(B,H,j){if(H=="e"&&O.push(B),H=="b"){if(!j)return;O.push(B)}--L||k(O)},N=0;N<F;N++)p(C[N],P,R)})(g,function(C){d(b,C),T&&d({success:T,error:M},C),h(x,C)},b)}if(b.returnPromise)return new Promise(S);S()}return m.ready=function(g,v){return function(_,x){_=_.push?_:[_];var b,S,T,M=[],C=_.length,k=C;for(b=function(R,P){P.length&&M.push(R),--k||x(M)};C--;)S=_[C],(T=c[S])?b(S,T):(f[S]=f[S]||[]).push(b)}(g,function(_){d(v,_)}),m},m.done=function(g){h(g,[])},m.reset=function(){u={},c={},f={}},m.isDefined=function(g){return g in u},m})=="function"?a.apply(r,s):a)===void 0||(t.exports=o)},,,function(t,r){function i(a,s){return t.exports=i=Object.setPrototypeOf||function(o,l){return o.__proto__=l,o},i(a,s)}t.exports=i},function(t,r){(function(){function i(a,s){throw new Error("abstract")}i.prototype.drawFrame=function(a){throw new Error("abstract")},i.prototype.clear=function(){throw new Error("abstract")},t.exports=i})()},,,,,,,,,,,function(t,r){var i={validateDimension:function(a){if(a<=0||a!==(0|a))throw"YUV plane dimensions must be a positive integer"},validateOffset:function(a){if(a<0||a!==(0|a))throw"YUV plane offsets must be a non-negative integer"},format:function(a){var s=a.width,o=a.height,l=a.chromaWidth||s,u=a.chromaHeight||o,c=a.cropLeft||0,f=a.cropTop||0,h=a.cropWidth||s-c,d=a.cropHeight||o-f,p=a.displayWidth||h,m=a.displayHeight||d;return this.validateDimension(s),this.validateDimension(o),this.validateDimension(l),this.validateDimension(u),this.validateOffset(c),this.validateOffset(f),this.validateDimension(h),this.validateDimension(d),this.validateDimension(p),this.validateDimension(m),{width:s,height:o,chromaWidth:l,chromaHeight:u,cropLeft:c,cropTop:f,cropWidth:h,cropHeight:d,displayWidth:p,displayHeight:m}},allocPlane:function(a,s){return i.validateDimension(a),i.validateDimension(s),{bytes:new Uint8Array(a*s),stride:a}},suitableStride:function(a){i.validateDimension(a);var s=a%4;return s==0?a:a+(4-s)},allocPlane:function(a,s,o,l,u){var c,f;if(this.validateDimension(a),this.validateDimension(s),u=u||0,l=l||this.suitableStride(a),this.validateDimension(l),l<a)throw"Invalid input stride for YUV plane; must be larger than width";if(c=l*s,o){if(o.length-u<c)throw"Invalid input buffer for YUV plane; must be large enough for stride times height";f=o.slice(u,u+c)}else f=new Uint8Array(c),l=l||this.suitableStride(a);return{bytes:f,stride:l}},lumaPlane:function(a,s,o,l){return this.allocPlane(a.width,a.height,s,o,l)},chromaPlane:function(a,s,o,l){return this.allocPlane(a.chromaWidth,a.chromaHeight,s,o,l)},frame:function(a,s,o,l){return{format:a,y:s=s||this.lumaPlane(a),u:o=o||this.chromaPlane(a),v:l=l||this.chromaPlane(a)}},copyPlane:function(a){return{bytes:a.bytes.slice(),stride:a.stride}},copyFrame:function(a){return{format:a.format,y:this.copyPlane(a.y),u:this.copyPlane(a.u),v:this.copyPlane(a.v)}},transferables:function(a){return[a.y.bytes.buffer,a.u.bytes.buffer,a.v.bytes.buffer]}};t.exports=i},function(t,r,i){var a=i(95),s=i(96),o=i(97),l=i(99);t.exports=function(u,c){return a(u)||s(u,c)||o(u,c)||l()}},,,,,,,,,,,function(t,r,i){(function(){var a=i(49),s=i(89),o=i(92),l={FrameSink:a,SoftwareFrameSink:s,WebGLFrameSink:o,attach:function(u,c){return("webGL"in(c=c||{})?c.webGL:o.isAvailable())?new o(u,c):new s(u,c)}};t.exports=l})()},,,,,,,,,,,,,function(t,r,i){i.r(r);var a=i(2),s=i.n(a),o=i(3),l=i.n(o),u=i(5),c=i.n(u),f=i(4),h=i.n(f),d=i(1),p=i.n(d),m=i(6),g=i.n(m),v=i(0),_=i.n(v),x=i(24),b=i.n(x),S=i(29),T=i.n(S),M=i(10),C=M.a.get("Events.js"),k=function(){function $(A){s()(this,$),_()(this,"eventsQueue",{}),_()(this,"target",{}),_()(this,"disallowRepeat",!1),this.target=A}return l()($,[{key:"add",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],y=arguments.length>1?arguments[1]:void 0,w=arguments.length>2?arguments[2]:void 0,I=!0,W=!1,Y=void 0;try{for(var oe,pe=A[Symbol.iterator]();!(I=(oe=pe.next()).done);I=!0){var Oe=oe.value;this.on(Oe,y,w)}}catch(et){W=!0,Y=et}finally{try{I||pe.return==null||pe.return()}finally{if(W)throw Y}}}},{key:"on",value:function(A,y,w){if(this.eventsQueue[A]===void 0&&(this.eventsQueue[A]={methods:[],once:!1}),typeof y=="function"){if(!this.disallowRepeat||!this.eventsQueue[A].methods.includes(y))return this.eventsQueue[A].methods.push(y),w!==void 0&&(this.eventsQueue[A].once=w),this.target}else C.error("on","the argument is not function.",y)}},{key:"once",value:function(A,y){this.on(A,y,!0)}},{key:"off",value:function(A,y){var w=this.eventsQueue[A];if(w){var I=w.methods;if(y)for(var W=I.length;W--;)I[W]===y&&I.splice(W,1);else delete this.eventsQueue[A];return this.target}}},{key:"emit",value:function(A){for(var y=this,w=arguments.length,I=new Array(w>1?w-1:0),W=1;W<w;W++)I[W-1]=arguments[W];var Y=this.eventsQueue[A];if(Y){var oe=Y.methods;return oe.forEach(function(pe){pe.apply(y.target,I)}),Y.once&&this.off(A),this.target}}},{key:"clear",value:function(A){delete this.eventsQueue[A]}},{key:"clearAll",value:function(){this.eventsQueue={}}}]),$}(),R=function($){var A=new k($);return function(y){return A.target=y,A}},P=i(11),N=i.n(P),L=M.a.get("Element.js"),F=function(){function $(){s()(this,$)}return l()($,null,[{key:"createEl",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"div",y=arguments.length>1?arguments[1]:void 0;if(typeof A!="string")return L.error("please input element name"),null;var w=document.createElement(A,y);return w}},{key:"registerElement",value:function(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:HTMLElement,w=arguments.length>2?arguments[2]:void 0,I=document.registerElement(A,{prototype:Object.create(y.prototype),extends:w});return I}},{key:"addEl",value:function(A,y){if(A&&y)try{y.appendChild(A)}catch(w){L.error(w)}}},{key:"removeEl",value:function(A){try{var y=A.parentNode;y&&y.removeChild(A)}catch(w){L.error(w)}}},{key:"addClass",value:function(A){try{for(var y,w=arguments.length,I=new Array(w>1?w-1:0),W=1;W<w;W++)I[W-1]=arguments[W];(y=A.classList).add.apply(y,I)}catch(Y){L.error(Y)}}},{key:"removeClass",value:function(){}},{key:"hasClass",value:function(){}},{key:"isElement",value:function(A){try{return A instanceof HTMLElement}catch{return N()(A)==="object"&&A.nodeType===1&&N()(A.style)==="object"&&N()(A.ownerDocument)==="object"}}},{key:"setAttributes",value:function(A,y){if($.isElement(A))for(var w=0,I=y.length;w<I;w++){var W=y[w],Y=W.name;Y=W.name.replace(/["|']/g,""),A.setAttribute(Y,W.value)}}},{key:"syncAttributes",value:function(A,y){var w=y.attributes;$.setAttributes(A,w);var I=A.attributes;$.setAttributes(y,I)}},{key:"getClientWidth",value:function(){return document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth}},{key:"getClientHeight",value:function(){return document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight}},{key:"adaptSizeElement",value:function(A,y,w,I){var W=w,Y=I;Y.width=A||Y.width||W.offsetWidth,Y.height=y||Y.height||W.offsetHeight;var oe=Y.width,pe=Y.height,Oe=0;Y.style.position="absolute",W.offsetWidth<=0&&(W.style.width=oe+"px"),W.offsetHeight<=0&&(W.style.height=pe+"px");var et=W.offsetWidth/oe,pt=W.offsetHeight/pe;Oe=pt>et?et:pt,Y.style.top=W.offsetTop+(W.offsetHeight-pe*Oe)/2+"px",Y.style.left=W.offsetLeft+(W.offsetWidth-oe*Oe)/2+"px",Y.style.transform="scale(".concat(Oe,", ").concat(Oe,")"),Y.style["transform-origin"]="top left",Y.style.display="inline-block"}}]),$}(),O=i(27),B=i.n(O),H=function(){function $(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};s()(this,$),_()(this,"logger",null),_()(this,"__instance__",null),_()(this,"__singleton__",null),this.options=A,this.setLogger(this.constructor.name+".js")}return l()($,[{key:"setLogger",value:function(A){this.logger=new M.a(A)}},{key:"getLogger",value:function(){return this.logger}},{key:"setOptions",value:function(A){Object.assign(this.options,A)}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"events",get:function(){return this.options&&this.options.events?this.options.events(this):R(this)}}],[{key:"getInstance",value:function(){for(var A=arguments.length,y=new Array(A),w=0;w<A;w++)y[w]=arguments[w];return this.__instance__=B()(this,y),this.__instance__}},{key:"getSingleton",value:function(){if(!this.__singleton__){for(var A=arguments.length,y=new Array(A),w=0;w<A;w++)y[w]=arguments[w];this.__singleton__=B()(this,y)}return this.__singleton__}}]),$}(),j=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this)),_()(p()(w),"component",null),w.component=y.component,w}return g()(A,$),l()(A,[{key:"confirm",value:function(){}},{key:"show",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.component.data.content=y,this.component.data.display!=="default"&&this.component.data.display!==""||this.component.showBox(),this.component.data.display!=="show"&&this.component.show()}},{key:"hide",value:function(){this.component.hide()}}]),A}(H),K=i(23),J=function(){function $(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};s()(this,$),_()(this,"logger",null),this.options=A,this.debug=A.debug||!1,this.setLogger(this.constructor.name+".js")}return l()($,[{key:"setLogger",value:function(A){this.logger=new M.a(A)}},{key:"getLogger",value:function(){return this.logger}},{key:"setOptions",value:function(A){Object.assign(this.options,A)}},{key:"toString",value:function(){return JSON.stringify(this)}},{key:"events",get:function(){return this.options&&this.options.events?this.options.events(this):R(this)}},{key:"alert",get:function(){var A="";return this.options&&this.options.alertError&&(A=this.options.alertError),A}}]),$}(),re=i(9),se=function($){function A(){var y;return s()(this,A),y=c()(this,h()(A).call(this)),_()(p()(y),"loadData",null),_()(p()(y),"sourceURL",""),y}return g()(A,$),l()(A,[{key:"init",value:function(){}},{key:"setLoadData",value:function(y){this.loadData=y}},{key:"setSourceURL",value:function(y){this.sourceURL=y}},{key:"getLoadData",value:function(){return this.getLoadData}},{key:"getSourceURL",value:function(){return this.getSourceURL}}]),A}(J),Ae={LOAD_PLAYLIST:10,get 10(){return"loading playlist"},LOADED_PLAYLIST:11,get 11(){return"playlist is loaded"},IDLE:0,get 0(){return"is free"},LOADING:1,get 1(){return"loading segment"},DONE:2,get 2(){return"segment is loaded"},ERROR:3,get 3(){return"load get error"}},Ee=M.a.get("M3U8Parser.js",{level:2}),Ne={lineDelimiter:/\r?\n/,extensionHeader:"#EXTM3U",tagPrefix:"#EXT",segmentPrefix:"#EXTINF",segmentParse:/^#EXTINF: *([0-9.]+)(, *(.+?)?)?$/,tagParse:/^#EXT-X-([A-Z-]+)(:(.+))?$/,version:"VERSION",allowCache:"ALLOW-CACHE",combined:"COMBINED",endList:"ENDLIST",targetDuration:"TARGETDURATION",mediaSequence:"MEDIA-SEQUENCE",discontinuity:"DISCONTINUITY",steamInf:"STREAM-INF",isComment:function($){return $&&$[0]==="#"&&!$.startsWith(Ne.tagPrefix)},isBlank:function($){return $===""},canStrip:function($){return Ne.isBlank($)||Ne.isComment($)}},we=0,me=1,Se={file:void 0,name:void 0,start:0,end:0,discontinuity:void 0,duration:void 0},Me=function(){function $(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s()(this,$),_()(this,"source",""),_()(this,"segments",[]),_()(this,"_currentSegment",null),_()(this,"discontinuous",null),_()(this,"tags",{VERSION:void 0,TARGETDURATION:void 0}),_()(this,"_state",null),this.source=A,this.options=y,this.parse(this.source)}return l()($,[{key:"readSegment",value:function(A){var y=Ne.segmentParse.exec(A);if(y!==null){var w=parseFloat(y[1],10),I=y[3];w%1!=0&&this.tags.VERSION>=3&&Ee.info("readsegment","Version must be 3 or higher to support floating.","duration:",w),w<this.tags.TARGETDURATION&&Ee.info("readsegment","Segment duration must be less than the TARGETDURATION","duration:",w),w*=1e3,this._currentSegment=Object.assign({},Se,{duration:w,name:I,discontinuity:this.discontinuous});var W=this.segments[this.segments.length-1]||{start:0,end:0};this._currentSegment.start=W.end,this._currentSegment.end=W.end+w,this.discontinuous=!1,this._state=me}else Ee.warn("readsegment","read segment failed","line:",A)}},{key:"readTag",value:function(A){var y=Ne.tagParse.exec(A);if(y!==null)return{name:y[1],value:y[3]}}},{key:"readLine",value:function(A){if(A.startsWith(Ne.segmentPrefix))return this.readSegment(A);var y=this.readTag(A);if(y)switch(y.name){case Ne.version:this.tags.VERSION=parseFloat(y.value,10);break;case Ne.mediaSequence:this.tags.MEDIA_SEQUENCE=parseFloat(y.value,10);break;case Ne.allowCache:this.tags.ALLOW_CACHE=!!/\s*(YES|yes)\s*/.test(y.value);break;case Ne.discontinuity:this.tags.DISCONTINUITY=!0,this.discontinuous=!0;break;case Ne.targetDuration:this.tags.TARGETDURATION=parseFloat(y.value,10);break;case Ne.combined:this.tags.COMBINED=y.value;break;case Ne.streamInf:this.tags.STREAM_INF=y.value;break;case Ne.endList:this.tags.ENDLIST="EOF";break;default:Ee.warn("readLine","unknow line","line:",A)}}},{key:"addFile",value:function(A){if(A[0]!=="#"){this._currentSegment.file=A;var y=this.parseSDParam(A);if(y>=0){this._currentSegment.start=y,this._currentSegment.end=y+this._currentSegment.duration;var w=this.segments[this.segments.length-1]||{sd:0,start:0,end:0};w.duration=y-w.start,w.end=y}this._currentSegment.name||(this._currentSegment.name=A.substr(Math.max(0,A.lastIndexOf("/")),A.lastIndexOf("."))),this.segments.push(this._currentSegment),this._state=we}else{var I=this.readTag(A);switch(I.name){case"PROGRAM-DATE-TIME":var W=new Date(I.value);this._currentSegment.time=W;break;default:Ee.warn("addFile","Invalid tag.","tag.name:",I.name)}}}},{key:"parseSDParam",value:function(A){var y=-1;try{var w=new URL(A).searchParams.get("sd");w&&(y=parseInt(w,10))}catch{}return y}},{key:"parse",value:function(A){var y=this;if(typeof(A=A||this.source)=="string"){this._state=we,this.discontinuous=!1;var w=A.split(Ne.lineDelimiter);if(w[0]==Ne.extensionHeader)return w.forEach(function(I){if(!Ne.canStrip(I))switch(y._state){case we:y.readLine(I);break;case me:y.addFile(I);break;default:Object(K.a)("parsing m3u8 get an error, it is unknow state.")}}),this;Ee.error("parse","it is not a valid  m3u8 header","header:",w[0])}else Object(K.a)("m3u8 file is not text.",A)}},{key:"version",get:function(){return this.tags.VERSION}},{key:"duration",get:function(){return this.segments.length?this.segments.reduce(function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=arguments.length>1?arguments[1]:void 0,w=typeof A=="number"?A:A.duration;return w+y.duration}):0}},{key:"targetDuration",get:function(){return this.tags.TARGETDURATION}},{key:"mediaSequence",get:function(){return this.tags.MEDIA_SEQUENCE}},{key:"allowCache",get:function(){return this.tags.ALLOW_CACHE}},{key:"length",get:function(){return this.segments.length}}]),$}(),ke=i(45),He=i.n(ke);function ee(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"Object";return function(A){var y="[object "+$+"]";return Object.prototype.toString.call(A)==y}}var ie=function(){function $(){s()(this,$)}return l()($,null,[{key:"importScripts",value:function(A,y,w){var I="ready"+Date.now();A instanceof Array?He()(A,I):He()([A],I),He.a.ready(I,{success:y,error:w})}},{key:"blobData",value:function(A){var y=new Blob([A],{type:"application/javascript"});return URL.createObjectURL(y)}},{key:"escapeHTML",value:function(A){if($.isString(A))return A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"getInnerWidthHeight",value:function(){return{width:window.innerWidth,height:window.innerHeight}}},{key:"Fullscreen",value:function(){var A=document.documentElement;A.requestFullscreen?A.requestFullscreen():A.mozRequestFullScreen?A.mozRequestFullScreen():A.webkitRequestFullScreen&&(A.webkitRequestFullScreen(),setTimeout(function(){console.error("fullscreen success"),document.dispatchEvent(new Event("fullscreenchange"))},0))}},{key:"exitFullscreen",value:function(){var A=document;A.exitFullscreen?A.exitFullscreen():A.mozCancelFullScreen?A.mozCancelFullScreen():A.webkitExitFullscreen&&(A.webkitExitFullscreen(),setTimeout(function(){console.error("exitfullscreen success"),document.dispatchEvent(new Event("fullscreenchange"))},0))}},{key:"buildFilePath",value:function(A,y){return A.map(function(w){return y+w})}},{key:"insertSort",value:function(A,y,w){var I,W,Y=A.length;if(Y!==0)if(w){var oe=w(y);I=oe.key,W=oe.value;for(var pe=0;pe<Y;pe++)if(W<A[pe][I]){for(var Oe=Y;Oe>pe;)A[Oe]=A[Oe-1],Oe--;return void(A[pe]=y)}A.push(y)}else{W=y;for(var et=0;et<Y;et++)if(W<A[et]){for(var pt=Y;pt>et;)A[pt]=A[pt-1],pt--;return void(A[et]=W)}A.push(W)}else A.push(y)}},{key:"isSafari",value:function(){var A=navigator.userAgent;return/Safari/.test(A)&&!/Chrome/.test(A)}},{key:"msec2sec",value:function(A){var y=(A/1e3).toFixed(3);return parseFloat(y,10)}}]),$}();_()(ie,"isObject",function(){return ee("Object")}),_()(ie,"isString",function(){return ee("String")}),_()(ie,"isFunction",function(){return ee("Function")});var xe=i(34),Ve=i.n(xe),Ge=function($){function A(){return s()(this,A),c()(this,h()(A).call(this))}return g()(A,$),l()(A,[{key:"add",value:function(y){this.push(Object.freeze(y))}},{key:"addAll",value:function(y){var w=this;y.forEach(function(I){w.add(I)})}},{key:"get",value:function(y){return this[y]}},{key:"getLast",value:function(){return this[this.length-1]}},{key:"getBy",value:function(y){var w=this;if(typeof y=="function"){var I=new this.constructor;return this.every(function(W,Y){return y.call(w,W,Y,w)===!0&&I.add(W),!0}),I}}},{key:"indexOfByTime",value:function(y,w){w||(w=function(pe){return y>=pe.start&&y<pe.end});for(var I=this.length-1,W=0;W<=I;){var Y=Math.floor((I+W)/2),oe=this[Y];if(w(oe))return Y;oe.start>y?I=Y-1:W=Y+1}return-1}},{key:"getByTime",value:function(y){var w=this.indexOfByTime(y);if(w>=0)return this[w]}},{key:"getByKey",value:function(){for(var y=arguments.length,w=new Array(y),I=0;I<y;I++)w[I]=arguments[I];return Array.isArray(w[0])&&(w=w[0]),this.getBy(function(W){var Y=!1;return w.every(function(oe){return!Object.prototype.hasOwnProperty.call(W,oe)||(Y=!0,!1)}),Y})}},{key:"getByValue",value:function(){for(var y=arguments.length,w=new Array(y),I=0;I<y;I++)w[I]=arguments[I];return Array.isArray(w[0])&&(w=w[0]),this.getBy(function(W){var Y=!1;return W.each(function(oe,pe){if(w.includes(pe))return Y=!0,!1}),Y})}},{key:"getByKeyValue",value:function(y,w){return this.getBy(function(I){return I[y]===w})}},{key:"getValues",value:function(){for(var y=arguments.length,w=new Array(y),I=0;I<y;I++)w[I]=arguments[I];return Array.isArray(w[0])&&(w=w[0]),this.map(function(W){return w.length?W.get(W,w):W.getValues(W)})}},{key:"indexOfBy",value:function(y){var w=0,I=this.length;for(y=y||function(){return!1};w<I;){if(y.call(this,this[w],w,this)===!0)return w;w++}return-1}},{key:"indexOfByKey",value:function(y,w){return this.indexOfBy(function(I){return I[y]===w})}},{key:"indexOfByKeyValue",value:function(y,w){return this.indexOfByKey(y,w)}},{key:"each",value:function(y){if(typeof y=="function")return this.forEach(y),this}},{key:"remove",value:function(y,w){return this.length<=0?this:(y=y<0?0:y,w=w||y+1,this.splice(y,w-y),this)}},{key:"removeItem",value:function(){for(var y=arguments.length,w=new Array(y),I=0;I<y;I++)w[I]=arguments[I];return Array.isArray(w[0])&&(w=w[0]),this.removeBy(function(W){return w.includes(W)})}},{key:"removeBy",value:function(y){for(var w=0,I=this.length;w<I;w++)y.call(this,this[w],w,this)===!0&&(this.splice(w,1),I--,w--);return this}},{key:"removeByKeyValue",value:function(y,w){return this.removeBy(function(I){return I[y]===w})}},{key:"toJSON",value:function(){var y=Array.from(this);return y.forEach(function(w,I){y[I]=w&&typeof w.toJSON=="function"?w.toJSON():w}),y}},{key:"toArray",value:function(){return Array.from(this)}},{key:"size",get:function(){return this.length}}]),A}(Ve()(Array)),Ze=function(){function $(){s()(this,$)}return l()($,[{key:"pair",value:function(){return Object.entries(this)}},{key:"keys",value:function(){return Object.keys(this)}},{key:"set",value:function(A,y){return this[A]=y,this}},{key:"get",value:function(A){return this[A]}},{key:"add",value:function(A,y){return Object.prototype.hasOwnProperty.call(this,A)||this.set(A,y),this}},{key:"addAll",value:function(A){for(var y in A)this.add(y,A[y]);return this}},{key:"toJSON",value:function(){var A={};for(var y in this)Object.prototype.hasOwnProperty.call(this,y)&&(A[y]=this[y]);return A}}]),$}(),ut=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"no",0),_()(p()(w),"name",null),_()(p()(w),"duration",0),_()(p()(w),"file",null),_()(p()(w),"start",0),_()(p()(w),"end",0),Object.assign(p()(w),y),w}return g()(A,$),A}(Ze),Qe=function($){function A(y){return s()(this,A),c()(this,h()(A).call(this,y))}return g()(A,$),l()(A,[{key:"add",value:function(y){y instanceof ut||(y=new ut(y)),y.no=this.length+1,ie.isObject(y)&&this.push(y)}}]),A}(Ge),ve={ProcessorResetEnd:"DataProcessorController.processorResetEnd",DataProcessorReady:"DataProcessorController.dataProcessorReady",DecodeStartDecode:"DecodeController.startDecode",DecodeFlush:"DecodeController.flush",DecodeDecoded:"DecodeController.decoded",DecodeApppendEnd:"DecodeController.appendEnd",DecodeFlushEnd:"DecodeController.flushEnd",DecodeReady:"DecodeController.ready",DemuxResetEnd:"DemuxController.resetEnd",DemuxStartDemux:"DemuxController.startDemux",DemuxLast:"DemuxController.last",DemuxVideo:"DemuxController.video",DemuxAAC:"DemuxController.AAC",DemuxReady:"DemuxController.ready",ImagePlayerRenderEnd:"ImagePlayer.renderEnd",ImagePlayerWait:"ImagePlayer.wait",ImagePlayerReady:"ImagePlayer.ready",ImagePlayerEnd:"ImagePlayer.end",ImagePlayerBuffeUpdate:"ImagePlayer.bufferUpdate",ControlBarPlay:"ControlBar.onPlay",ControlBarPause:"ControlBar.onPause",ControlBarPauseLoading:"ControlBar.onPauseLoading",LoadDataReadBufferByNo:"LoadData.readBufferByNo",LoadDataReadBuffer:"LoadData.readBuffer",LoadDataRead:"LoadData.onRead",LoadDataSeek:"LoadData.onSeek",LoadDataFirstLoaded:"LoadData.onFirstLoaded",LoaderPlayListStart:"Loader.playlistStart",LoaderLoading:"Loader.onLoading",LoaderError:"Loader.onError",LoaderLoaded:"Loader.onLoaded",LoaderUpdateSpeed:"Loader.updateSpeed",LoaderLoadFile:"Loader.loadFile",LoaderPlayListLoaded:"Loader.playlistLoaded",AudioPlayerReady:"AudioPlayer.MSEReady",AudioPlayerDataReady:"AudioPlayer.dataReady",AudioPlayerWait:"AudioPlayer.wait",AudioPlayerEnd:"AudioPlayer.end",AudioPlayerPlaySuccess:"AudioPlayer.playSuccess",AudioPlayerPlayFail:"AudioPlayer.playFail",PlayerMaxPTS:"DemuxController.maxpts",PlayerSeekEnd:"Player.seekend",PlayerSpeedTo:"Player.speedTo",PlayerChangeRate:"Player.changeRate",PlayerChangeSrc:"Player.changeSrc",PlayerPlaying:"Player.playing",PlayerTimeUpdate:"Player.timeUpdate",PlayerbufferUpdate:"Player.bufferupdate",PlayerResetReady:"Player.resetReady",PlayerWait:"Player.wait",PlayerLoadNext:"Player.loadNext",PlayerOnPlay:"Player.onPlay",PlayerOnPause:"Player.onPause",PlayerOnSeek:"Player.onSeek",PlayerOnVolume:"Player.onVolume",PlayerReady:"Player.ready",PlayerPlay:"Player.play",PlayerReset:"Player.reset",PlayerLoadedMetaData:"Player.loadedMetaData",PlayerEnd:"Player.end",PlayerPause:"Player.pause",PlayerSeeking:"Player.seeking",PlayerAlert:"Player.alert",PlayerThrowError:"Player.throwError",StreamDataReady:"StreamController.dataReady"};function Ke($,A){var y=Object.keys($);if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols($);A&&(w=w.filter(function(I){return Object.getOwnPropertyDescriptor($,I).enumerable})),y.push.apply(y,w)}return y}var ne,Z,fe={HLS:function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this)),_()(p()(w),"state",Ae.IDLE),_()(p()(w),"maxBufferDuration",re.b.maxDuration),_()(p()(w),"maxBufferSize",re.b.maxSize),_()(p()(w),"baseUrl",""),_()(p()(w),"options",null),_()(p()(w),"httpWorker",null),_()(p()(w),"sourceData",null),_()(p()(w),"segmentPool",[]),_()(p()(w),"currentNo",null),_()(p()(w),"maxRetryCount",re.b.maxRetryCount),w.options=y,w.loaderController=w.options.loaderController,w.dataController=w.loaderController.dataController,w.httpWorker=y.httpWorker,w.setSegmentPool(new Qe),w}return g()(A,$),l()(A,[{key:"loadPlaylist",value:function(y){var w=this;this.httpWorker.postMessage({type:"invoke",fileType:"m3u8",method:"get",name:"playlist",url:this.sourceURL}),this.httpWorker.onmessage=function(I){var W=I.data,Y=I.data.data;if(Y)W.name=="playlist"&&w.parsePlaylist(Y,y);else{var oe="Get the ".concat(W.fileType," file error. URL: ").concat(W.url);w.events.emit(ve.PlayerAlert,oe),w.events.emit(ve.LoaderError,oe,W);var pe=[w.state,"request playlist error.","data:",W,oe];w.events.emit(ve.PlayerThrowError,pe)}}}},{key:"parsePlaylist",value:function(y,w){var I=new Me(y);if(I.segments&&I.segments.length)I.segments.forEach(function(Y){Y.start=ie.msec2sec(Y.start),Y.end=ie.msec2sec(Y.end),Y.duration=ie.msec2sec(Y.duration)}),this.setSourceData(Object.freeze(I)),this.segmentPool.addAll(I.segments),w.call(this,I);else{this.events.emit(ve.LoaderError,I),this.events.emit(ve.PlayerAlert,"Parse playlist file error.");var W=[this.state,"Parse playlist error.","data:",I];this.events.emit(ve.PlayerThrowError,W)}}},{key:"setSourceData",value:function(y){this.sourceData=y}},{key:"getSourceData",value:function(){return this.sourceData}},{key:"setSegmentPool",value:function(y){this.segmentPool=y}},{key:"getSegmentPool",value:function(){return this.segmentPool}},{key:"isNotFree",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return y="["+y+"]loader is not free. please wait.",this.state!==Ae.IDLE&&this.state!==Ae.DONE&&(this.logger.warn("isNotFree","check status for loader","notice:",y),!0)}},{key:"getBaseUrl",value:function(y){var w=this.options.sourceURL;if(!(y.indexOf("//")>-1)){var I=w.lastIndexOf("/");return w.substr(0,I+1)}return""}},{key:"checkLoadCondition",value:function(y){return!(y.no>this.segmentPool.length)&&(!(this.dataController.getLoadDataBufferPool().bufferDuration>this.maxBufferDuration)||(this.logger.info("checkLoadCondition","stop load next segment.","bufferDuration:",this.dataController.getLoadDataBufferPool().bufferDuration,"maxBufferDuration:",this.maxBufferDuration),!1))}},{key:"loadFile",value:function(y,w,I){var W=this;if(y instanceof ut)if(this.isNotFree()&&w!=="seek"&&w!=="start")this.logger.warn("loadFile","is loading","segment:",y,"type:",w);else{if(!this.checkLoadCondition(y))return this.state=Ae.IDLE,void this.logger.warn("loadFile","checkLoadCondition failed","segment:",y,"type:",w);this.currentNo=y.no;var Y=this.getBaseUrl(y.file)+y.file,oe=1,pe=function(et,pt){return typeof W.options.processURL=="function"?W.options.processURL(et,pt):et},Oe=function(){W.httpWorker.postMessage({type:"invoke",fileType:"ts",method:"get",name:y.no,url:pe(Y,y)})};this.state=Ae.LOADING,this.events.emit(ve.LoaderLoading,y,w,I),this.httpWorker.onmessage=function(et){W.state=Ae.DONE;var pt=et.data;if(W.logger.info("loadfile","httpWorker","onmessage get data"),pt&&pt.type!=="error")pt.type==="notice"?pt.noticeType==="speed"&&W.events.emit(ve.LoaderUpdateSpeed,pt.data):pt.fileType==="ts"&&pt.name===y.no?(W.logger.info("loadFile","read success","data no:",pt.name),W.state=Ae.IDLE,W.events.emit(ve.LoaderLoaded,pt,y,w,I)):W.logger.warn("loadFile","is not ts file or the segment'no is not equal.","fileType:",pt.fileType,"data:",pt);else if(W.state=Ae.ERROR,oe<=W.maxRetryCount)W.logger.warn("loadFile","retry to load","count:",oe,"segment:",y),Oe(),oe+=1;else{W.events.emit(ve.LoaderError,y,w,I),W.events.emit(ve.PlayerAlert,"Load file error, please concat administrator.");var sn=[W.state,"Load File error.","load count:",oe,"segment:",y];W.events.emit(ve.PlayerThrowError,sn)}},Oe()}}},{key:"destroy",value:function(){this.httpWorker&&this.httpWorker.terminate()}}]),A}(se)},Be=function($){function A(y,w){var I;return s()(this,A),I=c()(this,h()(A).call(this)),_()(p()(I),"state",null),_()(p()(I),"exeLoader",null),_()(p()(I),"loadData",null),_()(p()(I),"type","HLS"),_()(p()(I),"options",null),_()(p()(I),"dataController",null),I.type=y||I.type,I.player=w.player,I.options=w.player.options,I.dataController=I.player.dataController,I.init(I.type,I.options),I}return g()(A,$),l()(A,[{key:"init",value:function(y,w){this.bindEvent(),this.setExeLoader(new fe[y](function(I){for(var W=1;W<arguments.length;W++){var Y=arguments[W]!=null?arguments[W]:{};W%2?Ke(Object(Y),!0).forEach(function(oe){_()(I,oe,Y[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(Y)):Ke(Object(Y)).forEach(function(oe){Object.defineProperty(I,oe,Object.getOwnPropertyDescriptor(Y,oe))})}return I}({},w,{player:this.player,loaderController:this}))),this.setSourceURL(w.sourceURL),this.player.loadData?this.setLoadData(this.player.loadData):this.setLoadData(this.dataController.getDataInstance("load",w)),this.exeLoader.setLoadData(this.loadData)}},{key:"run",value:function(){this.state=Ae.LOAD_PLAYLIST,this.events.emit(ve.LoaderPlayListStart,this),this.logger.info("run",Ae[this.state],"url:",this.options.sourceURL),this.loadPlaylist()}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.LoaderLoadFile,function(w,I,W){y.exeLoader.loadFile(w,I,W)})}},{key:"loadPlaylist",value:function(y){var w=this;this.exeLoader.loadPlaylist(function(I){I?(w.dataController.setLoadDataSourceData(w.exeLoader.getSourceData()),w.dataController.setLoadDataSegmentPool(w.exeLoader.getSegmentPool()),w.state=Ae.LOADED_PLAYLIST,w.events.emit(ve.LoaderPlayListLoaded,w),typeof y=="function"&&y.call(w,I)):w.logger.error("run","start load m3u8","data:",I)})}},{key:"switchPlaylist",value:function(y,w){this.setSourceURL(y),this.dataController.clearLoadData(),this.state=Ae.LOAD_PLAYLIST,this.events.emit(ve.LoaderPlayListStart,this),this.logger.info("switchPlaylist",Ae[this.state],"url:",y),this.loadPlaylist(w)}},{key:"setExeLoader",value:function(y){this.exeLoader=y}},{key:"getExeLoader",value:function(){return this.exeLoader}},{key:"setSourceURL",value:function(y){this.exeLoader.setSourceURL(y)}},{key:"getSourceURL",value:function(){return this.exeLoader.getSourceURL()}},{key:"setLoadData",value:function(y){this.loadData=y}},{key:"getLoadData",value:function(){return this.loadData}},{key:"getSourceData",value:function(){return this.exeLoader.getSourceData()}},{key:"destroy",value:function(){this.exeLoader.destroy()}}]),A}(H),Xe=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"no",0),_()(p()(w),"start",0),_()(p()(w),"end",0),_()(p()(w),"blob",null),_()(p()(w),"arrayBuffer",null),_()(p()(w),"duration",0),Object.assign(p()(w),y),w}return g()(A,$),l()(A,[{key:"size",get:function(){return this.blob.size}}]),A}(Ze),st=function($){function A(y){return s()(this,A),c()(this,h()(A).call(this,y))}return g()(A,$),l()(A,[{key:"add",value:function(y){y instanceof Xe||(y=new Xe(y));var w=this.length;if(w!==0){for(;w--;)if(y.no<=this[w].no)return void this.splice(w,1,y);return this.push(y),this}this.push(y)}},{key:"getBufferSize",value:function(){return this.length<=0?0:this.reduce(function(y,w){return isNaN(y)&&(y=y.blob.size),y+w.blob.size})}},{key:"getBufferDuration",value:function(){return this.length<=0?0:this.reduce(function(y,w){return isNaN(y)&&(y=y.end-y.start),y+(w.end-w.start)})}},{key:"bufferSize",get:function(){return this.getBufferSize()}},{key:"bufferDuration",get:function(){return this.getBufferDuration()}}]),A}(Ge),mt=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this)),_()(p()(y),"bufferPool",[]),_()(p()(y),"sourceData",{}),_()(p()(y),"options",{}),_()(p()(y),"segmentPool",[]),_()(p()(y),"readBufferNo",null),_()(p()(y),"startLoadTime",null),_()(p()(y),"currentSeekTime",null),y.options=w,y.init(),y}return g()(A,$),l()(A,[{key:"init",value:function(){var y=this;this.setBufferPool(new st),this.events.on(ve.LoadDataReadBufferByNo,function(w,I){y.readBufferByNo(w,I)}),this.events.on(ve.LoadDataReadBuffer,function(w,I){y.readBuffer(w,I)}),this.events.on(ve.LoaderLoaded,function(w,I,W,Y){var oe=y.createBuffer({arrayBuffer:w.arrayBuffer},I);if(y.segmentLoaded(I,oe),W==="seek"&&Y===y.currentSeekTime)return y.events.emit(ve.LoadDataSeek,oe,Y),void y.removeBufferByNo(oe.no);Y===y.startLoadTime&&y.events.emit(ve.LoadDataFirstLoaded,oe,Y)})}},{key:"setOptions",value:function(y){Object.assign(this.options,y)}},{key:"startLoad",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.logger.info("startLoad","begin to load ts data","time:",y),isNaN(y)?this.logger.error("seekTime","seek","time:",y):(this.startLoadTime=y,this.loadSegmentByTime(y,"start"))}},{key:"readBuffer",value:function(y,w){var I=this.getSegmentByTime(y);I&&this.readBufferByNo(I.no,w)}},{key:"segmentLoaded",value:function(y,w){w&&this.addBufferPool(w),y.no===this.options.player.currentIndex&&this.readBufferByNo(y.no),y.no<this.segmentPool.getLast().no&&this.loadSegmentByNo(y.no+1)}},{key:"seekTime",value:function(y){if(isNaN(y))this.logger.error("seekTime","seek","time:",y);else{var w;this.currentSeekTime=y;var I=this.bufferPool.indexOfByTime(y);I>-1?(w=this.bufferPool[I],this.events.emit(ve.LoadDataSeek,w,y)):(this.removeBufferPool(this.bufferPool.length),this.loadSegmentByTime(y,"seek"))}}},{key:"loadSegmentByTime",value:function(y,w){if(!isNaN(y)){var I=this.segmentPool.indexOfByTime(y);if(I>=0){var W=this.segmentPool[I];this.events.emit(ve.LoaderLoadFile,W,w,y)}else this.logger.error("loadSegmentByTime","time over","time:",y,"type:",w)}}},{key:"createBuffer",value:function(y,w){if(y){var I={start:w.start,end:w.end,no:w.no,duration:w.end-w.start,arrayBuffer:y.arrayBuffer};return new Xe(I)}}},{key:"isValidSegmentNo",value:function(y){return!isNaN(y)&&y>0&&y<=this.segmentPool.length}},{key:"loadSegmentByNo",value:function(y){var w=y-1,I=this.segmentPool.get(w);I&&this.events.emit(ve.LoaderLoadFile,I,"play")}},{key:"readBufferByNo",value:function(y,w){this.isValidSegmentNo(y)?(this.readBufferNo=y,w=w||function(I){this.events.emit(ve.LoadDataRead,I)},this.getBlobByNo(y,w)):this.logger.error("readBufferByNo","check buffer no","is not valid no",y)}},{key:"getSegmentByTime",value:function(y){var w=this.segmentPool.indexOfByTime(y);return this.segmentPool[w]}},{key:"getBlobByNo",value:function(y,w){if(isNaN(y))this.logger.error("getBlobByNo","isNaN","no:",y);else{var I;if(!this.isBufferReading)return this.isBufferReading=!0,I=this.bufferPool.getByKeyValue("no",y)[0],typeof w=="function"&&(w.call(this,I),I&&this.removeBufferByNo(I.no)),this.isBufferReading=!1,I;this.logger.warn("getBlobByNo","isBufferReading","no:",y)}}},{key:"addBufferPool",value:function(y){if(this.bufferPool.length){if(this.bufferPool[0].no===y.no+1)return this.bufferPool.unshift(y),!0;var w=this.bufferPool.getLast();if(y.no-w.no==1)return this.bufferPool.push(y),!0;if(this.bufferPool.indexOfByKey("no",y.no))return!0;this.bufferPool.splice(0,this.bufferPool.length)}this.bufferPool.push(y)}},{key:"removeBufferPool",value:function(y){this.bufferPool.splice(0,y+1)}},{key:"removeBufferByNo",value:function(y){var w=this.bufferPool.indexOfByKey("no",y);if(!(w<=-1))return this.removeBufferPool(w),this.bufferPool.length?this.bufferPool.getLast().no<this.segmentPool.getLast().no&&this.loadSegmentByNo(this.bufferPool.getLast().no+1):y<this.segmentPool.getLast().no&&this.loadSegmentByNo(y+1),!0}},{key:"clear",value:function(){this.sourceData={},this.readBufferNo=null,this.currentSeekTime=null,this.bufferPool.length=0,this.segmentPool.length=0}},{key:"getSegmentByNo",value:function(y){return this.segmentPool.get(y-1)}},{key:"getSegment",value:function(y){return this.segmentPool.getByTime(y)}},{key:"setSourceData",value:function(y){this.sourceData=y}},{key:"getSourceData",value:function(){return this.sourceData}},{key:"setBufferPool",value:function(y){this.bufferPool=y}},{key:"getBufferPool",value:function(){return this.bufferPool}},{key:"setSegmentPool",value:function(y){this.segmentPool=y}},{key:"getSegmentPool",value:function(){return this.segmentPool}}]),A}(J),ye=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this)),_()(p()(w),"loadData",null),w.options=y,w}return g()(A,$),l()(A,[{key:"setLoadData",value:function(){for(var y=arguments.length,w=new Array(y),I=0;I<y;I++)w[I]=arguments[I];this.loadData=B()(mt,w)}},{key:"getLoadData",value:function(){return this.loadData}},{key:"getLoadDataBufferPool",value:function(){return this.loadData.bufferPool}},{key:"setLoadDataSourceData",value:function(y){this.loadData.setSourceData(y)}},{key:"setLoadDataSegmentPool",value:function(y){this.loadData.setSegmentPool(y)}},{key:"startLoad",value:function(y){y=Math.max(y,0),this.startLoadData(y)}},{key:"startLoadData",value:function(y){this.loadData.startLoad(y)}},{key:"clearLoadData",value:function(){this.loadData.clear()}},{key:"getDataInstance",value:function(y){if(y)switch(y){case"load":if(!this.loadData){for(var w=arguments.length,I=new Array(w>1?w-1:0),W=1;W<w;W++)I[W-1]=arguments[W];this.setLoadData.apply(this,I)}return this.loadData;default:return null}}}]),A}(H),$e=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"checkHanlder",null),_()(p()(w),"resetStatus",{processor:!1,audioPlayer:!1}),w.player=y.player,w.player?(w.audioPlayer=y.audioPlayer,w.imagePlayer=y.imagePlayer,w.loadData=y.loadData,w.bindEvent(),w):c()(w)}return g()(A,$),l()(A,[{key:"bindEvent",value:function(){var y=this;this.events.on(ve.ProcessorResetEnd,function(){y.checkResetReady("processor")}),this.events.on(ve.AudioPlayerReady,function(){y.checkResetReady("audioPlayer")}),this.events.on(ve.PlayerResetReady,function(){y.onResetReady()}),this.events.on(ve.LoadDataSeek,function(w,I){y.onSeek(w,I)}),this.events.on(ve.ImagePlayerRenderEnd,function(w){y.onRenderEnd(w)}),this.events.on(ve.ImagePlayerWait,function(){y.audioPlayer.pause()})}},{key:"play",value:function(y){this.logger.warn("play","play start"),this.sync(y)}},{key:"sync",value:function(y){var w=this.player,I=this.audioPlayer,W=this.imagePlayer,Y=I.offset,oe=W.offset,pe=Math.min(Y,oe),Oe=Math.max(Y,oe),et=w.playbackRate;if(w.seeking&&(w.seeking=!1),!w.reseting&&w.status!=="pause"&&I.status!=="waiting"&&W.status!=="wait")if(w.status!=="end"){if(this.setCurrentTime(y),!(y<pe))return y>=Y&&y<=oe?(this.events.once(ve.AudioPlayerPlaySuccess,function(){W.render(oe)}),I.playbackRate=et,void I.play()):void(y>=oe&&y<=Y?W.render(y):y>Oe&&(this.audioPlayer.playbackRate=et,this.audioPlayer.play(),W.render(y)));this.sync(pe)}else I.paused||I.pause()}},{key:"setCurrentTime",value:function(y){this.player.currentTime=y,this.events.emit(ve.PlayerTimeUpdate,y)}},{key:"pause",value:function(){this.audioPlayer.pause(),this.clearDrawHanlder()}},{key:"seek",value:function(y){var w=this,I=this.imagePlayer.isBuffered(y),W=this.audioPlayer.isBuffered(y);this.player.pause(),I&&W?(this.logger.warn("seek","seek in buffer, time: ".concat(y,", buffer: ").concat(this.player.buffer()[0],", ").concat(this.player.buffer()[1])),this.audioPlayer.onSeekedHandler=function(){w.player.play()},this.audioPlayer.currentTime=y):this.reset()}},{key:"reset",value:function(y){this.logger.info("reset","reset start"),this.player.reseting=!0,this.events.emit(ve.PlayerReset,y),this.resetStatus={processor:!1,audioPlayer:!1},this.player.processController.reset(),this.player.streamController.reset(),this.player.audioPlayer.reset(y),this.player.imagePlayer.reset(),this.player.currentIndex=null}},{key:"checkResetReady",value:function(y){var w=this.resetStatus;if(y&&typeof y=="string"){w[y]=!0;for(var I=Object.keys(w),W=0;W<I.length;W++)if(!w[I[W]])return!1;this.logger.warn("checkResetReady","reset ready"),this.events.emit(ve.PlayerResetReady)}}},{key:"onResetReady",value:function(){this.player.reseting=!1,this.logger.info("onResetReady","reset Ready"),this.player.changing&&this.events.emit(ve.DataProcessorReady),this.player.seeking&&this.player.loadData.seekTime(this.player.currentTime/1e3)}},{key:"onSeek",value:function(y,w){var I=this.player.currentTime;this.logger.info("onseek",I,y,y.no,w),y&&y.no&&Math.abs(I-Math.floor(1e3*w))<2?(this.player.currentIndex=y.no,this.logger.info("seektime:",y.no,w,this.player.currentTime),this.player.seekSegmentNo=y.no,this.player.streamController.startLoad(y.no)):this.logger.warn("seek failue, not found data",I,y,w)}},{key:"clearDrawHanlder",value:function(){clearTimeout(this.drawFrameHanlder),this.drawFrameHanlder=null}},{key:"onRenderEnd",value:function(){this.player.seekTime&&(this.logger.info("onRenderEnd","seektoRenderTime:",Date.now()-this.player.seekTime),this.player.seekTime=null);var y=this.imagePlayer,w=this.audioPlayer,I=this.player.playbackRate,W=w.currentTime,Y=y.currentTime,oe=w.offset,pe=y.fragDuration,Oe=W-Y,et=0;Y<oe?this.drawNext(Y+pe*I,pe):(Oe>0&&Oe>pe?pe=(et=Y+Math.ceil(Oe/pe+I)*pe)-W:(et=Y+pe*I,pe-=Oe),this.drawNext(et,pe))}},{key:"drawNext",value:function(y,w){var I=this;this.drawFrameHanlder&&this.clearDrawHanlder(),this.drawFrameHanlder=setTimeout(function(){I.sync(y)},w)}}]),A}(J);function vt($){if(ne){for(var A=arguments.length,y=new Array(A>1?A-1:0),w=1;w<A;w++)y[w-1]=arguments[w];ne.apply(void 0,[$].concat(y))}}function bt($){if(Z){for(var A=arguments.length,y=new Array(A>1?A-1:0),w=1;w<A;w++)y[w-1]=arguments[w];Z.apply(void 0,[$].concat(y))}}var dt=function(){function $(A){s()(this,$),this.payload=A,this.nri=(96&this.payload[0])>>5,this.ntype=31&this.payload[0]}return l()($,null,[{key:"type",value:function(A){return A.ntype in $.TYPES?$.TYPES[A.ntype]:"UNKNOWN"}},{key:"NDR",get:function(){return 1}},{key:"IDR",get:function(){return 5}},{key:"SEI",get:function(){return 6}},{key:"SPS",get:function(){return 7}},{key:"PPS",get:function(){return 8}},{key:"AUD",get:function(){return 9}},{key:"TYPES",get:function(){var A;return A={},_()(A,$.IDR,"IDR"),_()(A,$.SEI,"SEI"),_()(A,$.SPS,"SPS"),_()(A,$.PPS,"PPS"),_()(A,$.NDR,"NDR"),_()(A,$.AUD,"AUD"),A}}]),l()($,[{key:"toString",value:function(){return"".concat($.type(this),": NRI: ").concat(this.getNri())}},{key:"getNri",value:function(){return this.nri>>6}},{key:"type",value:function(){return this.ntype}},{key:"isKeyframe",value:function(){return this.ntype==$.IDR}},{key:"getSize",value:function(){return 4+this.payload.byteLength}},{key:"getData",value:function(){var A=new Uint8Array(this.getSize());return new DataView(A.buffer).setUint32(0,this.getSize()-4),A.set(this.payload,4),A}}]),$}(),$t=function(){function $(A){s()(this,$),this.data=A,this.index=0,this.bitLength=8*A.byteLength}return l()($,[{key:"skipBits",value:function(A){if(this.bitsAvailable<A)return!1;this.index+=A}},{key:"readBits",value:function(A){var y=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],w=this.getBits(A,this.index,y);return w}},{key:"getBits",value:function(A,y){var w=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(this.bitsAvailable<A)return 0;var I=y%8,W=this.data[y/8|0]&255>>>I,Y=8-I;if(Y>=A)return w&&(this.index+=A),W>>Y-A;w&&(this.index+=Y);var oe=A-Y;return W<<oe|this.getBits(oe,y+Y,w)}},{key:"skipLZ",value:function(){var A;for(A=0;A<this.bitLength-this.index;++A)if(this.getBits(1,this.index+A,!1)!==0)return this.index+=A,A;return A}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var A=this.skipLZ();return this.readBits(A+1)-1}},{key:"readEG",value:function(){var A=this.readUEG();return 1&A?1+A>>>1:-1*(A>>>1)}},{key:"readBoolean",value:function(){return this.readBits(1)===1}},{key:"readUByte",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return this.readBits(8*A)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"bitsAvailable",get:function(){return this.bitLength-this.index}}]),$}(),Ct=function(){function $(A){s()(this,$),this.remuxer=A,this.track=A.mp4track}return l()($,null,[{key:"extractNALu",value:function(A){for(var y,w,I=0,W=A.byteLength,Y=0,oe=[];I<W;)switch(y=A[I++],Y){case 0:y===0&&(Y=1);break;case 1:Y=y===0?2:0;break;case 2:case 3:y===0?Y=3:(y===1&&I<W&&(w&&oe.push(A.subarray(w,I-Y-1)),w=I),Y=0)}return w&&oe.push(A.subarray(w,W)),oe}},{key:"skipScalingList",value:function(A,y){for(var w=8,I=8,W=0;W<y;W++)I!==0&&(I=(w+A.readEG()+256)%256),w=I===0?w:I}},{key:"readSPS",value:function(A){var y,w,I,W,Y,oe,pe=new $t(A),Oe=0,et=0,pt=0,sn=0,kn=1;if(pe.readUByte(),y=pe.readUByte(),pe.readBits(5),pe.skipBits(3),pe.readUByte(),pe.skipUEG(),y===100||y===110||y===122||y===244||y===44||y===83||y===86||y===118||y===128){var Mr=pe.readUEG();if(Mr===3&&pe.skipBits(1),pe.skipUEG(),pe.skipUEG(),pe.skipBits(1),pe.readBoolean()){oe=Mr!==3?8:12;for(var kr=0;kr<oe;++kr)pe.readBoolean()&&(kr<6?$.skipScalingList(pe,16):$.skipScalingList(pe,64))}}pe.skipUEG();var ti=pe.readUEG();if(ti===0)pe.readUEG();else if(ti===1){pe.skipBits(1),pe.skipEG(),pe.skipEG(),w=pe.readUEG();for(var Vi=0;Vi<w;++Vi)pe.skipEG()}if(pe.skipUEG(),pe.skipBits(1),I=pe.readUEG(),W=pe.readUEG(),(Y=pe.readBits(1))===0&&pe.skipBits(1),pe.skipBits(1),pe.readBoolean()&&(Oe=pe.readUEG(),et=pe.readUEG(),pt=pe.readUEG(),sn=pe.readUEG()),pe.readBoolean()){if(pe.readBoolean()){var Bn;switch(pe.readUByte()){case 1:Bn=[1,1];break;case 2:Bn=[12,11];break;case 3:Bn=[10,11];break;case 4:Bn=[16,11];break;case 5:Bn=[40,33];break;case 6:Bn=[24,11];break;case 7:Bn=[20,11];break;case 8:Bn=[32,11];break;case 9:Bn=[80,33];break;case 10:Bn=[18,11];break;case 11:Bn=[15,11];break;case 12:Bn=[64,33];break;case 13:Bn=[160,99];break;case 14:Bn=[4,3];break;case 15:Bn=[3,2];break;case 16:Bn=[2,1];break;case 255:Bn=[pe.readUByte()<<8|pe.readUByte(),pe.readUByte()<<8|pe.readUByte()]}Bn&&(kn=Bn[0]/Bn[1])}pe.readBoolean()&&pe.skipBits(1),pe.readBoolean()&&(pe.skipBits(4),pe.readBoolean()&&pe.skipBits(24)),pe.readBoolean()&&(pe.skipUEG(),pe.skipUEG()),pe.readBoolean()&&(pe.readUInt(),pe.readUInt(),pe.readBoolean())}return{width:Math.ceil((16*(I+1)-2*Oe-2*et)*kn),height:(2-Y)*(W+1)*16-(Y?2:4)*(pt+sn)}}}]),l()($,[{key:"parseSPS",value:function(A){var y=$.readSPS(new Uint8Array(A));this.track.width=y.width,this.track.height=y.height,this.track.sps=[new Uint8Array(A)],this.track.codec="avc1.";for(var w=new DataView(A.buffer,A.byteOffset+1,4),I=0;I<3;++I){var W=w.getUint8(I).toString(16);W.length<2&&(W="0"+W),this.track.codec+=W}}},{key:"parsePPS",value:function(A){this.track.pps=[new Uint8Array(A)]}},{key:"parseNAL",value:function(A){if(!A)return!1;var y=!1;switch(A.type()){case dt.NDR:case dt.IDR:y=!0;break;case dt.PPS:this.track.pps||(this.parsePPS(A.getData().subarray(4)),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),y=!0;break;case dt.SPS:this.track.sps||(this.parseSPS(A.getData().subarray(4)),!this.remuxer.readyToDecode&&this.track.pps&&this.track.sps&&(this.remuxer.readyToDecode=!0)),y=!0;break;case dt.AUD:vt("AUD - ignoing and disable HD mode for live channel"),this.remuxer.isHDAvail&&(this.remuxer.isHDAvail=!1);break;case dt.SEI:vt("SEI - ignoing")}return y}}]),$}(),Kt=function(){function $(A){s()(this,$),this.listener={},this.type=""|A}return l()($,[{key:"on",value:function(A,y){return this.listener[A]||(this.listener[A]=[]),this.listener[A].push(y),!0}},{key:"off",value:function(A,y){if(this.listener[A]){var w=this.listener[A].indexOf(y);return w>-1&&this.listener[A].splice(w,1),!0}return!1}},{key:"offAll",value:function(){this.listener={}}},{key:"dispatch",value:function(A,y){return!!this.listener[A]&&(this.listener[A].map(function(w){w.apply(null,[y])}),!0)}}]),$}(),Vt=Math.pow(2,32)-1,Ft=function(){function $(){s()(this,$)}return l()($,null,[{key:"init",value:function(){var A;for(A in $.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},$.types)$.types.hasOwnProperty(A)&&($.types[A]=[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]);var y=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),w=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);$.HDLR_TYPES={video:y,audio:w};var I=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),W=new Uint8Array([0,0,0,0,0,0,0,0]);$.STTS=$.STSC=$.STCO=W,$.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),$.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),$.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),$.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var Y=new Uint8Array([105,115,111,109]),oe=new Uint8Array([97,118,99,49]),pe=new Uint8Array([0,0,0,1]);$.FTYP=$.box($.types.ftyp,Y,pe,Y,oe),$.DINF=$.box($.types.dinf,$.box($.types.dref,I))}},{key:"box",value:function(A){for(var y=arguments.length,w=new Array(y>1?y-1:0),I=1;I<y;I++)w[I-1]=arguments[I];for(var W,Y=8,oe=w.length,pe=oe;oe--;)Y+=w[oe].byteLength;for((W=new Uint8Array(Y))[0]=Y>>24&255,W[1]=Y>>16&255,W[2]=Y>>8&255,W[3]=255&Y,W.set(A,4),oe=0,Y=8;oe<pe;++oe)W.set(w[oe],Y),Y+=w[oe].byteLength;return W}},{key:"hdlr",value:function(A){return $.box($.types.hdlr,$.HDLR_TYPES[A])}},{key:"mdat",value:function(A){return $.box($.types.mdat,A)}},{key:"mdhd",value:function(A,y){y*=A;var w=Math.floor(y/(Vt+1)),I=Math.floor(y%(Vt+1));return $.box($.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,255&A,w>>24,w>>16&255,w>>8&255,255&w,I>>24,I>>16&255,I>>8&255,255&I,85,196,0,0]))}},{key:"mdia",value:function(A){return $.box($.types.mdia,$.mdhd(A.timescale,A.duration),$.hdlr(A.type),$.minf(A))}},{key:"mfhd",value:function(A){return $.box($.types.mfhd,new Uint8Array([0,0,0,0,A>>24,A>>16&255,A>>8&255,255&A]))}},{key:"minf",value:function(A){return A.type==="audio"?$.box($.types.minf,$.box($.types.smhd,$.SMHD),$.DINF,$.stbl(A)):$.box($.types.minf,$.box($.types.vmhd,$.VMHD),$.DINF,$.stbl(A))}},{key:"moof",value:function(A,y,w){return $.box($.types.moof,$.mfhd(A),$.traf(w,y))}},{key:"moov",value:function(A,y,w){for(var I=A.length,W=[];I--;)W[I]=$.trak(A[I]);return $.box.apply(null,[$.types.moov,$.mvhd(w,y)].concat(W).concat($.mvex(A)))}},{key:"mvex",value:function(A){for(var y=A.length,w=[];y--;)w[y]=$.trex(A[y]);return $.box.apply(null,[$.types.mvex].concat(w))}},{key:"mvhd",value:function(A,y){y*=A;var w=Math.floor(y/(Vt+1)),I=Math.floor(y%(Vt+1)),W=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,255&A,w>>24,w>>16&255,w>>8&255,255&w,I>>24,I>>16&255,I>>8&255,255&I,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return $.box($.types.mvhd,W)}},{key:"sdtp",value:function(A){var y,w,I=A.samples||[],W=new Uint8Array(4+I.length);for(w=0;w<I.length;w++)y=I[w].flags,W[w+4]=y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy;return $.box($.types.sdtp,W)}},{key:"stbl",value:function(A){return $.box($.types.stbl,$.stsd(A),$.box($.types.stts,$.STTS),$.box($.types.stsc,$.STSC),$.box($.types.stsz,$.STSZ),$.box($.types.stco,$.STCO))}},{key:"avc1",value:function(A){var y,w,I,W=[],Y=[];for(y=0;y<A.sps.length;y++)I=(w=A.sps[y]).byteLength,W.push(I>>>8&255),W.push(255&I),W=W.concat(Array.prototype.slice.call(w));for(y=0;y<A.pps.length;y++)I=(w=A.pps[y]).byteLength,Y.push(I>>>8&255),Y.push(255&I),Y=Y.concat(Array.prototype.slice.call(w));var oe=$.box($.types.avcC,new Uint8Array([1,W[3],W[4],W[5],255,224|A.sps.length].concat(W).concat([A.pps.length]).concat(Y))),pe=A.width,Oe=A.height;return $.box($.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,pe>>8&255,255&pe,Oe>>8&255,255&Oe,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,98,105,110,101,108,112,114,111,46,114,117,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),oe,$.box($.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(A){var y=A.config.byteLength,w=new Uint8Array(26+y+3);return w.set([0,0,0,0,3,23+y,0,1,0,4,15+y,64,21,0,0,0,0,0,0,0,0,0,0,0,5,y]),w.set(A.config,26),w.set([6,1,2],26+y),w}},{key:"mp4a",value:function(A){var y=A.audiosamplerate;return $.box($.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,A.channelCount,0,16,0,0,0,0,y>>8&255,255&y,0,0]),$.box($.types.esds,$.esds(A)))}},{key:"stsd",value:function(A){return A.type==="audio"?$.box($.types.stsd,$.STSD,$.mp4a(A)):$.box($.types.stsd,$.STSD,$.avc1(A))}},{key:"tkhd",value:function(A){var y=A.id,w=A.duration*A.timescale,I=A.width,W=A.height,Y=Math.floor(w/(Vt+1)),oe=Math.floor(w%(Vt+1));return $.box($.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,y>>24&255,y>>16&255,y>>8&255,255&y,0,0,0,0,Y>>24,Y>>16&255,Y>>8&255,255&Y,oe>>24,oe>>16&255,oe>>8&255,255&oe,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,I>>8&255,255&I,0,0,W>>8&255,255&W,0,0]))}},{key:"traf",value:function(A,y){var w=$.sdtp(A),I=A.id,W=Math.floor(y/(Vt+1)),Y=Math.floor(y%(Vt+1));return $.box($.types.traf,$.box($.types.tfhd,new Uint8Array([0,0,0,0,I>>24,I>>16&255,I>>8&255,255&I])),$.box($.types.tfdt,new Uint8Array([1,0,0,0,W>>24,W>>16&255,W>>8&255,255&W,Y>>24,Y>>16&255,Y>>8&255,255&Y])),$.trun(A,w.length+16+20+8+16+8+8),w)}},{key:"trak",value:function(A){return A.duration=A.duration||4294967295,$.box($.types.trak,$.tkhd(A),$.mdia(A))}},{key:"trex",value:function(A){var y=A.id;return $.box($.types.trex,new Uint8Array([0,0,0,0,y>>24,y>>16&255,y>>8&255,255&y,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(A,y){var w,I,W,Y,oe,pe,Oe=A.samples||[],et=Oe.length,pt=12+16*et,sn=new Uint8Array(pt);for(y+=8+pt,sn.set([0,0,15,1,et>>>24&255,et>>>16&255,et>>>8&255,255&et,y>>>24&255,y>>>16&255,y>>>8&255,255&y],0),w=0;w<et;w++)W=(I=Oe[w]).duration,Y=I.size,oe=I.flags,pe=I.cts,sn.set([W>>>24&255,W>>>16&255,W>>>8&255,255&W,Y>>>24&255,Y>>>16&255,Y>>>8&255,255&Y,oe.isLeading<<2|oe.dependsOn,oe.isDependedOn<<6|oe.hasRedundancy<<4|oe.paddingValue<<1|oe.isNonSync,61440&oe.degradPrio,15&oe.degradPrio,pe>>>24&255,pe>>>16&255,pe>>>8&255,255&pe],12+16*w);return $.box($.types.trun,sn)}},{key:"initSegment",value:function(A,y,w){$.types||$.init();var I,W=$.moov(A,y,w);return(I=new Uint8Array($.FTYP.byteLength+W.byteLength)).set($.FTYP),I.set(W,$.FTYP.byteLength),I}}]),$}(),Pe=function(){function $(A){s()(this,$),this.remuxer=A,this.track=A.mp4track,this.aacHeader=null}return l()($,[{key:"getHeaderLength",value:function(A){return 1&A[1]?7:9}},{key:"getFrameLength",value:function(A){return(3&A[3])<<11|A[4]<<3|(224&A[5])>>>5}},{key:"isAACPattern",value:function(A){return A[0]===255&&(240&A[1])==240&&(6&A[1])==0}},{key:"extractAAC",value:function(A){var y,w,I=0,W=A.byteLength,Y=[];if(!this.isAACPattern(A))return bt("Invalid ADTS audio format"),Y;for(y=this.getHeaderLength(A),this.aacHeader||(this.aacHeader=A.subarray(0,y));I<W;)w=this.getFrameLength(A),Y.push(A.subarray(y,w)),A=A.slice(w),I+=w;return Y}},{key:"samplingRateMap",get:function(){return[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]}},{key:"getAACHeaderData",get:function(){return this.aacHeader}},{key:"setAACHeaderData",set:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.aacHeader=A}}]),l()($,[{key:"setAACConfig",value:function(){var A,y,w,I=new Uint8Array(2),W=this.getAACHeaderData;W&&(A=1+((192&W[2])>>>6),y=(60&W[2])>>>2,w=(1&W[2])<<2,w|=(192&W[3])>>>6,I[0]=A<<3,I[0]|=(14&y)>>1,I[1]|=(1&y)<<7,I[1]|=w<<3,this.track.codec="mp4a.40."+A,this.track.channelCount=w,this.track.config=I,this.remuxer.readyToDecode=!0)}}]),$}(),Je=1,ot=function(){function $(){s()(this,$),this.seq=1}return l()($,null,[{key:"getTrackID",value:function(){return Je++}}]),l()($,[{key:"flush",value:function(){this.seq++,this.mp4track.len=0,this.mp4track.samples=[]}},{key:"isReady",value:function(){return!(!this.readyToDecode||!this.samples.length)||null}}]),$}(),wt=function($){function A(){var y;return s()(this,A),(y=c()(this,h()(A).call(this))).readyToDecode=!1,y.nextDts=0,y.dts=0,y.timescale=1e3,y.mp4track={id:ot.getTrackID(),type:"audio",channelCount:0,len:0,fragmented:!0,timescale:y.timescale,duration:y.timescale,samples:[],config:"",codec:""},y.samples=[],y.aac=new Pe(p()(y)),y}return g()(A,$),l()(A,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.codec="",this.mp4track.channelCount="",this.mp4track.config="",this.mp4track.timescale=this.timescale}},{key:"remux",value:function(y){var w,I,W=!0,Y=!1,oe=void 0;try{for(var pe,Oe=y[Symbol.iterator]();!(W=(pe=Oe.next()).done);W=!0){var et=pe.value;w=(I=et.units).byteLength,this.samples.push({units:I,size:w,duration:et.duration}),this.mp4track.len+=w,this.readyToDecode||this.aac.setAACConfig()}}catch(pt){Y=!0,oe=pt}finally{try{W||Oe.return==null||Oe.return()}finally{if(Y)throw oe}}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var y,w,I=new Uint8Array(this.mp4track.len),W=0,Y=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var oe=this.samples.shift();(w=oe.duration)<=0?(vt("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(w)),this.mp4track.len-=oe.size):(this.nextDts+=w,y={size:oe.size,duration:w,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},I.set(oe.units,W),W+=oe.size,Y.push(y))}return Y.length?new Uint8Array(I.buffer,0,this.mp4track.len):null}}]),A}(ot),Bt=function($){function A(){var y;return s()(this,A),(y=c()(this,h()(A).call(this))).readyToDecode=!1,y.nextDts=0,y.dts=0,y.timescale=1e3,y.mp4track={id:ot.getTrackID(),type:"video",len:0,fragmented:!0,sps:"",pps:"",width:0,height:0,timescale:y.timescale,duration:y.timescale,samples:[]},y.samples=[],y.h264=new Ct(p()(y)),y}return g()(A,$),l()(A,[{key:"resetTrack",value:function(){this.readyToDecode=!1,this.mp4track.sps="",this.mp4track.pps=""}},{key:"remux",value:function(y){var w,I,W,Y,oe,pe=!0,Oe=!1,et=void 0;try{for(var pt,sn=y[Symbol.iterator]();!(pe=(pt=sn.next()).done);pe=!0){w=pt.value,I=[],Y=0,oe=!1;var kn=!0,Mr=!1,kr=void 0;try{for(var ti,Vi=w.units[Symbol.iterator]();!(kn=(ti=Vi.next()).done);kn=!0)W=ti.value,this.h264.parseNAL(W)&&(I.push(W),Y+=W.getSize(),oe||(oe=W.isKeyframe()))}catch(Bn){Mr=!0,kr=Bn}finally{try{kn||Vi.return==null||Vi.return()}finally{if(Mr)throw kr}}I.length>0&&this.readyToDecode&&(this.mp4track.len+=Y,this.samples.push({units:I,size:Y,keyFrame:oe,duration:w.duration}))}}catch(Bn){Oe=!0,et=Bn}finally{try{pe||sn.return==null||sn.return()}finally{if(Oe)throw et}}}},{key:"getPayload",value:function(){if(!this.isReady())return null;var y,w,I=new Uint8Array(this.mp4track.len),W=0,Y=this.mp4track.samples;for(this.dts=this.nextDts;this.samples.length;){var oe=this.samples.shift(),pe=oe.units;if((w=oe.duration)<=0)vt("remuxer: invalid sample duration at DTS: ".concat(this.nextDts," :").concat(w)),this.mp4track.len-=oe.size;else{this.nextDts+=w,y={size:oe.size,duration:w,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:oe.keyFrame?0:1,dependsOn:oe.keyFrame?2:1}};var Oe=!0,et=!1,pt=void 0;try{for(var sn,kn=pe[Symbol.iterator]();!(Oe=(sn=kn.next()).done);Oe=!0){var Mr=sn.value;I.set(Mr.getData(),W),W+=Mr.getSize()}}catch(kr){et=!0,pt=kr}finally{try{Oe||kn.return==null||kn.return()}finally{if(et)throw pt}}Y.push(y)}}return Y.length?new Uint8Array(I.buffer,0,this.mp4track.len):null}}]),A}(ot);function Ln($,A){var y=new Uint8Array((0|$.byteLength)+(0|A.byteLength));return y.set($,0),y.set(A,0|$.byteLength),y}var lr=function($){function A(y){var w;return s()(this,A),(w=c()(this,h()(A).call(this,"remuxer"))).initialized=!1,w.trackTypes=[],w.tracks={},w.mediaDuration=y?1/0:1e3,w}return g()(A,$),l()(A,[{key:"addTrack",value:function(y){y!=="video"&&y!=="both"||(this.tracks.video=new Bt,this.trackTypes.push("video")),y!=="audio"&&y!=="both"||(this.tracks.audio=new wt,this.trackTypes.push("audio"))}},{key:"reset",value:function(){var y=!0,w=!1,I=void 0;try{for(var W,Y=this.trackTypes[Symbol.iterator]();!(y=(W=Y.next()).done);y=!0){var oe=W.value;this.tracks[oe].resetTrack()}}catch(pe){w=!0,I=pe}finally{try{y||Y.return==null||Y.return()}finally{if(w)throw I}}this.initialized=!1}},{key:"destroy",value:function(){this.tracks={},this.offAll()}},{key:"flush",value:function(){if(this.initialized){var y=!0,w=!1,I=void 0;try{for(var W,Y=this.trackTypes[Symbol.iterator]();!(y=(W=Y.next()).done);y=!0){var oe=W.value,pe=this.tracks[oe],Oe=pe.getPayload();if(Oe&&Oe.byteLength){var et={type:oe,payload:Ln(Ft.moof(pe.seq,pe.dts,pe.mp4track),Ft.mdat(Oe)),dts:pe.dts};this.dispatch("buffer",et);var pt=(pc=pe.dts/1e3,ms=void 0,vv=void 0,mx=void 0,gx=void 0,gx="",ms=Math.floor(pc),(vv=parseInt(ms/3600,10)%24)>0&&(gx+=(vv<10?"0"+vv:vv)+":"),gx+=((mx=parseInt(ms/60,10)%60)<10?"0"+mx:mx)+":"+((ms=ms<0?0:ms%60)<10?"0"+ms:ms));vt("put segment (".concat(oe,"): ").concat(pe.seq," dts: ").concat(pe.dts," samples: ").concat(pe.mp4track.samples.length," second: ").concat(pt)),pe.flush()}}}catch(LC){w=!0,I=LC}finally{try{y||Y.return==null||Y.return()}finally{if(w)throw I}}}else if(this.isReady()){this.dispatch("ready");var sn=!0,kn=!1,Mr=void 0;try{for(var kr,ti=this.trackTypes[Symbol.iterator]();!(sn=(kr=ti.next()).done);sn=!0){var Vi=kr.value,Bn=this.tracks[Vi],Hf={type:Vi,payload:Ft.initSegment([Bn.mp4track],this.mediaDuration,Bn.mp4track.timescale)};this.dispatch("buffer",Hf)}}catch(LC){kn=!0,Mr=LC}finally{try{sn||ti.return==null||ti.return()}finally{if(kn)throw Mr}}vt("Initial segment generated."),this.initialized=!0}var pc,ms,vv,mx,gx}},{key:"isReady",value:function(){var y=!0,w=!1,I=void 0;try{for(var W,Y=this.trackTypes[Symbol.iterator]();!(y=(W=Y.next()).done);y=!0){var oe=W.value;if(!this.tracks[oe].readyToDecode||!this.tracks[oe].samples.length)return!1}}catch(pe){w=!0,I=pe}finally{try{y||Y.return==null||Y.return()}finally{if(w)throw I}}return!0}},{key:"remux",value:function(y){var w=!0,I=!1,W=void 0;try{for(var Y,oe=this.trackTypes[Symbol.iterator]();!(w=(Y=oe.next()).done);w=!0){var pe=Y.value,Oe=y[pe];pe==="audio"&&this.tracks.video&&!this.tracks.video.readyToDecode||Oe.length>0&&this.tracks[pe].remux(Oe)}}catch(et){I=!0,W=et}finally{try{w||oe.return==null||oe.return()}finally{if(I)throw W}}this.flush()}}]),A}(Kt),Xr=function($){function A(y,w){var I;return s()(this,A),(I=c()(this,h()(A).call(this,"buffer"))).type=w,I.queue=new Uint8Array,I.cleaning=!1,I.pendingCleaning=0,I.cleanOffset=30,I.cleanRanges=[],I.sourceBuffer=y,I.sourceBuffer.addEventListener("updateend",function(){I.dispatch("updateend",Date.now()),I.pendingCleaning>0&&(I.initCleanup(I.pendingCleaning),I.pendingCleaning=0),I.cleaning=!1,I.cleanRanges.length&&I.doCleanup()}),I.sourceBuffer.addEventListener("error",function(W){I.dispatch("error",{type:I.type,name:"buffer",error:W})}),I}return g()(A,$),l()(A,[{key:"destroy",value:function(){this.queue=null,this.sourceBuffer=null,this.offAll()}},{key:"doCleanup",value:function(){if(this.cleanRanges.length){var y=this.cleanRanges.shift();vt("".concat(this.type," remove range [").concat(y[0]," - ").concat(y[1],")")),this.cleaning=!0,this.sourceBuffer.remove(y[0],y[1]),this.dispatch("clearBuffer")}else this.cleaning=!1}},{key:"initCleanup",value:function(y){if(this.sourceBuffer.updating)this.pendingCleaning=y;else if(this.sourceBuffer.buffered&&this.sourceBuffer.buffered.length&&!this.cleaning){for(var w=0;w<this.sourceBuffer.buffered.length;++w){var I=this.sourceBuffer.buffered.start(w),W=this.sourceBuffer.buffered.end(w);y-I>this.cleanOffset&&I<(W=y-this.cleanOffset)&&this.cleanRanges.push([I,W])}this.doCleanup()}}},{key:"doAppend",value:function(){if(this.queue.length&&!this.sourceBuffer.updating)try{this.sourceBuffer.appendBuffer(this.queue),this.queue=new Uint8Array}catch(y){if(y.name==="QuotaExceededError")return vt("".concat(this.type," buffer quota full")),void this.dispatch("error",{type:this.type,name:"QuotaExceeded",error:"buffer error"});bt("Error occured while appending ".concat(this.type," buffer -  ").concat(y.name,": ").concat(y.message)),this.dispatch("error",{type:this.type,name:"unexpectedError",error:"buffer error"})}}},{key:"feed",value:function(y){this.queue=Ln(this.queue,y)}}]),A}(Kt);window.MediaSource=window.MediaSource||window.WebKitMediaSource;var Ca=function($){function A(y){var w;if(s()(this,A),w=c()(this,h()(A).call(this,"jmuxer")),window.MediaSource=window.MediaSource||window.WebKitMediaSource,w.options=Object.assign({},{node:"",mode:"both",flushingTime:1500,clearBuffer:!0,onReady:null,fps:30,debug:!1,onClearBuffer:null},y),w.options.debug&&(ne=console.log,Z=console.error),typeof w.options.node=="string"&&w.options.node==""&&bt("no video element were found to render, provide a valid video element"),w.options.fps||(w.options.fps=30),w.frameDuration=1e3/w.options.fps|0,w.node=typeof w.options.node=="string"?document.getElementById(w.options.node):w.options.node,w.sourceBuffers={},w.isMSESupported=!!window.MediaSource,!w.isMSESupported)throw"Oops! Browser does not support media source extension.";return w.setupMSE(),w.remuxController=new lr(w.options.clearBuffer),w.remuxController.addTrack(w.options.mode),w.options.mode==="audio"&&(w.aacParser=w.remuxController.tracks.audio.aac),w.mseReady=!1,w.lastCleaningTime=Date.now(),w.keyframeCache=[],w.frameCounter=0,w.remuxController.on("buffer",w.onBuffer.bind(p()(w))),w.remuxController.on("ready",w.createBuffer.bind(p()(w))),w.startInterval(),w}return g()(A,$),l()(A,null,[{key:"isSupported",value:function(y){return window.MediaSource&&window.MediaSource.isTypeSupported(y)}}]),l()(A,[{key:"setupMSE",value:function(){this.mediaSource=new MediaSource,this.node.src=URL.createObjectURL(this.mediaSource),this.mediaSource.addEventListener("sourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("sourceclose",this.onMSEClose.bind(this)),this.mediaSource.addEventListener("webkitsourceopen",this.onMSEOpen.bind(this)),this.mediaSource.addEventListener("webkitsourceclose",this.onMSEClose.bind(this))}},{key:"feed",value:function(y){var w,I,W,Y=!1,oe={video:[],audio:[]};y&&this.remuxController&&(W=y.duration?parseInt(y.duration):0,y.video&&(w=Ct.extractNALu(y.video)).length>0&&(oe.video=this.getVideoFrames(w,W),Y=!0),y.audio&&(I=this.aacParser.extractAAC(y.audio)).length>0&&(oe.audio=this.getAudioFrames(I,W),Y=!0),Y?this.remuxController.remux(oe):bt("Input object must have video and/or audio property. Make sure it is not empty and valid typed array"))}},{key:"getVideoFrames",value:function(y,w){var I,W,Y,oe=[],pe=[],Oe=0,et=[],pt=!0,sn=!1,kn=void 0;try{for(var Mr,kr=y[Symbol.iterator]();!(pt=(Mr=kr.next()).done);pt=!0)I=Mr.value,W=new dt(I),oe.push(W),W.type()!==dt.IDR&&W.type()!==dt.NDR||(pe.push({units:oe}),oe=[],this.options.clearBuffer&&(W.type()===dt.IDR&&et.push(this.frameCounter),this.frameCounter++))}catch(ti){sn=!0,kn=ti}finally{try{pt||kr.return==null||kr.return()}finally{if(sn)throw kn}}return w?(Y=w/pe.length|0,Oe=w-Y*pe.length):Y=this.frameDuration,pe.map(function(ti){ti.duration=Oe>0?Y+1:Y,Oe!==0&&Oe--}),this.options.clearBuffer&&(et=et.map(function(ti){return ti*Y/1e3}),this.keyframeCache=this.keyframeCache.concat(et)),pe}},{key:"getAudioFrames",value:function(y,w){var I,W,Y=[],oe=0,pe=!0,Oe=!1,et=void 0;try{for(var pt,sn=y[Symbol.iterator]();!(pe=(pt=sn.next()).done);pe=!0)I=pt.value,Y.push({units:I})}catch(kn){Oe=!0,et=kn}finally{try{pe||sn.return==null||sn.return()}finally{if(Oe)throw et}}return w?(W=w/Y.length|0,oe=w-W*Y.length):W=this.frameDuration,Y.map(function(kn){kn.duration=oe>0?W+1:W,oe!==0&&oe--}),Y}},{key:"destroy",value:function(){if(this.aacParser=null,this.stopInterval(),this.mediaSource){try{this.bufferControllers&&(this.mediaSource.endOfStream(),this.removeSourceBuffer())}catch(w){bt("mediasource is not available to end ".concat(w.message))}this.mediaSource=null}if(this.remuxController&&(this.remuxController.destroy(),this.remuxController=null),this.bufferControllers){for(var y in this.bufferControllers)this.bufferControllers[y].destroy();this.bufferControllers=null}this.node=!1,this.mseReady=!1,this.videoStarted=!1}},{key:"createBuffer",value:function(){if(this.mseReady&&this.remuxController&&this.remuxController.isReady()&&!this.bufferControllers)for(var y in this.bufferControllers={},this.remuxController.tracks){var w=this.remuxController.tracks[y];if(!A.isSupported("".concat(y,'/mp4; codecs="').concat(w.mp4track.codec,'"')))return bt("Browser does not support codec"),!1;var I=this.mediaSource.addSourceBuffer("".concat(y,'/mp4; codecs="').concat(w.mp4track.codec,'"'));this.bufferControllers[y]=new Xr(I,y),this.sourceBuffers[y]=I,this.bufferControllers[y].on("error",this.onBufferError.bind(this)),this.bufferControllers[y].on("clearBuffer",this.onClearBuffer.bind(this)),this.bufferControllers[y].on("updateend",this.onUpdateEnd.bind(this))}}},{key:"onUpdateEnd",value:function(y){typeof this.options.onUpdateEnd=="function"&&this.options.onUpdateEnd(y)}},{key:"startInterval",value:function(){var y=this;this.interval=setInterval(function(){y.bufferControllers&&(y.releaseBuffer(),y.clearBuffer())},this.options.flushingTime)}},{key:"stopInterval",value:function(){this.interval&&clearInterval(this.interval)}},{key:"releaseBuffer",value:function(){for(var y in this.bufferControllers)this.bufferControllers[y].doAppend()}},{key:"getSafeBufferClearLimit",value:function(y){for(var w,I=this.options.mode==="audio"&&y||0,W=0;W<this.keyframeCache.length&&!(this.keyframeCache[W]>=y);W++)w=this.keyframeCache[W];return w&&(this.keyframeCache=this.keyframeCache.filter(function(Y){return Y<w&&(I=Y),Y>=w})),I}},{key:"clearBuffer",value:function(){if(this.options.clearBuffer&&Date.now()-this.lastCleaningTime>1e4){for(var y in this.bufferControllers){var w=this.getSafeBufferClearLimit(this.node.currentTime);this.bufferControllers[y].initCleanup(w)}this.lastCleaningTime=Date.now()}}},{key:"onBuffer",value:function(y){this.bufferControllers&&this.bufferControllers[y.type]&&this.bufferControllers[y.type].feed(y.payload)}},{key:"onClearBuffer",value:function(){typeof this.options.onClearBuffer=="function"&&this.options.onClearBuffer()}},{key:"removeSourceBuffer",value:function(){if(this.mediaSource){var y=this.sourceBuffers;for(var w in y)this.mediaSource.removeSourceBuffer(y[w])}}},{key:"onMSEOpen",value:function(){this.mseReady=!0,this.createBuffer(),typeof this.options.onReady=="function"&&(this.options.onReady(),this.options.onReady=null)}},{key:"onMSEClose",value:function(){this.mseReady=!1,this.videoStarted=!1}},{key:"onBufferError",value:function(y){if(y.name!="QuotaExceeded"){if(this.mediaSource.sourceBuffers.length>0&&this.sourceBuffers[y.type]&&this.mediaSource.removeSourceBuffer(this.sourceBuffers[y.type]),this.mediaSource.sourceBuffers.length==0)try{this.mediaSource.endOfStream()}catch{bt("mediasource is not available to end")}}else this.bufferControllers[y.type].initCleanup(this.node.currentTime)}}]),A}(Kt),tr=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"source",[]),_()(p()(w),"onPlay",void 0),w.source=y.source,w.onPlay=y.onPlay,w.init(),w}return g()(A,$),l()(A,[{key:"init",value:function(){}},{key:"extract",value:function(y,w){for(var I=this.provide(w),W=0;W<I.size;W++)y[2*W]=I.left[W],y[2*W+1]=I.right[W];return I.size}},{key:"provide",value:function(y){for(var w=y,I=new Float32Array(w),W=new Float32Array(w),Y=0,oe=0,pe=0;this.source.length>0;){var Oe=this.source.shift(),et=Oe.loadedPosition||0;oe=Oe.startTime+Oe.duration*et/Oe.length;var pt=Math.min(Oe.length-et,w-Y),sn=Oe.getChannelData(0),kn=Oe.numberOfChannels>1?Oe.getChannelData(1):Oe.getChannelData(0);if(I.set(sn.slice(et,et+pt),Y),W.set(kn.slice(et,et+pt),Y),pe+=pt,Y+=pt,(et+=pt)<Oe.length){Oe.loadedPosition=et,this.source.unshift(Oe);break}}return this.onPlay&&this.onPlay(oe),{left:I,right:W,size:pe}}}]),A}(J);function Fr($,A){if(!($ instanceof A))throw new TypeError("Cannot call a class as a function")}function hi($,A){for(var y=0;y<A.length;y++){var w=A[y];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty($,w.key,w)}}function ii($,A,y){return A&&hi($.prototype,A),y&&hi($,y),$}function zt($,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");$.prototype=Object.create(A&&A.prototype,{constructor:{value:$,writable:!0,configurable:!0}}),A&&za($,A)}function it($){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(A){return A.__proto__||Object.getPrototypeOf(A)})($)}function za($,A){return(za=Object.setPrototypeOf||function(y,w){return y.__proto__=w,y})($,A)}function he($,A){return!A||N()(A)!=="object"&&typeof A!="function"?function(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}($):A}function Fe($,A,y){return(Fe=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(w,I,W){var Y=function(pe,Oe){for(;!Object.prototype.hasOwnProperty.call(pe,Oe)&&(pe=it(pe))!==null;);return pe}(w,I);if(Y){var oe=Object.getOwnPropertyDescriptor(Y,I);return oe.get?oe.get.call(W):oe.value}})($,A,y||$)}var Ye=function(){function $(){Fr(this,$),this._vector=new Float32Array,this._position=0,this._frameCount=0}return ii($,[{key:"clear",value:function(){this.receive(this._frameCount),this.rewind()}},{key:"put",value:function(A){this._frameCount+=A}},{key:"putSamples",value:function(A,y){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,I=2*(y=y||0);w>=0||(w=(A.length-I)/2);var W=2*w;this.ensureCapacity(w+this._frameCount);var Y=this.endIndex;this.vector.set(A.subarray(I,I+W),Y),this._frameCount+=w}},{key:"putBuffer",value:function(A,y){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;y=y||0,w>=0||(w=A.frameCount-y),this.putSamples(A.vector,A.position+y,w)}},{key:"receive",value:function(A){A>=0&&!(A>this._frameCount)||(A=this.frameCount),this._frameCount-=A,this._position+=A}},{key:"receiveSamples",value:function(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=2*y,I=this.startIndex;A.set(this._vector.subarray(I,I+w)),this.receive(y)}},{key:"extract",value:function(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,I=this.startIndex+2*y,W=2*w;A.set(this._vector.subarray(I,I+W))}},{key:"ensureCapacity",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=parseInt(2*A);if(this._vector.length<y){var w=new Float32Array(y);w.set(this._vector.subarray(this.startIndex,this.endIndex)),this._vector=w,this._position=0}else this.rewind()}},{key:"ensureAdditionalCapacity",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.ensureCapacity(this._frameCount+A)}},{key:"rewind",value:function(){this._position>0&&(this._vector.set(this._vector.subarray(this.startIndex,this.endIndex)),this._position=0)}},{key:"vector",get:function(){return this._vector}},{key:"position",get:function(){return this._position}},{key:"startIndex",get:function(){return 2*this._position}},{key:"frameCount",get:function(){return this._frameCount}},{key:"endIndex",get:function(){return 2*(this._position+this._frameCount)}}]),$}(),ze=function(){function $(A){Fr(this,$),A?(this._inputBuffer=new Ye,this._outputBuffer=new Ye):this._inputBuffer=this._outputBuffer=null}return ii($,[{key:"clear",value:function(){this._inputBuffer.clear(),this._outputBuffer.clear()}},{key:"inputBuffer",get:function(){return this._inputBuffer},set:function(A){this._inputBuffer=A}},{key:"outputBuffer",get:function(){return this._outputBuffer},set:function(A){this._outputBuffer=A}}]),$}(),tt=function($){function A(y){var w;return Fr(this,A),(w=he(this,it(A).call(this,y))).reset(),w._rate=1,w}return zt(A,$),ii(A,[{key:"reset",value:function(){this.slopeCount=0,this.prevSampleL=0,this.prevSampleR=0}},{key:"clone",value:function(){var y=new A;return y.rate=this._rate,y}},{key:"process",value:function(){var y=this._inputBuffer.frameCount;this._outputBuffer.ensureAdditionalCapacity(y/this._rate+1);var w=this.transpose(y);this._inputBuffer.receive(),this._outputBuffer.put(w)}},{key:"transpose",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(y===0)return 0;for(var w=this._inputBuffer.vector,I=this._inputBuffer.startIndex,W=this._outputBuffer.vector,Y=this._outputBuffer.endIndex,oe=0,pe=0;this.slopeCount<1;)W[Y+2*pe]=(1-this.slopeCount)*this.prevSampleL+this.slopeCount*w[I],W[Y+2*pe+1]=(1-this.slopeCount)*this.prevSampleR+this.slopeCount*w[I+1],pe+=1,this.slopeCount+=this._rate;if(this.slopeCount-=1,y!==1)e:for(;;){for(;this.slopeCount>1;)if(this.slopeCount-=1,(oe+=1)>=y-1)break e;var Oe=I+2*oe;W[Y+2*pe]=(1-this.slopeCount)*w[Oe]+this.slopeCount*w[Oe+2],W[Y+2*pe+1]=(1-this.slopeCount)*w[Oe+1]+this.slopeCount*w[Oe+3],pe+=1,this.slopeCount+=this._rate}return this.prevSampleL=w[I+2*y-2],this.prevSampleR=w[I+2*y-1],pe}},{key:"rate",set:function(y){this._rate=y}}]),A}(ze),Gt=function(){function $(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1024;Fr(this,$),this._pipe=A,this.inputSize=y}return ii($,[{key:"fillInputBuffer",value:function(){throw new Error("fillInputBuffer() not overridden")}},{key:"fillOutputBuffer",value:function(){for(var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,y=this.inputSize;this.outputBuffer.frameCount<A;){var w=y-this.inputBuffer.frameCount;if(this.fillInputBuffer(w),this.inputBuffer.frameCount<y)break;this._pipe.process()}}},{key:"clear",value:function(){this._pipe.clear()}},{key:"pipe",get:function(){return this._pipe}},{key:"inputBuffer",get:function(){return this._pipe.inputBuffer}},{key:"outputBuffer",get:function(){return this._pipe.outputBuffer}}]),$}(),Zt=function(){},fn=function($){function A(y,w){var I,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1024,Y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Zt;return Fr(this,A),(I=he(this,it(A).call(this,w,W))).callback=Y,I.sourceSound=y,I.historyBufferSize=22050,I._sourcePosition=0,I.outputBufferPosition=0,I._position=0,I}return zt(A,$),ii(A,[{key:"onEnd",value:function(){this.callback()}},{key:"fillInputBuffer",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,w=new Float32Array(2*y),I=this.sourceSound.extract(w,y,this._sourcePosition);this._sourcePosition+=I,this.inputBuffer.putSamples(w,0,I)}},{key:"extract",value:function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.fillOutputBuffer(this.outputBufferPosition+w);var I=Math.min(w,this.outputBuffer.frameCount-this.outputBufferPosition);this.outputBuffer.extract(y,this.outputBufferPosition,I);var W=this.outputBufferPosition+I;return this.outputBufferPosition=Math.min(this.historyBufferSize,W),this.outputBuffer.receive(Math.max(W-this.historyBufferSize,0)),this._position+=I,I}},{key:"handleSampleData",value:function(y){this.extract(y.data,4096)}},{key:"clear",value:function(){Fe(it(A.prototype),"clear",this).call(this),this.outputBufferPosition=0}},{key:"position",get:function(){return this._position},set:function(y){if(y>this._position)throw new RangeError("New position may not be greater than current position");var w=this.outputBufferPosition-(this._position-y);if(w<0)throw new RangeError("New position falls outside of history buffer");this.outputBufferPosition=w,this._position=y}},{key:"sourcePosition",get:function(){return this._sourcePosition},set:function(y){this.clear(),this._sourcePosition=y}}]),A}(Gt),hn=[[124,186,248,310,372,434,496,558,620,682,744,806,868,930,992,1054,1116,1178,1240,1302,1364,1426,1488,0],[-100,-75,-50,-25,25,50,75,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-20,-15,-10,-5,5,10,15,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-4,-3,-2,-1,1,2,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],Mn=function($){function A(y){var w;return Fr(this,A),(w=he(this,it(A).call(this,y)))._quickSeek=!0,w.midBufferDirty=!1,w.midBuffer=null,w.overlapLength=0,w.autoSeqSetting=!0,w.autoSeekSetting=!0,w._tempo=1,w.setParameters(44100,0,0,8),w}return zt(A,$),ii(A,[{key:"clear",value:function(){Fe(it(A.prototype),"clear",this).call(this),this.clearMidBuffer()}},{key:"clearMidBuffer",value:function(){this.midBufferDirty&&(this.midBufferDirty=!1,this.midBuffer=null)}},{key:"setParameters",value:function(y,w,I,W){y>0&&(this.sampleRate=y),W>0&&(this.overlapMs=W),w>0?(this.sequenceMs=w,this.autoSeqSetting=!1):this.autoSeqSetting=!0,I>0?(this.seekWindowMs=I,this.autoSeekSetting=!1):this.autoSeekSetting=!0,this.calculateSequenceParameters(),this.calculateOverlapLength(this.overlapMs),this.tempo=this._tempo}},{key:"calculateOverlapLength",value:function(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;y=(y=this.sampleRate*w/1e3)<16?16:y,y-=y%8,this.overlapLength=y,this.refMidBuffer=new Float32Array(2*this.overlapLength),this.midBuffer=new Float32Array(2*this.overlapLength)}},{key:"checkLimits",value:function(y,w,I){return y<w?w:y>I?I:y}},{key:"calculateSequenceParameters",value:function(){var y,w;this.autoSeqSetting&&(y=150+-50*this._tempo,y=this.checkLimits(y,50,125),this.sequenceMs=Math.floor(y+.5)),this.autoSeekSetting&&(w=25- -10/1.5*.5+-10/1.5*this._tempo,w=this.checkLimits(w,15,25),this.seekWindowMs=Math.floor(w+.5)),this.seekWindowLength=Math.floor(this.sampleRate*this.sequenceMs/1e3),this.seekLength=Math.floor(this.sampleRate*this.seekWindowMs/1e3)}},{key:"clone",value:function(){var y=new A;return y.tempo=this._tempo,y.setParameters(this.sampleRate,this.sequenceMs,this.seekWindowMs,this.overlapMs),y}},{key:"seekBestOverlapPosition",value:function(){return this._quickSeek?this.seekBestOverlapPositionStereoQuick():this.seekBestOverlapPositionStereo()}},{key:"seekBestOverlapPositionStereo",value:function(){var y,w,I,W=0;for(this.preCalculateCorrelationReferenceStereo(),y=0,w=Number.MIN_VALUE;W<this.seekLength;W+=1)(I=this.calculateCrossCorrelationStereo(2*W,this.refMidBuffer))>w&&(w=I,y=W);return y}},{key:"seekBestOverlapPositionStereoQuick",value:function(){var y,w,I,W,Y,oe=0;for(this.preCalculateCorrelationReferenceStereo(),w=Number.MIN_VALUE,y=0,W=0,Y=0;oe<4;oe+=1){for(var pe=0;hn[oe][pe]&&!((Y=W+hn[oe][pe])>=this.seekLength);)(I=this.calculateCrossCorrelationStereo(2*Y,this.refMidBuffer))>w&&(w=I,y=Y),pe+=1;W=y}return y}},{key:"preCalculateCorrelationReferenceStereo",value:function(){for(var y,w,I=0;I<this.overlapLength;I+=1)w=I*(this.overlapLength-I),y=2*I,this.refMidBuffer[y]=this.midBuffer[y]*w,this.refMidBuffer[y+1]=this.midBuffer[y+1]*w}},{key:"calculateCrossCorrelationStereo",value:function(y,w){var I=this._inputBuffer.vector;y+=this._inputBuffer.startIndex;for(var W,Y=0,oe=2,pe=2*this.overlapLength;oe<pe;oe+=2)Y+=I[W=oe+y]*w[oe]+I[W+1]*w[oe+1];return Y}},{key:"overlap",value:function(y){this.overlapStereo(2*y)}},{key:"overlapStereo",value:function(y){var w=this._inputBuffer.vector;y+=this._inputBuffer.startIndex;for(var I,W,Y,oe,pe,Oe=this._outputBuffer.vector,et=this._outputBuffer.endIndex,pt=0,sn=1/this.overlapLength;pt<this.overlapLength;pt+=1)W=(this.overlapLength-pt)*sn,Y=pt*sn,oe=(I=2*pt)+y,Oe[(pe=I+et)+0]=w[oe+0]*Y+this.midBuffer[I+0]*W,Oe[pe+1]=w[oe+1]*Y+this.midBuffer[I+1]*W}},{key:"process",value:function(){var y,w,I;if(this.midBuffer===null){if(this._inputBuffer.frameCount<this.overlapLength)return;this.midBuffer=new Float32Array(2*this.overlapLength),this._inputBuffer.receiveSamples(this.midBuffer,this.overlapLength)}for(;this._inputBuffer.frameCount>=this.sampleReq;){y=this.seekBestOverlapPosition(),this._outputBuffer.ensureAdditionalCapacity(this.overlapLength),this.overlap(Math.floor(y)),this._outputBuffer.put(this.overlapLength),(w=this.seekWindowLength-2*this.overlapLength)>0&&this._outputBuffer.putBuffer(this._inputBuffer,y+this.overlapLength,w);var W=this._inputBuffer.startIndex+2*(y+this.seekWindowLength-this.overlapLength);this.midBuffer.set(this._inputBuffer.vector.subarray(W,W+2*this.overlapLength)),this.skipFract+=this.nominalSkip,I=Math.floor(this.skipFract),this.skipFract-=I,this._inputBuffer.receive(I)}}},{key:"tempo",set:function(y){var w;this._tempo=y,this.calculateSequenceParameters(),this.nominalSkip=this._tempo*(this.seekWindowLength-this.overlapLength),this.skipFract=0,w=Math.floor(this.nominalSkip+.5),this.sampleReq=Math.max(w+this.overlapLength,this.seekWindowLength)+this.seekLength},get:function(){return this._tempo}},{key:"inputChunkSize",get:function(){return this.sampleReq}},{key:"outputChunkSize",get:function(){return this.overlapLength+Math.max(0,this.seekWindowLength-2*this.overlapLength)}},{key:"quickSeek",set:function(y){this._quickSeek=y}}]),A}(ze),vn=function($,A){return($>A?$-A:A-$)>1e-10},yn=function(){function $(){Fr(this,$),this.transposer=new tt(!1),this.stretch=new Mn(!1),this._inputBuffer=new Ye,this._intermediateBuffer=new Ye,this._outputBuffer=new Ye,this._rate=0,this._tempo=0,this.virtualPitch=1,this.virtualRate=1,this.virtualTempo=1,this.calculateEffectiveRateAndTempo()}return ii($,[{key:"clear",value:function(){this.transposer.clear(),this.stretch.clear()}},{key:"clone",value:function(){var A=new $;return A.rate=this.rate,A.tempo=this.tempo,A}},{key:"calculateEffectiveRateAndTempo",value:function(){var A=this._tempo,y=this._rate;this._tempo=this.virtualTempo/this.virtualPitch,this._rate=this.virtualRate*this.virtualPitch,vn(this._tempo,A)&&(this.stretch.tempo=this._tempo),vn(this._rate,y)&&(this.transposer.rate=this._rate),this._rate>1?this._outputBuffer!=this.transposer.outputBuffer&&(this.stretch.inputBuffer=this._inputBuffer,this.stretch.outputBuffer=this._intermediateBuffer,this.transposer.inputBuffer=this._intermediateBuffer,this.transposer.outputBuffer=this._outputBuffer):this._outputBuffer!=this.stretch.outputBuffer&&(this.transposer.inputBuffer=this._inputBuffer,this.transposer.outputBuffer=this._intermediateBuffer,this.stretch.inputBuffer=this._intermediateBuffer,this.stretch.outputBuffer=this._outputBuffer)}},{key:"process",value:function(){this._rate>1?(this.stretch.process(),this.transposer.process()):(this.transposer.process(),this.stretch.process())}},{key:"rate",get:function(){return this._rate},set:function(A){this.virtualRate=A,this.calculateEffectiveRateAndTempo()}},{key:"rateChange",set:function(A){this._rate=1+.01*A}},{key:"tempo",get:function(){return this._tempo},set:function(A){this.virtualTempo=A,this.calculateEffectiveRateAndTempo()}},{key:"tempoChange",set:function(A){this.tempo=1+.01*A}},{key:"pitch",set:function(A){this.virtualPitch=A,this.calculateEffectiveRateAndTempo()}},{key:"pitchOctaves",set:function(A){this.pitch=Math.exp(.69314718056*A),this.calculateEffectiveRateAndTempo()}},{key:"pitchSemitones",set:function(A){this.pitchOctaves=A/12}},{key:"inputBuffer",get:function(){return this._inputBuffer}},{key:"outputBuffer",get:function(){return this._outputBuffer}}]),$}(),Cr=function(){function $(A){Fr(this,$),this.buffer=A,this._position=0}return ii($,[{key:"extract",value:function(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;this.position=w;for(var I=this.buffer.getChannelData(0),W=this.dualChannel?this.buffer.getChannelData(1):this.buffer.getChannelData(0),Y=0;Y<y;Y++)A[2*Y]=I[Y+w],A[2*Y+1]=W[Y+w];return Math.min(y,I.length-w)}},{key:"dualChannel",get:function(){return this.buffer.numberOfChannels>1}},{key:"position",get:function(){return this._position},set:function(A){this._position=A}}]),$}(),ur=function($,A){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zt,w=arguments.length>3&&arguments[3]!==void 0?arguments[3]:4096,I=$.createScriptProcessor(w,2,2),W=new Float32Array(2*w);return I.onaudioprocess=function(Y){var oe=Y.outputBuffer.getChannelData(0),pe=Y.outputBuffer.getChannelData(1),Oe=A.extract(W,w);y(A.sourcePosition),Oe===0&&A.onEnd();for(var et=0;et<Oe;et++)oe[et]=W[2*et],pe[et]=W[2*et+1]},I},Kr=function($){var A,y,w,I=Math.floor($/60),W=$-60*I;return"".concat(I,":").concat((A=parseInt(W),w=w||"0",(A+="").length>=(y=2)?A:new Array(y-A.length+1).join(w)+A))},Di=function($){var A=this.timePlayed,y=this.sampleRate;if(this.sourcePosition=$,this.timePlayed=$/y,A!==this.timePlayed){var w=new CustomEvent("play",{detail:{timePlayed:this.timePlayed,formattedTimePlayed:this.formattedTimePlayed,percentagePlayed:this.percentagePlayed}});this._node.dispatchEvent(w)}},Er=(function(){function $(A,y,w){var I=this,W=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Zt;Fr(this,$),this._soundtouch=new yn;var Y=new Cr(y);this.timePlayed=0,this.sourcePosition=0,this._filter=new fn(Y,this._soundtouch,W),this._node=ur(A,this._filter,function(oe){return Di.call(I,oe)}),this.tempo=1,this.rate=1,this.duration=y.duration,this.sampleRate=A.sampleRate,this.listeners=[]}ii($,[{key:"connect",value:function(A){this._node.connect(A)}},{key:"disconnect",value:function(){this._node.disconnect()}},{key:"on",value:function(A,y){this.listeners.push({name:A,cb:y}),this._node.addEventListener(A,function(w){return y(w.detail)})}},{key:"off",value:function(){var A=this,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,w=this.listeners;y&&(w=w.filter(function(I){return I.name===y})),w.forEach(function(I){A._node.removeEventListener(I.name,function(W){return I.cb(W.detail)})})}},{key:"formattedDuration",get:function(){return Kr(this.duration)}},{key:"formattedTimePlayed",get:function(){return Kr(this.timePlayed)}},{key:"percentagePlayed",get:function(){return 100*this._filter.sourcePosition/(this.duration*this.sampleRate)},set:function(A){this._filter.sourcePosition=parseInt(A*this.duration*this.sampleRate)}},{key:"node",get:function(){return this._node}},{key:"pitch",set:function(A){this._soundtouch.pitch=A}},{key:"pitchSemitones",set:function(A){this._soundtouch.pitchSemitones=A}},{key:"rate",set:function(A){this._soundtouch.rate=A}},{key:"tempo",set:function(A){this._soundtouch.tempo=A}}])}(),function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"soundTouch",void 0),_()(p()(w),"filter",void 0),w.init(y.source),w}return g()(A,$),l()(A,[{key:"init",value:function(y){this.soundTouch=new yn,this.soundTouch.tempo=1,this.soundTouch.rate=1,this.filter=new fn(y,this.soundTouch,2048)}},{key:"provide",value:function(y){for(var w=new Float32Array(2*y),I=this.filter.extract(w,y),W=new Float32Array(I),Y=new Float32Array(I),oe=0;oe<I;oe++)W[oe]=w[2*oe],Y[oe]=w[2*oe+1];return{size:I,left:W,right:Y}}},{key:"rate",set:function(y){this.soundTouch.tempo=y}}]),A}(J)),ue=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"currentRate",1),_()(p()(w),"source",[]),_()(p()(w),"commonProcessor",void 0),_()(p()(w),"rateProcessor",void 0),_()(p()(w),"audioTime",0),w.source=y.source,w.init(),w}return g()(A,$),l()(A,[{key:"init",value:function(){var y=this;this.commonProcessor=new tr({source:this.source,onPlay:function(w){y.audioTime=w}}),this.rateProcessor=new Er({source:this.commonProcessor})}},{key:"provide",value:function(y){var w=(this.currentRate===1?this.commonProcessor:this.rateProcessor).provide(y);return w.audioTime=this.audioTime,w}},{key:"rate",set:function(y){this.currentRate=y,this.rateProcessor.rate=y}}]),A}(J),q="canplaythrough",z="seeked",G="waiting",ae=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"audioContext",null),_()(p()(w),"scriptNode",null),_()(p()(w),"gainNode",null),_()(p()(w),"delay",0),_()(p()(w),"audioBuffer",new ArrayBuffer(0)),_()(p()(w),"decodedBuffer",[]),_()(p()(w),"isFirstPlay",!0),_()(p()(w),"defaultVolume",1),_()(p()(w),"currentRate",1),_()(p()(w),"eventListeners",{}),_()(p()(w),"canPlay",!1),_()(p()(w),"interval",void 0),_()(p()(w),"seekTimeDelta",0),_()(p()(w),"audioTime",0),_()(p()(w),"audioProvider",void 0),_()(p()(w),"isWaiting",!1),y=Object.assign({},y),w.flushTime=y.flushTime||1e3,w.onReady=y.onReady,w.init(),w}return g()(A,$),l()(A,[{key:"init",value:function(){this.audioProvider=new ue({source:this.decodedBuffer}),typeof this.onReady=="function"&&setTimeout(this.onReady,0)}},{key:"feed",value:function(y){var w=y.audio;this.audioBuffer=this.appendByteArray(this.audioBuffer,w),this.canPlay||(this.canPlay=!0,this.triggerEvent(q))}},{key:"appendByteArray",value:function(y,w){var I=new Uint8Array((0|y.byteLength)+(0|w.byteLength));return I.set(new Uint8Array(y),0),I.set(new Uint8Array(w),0|y.byteLength),I.buffer}},{key:"decodeAudioData",value:function(y){var w=this;this.audioBuffer&&this.audioBuffer.byteLength>0&&(this.audioContext.decodeAudioData(this.audioBuffer,function(I){I.startTime=w.delay,w.delay+=I.duration,w.decodedBuffer.push(I),y&&y.call()},function(I){w.logger.error("decodeAudioData",I)}),this.audioBuffer=new ArrayBuffer(0))}},{key:"play",value:function(){var y=this;return new Promise(function(w,I){y.isFirstPlay?(y.isFirstPlay=!1,y.logger.info("startPlay"),y.audioContext=new(window.AudioContext||window.webkitAudioContext),y.gainNode=y.audioContext.createGain(),y.gainNode.gain.value=y.defaultVolume,y.scriptNode=y.audioContext.createScriptProcessor(2048,2,2),y.scriptNode.onaudioprocess=function(W){var Y=W.outputBuffer,oe=Y.length,pe=y.audioProvider.provide(oe);if(pe.size!==0){y.isWaiting&&(y.isWaiting=!1,y.triggerEvent(q));var Oe=Y.getChannelData(0),et=Y.getChannelData(1);if(pe.audioTime!=0&&(y.audioTime=pe.audioTime),Oe.set(pe.left),et.set(pe.right),pe.size<oe){var pt=new Float32Array(oe-pe.size);Oe.set(pt,pe.size),et.set(pt,pe.size)}}else y.isWaiting||(y.isWaiting=!0,y.triggerEvent(G))},y.scriptNode.connect(y.gainNode),y.gainNode.connect(y.audioContext.destination),y.decodeAudioData.call(y,y.testAutoplay.bind(y,w,I)),y.interval=setInterval(y.decodeAudioData.bind(y),y.flushTime)):y.audioContext.state==="suspended"?y.audioContext.resume().then(function(){y.logger.info("play","Audio is resumed"),w()}):(y.logger.info("Audio resumed from waiting"),w())})}},{key:"pause",value:function(){var y=this;this.audioContext&&this.audioContext.suspend().then(function(){y.logger.info("pause","Audio is paused")})}},{key:"addEventListener",value:function(y,w){this.eventListeners[y]=w}},{key:"triggerEvent",value:function(y){var w=this.eventListeners[y];w&&w.call()}},{key:"buffer",value:function(){var y=0;return this.decodedBuffer.length>0&&(y=this.decodedBuffer[0].startTime),{start:1e3*y,end:parseInt(1e3*this.delay)}}},{key:"destroy",value:function(){this.delay=0,this.audioContext&&(clearInterval(this.interval),this.scriptNode.disconnect(),this.scriptNode=null,this.audioContext.close(),this.audioContext=null),this.gainNode=null,this.audioBuffer=new ArrayBuffer(0),this.canPlay=!1,this.isFirstPlay=!0,this.decodedBuffer.length=0,this.seekTimeDelta=0,this.audioTime=0}},{key:"testAutoplay",value:function(y,w){var I=F.createEl("audio"),W=I.play();I=null;var Y=!1;W!==void 0?(W.catch(function(){Y=!0}),setTimeout(function(){W=null,Y?w("Autoplay is prevented"):y()},100)):w("Promise is undefined")}},{key:"currentTime",get:function(){return this.audioTime},set:function(y){var w=this;for(this.audioTime=y;this.decodedBuffer.length>0;){var I=this.decodedBuffer.shift();if(I.startTime<=y&&I.startTime+I.duration>y){I.loadedPosition=parseInt(I.length*(y-I.startTime)/I.duration),this.decodedBuffer.unshift(I);break}}setTimeout(function(){w.triggerEvent(z)},0)}},{key:"volume",get:function(){return this.gainNode.gain.value},set:function(y){this.gainNode?this.gainNode.gain.value=y:this.defaultVolume=y}},{key:"playbackRate",set:function(y){y!==this.currentRate&&(this.currentRate=y,this.audioProvider.rate=y)}}]),A}(J),be=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"first",!1),_()(p()(y),"offset",0),_()(p()(y),"currentPTS",0),_()(p()(y),"ready",!1),_()(p()(y),"end",!1),_()(p()(y),"lastData",null),_()(p()(y),"nodeParent",null),_()(p()(y),"useJMuxer",!1),y.player=w.audioNode,y.createAudioMuxer(),y.bindEvent(),y.logger.info("audioDecoder",y.useJMuxer?"JMuxer":"AudioContext"),y}return g()(A,$),l()(A,[{key:"bindEvent",value:function(){var y=this;this.bindNodeEvent(),this.events.on(ve.PlayerMaxPTS,function(w){y.currentPTS===w&&(y.end=!0)})}},{key:"bindNodeEvent",value:function(){var y=this;this.addEventListener("seeked",function(){y.onSeekedHandler&&y.onSeekedHandler(),y.events.emit("AudioPlayer.seeked")}),this.addEventListener("canplaythrough",function(){y.logger.info("canplaythrough"),y.ready||(y.ready=!0,y.status="ready",y.logger.info("constructor","canplaythrough","ready"),y.events.emit(ve.AudioPlayerDataReady))}),this.addEventListener("waiting",function(){y.ready=!1,y.end?(y.useJMuxer||y.player.destroy(),y.status="end",y.events.emit(ve.AudioPlayerEnd,"audio"),y.logger.info("audioPlayer end")):(y.logger.warn("audioPlayer waiting",y.player.currentTime,y.currentPTS),y.status="waiting",y.events.emit(ve.AudioPlayerWait,"audio"))})}},{key:"reset",value:function(){this.lastData=null,this.first=!1,this.offset=0,this.currentPTS=0,this.ready=!1,this.end=!1,this.clear(),this.createAudioMuxer(),this.bindNodeEvent(),this.stime=null}},{key:"createNode",value:function(){this.player=document.createElement("audio"),this.player.classList.add("goldplay__audio--player"),this.parentNode.appendChild(this.player)}},{key:"createAudioMuxer",value:function(){this.useJMuxer?this.audioDecoder=new Ca({node:this.player,mode:"audio",debug:!1,clearBuffer:!0,flushingTime:10,onReady:this.onMSEReady.bind(this)}):(this.audioDecoder=new ae({flushTime:100,onReady:this.onMSEReady.bind(this)}),this.player=this.audioDecoder)}},{key:"onMSEReady",value:function(){this.logger.info("onMSEReady","AudioPlayerReady"),this.events.emit(ve.AudioPlayerReady)}},{key:"clear",value:function(){this.audioDecoder.destroy(),this.audioDecoder=null}},{key:"play",value:function(){var y=this;this.status!=="playing"&&(this.status="playing",this.player.play().then(function(){y.events.emit(ve.AudioPlayerPlaySuccess)}).catch(function(w){y.logger.error("play","errorInfo:",w),y.events.emit(ve.AudioPlayerPlayFail)}))}},{key:"pause",value:function(){this.status!=="pause"&&(this.status="pause",this.player.pause())}},{key:"send",value:function(y){if(this.audioDecoder){if(this.stime||(this.stime=Date.now()),(y=this.format(y)).audioEnd)return this.logger.info("push","audioEnd"),this.feed(this.lastData),void(this.lastData=null);if(this.first||(this.first=!0,this.offset=y.start),y.PTS>this.currentPTS){if(!this.lastData)return void(this.lastData=y);this.lastData.duration=y.PTS-this.lastData.PTS,this.feed(this.lastData),y.duration=this.lastData.duration,this.lastData=y}}else this.logger.error("send","audioDecoder is:",this.audioDecoder)}},{key:"feed",value:function(y){this.audioDecoder.feed({audio:y.data_byte,duration:y.duration}),this.currentPTS=y.PTS}},{key:"format",value:function(y){return y&&y.data_byte&&(y.start=y.PTS),y}},{key:"addEventListener",value:function(y,w){this.player.addEventListener(y,w)}},{key:"isBuffered",value:function(y){return[this.buffer()].findIndex(function(w){return y>=w.start&&y<w.end})!==-1}},{key:"buffer",value:function(){if(this.useJMuxer){for(var y=this.player.buffered,w=y.length,I={};w>0;)I.start=1e3*y.start(w-1)+this.offset,I.end=1e3*y.end(w-1)+this.offset,w--;return I}var W=this.player.buffer();return{start:W.start+this.offset,end:W.end+this.offset}}},{key:"muted",set:function(y){this.player.muted=!!y}},{key:"playbackRate",set:function(y){this.player.playbackRate=y}},{key:"volume",get:function(){return this.player.volume},set:function(y){this.player.volume=y,this.muted=y===0}},{key:"currentTime",get:function(){return parseInt(1e3*this.player.currentTime+this.offset)},set:function(y){this.player.currentTime=(y-this.offset)/1e3}},{key:"paused",get:function(){return this.player.paused}},{key:"offset",set:function(y){this.offset=y}}]),A}(J),Ie={playerContainer:"goldplay__container",screenContainer:"goldplay__screen--container",screenCanvas:"goldplay__screen--canvas",audioContainer:"goldplay__audio--container",audioPlayer:"goldplay__audio--player",controlContainer:"goldplay__control--container",containerFullPage:"goldplay__container-fullpage",containerFullScreen:"goldplay__container-fullscreen",controlContainerFloat:"goldplay__control--container-float",bigPlayButton:"goldplay__screen--bigplay",poster:"goldplay__screen--poster",nearside:"goldplay__control--nearside",sidebar:"goldplay__control--sidebar",buttonBlock:"goldplay__control--button-block",playButton:"goldplay__control--play",pauseButton:"goldplay__control--pause",replayButton:"goldplay__control--replay",speedBar:"goldplay__speed-bar",speedBarBox:"goldplay__speed-bar--box",rateBar:"goldplay__rate-bar",rateBarBox:"goldplay__rate-bar--box",fullPage:"goldplay__control--fullpage",fullScreen:"goldplay__control--fullscreen",waitingBar:"goldplay__waiting-bar",progressBar:"goldplay__progress-bar",progressBarHover:"goldplay__progress-bar-hover",progressBarPlay:"goldplay__progressbar--play",progressBarPlayHover:"goldplay__progressbar--play-hover",progressBarLoad:"goldplay__progressbar--load",progressBarLoadHover:"goldplay__progressbar--load-hover",progressBarDot:"goldplay__progressbar--dot",progressBarDotHover:"goldplay__progressbar--dot-hover",volumeBar:"goldplay__volume-bar",volumeBarAudio:"goldplay__volume-bar--audio",volumeBarAudioOn:"goldplay__volume-bar--audio-on",volumeBarAudioOff:"goldplay__volume-bar--audio-off",volumeBarHandle:"goldplay__volume-bar--handle",volumeBarRod:"goldplay__volume-bar--rod",volumeBarRodHover:"goldplay__volume-bar--rod-hover",volumeBarSize:"goldplay__volume-bar--size",volumeBarColumn:"goldplay__volume-bar--column",alertBox:"goldplay__alter-box",alertClose:"goldplay__alter--close"},Ue=Ie,rt=function(){function $(){s()(this,$)}return l()($,null,[{key:"createContainer",value:function(A){var y=function(I){function W(){return s()(this,W),c()(this,h()(W).apply(this,arguments))}return g()(W,I),W}(Ve()(HTMLDivElement));customElements.get("gp-container")||customElements.define("gp-container",y,{extends:"div"});var w=F.createEl("gp-container","div");return w.className=Ue.playerContainer,w.style.width=(A.options.width?A.options.width:A.el.offsetWidth)+"px",w.style.height=(A.options.height?A.options.height:A.el.offsetHeight)+"px",w}},{key:"createScreenContainer",value:function(A){var y=A.$container,w=function(Y){function oe(){return s()(this,oe),c()(this,h()(oe).apply(this,arguments))}return g()(oe,Y),oe}(Ve()(HTMLDivElement));customElements.get("gp-screen")||customElements.define("gp-screen",w,{extends:"div"});var I,W=F.createEl("gp-screen","div");return W.classList.add(Ue.screenContainer),I=A.controlBarAutoHide?y.offsetHeight:y.offsetHeight-A.controlBarHeight,W.style.height=I+"px",W}},{key:"createAudioContainer",value:function(){var A=F.createEl("gp-audio");return A.classList.add(Ue.audioContainer),A.style.display="none",A}},{key:"createAudio",value:function(){var A=F.createEl("audio");return A.classList.add(Ue.audioPlayer),A.controls=!0,A}},{key:"clearCavans",value:function(A){var y=A.getContext("webgl");y.clear(y.COLOR_BUFFER_BIT)}}]),$}();_()(rt,"createCanvas",function($){var A=F.createEl("canvas");return A.style.display="none",A.classList.add(Ue.screenCanvas),A.width=$.options.screenWidth||$.screenWidth,A.height=$.options.screenHeight||$.screenHeight,A});var _t=M.a.get("Template.js"),ct=function(){function $(){s()(this,$)}return l()($,null,[{key:"mergeVar",value:function(A){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof A!="string"||A==="")return A;try{var w=new RegExp(`\\\${'?"?\\s*([.:a-z0-9_s]+?)\\s*'?"?}`,"ig");return A.replace(w,function(I,W){W=W.trim();var Y=y[W];return Y=(Y=(Y=Y===null?"":Y)===void 0?"":Y)||""})}catch(I){return _t.error("mergeVar","replace variable","error:",I),A}}},{key:"makeValue",value:function(A,y,w){if(typeof y!="string"&&typeof y!="function")return y;if(typeof y=="function"&&(y=y.call(this,this.data)),!w)return $.escapeHTML.call(this,y);var I,W=function(et){var pt="";return et&&(pt=" ".concat($.slotReplaceName,'="true"')),'<gp-slot style="display:none"'.concat(pt,"></gp-slot>")};if($.isSoltType(w)){if(typeof this.getComponent!="function")return _t.error("makeValue","the object is not support slot mode.",this.getComponent,y),y;switch(w){case $.slotTypeMap.component:I=y;var Y=this.getComponent(I);N()(Y)==="object"&&Y.element?(Y.element.setAttribute($.slotReplaceName,"true"),y=Y.element.outerHTML):y=W(I);break;case $.slotTypeMap.html:y=$.mergeVar.call(this,y,this.data)}var oe="";I!==void 0&&(oe=" ".concat($.slotComName,'="').concat(I,'" '));var pe="$1 "+$.slotTypeName+'="'+w+'" '+$.slotKeyName+'="'+A+'"'+oe+"$2";return typeof y=="string"&&(y=(y=y===""?W():y).replace(/^\s*(<\s?[\w-]*)(.*[\r|\n|>])/,pe)),y}if(typeof w=="string"){var Oe=Lt[w];return typeof Oe=="function"&&(y=Oe.call(this,y)),y}return $.escapeHTML.call(this,y)}},{key:"escapeHTML",value:function(A){return typeof A!="string"?A:A.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},{key:"generate",value:function(A,y,w){var I=this,W=w[w.length-1]||{},Y=[A[0]];return y.forEach(function(oe,pe){if(oe){var Oe,et,pt=oe.split($.pipSeparator);pt.length>1&&(oe=pt[0],et=pt[1]),Oe=Number.isInteger(oe)?w[oe]:W[oe],(Oe=$.makeValue.bind(I)(oe,Oe,et))!==void 0&&Y.push(Oe),A[pe+1]!==void 0&&Y.push(A[pe+1])}}),Y.join("")}},{key:"create",value:function(A){for(var y=arguments.length,w=new Array(y>1?y-1:0),I=1;I<y;I++)w[I-1]=arguments[I];var W;W=Array.isArray(A)?"array":typeof A=="function"?"function":"string";var Y=this;if(N()(Y)==="object"||typeof Y=="function")if(A!==void 0&&A!=="")switch(Y.data!==void 0&&Y.data!==null||(_t.info("create","this object.data is undefined or null",Y),Y.data={}),W){case"array":return function(){for(var pe=arguments.length,Oe=new Array(pe),et=0;et<pe;et++)Oe[et]=arguments[et];var pt=Oe[Oe.length-1]||{};N()(Y)==="object"&&(Y.__template__={tplObj:A,keys:w,dict:pt});var sn=$.generate.bind(Y);return sn(A,w,Oe)};case"function":var oe=$.create.bind(Y);return A.call(Y,Y.data,oe,Y);default:return function(pe){return pe=pe!==void 0?pe:Y.data,$.mergeVar(A,pe)}}else _t.error("create","have not give tplObj parameter.",A);else _t.error("create","this is not an object.",Y)}},{key:"isSoltType",value:function(A){return A=String(A).toLowerCase(),$.slotTypeMap[A]}}]),$}();ct.pipSeparator="|",ct.slotTypeName="gp-slot-type",ct.slotKeyName="gp-slot-key",ct.slotComName="gp-slot-com",ct.slotReplaceName="gp-slot-replace",ct.slotTypeMap={html:"html",component:"component"};var Lt={trim:function($){return $.trim()},upperCase:function($){return $.toUpperCase()},lowerCase:function($){return $.toLowerCase()}},Ot=ct,En=i(18),Br=i.n(En),Xt=i(28),Va=i.n(Xt),mn=M.a.get("Observer.js"),Os=function(){function $(y){s()(this,$),_()(this,"object",null),this.setObject(y)}var A;return l()($,[{key:"setObject",value:function(y){this.object=y}},{key:"watch",value:(A=Va()(Br.a.mark(function y(w,I,W){var Y;return Br.a.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(typeof(Y=this.object).watch=="function"){oe.next=3;break}return oe.abrupt("return");case 3:return oe.next=5,Y.watch(w,I,W);case 5:oe.sent!==!1&&typeof Y.render=="function"&&Y.render(w,I,W),typeof Y.afterWatch=="function"&&Y.afterWatch(w,I,W);case 8:case"end":return oe.stop()}},y,this)})),function(y,w,I){return A.apply(this,arguments)})},{key:"create",value:function(y){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},I=this,W=w.set,Y=w.get;y=y||I.data;var oe=I.object,pe={set:function(Oe,et,pt){return typeof W=="function"?W.call(I,Oe,et,pt):(Oe[et]!==pt&&(Oe[et]=pt,oe.__template__&&Object.prototype.hasOwnProperty.call(oe.__template__.dict,et)&&I.watch(Oe,et,pt)),!0)},get:function(Oe,et){return typeof Y=="function"?Y.call(I,Oe,et):N()(Oe[et])==="object"&&Oe[et]!==null?new Proxy(Oe[et],pe):Reflect.get(Oe,et)}};return new Proxy(y,pe)}}]),$}(),iu=function($){return N()($)!=="object"&&mn.error("observer","this is not an object."),new Os($)};function ds($){if($){var A=[],y=[];for(y.push($);y.length;){var w=y.shift(),I=w.getAttribute(Ot.slotTypeName);if(!Ot.isSoltType(I)){A.push(w);for(var W=w.children,Y=0,oe=W.length;Y<oe;Y++)y.push(W[Y])}}return A}}var Ea=function($){return $.getAttribute&&$.getAttribute(Ot.slotTypeName)===Ot.slotTypeMap.html},ps=function($,A){return!(!(y=$).getAttribute||y.getAttribute(Ot.slotTypeName)!==Ot.slotTypeMap.component||$.getAttribute(Ot.slotComName)===A.getAttribute(Ot.slotComName));var y},oc=function($,A,y){var w;($||A)&&(!$&&A?y.appendChild(A):!A&&$?y.removeChild($):$.tagName!==A.tagName||(w=A,Ea($)&&Ea(w))||ps($,A)?$.replaceWith(A.cloneNode(!0)):$.nodeType===Node.TEXT_NODE&&$.nodeValue!==A.nodeValue?$.nodeValue=A.nodeValue:$.setAttribute&&F.setAttributes($,A))},yr=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"createTemplate",null),_()(p()(y),"template",""),_()(p()(y),"element",null),_()(p()(y),"eventsList",{}),_()(p()(y),"data",{}),_()(p()(y),"id",""),y.id=w.id||y.constructor.name,y.options=w,y.createTemplate=Ot.create.bind(p()(y)),y}return g()(A,$),l()(A,[{key:"getTemplate",value:function(){return this.template}},{key:"setTemplate",value:function(y){this.template=y}},{key:"init",value:function(){this.data=iu(this).create(this.data),this.render(),typeof this.afterInit=="function"&&this.afterInit()}},{key:"afterInit",value:function(){}},{key:"initProps",value:function(){}},{key:"bindEvent",value:function(){}},{key:"watch",value:function(){}},{key:"render",value:function(){var y="";y=typeof this.template=="function"?this.template(this.data):this.template;var w=F.createEl("div");if(typeof y=="string"){w.innerHTML=y;var I=w.firstElementChild,W=I.querySelectorAll("["+Ot.slotReplaceName+"]"),Y=!0,oe=!1,pe=void 0;try{for(var Oe,et=W[Symbol.iterator]();!(Y=(Oe=et.next()).done);Y=!0){var pt=Oe.value;if(pt.getAttribute(Ot.slotReplaceName)==="true"){var sn=pt.getAttribute(Ot.slotComName),kn=this.getComponent(sn);if(!kn)continue;var Mr=kn.element;F.isElement(this.element)?pt.replaceWith(Mr.cloneNode(!0)):pt.replaceWith(Mr),kn.element.removeAttribute(Ot.slotReplaceName)}}}catch(kr){oe=!0,pe=kr}finally{try{Y||et.return==null||et.return()}finally{if(oe)throw pe}}F.isElement(this.element)?this.replaceNode(this.element,I):this.element=I}else this.logger.error("render:","this template is not html string","html:",y)}},{key:"replaceNode",value:function(y,w){if(y&&w){var I=ds(y),W=ds(w),Y=I.length,oe=W.length,pe=Math.max(Y,oe);if(pe<=0||y.tagName!==w.tagName)return y.replaceWith(w),void(this.element=w);for(;pe--;){var Oe=I[pe],et=W[pe];if(Oe)if(et){if(Oe.tagName===et.tagName&&F.syncAttributes(Oe,et),!Oe.isEqualNode(et)){var pt=Math.max(Oe.childNodes.length,et.childNodes.length);if(pt<=0)oc(Oe,et,Oe.parentNode);else for(var sn=0,kn=pt;sn<kn;sn++){var Mr=Oe.childNodes[sn],kr=et.childNodes[sn];(Mr||kr)&&oc(Mr,kr,Oe)}}}else Oe.parentNode.removeChild(Oe);else y.appendChild(et)}}}},{key:"show",value:function(){this.data.display="show",this.element&&(this.element.style.display="inline-block")}},{key:"hide",value:function(){this.data.display="hide",this.element&&(this.element.style.display="none")}},{key:"resetPosition",value:function(){var y=this.element.parentNode,w=y.offsetWidth,I=y.offsetHeight;this.element.style.marginTop=(I-this.element.offsetHeight)/2+"px",this.element.style.marginLeft=(w-this.element.offsetWidth)/2+"px"}},{key:"replace",value:function(y){this.element.replaceWith(y),this.element=y}},{key:"update",value:function(y){this.element.innerHTML=y}},{key:"addEventListener",value:function(y,w,I){var W=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return y.addEventListener(w,I,W),{destroy:function(){y.removeEventListener(w,I)}}}},{key:"removeEventListenerAll",value:function(){var y=this;Object.keys(this.eventsList).forEach(function(w){y.eventsList[w].destroy()})}},{key:"getComponent",value:function(y){if(y!==void 0)return this.options.componentsController?this.options.componentsController.getComponent(y):void 0}},{key:"getHTMLString",value:function(){return this.element.outerHTML}},{key:"destroy",value:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.events.emit("Component_"+this.id+".destroy",this),this.removeEventListenerAll()}}]),A}(J),dl=i(8),sr=i.n(dl),Aa={formatHHMMSS:function($){var A=parseInt($,10),y=Math.floor(A/3600),w=Math.floor((A-3600*y)/60),I=A-3600*y-60*w;y<10&&(y="0"+y),w<10&&(w="0"+w),I<10&&(I="0"+I);var W="";return y!=="00"&&(W=y+":"),W+w+":"+I}},pl={formatBytes:function($,A){if($==0)return"0 Bytes";var y=A<=0?0:A||2,w=Math.floor(Math.log($)/Math.log(1024));return parseFloat(($/Math.pow(1024,w)).toFixed(y))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][w]}};function au(){var $=sr()([`
  <gp-poster class="goldplay__screen--poster">
  <img src="`,'" width="','" data-display="','" heigth="',`" class="goldplay__screen--poster-image">
  <gp-speed class="goldplay__screen--poster-speed">`,`</gp-speed>
  </gp-poster>
  `]);return au=function(){return $},$}var ml=`data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAA+CAYAAABuk1SaAAAZ2ElEQVR4nO2de1wV1fbA157ZcyTe
6sjj8FJeoqghiJAovsAHkJSUmpZl3bTHTe/NzO71k131Z97y9tJft9SrojdNLTQUH6iR4EcTUTRN
BERCRAQcURCUnNfvDzl2OMzrPDDsd75/wZ6ZvdfMnLX3XmuvtQfAjh07duzYsWPHjh07duzYsdMp
QFKFoig+aDnsAEC0F9UzxgNiORG4L8+y31pSh7czxiQBmBeAu9rEcbaW8f8DCP2mFvh3lOOhIc6H
Ch2tFxOeDeKn+TuDv8N/RD9b1e3tjPHUEJg6py8/pyAV/AEAlpwil2i9PlZPBQ/xEIdEdBcfjewu
RJ5NAy/aAcKYFiguTCMqL96C8tIGoqSsEZUV3YSi/KtsuaWyxvtSfRP1YsLzIfzzrjpwdV8vhlha
18NCh40g0V5UzxA3CO3pLPbEBOD6X1H91dtQff4mFBcxbJ3VDTwAwmnKY3EUvyStpzgRAGgAgMom
KPTfJEbZov4RflS/7xK4He46CDaUMS1QTG8Q+6hdOyaAilzwKL9guLcYb5BNA0xxAxR/V0FmbrqI
vjp7ja3RclGkJ+W/bBC/bKyvOMbQViGD9kdmCGM1tvtQYTyC2ExBBvSg9MO8YegT/vyTiT5iQmux
1Itjau9A3Yoi8rOMX9D24ussY3ZjD4AxAVTk/nFcNpjcw4KT5KylJ7jV1tY/zJcKO5zMHTatP72U
+NcLP/DzlK5dMZRcODtceMP0WjNh1pQQ/1l6Ci2taOCa5E6aGKyL3z6azTBta/YxPG3FT+xmK9rv
tBgrCGFtZalB1JCs8cT6MxO5nz5/jNua6CNOgXsPU+7l0Z6PQN+lUfyq4qe48wuj8WvWymBrIjwo
XynlAAC42IgsnqIY8HPFDlLKAQDwqwB3la7NeZzYagPlAACgX+4tvFMxhf8lpRcVK3VCrJ4KllIO
AIDyRrD6OTwMWKwgw3ypsIKJxN7MBC4zxV98ASx7YfTiSH7RkSeITEvl6Ai2jOK+Bpn7qWiCCmvr
fyYYTZWrn0Dy7yRrPLF+lF4cJXethdBZY7hdU3tTY0wPZCZwmXJtVTZBpQ1l6LRYpCBLBuPZh5O5
w9E9xHFgg54szlMcciCF+NrKemxChAflG+YGYXLHq5vFamvbyKuBvCWnyDktPFRpveaV/tRTKf5i
CthWOQzQm0dwm2K8qUBDQZwPFer5CHjInM/U3BY02S8PO2YrSHYysendgfy70P5FMeW34Pj8AvzS
+Gwc3X879g7ZhruGZ2DP+N04fHouTs6qROkAIGVz0Ik+YsKbEXi6BfdgU07XsVUTDuDUyiYolDou
iCBY28axarbs3ePcihF78EiQfh5tCOpKuX45hPsCOkY5DNDfjOK+Mfxz5ApbmvY9TmNaoFjq5Lpm
3urn8DBglpv39NPowFhfiIC2L4phWoCZeYSatb3sbt4H0pfWAUARAOyRM34BgP44hv/IzxVvu9zI
tZgjl63ZWc4eDelKjb4wibsARnJyAtSwvLKNYA7Hqtmy0imoNNRN+Yf/9gBhPnSscgAAgL8z+E8J
pRK2lLIHAQAyyti8CA8q8fST3Cnj9mvvQJ1nRwvTSdA8gmQnE5siurVXjk0Xic30BrHP9rK7eVrq
2X+JLYzZiWNAZiQZ7IEGa5WpI7lwg72ZXkqkG5edqUdnaps5m/act3m4rXZO9hUyO6cabQMNo42V
0DNC+BnGBafr2KrMS2incdm5G+jnDpaj06BJQRYMwjONfeCtMGtLiHXTDvJzzG00/ypbbvrjM+BK
gau59XUUZ2+is8b/19wBm8+7HUlwVDtne9ndvFG7hMlp3+M00KYkzOl6OLi2hPhwz2W0UeM1AAAw
1lccE9SVavMOTtcTp4z/r2uBh2IdyxaoTrEiPSn/wif4pWAyxBc3QPFLh/j5ljb8+Xni8xdChRdM
6mWOX4PjltZpa1gBtQnVaObUe/uOJKOMzetLU+FFadw5kJ9yMc/m4ue+Kmb3RbQWeDiRRKwnEftp
LPdJoAsEKlwLAEAHOENPADhjKLhr4nq+xSLZdZM/GqojyBdDeCnjkJmSg5+xpuGCGrbilaP4Vfit
d2OezcXPnetEq+wYiW06EB0But9LFgNFDFsXuws/BjKjwsoiYuVXxew+47K6Zl7YWc4eDdwsxmRX
of1qbXg5gpfx/yRq25F2IX//5/CgUFSQMQFUZIyH2M4mSC8l0k/XsZpdlHJ8eZb9dsB2/GjqQRwX
+g3ubfpiOxu0g+0NZQHM94odq2bL5KaoOyqI75Sufe4Qeg5UplxOWHna100ndlOT8Y+CooLM7cfP
BYnR44ti4gtbCXDmGludeZE9WlrP1tuqzo7iERIcfm8ZDKSXERukymtV7KS6Zl5YdIpcpHROIwuN
Sse7dKLn0NHI2iB9acqjKE1st7pafgvKrYkIfZjRkaLVU4sYbyowugcM9nUUfXu6CAFTAuUXJZW4
2CCWSZXzGtZpjtWhYwqHmfM3pNc+DHSGqaatmB5GJbnqwDXvKuSduca2WwSWVZBRepAMaUi/QG5Y
bGMhO4LQblS3QFcIDHKFwBu/ws2SBiiubhKrrcmRcFSZeigxOZQa9W4E927+BOgHNljT+JUX7zax
UOFMQU/jcqVQFQNNHMga2Udq0VGpH4oxLhQ4axa0FT9X7ODliLwCXSGwhwN4dCFFHSsgrv5XqP/l
FpRfuiVWVj3A9S+9C9btGcfv3jj8/tIFkxpEpWZeZI8anyerIIl6PlGq/Pg11Gm8TKZ4OmEitRd6
4qUQ/qXSp8XBYPJD5ASoWT4Ef7KtHG0rqGErzK3fCZv/w/B0wsTqYcKarSPFCabyWENdMy9UTkP1
pgqiBb0j6GUOMR+cIT/YKXPQgDkjaUovKvbZYH7a5WfuB7HKwawYSq5ceY5YceEGe1Nr/ZaSEoBS
IrpBglERvXUkt9XDiQwAI7tQsrfRu2BdaoA4QerY5U4apDYxWBd/7in+3Oo4LiPGQ0wCiZeBCfCa
15//oCCVK/jXEPyOuW2Y673xdcUOBU/wBakB4osS8jCbLhIrzInHshXJfkKyVHlONcrZWd62B5VC
60i6JZFYmTWG2zUlUPwzqHcO9OxwYdGFSdwF45iwjkK8NxVt46xwIMG3bzeir3GZpIL4OCE9SNxQ
9W04U98idjpj+u9ReOb20WwG7dBmPs/k16E9G8uIjzMvoXXVt+EM/PZA6Lf683N/noR+8HXFmg1O
ZwzOnk5Yc/RB1lh+l78zRJoUM5+fJxbrN5M+0w7yc4puoCKt9dmCAT0o/fRgQSrmjfnTYeJlLXVo
GUmzxhPrpwSqjhpS0EdSuCMeTqTqc/Z0wsTMftTE7GRiU+10dO700+jAlFAqQe06AIA159jvFhaS
70FbJWHumKx1SU6xertLG44XGlBZZ8tznjsQT/9ocJuFTObNfHJu5iX03cUbbGOM0bmj/KgBc8L5
Oa2jI92vK4w4+jh/BAA0ZQhiArxa5/iqhvDyIfjtef0hwqSYmfwDnry1lM15vbXAmRLNnrZZw3eJ
3A6QGM3id+Ph5TdZRe+VAbWRdEIgNWRnouWRx5gAr0lBxCQA2CJ3TqA7di2ZxJ80zsb0fAT6bhnJ
RczoQ81Yf57NUmtncQH379rp6HXPR+5ni1bmX2XLVXPSe7uKoTKC2yyHfUAPSh/rCbE6AnQ6QtRh
AmEAAF4UOVEE4ETE3RXgLi8AhxAQzlh0PnAF7TdOE43zoUKPpPAfgZFyROzAA0/XsVUfS7SZc5k9
AwAvvR1JvfhhNPcBAND+zuC/ZgS57OVD/N+0yI00GMGt0QfzwCRKIO17nJZRxmqKWesIDqQQXyf6
gOn0hUnZjx/Pq2I1j2QOKm7eVH8hFay0t1ptYFkF+Xa08I2xchhBr4/n1gNADy3trC8l17/zKL8c
AOBoHTrqb3Jc8gevdxR9pMrDu4p99S5YV32Lszqi9Xgql+9Agq8512RUoNUAMMvw/9ph3FowUo4R
e/BILQuYHxay69aOIHu/1Ft4G+5l1v1pmC+14XAVq+jeBNDmJXpvIP8emPxA0kuJ9N9LOcJpyiMj
gctI9IEwE7mYcdl4/L4K9oQ59akpiLej6KV0vIW/X48sSouyiQG6iAPjRNOpaxtSg6ghph4pKX6+
+VvgZQFDFEwxOS75sq+1oGtS5e46CPZ4BMkl0ZhF9W0wO/HoSjO6Yvg7pRcVa5zYlHkJ7Tx0mdUc
ZfpeITKef9J/G6BxBFE5Hk5THhIODubTc8RnWmWzBtN8ldmPUlPPpXHnwtxgKBgpRwsPVVGZOMpc
5TCgZCPk1pC5EsXMolPkG1GZOCD0G9Ip9BvSKexb3GNcNo6WCqjESH62Ek0L7TyUJtCDuouD1O4B
AODmr2DwmDFSHlrJmyxvks+7jqTbGZ0WkXoAp4J54dvMpz+jTw3/vNybfxmMHtKGMiy5sixHVSPX
sqUc3R/Ck/zEpAE9KDn3533UplhShmlxAxTbIjRHC/UtQj3AvXWX8qkof0Us95mJPEzmJbQucCsZ
dLKGtdQjSSOFriK9RExvdYrc5+0CPP+949z/nqxhKysbuNuVDdzt4usss6+CPZG0R3i+4Bpqo6ic
CLK2Li8iVTt4cA8hRu0cAAD3LuBu+FtqBiH5sssaQHKVFgDg1TD+VS0Nq3H2Gluz6SKhdVcMZuoh
PK38JtcIAODvhh1Nemnmp+viaXNl+L6a/N7oX3qYNwxVu4ZQCc+ZGcbPMi07VksorVzblKeDiKcy
xhKrto7ktga6gGlPy7xyFL+auk94ydppstJUs7aZE2J3ko+tKSH+CfcS6orTS4R0qXMjPCjfZ8Oo
cZ6PiJpnJj/Vt/FISjLWVxwT6I5VUyf6uYv9AAAOXEEHpY5LDmOtax0MSAxj0T3EQXE+VOiRK2yp
WuO24kgtOrq5hL0fhRrRHZkmbsHFG9o8MMZUNbddgxij58cCwDala6hWZ4IUUV6U/8nU9nnc136V
nrJ2BJ8/xm2VKGZyqlHOnGPkHK17YalB3nPYyPbklQ3cbQD4W1BXahkAQF0ze3/q19MNOyf6ooQn
A/gnTz8pvWalxL4K9gTMUpvsAj3UCw0FgD1KJ0XRQhQAQGYlmSm1Mi7ZC1y4wd78+QbIzefpVuPY
avq4iZrikFYUkW3m72ESbmi9CzY7PshN99vwCgAw+t6OIYqQCp68OM+283wDXQixQ4L7WnjQEprB
TM/Fz4/aJUy2lXIAKNsIxly8wTYaOq84Hyo0fSS5vGIK/8uaodyOJD9xOljo7Xr9R/w6qIwif4/g
VO3K1j3cmKO1IGnQyw6Te6vIvXLHwtwgbMVQcqFa40qEdKXcI2llT4SBssa2U76+boLpzoN0qDuS
dE0rMcRDGGL8vzMFziFdKXe58wEAKAUFGebJD5MqD3YVg8yVTQ1fV+zQmvwkB7PkFDnHexPpvbGY
VexFLYEkkOYF01g9FZw5jlh7JIU78kKo8BYYeR4LrqF9Lx7GqbG7cAiYYZN+fobdVn5LeW+uMDcI
Sw2ihsgdj/Cg7ntRC2ul7THZm8ypRjkgLzA9O1x4w5JwDQOz+oivgMbeg+XbDuUhbu3Xacb5iOPM
laF1AzZj6G4OoJjrYJo8ZEwfd+kRMclPTDJXNiUmh1Kj8lL4XEyAlDuVWVhIvh6yDYe8e5xb0VEL
u0rPwZiF0fi1Y49zP5qE2zAZFWh1XBaOi94ujF9XxO48Vs3K2r1yPJ2DnwZlpaI3xHOyzpvBHvds
tFXFhOxOmfIjSAV7oomVj/qE1nCN3AlERrQX1VPhvHakBVPxb/Xn52o938epbXCdlIv4nUf5+eaE
jcwdKL3FkMo9Kxqn11uQbBjOs2GUpAKbmzC1ZgS5zMgAb0fiPipxcQH3744O+NOyaJw1nli/OJJf
BCaOgjfzyblp2cIsa+3YkzVs5dzj5FxQUBJ3HbgvjcF/kTo2pRc/GQBgTxWxW+56xWFy2RlymYqM
9HBvcWJBKleQPpJcntKLilXyj3s6YWLBIDwzYzQnuZ2lHP8YyLdJ8Cm+SZyXkmV9vLBeS33je1KD
PhrcZgXeAKMWa0YqKEhxA5JbaKS/Gs79N5ym2hnwnCBv6Jry9yg88+Xewp9A4dldbBAeSK6O0nMA
AMgYS6yS2uguvZRI//g0t9FWcnx0ituYVYmyQGG2syCCXzC+J9VmXcTfDTu27lLJHKsRZb2Mije5
sRS07ohBvxAqvJU1hvuxdJJQsieJ2LBoMP7z9DAqKTFAFzExWBe/chi58NIz/KWlUfwqMNMwi/EQ
B68ZQS4zGOKn65GkSzfRR0zInUBkyK1neDtjPD+SenHvWG6vlAy5V1Ge2pREyUg/eZ04qXApfS6N
Ozf7UWpqWHeK9nTCRIw3FRjsKhkuIclYH2GslNzGdHdADyQdVmmKNT2MSjLeEd+YTeXkJlvLkrJX
mFF7R3GnFXrvWG6v8e8iwQclAACdUYG2K23lpDhMXm7kWuYOxHNleltJ3HUQnOQnBif58bbcJZF+
ubfwDoUIDADzTl4TC0HaDU0P9xYnnpnIxWeOI3buriJ3VzdDtasOXOM8hbir04TXlO4j+wqRPVxF
ECUj/VA1HJKR6758K2I5i38gq0rIVcO9uXgAoHOqEYzSt9+F3+UBbZukNNX8RyTXLtTGQAsvdkhS
1LAsPKz0aa5Erl0AoM9M5H7ydcV+VY1cy/9EcUsAgFlfSq5PU6hX1RPx0SluYyfZqJj5soRYBQBQ
0cA15V5FSnFNdGqA+OLqOC4jawz34+YRXPbrfYSFoJKwk3MV5agJodRzltaz9fl1HZdQtrmE3T/h
wD2Pz7OHiC5NbPtz3LsgRS+crZCbYg3oQemVvGvxXmK8ZLkv1VeqXCul9Wx9/G48HFSM9pwk/vu/
R+GZhqSxrF9YxUVcTa665P04WaXhjoCpvQNFTAsUrywi3tNvJn2MPR2tayM2kym/Dh039aQgibUo
tZX0f5xql2NgU3aWs0ePVbNlThg5OlPtjzti0eK0YDmklEFuBHHRgTModERLo/ilk0OpNutN0V5U
z7xkLtf4OnNsMwN5VWzRxO8pxc31Qt1gyPuD7k3zl58ll6vVqUlBzl5ja8Zn4/FKDdsYJi4Lx3lu
FMPpDWKfNw7zi01DIzLK2LzSBrDVaj4z/wTZbhM8qV0e1fz/eyvYE3JhC1rQujn2gO4wwNI2zMWV
Ets9B7mYtKvNYg2o9OJbR3Jbi6egwyuHkQu3JBIrC1K5AjBRKj9n0axIbwPby+7mzcjDM1RkAABg
NpUh1VAnzYs9eyvYE2raaSOY8dl4vBYX4DOH8DM2kIf55GfiE6lI4AAnMcC0DIGo+sxm5BFaXpAk
SkF6xgTJGPe22H3elECX9gudcrZY+U2uUcM0kw5zg6Fv9BUWyaXjBrpA4DBfyqIdX9afZ7NmH8Nz
QOEd5F5FeVoCSM36/MH2srt5w3bjYU2s9R+RkYEZl43H79UYgn2yhq2c8oNVSsJkV6H9fz3Cvy91
cEA3sV0vrSUfpKqRawnPwOGWPKdgF1GTV8vDQTq4T4t85jKwu2iaGanIh2fJD8D6jktzCoIUK35i
N79dgOfLyMF8VoQ1pR+Y/TAPV7HFQVvJoE9+JhbING4JTGUTFFqSn7CllD1o4fSP+fw88e+xu4Vp
cidIhcJojUE6x7B1od+QvVcVE++bI9tYX3GMFoPVTSe6SZWr2UjmonfBOn9nME20AwrJp91mlLF5
rTs/ar1vJr8O7TE9P8lPTDIOBzGXDwvZdVJKUnsH6rR+jcCih1nbzAl/PcK/H7EDDzT3ByABs+QU
ucR/kxhlaX7C3gr2hN/XpN8/fyLnaZCFyb2Kto/ag0e/nse/Z66sV+9oT/SqvsXdnZXLL4jKxFHL
z5LzWz9GoyYfnZfM5aptPnC5GV2Wlg9Z/QUsYzhBlJryMWo73b/wAz9v6WlyKWh4H68cxa/G7BCS
//wjfsP0/Faj32I+LGTXtdZ7v715x7HiR1KNsclXbv3dsOM4PzQu2ZdPHu4txsvkChvDVDZB5X/L
yP9uuIA22nLbUW9njOP1KH6opzA0yEUM8ncW/RvuosaKJlRReB2dPFCFDqptjGZgehiVtHE4twFa
NxZbcopc8u5xboU18oXTlIe/M/j7OoGvjgSd6U6IJALCz1H0L2DQcaUU3ZCulLvpB3466tPMr/Sn
njL6whUzvwDP/6CQXafl2tYMyydieggxAS6ivwMJDtdbUP3FW6js0FUid99lcZ+xA2ZhNH5tahD/
TFcddNv2C7H1jcO81fsUBnWlXC9O4hoAAG7ehTK177t3yGegDehdsK6XK+rp5wT+ekdRr3cEvQsl
ugAA1N1BtZXNqPJCI5SZkx77e+Lvhh31Tkh/6y40dqad5wHubQ/7VC/xKT8n0a+skbiwuUzc3FFf
5wp0x67eTsjregvUd9ZPd8tRmEZkR9LiGNC4cUaHKogdO52JTQnkZ9OChKkAQOfXoT0xO6Q3zTPG
pt9Jt2Ons7IwGr9mUA4AYF48TM5Qu8YUm+1zZcdOZ2JmP2ri6rj7ofbMm/nkXEumyPYplp0/HDP6
UCmtm8fRAAA51WjbqF3CZK3X220QO39YWreivR993sRCRcg2MsSczEq7DWLnoSfSk/K/OQNdeLEv
NQHg3o4ymeOItSapGcygTBxtTdqxfQSx81CyYBCe2Zp8Z+xybpPa23877m/JTi6qm1fbsdPZobuI
BmVolzadX4eOT84hJlc0sFZ/rto+xbLzUJJ/jTgO7cNYmPkFeH7MDiG5ooGzybfc7VMsOw8tS2Pw
X+YP4Oc3cdD0nxJy7epitNoWYUtIKlPOjh07duzYsWPHjh07dh4A/wcMRwRD90zgYwAAAABJRU5E
rkJggg==`,ep=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(au(),"poster","width","display","height","speed")),_()(p()(y),"data",{poster:"",status:"",display:"show",speed:"",width:"",height:""}),_()(p()(y),"options",{}),y.options=w,w.player.poster?y.data.poster=w.player.poster:y.data.poster=ml,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"resetPosition",value:function(){if(this.element){var y=this.element.parentNode.offsetWidth,w=this.element.parentNode.offsetHeight;this.element.style.width=y+"px",this.element.style.marginTop=(w-this.element.offsetHeight-20)/2+"px"}}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.LoaderUpdateSpeed,function(w){y.data.display==="show"&&(y.data.speed=pl.formatBytes(w.speed)+" /s")})}},{key:"hide",value:function(){this.data.display!=="hide"&&(this.element.style.opacity=0,this.element.style.display="none",this.data.display="hide")}}]),A}(yr);function tp(){var $=sr()([`
    <gp-control class="goldplay__control--container `,'" style="width:',"px;height:","px;opacity:",'" data-status="',`">
      `,`
      `,`
      `,`
    </gp-control>
  `]);return tp=function(){return $},$}var np=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(tp(),"containerFloatCss","width","height","opacity","status","progressBarName|component","sideControlBarName|component","nearControlBarName|component")),_()(p()(y),"hideDelayTime",void 0),_()(p()(y),"hideTimeCount",void 0),_()(p()(y),"data",{progressBarName:"progressBar",sideControlBarName:"sideControlBar",nearControlBarName:"nearControlBar",width:"",height:"",opacity:1,containerFloatCss:"",display:"show",status:""}),_()(p()(y),"options",{}),y.options=w,y.hideDelayTime=y.options.player.controlBarAutoHideTime||3,w.player.controlBarAutoHide&&(y.data.containerFloatCss=y.options.cssName.controlContainerFloat,y.resetPosition()),Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"initProps",value:function(){this.hideTimeCount=this.hideDelayTime}},{key:"bindEvent",value:function(){var y=this,w=this.options;w.player.controlBarAutoHide&&(w.$container.addEventListener("mousemove",function(){y.hideTimeCount<=0&&(y.data.display="show",y.show()),y.hideTimeCount=y.hideDelayTime}),setInterval(function(){y.hideTimeCount>0?y.hideTimeCount-=1:y.data.display!=="hide"&&(y.data.display="hide",y.hide())},100))}},{key:"setSize",value:function(y,w){y!==void 0&&(this.data.width=y),w!==void 0&&(this.data.height=w)}},{key:"show",value:function(){var y,w=this;this.options.player.controlBarAutoHide?(clearTimeout(y),y=setTimeout(function(){w.data.opacity=1},1)):this.data.opacity=1}},{key:"hide",value:function(){this.data.opacity=0}},{key:"resetPosition",value:function(){this.setSize(this.options.$container.offsetWidth,this.options.player.controlBarHeight)}}]),A}(yr),rp=M.a.get("Delegator.js");function su($){return typeof HTMLElement<"u"?$ instanceof HTMLElement:N()($)==="object"&&$.nodeType===1&&typeof $.nodeName=="string"}function ou($){$.preventDefault(),$.stopPropagation()}function $f($,A,y,w,I){var W=function(oe,pe){if(oe&&oe.matches){if(!Array.isArray(pe))return oe.matches(pe);for(var Oe=0,et=pe.length;Oe<et;Oe++)if(oe.matches(pe[Oe]))return!0}return!1};function Y(oe){for(var pe=(oe=oe||window.event).target||oe.srcElement,Oe=oe.currentTarget,et=!0;et&&pe!==Oe&&pe;){if(W(pe,y)&&(et=w.call(pe,oe)!==!1),!et)return void ou(oe);pe=pe.parentNode}}w.__delegateWrapper=Y,function(oe,pe,Oe,et){et===void 0&&(et=pe==="blur"||pe==="focus"),su(oe)&&oe.addEventListener(pe,Oe,et)}($,A,Y,I)}var ip=function(){function $(A){return s()(this,$),_()(this,"element",null),su(A)?this.element=A:rp.error("constructor","new instance","element:",this.element),this}return l()($,[{key:"off",value:function(A,y,w){return y.__delegateWrapper&&delete(y=y.__delegateWrapper).__delegateWrapper,this.element.removeEventListener(A,y,w),this}},{key:"on",value:function(A,y,w,I){var W=this;return Array.isArray(y)?y.forEach(function(Y){$f(W.element,A,Y,w,I)}):$f(this.element,A,y,w,I),this}},{key:"once",value:function(A,y,w,I){return this.on(A,y,w,{capture:I,once:!0}),this}}]),$}(),lu=null,Ur=function($){return typeof $=="string"&&($=document.querySelector($)),lu?lu.element=$:lu=new ip($),lu},lc=function(){function $(A,y){var w=y.$container,I=y.type,W=y.scope,Y=y.onStart,oe=y.onDrag,pe=y.onRelease;s()(this,$),_()(this,"$container",null),_()(this,"$ele",null),_()(this,"active",!1),_()(this,"offsetX",0),_()(this,"offsetY",0),_()(this,"offsetLeft",0),_()(this,"offsetTop",0),_()(this,"orginOffsetLeft",0),_()(this,"orginOffsetTop",0),_()(this,"orginOffsetWidth",0),_()(this,"orginOffsetHeight",0),_()(this,"initialX",0),_()(this,"initialY",0),_()(this,"type","default"),_()(this,"scope",{}),this.$container=w||document.body,this.$ele=A,this.type=I,this.scope=W,this.eventsList={},this.onStart=Y,this.onDrag=oe,this.onRelease=pe,this.bindEvent()}return l()($,[{key:"addEventListener",value:function(A,y,w){var I=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return A.addEventListener(y,w,I),{destroy:function(){A.removeEventListener(y,w)}}}},{key:"removeEventListenerAll",value:function(){var A=this;Object.keys(this.eventsList).forEach(function(y){A.eventsList[y].destroy()})}},{key:"bindEvent",value:function(){var A=this;this.eventsList.mousedown=this.addEventListener(this.$container,"mousedown",function(y){A.start(y)},!1),this.eventsList.mouseup=this.addEventListener(this.$container,"mouseup",function(y){A.release(y)},!1),this.eventsList.mousemove=this.addEventListener(this.$container,"mousemove",function(y){A.drag(y)},!1)}},{key:"start",value:function(A){A.target===this.$ele&&(this.scope===void 0&&this.$container!==void 0&&(this.scope={left:this.$container.offsetLeft,right:this.$container.offsetLeft+this.$container.offsetWidth,top:this.$container.offsetTop,bottom:this.$container.offsetTop+this.$container.offsetHeight}),this.offsetLeft=this.$ele.offsetLeft,this.offsetTop=this.$ele.offsetTop,this.active=!0,this.initialX=A.clientX,this.initialY=A.clientY,this.orginOffsetLeft=this.$ele.offsetLeft,this.orginOffsetTop=this.$ele.offsetTop,this.orginOffsetWidth=this.$ele.offsetWidth,this.orginOffsetHeight=this.$ele.offsetHeight,typeof this.onStart=="function"&&this.onStart.call(this,this.offsetX,this.offsetY,A,this))}},{key:"release",value:function(A){this.active=!1,typeof this.onRelease=="function"&&this.onRelease.call(this,this.offsetX,this.offsetY,A,this)}},{key:"drag",value:function(A){this.active&&(A.preventDefault(),A.stopPropagation(),this.offsetX=A.clientX-this.initialX+this.offsetLeft,this.offsetY=A.clientY-this.initialY+this.offsetTop,this.setPosition(A))}},{key:"setPosition",value:function(A){switch(this.type){case"vertical":this.offsetX=this.orginOffsetLeft,this.offsetY<this.scope.top&&(this.offsetY=this.scope.top),this.offsetY>this.scope.bottom-this.orginOffsetHeight&&(this.offsetY=this.scope.bottom-this.orginOffsetHeight);break;case"level":this.offsetY=this.orginOffsetTop,this.offsetX>this.scope.right-this.orginOffsetWidth&&(this.offsetX=this.scope.right-this.orginOffsetWidth),this.offsetX<this.scope.left&&(this.offsetX=this.scope.left);break;default:isNaN(this.scope.right)||this.offsetX>this.scope.right-this.orginOffsetWidth&&(this.offsetX=this.scope.right-this.orginOffsetWidth),isNaN(this.scope.left)||this.offsetX<this.scope.left&&(this.offsetX=this.scope.left),isNaN(this.scope.top)||this.offsetY<this.scope.top&&(this.offsetY=this.scope.top),isNaN(this.scope.bottom)||this.offsetY>this.scope.bottom-this.orginOffsetHeight&&(this.offsetY=this.scope.bottom-this.orginOffsetHeight)}this.$ele.style.left=this.offsetX+"px",this.$ele.style.top=this.offsetY+"px",typeof this.onDrag=="function"&&this.onDrag.call(this,this.offsetX,this.offsetY,A,this)}},{key:"destroy",value:function(){this.$ele.parentNode.removeChild(this.$ele),this.removeEventListenerAll()}}]),$}(),uc=function($,A){return new lc($,A)};function cc(){var $=sr()([`
    <gp-control-progressbar class="goldplay__progress-bar `,'" data-status="',`">
      <div class="goldplay__progressbar--load `,`">
      </div>
      <div class="goldplay__progressbar--play `,`">
      </div>
      <span class="goldplay__progressbar--dot `,'" title="',`"></span>
    </gp-control-progressbar>
  `]);return cc=function(){return $},$}var gl=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(cc(),"progressBarHoverCss","status","progressBarLoadHoverCss","progressBarPlayHoverCss","progressBarDotHoverCss","time")),_()(p()(y),"options",{}),_()(p()(y),"data",{playWidth:"",dot:"",time:"",status:""}),_()(p()(y),"setProgressBarSize",function(I){y.$progressBarPlay.style.width=I+"px"}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"watch",value:function(){var y=this.options.cssName;this.data.status==="dragstart"?(this.data.progressBarHoverCss=y.progressBarHover,this.data.progressBarLoadHoverCss=y.progressBarLoadHover,this.data.progressBarPlayHoverCss=y.progressBarPlayHover,this.data.progressBarDotHoverCss=y.progressBarDotHover):this.data.status==="dragend"&&(this.data.progressBarHoverCss="",this.data.progressBarLoadHoverCss="",this.data.progressBarPlayHoverCss="",this.data.progressBarDotHoverCss="")}},{key:"afterInit",value:function(){}},{key:"initProps",value:function(){var y=this.element,w=this.options.cssName;this.$progressDragDot=y.querySelector("."+w.progressBarDot),this.$progressBarPlay=y.querySelector("."+w.progressBarPlay),this.$progressBarLoad=y.querySelector("."+w.progressBarLoad),this.timer=this.getComponent("timer"),this.pauseButton=this.getComponent("pauseButton")}},{key:"bindEvent",value:function(){var y=this,w=this.options.cssName,I=!1;this.events.on(ve.PlayerTimeUpdate,function(W){var Y=y.options.loadData.sourceData.duration;if(!I&&W&&Y){var oe=W/1e3/Y*y.progressBarWidth;y.setProgressPosition(oe),y.timer.data.time=Aa.formatHHMMSS(W/1e3)}}),this.events.on(ve.PlayerbufferUpdate,function(W){!I&&W&&y.updateProgressLoad(W)}),Ur(this.options.$controlBarContainer).on("click","."+w.progressBar,function(W){if(W.target!==y.$progressDragDot){var Y=(y.options.loadData.sourceData.duration||0)/y.progressBarWidth,oe=0;W.target.classList.contains(w.progressBarLoad)&&(oe=W.target.offsetLeft-W.target.parentNode.offsetLeft);var pe=oe+W.offsetX,Oe=pe*Y*1e3;return y.setProgressPosition(pe),y.logger.info("bindEvent","click to seek","seekTime:",Oe,"offsetX:",pe),W.target!==y.$progressBarLoad&&y.clearLoadBar(W.offsetX),y.timer.data.time=Aa.formatHHMMSS(Oe/1e3),y.events.emit(ve.PlayerOnSeek,Oe),!1}}),this.progressDragEvent=uc(this.$progressDragDot,{$container:document.body,type:"level",scope:{left:this.progressBarLeft,right:this.progressBarLeft+this.progressBarWidth,top:this.$progressDragDot.offsetTop,bottom:this.$progressDragDot.offsetTop+this.$progressDragDot.offsetHeight},onStart:function(){I=!0,y.data.status="dragstart"},onDrag:function(W){var Y;Y=y.options.player.controlBarAutoHide?W:W-y.options.$controlBarContainer.offsetLeft;var oe=0,pe=y.$progressDragDot.offsetWidth;y.progressBarWidth-Y<=pe&&(oe=pe),y.setProgressBarSize(Y),y.data.status="draging";var Oe=y.getSeekTime(y.progressBarWidth-oe);y.timer.data.time=Aa.formatHHMMSS(Oe/1e3),y.data.time=y.timer.data.time},onRelease:function(W,Y,oe){if(I){var pe=y.getSeekTime();oe.target!==y.$progressBarLoad&&y.clearLoadBar(W),y.events.emit(ve.PlayerOnSeek,pe),y.logger.info("bindEvent","onDrag release seek","seekTime:",pe),y.data.status="dragend",I=!1}}})}},{key:"setProgressPosition",value:function(y){var w=Math.min(y,this.progressBarWidth),I=this.$progressDragDot,W=this.progressBarWidth,Y=0,oe=I.offsetWidth/2;w>W||W-w<=oe?Y=oe-(W-w):w<=oe&&(Y=-(oe-w));var pe=w-Y-I.offsetWidth/2;this.setProgressPlayWidth(w),this.setProgressDragDotLeft(pe+this.progressBarLeft)}},{key:"setProgressPlayWidth",value:function(y){this.$progressBarPlay.style.width=y+"px"}},{key:"setProgressDragDotLeft",value:function(y){this.$progressDragDot.style.left=y+"px"}},{key:"getProgressPlayLeftWidth",value:function(){return{offsetLeft:this.$progressBarPlay.offsetLeft,offsetWidth:this.$progressBarPlay.offsetWidth}}},{key:"getProgressLoadLeftWidth",value:function(){return{offsetLeft:this.$progressBarLoad.offsetLeft,offsetWidth:this.$progressBarLoad.offsetWidth}}},{key:"setProgressLoadLeftWidth",value:function(y,w){var I=this.progressBarLeft+this.progressBarWidth;(y=Math.min(y,I))+w>I&&(w=I-y),this.$progressBarLoad.style.left=y+"px",this.$progressBarLoad.style.width=w+"px"}},{key:"updateProgressLoad",value:function(y){var w=this.options.loadData.sourceData.duration;if(w){var I=this.progressBarWidth,W=this.progressBarLeft,Y=y[0]/1e3/w*I,oe=y[1]/1e3/w*I,pe=Math.floor(W+Y),Oe=Math.floor(oe-Y);this.setProgressLoadLeftWidth(pe,Oe)}}},{key:"getSeekTime",value:function(y,w){var I=this.progressBarWidth,W=(w=w||this.options.loadData.sourceData.duration||0)/(y||I);return this.$progressBarPlay.offsetWidth*W*1e3}},{key:"clearLoadBar",value:function(y){y<this.$progressBarLoad.offsetLeft-this.progressBarLeft&&(this.$progressBarLoad.style.width="0px")}},{key:"getDragDotPosition",value:function(){return{offsetLeft:this.$progressDragDot.offsetLeft,offsetTop:this.$progressDragDot.offsetTop,left:this.$progressDragDot.style.left,top:this.$progressDragDot.style.top}}},{key:"clearDragDotTop",value:function(){this.$progressDragDot.style.top=""}},{key:"progressBarWidth",get:function(){return this.element.offsetWidth}},{key:"progressBarLeft",get:function(){return this.element.offsetLeft}}]),A}(yr);function ea(){var $=sr()([`
  <gp-button class="goldplay__control--play" data-status="`,'" title="',`">
  <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
  viewBox="0 0 232.153 232.153" width="20" height="20" style="enable-background:new 0 0 232.153 232.153;" xml:space="preserve">
  <g >
  <path style="fill-rule:evenodd;clip-rule:evenodd;" d="M203.791,99.628L49.307,2.294c-4.567-2.719-10.238-2.266-14.521-2.266
    c-17.132,0-17.056,13.227-17.056,16.578v198.94c0,2.833-0.075,16.579,17.056,16.579c4.283,0,9.955,0.451,14.521-2.267
    l154.483-97.333c12.68-7.545,10.489-16.449,10.489-16.449S216.471,107.172,203.791,99.628z" fill="#f1f1f1"/>
  </g>
  </svg>
  </gp-button>
  `]);return ea=function(){return $},$}var av=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(ea(),"status","title")),_()(p()(y),"data",{title:"play",play:">"}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),A}(yr);function Ff(){var $=sr()([`
  <gp-button class="goldplay__control--pause" title="`,'" status="',`">
  `,`
  </gp-button>
  `]);return Ff=function(){return $},$}function Bf(){var $=sr()([`
<svg style="display:`,`" class="goldplay__control--pausing" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 26 26" style="background:none" xml:space="preserve">
<g>
<path d="M2.667,0h6v26h-6V0z M15.333,0v26h6V0H15.333z" fill="#f1f1f1"/>
</g>
</svg>
`]);return Bf=function(){return $},$}var Uf=Ot.create(Bf(),"pauseHide"),zf=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(function(I,W){return W(Ff(),"title","status","icon|html")})),_()(p()(y),"data",{title:"pause",pauseHide:"",pauseLoadingHide:"none",icon:Uf,status:"",display:""}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"watch",value:function(){this.data.status==="pauseloading"?(this.data.pauseHide="none",this.data.pauseLoadingHide="inline-block",this.data.title="loading",this.data.icon=`
<svg version="1.1" class="goldplay__control--pause-loading" style="display:\${'pauseLoadingHide'}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="25px" height="25px" viewBox="0 0 612 792" style="background:none;margin: -4px 0 0 -5px;" xml:space="preserve">
<linearGradient id="goldplay-pause-loading-gradient" gradientUnits="userSpaceOnUse" x1="1.98" y1="784.6123" x2="26.2101" y2="770.623" gradientTransform="matrix(21.8571 0 0 21.8571 -2.0895 -16600.5293)">
    <stop offset="0.1682" style="stop-color:#f1f1f1;stop-opacity:0"></stop>
    <stop offset="0.7502" style="stop-color:#f1f1f1"></stop>
    <stop offset="1" style="stop-color:#f1f1f1"></stop>
</linearGradient>
<path style="transform-origin: center center;animation: goldplay-rotate-360 .8s linear infinite;" fill="url(#goldplay-pause-loading-gradient)" d="M306,133.714c144.257,0,262.286,118.028,262.286,262.286c0,144.257-118.029,262.286-262.286,262.286
  C161.743,658.286,43.714,540.257,43.714,396C43.714,251.743,161.743,133.714,306,133.714 M306,90C137.7,90,0,227.7,0,396
  s137.7,306,306,306s306-137.7,306-306S474.3,90,306,90L306,90z">
    <animateTransform attributeName="transform" attributeType="XML" type="rotate" from="0" to="360" dur=".8s" repeatCount="indefinite" />
</path>
<g>
    <g>
        <path fill="#f1f1f1" d="M229.5,514.028L229.5,514.028c-13.114,0-21.857-8.742-21.857-21.856V295.457
        c0-10.929,8.743-21.857,21.857-21.857l0,0c10.929,0,21.857,8.743,21.857,21.857v196.715
        C251.357,503.1,242.614,514.028,229.5,514.028z"></path>
        <path fill="#f1f1f1" d="M229.5,273.6c-13.114,0-21.857,8.743-21.857,21.857v196.715c0,10.928,8.743,21.856,21.857,21.856
        s21.857-10.929,21.857-21.856V295.457C251.357,282.343,242.614,273.6,229.5,273.6L229.5,273.6z"></path>
    </g>
    <g>
        <path fill="#f1f1f1" d="M382.5,518.4L382.5,518.4c-13.114,0-21.857-8.743-21.857-21.857V299.829
        c0-10.929,8.743-21.857,21.857-21.857l0,0c10.929,0,21.857,8.743,21.857,21.857v196.714
        C404.357,509.657,395.614,518.4,382.5,518.4z"></path>
        <path fill="#f1f1f1" d="M382.5,277.972c-10.929,0-21.857,8.743-21.857,21.857v196.714c0,10.929,10.929,21.857,21.857,21.857
        s21.857-10.929,21.857-21.857V299.829C404.357,288.9,393.429,277.972,382.5,277.972L382.5,277.972z"></path>
    </g>
</g>
</svg>
`):this.data.status==="pause"&&(this.data.pauseHide="inline-block",this.data.pauseLoadingHide="none",this.data.title="pause",this.data.icon=Uf)}}]),A}(yr);function fc(){var $=sr()([`
  <gp-button class="goldplay__control--replay" title="`,'" data-display="',`">
  <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
  width="24px" height="24px" viewBox="0 0 245.000000 206.000000"
  preserveAspectRatio="xMidYMid meet">
 <g transform="translate(0.000000,206.000000) scale(0.100000,-0.100000)"
 fill="#f1f1f1" stroke="1">
 <path d="M1250 2046 c-286 -55 -525 -211 -681 -445 -91 -136 -152 -302 -167
 -453 -12 -119 3 -108 -143 -109 -70 -1 -156 -4 -192 -8 l-65 -6 262 -265 262
 -265 266 265 265 265 -62 6 c-35 4 -123 7 -197 8 l-134 1 7 69 c26 284 232
 543 504 635 201 69 404 53 596 -47 62 -32 103 -63 177 -137 83 -83 102 -108
 142 -190 63 -130 77 -193 77 -340 0 -178 -37 -298 -134 -435 -91 -126 -220
 -224 -369 -278 -72 -26 -99 -31 -218 -35 -117 -4 -146 -1 -215 17 -104 29
 -205 79 -283 142 l-63 52 -89 -89 c-49 -49 -89 -96 -89 -106 0 -24 154 -136
 253 -185 89 -44 177 -74 272 -95 84 -17 303 -15 391 5 403 91 691 371 795 772
 19 76 23 114 22 240 0 129 -4 164 -27 249 -99 377 -406 673 -778 751 -104 22
 -297 28 -385 11z"/>
 <path d="M1227 1418 c-9 -68 -7 -695 2 -770 l6 -57 240 200 c132 110 251 210
 264 223 l23 24 -257 213 c-141 118 -260 215 -264 217 -5 1 -11 -21 -14 -50z"/>
 </g>
 </svg>
  </gp-button>
  `]);return fc=function(){return $},$}var vl=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(fc(),"title","display")),_()(p()(y),"data",{title:"replay",display:"",replay:"->"}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),A}(yr);function Vf(){var $=sr()([`
  <gp-volume class="goldplay__volume-bar">
    <gp-overbox class="goldplay-hoverbox goldplay__volume-bar--handle">
      <span class="goldplay__volume-bar--precent">`,`</span>
      <span class="goldplay__volume-bar--rod `,`" title="adjust volume"></span>
      <span class="goldplay__volume-bar--size">&nbsp;</span>
      <span class="goldplay__volume-bar--column">&nbsp;</span>
    </gp-overbox>
    <gp-button class="goldplay__volume-bar--audio `,'" title="','" data-mute="','" data-volume-size="','"  data-last-volume="',`">
    `,`
    </gp-button>
  </gp-volume>
  `]);return Vf=function(){return $},$}function hc(){var $=sr()([`
<svg xmlns="http://www.w3.org/2000/svg" style="display:`,`" width="20px" height="20px" viewBox="0 0 24 24" style="margin-left: -5px;">
<path d="M12.2 13.914v6.678a.5.5 0 0 1-.825.38L5.2 15.679H3a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2.2l.412-.353-2.558-2.558a.5.5 0 0 1 0-.707l.707-.707a.5.5 0 0 1 .707 0l16.849 16.849a.5.5 0 0 1 0 .707l-.707.707a.5.5 0 0 1-.707 0l-2.386-2.386a10 10 0 0 1-2.33 1.422c-.526.229-.583.284-.987.377v-2.375l.007-.003a8.332 8.332 0 0 0 1.717-1.014l-1.67-1.669a5.251 5.251 0 0 1-.054.034v-.089l-2-2zM8.373 4.96l3.002-2.572a.5.5 0 0 1 .825.38v6.019L8.373 4.959zm9.867 9.867c.48-.99.76-2.115.76-3.347 0-3.418-2.148-6.014-4.793-7.173a4.11 4.11 0 0 0-.007-.003V2c.027.006.054.012.082.02.852.221 1.274.453 1.436.535A10 10 0 0 1 21.2 11.48a9.954 9.954 0 0 1-1.326 4.98l-1.634-1.633zm-1.766-1.766L14.2 10.786V7.057a5.247 5.247 0 0 1 2.274 6.003z" fill="#f1f1f1"></path>
</svg>
`]);return hc=function(){return $},$}function ap(){var $=sr()([`
<svg xmlns="http://www.w3.org/2000/svg" style="display:`,`" width="20px" height="20px" viewBox="0 0 24 24" style="margin-left: -5px;">
<path d="M5.2 7.68l6.175-5.293a.5.5 0 0 1 .825.38v17.825a.5.5 0 0 1-.825.38L5.2 15.679H3a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2.2zm9 13.35v-2.375l.007-.003C16.852 17.493 19 14.897 19 11.479s-2.148-6.014-4.793-7.173a4.11 4.11 0 0 0-.007-.003V2c.027.006.054.012.082.02.852.221 1.274.453 1.436.535A10 10 0 0 1 21.2 11.48c0 4.106-2.474 7.633-6.013 9.174-.526.229-.583.284-.987.377zm0-13.973c1.5.925 2.5 2.582 2.5 4.473 0 1.892-1 3.55-2.5 4.473V7.057z" fill="#f1f1f1"></path>
</svg>
`]);return ap=function(){return $},$}var sp=Ot.create(ap(),"audioOnHide"),uu=Ot.create(hc(),"audioOffHide"),op=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(Vf(),"dataPrecent","volumeBarRodHoverCss","audioOffClass","title","dataMute","dataVolumeSize","dataLastVolume","icon|html")),_()(p()(y),"options",{}),_()(p()(y),"data",{audioONHide:"",audioOffHide:"",audioOffClass:"",dataVolumeSize:"",dataPrecent:"",dataLastVolume:"",dataMute:"",volumeBarRodHoverCss:"",icon:sp,title:"turn off"}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"watch",value:function(){this.data.dataPrecent=Math.floor(100*this.data.dataVolumeSize),this.data.audioOffClass!==""?(this.data.dataMute="true",this.data.audioOffHide="inline-block",this.data.audioOnHide="none",this.data.icon=uu,this.data.title="turn on"):(this.data.dataMute="",this.data.audioOffHide="none",this.data.audioOnHide="inline-block",this.data.icon=sp,this.data.title="turn off")}},{key:"initProps",value:function(){var y=this.element,w=this.options.cssName;this.INIT_VOLUME_SIZE=this.options.player.defaultVolumeSize===void 0?.5:this.options.player.defaultVolumeSize,this.$volumeBarHandle=y.querySelector("."+w.volumeBarHandle),this.$volumeBarRod=y.querySelector("."+w.volumeBarRod),this.$volumeBarAudio=y.querySelector("."+w.volumeBarAudio),this.$volumeBarSize=y.querySelector("."+w.volumeBarSize),this.$volumeBarColumn=y.querySelector("."+w.volumeBarColumn),this.volumeBarColumnHeight=this.$volumeBarColumn.offsetHeight,this.volumeBarColumnTop=this.$volumeBarColumn.offsetTop,this.volumeBarRodHeight=this.$volumeBarRod.offsetHeight,this.volumeBarRodHeightHalf=this.volumeBarRodHeight/2,this.volumeBarColumnRealTop=this.volumeBarColumnTop+this.volumeBarRodHeightHalf,this.volumeBarColumnMaxHeight=this.volumeBarColumnHeight-this.volumeBarRodHeight}},{key:"bindEvent",value:function(){var y,w=this,I=this.options.$controlBarContainer,W=this.options.cssName;Ur(I).on("mouseover","."+W.volumeBar,function(){clearTimeout(y),w.showVolumeBarHandle()}),Ur(I).on("mousewheel","."+W.volumeBarHandle,function(Y){var oe=Y.wheelDelta/500;oe=w.data.dataVolumeSize+oe,w.setVolumeSize(oe),Y.preventDefault(),Y.stopPropagation()}),Ur(I).on("click",["."+W.volumeBarColumn,"."+W.volumeBarSize],function(Y){var oe=0;return Y.target===w.$volumeBarColumn?oe=(w.$volumeBarColumn.offsetHeight-Y.offsetY)/Y.target.offsetHeight:Y.target===w.$volumeBarSize&&(oe=w.$volumeBarColumn.offsetHeight-Y.target.offsetHeight+Y.offsetY,oe=w.$volumeBarColumn.offsetHeight-oe,oe/=w.$volumeBarColumn.offsetHeight),w.setVolumeSize(oe),!1}),Ur(I).on("click","."+W.volumeBarAudio,function(Y){return w.$volumeBarAudio.classList.contains(W.volumeBarAudioOff)?w.setAudioOn(Y.offsetY):w.setAudioOff(Y.offsetY),!1}),Ur(I).on("mouseout","."+W.volumeBar,function(Y){y=setTimeout(function(){(function(oe){var pe=w.element,Oe={y:pe.offsetTop+w.$volumeBarHandle.offsetTop,x:pe.offsetLeft};return Oe.width=pe.offsetWidth,Oe.height=w.$volumeBarHandle.offsetHeight,oe.pageX>Oe.x&&oe.pageX<Oe.x+Oe.width&&oe.pageY>Oe.y&&oe.pageY<Oe.y+Oe.height})(Y)?clearTimeout(y):w.hideVolumeBarHandle()},re.c.hideBarBoxTime)}),this.volumeDragEvent=uc(this.$volumeBarRod,{$container:this.element,type:"vertical",scope:{top:this.volumeBarColumnTop,right:0,bottom:this.volumeBarColumnTop+this.volumeBarColumnHeight,left:0},onStart:function(){w.data.volumeBarRodHoverCss=w.options.cssName.volumeBarRodHover},onDrag:function(Y,oe){oe-=1,w.dragHandle(oe)},onRelease:function(){w.data.volumeBarRodHoverCss=""}})}},{key:"hideVolumeBarHandle",value:function(){this.$volumeBarHandle.style.visibility="hidden"}},{key:"showVolumeBarHandle",value:function(){this.$volumeBarHandle.style.visibility="visible"}},{key:"getVolume",value:function(){var y=(this.$volumeBarSize.offsetHeight-this.volumeBarRodHeight)/this.volumeBarColumnMaxHeight;return y=Math.min(y,1),(y=Math.max(y,0)).toFixed(2)}},{key:"setVolume",value:function(y){this.data.dataVolumeSize=Number(y),this.events.emit(ve.PlayerOnVolume,y)}},{key:"initVolumeSize",value:function(){this.data.dataLastVolume=this.INIT_VOLUME_SIZE,this.setAudioOn()}},{key:"setAudioOn",value:function(){var y=this.data.dataLastVolume||0;this.setVolume(y);var w=parseFloat(y,10),I=Math.floor(w*this.volumeBarColumnMaxHeight),W=this.volumeBarColumnTop+(this.volumeBarColumnMaxHeight-I);this.$volumeBarSize.style.marginTop=W+"px",this.$volumeBarSize.style.height=I+this.volumeBarRodHeight+"px",this.$volumeBarRod.style.top=W+"px",this.data.audioOffClass=""}},{key:"setAudioOff",value:function(){this.setVolume(0),this.data.audioOffClass=this.options.cssName.volumeBarAudioOff;var y=this.getVolume();y>0&&(this.data.dataLastVolume=y),this.$volumeBarSize.style.height=this.volumeBarRodHeight+"px",this.$volumeBarSize.style.marginTop=this.volumeBarColumnRealTop-this.volumeBarRodHeightHalf+this.volumeBarColumnMaxHeight+"px",this.$volumeBarRod.style.top=this.volumeBarColumnRealTop+this.volumeBarColumnMaxHeight-this.volumeBarRodHeightHalf+"px"}},{key:"dragHandle",value:function(y){this.$volumeBarSize.style.marginTop=y+1+"px",this.$volumeBarSize.style.height=this.volumeBarColumnHeight-y+this.volumeBarRodHeight+"px";var w=this.getVolume();w<=0?this.setAudioOff(y):this.data.dataMute=="true"&&this.setAudioOn(y),this.setVolume(w)}},{key:"setVolumeSize",value:function(y){if((y=y.toFixed(2))>=1?y=1:y<.001&&(y=0),y!==this.data.dataVolumeSize){this.setVolume(y);var w=this.volumeBarColumnMaxHeight,I=w-y*w+this.volumeBarColumnTop;this.$volumeBarSize.style.marginTop=I+"px",this.$volumeBarSize.style.height=y*w+this.volumeBarRodHeight+"px",this.$volumeBarRod.style.top=I+"px",y<=0?this.data.audioOffClass=this.options.cssName.volumeBarAudioOff:this.data.dataMute=="true"&&(this.data.audioOffClass="")}}}]),A}(yr);function sv(){var $=sr()([`
  <gp-wait class="goldplay-tip goldplay__waiting-bar" title="`,'" data-status="',`">
    <span class="goldplay__waiting-bar--icon">
    <svg width="60px" height="60px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" style="background: none;opacity:0.8">
    <circle cx="50" cy="50" fill="none" stroke-linecap="round" r="40" stroke-width="8" stroke="#f6f6f6" stroke-dasharray="62.83185307179586 62.83185307179586" transform="rotate(17.8841 50 50)">
    <animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="0.7s" begin="0s" repeatCount="indefinite">
    </animateTransform>
    </circle>
    </svg>
  </span>
  <gp-speed class="goldplay__waiting-bar--speed">`,`</gp-speed>
  </gp-wait>
  `]);return sv=function(){return $},$}var EC=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(sv(),"title","status","speed")),_()(p()(y),"data",{title:"waiting",speed:"",status:"",display:"show"}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"initProps",value:function(){}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.LoaderUpdateSpeed,function(w){y.data.display==="show"&&(y.data.speed=pl.formatBytes(w.speed)+" /s")})}},{key:"showWaiting",value:function(){var y=this.options.cssName,w=this.options.$screenContainer;w.querySelector("."+y.waitingBar)||w.prepend(this.element),this.data.display="show",this.show(),this.resetPosition()}},{key:"hideWaiting",value:function(){var y=this.options.cssName;this.options.$screenContainer.querySelector("."+y.waitingBar)&&(this.data.display="hide",this.data.speed="Loading...",this.hide())}}]),A}(yr);function ix(){var $=sr()([`
  <gp-alert class="goldplay-tip goldplay__alter-box" title="`,'" data-display="',`">
  <em title="close" class="goldplay__alter--close">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="background:none;opacity:0.6" xml:space="preserve" width="20px" height="20px" viewBox="0 0 496.158 496.158">
    <path style="fill:#ff3300;" d="M496.158,248.085c0-137.021-111.07-248.082-248.076-248.082C111.07,0.003,0,111.063,0,248.085
    c0,137.002,111.07,248.07,248.082,248.07C385.088,496.155,496.158,385.087,496.158,248.085z"/>
    <path style="fill:#FFFFFF;" d="M277.042,248.082l72.528-84.196c7.91-9.182,6.876-23.041-2.31-30.951
    c-9.172-7.904-23.032-6.876-30.947,2.306l-68.236,79.212l-68.229-79.212c-7.91-9.188-21.771-10.216-30.954-2.306
    c-9.186,7.91-10.214,21.77-2.304,30.951l72.522,84.196l-72.522,84.192c-7.91,9.182-6.882,23.041,2.304,30.951
    c4.143,3.569,9.241,5.318,14.316,5.318c6.161,0,12.294-2.586,16.638-7.624l68.229-79.212l68.236,79.212
    c4.338,5.041,10.47,7.624,16.637,7.624c5.069,0,10.168-1.749,14.311-5.318c9.186-7.91,10.22-21.77,2.31-30.951L277.042,248.082z"/>
    </svg>
  </em>
  <span class="goldplay__alter--warn">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    width="30" height="30" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512;" xml:space="preserve">
    <path style="fill:#495A79;" d="M501.461,383.799L320.501,51.401C306.7,28.6,282.7,14.8,256,14.8s-50.7,13.8-64.501,36.601
      L10.539,383.799C-3.259,407.501-3.56,435.701,9.941,459.4c13.499,23.699,37.798,37.8,65.099,37.8h361.92
      c27.301,0,51.601-14.101,65.099-37.8C515.56,435.701,515.259,407.501,501.461,383.799z"/>
    <path style="fill:#42516D;" d="M502.059,459.4c-13.499,23.699-37.798,37.8-65.099,37.8H256V14.8c26.7,0,50.7,13.801,64.501,36.601
      L501.461,383.8C515.259,407.501,515.56,435.701,502.059,459.4z"/>
    <path style="fill:#FFDE33;" d="M475.661,399.1L294.699,66.699C286.601,52.9,271.901,44.8,256,44.8s-30.601,8.101-38.699,21.899
      L36.339,399.1c-8.399,14.101-8.399,31.199-0.298,45.3c8.099,14.399,22.798,22.8,39,22.8h361.92c16.201,0,30.901-8.401,39-22.8
      C484.06,430.299,484.06,413.201,475.661,399.1z"/>
    <path style="fill:#FFBC33;" d="M475.96,444.4c-8.099,14.399-22.798,22.8-39,22.8H256V44.8c15.901,0,30.601,8.101,38.699,21.899
      L475.661,399.1C484.06,413.201,484.06,430.299,475.96,444.4z"/>
    <g>
      <path style="fill:#495A79;" d="M256,437.2c-16.538,0-30-13.462-30-30s13.462-30,30-30s30,13.462,30,30S272.538,437.2,256,437.2z"/>
      <path style="fill:#495A79;" d="M286,317.2c0,16.538-13.462,30-30,30s-30-13.462-30-30v-150c0-16.538,13.462-30,30-30
        s30,13.462,30,30V317.2z"/>
    </g>
    <g>
      <path style="fill:#42516D;" d="M286,407.2c0-16.538-13.462-30-30-30v60C272.538,437.2,286,423.738,286,407.2z"/>
      <path style="fill:#42516D;" d="M286,317.2v-150c0-16.538-13.462-30-30-30v210C272.538,347.2,286,333.738,286,317.2z"/>
    </g>
    </svg>
  </span>
  <gp-content class="goldplay__alter--content">`,`</gp-content>
  </gp-alert>
  `]);return ix=function(){return $},$}var lp=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(ix(),"title","display","content|trim")),_()(p()(y),"data",{title:"alert",display:"default",content:""}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"bindEvent",value:function(){var y=this,w=this.options.$screenContainer,I=this.options.cssName;Ur(w).on("click","."+I.alertClose,function(){y.hide()})}},{key:"afterWatch",value:function(){this.data.display==="show"&&this.resetPosition()}},{key:"showBox",value:function(){var y=this.options.cssName,w=this.options.$screenContainer;w.querySelector("."+y.alertBox)||w.prepend(this.element),this.data.display="show",this.show()}},{key:"hideBox",value:function(){var y=this.options.cssName;this.options.$screenContainer.querySelector("."+y.alertBox)&&(this.data.display="hide",this.hide())}},{key:"show",value:function(){this.element.style.opacity=1,this.element.style.display="inline-block",this.resetPosition()}},{key:"hide",value:function(){this.element.style.opacity=0,this.element.style.display="none"}}]),A}(yr);function ov(){var $=sr()([`
  <gp-time class="goldplay__control--timer">
  <span gid="time" class="goldplay__control--timer-play">`,`</span>
  <span gid="slash">`,`</span>
  <span gid="total-time" class="goldplay__control--timer-total">`,`</span>
  </gp-time>
  `]);return ov=function(){return $},$}var AC=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(ov(),"time","slash","totalTime")),_()(p()(y),"data",{time:"00:00",totalTime:"",slash:"/"}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"setTotalTime",value:function(y){var w=y.sourceData;this.data.totalTime=Aa.formatHHMMSS(w.duration)}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.LoaderPlayListLoaded,function(w){y.setTotalTime(w.loadData)})}},{key:"updateTime",value:function(y){this.element.querySelector('[gid="time"]').innerHTML=y}},{key:"updateTotalTime",value:function(y){this.element.querySelector('[gid="total-time"]').innerHTML=y}}]),A}(yr);function lv(){var $=sr()([`
  <gp-speed class="goldplay__speed-bar" title="`,`">
  <gp-overbox class="goldplay-hoverbox goldplay__speed-bar--box">
  `,`
  </gp-overbox>
  <gp-button class="goldplay__speed-bar--link">
  `,`
  </gp-button>
  </gp-speed>
  `]);return lv=function(){return $},$}var MC=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(lv(),"title","speedListHTML|html","currentSpeedName")),_()(p()(y),"data",{title:"speed",currentSpeed:1,speedList:null,currentSpeedName:"",speedListHTML:""}),_()(p()(y),"options",{}),y.options=w,y.speedList=y.options.player.options.speedList||re.c.speedList,y.updateSpeedListHTML(),Object.assign(y.data,w.data),y.init(),y.initProps(),y.showHideBar(),y}return g()(A,$),l()(A,[{key:"initProps",value:function(){var y=this.options.cssName;this.$barBox=this.element.querySelector("."+y.speedBarBox)}},{key:"bindEvent",value:function(){var y=this,w=this.options.cssName,I=this.options.$controlBarContainer;Ur(I).on("mouseover","."+w.speedBar,function(){clearTimeout(W),y.showBarBoxHandle()});var W;Ur(I).on("mouseout","."+w.speedBar,function(Y){W=setTimeout(function(){(function(oe){var pe=y.element,Oe={y:y.$barBox.offsetTop,x:pe.offsetLeft};return Oe.width=pe.offsetWidth,Oe.height=y.$barBox.offsetHeight,oe.pageX>Oe.x&&oe.pageX<Oe.x+Oe.width&&oe.pageY>Oe.y&&oe.pageY<Oe.y+Oe.height})(Y)?clearTimeout(W):y.hideBarBoxHandle()},re.c.hideBarBoxTime)}),Ur(this.element).on("click","[gp-node-li]",function(Y){var oe=Y.target,pe=parseFloat(oe.getAttribute("value"),10);if(pe!==y.data.currentSpeed){y.data.currentSpeed=pe;var Oe=y.speedList.filter(function(et){return et.value===pe});y.events.emit(ve.PlayerSpeedTo,Oe[0]),y.updateSpeedListHTML()}})}},{key:"showHideBar",value:function(){this.speedList.length<=0&&this.hide()}},{key:"resetBoxPosition",value:function(){var y=33+28*this.speedList.length,w=(this.$barBox.offsetWidth-this.element.offsetWidth)/2;this.$barBox.style.marginTop=-y+"px",this.$barBox.style.marginLeft=-w+"px"}},{key:"hideBarBoxHandle",value:function(){this.$barBox.style.visibility="hidden"}},{key:"showBarBoxHandle",value:function(){this.$barBox.style.visibility="visible"}},{key:"updateSpeedListHTML",value:function(y){var w=this.speedList;if(!(w.length<=0)){y===void 0&&(y=this.data.currentSpeed);var I=w.slice(0,w.length).reverse(),W=!0,Y=!1,oe=void 0;try{for(var pe,Oe=I[Symbol.iterator]();!(W=(pe=Oe.next()).done);W=!0){var et=pe.value;et.value===y?et.selected=!0:delete et.selected}}catch(pt){Y=!0,oe=pt}finally{try{W||Oe.return==null||Oe.return()}finally{if(Y)throw oe}}return this.data.speedListHTML=function(pt){if(pt){var sn=["<ul>"],kn=!0,Mr=!1,kr=void 0;try{for(var ti,Vi=pt[Symbol.iterator]();!(kn=(ti=Vi.next()).done);kn=!0){var Bn=ti.value,Hf="",pc="";Bn.selected&&(Hf="gp-selected",pc=" selected=".concat(Bn.selected)),sn.push(`
    <li class="`.concat(Hf,'" gp-node-li value="').concat(Bn.value,'" ').concat(pc,">").concat(Bn.name,`</li>
    `))}}catch(ms){Mr=!0,kr=ms}finally{try{kn||Vi.return==null||Vi.return()}finally{if(Mr)throw kr}}return sn.push("</ul>"),sn.join("")}}(I)}}}]),A}(yr);function ax(){var $=sr()([`
  <gp-subtitle class="goldplay__subtitle">
  </gp-subtitle>
  `]);return ax=function(){return $},$}var uv=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(ax())),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),A}(yr);function cv(){var $=sr()([`
  <gp-rate class="goldplay__rate-bar" title="`,`">
  <gp-overbox class="goldplay-hoverbox goldplay__rate-bar--box">
  `,`
  </gp-overbox>
  <gp-button class="goldplay__rate-bar--link">
  `,`
  </gp-button>
  </gp-rate>
  `]);return cv=function(){return $},$}var kC=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"rateList",[]),_()(p()(y),"defaultRate",{value:"600",name:""}),_()(p()(y),"template",y.createTemplate(cv(),"title","rateListHTML|html","currentRateName")),_()(p()(y),"data",{title:"stream rate",currentRate:"600",currentRateName:"",rateListHTML:""}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.rateList=y.options.player.options.rateList||y.rateList,y.defaultRate=y.options.player.options.defaultRate||y.defaultRate,y.setDefaultRate(),y.updateRateListHTML(),y.init(),y.initProps(),y.showHideBar(),y}return g()(A,$),l()(A,[{key:"initProps",value:function(){var y=this.options.cssName;this.$barBox=this.element.querySelector("."+y.rateBarBox)}},{key:"setDefaultRate",value:function(){var y=this;if(!(this.rateList.length<=0)){var w=this.rateList.find(function(I){return String(I.value)===String(y.defaultRate.value)});w?(this.data.currentRateName=w.name,this.data.currentRate=w.value):(this.data.currentRateName=this.rateList[0].name,this.data.currentRate=this.rateList[0].value)}}},{key:"bindEvent",value:function(){var y=this,w=this.options.cssName,I=this.options.$controlBarContainer;Ur(I).on("mouseover","."+w.rateBar,function(){clearTimeout(W),y.showBarBoxHandle()});var W;Ur(I).on("mouseout","."+w.rateBar,function(Y){W=setTimeout(function(){(function(oe){var pe=y.element,Oe={y:y.$barBox.offsetTop,x:pe.offsetLeft};return Oe.width=pe.offsetWidth,Oe.height=y.$barBox.offsetHeight,oe.pageX>Oe.x&&oe.pageX<Oe.x+Oe.width&&oe.pageY>Oe.y&&oe.pageY<Oe.y+Oe.height})(Y)?clearTimeout(W):y.hideBarBoxHandle()},re.c.hideBarBoxTime)}),Ur(this.element).on("click","[gp-node-li]",function(Y){var oe=Y.target.getAttribute("value");if(oe!==y.data.currentRate){y.data.currentRate=oe;var pe=y.rateList.filter(function(Oe){return Oe.value===oe});y.events.emit(ve.PlayerChangeRate,pe[0]),y.data.currentRateName=pe[0].name,y.updateRateListHTML(),y.hideBarBoxHandle()}})}},{key:"showHideBar",value:function(){var y=this.rateList;y&&y.length<=0&&this.hide()}},{key:"resetBoxPosition",value:function(){var y=33+28*this.rateList.length,w=(this.$barBox.offsetWidth-this.element.offsetWidth)/2;this.$barBox.style.marginTop=-y+"px",this.$barBox.style.marginLeft=-w+"px"}},{key:"hideBarBoxHandle",value:function(){this.$barBox.style.visibility="hidden"}},{key:"showBarBoxHandle",value:function(){this.$barBox.style.visibility="visible"}},{key:"updateRateListHTML",value:function(y){var w=this.rateList;if(!(w.length<=0)){y===void 0&&(y=this.data.currentRate);var I=w.slice(0,w.length).reverse(),W=!0,Y=!1,oe=void 0;try{for(var pe,Oe=I[Symbol.iterator]();!(W=(pe=Oe.next()).done);W=!0){var et=pe.value;et.value===y?et.selected=!0:delete et.selected}}catch(pt){Y=!0,oe=pt}finally{try{W||Oe.return==null||Oe.return()}finally{if(Y)throw oe}}return this.data.rateListHTML=function(pt){if(pt){var sn=["<ul>"],kn=!0,Mr=!1,kr=void 0;try{for(var ti,Vi=pt[Symbol.iterator]();!(kn=(ti=Vi.next()).done);kn=!0){var Bn=ti.value,Hf="",pc="";Bn.selected&&(Hf="gp-selected",pc=" selected=".concat(Bn.selected)),sn.push(`
    <li class="`.concat(Hf,'" gp-node-li value="').concat(Bn.value,'" ').concat(pc,">").concat(Bn.name,`</li>
    `))}}catch(ms){Mr=!0,kr=ms}finally{try{kn||Vi.return==null||Vi.return()}finally{if(Mr)throw kr}}return sn.push("</ul>"),sn.join("")}}(I)}}}]),A}(yr);function sx(){var $=sr()([`
  <gp-setting class="goldplay__setting-bar">
  </gp-setting>
  `]);return sx=function(){return $},$}var RC=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(sx())),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),A}(yr);function ox(){var $=sr()([`
  <gp-button class="goldplay__control--fullpage" title="`,'" data-status="',`">
  `,`
  </gp-button>
  `]);return ox=function(){return $},$}function fv(){var $=sr()([`
<svg xmlns="http://www.w3.org/2000/svg" style="display:`,`" width="20" height="20" viewBox="0 0 24 24">
<path d="M3.5 6h17a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-17a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5zM6 9v6h12V9H6z" fill="#f1f1f1"></path>
</svg>
`]);return fv=function(){return $},$}function lx(){var $=sr()([`
<svg xmlns="http://www.w3.org/2000/svg" style="display:`,`" width="20" height="20" viewBox="0 0 24 24">
  <path d="M2.5 4h19a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-19a.5.5 0 0 1-.5-.5v-15a.5.5 0 0 1 .5-.5zM5 7v10h14V7H5z" fill="#f1f1f1"></path>
</svg>
`]);return lx=function(){return $},$}var ux=Ot.create(lx(),"fullpageHide"),hv=Ot.create(fv(),"fullpageExitHide"),PC=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"containerOriginStyle",""),_()(p()(y),"template",y.createTemplate(ox(),"title","status","icon|html")),_()(p()(y),"data",{fullpageHide:"",fullpageExitHide:"none",status:"",icon:ux,title:"fullpage"}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"watch",value:function(){this.data.status==="fullpage"?(this.data.fullpageHide="none",this.data.fullpageExitHide="inline-block",this.data.title="exit fullspage",this.data.icon=hv):(this.data.fullpageHide="inline-block",this.data.fullpageExitHide="none",this.data.title="fullpage",this.data.icon=ux)}},{key:"initProps",value:function(){var y=this.options;this.$container=this.options.$container,this.$screenContainer=y.$screenContainer,this.$controlBarContainer=this.getComponent("controlBarContainer").element,this.originWidth=y.$container.offsetWidth,this.originHeight=y.$container.offsetHeight,this.containerOriginStyle=y.$container.getAttribute("style"),this.screenContainerOrginStyle=this.$screenContainer.getAttribute("style"),this.controlContainerOrginWidth=this.$controlBarContainer.style.width}},{key:"bindEvent",value:function(){var y=this,w=this.options.cssName,I=document,W=window;Ur(this.$controlBarContainer).on("click","."+w.fullPage,function(){var Y=y.data.status;y.getComponent("fullScreen").data.status==="fullscreen"&&ie.exitFullscreen(),Y==="fullpage"?y.exitFullPage():y.fullPage()}),this.eventsList.esckeyup=this.addEventListener(I,"keyup",function(Y){Y.keyCode===27&&y.data.status==="fullpage"&&y.exitFullPage()}),this.eventsList.windowresize=this.addEventListener(W,"resize",function(){if(y.data.status==="fullpage"){var Y=ie.getInnerWidthHeight();y.resizeTo(Y.width,Y.height),y.resetPosition()}})}},{key:"fullPage",value:function(){this.data.status="fullpage";var y=this.options,w=this.options.cssName,I=ie.getInnerWidthHeight();this.saveOriginPosition(),y.$container.classList.add(w.containerFullPage),this.resizeTo(I.width,I.height),this.resetPosition(),scrollTo(0,0)}},{key:"saveOriginPosition",value:function(){var y=this.getComponent("progressBar");this.posterOriginStyle=this.getComponent("poster").element.getAttribute("style"),this.originScroll={scrollX,scrollY},this.progressBarOriginLeft=y.progressBarLeft,this.progressBarOriginWidth=y.progressBarWidth,this.progressBarPlayWidthRate=y.getProgressPlayLeftWidth().offsetWidth/this.progressBarOriginWidth,this.progressBarLoadWidthRate=y.getProgressLoadLeftWidth().offsetWidth/this.progressBarOriginWidth,this.progressBarLoadLeftRate=(y.getProgressLoadLeftWidth().offsetLeft-this.progressBarOriginLeft)/this.progressBarOriginWidth}},{key:"setProgressBarPosition",value:function(){var y=this.getComponent("progressBar"),w=y.progressBarWidth,I=y.progressBarLeft,W=w*this.progressBarPlayWidthRate,Y=w*this.progressBarLoadWidthRate,oe=w*this.progressBarLoadLeftRate;y.setProgressPosition(W),y.setProgressLoadLeftWidth(oe+I,Y),this.getComponent("progressBar").clearDragDotTop()}},{key:"resizeTo",value:function(y,w){var I=this.options,W=I.player,Y=W.controlBarAutoHide?w:w-W.controlBarHeight;W.$screenContainer.style.width=y+"px",W.$screenContainer.style.height=Y+"px",I.$container.style.width=y+"px",I.$container.style.height=w+"px"}},{key:"resetPosition",value:function(){var y=this.options;this.setProgressBarPosition(),y.player.resizeScreen(),this.getComponent("bigPlayButton").resetPosition(),this.getComponent("poster").resetPosition(),this.getComponent("waitingBar").resetPosition(),this.getComponent("controlBarContainer").resetPosition()}},{key:"exitFullPage",value:function(){this.data.status="exitfullpage";var y=this.options.cssName;this.saveOriginPosition(),this.$container.classList.remove(y.containerFullPage),this.resetScreen()}},{key:"resetScreen",value:function(){this.$container.setAttribute("style",this.containerOriginStyle),this.$screenContainer.setAttribute("style",this.screenContainerOrginStyle),this.$controlBarContainer.style.width=this.controlContainerOrginWidth,this.getComponent("poster").element.setAttribute("style",this.posterOriginStyle),scrollTo(this.originScroll.scrollX,this.originScroll.scrollY),this.resetPosition()}}]),A}(yr);function cx(){var $=sr()([`
  <gp-button class="goldplay__control--fullscreen" title="`,'" data-status="',`">
  `,`
  </gp-button>
  `]);return cx=function(){return $},$}var fx=`
<svg xmlns="http://www.w3.org/2000/svg" gid="fullscreen" style="display:\${'fullscreenHide'}" width="20" height="20" viewBox="0 0 24 24">
<path d="M15 5.057V2h6.5a.5.5 0 0 1 .5.5V9h-2.943V5.057H15zm-6 0H5.057V9H2V2.5a.5.5 0 0 1 .5-.5H9v3.057zM15 22v-2.943h4.057V15H22v6.5a.5.5 0 0 1-.5.5H15zm-6 0H2.5a.5.5 0 0 1-.5-.5V15h3.057v4.057H9V22z" fill="#f1f1f1"></path>
</svg>
`,up=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(cx(),"title","status","icon|html")),_()(p()(y),"data",{fullscreenHide:"inline-block",fullscreenExitHide:"none",status:"",icon:fx,title:"fullscreen"}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"watch",value:function(){this.data.status==="fullscreen"?(this.data.fullscreenHide="none",this.data.fullscreenExitHide="inline-block",this.data.title="exit fullscreen",this.data.icon=`
<svg xmlns="http://www.w3.org/2000/svg" gid="fullscreenExit" style="display:\${'fullscreenExitHide'}"  width="20" height="20" viewBox="0 0 24 24">
<path d="M22 5.943V9h-6.5a.5.5 0 0 1-.5-.5V2h2.943v3.943H22zm-20 0h3.943V2H9v6.5a.5.5 0 0 1-.5.5H2V5.943zM22 15v2.943h-4.057V22H15v-6.5a.5.5 0 0 1 .5-.5H22zM2 15h6.5a.5.5 0 0 1 .5.5V22H5.943v-4.057H2V15z" fill="#f1f1f1"></path>
</svg>
`):(this.data.fullscreenHide="inline-block",this.data.fullscreenExitHide="none",this.data.title="fullscreen",this.data.icon=fx)}},{key:"initProps",value:function(){this.getComponent("fullPage").initProps.call(this)}},{key:"bindEvent",value:function(){var y=this,w=this.options.$container,I=this.options.cssName,W=document,Y=window;this.eventsList.fullscreenchange=this.addEventListener(W,"fullscreenchange",function(){if(document.fullscreenElement||document.webkitFullscreenElement)y.fullScreen();else{var oe=y.getComponent("fullPage");oe.data.status==="fullpage"?(w.classList.remove(I.containerFullScreen),y.data.status="exitfullscreen",oe.fullPage()):y.exitFullScreen()}}),this.eventsList.windowresize=this.addEventListener(Y,"resize",function(){document.fullscreenElement&&(y.resizeTo(screen.width,screen.height-(window.outerHeight-window.innerHeight)),y.resetPosition())}),Ur(this.$controlBarContainer).on("click","."+I.fullScreen,function(){var oe=y.data.status;y.saveOriginPosition(),oe==="fullscreen"?ie.exitFullscreen():ie.Fullscreen()})}},{key:"fullScreen",value:function(){this.data.status="fullscreen";var y=this.options,w=this.options.cssName,I={width:screen.width,height:screen.height-(outerHeight-innerHeight)};ie.isSafari()&&(I.height=I.height+38),y.$container.classList.add(w.containerFullScreen),this.resizeTo(I.width,I.height),this.resetPosition(),scrollTo(0,0)}},{key:"saveOriginPosition",value:function(){this.getComponent("fullPage").saveOriginPosition.call(this)}},{key:"resizeTo",value:function(y,w){this.getComponent("fullPage").resizeTo.call(this,y,w)}},{key:"resetPosition",value:function(){this.getComponent("fullPage").resetPosition.call(this)}},{key:"setProgressBarPosition",value:function(){this.getComponent("fullPage").setProgressBarPosition.call(this)}},{key:"exitFullScreen",value:function(){this.data.status="exitfullscreen";var y=this.options.cssName;this.saveOriginPosition(),this.options.$container.classList.remove(y.containerFullScreen),this.resetScreen(),this.saveOriginPosition()}},{key:"resetScreen",value:function(){this.getComponent("fullPage").resetScreen.call(this)}}]),A}(yr);function hx(){var $=sr()([`
  <gp-button class="goldplay__screen--bigplay" title="`,'" data-status="',`">
  `,`
  </gp-button>
  `]);return hx=function(){return $},$}function dx(){var $=sr()([`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
width="`,'" height="','" viewBox="0 0 438.533 438.533" style="',`" xml:space="preserve">
<g>
<path d="M409.133,109.203c-19.608-33.592-46.205-60.189-79.798-79.796C295.736,9.801,259.058,0,219.273,0
 c-39.781,0-76.466,9.801-110.063,29.407c-33.595,19.604-60.192,46.201-79.8,79.796C9.801,142.8,0,179.489,0,219.267
 s9.804,76.463,29.407,110.062c19.607,33.585,46.204,60.189,79.799,79.798c33.597,19.605,70.283,29.407,110.063,29.407
 s76.47-9.802,110.065-29.407c33.593-19.602,60.189-46.206,79.795-79.798c19.603-33.599,29.403-70.287,29.403-110.062
 C438.533,179.489,428.732,142.795,409.133,109.203z M328.904,234.966L173.588,326.33c-2.856,1.711-5.902,2.567-9.136,2.567
 c-3.045,0-6.09-0.764-9.135-2.286c-6.09-3.614-9.136-8.939-9.136-15.985V127.907c0-7.041,3.046-12.371,9.136-15.987
 c6.28-3.427,12.369-3.333,18.271,0.284l155.316,91.36c6.088,3.424,9.134,8.663,9.134,15.703
 C338.038,226.308,334.992,231.537,328.904,234.966z" fill="`,`">
</g>
</svg>
`]);return dx=function(){return $},$}var IC=Ot.create(dx(),"width","height","iconStyle","fillColor"),px=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"template",y.createTemplate(hx(),"title","status","icon|html")),_()(p()(y),"data",{titie:"click to play",iconStyle:"opacity:0.5",display:"hide",status:"",width:100,height:100,fillColor:"#999",icon:IC}),_()(p()(y),"options",{}),y.options=w,Object.assign(y.data,w.data),y.init(),y}return g()(A,$),l()(A,[{key:"watch",value:function(){if(this.data.display==="show"){var y=(this.element.parentNode.offsetHeight-this.data.height)/2;this.data.iconStyle="opacity:0.7;margin-top:".concat(y,"px")}}},{key:"resetPosition",value:function(){if(this.data.display==="show"){var y=this.element.parentNode,w=y.offsetWidth,I=y.offsetHeight;this.options.player.controlBarAutoHide===!0&&(I-=this.options.player.controlBarHeight);var W=y.offsetTop,Y=y.offsetLeft;this.element.style.width=w+"px",this.element.style.height=I+"px",this.element.style.top=W+"px",this.element.style.left=Y+"px"}}},{key:"bindEvent",value:function(){var y=this,w=this.options.$screenContainer,I=this.options.cssName;Ur(w).on("click","."+I.bigPlayButton,function(){y.events.emit(ve.PlayerOnPlay,y),y.events.emit(ve.ControlBarPlay,y),y.hide()}),Ur(w).on("mouseover","."+I.bigPlayButton,function(){y.data.fillColor=y.options.bigPlayButtonColor||"#fff"}),Ur(w).on("mouseout","."+I.bigPlayButton,function(W){var Y=y.element,oe={y:Y.offsetTop,x:Y.offsetLeft};oe.width=Y.offsetWidth,oe.height=Y.offsetHeight,W.pageX>oe.x&&W.pageX<oe.x+oe.width&&W.pageY>oe.y&&W.pageY<oe.y+oe.height||(y.data.fillColor="#999")})}},{key:"show",value:function(){var y=this;this.data.display!=="show"&&(this.data.display="show",this.element.style.opacity="1",setTimeout(function(){y.element.style.display="inline-block"},1))}},{key:"hide",value:function(){this.data.display!=="hide"&&(this.element.style.opacity="0",this.data.display="hide",this.element.style.display="none")}}]),A}(yr),dv=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),(y=c()(this,h()(A).call(this,w))).options=Object.assign(y.options,w),y.componentsController=y.options.componentsController,y.init(),y}return g()(A,$),l()(A,[{key:"render",value:function(){var y=this,w=F.createEl("gp-button-block");w.classList.add("goldplay__control--button-block"),A.componentList.forEach(function(I){var W=y.componentsController.getComponent(I);w.appendChild(W.element)}),this.element=w}}],[{key:"addCustomControl",value:function(y){A.componentList.push(y)}}]),A}(yr);_()(dv,"componentList",["playButton","pauseButton","replayButton"]);var E=dv,D=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),(y=c()(this,h()(A).call(this,w))).options=Object.assign(y.options,w),y.componentsController=y.options.componentsController,y.init(),y}return g()(A,$),l()(A,[{key:"render",value:function(){var y=this,w=F.createEl("gp-control-sidebar");w.classList.add("goldplay__control--sidebar"),A.componentList.forEach(function(I){var W=y.componentsController.getComponent(I);w.appendChild(W.element)}),this.element=w}}],[{key:"addCustomControl",value:function(y,w){(w<0||w>A.componentList.length)&&(w=A.componentList.length),A.componentList.splice(w,0,y)}}]),A}(yr);_()(D,"componentList",["speedBar","rateBar","volumeBar","fullPage","fullScreen"]);var U=D,X=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),(y=c()(this,h()(A).call(this,w))).options=Object.assign(y.options,w),y.componentsController=y.options.componentsController,y.init(),y}return g()(A,$),l()(A,[{key:"render",value:function(){var y=this,w=F.createEl("gp-control-nearside");w.classList.add("goldplay__control--button-block"),A.componentList.forEach(function(I){var W=y.componentsController.getComponent(I);w.appendChild(W.element)}),this.element=w}}],[{key:"addCustomControl",value:function(y,w){(w<0||w>A.componentList.length)&&(w=A.componentList.length),A.componentList.splice(w,0,y)}}]),A}(yr);_()(X,"componentList",["playControl","timer"]);var de=X,ge={BaseComponent:yr,controlBarContainer:np,bigPlayButton:px,poster:ep,progressBar:gl,playButton:av,pauseButton:zf,replayButton:vl,volumeBar:op,waitingBar:EC,alertBox:lp,timer:AC,speedBar:MC,subtitle:uv,rateBar:kC,settingBar:RC,fullPage:PC,fullScreen:up,playControl:E,sideControlBar:U,nearControlBar:de},_e=Ie,Re=function($){return $.substr(0,1).toUpperCase()+$.substr(1)},je=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"allComponents",{}),_()(p()(y),"controlBarController",null),_()(p()(y),"options",{cssName:_e}),y.options=Object.assign(y.options,w),y.options.componentsController=p()(y),y.initComponents(),y.$container=y.options.$container,y.$screenContainer=y.options.$screenContainer,y.$canvas=y.options.$canvas,y.$audioContainer=y.options.$audioContainer,y.$audio=y.options.$audio,y.options.$controlBarContainer=y.controlBarContainer.element,y.bindEvent(),y}return g()(A,$),l()(A,[{key:"run",value:function(){for(var y in this.controlBarController.run(),ge)this[y]&&typeof this[y].registerMethod=="function"&&this[y].registerMethod()}},{key:"initComponents",value:function(){for(var y in ge){var w=ge[y];this.allComponents[y]||this.createComponent(w,y)}}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.PlayerLoadedMetaData,function(){y.poster.hide()}),this.events.on(ve.AudioPlayerPlayFail,function(){y.drawBigPlayButton(),y.getComponent("poster").hide(),y.events.emit(ve.PlayerOnPause,y),y.events.emit(ve.ControlBarPause,y)}),this.bindAlertBoxEvent(),this.bindWaitingBarEvent()}},{key:"bindWaitingBarEvent",value:function(){this.waitingBar.initProps(),this.waitingBar.bindEvent()}},{key:"drawBigPlayButton",value:function(){this.$screenContainer.prepend(this.bigPlayButton.element),this.bigPlayButton.show(),this.bigPlayButton.bindEvent(),this.bigPlayButton.resetPosition()}},{key:"setControlBarController",value:function(y){this.controlBarController=y}},{key:"getControlBarController",value:function(){return this.controlBarController||this.options.player.controlBarContainer}},{key:"bindAlertBoxEvent",value:function(){this.alertBox.initProps(),this.alertBox.bindEvent()}},{key:"drawPoster",value:function(){this.$screenContainer.prepend(this.poster.element),this.poster.data.display="show",this.poster.bindEvent(),this.poster.resetPosition()}},{key:"createComponent",value:function(y,w){var I=Re(w);this["set"+I](new y(this.options)),this[w]=this["get"+I](),this.allComponents[w]||(this.allComponents[w]=this[w])}},{key:"getComponent",value:function(y){return this.allComponents[y]||ge[y]&&this.createComponent(ge[y],y),this.allComponents[y]}},{key:"resetAllComponents",value:function(){var y=this,w=Object.getOwnPropertyNames(this),I={};w.forEach(function(W){ge[W]&&(I[W]=y[W])}),this.allComponents=I}},{key:"getAllComponents",value:function(){return this.allComponents}}]),A}(H);for(var ft in je.addComponet=function($){var A=Re($);je.prototype["set"+A]=function(y){this[$]=y},je.prototype["get"+A]=function(){return this[$]}},ge)je.addComponet(ft);var xt=je,Qt=Ie,qt=function($){function A(){var y,w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return s()(this,A),y=c()(this,h()(A).call(this,w)),_()(p()(y),"player",null),_()(p()(y),"loadData",null),_()(p()(y),"options",{cssName:Qt}),y.options=Object.assign(y.options,w),y.player=y.options.player,y.loadData=y.player.loadData,y.componentsController=y.player.componentsController,y.$screenContainer=y.player.$screenContainer,y.initComponents(),y}return g()(A,$),l()(A,[{key:"initComponents",value:function(){var y=this.componentsController;Object.assign(this,y.getAllComponents()),this.container=this.controlBarContainer}},{key:"run",value:function(){this.timer.setTotalTime(this.loadData),this.drawLayout(),this.bindEvent(),this.player.autoPlay?this.events.emit(ve.ControlBarPlay):this.events.emit(ve.ControlBarPause)}},{key:"bindEvent",value:function(){this.bindContainerEvent(),this.bindTimerEvent(),this.bindPlayEvent(),this.bindProgressEvent(),this.bindSpeedEvent(),this.bindRateEvent(),this.bindVolumeEvent(),this.bindFullPage(),this.bindFullScreen()}},{key:"bindContainerEvent",value:function(){this.container.initProps(),this.container.bindEvent()}},{key:"bindTimerEvent",value:function(){this.timer.initProps(),this.timer.bindEvent()}},{key:"bindSpeedEvent",value:function(){this.speedBar.bindEvent(),this.speedBar.resetBoxPosition()}},{key:"bindRateEvent",value:function(){this.rateBar.bindEvent(),this.rateBar.resetBoxPosition()}},{key:"bindFullPage",value:function(){this.fullPage.initProps(),this.fullPage.bindEvent()}},{key:"bindFullScreen",value:function(){this.fullScreen.initProps(),this.fullScreen.bindEvent()}},{key:"bindPlayEvent",value:function(){var y=this;this.events.on(ve.ControlBarPlay,function(){y.pauseButton.data.status!=="pause"&&(y.pauseButton.data.status="pause"),y.replayButton.hide(),y.playButton.hide(),y.pauseButton.show(),y.bigPlayButton.hide()}),this.events.on(ve.ControlBarPause,function(){y.player.status!=="pause"&&(y.pauseButton.data.status="pause"),y.playButton.show(),y.pauseButton.hide()}),this.events.on(ve.PlayerEnd,function(){y.replayButton.show(),y.pauseButton.hide(),y.playButton.hide()}),[ve.PlayerWait,ve.PlayerSeeking,ve.PlayerReset,ve.PlayerChangeRate,ve.PlayerChangeSrc].forEach(function(w){y.events.on(w,function(){y.waitingBar.showWaiting()})}),this.events.on(ve.PlayerSeekEnd,function(){y.waitingBar.hideWaiting()}),this.events.on(ve.PlayerPlay,function(){y.waitingBar.hideWaiting(),y.events.emit(ve.ControlBarPlay,y)}),this.events.on(ve.PlayerPause,function(){y.events.emit(ve.ControlBarPause,y)}),this.events.on(ve.PlayerPlaying,function(){y.waitingBar.hideWaiting()}),this.events.on(ve.PlayerOnSeek,function(w){w<1e3*y.loadData.sourceData.duration&&y.events.emit(ve.ControlBarPauseLoading)}),this.events.on(ve.ControlBarPauseLoading,function(){y.pauseButton.data.status!=="pauseloading"&&(y.pauseButton.data.status="pauseloading"),y.replayButton.hide(),y.playButton.hide(),y.pauseButton.show()}),Ur(this.options.$container).on("click","."+Qt.playButton,function(){y.player.status!=="play"&&y.events.emit(ve.PlayerOnPlay,y)}),Ur(this.options.$container).on("click","."+Qt.pauseButton,function(){y.player.status!=="pause"&&y.events.emit(ve.PlayerOnPause,y)}),Ur(this.options.$container).on("click","."+Qt.replayButton,function(){y.events.emit(ve.PlayerOnSeek,y.player.startTime)})}},{key:"bindProgressEvent",value:function(){this.progressBar.initProps(),this.progressBar.bindEvent()}},{key:"bindVolumeEvent",value:function(){this.volumeBar.initProps(),this.volumeBar.initVolumeSize(),this.volumeBar.bindEvent()}},{key:"drawLayout",value:function(){var y=this.options.$container,w=this.container.element;y.append(w)}},{key:"destroy",value:function(){this.removeEventListenerGlobal(),this.container.destroy()}},{key:"removeEventListenerGlobal",value:function(){this.progressBar.progressDragEvent&&this.progressBar.progressDragEvent.removeEventListenerAll(),this.volumeBar.volumeDragEvent&&this.volumeBar.volumeDragEvent.removeEventListenerAll(),this.fullPage.removeEventListenerAll(),this.fullScreen.removeEventListenerAll()}}]),A}(H),Pt=i(44),an=i.n(Pt),Cn=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"isLast",!1),w.type=y.type,w.libPath=y.libPath,w.player=y.player,w.init(),w}return g()(A,$),l()(A,[{key:"init",value:function(){this.type=="ts"&&this.initNornalWorker(),this.bindEvent(),this.loadjs()}},{key:"initNornalWorker",value:function(){this.processor=this.initWorker()}},{key:"initWorker",value:function(){var y=this,w=an()(128);return w.onmessage=function(I){var W=I.data,Y=W.type,oe=W.data;switch(Y){case"dataProcessorReady":y.onDataProcessorReady();break;case"decoded":y.onDecoded(oe);break;case"demuxedAAC":y.onDemuxedAAC(oe);break;case"partEnd":y.onPartEnd(oe);break;case"resetEnd":y.onResetEnd();break;case"maxPTS":y.onMaxPTS(oe);break;case"flushEnd":y.onFlushEnd(oe)}},w}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.DemuxStartDemux,this.onStartDemux.bind(this)),this.events.on(ve.DemuxLast,function(){y.isLast=!0}),this.events.on(ve.DecodeFlush,function(){y.flush()})}},{key:"flush",value:function(){this.processor.postMessage({type:"flush"})}},{key:"loadjs",value:function(){this.processor.postMessage({type:"loadwasm",libPath:this.libPath})}},{key:"reset",value:function(){this.isLast=!1,this.processor.terminate(),this.initNornalWorker(),this.loadjs()}},{key:"onFlushEnd",value:function(y){this.events.emit(ve.DecodeFlushEnd,y)}},{key:"onMaxPTS",value:function(y){this.events.emit(ve.PlayerMaxPTS,y.maxAudioPTS,y.maxVideoPTS)}},{key:"onDemuxedAAC",value:function(y){this.events.emit(ve.DemuxAAC,y)}},{key:"onDataProcessorReady",value:function(){this.player.seeking||this.player.reseting?this.events.emit(ve.ProcessorResetEnd):this.events.emit(ve.DataProcessorReady)}},{key:"onStartDemux",value:function(y){this.player.reseting||(this.logger.info("onStartDemux","postMessage to demux"),y&&y.arrayBuffer?this.processor.postMessage({type:"startDemux",data:y.arrayBuffer,isLast:this.isLast},[y.arrayBuffer.buffer]):this.logger.error("onStartDemux","data is null","data:",y))}},{key:"onDecoded",value:function(y){this.player.reseting||this.events.emit(ve.DecodeDecoded,y)}},{key:"onPartEnd",value:function(y){this.events.emit(ve.DecodeApppendEnd,y)}},{key:"onResetEnd",value:function(){this.events.emit(ve.ProcessorResetEnd)}},{key:"destroy",value:function(){this.processor&&this.processor.terminate()}}]),A}(J),Ir=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"currentIndex",null),_()(p()(w),"retryTime",0),_()(p()(w),"dataReady",{audioReady:!1,imageReady:!1}),_()(p()(w),"hasInit",!1),_()(p()(w),"loadDataStatus","loading"),_()(p()(w),"duration",0),_()(p()(w),"tsNumber",0),w.loadData=y.loadData,w.imagePlayer=y.imagePlayer,w.audioPlayer=y.audioPlayer,w.player=y.player,w.bindEvent(),w}return g()(A,$),l()(A,[{key:"bindEvent",value:function(){var y=this;this.events.on(ve.LoadDataRead,function(w){y.onRead(w)}),this.events.on(ve.DemuxVideo,function(w,I){y.onVideoDemuxed(w,I)}),this.events.on(ve.DemuxAAC,function(w){y.onAACDemuxed(w)}),this.events.on(ve.DecodeDecoded,function(w){y.onDecoded(w)}),this.events.on(ve.DecodeApppendEnd,function(w){y.onAppendEnd(w)}),this.events.on(ve.ImagePlayerReady,function(){y.logger.info("bindevent","Events.ImagePlayerReady"),y.checkDataReady("imageReady")}),this.events.on(ve.AudioPlayerDataReady,function(){y.logger.info("bindevent","Events.AudioPlayerDataReady"),y.player.receiveAACTime=null,y.checkDataReady("audioReady")}),this.events.on(ve.AudioPlayerWait,function(){y.dataReady.audioReady=!1,y.events.emit(ve.PlayerWait,"audioPlayer")}),this.events.on(ve.ImagePlayerWait,function(){y.dataReady.imageReady=!1,y.events.emit(ve.PlayerWait,"imagePlayer")}),this.events.on(ve.ImagePlayerEnd,function(){y.logger.info("bindevent","........imageplayer end"),y.events.emit(ve.PlayerEnd)}),this.events.on(ve.PlayerWait,function(){y.logger.warn("player status wait"),y.player.status="wait",y.loadDataStatus==="loadend"&&(y.loadDataStatus="loading",y.loadNext())}),this.events.on(ve.PlayerLoadNext,function(){y.loadDataStatus==="loadend"&&(y.loadDataStatus="loading",y.loadNext())}),this.events.on(ve.DecodeFlushEnd,function(w){y.logger.info("flushend>>>>>>>>>>>>>>>",w),y.imagePlayer.maxPTS=w})}},{key:"checkDataReady",value:function(y){var w=this.dataReady;w[y]=!0;for(var I=Object.keys(w),W=0,Y=0;Y<I.length&&w[I[Y]];Y++)W++;W==I.length&&this.events.emit(ve.StreamDataReady)}},{key:"setBaseInfo",value:function(y){this.duration=y.duration,this.tsNumber=y.tsNumber}},{key:"reset",value:function(){this.dataReady={audioReady:!1,imageReady:!1},this.currentIndex=null,this.loadDataStatus="loading"}},{key:"startLoad",value:function(y){this.logger.info("startLoad","index:",y),this.currentIndex=y,this.player.currentIndex=y,this.events.emit(ve.LoadDataReadBufferByNo,y)}},{key:"loadNext",value:function(){this.player.reseting||(this.currentIndex>=this.tsNumber?this.logger.info("loadNext","load end","currentIndex",this.currentIndex,"tsNumber:",this.tsNumber):(this.currentIndex+=1,this.player.currentIndex=this.currentIndex,this.logger.info("loadNext","load next ts","tsno:",this.currentIndex),this.events.emit(ve.LoadDataReadBufferByNo,this.currentIndex)))}},{key:"onDecoded",value:function(y){var w=this;y.forEach(function(I){w.player.reseting||I.pts>=w.player.currentTime&&w.imagePlayer.push(I)})}},{key:"onAppendEnd",value:function(y){return y?(this.logger.info("onAppendEnd","events.decodeFlush",y),void this.events.emit(ve.DecodeFlush)):(this.logger.info("onAppendEnd","start load next ts condition",this.checkBuffer(),this.currentIndex),this.checkBuffer()&&this.currentIndex!==null?(this.logger.info("onAppendEnd","load next ts. currentIndex:",this.currentIndex),void this.loadNext()):(this.loadDataStatus="loadend",void this.logger.info("onAppendEnd","load ts stop")))}},{key:"onAACDemuxed",value:function(y){var w=this;this.player.reseting||y.forEach(function(I){(I.PTS>=w.player.currentTime||I.audioEnd)&&(!w.player.receiveAACTime&&w.player.seeking&&(w.player.receiveAACTime=Date.now()),w.audioPlayer.send(I))})}},{key:"onVideoDemuxed",value:function(y){this.player.reseting||this.events.emit(ve.DecodeStartDecode,y)}},{key:"checkBuffer",value:function(){var y=this.player,w=y.currentTime;return!((y.buffer()[1]||0)-w>=y.maxBufferLength)}},{key:"onRead",value:function(y){this.player.reseting?console.error("onRead reseting"):y&&y.arrayBuffer&&y.no===this.currentIndex?(this.retryTime=0,this.logger.warn("onRead","get stream data"),y.no===this.tsNumber&&(this.logger.info("onRead","the last ts"),this.events.emit(ve.DemuxLast)),this.events.emit(ve.DemuxStartDemux,y)):this.logger.error("onRead","load ts failred","tsno:",this.currentIndex)}}]),A}(J),Ar=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"maxBufferLength",0),_()(p()(w),"duration",0),_()(p()(w),"pool",[]),_()(p()(w),"start",0),_()(p()(w),"end",0),_()(p()(w),"offset",0),_()(p()(w),"fps",25),w.maxBufferLength=y.maxBufferLength,w}return g()(A,$),l()(A,[{key:"push",value:function(y){var w=this.pool,I=w.length;I===0&&(this.offset=y.pts,this.start=y.pts,this.fps=y.fps);var W=this.insertSort(w,y);w[W-1]&&(w[W-1].duration=w[W].pts-w[W-1].pts),w[W+1]&&(w[W].duration=w[W+1].pts-w[W].pts),this.end=this.pool[I].pts+this.pool[I].duration,this.duration=this.end-this.start}},{key:"insertSort",value:function(y,w){var I=y.length;if(I===0)return y.push(w),0;for(var W=0;W<I;W++)if(w.pts<y[W].pts){for(var Y=I;Y>W;)y[Y]=y[Y-1],Y--;return y[W]=w,W}return y.push(w),y.length-1}},{key:"reset",value:function(){this.duration=0,this.pool=[],this.start=0,this.end=0,this.offset=0}},{key:"findByIndex",value:function(y){var w=this.buffer.length;return y<w?(this.currentIndex=y,this.buffer[y]):(this.logger.error("input index ".concat(y,"is not found, current maxIndex is ").concat(w-1)),null)}},{key:"find",value:function(y){var w=this.pool,I=w.length;if(this.isBuffered(y)&&I!==0){var W=this.findIndex(y);if(W!==-1){var Y=w[W];return this.checkBuffer(y),Y}}}},{key:"findIndex",value:function(y){return this.pool.findIndex(function(w){var I=parseInt(w.pts);return y>=I&&y<I+w.duration})}},{key:"isBuffered",value:function(y){return y>=this.start&&y<this.end}},{key:"checkBuffer",value:function(y){if(this.duration>this.maxBufferLength){if(y>this.start){var w=this.findIndex(y),I=this.pool.splice(0,w);I.forEach(function(W){}),I=null,this.start=this.pool[0].pts,this.duration=this.end-this.start}return!1}return this.events.emit(ve.PlayerLoadNext),!0}},{key:"buffer",value:function(){return{start:this.start,end:this.end}}}]),A}(J),xi=i(72),Ha=i.n(xi),ta=i(60),Gn=i.n(ta),bi=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this)),_()(p()(w),"canvas",null),w.setCanvas(y.canvas),w.setRender(),w}return g()(A,$),l()(A,[{key:"setCanvas",value:function(y){this.canvas=y}},{key:"setRender",value:function(y){this.render=Ha.a.attach(y||this.canvas)}},{key:"clear",value:function(){this.render.clear()}},{key:"drawFrame",value:function(y){var w,I,W,Y,oe,pe=Date.now(),Oe=y.buf_y,et=y.buf_u,pt=y.buf_v,sn=y.width,kn=y.height,Mr=sn/2,kr=kn/2;w={bytes:Oe,stride:y.stride_y},I={bytes:et,stride:y.stride_u},W={bytes:pt,stride:y.stride_v},Y=Gn.a.format({width:sn,height:kn,chromaWidth:Mr,chromaHeight:kr}),oe=Gn.a.frame(Y,w,I,W),this.render.drawFrame(oe);var ti=Date.now();ti-pe>10&&this.logger.warn("drawFrame","reandertime:",ti-pe)}}]),A}(J),yl=function($){function A(y){var w;return s()(this,A),w=c()(this,h()(A).call(this,y)),_()(p()(w),"status","pause"),_()(p()(w),"_currentTime",0),_()(p()(w),"maxPTS",null),_()(p()(w),"ready",!1),_()(p()(w),"firstRender",!1),w.imageData=new Ar({events:y.events,maxBufferLength:y.maxBufferLength}),w.screen=new bi({canvas:y.canvas}),w.playHandler=null,w.player=y.player,w.debug=y.debug||!1,w}return g()(A,$),l()(A,[{key:"setScreenRender",value:function(y){this.screen.setCanvas(y),this.screen.setRender(y)}},{key:"clear",value:function(){this.screen.clear()}},{key:"play",value:function(y){this.status!=="play"&&(this.status="play",this.render(y))}},{key:"pause",value:function(){this.status!=="pause"&&(this.status="pause",clearTimeout(this.playHandler),this.playHandler=null)}},{key:"checkBuffer",value:function(){return this.imageData.checkBuffer(this.currentTime)}},{key:"push",value:function(y){this.player.reseting||(this.imageData.push(y),this.end-this.player.currentTime>re.d.READYBUFFERLENGTH&&!this.ready&&(this.ready=!0,this.status="ready",this.events.emit(ve.ImagePlayerReady)),this.events.emit(ve.ImagePlayerBuffeUpdate))}},{key:"find",value:function(y){return this.imageData.find(y)}},{key:"buffer",value:function(){return this.imageData.buffer()}},{key:"isBuffered",value:function(y){return this.imageData.isBuffered(y)}},{key:"render",value:function(y){if(!(y<this.imageData.offset)){var w=this.find(y);return w?(this.firstRender||(this.firstRender=!0,this.events.emit(ve.PlayerLoadedMetaData,w.width,w.height)),this.screen.drawFrame(w),this.currentTime=w.pts,this.events.emit(ve.ImagePlayerRenderEnd,y),w):this.maxPTS&&y>=this.maxPTS+this.fragDuration?(this.status="end",void this.events.emit(ve.ImagePlayerEnd,this.maxPTS)):(this.logger.warn("Events.ImagePlayerWait",y,this.start,this.end,this.maxPTS),this.logger.warn("render","not yuv data"),this.status="wait",this.ready=!1,this.events.emit(ve.ImagePlayerWait,"image","this"),!1)}}},{key:"reset",value:function(){this.status="pause",this.ready=!1,this.imageData.reset(),this.maxPTS=null,this.currentTime=0}},{key:"currentTime",set:function(y){this._currentTime=y},get:function(){return this._currentTime}},{key:"offset",get:function(){return this.imageData.offset}},{key:"fragDuration",get:function(){return Math.ceil(1e3/this.imageData.fps)}},{key:"start",get:function(){return this.imageData.start}},{key:"end",get:function(){return this.imageData.end}},{key:"duration",get:function(){return this.imageData.duration}}]),A}(J),DC=function($){function A(y){var w,I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return s()(this,A),w=c()(this,h()(A).call(this)),_()(p()(w),"mode",re.c.mode),_()(p()(w),"$container",null),_()(p()(w),"componentsController",null),_()(p()(w),"controlBarController",null),_()(p()(w),"controlBarHeight",50),_()(p()(w),"alertError",null),_()(p()(w),"dataController",null),_()(p()(w),"demuxer",null),_()(p()(w),"decoder",null),_()(p()(w),"preload",!0),_()(p()(w),"startTime",0),_()(p()(w),"screenWidth",null),_()(p()(w),"screenHeight",null),_()(p()(w),"options",{}),cp.set(p()(w),{writable:!0,value:re.c.libPath}),_()(p()(w),"readyStatus",{dataProcessor:!1,firstData:!1,audioPlayer:!1}),_()(p()(w),"reseting",!1),pv.set(p()(w),{writable:!0,value:0}),mv.set(p()(w),{writable:!0,value:!1}),gv.set(p()(w),{writable:!0,value:1}),dc.set(p()(w),{writable:!0,value:!1}),_()(p()(w),"maxBufferLength",re.d.MAXBUFFERLENGTH),_()(p()(w),"seekSegmentNo",-1),_()(p()(w),"status","init"),_()(p()(w),"loader",null),_()(p()(w),"currentIndex",null),_()(p()(w),"startIndex",1),_()(p()(w),"loadData",null),_()(p()(w),"paused",!1),_()(p()(w),"autoPlay",!0),_()(p()(w),"duration",0),_()(p()(w),"tsNumber",0),y||w.logger.error("Please pass in a dom object as the display container"),w.el=y,Object.assign(w.options,I),w.options.sourceURL=w.options.sourceURL||w.options.source,w.options.streamList=w.options.streamList||[],w.options.events=R(),w.maxBufferLength=I.maxBufferLength!==void 0?I.maxBufferLength:w.maxBufferLength,w.autoPlay=I.autoPlay!==void 0?I.autoPlay:w.autoPlay,w.controlBarAutoHide=I.controlBarAutoHide!==void 0?I.controlBarAutoHide:w.controlBarAutoHide,T()(p()(w),cp,I.libPath!==void 0?I.libPath:b()(p()(w),cp)),w.preload=I.preload===void 0?w.preload:I.preload,w.startTime=I.startTime===void 0?w.startTime:I.startTime,w.originStartTime=w.startTime,w.playbackRate=I.playbackRate===void 0?w.playbackRate:I.playbackRate,w}return g()(A,$),l()(A,[{key:"setAlertError",value:function(){this.options.alertError=this.alertError=j.getInstance({player:this,component:this.componentsController.alertBox,events:this.options.events})}},{key:"setDataController",value:function(){this.dataController=ye.getInstance({player:this,events:this.options.events})}},{key:"setLoadData",value:function(){this.dataController.setLoadData({player:this,events:this.options.events}),this.loadData=this.dataController.loadData}},{key:"setComponentsController",value:function(){this.componentsController=xt.getInstance({$container:this.$container,$screenContainer:this.$screenContainer,$canvas:this.$canvas,$audioContainer:this.$audioContainer,$audio:this.$audio,loadData:this.loadData,bigPlayButtonColor:this.bigPlayButtonColor,player:this,events:this.options.events})}},{key:"setControlBarController",value:function(){var y=Object.assign({},this.options,{$container:this.$container,$screenContainer:this.$screenContainer,controlBarAutoHide:this.controlBarAutoHide,player:this});this.controlBarController=qt.getInstance(y)}},{key:"setLoadController",value:function(){this.loaderController=Be.getInstance(this.options.type,{player:this,events:this.options.events})}},{key:"setProcessorController",value:function(){this.processController=new Cn({type:"ts",libPath:b()(this,cp),events:this.options.events,player:this})}},{key:"setStreamController",value:function(){this.streamController=new Ir({events:this.options.events,loadData:this.loadData,imagePlayer:this.imagePlayer,audioPlayer:this.audioPlayer,player:this})}},{key:"setImagerPlayer",value:function(){this.imagePlayer=new yl({events:this.options.events,canvas:this.$canvas,maxBufferLength:this.maxBufferLength,player:this})}},{key:"setAudioPlayer",value:function(){this.audioPlayer=new be({player:this,events:this.options.events,audioNode:this.$audio})}},{key:"setAction",value:function(){this.action=new $e({player:this,screen:this.screen,imagePlayer:this.imagePlayer,loadData:this.loadData,audioPlayer:this.audioPlayer,events:this.options.events})}},{key:"init",value:function(){this.controlBarHeight=this.options.controlBarHeight||this.controlBarHeight,this.options.httpWorker=an()(94,{name:"httpWorker"}),this.currentTime=this.startTime,this.addEl(),this.setDataController(),this.setLoadData(),this.setComponentsController(),this.setLoadController(),this.setControlBarController(),this.componentsController.setControlBarController(this.controlBarController),this.setAlertError(),this.setProcessorController(),this.setImagerPlayer(),this.setAudioPlayer(),this.setAction(),this.setStreamController(),this.componentsController.drawPoster(),this.preload&&this.run(),this.bindEvent()}},{key:"bindEvent",value:function(){var y=this;this.events.on(ve.PlayerOnPlay,function(){y.play()}),this.events.on(ve.PlayerOnPause,function(){y.pause()}),this.events.on(ve.PlayerOnVolume,function(w){y.volume=w}),this.events.on(ve.DataProcessorReady,function(){y.logger.info("bindEvent","decoder ready"),y.checkReady("dataProcessor")}),this.events.on(ve.AudioPlayerReady,function(){y.logger.info("bindEvent","audioPlayer ready"),y.seeking||y.checkReady("audioPlayer")}),this.events.on(ve.PlayerReady,function(){y.logger.info("bindEvent","player ready"),y.onReady()}),this.events.on(ve.PlayerSpeedTo,function(w){y.changeSpeed(w)}),this.events.on(ve.PlayerChangeRate,function(w){y.changeRate(w)}),this.events.on(ve.PlayerWait,function(){y.onWait()}),this.events.on(ve.PlayerPlay,function(){y.onPlay()}),this.events.on(ve.LoaderPlayListLoaded,function(w){typeof y.options.afterLoadPlaylist=="function"&&y.options.afterLoadPlaylist(y.laodData.sourceData);var I=w.loadData.sourceData;y.duration=I.duration,y.tsNumber=I.length,y.streamController.setBaseInfo({duration:y.duration,tsNumber:y.tsNumber}),y.dataController.startLoad(y.startTime),y.setStartTime(y.originStartTime)}),this.events.on(ve.LoadDataFirstLoaded,function(w){y.logger.info("bindEvent","first data ready"),y.startIndex=w.no,y.streamController.currentIndex=w.no,y.checkReady("firstData")}),this.events.on(ve.StreamDataReady,function(){y.logger.info("bindEvent","dataReady"),y.onDataReady()}),this.events.on(ve.PlayerLoadedMetaData,function(w,I){y.setCanvas(),y.resizeScreen(w,I)}),this.events.on(ve.PlayerEnd,function(){y.status="end"}),this.events.on(ve.ImagePlayerBuffeUpdate,function(){var w=y.buffer();y.events.emit(ve.PlayerbufferUpdate,w)}),this.events.on(ve.PlayerOnSeek,function(w){y.seek(Math.floor(w))}),this.events.on(ve.PlayerAlert,function(w){y.alertError.show(w)}),this.events.on(ve.PlayerThrowError,function(w){K.a.apply(y,w)})}},{key:"reset",value:function(y){this.action&&this.action.reset(y)}},{key:"switchPlaylist",value:function(y,w){this.loaderController.switchPlaylist(y,w)}},{key:"changeSpeed",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.playbackRate=y.value||1}},{key:"setStartTime",value:function(y){this.startTime=y}},{key:"changeRate",value:function(y){this.pause(),this.events.emit(ve.ControlBarPauseLoading,this),this.setStartTime((this.currentTime-5e3)/1e3),this.changing=!0,this.seeking=!1,this.imagePlayer.firstRender=!1,this.readyStatus={dataProcessor:!1,firstData:!1,audioPlayer:!1},this.reset(!0),this.switchPlaylist(y.url)}},{key:"changeSrc",value:function(y,w){this.pause(),this.events.emit(ve.ControlBarPauseLoading,this),this.events.emit(ve.PlayerChangeSrc,this),this.changing=!0,this.seeking=!1,this.imagePlayer.firstRender=!1,this.readyStatus={dataProcessor:!1,firstData:!1,audioPlayer:!1},this.currentTime=this.startTime,this.imagePlayer.clear(),this.reset(!0),this.switchPlaylist(y,w)}},{key:"setCanvas",value:function(){var y=rt.createCanvas(this);if(F.isElement(this.$canvas)){if(this.$canvas.width&&this.$canvas.height)return this.imagePlayer.setScreenRender(y),this.$canvas.replaceWith(y),void(this.$canvas=y)}else this.$screen.appendChild(y),this.$canvas=y}},{key:"destroy",value:function(){this.controlBarController&&(this.controlBarController.destroy(),delete this.controlBarController),this.$container&&(this.el.removeChild(this.$container),delete this.$container),this.processController.destroy(),this.loaderController.destroy()}},{key:"run",value:function(){this.loaderController.run()}},{key:"checkReady",value:function(y){var w=this.readyStatus;if(y&&typeof y=="string"){w[y]=!0;for(var I=Object.keys(w),W=0;W<I.length;W++)if(!w[I[W]])return!1;return this.logger.info("checkReady","player ready"),this.events.emit(ve.PlayerReady),!0}return this.logger.error("checkReady","check ready","type is no correct, type:",y),!1}},{key:"addEl",value:function(){var y,w,I,W;this.el?(y=rt.createContainer(this),this.el.appendChild(y),this.$container=y,w=rt.createScreenContainer(this),this.$screen=w,y.appendChild(w),this.$screenContainer=w,this.setCanvas(),W=rt.createAudio(this),this.$audio=W,(I=rt.createAudioContainer(this)).appendChild(W),this.$audioContainer=I,y.appendChild(I)):this.logger.error("addEl","not found el.","el:",this.options.el)}},{key:"onWait",value:function(){this.logger.info("onWait","wait,wait,wait")}},{key:"onPlay",value:function(){this.logger.info("onPlay","play, play, play")}},{key:"onReady",value:function(){this.changing||this.componentsController.run(),this.changing&&this.logger.info("onReady","change ready","startIndex:",this.startIndex),this.streamController.startLoad(this.startIndex)}},{key:"onDataReady",value:function(){this.changing&&(this.changing=!1,this.play()),(this.seeking||this.autoPlay&&!this.paused)&&this.play()}},{key:"buffer",value:function(){var y=this.imagePlayer.buffer(),w=this.audioPlayer.buffer(),I=Math.max(y.start,w.start),W=Math.min(y.end,w.end);return I<W?[I,W]:[0,0]}},{key:"play",value:function(){this.logger.info("play",this.status),this.status!=="playing"&&(this.logger.info("start play"),this.status="playing",this.paused=!1,this.action.play(this.currentTime),this.events.emit(ve.PlayerPlay,this))}},{key:"on",value:function(y,w){this.events.on("Player."+y,w)}},{key:"off",value:function(y,w){this.events.off("Player."+y,w)}},{key:"once",value:function(y,w){this.events.once("Player."+y,w)}},{key:"pause",value:function(){this.status!="pause"&&(this.logger.info("pause"),this.status="pause",this.action.pause(),this.paused=!0,this.events.emit(ve.PlayerPause,this))}},{key:"seek",value:function(y){y<this.startTime||(y>=1e3*this.duration?this.logger.info("seek","seek to time:",y):(this.seekTime=Date.now(),this.seeking=!0,this.currentTime=y,this.action.seek(y)))}},{key:"resizeScreen",value:function(y,w){F.adaptSizeElement(y,w,this.$screenContainer,this.$canvas)}},{key:"muted",get:function(){return b()(this,dc)},set:function(y){T()(this,dc,!!y)}},{key:"playbackRate",set:function(y){T()(this,gv,y)},get:function(){return b()(this,gv)}},{key:"seeking",set:function(y){T()(this,mv,y),y?this.events.emit(ve.PlayerSeeking):this.events.emit(ve.PlayerSeekEnd)},get:function(){return b()(this,mv)}},{key:"currentTime",get:function(){return b()(this,pv)},set:function(y){T()(this,pv,y)}},{key:"volume",get:function(){return this.audioPlayer.volume},set:function(y){this.audioPlayer.volume=y}}]),A}(J),cp=new WeakMap,pv=new WeakMap,mv=new WeakMap,gv=new WeakMap,dc=new WeakMap,cre=function($){function A(y,w){var I;return s()(this,A),I=c()(this,h()(A).call(this,y,w)),_()(p()(I),"libPath",null),I.options.processURL=w.processURL,I.libPath=w.libPath,I.options.needInit!==!1&&I.init(),I}return g()(A,$),l()(A,null,[{key:"getComponent",value:function(y){return ge[y]}},{key:"registerComponent",value:function(y,w){var I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"right",W=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1;if(typeof y!="string"||!y)throw new Error('Illegal component name, "'.concat(y,'"; must be a non-empty string.'));var Y=Object.prototype.isPrototypeOf.call(yr,w.prototype);if(!Y)throw new Error('Illegal component, "'.concat(y,'"; must be a BaseComponent subclass.'));ge[y]=w,xt.addComponet(y),I==="left"?de.addCustomControl(y,W):U.addCustomControl(y,W)}}]),A}(DC);r.default=cre},function(t,r){t.exports=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}},function(t,r){t.exports=function(i){return Function.toString.call(i).indexOf("[native code]")!==-1}},function(t,r,i){var a=function(s){var o=Object.prototype,l=o.hasOwnProperty,u=typeof Symbol=="function"?Symbol:{},c=u.iterator||"@@iterator",f=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function d(O,B,H,j){var K=B&&B.prototype instanceof g?B:g,J=Object.create(K.prototype),re=new N(j||[]);return J._invoke=function(se,Ae,Ee){var Ne="suspendedStart";return function(we,me){if(Ne==="executing")throw new Error("Generator is already running");if(Ne==="completed"){if(we==="throw")throw me;return F()}for(Ee.method=we,Ee.arg=me;;){var Se=Ee.delegate;if(Se){var Me=k(Se,Ee);if(Me){if(Me===m)continue;return Me}}if(Ee.method==="next")Ee.sent=Ee._sent=Ee.arg;else if(Ee.method==="throw"){if(Ne==="suspendedStart")throw Ne="completed",Ee.arg;Ee.dispatchException(Ee.arg)}else Ee.method==="return"&&Ee.abrupt("return",Ee.arg);Ne="executing";var ke=p(se,Ae,Ee);if(ke.type==="normal"){if(Ne=Ee.done?"completed":"suspendedYield",ke.arg===m)continue;return{value:ke.arg,done:Ee.done}}ke.type==="throw"&&(Ne="completed",Ee.method="throw",Ee.arg=ke.arg)}}}(O,H,re),J}function p(O,B,H){try{return{type:"normal",arg:O.call(B,H)}}catch(j){return{type:"throw",arg:j}}}s.wrap=d;var m={};function g(){}function v(){}function _(){}var x={};x[c]=function(){return this};var b=Object.getPrototypeOf,S=b&&b(b(L([])));S&&S!==o&&l.call(S,c)&&(x=S);var T=_.prototype=g.prototype=Object.create(x);function M(O){["next","throw","return"].forEach(function(B){O[B]=function(H){return this._invoke(B,H)}})}function C(O,B){var H;this._invoke=function(j,K){function J(){return new B(function(re,se){(function Ae(Ee,Ne,we,me){var Se=p(O[Ee],O,Ne);if(Se.type!=="throw"){var Me=Se.arg,ke=Me.value;return ke&&typeof ke=="object"&&l.call(ke,"__await")?B.resolve(ke.__await).then(function(He){Ae("next",He,we,me)},function(He){Ae("throw",He,we,me)}):B.resolve(ke).then(function(He){Me.value=He,we(Me)},function(He){return Ae("throw",He,we,me)})}me(Se.arg)})(j,K,re,se)})}return H=H?H.then(J,J):J()}}function k(O,B){var H=O.iterator[B.method];if(H===void 0){if(B.delegate=null,B.method==="throw"){if(O.iterator.return&&(B.method="return",B.arg=void 0,k(O,B),B.method==="throw"))return m;B.method="throw",B.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var j=p(H,O.iterator,B.arg);if(j.type==="throw")return B.method="throw",B.arg=j.arg,B.delegate=null,m;var K=j.arg;return K?K.done?(B[O.resultName]=K.value,B.next=O.nextLoc,B.method!=="return"&&(B.method="next",B.arg=void 0),B.delegate=null,m):K:(B.method="throw",B.arg=new TypeError("iterator result is not an object"),B.delegate=null,m)}function R(O){var B={tryLoc:O[0]};1 in O&&(B.catchLoc=O[1]),2 in O&&(B.finallyLoc=O[2],B.afterLoc=O[3]),this.tryEntries.push(B)}function P(O){var B=O.completion||{};B.type="normal",delete B.arg,O.completion=B}function N(O){this.tryEntries=[{tryLoc:"root"}],O.forEach(R,this),this.reset(!0)}function L(O){if(O){var B=O[c];if(B)return B.call(O);if(typeof O.next=="function")return O;if(!isNaN(O.length)){var H=-1,j=function K(){for(;++H<O.length;)if(l.call(O,H))return K.value=O[H],K.done=!1,K;return K.value=void 0,K.done=!0,K};return j.next=j}}return{next:F}}function F(){return{value:void 0,done:!0}}return v.prototype=T.constructor=_,_.constructor=v,_[h]=v.displayName="GeneratorFunction",s.isGeneratorFunction=function(O){var B=typeof O=="function"&&O.constructor;return!!B&&(B===v||(B.displayName||B.name)==="GeneratorFunction")},s.mark=function(O){return Object.setPrototypeOf?Object.setPrototypeOf(O,_):(O.__proto__=_,h in O||(O[h]="GeneratorFunction")),O.prototype=Object.create(T),O},s.awrap=function(O){return{__await:O}},M(C.prototype),C.prototype[f]=function(){return this},s.AsyncIterator=C,s.async=function(O,B,H,j,K){K===void 0&&(K=Promise);var J=new C(d(O,B,H,j),K);return s.isGeneratorFunction(B)?J:J.next().then(function(re){return re.done?re.value:J.next()})},M(T),T[h]="Generator",T[c]=function(){return this},T.toString=function(){return"[object Generator]"},s.keys=function(O){var B=[];for(var H in O)B.push(H);return B.reverse(),function j(){for(;B.length;){var K=B.pop();if(K in O)return j.value=K,j.done=!1,j}return j.done=!0,j}},s.values=L,N.prototype={constructor:N,reset:function(O){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!O)for(var B in this)B.charAt(0)==="t"&&l.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=void 0)},stop:function(){this.done=!0;var O=this.tryEntries[0].completion;if(O.type==="throw")throw O.arg;return this.rval},dispatchException:function(O){if(this.done)throw O;var B=this;function H(Ae,Ee){return J.type="throw",J.arg=O,B.next=Ae,Ee&&(B.method="next",B.arg=void 0),!!Ee}for(var j=this.tryEntries.length-1;j>=0;--j){var K=this.tryEntries[j],J=K.completion;if(K.tryLoc==="root")return H("end");if(K.tryLoc<=this.prev){var re=l.call(K,"catchLoc"),se=l.call(K,"finallyLoc");if(re&&se){if(this.prev<K.catchLoc)return H(K.catchLoc,!0);if(this.prev<K.finallyLoc)return H(K.finallyLoc)}else if(re){if(this.prev<K.catchLoc)return H(K.catchLoc,!0)}else{if(!se)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return H(K.finallyLoc)}}}},abrupt:function(O,B){for(var H=this.tryEntries.length-1;H>=0;--H){var j=this.tryEntries[H];if(j.tryLoc<=this.prev&&l.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var K=j;break}}K&&(O==="break"||O==="continue")&&K.tryLoc<=B&&B<=K.finallyLoc&&(K=null);var J=K?K.completion:{};return J.type=O,J.arg=B,K?(this.method="next",this.next=K.finallyLoc,m):this.complete(J)},complete:function(O,B){if(O.type==="throw")throw O.arg;return O.type==="break"||O.type==="continue"?this.next=O.arg:O.type==="return"?(this.rval=this.arg=O.arg,this.method="return",this.next="end"):O.type==="normal"&&B&&(this.next=B),m},finish:function(O){for(var B=this.tryEntries.length-1;B>=0;--B){var H=this.tryEntries[B];if(H.finallyLoc===O)return this.complete(H.completion,H.afterLoc),P(H),m}},catch:function(O){for(var B=this.tryEntries.length-1;B>=0;--B){var H=this.tryEntries[B];if(H.tryLoc===O){var j=H.completion;if(j.type==="throw"){var K=j.arg;P(H)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(O,B,H){return this.delegate={iterator:L(O),resultName:B,nextLoc:H},this.method==="next"&&(this.arg=void 0),m}},s}(t.exports);try{regeneratorRuntime=a}catch{Function("r","regeneratorRuntime = r")(a)}},function(t,r,i){(function(){var a=i(49),s=i(90);function o(l){var u=l.getContext("2d"),c=null,f=null,h=null;return this.drawFrame=function(d){var p=d.format;l.width===p.displayWidth&&l.height===p.displayHeight||(l.width=p.displayWidth,l.height=p.displayHeight),c!==null&&c.width==p.width&&c.height==p.height||function(x,b){for(var S=(c=u.createImageData(x,b)).data,T=x*b*4,M=0;M<T;M+=4)S[M+3]=255}(p.width,p.height),s.convertYCbCr(d,c.data);var m,g,v,_=p.cropWidth!=p.displayWidth||p.cropHeight!=p.displayHeight;_?(f||(g=p.cropWidth,v=p.cropHeight,(f=document.createElement("canvas")).width=g,f.height=v,h=f.getContext("2d")),m=h):m=u,m.putImageData(c,-p.cropLeft,-p.cropTop,p.cropLeft,p.cropTop,p.cropWidth,p.cropHeight),_&&u.drawImage(f,0,0,p.displayWidth,p.displayHeight)},this.clear=function(){u.clearRect(0,0,l.width,l.height)},this}o.prototype=Object.create(a.prototype),t.exports=o})()},function(t,r,i){(function(){var a=i(91);/**
	 * Basic YCbCr->RGB conversion
	 *
	 * @author Brion Vibber <brion@pobox.com>
	 * @copyright 2014-2019
	 * @license MIT-style
	 *
	 * @param {YUVFrame} buffer - input frame buffer
	 * @param {Uint8ClampedArray} output - array to draw RGBA into
	 * Assumes that the output array already has alpha channel set to opaque.
	 */t.exports={convertYCbCr:function(s,o){var l=0|s.format.width,u=0|s.format.height,c=0|a(s.format.width/s.format.chromaWidth),f=0|a(s.format.height/s.format.chromaHeight),h=s.y.bytes,d=s.u.bytes,p=s.v.bytes,m=0|s.y.stride,g=0|s.u.stride,v=0|s.v.stride,_=l<<2,x=0,b=0,S=0,T=0,M=0,C=0,k=0,R=0,P=0,N=0,L=0,F=0,O=0,B=0,H=0,j=0,K=0,J=0;if(c==1&&f==1)for(k=0,R=_,J=0,j=0;j<u;j+=2){for(S=(b=j*m|0)+m|0,T=J*g|0,M=J*v|0,H=0;H<l;H+=2)P=0|d[T++],F=(409*(N=0|p[M++])|0)-57088|0,O=(100*P|0)+(208*N|0)-34816|0,B=(516*P|0)-70912|0,L=298*h[b++]|0,o[k]=L+F>>8,o[k+1]=L-O>>8,o[k+2]=L+B>>8,k+=4,L=298*h[b++]|0,o[k]=L+F>>8,o[k+1]=L-O>>8,o[k+2]=L+B>>8,k+=4,L=298*h[S++]|0,o[R]=L+F>>8,o[R+1]=L-O>>8,o[R+2]=L+B>>8,R+=4,L=298*h[S++]|0,o[R]=L+F>>8,o[R+1]=L-O>>8,o[R+2]=L+B>>8,R+=4;k+=_,R+=_,J++}else for(C=0,j=0;j<u;j++)for(K=0,x=j*m|0,T=(J=j>>f)*g|0,M=J*v|0,H=0;H<l;H++)P=0|d[T+(K=H>>c)],F=(409*(N=0|p[M+K])|0)-57088|0,O=(100*P|0)+(208*N|0)-34816|0,B=(516*P|0)-70912|0,L=298*h[x++]|0,o[C]=L+F>>8,o[C+1]=L-O>>8,o[C+2]=L+B>>8,C+=4}}})()},function(t,r){(function(){/**
* Convert a ratio into a bit-shift count; for instance a ratio of 2
* becomes a bit-shift of 1, while a ratio of 1 is a bit-shift of 0.
*
* @author Brion Vibber <brion@pobox.com>
* @copyright 2016
* @license MIT-style
*
* @param {number} ratio - the integer ratio to convert.
* @returns {number} - number of bits to shift to multiply/divide by the ratio.
* @throws exception if given a non-power-of-two
*/t.exports=function(i){for(var a=0,s=i>>1;s!=0;)s>>=1,a++;if(i!==1<<a)throw"chroma plane dimensions must be power of 2 ratio to luma plane dimensions; got "+i;return a}})()},function(t,r,i){(function(){var a=i(49),s=i(93);function o(l){var u,c,f=this,h=o.contextForCanvas(l);if(h===null)throw new Error("WebGL unavailable");function d(H,j){var K=h.createShader(H);if(h.shaderSource(K,j),h.compileShader(K),!h.getShaderParameter(K,h.COMPILE_STATUS)){var J=h.getShaderInfoLog(K);throw h.deleteShader(K),new Error("GL shader compilation for "+H+" failed: "+J)}return K}var p,m,g,v,_,x,b,S,T,M,C=new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),k={},R={},P={};function N(H){return k[H]||(k[H]=h.createTexture()),k[H]}function L(H,j,K,J){var re=N(H);if(h.activeTexture(h.TEXTURE0),o.stripe){var se=!k[H+"_temp"],Ae=N(H+"_temp");h.bindTexture(h.TEXTURE_2D,Ae),se?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,j/4,K,0,h.RGBA,h.UNSIGNED_BYTE,J)):h.texSubImage2D(h.TEXTURE_2D,0,0,0,j/4,K,h.RGBA,h.UNSIGNED_BYTE,J);var Ee=k[H+"_stripe"],Ne=!Ee;Ne&&(Ee=N(H+"_stripe")),h.bindTexture(h.TEXTURE_2D,Ee),Ne&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,j,1,0,h.RGBA,h.UNSIGNED_BYTE,function(we){if(P[we])return P[we];for(var me=we,Se=new Uint32Array(me),Me=0;Me<me;Me+=4)Se[Me]=255,Se[Me+1]=65280,Se[Me+2]=16711680,Se[Me+3]=4278190080;return P[we]=new Uint8Array(Se.buffer)}(j)))}else h.bindTexture(h.TEXTURE_2D,re),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.LUMINANCE,j,K,0,h.LUMINANCE,h.UNSIGNED_BYTE,J)}function F(H,j,K){var J=k[H];h.useProgram(c);var re=R[H];re||(h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,J),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,j,K,0,h.RGBA,h.UNSIGNED_BYTE,null),re=R[H]=h.createFramebuffer()),h.bindFramebuffer(h.FRAMEBUFFER,re),h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,J,0);var se=k[H+"_temp"];h.activeTexture(h.TEXTURE1),h.bindTexture(h.TEXTURE_2D,se),h.uniform1i(x,1);var Ae=k[H+"_stripe"];h.activeTexture(h.TEXTURE2),h.bindTexture(h.TEXTURE_2D,Ae),h.uniform1i(_,2),h.bindBuffer(h.ARRAY_BUFFER,p),h.enableVertexAttribArray(m),h.vertexAttribPointer(m,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,g),h.enableVertexAttribArray(v),h.vertexAttribPointer(v,2,h.FLOAT,!1,0,0),h.viewport(0,0,j,K),h.drawArrays(h.TRIANGLES,0,C.length/2),h.bindFramebuffer(h.FRAMEBUFFER,null)}function O(H,j,K){h.activeTexture(j),h.bindTexture(h.TEXTURE_2D,k[H]),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.uniform1i(h.getUniformLocation(u,H),K)}function B(H,j){var K=d(h.VERTEX_SHADER,H),J=d(h.FRAGMENT_SHADER,j),re=h.createProgram();if(h.attachShader(re,K),h.attachShader(re,J),h.linkProgram(re),!h.getProgramParameter(re,h.LINK_STATUS)){var se=h.getProgramInfoLog(re);throw h.deleteProgram(re),new Error("GL program linking failed: "+se)}return re}return f.drawFrame=function(H){var j=H.format,K=!u||l.width!==j.displayWidth||l.height!==j.displayHeight;if(K&&(l.width=j.displayWidth,l.height=j.displayHeight,f.clear()),u||function(){if(o.stripe){c=B(s.vertexStripe,s.fragmentStripe),h.getAttribLocation(c,"aPosition"),g=h.createBuffer();var re=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]);h.bindBuffer(h.ARRAY_BUFFER,g),h.bufferData(h.ARRAY_BUFFER,re,h.STATIC_DRAW),v=h.getAttribLocation(c,"aTexturePosition"),_=h.getUniformLocation(c,"uStripe"),x=h.getUniformLocation(c,"uTexture")}u=B(s.vertex,s.fragment),p=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,p),h.bufferData(h.ARRAY_BUFFER,C,h.STATIC_DRAW),m=h.getAttribLocation(u,"aPosition"),b=h.createBuffer(),S=h.getAttribLocation(u,"aLumaPosition"),T=h.createBuffer(),M=h.getAttribLocation(u,"aChromaPosition")}(),K){var J=function(re,se,Ae){var Ee=j.cropLeft/Ae,Ne=(j.cropLeft+j.cropWidth)/Ae,we=(j.cropTop+j.cropHeight)/j.height,me=j.cropTop/j.height,Se=new Float32Array([Ee,we,Ne,we,Ee,me,Ee,me,Ne,we,Ne,me]);h.bindBuffer(h.ARRAY_BUFFER,re),h.bufferData(h.ARRAY_BUFFER,Se,h.STATIC_DRAW)};J(b,0,H.y.stride),J(T,0,H.u.stride*j.width/j.chromaWidth)}L("uTextureY",H.y.stride,j.height,H.y.bytes),L("uTextureCb",H.u.stride,j.chromaHeight,H.u.bytes),L("uTextureCr",H.v.stride,j.chromaHeight,H.v.bytes),o.stripe&&(F("uTextureY",H.y.stride,j.height),F("uTextureCb",H.u.stride,j.chromaHeight),F("uTextureCr",H.v.stride,j.chromaHeight)),h.useProgram(u),h.viewport(0,0,l.width,l.height),O("uTextureY",h.TEXTURE0,0),O("uTextureCb",h.TEXTURE1,1),O("uTextureCr",h.TEXTURE2,2),h.bindBuffer(h.ARRAY_BUFFER,p),h.enableVertexAttribArray(m),h.vertexAttribPointer(m,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,b),h.enableVertexAttribArray(S),h.vertexAttribPointer(S,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,T),h.enableVertexAttribArray(M),h.vertexAttribPointer(M,2,h.FLOAT,!1,0,0),h.drawArrays(h.TRIANGLES,0,C.length/2)},f.clear=function(){h.viewport(0,0,l.width,l.height),h.clearColor(0,0,0,0),h.clear(h.COLOR_BUFFER_BIT)},f.clear(),f}o.stripe=navigator.userAgent.indexOf("Windows")!==-1,o.contextForCanvas=function(l){var u={preferLowPowerToHighPerformance:!0,powerPreference:"low-power",failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!0};return l.getContext("webgl",u)||l.getContext("experimental-webgl",u)},o.isAvailable=function(){var l,u=document.createElement("canvas");u.width=1,u.height=1;try{l=o.contextForCanvas(u)}catch{return!1}if(l){var c=l.TEXTURE0,f=l.createTexture(),h=new Uint8Array(16),d=o.stripe?1:4,p=o.stripe?l.RGBA:l.LUMINANCE,m=o.stripe?l.NEAREST:l.LINEAR;return l.activeTexture(c),l.bindTexture(l.TEXTURE_2D,f),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,m),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,m),l.texImage2D(l.TEXTURE_2D,0,p,d,4,0,p,l.UNSIGNED_BYTE,h),!l.getError()}return!1},o.prototype=Object.create(a.prototype),t.exports=o})()},function(t,r){t.exports={vertex:`precision lowp float;

attribute vec2 aPosition;
attribute vec2 aLumaPosition;
attribute vec2 aChromaPosition;
varying vec2 vLumaPosition;
varying vec2 vChromaPosition;
void main() {
    gl_Position = vec4(aPosition, 0, 1);
    vLumaPosition = aLumaPosition;
    vChromaPosition = aChromaPosition;
}
`,fragment:`// inspired by https://github.com/mbebenita/Broadway/blob/master/Player/canvas.js

precision lowp float;

uniform sampler2D uTextureY;
uniform sampler2D uTextureCb;
uniform sampler2D uTextureCr;
varying vec2 vLumaPosition;
varying vec2 vChromaPosition;
void main() {
   // Y, Cb, and Cr planes are uploaded as LUMINANCE textures.
   float fY = texture2D(uTextureY, vLumaPosition).x;
   float fCb = texture2D(uTextureCb, vChromaPosition).x;
   float fCr = texture2D(uTextureCr, vChromaPosition).x;

   // Premultipy the Y...
   float fYmul = fY * 1.1643828125;

   // And convert that to RGB!
   gl_FragColor = vec4(
     fYmul + 1.59602734375 * fCr - 0.87078515625,
     fYmul - 0.39176171875 * fCb - 0.81296875 * fCr + 0.52959375,
     fYmul + 2.017234375   * fCb - 1.081390625,
     1
   );
}
`,vertexStripe:`precision lowp float;

attribute vec2 aPosition;
attribute vec2 aTexturePosition;
varying vec2 vTexturePosition;

void main() {
    gl_Position = vec4(aPosition, 0, 1);
    vTexturePosition = aTexturePosition;
}
`,fragmentStripe:`// extra 'stripe' texture fiddling to work around IE 11's poor performance on gl.LUMINANCE and gl.ALPHA textures

precision lowp float;

uniform sampler2D uStripe;
uniform sampler2D uTexture;
varying vec2 vTexturePosition;
void main() {
   // Y, Cb, and Cr planes are mapped into a pseudo-RGBA texture
   // so we can upload them without expanding the bytes on IE 11
   // which doesn't allow LUMINANCE or ALPHA textures
   // The stripe textures mark which channel to keep for each pixel.
   // Each texture extraction will contain the relevant value in one
   // channel only.

   float fLuminance = dot(
      texture2D(uStripe, vTexturePosition),
      texture2D(uTexture, vTexturePosition)
   );

   gl_FragColor = vec4(fLuminance, fLuminance, fLuminance, 1);
}
`}},function(t,r,i){i.r(r);var a=i(2),s=i.n(a),o=i(3),l=i.n(o),u=i(0),c=i.n(u),f=i(61),h=i.n(f),d=i(11),p=i.n(d),m=i(18),g=i.n(m),v=i(28),_=i.n(v),x=i(10),b=i(23),S=x.a.get("HTTP.js",{level:2}),T=function(){var N=_()(g.a.mark(function L(F){var O;return g.a.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(!(F instanceof Blob)){B.next=5;break}return B.next=3,new Response(F).arrayBuffer();case 3:return O=B.sent,B.abrupt("return",new Uint8Array(O,0));case 5:case"end":return B.stop()}},L)}));return function(L){return N.apply(this,arguments)}}(),M=function(N){if(N)return Object.entries(N).reduce(function(L,F,O){var B=h()(F,2),H=B[0],j=B[1];return L+(O===0?H+"="+encodeURIComponent(j):"&"+H+"="+encodeURIComponent(j))},"")};function C(N,L){var F=(typeof N.clone=="function"?N.clone():void 0)||N,O=function(B,H){var j={body:H,headers:function(K){return K.headers.entries?function(J){var re=Object.create(Object.getPrototypeOf(J.headers)),se=!0,Ae=!1,Ee=void 0;try{for(var Ne,we=J.headers.entries()[Symbol.iterator]();!(se=(Ne=we.next()).done);se=!0){var me=h()(Ne.value,2),Se=me[0],Me=me[1];re[Se]=Me}}catch(ke){Ae=!0,Ee=ke}finally{try{se||we.return==null||we.return()}finally{if(Ae)throw Ee}}return re}(K):function(J){var re={},se=J.headers.__headers__;for(var Ae in se)re[Ae]=se[Ae].join("");return re}(K)}(B),response:B,status:B.status,statusText:B.statusText};return B.ok?Promise.resolve(j):Promise.reject(j)};return N[L]().then(function(B){return O(F,B)})}function k(N,L){var F=N.headers.get("content-type"),O=N.clone().body.getReader(),B=0,H=B,j=setInterval(function(){var K=50*(B-H);K<=1||(S.info("HTTP>handleResponse","".concat(H," | ").concat(B),"".concat(K.toFixed(2)," Bytes/s")),self.postMessage({type:"notice",method:"fetch",noticeType:"speed",data:{speed:K,intervalValue:20,lastReceived:H,bytesReceived:B}}),H=B)},20);return O.read().then(function K(J){return J.done?(clearInterval(j),function(){if(L==="ts"||L==="video")return C(N,"blob");if(F.includes("json"))return C(N,"json");if(F.includes("text"))return C(N,"text");if(F.includes("form"))return C(N,"formData");if(F.includes("video")||F.includes("image")||F.includes("octet-stream"))return C(N,"blob");try{return C(N,"text")}catch(re){return Object(b.a)(re,"[HTTP>handleResponse:unknow content-type]",F,N),Promise.resolve(N)}}()):(B+=J.value.length,O.read().then(K))})}var R=null,P=(R||(R=new(function(){function N(F){s()(this,N),c()(this,"options",{"content-type":"application/json;charset=UTF-8",cache:"no-cache",mode:"cors"}),Object.assign(this.options,F)}var L;return l()(N,[{key:"setOptions",value:function(F){var O=Object.assign(this.options,F);O.url=function(B){var H=B.url,j=B.params;return j?H+"?"+M(j):H}(O),O.method=O.method||"get",O.headers=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},H=B.headers,j=H===void 0?{}:H,K=B.method,J=K===void 0?"get":K,re=B.username,se=B.password,Ae=B.token,Ee=new Headers(j);if(re||se){if(!re)throw new TypeError("username required for basic authentication");if(!se)throw new TypeError("password required for basic authentication");var Ne=(typeof win>"u"?"undefined":p()(win))==="object"&&win.btoa?btoa:function(we){return we};Ee.set("Authorization","Basic "+Ne(re+":"+se))}return Ae&&Ee.set("Authorization","Bearer "+Ae),J==="get"||Ee.get("content-type")||Ee.set("content-type","application/json"),Ee}(O),O.body=function(B){var H=B.headers.get("content-type");if(H)return H.includes("json")?JSON.stringify(B.body):H.includes("x-www-form-urlencoded")?M(B.body):B.body}(O),delete O.username,delete O.password,delete O.token,this.options=O}},{key:"request",value:function(F){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},B=arguments.length>2?arguments[2]:void 0;if(F)return this.setOptions(Object.assign({url:F},O)),fetch(this.options.url,this.options).then(function(H){return k(H,B)});S.error("[HTTP>request]","url is undefined","url:",F,"options:",O)}},{key:"fetch",value:function(F){function O(B){return F.apply(this,arguments)}return O.toString=function(){return F.toString()},O}(function(){var F=_()(g.a.mark(function O(B){var H,j,K,J,re=arguments;return g.a.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(H=re.length>1&&re[1]!==void 0?re[1]:{},j=re.length>2?re[2]:void 0,K=re.length>3?re[3]:void 0,B){se.next=6;break}return S.wran("[HTTP>fetch]","url is undefined","url:",B,"options:",H),se.abrupt("return");case 6:return this.setOptions(Object.assign({url:B},H)),S.info("[HTTP>fetch]","http fetch","url:",B,"options:",H),se.next=10,fetch(B,H);case 10:(J=se.sent).ok?J.text().then(function(Ae){self.postMessage({type:"invoke",method:"fetch",fileType:K,name:j,data:Ae})}):self.postMessage({result:"failed"});case 12:case"end":return se.stop()}},O,this)}));return function(O){return F.apply(this,arguments)}}())},{key:"get",value:(L=_()(g.a.mark(function F(O){var B,H,j,K,J,re=arguments;return g.a.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return B=re.length>1&&re[1]!==void 0?re[1]:{},H=re.length>2?re[2]:void 0,j=re.length>3?re[3]:void 0,B.method="get",S.info("[HTTP>get]","http get","url:",O,"options:",B,"name:",H,"fileType:",j),J={type:"invoke",method:"get",fileType:j,name:H,url:O},se.prev=6,se.next=9,this.request.call(this,O,B,j);case 9:K=se.sent,se.next=15;break;case 12:se.prev=12,se.t0=se.catch(6),S.error("[HTTP>get]","networks error","url:",O,"options:",B,"name:",H,"fileType:",j,"ex:",se.t0);case 15:if(!K||!K.body){se.next=24;break}if(J.data=K.body,j!=="ts"&&j!=="video"){se.next=21;break}return se.next=20,T(J.data);case 20:J.arrayBuffer=se.sent;case 21:J.arrayBuffer?self.postMessage(J,[J.arrayBuffer.buffer]):self.postMessage(J),se.next=27;break;case 24:J.type="error",J.data=K,self.postMessage(J);case 27:case"end":return se.stop()}},F,this,[[6,12]])})),function(F){return L.apply(this,arguments)})}]),N}())({})),R);r.default=function(N){N.onmessage=function(L){var F=L.data,O=F.type,B=F.method;switch(O){case"invoke":P[B].call(P,F.url,F.options,F.name,F.fileType)}}}},function(t,r){t.exports=function(i){if(Array.isArray(i))return i}},function(t,r){t.exports=function(i,a){if(typeof Symbol<"u"&&Symbol.iterator in Object(i)){var s=[],o=!0,l=!1,u=void 0;try{for(var c,f=i[Symbol.iterator]();!(o=(c=f.next()).done)&&(s.push(c.value),!a||s.length!==a);o=!0);}catch(h){l=!0,u=h}finally{try{o||f.return==null||f.return()}finally{if(l)throw u}}return s}}},function(t,r,i){var a=i(98);t.exports=function(s,o){if(s){if(typeof s=="string")return a(s,o);var l=Object.prototype.toString.call(s).slice(8,-1);return l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set"?Array.from(s):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?a(s,o):void 0}}},function(t,r){t.exports=function(i,a){(a==null||a>i.length)&&(a=i.length);for(var s=0,o=new Array(a);s<a;s++)o[s]=i[s];return o}},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,r,i){i.r(r);var a,s=i(2),o=i.n(s),l=i(3),u=i.n(l),c=i(9),f=function(){function ue(q){o()(this,ue),this.decode=q,this.result=[]}return u()(ue,[{key:"openDecode",value:function(){var q=this,z=Module.addFunction(function(G,ae,be,Ie,Ue,rt,_t,ct,Lt){var Ot=HEAPU8.subarray(G,G+Ie*ct),En=HEAPU8.subarray(ae,ae+Ue*ct/2),Br=HEAPU8.subarray(be,be+rt*ct/2),Xt={stride_y:Ie,stride_u:Ue,stride_v:rt,width:_t,height:ct,buf_y:new Uint8Array(Ot),buf_u:new Uint8Array(En),buf_v:new Uint8Array(Br),pts:Lt};q.result.push(Xt)});Module._openDecoder(z,1)}},{key:"decodeData",value:function(q,z){var G=q.length,ae=Module._malloc(G);Module.HEAPU8.set(q,ae),Module._decodeData(ae,G,z),Module._free(ae)}},{key:"flush",value:function(){for(Module._flushDecoder();this.checkData();)this.decode.getDecodeYUV()}},{key:"closeDecode",value:function(){Module._closeDecoder()}},{key:"getYUV",value:function(){var q=null;return this.result.length>0&&(q=this.result.shift()),q}},{key:"checkData",value:function(){return this.result.length>0}}]),ue}(),h=function(){function ue(q){o()(this,ue),this.decode=q}return u()(ue,[{key:"openDecode",value:function(){return _web_decoder_open()}},{key:"closeDecode",value:function(q){_web_decoder_close(q)}},{key:"decodeData",value:function(q,z,G){var ae=q.length||0;Module.ccall("web_decoder_decode_frame","number",["number","array","number","number"],[G,q,ae,z])}},{key:"flush",value:function(q){var z=this.decode;if(_web_decoder_decode_frame)for(;!(_web_decoder_decode_frame(q,null,0,0)<0||!_web_got_frame(q));)z.getDecodeYUV(q)}},{key:"getYUV",value:function(q){var z=_web_get_stride_y(q),G=_web_get_stride_u(q),ae=_web_get_stride_v(q),be=_web_get_width(q),Ie=_web_get_height(q),Ue=_web_get_frame_y(q),rt=_web_get_frame_u(q),_t=_web_get_frame_v(q),ct=parseInt(_web_got_frame_pts(q)*c.a*1e3),Lt=HEAPU8.subarray(Ue,Ue+z*Ie),Ot=HEAPU8.subarray(rt,rt+G*Ie/2),En=HEAPU8.subarray(_t,_t+ae*Ie/2);return{stride_y:z,stride_u:G,stride_v:ae,width:be,height:Ie,buf_y:new Uint8Array(Lt),buf_u:new Uint8Array(Ot),buf_v:new Uint8Array(En),pts:ct}}},{key:"checkData",value:function(q){return _web_got_frame(q)}}]),ue}(),d=function(){function ue(){o()(this,ue),this.p=null,this.ptsList=[],this.ptsOffset=0,this.fps=0,this.lastDuration=0,this.previousPTS=0,this.status=!1,this.yuvArray=[],this.decodeTool=null}return u()(ue,[{key:"loadWASM",value:function(q){var z=q.data.libPath;self.Module={locateFile:function(G){return z+G}},self.importScripts(z+"libffmpeg.js"),self.Module.onRuntimeInitialized=function(){console.log("wasm loaded"),Module._web_decoder_open?self.decode.decodeTool=new h(self.decode,this.event):self.decode.decodeTool=new f(self.decode,this.event),self.decode.openDecode(),self.decode.onWasmLoaded()}}},{key:"openDecode",value:function(){try{this.status||(this.p=this.decodeTool.openDecode(),this.status=!0),console.log("opendecode")}catch(q){console.error(q)}}},{key:"closeDecode",value:function(){this.status&&(this.decodeTool.closeDecode(this.p),this.status=!1)}},{key:"push",value:function(q){var z=this;q.forEach(function(G){var ae=G.PTS,be=G.data_byte,Ie=G.partEnd,Ue=G.lastTS,rt=z.ptsList;z.insertSort(rt,parseInt(ae*c.a*1e3)),z.decodeTool.decodeData(be,ae,z.p),z.decodeTool.checkData(z.p)&&z.getDecodeYUV(z.p,Ie,Ue)})}},{key:"getDecodeYUV",value:function(q,z,G){if(!this.reseting){var ae=0;this.fps||(this.fps=this.getFPS());var be=this.decodeTool.getYUV(q),Ie=this.ptsList.shift();be.pts=Ie,this.previousPTS&&Ie?(ae=parseInt(Ie-this.previousPTS),this.lastDuration=ae):ae=this.lastDuration,be.duration=ae,be.fps=this.fps,Ie&&(this.previousPTS=Ie,this.yuvArray.push(be),this.yuvArray.length>10&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[])),z&&(this.yuvArray.length&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[]),self.postMessage({type:"partEnd",data:G}))}}},{key:"reset",value:function(){this.reseting=!0,this.ptsList=[],this.ptsOffset=0,this.previousPTS=0,this.fps=0,this.yuvArray=[],this.closeDecode(),this.openDecode(),self.postMessage({type:"resetEnd",data:Date.now()}),this.reseting=!1}},{key:"flush",value:function(){this.decodeTool.flush(this.p),this.yuvArray.length&&(self.postMessage({type:"decoded",data:this.yuvArray}),this.yuvArray=[]),this.closeDecode(),self.postMessage({type:"flushEnd",data:this.previousPTS})}},{key:"getFPS",value:function(){var q=this.ptsList;return q.length>=2?Math.round(1e3/(q[1]-q[0])):null}},{key:"onWasmLoaded",value:function(){self.postMessage({type:"dataProcessorReady"})}},{key:"insertSort",value:function(q,z){var G=q.length;if(G!==0){for(var ae=0;ae<G;ae++)if(z<q[ae]){for(var be=G;be>ae;)q[be]=q[be-1],be--;return void(q[ae]=z)}q.push(z)}else q.push(z)}}]),ue}(),p=i(0),m=i.n(p);function g(ue,q,z){return(g=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(G,ae,be){var Ie=function(rt,_t){for(;!Object.prototype.hasOwnProperty.call(rt,_t)&&(rt=R(rt))!==null;);return rt}(G,ae);if(Ie){var Ue=Object.getOwnPropertyDescriptor(Ie,ae);return Ue.get?Ue.get.call(be):Ue.value}})(ue,q,z||ue)}function v(ue){return function(q){if(Array.isArray(q)){for(var z=0,G=new Array(q.length);z<q.length;z++)G[z]=q[z];return G}}(ue)||function(q){if(Symbol.iterator in Object(q)||Object.prototype.toString.call(q)==="[object Arguments]")return Array.from(q)}(ue)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function _(ue){return(_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q})(ue)}function x(ue,q){return!q||_(q)!=="object"&&typeof q!="function"?b(ue):q}function b(ue){if(ue===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ue}function S(ue,q){if(typeof q!="function"&&q!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(q&&q.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),q&&k(ue,q)}function T(ue){var q=typeof Map=="function"?new Map:void 0;return(T=function(z){if(z===null||(G=z,Function.toString.call(G).indexOf("[native code]")===-1))return z;var G;if(typeof z!="function")throw new TypeError("Super expression must either be null or a function");if(q!==void 0){if(q.has(z))return q.get(z);q.set(z,ae)}function ae(){return C(z,arguments,R(this).constructor)}return ae.prototype=Object.create(z.prototype,{constructor:{value:ae,enumerable:!1,writable:!0,configurable:!0}}),k(ae,z)})(ue)}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function C(ue,q,z){return(C=M()?Reflect.construct:function(G,ae,be){var Ie=[null];Ie.push.apply(Ie,ae);var Ue=new(Function.bind.apply(G,Ie));return be&&k(Ue,be.prototype),Ue}).apply(null,arguments)}function k(ue,q){return(k=Object.setPrototypeOf||function(z,G){return z.__proto__=G,z})(ue,q)}function R(ue){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(q){return q.__proto__||Object.getPrototypeOf(q)})(ue)}function P(ue,q){if(!(ue instanceof q))throw new TypeError("Cannot call a class as a function")}function N(ue,q){for(var z=0;z<q.length;z++){var G=q[z];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(ue,G.key,G)}}function L(ue,q,z){return q&&N(ue.prototype,q),z&&N(ue,z),ue}(function(ue){ue.ERROR="ERROR",ue.INFO="INFO",ue.DATA="DATA",ue.DEMUX_DATA="DEMUX_DATA",ue.DONE="DONE"})(a||(a={}));var F,O=Object.create||function(ue){var q=function(){};return q.prototype=ue,new q},B=Object.keys||function(ue){for(var q in ue)Object.prototype.hasOwnProperty.call(ue,q);return q},H=Function.prototype.bind||function(ue){var q=this;return function(){return q.apply(ue,arguments)}},j=10,K=function(){function ue(){P(this,ue),this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=O(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}return L(ue,[{key:"emit",value:function(q){for(var z=arguments.length,G=new Array(z>1?z-1:0),ae=1;ae<z;ae++)G[ae-1]=arguments[ae];var be,Ie,Ue,rt,_t,ct,Lt=q==="error";if(ct=this._events)Lt=Lt&&ct.error==null;else if(!Lt)return!1;if(Lt){if(arguments.length>1&&(be=arguments[1]),be instanceof Error)throw be;var Ot=new Error('Unhandled "error" event. ('+be+")");throw Ot.context=be,Ot}if(!(Ie=ct[q]))return!1;var En=typeof Ie=="function";switch(Ue=arguments.length){case 1:re(Ie,En,this);break;case 2:se(Ie,En,this,arguments[1]);break;case 3:Ae(Ie,En,this,arguments[1],arguments[2]);break;case 4:Ee(Ie,En,this,arguments[1],arguments[2],arguments[3]);break;default:for(rt=new Array(Ue-1),_t=1;_t<Ue;_t++)rt[_t-1]=arguments[_t];Ne(Ie,En,this,rt)}return!0}},{key:"on",value:function(q,z){return function(G,ae,be){var Ie,Ue,rt;if(typeof be!="function")throw new TypeError('"listener" argument must be a function');if((Ue=G._events)?(Ue.newListener&&(G.emit("newListener",ae,be.listener?be.listener:be),Ue=G._events),rt=Ue[ae]):(Ue=G._events=O(null),G._eventsCount=0),rt){if(typeof rt=="function"?rt=Ue[ae]=[rt,be]:rt.push(be),!rt.warned&&(Ie=function(ct){return ct._maxListeners===void 0?ue.defaultMaxListeners:ct._maxListeners}(G))&&Ie>0&&rt.length>Ie){rt.warned=!0;var _t=new(function(ct){function Lt(){return P(this,Lt),x(this,R(Lt).apply(this,arguments))}return S(Lt,ct),Lt}(T(Error)))("Possible Dispatcher memory leak detected. "+rt.length+' "'+String(ae)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');_t.name="MaxListenersExceededWarning",_t.emitter=G,_t.type=ae,_t.count=rt.length,(typeof console>"u"?"undefined":_(console))==="object"&&console.warn&&console.warn("%s: %s",_t.name,_t.message)}}else rt=Ue[ae]=be,++G._eventsCount;return G}(this,q,z)}},{key:"once",value:function(q,z){if(typeof z!="function")throw new TypeError('"listener" argument must be a function');return this.on(q,function(G,ae,be){var Ie={fired:!1,wrapFn:void 0,target:G,type:ae,listener:be},Ue=H.call(me,Ie);return Ue.listener=be,Ie.wrapFn=Ue,Ue}(this,q,z)),this}},{key:"off",value:function(q,z){return we.call(this,q,z)}},{key:"removeAllListeners",value:function(q){var z,G,ae;if(!(G=this._events))return this;if(!G.off)return arguments.length===0?(this._events=O(null),this._eventsCount=0):G[q]&&(--this._eventsCount==0?this._events=O(null):delete G[q]),this;if(arguments.length===0){var be,Ie=B(G);for(ae=0;ae<Ie.length;++ae)(be=Ie[ae])!=="off"&&this.removeAllListeners(be);return this.removeAllListeners("off"),this._events=O(null),this._eventsCount=0,this}if(typeof(z=G[q])=="function")this.off(q,z);else if(z)for(ae=z.length-1;ae>=0;ae--)this.off(q,z[ae]);return this}},{key:"listeners",value:function(q){return Se(this,q,!0)}},{key:"rawListeners",value:function(q){return Se(this,q,!1)}},{key:"listenerCount",value:function(){return ue.listenerCount.apply(this,arguments)}}],[{key:"listenerCount",value:function(q,z){return typeof q.listenerCount=="function"?q.listenerCount(z):Me.call(q,z)}}]),ue}();try{var J={};Object.defineProperty&&Object.defineProperty(J,"x",{value:0}),F=J.x===0}catch{F=!1}function re(ue,q,z){if(q)ue.call(z);else for(var G=ue.length,ae=ke(ue,G),be=0;be<G;++be)try{ae[be].call(z)}catch(Ie){console.error(Ie)}}function se(ue,q,z,G){if(q)ue.call(z,G);else for(var ae=ue.length,be=ke(ue,ae),Ie=0;Ie<ae;++Ie)try{be[Ie].call(z,G)}catch(Ue){console.error(Ue)}}function Ae(ue,q,z,G,ae){if(q)ue.call(z,G,ae);else for(var be=ue.length,Ie=ke(ue,be),Ue=0;Ue<be;++Ue)try{Ie[Ue].call(z,G,ae)}catch(rt){console.error(rt)}}function Ee(ue,q,z,G,ae,be){if(q)ue.call(z,G,ae,be);else for(var Ie=ue.length,Ue=ke(ue,Ie),rt=0;rt<Ie;++rt)try{Ue[rt].call(z,G,ae,be)}catch(_t){console.error(_t)}}function Ne(ue,q,z,G){if(q)ue.apply(z,G);else for(var ae=ue.length,be=ke(ue,ae),Ie=0;Ie<ae;++Ie)try{be[Ie].apply(z,G)}catch(Ue){console.error(Ue)}}function we(ue,q){var z,G,ae,be,Ie;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(!(G=this._events))return this;if(!(z=G[ue]))return this;if(z===q||z.listener===q)--this._eventsCount==0?this._events=O(null):(delete G[ue],G.off&&this.emit("off",ue,z.listener||q));else if(typeof z!="function"){for(ae=-1,be=z.length-1;be>=0;be--)if(z[be]===q||z[be].listener===q){Ie=z[be].listener,ae=be;break}if(ae<0)return this;ae===0?z.shift():function(Ue,rt){for(var _t=rt,ct=_t+1,Lt=Ue.length;ct<Lt;_t+=1,ct+=1)Ue[_t]=Ue[ct];Ue.pop()}(z,ae),z.length===1&&(G[ue]=z[0]),G.off&&this.emit("off",ue,Ie||q)}return this}function me(){if(!this.fired)switch(this.target.off(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var ue=new Array(arguments.length),q=0;q<ue.length;++q)ue[q]=arguments[q];this.listener.apply(this.target,ue)}}function Se(ue,q,z){var G=ue._events;if(!G)return[];var ae=G[q];return ae?typeof ae=="function"?z?[ae.listener||ae]:[ae]:z?function(be){for(var Ie=new Array(be.length),Ue=0;Ue<Ie.length;++Ue)Ie[Ue]=be[Ue].listener||be[Ue];return Ie}(ae):ke(ae,ae.length):[]}function Me(ue){var q=this._events;if(q){var z=q[ue];if(typeof z=="function")return 1;if(z)return z.length}return 0}function ke(ue,q){for(var z=new Array(q),G=0;G<q;++G)z[G]=ue[G];return z}F?Object.defineProperty(K,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(ue){if(typeof ue!="number"||ue<0||ue!=ue)throw new TypeError('"defaultMaxListeners" must be a positive number');j=ue}}):K.defaultMaxListeners=j;var He=function(ue){function q(){return P(this,q),x(this,R(q).apply(this,arguments))}return S(q,ue),q}(K),ee=Object.prototype.toString;function ie(ue){return!!ue&&_(ue)=="object"}function xe(ue){return typeof ue=="number"&&!isNaN(ue)}function Ve(ue){return ie(ue)&&ee.call(ue).toLowerCase()==="[object arraybuffer]"}var Ge,Ze=function(){function ue(){P(this,ue),this.list_=[]}return L(ue,[{key:"clear",value:function(){var q=this.list_.length;q>0&&this.list_.splice(0,q),this.byteLength_=null}},{key:"toNewBytes",value:function(){for(var q=null,z=0;q===null;)try{z++,q=new Uint8Array(this.byteLength)}catch(Ie){if(z>50)throw Ie}for(var G=0,ae=0;G<this.list_.length;G++){var be=this.list_[G];q.set(be,ae),ae+=be.byteLength}return q}},{key:"append",value:function(q){q instanceof ue?this.list_=this.list_.concat(q.bufferList):this.list_.push(q),this.byteLength_=null}},{key:"cut",value:function(q){var z=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],G=null;if(q>0&&!this.empty){for(var ae=this.list_,be=0,Ie=0;ae.length>0;){var Ue=ae.shift();if(Ie!==0){var rt=q-be;if(Ue.byteLength>=rt){z&&G.set(Ue.subarray(0,rt),be),(Ue=Ue.subarray(rt)).byteLength>0&&ae.unshift(Ue);break}z&&G.set(Ue,be),be+=Ue.byteLength;break}if(Ue.byteLength>=q){z&&(G=Ue.subarray(0,q)),Ue.byteLength>q&&(Ue=Ue.subarray(q),ae.unshift(Ue));break}if(z){try{G=new Uint8Array(q)}catch(_t){throw"alloc_memory_error@ cache buffer: ".concat(q," ").concat(_t.message)}G.set(Ue,0)}be+=Ue.byteLength,Ie++}this.byteLength_=null}return G}},{key:"byteLength",get:function(){if(!xe(this.byteLength_)){for(var q=0,z=0;z<this.list_.length;z++)q+=this.list_[z].byteLength;this.byteLength_=q}return this.byteLength_}},{key:"bytes",get:function(){var q=this.bufferList,z=null;return q.length>0&&(z=q.length===0?q[0]:this.toNewBytes()),z}},{key:"empty",get:function(){return this.list_.length===0}},{key:"bufferList",get:function(){return this.list_}}]),ue}(),ut=function(){function ue(){P(this,ue),this.map_={}}return L(ue,[{key:"push",value:function(q,z){Object.prototype.hasOwnProperty.call(this.map_,q)?this.map_[q].push(z):this.map_[q]=[z]}},{key:"get",value:function(q){var z=this.map_[q];return z?z.slice():null}},{key:"getAll",value:function(){var q=[];for(var z in this.map_)q.push.apply(q,this.map_[z]);return q}},{key:"remove",value:function(q,z){var G=this.map_[q];if(G)for(var ae=0;ae<G.length;++ae)G[ae]==z&&(G.splice(ae,1),--ae)}},{key:"clear",value:function(){this.map_={}}},{key:"forEach",value:function(q){for(var z in this.map_)q(z,this.map_[z])}}]),ue}(),Qe=function(){function ue(q,z,G){P(this,ue),this.target=q,this.type=z,this.listener=G,this.target.addEventListener?this.target.addEventListener(z,G,!1):this.target.on&&this.target.on(z,G,!1)}return L(ue,[{key:"off",value:function(){this.target.removeEventListener?this.target.removeEventListener(this.type,this.listener,!1):this.target.off&&this.target.off(this.type,this.listener,!1),this.target=null,this.listener=null}}]),ue}(),ve=function(){function ue(){P(this,ue),this.bindingMap_=new ut}return L(ue,[{key:"destroy",value:function(){this.removeAll(),this.bindingMap_=null}},{key:"on",value:function(q,z,G){if(this.bindingMap_){var ae=new Qe(q,z,G);return this.bindingMap_.push(z,ae),this}}},{key:"once",value:function(q,z,G){this.on(q,z,function(ae){this.off(q,z),G(ae)}.bind(this))}},{key:"off",value:function(q,z){if(this.bindingMap_)for(var G=this.bindingMap_.get(z)||[],ae=0;ae<G.length;++ae){var be=G[ae];be.target==q&&(be.off(),this.bindingMap_.remove(z,be))}}},{key:"removeAll",value:function(){if(this.bindingMap_){for(var q=this.bindingMap_.getAll(),z=0;z<q.length;++z)q[z].off();this.bindingMap_.clear()}}}]),ue}(),Ke=(typeof window>"u"?self:window).console,ne=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof importScripts<"u",Z=">>>",fe=new(function(ue){function q(){var z;return P(this,q),(z=x(this,R(q).call(this)))._enable=!1,z}return S(q,ue),L(q,[{key:"log",value:function(){for(var z=arguments.length,G=new Array(z),ae=0;ae<z;ae++)G[ae]=arguments[ae];var be;ne?fe.emit(this.MSG_NAME,"log",[].concat(G).join("")):this._enable&&(be=Ke.log).call.apply(be,[Ke,Z].concat(G))}},{key:"debug",value:function(){for(var z=arguments.length,G=new Array(z),ae=0;ae<z;ae++)G[ae]=arguments[ae];var be;ne?fe.emit(this.MSG_NAME,"debug",[].concat(G).join("")):this._enable&&Ke.debug&&(be=Ke.debug).call.apply(be,[Ke,Z].concat(G))}},{key:"assert",value:function(){if(this._enable&&Ke.assert){for(var z,G=arguments.length,ae=new Array(G),be=0;be<G;be++)ae[be]=arguments[be];var Ie=ae[0],Ue=Array.prototype.slice.call(ae,1);Ue.unshift(Z),(z=Ke.assert).call.apply(z,[Ke,Ie].concat(v(Ue)))}}},{key:"warn",value:function(){for(var z=arguments.length,G=new Array(z),ae=0;ae<z;ae++)G[ae]=arguments[ae];var be;ne?fe.emit(this.MSG_NAME,"warn",[].concat(G).join("")):this._enable&&(be=Ke.warn).call.apply(be,[Ke,Z].concat(G))}},{key:"error",value:function(){for(var z=arguments.length,G=new Array(z),ae=0;ae<z;ae++)G[ae]=arguments[ae];var be;ne?fe.emit(this.MSG_NAME,"error",[].concat(G).join("")):this._enable&&(be=Ke.error).call.apply(be,[Ke,Z].concat(G))}},{key:"enable",get:function(){return this._enable},set:function(z){this._enable=z,this.MSG_NAME="__log__"}}]),q}(K)),Be=function(ue){function q(){return P(this,q),x(this,R(q).call(this))}return S(q,ue),L(q,[{key:"pipe",value:function(z){return this.on("reset",function(){z.reset()}),this.on("data",function(G){z.push(G)}),this.on("done",function(G){z.flush(G)}),z}},{key:"unpipe",value:function(){return this.removeAllListeners("reset"),this.removeAllListeners("data"),this.removeAllListeners("done"),this}},{key:"push",value:function(z,G){this.emit("data",z)}},{key:"flush",value:function(z){this.emit("done",z)}},{key:"reset",value:function(){this.emit("reset")}}]),q}(K),Xe=function(ue){function q(){var z,G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return P(this,q),z=x(this,R(q).call(this)),G.debug&&(fe.enable=!0),z.ctx_=new He,z.options_=G,z.cache_buffer_=new Ze,z}return S(q,ue),L(q,[{key:"listenEndStream_",value:function(){var z=this;this.eventManager_=new ve,this.eventManager_.on(this.endStream,"data",function(G){z.emit(a.DEMUX_DATA,G)}).on(this.endStream,"done",function(G){z.emit(a.DONE,G)}).on(this.ctx_,"error",function(G){z.emit(a.ERROR,G)})}},{key:"constraintPushData_",value:function(z){var G,ae=null;return Ve(z)||ie(G=z)&&ee.call(G).toLowerCase()==="[object uint8array]"?ae=Ve(z)?new Uint8Array(z):z:(fe.error("Data pushed is not an ArrayBuffer or Uint8Array: ".concat(z)),ae)}},{key:"reset",value:function(){}},{key:"destroy",value:function(){this.unpipe(),this.endStream.unpipe(),this.eventManager_.removeAll()}}]),q}(Be);(function(ue){ue[ue.WORKER_EXCEPTION=0]="WORKER_EXCEPTION",ue[ue.WORKER_MSG_EXCEPTION=1]="WORKER_MSG_EXCEPTION",ue[ue.TS_SYNC_BYTE=2]="TS_SYNC_BYTE",ue[ue.FLV_HEAD_SIGNATURE=3]="FLV_HEAD_SIGNATURE",ue[ue.FLV_NOT_EXPECTED_ADJACENT_DATA=4]="FLV_NOT_EXPECTED_ADJACENT_DATA"})(Ge||(Ge={}));var st=Ge;function mt(ue){var q=0;return ArrayBuffer.isView(ue)&&(q=ue.byteOffset,ue=ue.buffer),new DataView(ue,q)}var ye=function(){function ue(){P(this,ue)}return L(ue,[{key:"readUint8",value:function(q,z){return mt(q).getUint8(z)}},{key:"readUint16",value:function(q,z){var G=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return mt(q).getUint16(z,G)}},{key:"readUint32",value:function(q,z){var G=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return mt(q).getUint32(z,G)}}]),ue}(),$e=function(ue){function q(z){var G;P(this,q),(G=x(this,R(q).call(this))).table_id=z[0],G.section_syntax_indicator=z[1]>>7,G.section_length=(15&z[1])<<8|z[2],G.transport_stream_id=G.readUint16(z,3),G.version_number=z[5]>>1&31,G.current_next_indicator=z[5]&&1,G.section_number=z[6],G.last_section_number=z[7],G.network_PID=0;var ae,be=0,Ie=G.section_length-4-5;for(G.pmtTable=[];be<Ie;be+=4)(ae=G.readUint16(z,8+be))==0?(G.network_PID=(31&z[10+be])<<8|z[11+be],fe.log("packet->network_PID %0x /n/n",G.network_PID)):G.pmtTable.push({programNum:ae,program_map_PID:(31&z[10+be])<<8|z[11+be]});var Ue=G.section_length+3;return G.CRC_32=(255&z[Ue-4])<<24|(255&z[Ue-3])<<16|(255&z[Ue-2])<<8|255&z[Ue-1],G}return S(q,ue),q}(ye),vt=function(ue){function q(z){var G;if(P(this,q),(G=x(this,R(q).call(this))).table_id=z[0],G.section_syntax_indicator=z[1]>>7,G.section_length=(15&z[1])<<8|z[2],G.program_number=G.readUint16(z,3),G.version_number=z[5]>>1&31,G.current_next_indicator=z[5]&&1,G.section_number=z[6],G.last_section_number=z[7],G.PCR_PID=(31&z[8])<<8|z[9],G.program_info_length=(15&z[10])<<8|z[11],G.program_info_length<0)return x(G);if(G.program_info_length>2)for(var ae=0;ae<G.program_info_length;)ae+=z[13+ae];var be=12+G.program_info_length,Ie=G.section_length-G.program_info_length-9-4,Ue=be+Ie;if(be>=Ue)return fe.warn("es_section_pos < es_section_end ".concat(be,", ").concat(Ue)),x(G);G.pes_table=[];for(var rt=0;rt<Ie;){var _t=z[be+rt],ct=8191&G.readUint16(z,be+rt+1),Lt=4095&G.readUint16(z,be+rt+3);if(G.pes_table.push({streamType:_t,PID:ct}),Lt>2)for(var Ot=0,En=be+rt+5;Ot<Lt;)Ot+=z[En+Ot];rt+=Lt+5}var Br=G.section_length+3;return G.CRC_32=(255&z[Br-4])<<24|(255&z[Br-3])<<16|(255&z[Br-2])<<8|255&z[Br-1],G}return S(q,ue),L(q,[{key:"parse",value:function(){}}]),q}(ye),bt=function(ue){function q(z){var G;P(this,q),(G=x(this,R(q).call(this))).table_id=z[0],G.section_syntax_indicator=z[1]>>7,G.section_length=(15&z[1])<<8|z[2],G.transport_stream_id=G.readUint16(z,3),G.version_number=z[5]>>1&31,G.current_next_indicator=1&z[5],G.section_number=z[6],G.last_section_number=z[7],G.original_network_id=G.readUint16(z,8);var ae=G.section_length-8-4;G.service_table=[];for(var be=0;be<ae;){for(var Ie=0,Ue={service_id:G.readUint16(z,11),EIT_schedule_flag:2&z[13],EIT_present_following_flag:1&z[13],running_status:z[14]>>5,free_CA_mode:z[14]>>4&1,descriptors_loop_length:(15&z[14])<<8|z[15],provider_name:"",name:""};Ie<Ue.descriptors_loop_length;){var rt=16+Ie,_t=z[rt],ct=z[rt+1];switch(_t){case 72:var Lt=[],Ot=z[rt+3],En=0,Br=0,Xt=rt+4;for(En=0;En<Ot;En++)Lt.push(String.fromCharCode(z[Xt])),Xt+=1;Ue.provider_name=Lt.join("");var Va=[],mn=z[Xt];for(Xt+=1,Br=0;Br<mn;Br++)Va.push(String.fromCharCode(z[Xt])),Xt+=1;Ue.name=Va.join("");break;default:fe.warn("sdt section unhandled descriptor_tag ".concat(_t))}Ie+=2+ct}G.service_table.push(Ue),be+=5+Ue.descriptors_loop_length}return G}return S(q,ue),q}(ye),dt=function ue(){P(this,ue)},$t=function(){function ue(q){P(this,ue),this.context=q,this.metadata=new dt,this.pat_table=[],this.pes_streams=[]}return L(ue,[{key:"reset",value:function(){this.metadata=new dt,this.pat_table.splice(0,this.pat_table.length),this.pes_streams.splice(0,this.pes_streams.length)}},{key:"parse",value:function(q){q.PID===0?this._parsePat(q):q.PID===1||q.PID===2||3<=q.PID&&q.PID<=15||(q.PID===17?this._parseSdt(q):q.PID===this.currentProgramPID&&this._parsePmt(q))}},{key:"findTrack",value:function(q){for(var z=null,G=this.pes_streams,ae=0;ae<G.length;ae++)if(G[ae].id===q){z=G[ae];break}return z}},{key:"_parsePat",value:function(q){var z;if(q.payload_unit_start_indicator){var G=q.payload[0];z=q.payload.subarray(G+1)}else z=q.payload;for(var ae=new $e(z),be=0;be<ae.pmtTable.length;be++)this._add_pid_to_pmt(ae.pmtTable[be].programNum,ae.pmtTable[be].program_map_PID);return ae}},{key:"_add_pid_to_pmt",value:function(q,z){var G=this.pat_table;(function(ae){for(var be,Ie=0;Ie<G.length;Ie++)if((be=G[Ie]).id===ae)return{idx:Ie,item:be};return null})(q)||G.push({id:q,pid:z})}},{key:"_parsePmt",value:function(q){var z;if(q.payload_unit_start_indicator){var G=q.payload[0];z=q.payload.subarray(G+1)}else z=q.payload;for(var ae=new vt(z),be=0;be<ae.pes_table.length;be++)this._add_pes_stream(ae.pes_table[be],ae);return ae}},{key:"_add_pes_stream",value:function(q,z){var G=this.pes_streams;(function(ae){for(var be,Ie=0;Ie<G.length;Ie++)if((be=G[Ie]).id===ae)return{idx:Ie,item:be};return null})(q.PID)||G.push({id:q.PID,stream_type:q.streamType,pcr_pid:z.PCR_PID,duration:0,sps:[],pps:[],pixelRatio:[1,1],timescale:9e4,width:0,height:0})}},{key:"_parseSdt",value:function(q){var z;if(q.payload_unit_start_indicator){var G=q.payload[0];z=q.payload.subarray(G+1)}else z=q.payload;var ae=new bt(z);return ae.service_table.length>0&&(this.metadata.service_name=ae.service_table[0].name,this.metadata.service_provider=ae.service_table[0].provider_name),ae}},{key:"currentProgramPID",get:function(){for(var q=[],z=0;z<this.pat_table.length;z++)q.push(this.pat_table[z].pid);return q.length>0?q[0]:-1}}]),ue}(),Ct=function(ue){function q(z,G){var ae;return P(this,q),(ae=x(this,R(q).call(this))).context=z,ae.PSI=G,ae.videoTrack=null,ae.audioTrack=null,ae.captionTrack=null,ae}return S(q,ue),L(q,[{key:"push",value:function(z){for(var G,ae=z,be=0;be<ae.length;be++)switch((G=ae[be]).type){case"video":this._complexVideo(G);break;case"audio":this._complexAudio(G);break;case"caption":this._complexCaption(G)}}},{key:"flush",value:function(){this.emit("done"),this._clearStream()}},{key:"reset",value:function(){this._clearStream()}},{key:"_clearStream",value:function(){this.videoTrack=null,this.audioTrack=null,this.captionTrack=null}},{key:"_complexVideo",value:function(z){var G=this.PSI.findTrack(z.trackId);G&&(G.type="video",G.gops=z,G.firstDTS=z[0][0].dts,G.firstPTS=z[0][0].pts,G.duration=Number.POSITIVE_INFINITY,this.videoTrack=G,this.emit("data",{videoTrack:this.videoTrack}))}},{key:"_complexAudio",value:function(z){var G=this.PSI.findTrack(z.trackId);G&&(G.type="audio",G.frames=z,G.firstPTS=G.firstDTS=z[0].dts,G.duration=Number.POSITIVE_INFINITY,this.audioTrack=G,this.emit("data",{audioTrack:this.audioTrack}))}},{key:"_complexCaption",value:function(){}}]),q}(Be),Kt={mac:!1,iphone:!1,android:!1},Vt={version:!1,CHROME:!1,SAFARI:!1,FIREFOX:!1,IE11:!1,IE:!1,EDGE:!1,WECHAT:!1},Ft=navigator.userAgent.toLowerCase(),Pe=/(edge)\/([\w.]+)/.exec(Ft)||/(opr)[/]([\w.]+)/.exec(Ft)||/(chrome)[ /]([\w.]+)/.exec(Ft)||/(firefox)[ /]([\w.]+)/.exec(Ft)||/(iemobile)[/]([\w.]+)/.exec(Ft)||/(version)(applewebkit)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(Ft)||/(webkit)[ /]([\w.]+).*(version)[ /]([\w.]+).*(safari)[ /]([\w.]+)/.exec(Ft)||/(webkit)[ /]([\w.]+)/.exec(Ft)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(Ft)||/(msie) ([\w.]+)/.exec(Ft)||Ft.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(Ft)||Ft.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(Ft)||[],Je=/(ipad)/.exec(Ft)||/(ipod)/.exec(Ft)||/(windows phone)/.exec(Ft)||/(iphone)/.exec(Ft)||/(kindle)/.exec(Ft)||/(silk)/.exec(Ft)||/(android)/.exec(Ft)||/(win)/.exec(Ft)||/(mac)/.exec(Ft)||/(linux)/.exec(Ft)||/(cros)/.exec(Ft)||/(playbook)/.exec(Ft)||/(bb)/.exec(Ft)||/(blackberry)/.exec(Ft)||[],ot={version:void 0},wt={browser:Pe[5]||Pe[3]||Pe[1]||"",version:Pe[2]||Pe[4]||"0",versionNumber:Pe[4]||Pe[2]||"0",platform:Je[0]||""};if(wt.browser){ot[wt.browser]=!0;var Bt=wt.versionNumber.split(".");ot.version={major:parseInt(wt.versionNumber,10),string:wt.version},Bt.length>1&&(ot.version.minor=parseInt(Bt[1],10)),Bt.length>2&&(ot.version.build=parseInt(Bt[2],10))}Vt.version=ot.version,Vt.CHROME=!!ot.chrome,Vt.SAFARI=!!ot.safari&&!Vt.CHROME,Vt.FIREFOX=!!ot.firefox,Vt.IE11=/rv:11/.test(Ft),Vt.IE=!!ot.msie||Vt.IE11,Vt.EDGE=!!ot.edge,Vt.WECHAT=/(wechat)|(micromessenger)/.test(Ft),Kt.mac=!!wt.platform.mac,Kt.iphone=!!wt.platform.iphone,Kt.android=!!wt.platform.android;var Ln=Vt,lr=Kt,Xr=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Ca=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],tr=function(ue){function q(){return P(this,q),x(this,R(q).call(this))}return S(q,ue),L(q,[{key:"push",value:function(z){for(var G,ae,be,Ie,Ue,rt=z.pts,_t=z.dts,ct=z.payload,Lt=0,Ot=0;Lt+5<ct.length;)if(ct[Lt]===255&&(246&ct[Lt+1])==240){if(ae=2*(1&~ct[Lt+1]),G=(3&ct[Lt+3])<<11|ct[Lt+4]<<3|(224&ct[Lt+5])>>5,Ue=9e4*(Ie=1024*(1+(3&ct[Lt+6])))/Ca[(60&ct[Lt+2])>>>2],be=Lt+G,ct.byteLength<be)return;var En={pts:rt+Ot*Ue,dts:_t+Ot*Ue,sampleCount:Ie,audioObjectType:1+(ct[Lt+2]>>>6&3),channelCount:(1&ct[Lt+2])<<2|(192&ct[Lt+3])>>>6,sampleRate:Ca[(60&ct[Lt+2])>>>2],samplingFrequencyIndex:(60&ct[Lt+2])>>>2,sampleSize:16,data:ct.subarray(Lt+7+ae,be)};if(this.emit("frame",En),ct.byteLength===be)return ct=void 0,void this.emit("done");Ot++,ct=ct.subarray(be)}else Lt++}}]),q}(K),Fr=function(ue){function q(z){var G;return P(this,q),(G=x(this,R(q).call(this))).PSI=z,G.trackId=null,G.codec=new tr,G.codec.on("frame",function(ae){G.frames.push(ae),G.frames.byteLength+=ae.data.byteLength,G.frames.trackId=G.trackId}),G._newFrames(),G}return S(q,ue),L(q,[{key:"push",value:function(z){z.stream_type===15&&(this.trackId=z.pid,this.codec.push({dts:z.pes.DTS,pts:z.pes.PTS,payload:z.pes.data_byte}))}},{key:"flush",value:function(){if(this.frames.length>0){var z=this.frames.length,G=this.frames[0],ae=this.frames[z-1],be=ae.sampleRate*ae.sampleCount/9e4;this.frames.firstDTS=G.dts,this.frames.firstPTS=G.pts,this.frames.duration=z===1?be:be+(ae.pts-G.pts),this._updateTrackMeta(G),this.emit("data",this.frames),this.reset(),this.emit("done")}}},{key:"reset",value:function(){this.trackId=null,this._newFrames()}},{key:"_newFrames",value:function(){this.frames=[],this.frames.type="audio",this.frames.byteLength=0,this.frames.duration=0,this.frames.firstDTS=0,this.frames.firstPTS=0}},{key:"_updateTrackMeta",value:function(z){var G=this.PSI.findTrack(this.trackId),ae=function(be,Ie,Ue){var rt,_t,ct=be;if(!(Ie>Xr.length-1))return Ln.FIREFOX?Ie>=6?(be=5,_t=new Array(4),rt=Ie-3):(be=2,_t=new Array(2),rt=Ie):lr.android?(be=2,_t=new Array(2),rt=Ie):(be=5,_t=new Array(4),Ie>=6?rt=Ie-3:(Ue===1&&(be=2,_t=new Array(2)),rt=Ie)),_t[0]=be<<3,_t[0]|=(14&Ie)>>1,_t[1]|=(1&Ie)<<7,_t[1]|=Ue<<3,be===5&&(_t[1]|=(14&rt)>>1,_t[2]=(1&rt)<<7,_t[2]|=8,_t[3]=0),{config:_t,sampleRate:Xr[Ie],channelCount:Ue,codec:"mp4a.40."+be,realCodec:"mp4a.40."+ct};fe.error("invalid sampling index:".concat(Ie))}(z.audioObjectType,z.samplingFrequencyIndex,z.channelCount);G.config=ae.config,G.sampleRate=ae.sampleRate,G.inputTimeScale=G.inputTimeScale||G.timescale,G.timescale=ae.sampleRate,G.channelCount=ae.channelCount,G.codec=ae.codec,G.realCodec=ae.realCodec,G.isAAC=!0}}]),q}(Be);function hi(ue){for(var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,G=0,ae="",be=q;be<q+z;be++)G=7-be%8,ae+=ue[Math.floor(be/8)]>>G&1;return parseInt(ae,2)}function ii(ue){for(var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,z=[],G=8*ue.byteLength,ae=!1,be=0,Ie=0,Ue="",rt=q;rt<G;rt++)if(be=7-rt%8,Ie=ue[Math.floor(rt/8)]>>be&1,!ae){if(Ie!==0){ae=!0,q=rt;break}z.push(0)}for(var _t=z.length+1,ct=q;ct<q+_t;ct++)be=7-ct%8,Ue+=Ie=ue[Math.floor(ct/8)]>>be&1;return{bitLength:z.length+_t,value:parseInt(Ue,2)-1}}var zt={readUEV:ii,readSEV:function(ue){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,z=ii(ue,q),G=z.value,ae=Math.pow(-1,G+1)*Math.ceil(G/2);return{bitLength:z.bitLength,value:ae}},readBit:hi,readByte:function(ue){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return hi(ue,q,8)}},it=0;function za(ue,q){for(var z,G=8,ae=8,be=0;be<q;be++)ae!=0&&(z=zt.readUEV(ue,it),it+=z.bitLength,ae=(G+z.value+256)%256),G=ue[be]}var he,Fe,Ye=function(ue){function q(z){var G;switch(P(this,q),(G=x(this,R(q).call(this))).forbidden_zero_bit=z[0]>>7,G.ref_idc=z[0]>>5&3,G.unit_type=31&z[0],G.data=function(ae){for(var be,Ie=ae.byteLength,Ue=[],rt=1,_t=new Uint8Array(0);rt<Ie-2;)ae[rt]===0&&ae[rt+1]===0&&ae[rt+2]===3?(Ue.push(rt+2),rt+=2):rt++;if(Ue.length===0)return ae;be=Ie-Ue.length;try{_t=new Uint8Array(be)}catch{throw"epsb alloc mem error ".concat(be)}var ct=0;for(rt=0;rt<be;ct++,rt++)ct===Ue[0]&&(ct++,Ue.shift()),_t[rt]=ae[ct];return _t}(z.subarray(1)),G.rawData=z,G.unit_type){case 1:break;case 2:case 3:case 4:case 5:break;case 7:G.sps=function(ae){it=0;var be,Ie,Ue,rt,_t,ct,Lt,Ot=ae[0],En=ae[1],Br=ae[2],Xt=ae.subarray(3),Va=0,mn=[1,1],Os=1,iu=0,ds=!0,Ea=zt.readUEV(Xt,it);if(it+=Ea.bitLength,Ot==100||Ot==110||Ot==122||Ot==244||Ot==44||Ot==83||Ot==86||Ot==118||Ot==128){var ps=zt.readUEV(Xt,it);it+=ps.bitLength,ps.value==3&&(it+=1);var oc=zt.readUEV(Xt,it);it+=oc.bitLength;var yr=zt.readUEV(Xt,it);if(it+=yr.bitLength,it+=1,Va=zt.readBit(Xt,it),it+=1,Va)for(var dl=0;dl<(ps.value!=3?8:12);dl++){var sr=zt.readBit(Xt,it);it+=1,sr&&za(Xt,dl<6?16:64)}}var Aa=zt.readUEV(Xt,it);it+=Aa.bitLength;var pl=zt.readUEV(Xt,it),au=pl.value;if(it+=pl.bitLength,au===0)be=zt.readUEV(Xt,it),it+=be.bitLength;else if(au===1){it+=1,Ie=zt.readSEV(Xt,it),it+=Ie.bitLength,Ue=zt.readSEV(Xt,it),it+=Ue.bitLength,rt=zt.readUEV(Xt,it),it+=rt.bitLength;for(var ml,ep=0;ep<rt.value;ep++)ml=zt.readSEV(Xt,it),it+=ml.bitLength}var tp=zt.readUEV(Xt,it);it+=tp.bitLength,it+=1;var np=zt.readUEV(Xt,it);it+=np.bitLength;var rp=zt.readUEV(Xt,it);it+=rp.bitLength;var su=zt.readBit(Xt,it);it+=1,su||(it+=1),it+=1;var ou=zt.readBit(Xt,it);it+=1;var $f=0,ip=0,lu=0,Ur=0;if(ou){var lc=zt.readUEV(Xt,it);it+=lc.bitLength,$f=lc.value;var uc=zt.readUEV(Xt,it);it+=uc.bitLength,ip=uc.value;var cc=zt.readUEV(Xt,it);it+=cc.bitLength,lu=cc.value;var gl=zt.readUEV(Xt,it);it+=gl.bitLength,Ur=gl.value}var ea=zt.readBit(Xt,it);if(it+=1,ea){var av=zt.readBit(Xt,it);if(it+=1,av){var Ff=zt.readByte(Xt,it);switch(it+=8,Ff){case 1:mn=[1,1];break;case 2:mn=[12,11];break;case 3:mn=[10,11];break;case 4:mn=[16,11];break;case 5:mn=[40,33];break;case 6:mn=[24,11];break;case 7:mn=[20,11];break;case 8:mn=[32,11];break;case 9:mn=[80,33];break;case 10:mn=[18,11];break;case 11:mn=[15,11];break;case 12:mn=[64,33];break;case 13:mn=[160,99];break;case 14:mn=[4,3];break;case 15:mn=[3,2];break;case 16:mn=[2,1];break;case 255:var Bf=zt.readByte(Xt,it);it+=8;var Uf=zt.readByte(Xt,it);it+=8;var zf=zt.readByte(Xt,it);it+=8;var fc=zt.readByte(Xt,it);it+=8,mn=[Bf<<8|Uf,zf<<8|fc]}mn&&(Os=mn[0]/mn[1]),Ff===255&&(it+=16,it+=16)}var vl=zt.readBit(Xt,it);it+=1,vl&&(it+=1);var Vf=zt.readBit(Xt,it);if(it+=1,Vf){_t=zt.readBit(Xt,it,3),it+=3,it+=1;var hc=zt.readBit(Xt,it);it+=1,hc&&(it+=24)}var ap=zt.readBit(Xt,it);if(it+=1,ap){var sp=zt.readUEV(Xt,it);it+=sp.bitLength;var uu=zt.readUEV(Xt,it);it+=uu.bitLength}var op=zt.readBit(Xt,it);it+=1,op&&(ct=zt.readBit(Xt,it,32),it+=32,Lt=zt.readBit(Xt,it,32),it+=32,ds=!!zt.readBit(Xt,it),it+=1,iu=Lt/(2*ct))}return{payload:Xt,profile_idc:Ot,profile_compatibility:En,level_idc:Br,sps_id:Ea.value,log2_max_frame_num_minus4:pl.value,pic_order_cnt_type:au,log2_max_pic_order_cnt_lsb_minus4:be?be.value:0,width:Math.ceil((16*(np.value+1)-2*$f-2*ip)*Os),height:(2-su)*(rp.value+1)*16-2*lu-2*Ur,pixelRatio:mn,video_format:_t,fps:iu,fixedFPS:ds}}(G.data);break;case 8:G.pps=function(ae){var be,Ie=0,Ue=ae,rt=[],_t=0;Ie+=zt.readUEV(Ue,Ie).bitLength,Ie+=zt.readUEV(Ue,Ie).bitLength,Ie+=1,Ie+=1;var ct=zt.readUEV(Ue,Ie);if(Ie+=ct.bitLength,ct.value>0){var Lt=zt.readUEV(Ue,Ie);Ie+=Lt.bitLength;var Ot=0;switch(Lt.value){case 0:for(Ot=0;Ot<=Lt.value;Ot++)Ie+=zt.readUEV(Ue,Ie).bitLength;break;case 2:for(Ot=0;Ot<=Lt.value;Ot++)Ie+=zt.readUEV(Ue,Ie).bitLength,Ie+=zt.readUEV(Ue,Ie).bitLength;break;case 3:case 4:case 5:Ie+=1,Ie+=zt.readUEV(Ue,Ie).bitLength;break;case 6:Ie+=(be=zt.readUEV(Ue,Ie)).bitLength;var En=Math.ceil(Math.log2(ct.value+1));for(_t=0;_t<=be.value;_t++)rt.push(zt.readBit(Ue,Ie,En)),Ie+=En}}return Ie+=zt.readUEV(Ue,Ie).bitLength,Ie+=zt.readUEV(Ue,Ie).bitLength,Ie+=1,Ie+=1,Ie+=zt.readSEV(Ue,Ie).bitLength,Ie+=zt.readSEV(Ue,Ie).bitLength,Ie+=zt.readSEV(Ue,Ie).bitLength,Ie+=1,Ie+=1,Ie+=1,{sliceGroupNum:ct.value+1}}(G.data);break;case 6:G.sei=(G.data,{});break;case 9:G.primary_pic_type=G.data[0]>>5}return G}return S(q,ue),q}(ye),ze=function(ue){function q(){var z;return P(this,q),(z=x(this,R(q).call(this))).cachedBytes=null,z}return S(q,ue),L(q,[{key:"push",value:function(z){var G,ae=0,be=0,Ie=0,Ue=z.pts,rt=z.dts,_t=z.payload,ct=z.naluSizeLength;if(this.cachedBytes){try{G=new Uint8Array(this.cachedBytes.byteLength+_t.byteLength)}catch{throw"h264 alloc mem error ".concat(this.cachedBytes.byteLength,"/").concat(_t.byteLength)}G.set(this.cachedBytes),G.set(_t,this.cachedBytes.byteLength)}else G=_t;if(ct){var Lt=0,Ot=0,En=0;do{Ot=0;for(var Br=0;Br<ct;Br++)Ot|=G[Lt+Br]<<8*(ct-Br-1);(En=(Lt+=ct)+Ot)>G.length&&(En=G.length);var Xt=G.subarray(Lt,En),Va=new Ye(Xt);Va.pts=Ue,Va.dts=rt,this.emit("nalu",Va),Lt=En}while(Lt<G.length)}else{var mn=G.byteLength-1,Os=0;do{if(G[mn]!==0)break;Os++,mn--}while(mn>0);Os>=3&&(G=G.subarray(0,mn+1));do{var iu=G[ae]<<24|G[ae+1]<<16|G[ae+2]<<8|G[ae+3],ds=G.length-ae>=4?iu:-1,Ea=0,ps=ae===G.length-1;if(ds>>8==1?Ea=3:ds===1&&(Ea=4),Ea===3||Ea===4||ps){var oc=be+Ie,yr=ps&&Os>=3;if(ae>be&&(!ps||yr)){var dl=G.subarray(oc,yr?ae+1:ae),sr=new Ye(dl);sr.pts=Ue,sr.dts=rt,this.emit("nalu",sr),be=ae}ps&&(Os<3?(this.cachedBytes=G.subarray(be),this.cachedBytes.pts=Ue,this.cachedBytes.dts=rt,this.cachedBytes.startCodeLength=Ie):this.cachedBytes=null),ae===be&&(Ie=Ea),ae+=Ea||1}else ae++}while(ae<G.length)}if(this.cachedBytes){var Aa=new Ye(this.cachedBytes.subarray(this.cachedBytes.startCodeLength));Aa.pts=this.cachedBytes.pts,Aa.dts=this.cachedBytes.dts,this.emit("nalu",Aa),this.cachedBytes=null}this.emit("done")}},{key:"reset",value:function(){this.cachedBytes=null}}]),q}(K),tt=function(ue){function q(z){var G;return P(this,q),(G=x(this,R(q).call(this))).PSI=z,G.trackId=null,G.currentFrame=[],G.codec=new ze,G._newGop(),G._newGops(),G.codec.on("nalu",function(ae){if(ae.unit_type===7){var be=G.PSI.findTrack(G.trackId),Ie=function(Ue){for(var rt="avc1.",_t=[Ue.profile_idc,Ue.profile_compatibility,Ue.level_idc],ct=0;ct<_t.length;ct++){var Lt=_t[ct].toString(16);Lt.length<2&&(Lt="0"+Lt),rt+=Lt}return{codec:rt}}(ae.sps);be.codec=Ie.codec,be.width=ae.sps.width,be.height=ae.sps.height,be.profileIdc=ae.sps.profile_idc,be.profileCompatibility=ae.sps.profile_compatibility,be.levelIdc=ae.sps.level_idc,be.pixelRatio=ae.sps.pixelRatio,be.sps=[ae.rawData]}else ae.unit_type===8&&(G.PSI.findTrack(G.trackId).pps=[ae.rawData]);G._grouping(ae)}),G}return S(q,ue),L(q,[{key:"push",value:function(z){var G=z.stream_type,ae=z.pes,be=z.pid;if(G===27||G===36){this.trackId=be;var Ie={pts:ae.PTS,dts:ae.DTS,payload:ae.data_byte};this.codec.push(Ie)}}},{key:"flush",value:function(){this.currentFrame.length>0&&((!this.currentFrame.duration||this.currentFrame.duration<=0)&&(this.currentFrame.duration=this.prevFrame.duration||0),this._pushFrameIntoGop(),this.currentFrame=[]),this.gop.length>0&&this._pushGopIntoGroup()}},{key:"reset",value:function(){this.codec.reset(),this.currentFrame=[],this._newGop(),this._newGops()}},{key:"_grouping",value:function(z){z.unit_type===9?(this.currentFrame.length>0&&(this.currentFrame.duration=z.dts-this.currentFrame.dts,this.gop.length>0&&this.currentFrame.keyframe&&(this.gop.trackId=this.trackId,this._pushGopIntoGroup()),this.currentFrame.keyframe||this.gop.length>0?this._pushFrameIntoGop():fe.warn("h264 codec drop frame")),this.prevFrame=this.currentFrame,this.currentFrame=[],this.currentFrame.keyframe=!1,this.currentFrame.byteLength=0,this.currentFrame.naluCount=0,this.currentFrame.pts=z.pts,this.currentFrame.dts=z.dts):(z.unit_type===5&&(this.currentFrame.keyframe=!0),this.currentFrame.byteLength+=z.rawData.byteLength,this.currentFrame.naluCount++,this.currentFrame.push(z)),this.currentFrame.duration=z.dts-this.currentFrame.dts}},{key:"_newGop",value:function(){this.gop=[],this.gop.duration=0,this.gop.naluCount=0,this.gop.byteLength=0}},{key:"_pushFrameIntoGop",value:function(){this.gop.push(this.currentFrame),this.gop.duration+=this.currentFrame.duration,this.gop.byteLength+=this.currentFrame.byteLength,this.gop.naluCount+=this.currentFrame.naluCount}},{key:"_newGops",value:function(){this.gops=[],this.gops.type="video",this.gops.duration=0,this.gops.naluCount=0,this.gops.byteLength=0,this.gops.frameLength=0,this.gops.firstDTS=0}},{key:"_pushGopIntoGroup",value:function(){var z=this.gop[0];this.gops.trackId=this.trackId,this.gops.duration+=this.gop.duration,this.gops.byteLength+=this.gop.byteLength,this.gops.naluCount+=this.gop.naluCount,this.gops.frameLength+=this.gop.length,this.gops.firstDTS=z.dts,this.gops.firstPTS=z.pts,this.gops.push(this.gop),this.emit("data",this.gops),this._newGop(),this._newGops(),this.emit("done")}}]),q}(Be),Gt=function(ue){function q(z,G){var ae,be=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return P(this,q),(ae=x(this,R(q).call(this))).context=z,ae.PSI=G,ae.options=be,ae.tracks=[],ae.adtsStream=new Fr(G),ae.avcStream=new tt(G),ae.streams=[ae.adtsStream,ae.avcStream],be.decodeCodec&&(ae.avcStream.on("data",function(Ie){var Ue=be.config.stubTime;if(xe(Ue)){var rt=(Ie.firstPTS+Ie.duration)/9e4;if(rt<Ue)return void fe.warn("drop avc gop, start/end/stubTime(".concat(Ie.firstPTS,"/").concat(rt,"/").concat(Ue,")"))}ae.tracks.push(Ie),ae.emit("data",ae.tracks),ae.tracks=[],ae.adtsStream.flush()}),ae.adtsStream.on("data",function(Ie){var Ue=be.config.stubTime;if(xe(Ue)){var rt=(Ie.firstPTS+Ie.duration)/9e4;if(rt<Ue)return void fe.warn("drop adts, start/end/stubTime(".concat(Ie.firstPTS,"/").concat(rt,"/").concat(Ue,")"))}ae.tracks.push(Ie),ae.emit("data",ae.tracks),ae.tracks=[]})),ae}return S(q,ue),L(q,[{key:"push",value:function(z){var G=this.options,ae=this.adtsStream,be=this.avcStream,Ie=z.stream_type;if(G.decodeCodec)switch(Ie){case 27:case 36:be.push(z);break;case 15:ae.push(z);break;default:fe.warn("ts elementary encounter unknown stream type ".concat(Ie))}else this.emit("data",z)}},{key:"flush",value:function(){for(var z=this.streams,G=this.tracks,ae=0;ae<this.streams.length;ae++)z[ae].flush();G.length>0&&this.emit("data",G),this.emit("done"),G.splice(0,G.length)}},{key:"reset",value:function(){this.tracks=[];for(var z=0;z<this.streams.length;z++)this.streams[z].reset();this.emit("reset")}}]),q}(Be),Zt=function(ue){function q(z){var G;return P(this,q),(G=x(this,R(q).call(this))).start_code_prefix=G.readUint16(z,0)<<8|z[2],G.stream_id=z[3],G.packet_length=G.readUint16(z,4),G.data_alignment_indicator=4&z[6],G.copyright=2&z[6],G.PTS_DTS_flags=z[7]>>6,G.ESCR_flag=32&z[7],G.ES_rate_flag=16&z[7],G.trick_mode_flag=8&z[7],G.additional_copy_info_flag=4&z[7],G.CRC_flag=2&z[7],G.extension_flag=1&z[7],G.header_data_length=z[8],G.PTS=0,(2&G.PTS_DTS_flags)==2&&(G.PTS=G.calcTimestamp_(z,9)),G.DTS=G.PTS,(1&G.PTS_DTS_flags)==1&&(G.DTS=G.calcTimestamp_(z,14)),G.data_byte=z.subarray(9+G.header_data_length),G}return S(q,ue),L(q,[{key:"calcTimestamp_",value:function(z,G){return 536870912*(14&z[G])+(z[G+1]<<22)+(z[G+2]>>1<<15)+(z[G+3]<<7)+(z[G+4]>>1)}},{key:"valid",value:function(){var z=this.start_code_prefix;return z[0]===0&&z[1]===0&&z[2]===1}}]),q}(ye),fn=function(ue){function q(z,G){var ae;return P(this,q),(ae=x(this,R(q).call(this))).context=z,ae.PSI=G,ae.PID=null,ae.cache_buffer=new Ze,ae}return S(q,ue),L(q,[{key:"push",value:function(z){z.PID>255&&z.PID<8191&&(this.PSI.currentProgramPID==-1?this._pushPacket(z):this.PSI.currentProgramPID!==z.PID&&(z.payload_unit_start_indicator===1&&this._assembleOnePES(),this._pushPacket(z)))}},{key:"flush",value:function(){this._assembleOnePES(),this.emit("done")}},{key:"reset",value:function(){this._clearCached(),this.emit("reset")}},{key:"_clearCached",value:function(){this.PID=null,this.cache_buffer.clear()}},{key:"_pushPacket",value:function(z){var G=this.cache_buffer.empty;G&&z.payload_unit_start_indicator===0||(G&&(this.PID=z.PID),this.cache_buffer.append(z.payload))}},{key:"_assembleOnePES",value:function(){if(!this.cache_buffer.empty){var z;try{z=this.cache_buffer.toNewBytes()}catch{throw"pes alloc mem err ".concat(this.cache_buffer.byteLength)}var G=new Zt(z),ae=this.PSI.findTrack(this.PID);if(ae){var be={pid:ae.id,stream_type:ae.stream_type,pcr_pid:ae.pcr_pid,pes:G};this.emit("data",be)}this._clearCached()}}}]),q}(Be),hn=function(ue){function q(z){var G;if(P(this,q),(G=x(this,R(q).call(this))).sync_byte=z[0],G.transport_error_indicator=z[1]>>7,G.payload_unit_start_indicator=z[1]>>6&1,G.transport_priority=z[1]>>>5&1,G.PID=8191&G.readUint16(z,1),G.tsc=z[3]>>6,G.afc=z[3]>>4&3,G.continuity_counter=15&z[3],G.has_payload=1&G.afc,G.has_adaptation=2&G.afc,G.has_payload)if(G.has_adaptation){var ae=z[4];G.payload=z.subarray(5+ae)}else G.payload=z.subarray(4);return G}return S(q,ue),L(q,[{key:"valid",value:function(){return this.sync_byte===71&&this.has_payload===1}}]),q}(ye),Mn=function(ue){function q(){var z,G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return P(this,q),(z=x(this,R(q).call(this,G))).psi_=new $t(z.ctx_),z.pesStream_=new fn(z.ctx_,z.psi_),z.elementaryStream_=new Gt(z.ctx_,z.psi_,G),z.complexStream_=new Ct(z.ctx_,z.psi_),z.pipe(z.pesStream_),z.pesStream_.pipe(z.elementaryStream_),z.elementaryStream_.pipe(z.complexStream_),g(R(q.prototype),"listenEndStream_",b(z)).call(b(z)),z}return S(q,ue),L(q,[{key:"push",value:function(z,G){var ae=G.done,be=this.options_,Ie=this.ctx_,Ue=this.cache_buffer_,rt=this.psi_,_t=g(R(q.prototype),"constraintPushData_",this).call(this,z),ct=Ue.byteLength,Lt=null;for(be.config=G,fe.log("hls demux received ".concat(_t.byteLength," bytes, cache ").concat(ct," bytes. ").concat(ae?"chunk done":"")),Ue.append(_t);Ue.byteLength>=188;){var Ot=Ue.cut(188);if(Ot){var En=new hn(Ot);if(!En.valid()){var Br="Encounter invalid ts packet, packet_length(".concat(Ot.length,"), cache_length(").concat(this.cache_buffer_.byteLength,"), has_payload(").concat(En.has_payload,"), data(").concat(Ot,")");fe.error(Br),this.reset(),Ie.emit("error",st.TS_SYNC_BYTE,Br,{startByte:Lt,endByte:Lt+Ot.byteLength});break}rt.parse(En),this.emit("data",En),Lt+=Ot.byteLength}}Ue.empty&&ae&&this.emit("done")}},{key:"reset",value:function(){this.cache_buffer_.clear(),this.emit("reset")}},{key:"endStream",get:function(){var z=this.elementaryStream_;return this.options_.decodeCodec&&(z=this.complexStream_),z}}]),q}(Xe);(function(ue){ue[ue.HEAD=0]="HEAD",ue[ue.BODY=1]="BODY"})(he||(he={})),function(ue){ue[ue.SCRIPT_DATA=18]="SCRIPT_DATA",ue[ue.VIDEO=9]="VIDEO",ue[ue.AUDIO=8]="AUDIO"}(Fe||(Fe={}));var vn,yn;(function(ue){ue[ue.AAC=10]="AAC"})(vn||(vn={})),function(ue){ue[ue.MONO=0]="MONO",ue[ue.STEREO=1]="STEREO"}(yn||(yn={}));var Cr;(function(ue){ue[ue.SEQUENCE_HEAD=0]="SEQUENCE_HEAD",ue[ue.AAC_RAW=1]="AAC_RAW"})(Cr||(Cr={}));var ur;(function(ue){ue[ue.SEQUENCE_HEAD=0]="SEQUENCE_HEAD",ue[ue.NALU=1]="NALU",ue[ue.SEQUENCE_END=2]="SEQUENCE_END"})(ur||(ur={}));var Kr=new ze;Kr.on("nalu",function(ue){});var Di;(function(ue){ue[ue.AVC=7]="AVC"})(Di||(Di={}));var Er=function(){function ue(q){o()(this,ue),m()(this,"previousPes",null),m()(this,"maxAudioPTS",0),m()(this,"maxVideoPTS",0),q?(this.init(),this.dataArray=[],this.videoArray=[],this.audioArray=[],this.decode=q):console.error("class TsDemux need pass decode parmas")}return u()(ue,[{key:"init",value:function(){var q=this;try{this.demuxer=new Mn({enableWorker:!1,debug:!1,onlyDemuxElementary:!0}),this.demuxer.on(a.DEMUX_DATA,function(z){z instanceof Array?(q.dataArray.push(z),q.demuxed(q.dataArray),q.dataArray=[]):q.dataArray.push(z)}),this.demuxer.on(a.DONE,function(z){var G={};q.demuxed(q.dataArray),q.dataArray=[],q.previousPes.partEnd=!0,q.previousPes.lastTS=q.isLast,q.isLast?(q.maxPTS=Math.min(q.maxAudioPTS,q.maxVideoPTS),G.audioEnd=!0,q.audioQueue(G),self.postMessage({type:"demuxedAAC",data:q.audioArray}),q.audioArray=[],self.postMessage({type:"maxPTS",data:{maxAudioPTS:q.maxAudioPTS,maxVideoPTS:q.maxVideoPTS}})):(self.postMessage({type:"demuxedAAC",data:q.audioArray}),q.audioArray=[]),q.decode.push(q.videoArray),q.videoArray=[],q.previousPes=null})}catch{console.error("init demuxer failed.")}}},{key:"push",value:function(q){this.demuxer.push(q,{done:!0})}},{key:"demuxed",value:function(q){var z=this;q.forEach(function(G){z.tsDemuxed(G)})}},{key:"tsDemuxed",value:function(q){var z=q.stream_type,G=q.pes||{};switch(z){case 36:this.videoQueue(G);break;case 3:case 15:case 17:G.PTS=Math.round(G.PTS*c.a*1e3),this.maxAudioPTS=Math.max(G.PTS,this.maxAudioPTS),this.audioQueue(G)}}},{key:"audioQueue",value:function(q){this.audioArray.push(q)}},{key:"videoQueue",value:function(q){this.previousPes=q,this.maxVideoPTS=Math.max(this.maxVideoPTS,q.PTS),this.videoArray.push(q)}},{key:"destroy",value:function(){this.demuxer.destroy()}}]),ue}();self.decode=new d,self.demuxer=new Er(self.decode),r.default=function(ue){ue.onmessage=function(q){var z=q.data,G=z.type,ae=z.data,be=z.isLast;switch(G){case"startDemux":ue.demuxer.isLast=be,ue.demuxer.push(ae);break;case"loadwasm":ue.decode.loadWASM(q);break;case"flush":ue.decode.flush()}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,r,i){t.exports=i(163)},function(t,r,i){t.exports=i(85).default}])})})(DZ);var GBe=DZ.exports;const _it=b_(GBe);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jBe=1e-7,qBe=1e-4;class LZ{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class $D{refCount(e){return _s("refCount")}incRef(e){return _s("incRef")}timerAvailable(){return!0}time(e){return _s("time")}read(e){return _s("read")}readSync(e){return _s("readSync")}readToGPU(e,t){return _s("readToGPU")}numDataIds(){return _s("numDataIds")}disposeData(e,t){return _s("disposeData")}write(e,t,r){return _s("write")}move(e,t,r,i,a){return _s("move")}memory(){return _s("memory")}floatPrecision(){return _s("floatPrecision")}epsilon(){return this.floatPrecision()===32?jBe:qBe}dispose(){return _s("dispose")}}function _s(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,ku(n,e,t)}function XBe(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,r=0;for(;t>0;)r=Math.random()*t|0,t--,ku(n,t,r),ku(e,t,r)}function e_(n,e,t){return Math.max(n,Math.min(e,t))}function GT(n){return n%2===0?n:n+1}function ku(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function OZ(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function KBe(n,e){const t=Math.random();return e*t+(1-t)*n}function YBe(n,e){let t=0;for(let r=0;r<n.length;r++){const i=Number(n[r])-Number(e[r]);t+=i*i}return t}function le(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Qi(n,e,t=""){le(Jr(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Gd(n){le(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Zu(n,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(n)||Wi(n)&&!t)for(let r=0;r<n.length;++r)Zu(n[r],e,t);else e.push(n);return e}function yt(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function ZBe(n){return n.length===0}function Jr(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Sd(n){return n%1===0}function QBe(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function aS(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function JBe(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return NZ(e),e}function id(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function nR(n,e=i=>0,t,r=setTimeout){return new Promise((i,a)=>{let s=0;const o=()=>{if(n()){i();return}s++;const l=e(s);if(t!=null&&s>=t){a();return}r(o,l)};o()})}function $Z(n,e){let t=1,r=-1;for(let a=0;a<n.length;++a)if(n[a]>=0)t*=n[a];else if(n[a]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${a}`);r=a}else if(n[a]<0)throw Error(`Shapes can not be < 0. Found ${n[a]} at dim ${a}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const i=n.slice();return i[r]=e/t,i}function _i(n,e){const t=e.length;return n=n==null?e.map((r,i)=>i):[].concat(n),le(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),le(n.every(r=>Sd(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function ic(n,e){const t=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||i?null:_i(e,n).sort();let s=0;for(let o=0;o<n.length;++o){if(a!=null){if(a[s]===o&&n[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${n[o]}' is not 1`);(a[s]==null||a[s]>o)&&n[o]===1&&(t.push(n[o]),r.push(o)),a[s]<=o&&s++}n[o]!==1&&(t.push(n[o]),r.push(o))}return{newShape:t,keptDims:r}}function Xl(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${n}`);return t}function ga(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function FZ(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function BZ(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function UZ(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function Wi(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}function sS(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function zZ(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function $u(n){return typeof n=="string"||n instanceof String}function VZ(n){return typeof n=="boolean"}function HZ(n){return typeof n=="number"}function F_(n){return Array.isArray(n)?F_(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":HZ(n)?"float32":$u(n)?"string":VZ(n)?"bool":"float32"}function _f(n){return!!(n&&n.constructor&&n.call&&n.apply)}function oS(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Ai(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function WZ(n,e,t,r=!1){const i=new Array;if(e.length===1){const a=e[0]*(r?2:1);for(let s=0;s<a;s++)i[s]=t[n+s]}else{const a=e[0],s=e.slice(1),o=s.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<a;l++)i[l]=WZ(n+l*o,s,t,r)}return i}function ad(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((i,a)=>i*a)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return WZ(0,n,e,t)}function FD(n,e){const t=Qu(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function Qu(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function e4e(n,e){const t=n.reduce((r,i)=>r*i,1);if(e==null||e==="float32")return ad(n,new Float32Array(t));if(e==="int32")return ad(n,new Int32Array(t));if(e==="bool")return ad(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function BD(n){n.forEach(e=>{le(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function lS(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let i=0;i<n.length-1;++i)r+=t[i]*n[i];return r}function jT(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(n/t[i]),n-=r[i]*t[i];return r[r.length-1]=n,r}function Td(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pH="tfjsflags";class GZ{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=t4e,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(We().getBool("IS_TEST")||We().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const i=this.urlFlags[e];We().getBool("IS_TEST")||We().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${i}.`),this.set(e,i)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Td(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);pH in e&&e[pH].split(",").forEach(r=>{const[i,a]=r.split(":");this.urlFlags[i]=r4e(i,a)})}}function t4e(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(n4e(e,r[0],r[1]),r.join("="))),e}function n4e(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function r4e(n,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${n}.`)}function We(){return UD}let UD=null;function i4e(n){UD=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let pA;function jZ(){if(pA==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");pA=n}return pA}function a4e(){const n=jZ();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function zD(n,e){const t=a4e();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const VD="Abs",HD="Acos",WD="Acosh",qT="Add",GD="AddN",jD="All",qD="Any",XD="ArgMax",KD="ArgMin",YD="Asin",ZD="Asinh",QD="Atan",JD="Atanh",eL="Atan2",tL="AvgPool",qZ="AvgPoolGrad",nL="AvgPool3D",XZ="AvgPool3DGrad",rL="BatchMatMul",iL="BatchToSpaceND",aL="Bincount",s4e="BroadcastTo",sL="BroadcastArgs",XT="Cast",oL="Ceil",lL="ClipByValue",uL="Complex",cL="ComplexAbs",fL="Concat",hL="Conv2D",dL="Conv2DBackpropFilter",pL="Conv2DBackpropInput",mL="Conv3D",KZ="Conv3DBackpropFilterV2",gL="Conv3DBackpropInputV2",vL="Cos",yL="Cosh",_L="Cumprod",xL="Cumsum",bL="CropAndResize",wL="DenseBincount",SL="DepthToSpace",TL="DepthwiseConv2dNative",CL="DepthwiseConv2dNativeBackpropFilter",EL="DepthwiseConv2dNativeBackpropInput",AL="Diag",ML="Dilation2D",o4e="Dilation2DBackpropInput",l4e="Dilation2DBackpropFilter",kL="RealDiv",RL="Einsum",PL="Elu",YZ="EluGrad",IL="Erf",DL="Equal",LL="Exp",NL="ExpandDims",OL="Expm1",$L="FFT",FL="Fill",BL="FlipLeftRight",UL="Floor",zL="FloorDiv",VL="FusedBatchNorm",HL="GatherV2",WL="GatherNd",GL="Greater",jL="GreaterEqual",KT="Identity",qL="IFFT",XL="Imag",KL="IsFinite",YL="IsInf",ZL="IsNan",QL="LeakyRelu",JL="Less",eN="LessEqual",tN="LinSpace",nN="Log",rN="Log1p",iN="LogicalAnd",aN="LogicalNot",sN="LogicalOr",u4e="LogicalXor",c4e="LogSoftmax",f4e="LowerBound",oN="LRN",ZZ="LRNGrad",lN="Max",uN="Maximum",cN="MaxPool",QZ="MaxPoolGrad",fN="MaxPool3D",JZ="MaxPool3DGrad",hN="MaxPoolWithArgmax",dN="Mean",pN="Min",mN="Minimum",gN="MirrorPad",vN="Mod",yN="Multinomial",_N="Multiply",xN="Neg",bN="NotEqual",wN="NonMaxSuppressionV3",SN="NonMaxSuppressionV4",TN="NonMaxSuppressionV5",CN="OnesLike",EN="OneHot",AN="Pack",MN="PadV2",h4e="Pool",kN="Pow",RN="Prelu",PN="Prod",IN="RaggedGather",DN="RaggedTensorToTensor",LN="Range",NN="Real",ON="Reciprocal",$N="Relu",FN="Reshape",BN="ResizeNearestNeighbor",eQ="ResizeNearestNeighborGrad",UN="ResizeBilinear",tQ="ResizeBilinearGrad",zN="Relu6",VN="Reverse",HN="Round",WN="Rsqrt",GN="ScatterNd",jN="SearchSorted",qN="Select",XN="Selu",KN="Slice",YN="Sin",ZN="Sinh",QN="Sign",JN="Sigmoid",eO="Softplus",tO="Sqrt",nO="Sum",rO="SpaceToBatchND",iO="SplitV",aO="Softmax",sO="SparseFillEmptyRows",oO="SparseReshape",lO="SparseSegmentMean",uO="SparseSegmentSum",cO="SparseToDense",fO="SquaredDifference",nQ="Square",hO="StridedSlice",dO="StringNGrams",pO="StringSplit",mO="StringToHashBucketFast",gO="Sub",vO="Tan",yO="Tanh",YT="Tile",_O="TopK",xO="Transform",s0="Transpose",bO="Unique",wO="Unpack",SO="UnsortedSegmentSum",d4e="UpperBound",TO="ZerosLike",CO="Step",uS="FromPixels",EO="RotateWithOffset",cS="_FusedMatMul",fS="FusedConv2D",hS="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(...n){We().getBool("IS_TEST")||We().getBool("PROD")||console.warn(...n)}function p4e(...n){We().getBool("IS_TEST")||We().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gg=zD("kernelRegistry",()=>new Map),t_=zD("gradRegistry",()=>new Map);function dS(n,e){const t=MO(n,e);return gg.get(t)}function rR(n){return t_.get(n)}function pS(n){const e=gg.entries(),t=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,s]=i,[o]=a.split("_");o===n&&t.push(s)}return t}function AO(n){const{kernelName:e,backendName:t}=n,r=MO(e,t);gg.has(r)&&no(`The kernel '${e}' for backend '${t}' is already registered`),gg.set(r,n)}function m4e(n){const{kernelName:e}=n;t_.has(e)&&We().getBool("DEBUG")&&no(`Overriding the gradient for '${e}'`),t_.set(e,n)}function g4e(n,e){const t=MO(n,e);if(!gg.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);gg.delete(t)}function v4e(n){if(!t_.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);t_.delete(n)}function y4e(n,e){pS(n).forEach(r=>{const i=Object.assign({},r,{backendName:e});AO(i)})}function MO(n,e){return`${e}_${n}`}var rQ=Gr,io=null;try{io=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Gr(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}Gr.prototype.__isLong__;Object.defineProperty(Gr.prototype,"__isLong__",{value:!0});function fs(n){return(n&&n.__isLong__)===!0}Gr.isLong=fs;var mH={},gH={};function jd(n,e){var t,r,i;return e?(n>>>=0,(i=0<=n&&n<256)&&(r=gH[n],r)?r:(t=jr(n,(n|0)<0?-1:0,!0),i&&(gH[n]=t),t)):(n|=0,(i=-128<=n&&n<128)&&(r=mH[n],r)?r:(t=jr(n,n<0?-1:0,!1),i&&(mH[n]=t),t))}Gr.fromInt=jd;function ao(n,e){if(isNaN(n))return e?Wh:so;if(e){if(n<0)return Wh;if(n>=iQ)return oQ}else{if(n<=-yH)return rs;if(n+1>=yH)return sQ}return n<0?ao(-n,e).neg():jr(n%vg|0,n/vg|0,e)}Gr.fromNumber=ao;function jr(n,e,t){return new Gr(n,e,t)}Gr.fromBits=jr;var mS=Math.pow;function kO(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return so;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return kO(n.substring(1),e,t).neg();for(var i=ao(mS(t,8)),a=so,s=0;s<n.length;s+=8){var o=Math.min(8,n.length-s),l=parseInt(n.substring(s,s+o),t);if(o<8){var u=ao(mS(t,o));a=a.mul(u).add(ao(l))}else a=a.mul(i),a=a.add(ao(l))}return a.unsigned=e,a}Gr.fromString=kO;function fl(n,e){return typeof n=="number"?ao(n,e):typeof n=="string"?kO(n,e):jr(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}Gr.fromValue=fl;var vH=65536,_4e=1<<24,vg=vH*vH,iQ=vg*vg,yH=iQ/2,_H=jd(_4e),so=jd(0);Gr.ZERO=so;var Wh=jd(0,!0);Gr.UZERO=Wh;var vm=jd(1);Gr.ONE=vm;var aQ=jd(1,!0);Gr.UONE=aQ;var iR=jd(-1);Gr.NEG_ONE=iR;var sQ=jr(-1,2147483647,!1);Gr.MAX_VALUE=sQ;var oQ=jr(-1,-1,!0);Gr.MAX_UNSIGNED_VALUE=oQ;var rs=jr(0,-2147483648,!1);Gr.MIN_VALUE=rs;var Tt=Gr.prototype;Tt.toInt=function(){return this.unsigned?this.low>>>0:this.low};Tt.toNumber=function(){return this.unsigned?(this.high>>>0)*vg+(this.low>>>0):this.high*vg+(this.low>>>0)};Tt.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(rs)){var t=ao(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var a=ao(mS(e,6),this.unsigned),s=this,o="";;){var l=s.div(a),u=s.sub(l.mul(a)).toInt()>>>0,c=u.toString(e);if(s=l,s.isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}};Tt.getHighBits=function(){return this.high};Tt.getHighBitsUnsigned=function(){return this.high>>>0};Tt.getLowBits=function(){return this.low};Tt.getLowBitsUnsigned=function(){return this.low>>>0};Tt.getNumBitsAbs=function(){if(this.isNegative())return this.eq(rs)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};Tt.isZero=function(){return this.high===0&&this.low===0};Tt.eqz=Tt.isZero;Tt.isNegative=function(){return!this.unsigned&&this.high<0};Tt.isPositive=function(){return this.unsigned||this.high>=0};Tt.isOdd=function(){return(this.low&1)===1};Tt.isEven=function(){return(this.low&1)===0};Tt.equals=function(e){return fs(e)||(e=fl(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Tt.eq=Tt.equals;Tt.notEquals=function(e){return!this.eq(e)};Tt.neq=Tt.notEquals;Tt.ne=Tt.notEquals;Tt.lessThan=function(e){return this.comp(e)<0};Tt.lt=Tt.lessThan;Tt.lessThanOrEqual=function(e){return this.comp(e)<=0};Tt.lte=Tt.lessThanOrEqual;Tt.le=Tt.lessThanOrEqual;Tt.greaterThan=function(e){return this.comp(e)>0};Tt.gt=Tt.greaterThan;Tt.greaterThanOrEqual=function(e){return this.comp(e)>=0};Tt.gte=Tt.greaterThanOrEqual;Tt.ge=Tt.greaterThanOrEqual;Tt.compare=function(e){if(fs(e)||(e=fl(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Tt.comp=Tt.compare;Tt.negate=function(){return!this.unsigned&&this.eq(rs)?rs:this.not().add(vm)};Tt.neg=Tt.negate;Tt.add=function(e){fs(e)||(e=fl(e));var t=this.high>>>16,r=this.high&65535,i=this.low>>>16,a=this.low&65535,s=e.high>>>16,o=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,f=0,h=0,d=0;return d+=a+u,h+=d>>>16,d&=65535,h+=i+l,f+=h>>>16,h&=65535,f+=r+o,c+=f>>>16,f&=65535,c+=t+s,c&=65535,jr(h<<16|d,c<<16|f,this.unsigned)};Tt.subtract=function(e){return fs(e)||(e=fl(e)),this.add(e.neg())};Tt.sub=Tt.subtract;Tt.multiply=function(e){if(this.isZero())return so;if(fs(e)||(e=fl(e)),io){var t=io.mul(this.low,this.high,e.low,e.high);return jr(t,io.get_high(),this.unsigned)}if(e.isZero())return so;if(this.eq(rs))return e.isOdd()?rs:so;if(e.eq(rs))return this.isOdd()?rs:so;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(_H)&&e.lt(_H))return ao(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,a=this.low>>>16,s=this.low&65535,o=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,f=0,h=0,d=0,p=0;return p+=s*c,d+=p>>>16,p&=65535,d+=a*c,h+=d>>>16,d&=65535,d+=s*u,h+=d>>>16,d&=65535,h+=i*c,f+=h>>>16,h&=65535,h+=a*u,f+=h>>>16,h&=65535,h+=s*l,f+=h>>>16,h&=65535,f+=r*c+i*u+a*l+s*o,f&=65535,jr(d<<16|p,f<<16|h,this.unsigned)};Tt.mul=Tt.multiply;Tt.divide=function(e){if(fs(e)||(e=fl(e)),e.isZero())throw Error("division by zero");if(io){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?io.div_u:io.div_s)(this.low,this.high,e.low,e.high);return jr(t,io.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Wh:so;var r,i,a;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Wh;if(e.gt(this.shru(1)))return aQ;a=Wh}else{if(this.eq(rs)){if(e.eq(vm)||e.eq(iR))return rs;if(e.eq(rs))return vm;var s=this.shr(1);return r=s.div(e).shl(1),r.eq(so)?e.isNegative()?vm:iR:(i=this.sub(e.mul(r)),a=r.add(i.div(e)),a)}else if(e.eq(rs))return this.unsigned?Wh:so;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=so}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),l=o<=48?1:mS(2,o-48),u=ao(r),c=u.mul(e);c.isNegative()||c.gt(i);)r-=l,u=ao(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=vm),a=a.add(u),i=i.sub(c)}return a};Tt.div=Tt.divide;Tt.modulo=function(e){if(fs(e)||(e=fl(e)),io){var t=(this.unsigned?io.rem_u:io.rem_s)(this.low,this.high,e.low,e.high);return jr(t,io.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Tt.mod=Tt.modulo;Tt.rem=Tt.modulo;Tt.not=function(){return jr(~this.low,~this.high,this.unsigned)};Tt.and=function(e){return fs(e)||(e=fl(e)),jr(this.low&e.low,this.high&e.high,this.unsigned)};Tt.or=function(e){return fs(e)||(e=fl(e)),jr(this.low|e.low,this.high|e.high,this.unsigned)};Tt.xor=function(e){return fs(e)||(e=fl(e)),jr(this.low^e.low,this.high^e.high,this.unsigned)};Tt.shiftLeft=function(e){return fs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?jr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):jr(0,this.low<<e-32,this.unsigned)};Tt.shl=Tt.shiftLeft;Tt.shiftRight=function(e){return fs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?jr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):jr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Tt.shr=Tt.shiftRight;Tt.shiftRightUnsigned=function(e){if(fs(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var r=this.low;return jr(r>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?jr(t,0,this.unsigned):jr(t>>>e-32,0,this.unsigned)};Tt.shru=Tt.shiftRightUnsigned;Tt.shr_u=Tt.shiftRightUnsigned;Tt.toSigned=function(){return this.unsigned?jr(this.low,this.high,!1):this};Tt.toUnsigned=function(){return this.unsigned?this:jr(this.low,this.high,!0)};Tt.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Tt.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Tt.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};Gr.fromBytes=function(e,t,r){return r?Gr.fromBytesLE(e,t):Gr.fromBytesBE(e,t)};Gr.fromBytesLE=function(e,t){return new Gr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};Gr.fromBytesBE=function(e,t){return new Gr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const lQ=b_(rQ),x4e=LW({__proto__:null,default:lQ},[rQ]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lh=lQ||x4e;function B_(n){return Lh.fromString(n,!0,16)}const uQ=B_("c3a5c85c97cb3127"),Mh=B_("b492b66fbe98f273"),fa=B_("9ae16a3b2f90404f");function aR(n){return n.xor(n.shru(47))}function cQ(n,e,t){const r=n.slice(e,e+t);return Lh.fromBytes(Array.from(r),!0,!0)}function Lr(n,e){return cQ(n,e,8)}function xH(n,e){return cQ(n,e,4)}function Ti(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function sf(n,e,t=B_("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let i=e.xor(r).mul(t);return i=i.xor(i.shru(47)),i=i.mul(t),i}function b4e(n,e,t,r,i,a){i=i.add(n),a=Ti(a.add(i).add(r),21);const s=i;return i=i.add(e),i=i.add(t),a=a.add(Ti(i,44)),[i.add(r),a.add(s)]}function t1(n,e,t,r){return b4e(Lr(n,e),Lr(n,e+8),Lr(n,e+16),Lr(n,e+24),t,r)}function w4e(n,e=n.length){if(e>=8){const t=fa.add(e*2),r=Lr(n,0).add(fa),i=Lr(n,e-8),a=Ti(i,37).mul(t).add(r),s=Ti(r,25).add(i).mul(t);return sf(a,s,t)}if(e>=4){const t=fa.add(e*2),r=xH(n,0);return sf(r.shl(3).add(e),xH(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],i=n[e-1],a=t+(r<<8),s=e+(i<<2);return aR(fa.mul(a).xor(uQ.mul(s))).mul(fa)}return fa}function S4e(n,e=n.length){const t=fa.add(e*2),r=Lr(n,0).mul(Mh),i=Lr(n,8),a=Lr(n,e-8).mul(t),s=Lr(n,e-16).mul(fa);return sf(Ti(r.add(i),43).add(Ti(a,30)).add(s),r.add(Ti(i.add(fa),18)).add(a),t)}function T4e(n,e=n.length){const t=fa.add(e*2),r=Lr(n,0).mul(fa),i=Lr(n,8),a=Lr(n,e-8).mul(t),s=Lr(n,e-16).mul(fa),o=Ti(r.add(i),43).add(Ti(a,30)).add(s),l=sf(o,r.add(Ti(i.add(fa),18)).add(a),t),u=Lr(n,16).mul(t),c=Lr(n,24),f=o.add(Lr(n,e-32)).mul(t),h=l.add(Lr(n,e-24)).mul(t);return sf(Ti(u.add(c),43).add(Ti(f,30)).add(h),u.add(Ti(c.add(r),18)).add(f),t)}function fQ(n,e=n.length){const t=Lh.fromNumber(81,!0);if(e<=32)return e<=16?w4e(n,e):S4e(n,e);if(e<=64)return T4e(n,e);let r=t,i=t.mul(Mh).add(113),a=aR(i.mul(fa).add(113)).mul(fa),s=[Lh.UZERO,Lh.UZERO],o=[Lh.UZERO,Lh.UZERO];r=r.mul(fa).add(Lr(n,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=Ti(r.add(i).add(s[0]).add(Lr(n,l+8)),37).mul(Mh),i=Ti(i.add(s[1]).add(Lr(n,l+48)),42).mul(Mh),r=r.xor(o[1]),i=i.add(s[0]).add(Lr(n,l+40)),a=Ti(a.add(o[0]),33).mul(Mh),s=t1(n,l,s[1].mul(Mh),r.add(o[0])),o=t1(n,l+32,a.add(o[1]),i.add(Lr(n,l+16))),[a,r]=[r,a],l+=64;while(l!==u);const f=Mh.add(a.and(255).shl(1));return l=c,o[0]=o[0].add(e-1&63),s[0]=s[0].add(o[0]),o[0]=o[0].add(s[0]),r=Ti(r.add(i).add(s[0]).add(Lr(n,l+8)),37).mul(f),i=Ti(i.add(s[1]).add(Lr(n,l+48)),42).mul(f),r=r.xor(o[1].mul(9)),i=i.add(s[0].mul(9).add(Lr(n,l+40))),a=Ti(a.add(o[0]),33).mul(f),s=t1(n,l,s[1].mul(f),r.add(o[0])),o=t1(n,l+32,a.add(o[1]),i.add(Lr(n,l+16))),[a,r]=[r,a],sf(sf(s[0],o[0],f).add(aR(i).mul(uQ)).add(a),sf(s[1],o[1],f).add(r),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(n,e){return e==="string"?zu(n):U_([n],e)}function C4e(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function U_(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Zu(n)),We().getBool("DEBUG")&&FZ(n,e),C4e(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Ks(){return We().platform.now()}function E4e(n,e){return We().platform.fetch(n,e)}function zu(n,e="utf-8"){return e=e||"utf-8",We().platform.encode(n,e)}function Cd(n,e="utf-8"){return e=e||"utf-8",We().platform.decode(n,e)}const A4e=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Jr,assert:le,assertNonNegativeIntegerDimensions:BD,assertNonNull:Gd,assertShapesMatch:Qi,bytesFromStringArray:zZ,bytesPerElement:sS,checkConversionForErrors:FZ,clamp:e_,computeStrides:Ai,createScalarValue:qd,createShuffledIndices:JBe,decodeString:Cd,distSquared:YBe,encodeString:zu,fetch:E4e,fingerPrint64:fQ,flatten:Zu,getArrayFromDType:ga,getTypedArrayFromDType:Xl,hasEncodingLoss:UZ,hexToLong:B_,indexToLoc:jT,inferDtype:F_,inferFromImplicitShape:$Z,isBoolean:VZ,isFunction:_f,isInt:Sd,isNumber:HZ,isPromise:Td,isScalarShape:ZBe,isString:$u,isTypedArray:Wi,isValidDtype:BZ,locToIndex:lS,makeOnesTypedArray:FD,makeZerosNestedTypedArray:e4e,makeZerosTypedArray:Qu,nearestDivisor:oS,nearestLargerEven:GT,now:Ks,parseAxisParam:_i,randUniform:KBe,repeatedTry:nR,rightPad:id,shuffle:NZ,shuffleCombo:XBe,sizeFromShape:yt,sizeToSquarishShape:aS,squeezeShape:ic,sum:OZ,swap:ku,tanh:QBe,toNestedArray:ad,toTypedArray:U_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M4e{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new R4e)}profileKernel(e,t,r){let i;const a=()=>{i=r()};let s;const o=Ks();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(a);else{a();for(const u of i)u.dataSync();s=Promise.resolve({kernelMs:Ks()-o})}if(We().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<i.length;u++){const c=i[u];c.data().then(f=>{k4e(f,c.dtype,e)})}return{kernelName:e,outputs:i,inputs:t,timeMs:s.then(u=>u.kernelMs),extraInfo:s.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:i,inputs:a,extraInfo:s}=e;r.forEach(o=>{Promise.all([o.data(),i,s]).then(l=>{this.logger.logKernelProfile(t,o,l[0],l[1],a,l[2])})})}}function k4e(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const i=n[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${t}'`),!0}return!1}class R4e{logKernelProfile(e,t,r,i,a,s){const o=typeof i=="number"?id(`${i}ms`,9):i.error,l=id(e,25),u=t.rank,c=t.size,f=id(t.shape.toString(),14);let h="";for(const d in a){const p=a[d];if(p!=null){const m=p.shape||t.shape,g=m.length;h+=`${d}: ${g}D ${g>0?m:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${f}	%c${c}	%c${h}	%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4e(n,e,t){const r={},i={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],c=u.inputs;for(const f in c){const h=c[f];let d=!1;for(let p=0;p<e.length;p++)if(r[h.id]){u.outputs.forEach(m=>r[m.id]=!0),d=!0,i[u.id]=!0;break}if(d)break}}const a={};a[t.id]=!0;const s={};for(let l=n.length-1;l>=0;l--){const u=n[l],c=u.inputs;for(let f=0;f<u.outputs.length;f++)if(a[u.outputs[f].id]){for(const h in c)a[c[h].id]=!0,s[u.id]=!0;break}}const o=[];for(let l=0;l<n.length;l++){const u=n[l];if(i[u.id]&&s[u.id]){const c={};for(const h in u.inputs){const d=u.inputs[h];r[d.id]&&(c[h]=d)}const f=Object.assign({},u);f.inputs=c,f.outputs=u.outputs,o.push(f)}}return o}function I4e(n,e,t,r){for(let i=e.length-1;i>=0;i--){const a=e[i],s=[];if(a.outputs.forEach(l=>{const u=n[l.id];u!=null?s.push(u):s.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(s);for(const l in a.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=t(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=a.inputs[l];if(!Jr(u.shape,c.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(n[c.id]==null)n[c.id]=u;else{const f=n[c.id];n[c.id]=r(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bH=20,sy=3,mA=7;function D4e(n,e,t,r){const i=Ai(e),a=L4e(n,e,t,i),s=e.length,o=iw(n,e,t,i,a),l=["Tensor"];return r&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${s}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function L4e(n,e,t,r){const i=yt(e),a=r[r.length-1],s=new Array(a).fill(0),o=e.length,l=t==="complex64"?Ey(n):n;if(o>1)for(let u=0;u<i/a;u++){const c=u*a;for(let f=0;f<a;f++)s[f]=Math.max(s[f],Cy(l[c+f],0,t).length)}return s}function Cy(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(mA))} + ${parseFloat(n[1].toFixed(mA))}j`:$u(n)?r=`'${n}'`:t==="bool"?r=hQ(n):r=parseFloat(n.toFixed(mA)).toString(),id(r,e)}function hQ(n){return n===0?"false":"true"}function iw(n,e,t,r,i,a=!0){const s=t==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(t==="complex64"){const m=Ey(n);return[Cy(m[0],0,t)]}return t==="bool"?[hQ(n[0])]:[n[0].toString()]}if(l===1){if(o>bH){const g=sy*s;let v=Array.from(n.slice(0,g)),_=Array.from(n.slice((o-sy)*s,o*s));return t==="complex64"&&(v=Ey(v),_=Ey(_)),["["+v.map((x,b)=>Cy(x,i[b],t)).join(", ")+", ..., "+_.map((x,b)=>Cy(x,i[o-sy+b],t)).join(", ")+"]"]}return["["+(t==="complex64"?Ey(n):Array.from(n)).map((g,v)=>Cy(g,i[v],t)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),f=r[0]*s,h=[];if(o>bH){for(let m=0;m<sy;m++){const g=m*f,v=g+f;h.push(...iw(n.slice(g,v),u,t,c,i,!1))}h.push("...");for(let m=o-sy;m<o;m++){const g=m*f,v=g+f;h.push(...iw(n.slice(g,v),u,t,c,i,m===o-1))}}else for(let m=0;m<o;m++){const g=m*f,v=g+f;h.push(...iw(n.slice(g,v),u,t,c,i,m===o-1))}const d=l===2?",":"";h[0]="["+h[0]+d;for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+d;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(a?"":p),h}function Ey(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yg{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=yt(e),r!=null){const i=r.length;le(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||ga(t,this.size),this.strides=Ai(e)}set(e,...t){t.length===0&&(t=[0]),le(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const i of e){if(i<0||i>=this.shape[t]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}t++}let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=this.strides[i]*e[i];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return zo().makeTensor(this.values,this.shape,this.dtype)}}let zo=null,sm=null;function N4e(n){zo=n}function O4e(n){sm=n}class dr{constructor(e,t,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=yt(e),this.strides=Ai(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return sm.buffer(this.shape,this.dtype,e)}bufferSync(){return sm.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ad(this.shape,e,this.dtype==="complex64")}arraySync(){return ad(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=zo().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>Cd(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),zo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=zo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>Cd(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await zo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(zo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return sm.print(this,e)}clone(){return this.throwIfDisposed(),sm.clone(this)}toString(e=!1){const t=this.dataSync();return D4e(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),sm.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),zo().makeVariable(this,e,t,r)}}Object.defineProperty(dr,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function $4e(){return zD("Tensor",()=>dr)}$4e();class n_ extends dr{constructor(e,t,r,i){super(e.shape,e.dtype,e.dataId,i),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Jr(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);zo().disposeTensor(this),this.dataId=e.dataId,zo().incRef(this,null)}dispose(){zo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(n_,Symbol.hasInstance,{value:n=>n instanceof dr&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var sR;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(sR||(sR={}));var oR;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(oR||(oR={}));var lR;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(lR||(lR={}));var uR;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(uR||(uR={}));var cR;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(cR||(cR={}));const F4e={float32:uR,int32:oR,bool:lR,complex64:cR};function nl(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return F4e[n][e]}function ZT(n){return nl(n,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ri(n,e){if(n.dtype===e.dtype)return[n,e];const t=nl(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function dQ(n,e){le(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function B4e(n,e){return e.some(t=>t.id===n.id)}function RO(n){const e=[];return pQ(n,e,new Set),e}function pQ(n,e,t){if(n==null)return;if(n instanceof dr){e.push(n);return}if(!U4e(n))return;const r=n;for(const i in r){const a=r[i];t.has(a)||(t.add(a),pQ(a,e,t))}}function U4e(n){return Array.isArray(n)||typeof n=="object"}const z4e=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:dQ,getTensorsInContainer:RO,isTensorInList:B4e,makeTypesMatch:ri},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(n){return n.kernelName!=null}class wH{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class _g{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new wH}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(no(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new M4e(this.backendInstance),!0}setupRegisteredKernels(){pS(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){pS(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof $D)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,a=r.then(s=>i<this.pendingBackendInitId?!1:(this.registry[e]=s,this.pendingBackendInit=null,!0)).catch(s=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,no(`Initialization of backend ${e} failed`),no(s.stack||s.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return no(`Initialization of backend ${e} failed`),no(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:i,asyncInit:a}=this.initializeBackend(r);if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),i=r.backend,a=this.readSync(t),s=i.refCount(t);i.disposeData(t,!0),r.backend=e,e.move(t,a,r.shape,r.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=t(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(e,t,r){e();try{const i=r();return t(),i}catch(i){throw t(),i}}nextTensorId(){return _g.nextTensorId++}nextVariableId(){return _g.nextVariableId++}clone(e){const t=Ce.runKernel(KT,{x:e}),r={x:e},i=s=>({x:()=>{const o="float32",l={x:s},u={dtype:o};return Ce.runKernel(XT,l,u)}}),a=[];return this.addTapeNode(this.state.activeScope.name,r,[t],i,a,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(dS(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const i=this.backend.numDataIds();let a=0;r.forEach(l=>{a+=l.dtype==="complex64"?3:1});const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-t-a-s;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const i=this.isTapeOn(),a=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=gA(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(gA(e)){const{kernelName:p,inputs:m,attrs:g}=e;this.backendName==null&&this.backend;const v=dS(p,this.backendName);le(v!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),o=()=>{const _=this.backend.numDataIds();l=v.kernelFunc({inputs:m,attrs:g,backend:this.backend});const x=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,_,x);const b=x.map(S=>S.rank!=null?S:this.makeTensorFromTensorInfo(S));if(i){const S=this.getTensorsForGradient(p,m,b);r=this.saveTensorsForBackwardMode(S)}return b}}else{const{forwardFunc:p}=e,m=g=>{i&&(r=g.map(v=>this.keep(this.clone(v))))};o=()=>{const g=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const v=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,g,v),v}}const{inputs:c,attrs:f}=e,h=gA(e)?null:e.backwardsFunc;let d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=o():(d=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),t=d.outputs)}),i&&this.addTapeNode(u,c,t,h,r,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:t.map(p=>p.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const i=rR(e);if(i!=null){const a=i.inputsToSave||[],s=i.outputsToSave||[];let o;i.saveAllInputs?(le(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(t).map(u=>t[u])):o=a.map(u=>t[u]);const l=r.filter((u,c)=>s[c]);return o.concat(l)}return[]}makeTensor(e,t,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let a=e;r==="string"&&$u(e[0])&&(a=e.map(l=>zu(l)));const s=i.write(a,t,r),o=new dr(t,r,s,this.nextTensorId());if(this.trackTensor(o,i),r==="string"){const l=this.state.tensorInfo.get(s),u=zZ(a);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(e,t,r,i){r=r||"float32";const a={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(a,i)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:i,dtype:a}=e,s=new dr(i,a,r,this.nextTensorId());return this.trackTensor(s,t),s}makeVariable(e,t=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.cast(i));const a=new n_(e,t,r,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*sS(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof n_||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*sS(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,i,a,s){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:a},l=rR(e);l!=null&&(i=l.gradFunc),i!=null&&(o.gradient=u=>(u=u.map((c,f)=>{if(c==null){const h=r[f],d=Qu(h.size,h.dtype);return this.makeTensor(d,h.shape,h.dtype)}return c}),i(u.length>1?u:u[0],a,s))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=RO(e),r=new Set(t.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const s=this.state.activeScope.track[a];!s.kept&&!r.has(s.id)&&s.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(a=>{!a.kept&&a.scopeId===i.id&&this.track(a)})}gradients(e,t,r,i=!1){if(le(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));le(a instanceof dr,()=>"The result y returned by f() must be a tensor.");const s=P4e(this.state.activeTape,t,a);if(!i&&s.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[a.id]=r??V4e(a.shape),I4e(o,s,u=>this.tidy(u),H4e);const l=t.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:a,grads:l}})}customGrad(e){return le(_f(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{le(t.every(o=>o instanceof dr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};t.forEach((o,l)=>{i[l]=o});const a=(o,l)=>(r=e(...t,l),le(r.value instanceof dr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),le(_f(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),s=(o,l)=>{const u=r.gradFunc(o,l),c=Array.isArray(u)?u:[u];le(c.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),le(c.every(h=>h instanceof dr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return c.forEach((h,d)=>{f[d]=()=>h}),f};return this.runKernelFunc({forwardFunc:a,backwardsFunc:s,inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Ks(),r=await this.backend.time(e);return r.wallMs=Ks()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new wH;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}_g.nextTensorId=0;_g.nextVariableId=0;function V4e(n){const e=FD(yt(n),"float32");return Ce.makeTensor(e,n,"float32")}function mQ(){const n=jZ();if(n._tfengine==null){const e=new GZ(n);n._tfengine=new _g(e)}return i4e(n._tfengine.ENV),N4e(()=>n._tfengine),n._tfengine}const Ce=mQ();function H4e(n,e){const t={a:n,b:e};return Ce.runKernel(qT,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4e(){return typeof navigator<"u"&&navigator!=null}let fR;function G4e(n){fR=n}function PO(n){if(fR!==void 0)return fR;if(n||W4e()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function IO(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const j4e=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:IO,isMobile:PO,mockIsMobile:G4e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ls=We();ls.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ls.registerFlag("IS_BROWSER",()=>IO());ls.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ls.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ls.registerFlag("PROD",()=>!1);ls.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ls.getBool("DEBUG"));ls.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ls.registerFlag("IS_TEST",()=>!1);ls.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);ls.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ls.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);ls.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ls.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kl(n,e){let t=n;if(Wi(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||Wi(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&We().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&gQ(n,r,[]),r}function gQ(n,e,t){if(t=t||[],!Array.isArray(n)&&!Wi(n)){le(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}le(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),le(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let i=0;i<n.length;++i)gQ(n[i],r,t.concat(i))}function SH(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function te(n,e,t,r="numeric"){if(n instanceof dr)return SH(r,n.dtype,e,t),n;let i=F_(n);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),SH(r,i,e,t),n==null||!Wi(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const a=Kl(n,i);!Wi(n)&&!Array.isArray(n)&&(n=[n]);const o=i!=="string"?U_(n,i):Zu(n,[],!0);return Ce.makeTensor(o,a,i)}function r_(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((a,s)=>te(a,`${e}[${s}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DO="__op";function Te(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+DO;const i=(...a)=>{Ce.startScope(t);try{const s=r(...a);return Td(s)&&console.error("Cannot return a Promise inside of tidy."),Ce.endScope(s),s}catch(s){throw Ce.endScope(null),s}};return Object.defineProperty(i,"name",{value:t,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4e(n,e){const t=te(n,"real","complex"),r=te(e,"imag","complex");Qi(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:t,imag:r};return Ce.runKernel(uL,i)}const Ju=Te({complex_:q4e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pf(n,e,t,r){if(r==null&&(r=F_(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Wi(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){BD(e);const i=yt(e),a=yt(t);le(i===a,()=>`Based on the provided shape, [${e}], the tensor should have ${i} values but has ${a}`);for(let s=0;s<t.length;++s){const o=t[s],l=s===t.length-1?o!==yt(e.slice(s)):!0;le(t[s]===e[s]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!Wi(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?U_(n,r):Zu(n,[],!0),Ce.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function go(n,e,t){const r=Kl(n,t);return Pf(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hR={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gS=4;async function X4e(n,e){const t=[],r=[],i=Array.isArray(n)?n.map(s=>s.name):Object.keys(n);for(let s=0;s<i.length;++s){const o=i[s],l=Array.isArray(n)?n[s].tensor:n[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async f=>{const h=await l.bytes(),d=h.reduce((g,v)=>g+v.length,0)+gS*h.length,p=new Uint8Array(d);let m=0;for(let g=0;g<h.length;g++){const v=h[g],_=new Uint8Array(new Uint32Array([v.length]).buffer);p.set(_,m),m+=gS,p.set(v,m),m+=v.length}f(p)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),t.push(u)}const a=await Promise.all(r);return{data:K4e(a),specs:t}}function vQ(n,e){const t={};let r,i=0;for(const a of e){const s=a.name,o=a.dtype,l=a.shape,u=yt(l);let c;if("quantization"in a){const f=a.quantization;if(f.dtype==="uint8"||f.dtype==="uint16"){if(!("min"in f&&"scale"in f))throw new Error(`Weight ${a.name} with quantization ${f.dtype} doesn't have corresponding metadata min and scale.`)}else if(f.dtype==="float16"){if(o!=="float32")throw new Error(`Weight ${a.name} is quantized with ${f.dtype} which only supports weights of type float32 not ${o}.`)}else throw new Error(`Weight ${a.name} has unknown quantization dtype ${f.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const h=hR[f.dtype],d=n.slice(i,i+u*h),p=f.dtype==="uint8"?new Uint8Array(d):new Uint16Array(d);if(o==="float32")if(f.dtype==="uint8"||f.dtype==="uint16"){c=new Float32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];c[m]=g*f.scale+f.min}}else if(f.dtype==="float16")r===void 0&&(r=t5e()),c=r(p);else throw new Error(`Unsupported quantization type ${f.dtype} for weight type float32.`);else if(o==="int32"){if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error(`Unsupported quantization type ${f.dtype} for weight type int32.`);c=new Int32Array(p.length);for(let m=0;m<p.length;m++){const g=p[m];c[m]=Math.round(g*f.scale+f.min)}}else throw new Error(`Unsupported dtype in weight '${s}': ${o}`);i+=u*h}else if(o==="string"){const f=yt(a.shape);c=[];for(let h=0;h<f;h++){const d=new Uint32Array(n.slice(i,i+gS))[0];i+=gS;const p=new Uint8Array(n.slice(i,i+d));c.push(p),i+=d}}else{const f=hR[o],h=n.slice(i,i+u*f);if(o==="float32")c=new Float32Array(h);else if(o==="int32")c=new Int32Array(h);else if(o==="bool")c=new Uint8Array(h);else if(o==="complex64"){c=new Float32Array(h);const d=new Float32Array(c.length/2),p=new Float32Array(c.length/2);for(let v=0;v<d.length;v++)d[v]=c[v*2],p[v]=c[v*2+1];const m=go(d,l,"float32"),g=go(p,l,"float32");t[s]=Ju(m,g),m.dispose(),g.dispose()}else throw new Error(`Unsupported dtype in weight '${s}': ${o}`);i+=u*f}o!=="complex64"&&(t[s]=go(c,l,o))}return t}function K4e(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(a=>{if(e+=a.byteLength,t.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const r=new Uint8Array(e);let i=0;return t.forEach(a=>{r.set(new Uint8Array(a.buffer),i),i+=a.byteLength}),r.buffer}const LO=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function TH(n){return LO?Buffer.byteLength(n):new Blob([n]).size}function Y4e(n){if(LO)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function Z4e(n){if(LO){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function NO(n){if(n.length===1)return n[0];let e=0;n.forEach(i=>{e+=i.byteLength});const t=new Uint8Array(e);let r=0;return n.forEach(i=>{t.set(new Uint8Array(i),r),r+=i.byteLength}),t.buffer}function CH(n){const e="/";for(n=n.trim();n.endsWith(e);)n=n.slice(0,n.length-1);const t=n.split(e);return t[t.length-1]}function yQ(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function _Q(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),r}async function OO(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),_Q(n,t,r)}function z_(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:TH(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:TH(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function xQ(n){const e=[];for(const t of n)e.push(...t.weights);return e}function Q4e(){const n=t=>{let r=t<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function J4e(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function e5e(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function t5e(){const n=Q4e(),e=J4e(),t=e5e();return r=>{const i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let s=0;s<r.length;s++){const o=r[s],l=n[t[o>>10]+(o&1023)]+e[o>>10];a[s]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ni{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ni.instance==null&&(ni.instance=new ni),ni.instance}static registerSaveRouter(e){ni.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ni.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ni.getHandlers(e,"save")}static getLoadHandlers(e,t){return ni.getHandlers(e,"load",t)}static getHandlers(e,t,r){const i=[];return(t==="load"?ni.getInstance().loadRouters:ni.getInstance().saveRouters).forEach(s=>{const o=s(e,r);o!==null&&i.push(o)}),i}}const n5e=n=>ni.registerSaveRouter(n),r5e=n=>ni.registerLoadRouter(n),i5e=n=>ni.getSaveHandlers(n),a5e=(n,e)=>ni.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dR="tensorflowjs",pR=1,Gh="models_store",Yc="model_info_store";function bQ(){if(!We().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function mR(n){const e=n.result;e.createObjectStore(Gh,{keyPath:"modelPath"}),e.createObjectStore(Yc,{keyPath:"modelPath"})}class Ed{constructor(e){if(this.indexedDB=bQ(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,i)=>{const a=this.indexedDB.open(dR,pR);a.onupgradeneeded=()=>mR(a),a.onsuccess=()=>{const s=a.result;if(t==null){const o=s.transaction(Gh,"readonly"),u=o.objectStore(Gh).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return s.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(s.close(),i(u.error)),o.oncomplete=()=>s.close()}else{const o=z_(t),l=s.transaction(Yc,"readwrite");let u=l.objectStore(Yc);const c=u.put({modelPath:this.modelPath,modelArtifactsInfo:o});let f;c.onsuccess=()=>{f=s.transaction(Gh,"readwrite");const d=f.objectStore(Gh).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:o});d.onsuccess=()=>r({modelArtifactsInfo:o}),d.onerror=p=>{u=l.objectStore(Yc);const m=u.delete(this.modelPath);m.onsuccess=()=>(s.close(),i(d.error)),m.onerror=g=>(s.close(),i(d.error))}},c.onerror=h=>(s.close(),i(c.error)),l.oncomplete=()=>{f==null?s.close():f.oncomplete=()=>s.close()}}},a.onerror=s=>i(a.error)})}}Ed.URL_SCHEME="indexeddb://";const wQ=n=>We().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ed.URL_SCHEME)?s5e(n.slice(Ed.URL_SCHEME.length)):null;ni.registerSaveRouter(wQ);ni.registerLoadRouter(wQ);function s5e(n){return new Ed(n)}function o5e(n){return n.startsWith(Ed.URL_SCHEME)?n.slice(Ed.URL_SCHEME.length):n}class l5e{constructor(){this.indexedDB=bQ()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(dR,pR);r.onupgradeneeded=()=>mR(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(Yc,"readonly"),o=a.objectStore(Yc).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},o.onerror=l=>(i.close(),t(o.error)),a.oncomplete=()=>i.close()},r.onerror=i=>t(r.error)})}async removeModel(e){return e=o5e(e),new Promise((t,r)=>{const i=this.indexedDB.open(dR,pR);i.onupgradeneeded=()=>mR(i),i.onsuccess=()=>{const a=i.result,s=a.transaction(Yc,"readwrite"),o=s.objectStore(Yc),l=o.get(e);let u;l.onsuccess=()=>{if(l.result==null)return a.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=o.delete(e),f=()=>{u=a.transaction(Gh,"readwrite");const d=u.objectStore(Gh).delete(e);d.onsuccess=()=>t(l.result.modelArtifactsInfo),d.onerror=p=>r(l.error)};c.onsuccess=f,c.onerror=h=>(f(),a.close(),r(l.error))}},l.onerror=c=>(a.close(),r(l.error)),s.oncomplete=()=>{u==null?a.close():u.oncomplete=()=>a.close()}},i.onerror=a=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ru="/",om="tensorflowjs_models",SQ="info",u5e="model_topology",c5e="weight_specs",f5e="weight_data",h5e="model_metadata";function TQ(n){return{info:[om,n,SQ].join(Ru),topology:[om,n,u5e].join(Ru),weightSpecs:[om,n,c5e].join(Ru),weightData:[om,n,f5e].join(Ru),modelMetadata:[om,n,h5e].join(Ru)}}function CQ(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function d5e(n){const e=n.split(Ru);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(Ru)}function p5e(n){return n.startsWith(Ad.URL_SCHEME)?n.slice(Ad.URL_SCHEME.length):n}class Ad{constructor(e){if(!We().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=TQ(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=z_(e);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Y4e(e.weightData));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:i}}catch{throw CQ(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=i;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const o=JSON.parse(a);t.format=o.format,t.generatedBy=o.generatedBy,t.convertedBy=o.convertedBy,o.signature!=null&&(t.signature=o.signature),o.userDefinedMetadata!=null&&(t.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(t.modelInitializer=o.modelInitializer),o.trainingConfig!=null&&(t.trainingConfig=o.trainingConfig)}const s=this.LS.getItem(this.keys.weightData);if(s==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Z4e(s),t}}Ad.URL_SCHEME="localstorage://";const EQ=n=>We().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ad.URL_SCHEME)?m5e(n.slice(Ad.URL_SCHEME.length)):null;ni.registerSaveRouter(EQ);ni.registerLoadRouter(EQ);function m5e(n){return new Ad(n)}class g5e{constructor(){le(We().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),le(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=om+Ru,r=Ru+SQ;for(let i=0;i<this.LS.length;++i){const a=this.LS.key(i);if(a.startsWith(t)&&a.endsWith(r)){const s=d5e(a);e[s]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=p5e(e);const t=TQ(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return CQ(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $m="://";class la{constructor(){this.managers={}}static getInstance(){return la.instance==null&&(la.instance=new la),la.instance}static registerManager(e,t){le(e!=null,()=>"scheme must not be undefined or null."),e.endsWith($m)&&(e=e.slice(0,e.indexOf($m))),le(e.length>0,()=>"scheme must not be an empty string.");const r=la.getInstance();le(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=la.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(la.getInstance().managers)}}function aw(n){if(n.indexOf($m)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${la.getSchemes().join(",")}`);return{scheme:n.split($m)[0],path:n.split($m)[1]}}async function AQ(n,e,t=!1){le(n!==e,()=>`Old path and new path are the same: '${n}'`);const r=ni.getLoadHandlers(n);le(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),le(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const i=r[0],a=ni.getSaveHandlers(e);le(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),le(a.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const s=a[0],o=aw(n).scheme,l=aw(n).path,u=o===aw(n).scheme,c=await i.load();t&&u&&await la.getManager(o).removeModel(l);const f=await s.save(c);return t&&!u&&await la.getManager(o).removeModel(l),f.modelArtifactsInfo}async function v5e(){const n=la.getSchemes(),e={};for(const t of n){const r=await la.getManager(t).listModels();for(const i in r){const a=t+$m+i;e[a]=r[i]}}return e}async function y5e(n){const e=aw(n);return la.getManager(e.scheme).removeModel(e.path)}async function _5e(n,e){return AQ(n,e,!1)}async function x5e(n,e){return AQ(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b5e{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!We().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(We().get("IS_BROWSER")){We().setPlatform("browser",new b5e);try{la.registerManager(Ad.URL_SCHEME,new g5e)}catch{}try{la.registerManager(Ed.URL_SCHEME,new l5e)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5e={importFetch:()=>require("node-fetch")};let vA;class S5e{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return We().global.fetch!=null?We().global.fetch(e,t):(vA==null&&(vA=w5e.importFetch()),vA(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}}We().get("IS_NODE")&&!We().get("IS_BROWSER")&&We().setPlatform("node",new S5e);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ei(n,e="float32",t){return e=e||"float32",BD(n),new yg(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5e(n,e){const t=te(n,"x","cast");if(!BZ(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},i={dtype:e};return Ce.runKernel(XT,r,i)}const or=Te({cast_:T5e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5e(n){const t={x:te(n,"x","clone","string_or_numeric")};return Ce.runKernel(KT,t)}const Vu=Te({clone_:C5e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */mQ();const E5e={buffer:ei,cast:or,clone:Vu,print:$O};O4e(E5e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5e="model",M5e=".json",k5e=".weights.bin";function EH(n){return new Promise(e=>setTimeout(e)).then(n)}class Md{constructor(e){if(!We().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Md.URL_SCHEME)&&(e=e.slice(Md.URL_SCHEME.length)),(e==null||e.length===0)&&(e=A5e),this.modelJsonFileName=e+M5e,this.weightDataFileName=e+k5e}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],i=yQ(e,r),a=window.URL.createObjectURL(new Blob([JSON.stringify(i)],{type:"application/json"})),s=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(s.download=this.modelJsonFileName,s.href=a,await EH(()=>s.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const o=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;o.download=this.weightDataFileName,o.href=t,await EH(()=>o.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:z_(e)}}}}Md.URL_SCHEME="downloads://";class R5e{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const r=new FileReader;r.onload=i=>{const a=JSON.parse(i.target.result),s=a.modelTopology;if(s==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:s});return}const l=OO(a,u=>this.loadWeights(u));e(l)},r.onerror=i=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const t=[],r=[];for(const s of e)t.push(...s.weights),r.push(...s.paths);const i=this.checkManifestAndWeightFiles(e),a=r.map(s=>this.loadWeightsFile(s,i[s]));return Promise.all(a).then(s=>[t,NO(s)])}loadWeightsFile(e,t){return new Promise((r,i)=>{const a=new FileReader;a.onload=s=>{const o=s.target.result;r(o)},a.onerror=s=>i(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],r=this.weightsFiles.map(a=>CH(a.name)),i={};for(const a of e)a.paths.forEach(s=>{const o=CH(s);if(t.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(t.push(o),r.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);i[s]=this.weightsFiles[r.indexOf(o)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const P5e=n=>We().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Md.URL_SCHEME)?I5e(n.slice(Md.URL_SCHEME.length)):null;ni.registerSaveRouter(P5e);function I5e(n="model"){return new Md(n)}function D5e(n){return new R5e(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(n,e,t,r){s(n),t=t??0,r=r??1,o(t,r);let i=0;const a=l=>(l.then(u=>{const c=t+ ++i/n.length*(r-t);return e(c),u}),l);function s(l){le(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){le(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),le(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),le(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(n.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MQ(n,e){e==null&&(e={});const t=e.fetchFunc==null?We().platform.fetch:e.fetchFunc,r=n.map(f=>t(f,e.requestInit,{isBinary:!0})),i=0,a=.5,o=(e.onProgress==null?await Promise.all(r):await AH(r,e.onProgress,i,a)).map(f=>f.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(o):await AH(o,e.onProgress,l,u)}async function L5e(n,e="",t,r){return kQ(s=>MQ(s,{requestInit:r}))(n,e,t)}function kQ(n){return async(e,t="",r)=>{const i=e.map(()=>!1),a={},s=r!=null?r.map(()=>!1):[],o=[];if(e.forEach((d,p)=>{let m=0;d.weights.forEach(g=>{const v="quantization"in g?g.quantization.dtype:g.dtype,_=hR[v]*yt(g.shape),x=()=>{i[p]=!0,a[p]==null&&(a[p]=[]),a[p].push({manifestEntry:g,groupOffset:m,sizeBytes:_})};r!=null?r.forEach((b,S)=>{b===g.name&&(x(),s[S]=!0)}):x(),o.push(g.name),m+=_})}),!s.every(d=>d)){const d=r.filter((p,m)=>!s[m]);throw new Error(`Could not find weights in manifest with names: ${d.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=i.reduce((d,p,m)=>(p&&d.push(m),d),[]),u=[];l.forEach(d=>{e[d].paths.forEach(p=>{const m=t+(t.endsWith("/")?"":"/")+p;u.push(m)})});const c=await n(u),f={};let h=0;return l.forEach(d=>{const p=e[d].paths.length;let m=0;for(let b=0;b<p;b++)m+=c[h+b].byteLength;const g=new ArrayBuffer(m),v=new Uint8Array(g);let _=0;for(let b=0;b<p;b++){const S=new Uint8Array(c[h+b]);v.set(S,_),_+=S.byteLength}a[d].forEach(b=>{const S=g.slice(b.groupOffset,b.groupOffset+b.sizeBytes),T=vQ(S,[b.manifestEntry]);for(const M in T)f[M]=T[M]}),h+=p}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5e="application/octet-stream",O5e="application/json";class FO{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(le(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=We().platform.fetch,le(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&le(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i=yQ(e,r);t.body.append("model.json",new Blob([JSON.stringify(i)],{type:O5e}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:N5e}),"model.weights.bin");const a=await this.fetch(this.path,t);if(a.ok)return{modelArtifactsInfo:z_(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let s=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?s+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":s+=" Please make sure the server is serving valid JSON for this request.",new Error(s)}const r=t.modelTopology,i=t.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return OO(t,a=>this.loadWeights(a))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=$5e(t),a=this.weightPathPrefix||r,s=xQ(e),o=[],l=[];for(const c of e)for(const f of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(f)):o.push(a+f+i);this.weightUrlConverter&&o.push(...await Promise.all(l));const u=await MQ(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[s,NO(u)]}}FO.URL_SCHEME_REGEX=/^https?:\/\//;function $5e(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),i=t>e?n.substring(t):"";return[r+"/",i]}function gR(n){return n.match(FO.URL_SCHEME_REGEX)!=null}const RQ=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>gR(r)):t=gR(n),t)return BO(n,e)}return null};ni.registerSaveRouter(RQ);ni.registerLoadRouter(RQ);function BO(n,e){return new FO(n,e)}function F5e(n,e){return BO(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yA{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class PQ{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class B5e{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function U5e(n,e,t,r){const i=arguments;return new B5e(IQ(...i))}function IQ(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new yA(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new yA({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new yA({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))}function z5e(n){return new PQ(n)}function V5e(n){return new PQ(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UO=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:D5e,browserHTTPRequest:F5e,concatenateArrayBuffers:NO,copyModel:_5e,decodeWeights:vQ,encodeWeights:X4e,fromMemory:U5e,fromMemorySync:IQ,getLoadHandlers:a5e,getModelArtifactsForJSON:OO,getModelArtifactsForJSONSync:_Q,getModelArtifactsInfoForJSON:z_,getSaveHandlers:i5e,getWeightSpecs:xQ,http:BO,isHTTPScheme:gR,listModels:v5e,loadWeights:L5e,moveModel:x5e,registerLoadRouter:r5e,registerSaveRouter:n5e,removeModel:y5e,weightsLoaderFactory:kQ,withSaveHandler:z5e,withSaveHandlerSync:V5e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H5e(n,e,t=!1,r=!1){let i=te(n,"a","matMul"),a=te(e,"b","matMul");[i,a]=ri(i,a);const s={a:i,b:a},o={transposeA:t,transposeB:r};return Ce.runKernel(rL,s,o)}const nr=Te({matMul_:H5e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5e(n,e,t=1,r=0,i="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const s={indices:te(n,"indices","oneHot","int32")},o={dtype:i,depth:e,onValue:t,offValue:r};return Ce.runKernel(EN,s,o)}const i_=Te({oneHot_:W5e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5e(){We().set("PROD",!0)}function j5e(){We().set("DEBUG",!0)}function q5e(){We().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function X5e(n){We().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function K5e(){Ce.disposeVariables()}function Cu(){return Ce}function Y5e(){return Ce.memory()}function Z5e(n){return Ce.profile(n)}function tn(n,e){return Ce.tidy(n,e)}function $a(n){RO(n).forEach(t=>t.dispose())}function Ol(n){return Ce.keep(n)}function Q5e(n){return Ce.time(n)}function J5e(n){return Ce.setBackend(n)}function eUe(){return Ce.ready()}function DQ(){return Ce.backendName}function tUe(n){Ce.removeBackend(n)}function nUe(n){return Ce.findBackend(n)}function rUe(n){return Ce.findBackendFactory(n)}function LQ(n,e,t=1){return Ce.registerBackend(n,e,t)}function NQ(){return Ce.backend}function iUe(n,e){We().setPlatform(n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aUe(n){const t={input:te(n,"input","imag")};return Ce.runKernel(XL,t)}const V_=Te({imag_:aUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sUe(n){const t={x:te(n,"x","neg")};return Ce.runKernel(xN,t)}const zl=Te({neg_:sUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oUe(n){const t={input:te(n,"input","real")};return Ce.runKernel(NN,t)}const xg=Te({real_:oUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lUe(n,e,t){const r=te(n,"x","transpose");if(e==null&&(e=r.shape.map((s,o)=>o).reverse()),le(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(s=>{le(s>=0&&s<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const i={x:r},a={perm:e};return r.dtype==="complex64"?tn(()=>{let s=xg(r),o=V_(r);return s=Ce.runKernel(s0,{x:s},a),o=Ce.runKernel(s0,{x:o},a),t&&(o=zl(o)),Ju(s,o)}):Ce.runKernel(s0,i,a)}const a_=Te({transpose_:lUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uUe(n,e,t){const r=te(n,"labels","confusionMatrix"),i=te(e,"predictions","confusionMatrix");le(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),le(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),le(i.rank===1,()=>`Expected the rank of predictions to be 1, but got ${i.rank}`),le(r.shape[0]===i.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`),le(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const a=i_(or(r,"int32"),t),s=i_(or(i,"int32"),t),o=a_(a),l=nr(o,s);return or(l,"int32")}const cUe=Te({confusionMatrix_:uUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fUe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:cUe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_(n,e){const t=n.length,r=[];for(let i=0;i<t;i++){const a=t-1-i,s=n[a]||1;(e[e.length-1-i]||1)>1&&s===1&&r.unshift(a)}return r}function zO(n,e){const t=[];for(let r=0;r<e.length;r++){const i=n[n.length-r-1],a=e.length-r-1,s=e[a];(i==null||i===1&&s>1)&&t.unshift(a)}return t}function Kn(n,e){const t=[],r=Math.max(n.length,e.length);for(let i=0;i<r;i++){let a=n[n.length-i-1];a==null&&(a=1);let s=e[e.length-i-1];if(s==null&&(s=1),a===1)t.unshift(s);else if(s===1)t.unshift(a);else if(a!==s){const o=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(o)}else t.unshift(a)}return t}const hUe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Kn,getBroadcastDims:s_,getReductionAxes:zO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VO(n,e,t){if(Gd(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Kl(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Pf(n,e,r,t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let bh;function OQ(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,r=!1,i=!1,a=!1,s=!1,o=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)a=!0;else if(n.getContext!=null)s=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(dS(uS,Ce.backendName)!=null){const p={pixels:n},m={numChannels:e};return Ce.runKernel(uS,p,m)}const[u,c]=i?[n.videoWidth,n.videoHeight]:[n.width,n.height];let f;if(s)f=n.getContext("2d").getImageData(0,0,u,c).data;else if(r||t)f=n.data;else if(a||i||o){if(bh==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")bh=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else bh=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});bh.canvas.width=u,bh.canvas.height=c,bh.drawImage(n,0,0,u,c),f=bh.getImageData(0,0,u,c).data}let h;if(e===4)h=new Int32Array(f);else{const p=u*c;h=new Int32Array(p*e);for(let m=0;m<p;m++)for(let g=0;g<e;++g)h[m*e+g]=f[m*4+g]}return VO(h,[c,u,e],"int32")}function dUe(n){return n!=null&&n.data instanceof Uint8Array}function pUe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function mUe(n){return n!=null&&n.width!==0&&n.height!==0}function gUe(n){return pUe()&&!(n instanceof ImageBitmap)&&mUe(n)&&!dUe(n)}async function vUe(n,e=3){let t=null;if(We().getBool("WRAP_TO_IMAGEBITMAP")&&gUe(n)){let r;try{r=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===n.width&&r.height===n.height?t=r:t=n}else t=n;return OQ(t,e)}async function QT(n,e){let t=te(n,"img","toPixels");if(!(n instanceof dr)){const u=t;t=or(u,"int32"),u.dispose()}if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const[r,i]=t.shape.slice(0,2),a=t.rank===2?1:t.shape[2];if(a>4||a===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${a}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`);const s=await t.data(),o=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let u=0;u<r*i;++u){const c=[0,0,0,255];for(let h=0;h<a;h++){const d=s[u*a+h];if(t.dtype==="float32"){if(d<0||d>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${d}.`)}else if(t.dtype==="int32"&&(d<0||d>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${d}.`);a===1?(c[0]=d*o,c[1]=d*o,c[2]=d*o):c[h]=d*o}const f=u*4;l[f+0]=Math.round(c[0]),l[f+1]=Math.round(c[1]),l[f+2]=Math.round(c[2]),l[f+3]=Math.round(c[3])}if(e!=null){e.width=i,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,i,r);u.putImageData(c,0,0)}return t!==n&&t.dispose(),l}const JT=Te({fromPixels_:OQ}),yUe=Object.freeze(Object.defineProperty({__proto__:null,fromPixels:JT,fromPixelsAsync:vUe,toPixels:QT},Symbol.toStringTag,{value:"Module"}));function HO(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(yt(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const i=e.shape,a=i[i.length-1];let s=1;for(let f=0;f<i.length-1;++f)s*=i[f];const o=n.shape,l=i.slice();l.pop();let u=1;for(let f=a;f<t;++f)u*=o[f],l.push(o[f]);const c=[...Ai(n.shape).map(f=>f/u),1].slice(0,a);return[l,s,u,c]}const _Ue=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:HO},Symbol.toStringTag,{value:"Module"}));function WO(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${i}.`;if(t.rank<i)throw new Error(a+` update.rank < ${i}. `);if(n.length<r+(t.rank-i))throw new Error(a+` Output shape length < ${r+(t.rank-i)}`);if(t.rank!==i+n.length-r)throw new Error(a+` update.rank != ${i+n.length-r}`);for(let s=0;s<i;++s)if(t.shape[s]!==e.shape[s])throw new Error(a+` updates.shape[${s}] (${t.shape[s]}) != indices.shape[${s}] (${e.shape[s]}).`);for(let s=0;s<t.rank-i;++s)if(t.shape[s+i]!==n[s+r])throw new Error(a+` updates.shape[${s+i}] (${t.shape[s+i]}) != shape[${s+i}] (${n[s+i]})`)}function GO(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}WO(t,e,n)}function eC(n,e,t){const r=e.shape.length,i=r>1?e.shape[r-1]:1,a=t.length;let s=1;for(let f=i;f<a;++f)s*=t[f];const o=i<1?1:i,l=yt(e.shape)/o,u=[...Ai(t.slice(0,i)),1],c=yt(t);return{sliceRank:i,numUpdates:l,sliceSize:s,strides:u,outputSize:c}}const xUe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:eC,validateInput:GO,validateUpdateShape:WO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vR=-2,bUe=-1;function $Q(n,e,t){const r=n.shape.length;le(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),le(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)le(e[i]+t[i]<=n.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${e[i]+t[i]}) would overflow input.shape[${i}] (${n.shape[i]})`)}function wUe(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function FQ(n,e,t){const r=[];for(let i=0;i<n.length;i++)r[i]=Math.ceil((e[i]-n[i])/t[i]);return r}function BQ(n,e,t,r){const i=[...n];for(let a=i.length;a<r.length;a++)i.push(1);for(let a=0;a<t;a++)a===0?i[e]=1:(i.splice(e,0,1),i.pop());return i}function UQ(n,e,t){return t<=n?t:t-(e-1)}function zQ(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function SUe(n,e,t,r,i,a,s,o,l){const u=n.length;let c=new Array(u),f=new Array(u),h=new Array(u);if(e.length&&t>0){const d=e[0],p=t+1;c=VQ(s,d,p,r,n),f=HQ(o,d,p,i,n),h=BQ(a,d,p,n)}else for(let d=0;d<u;d++)c[d]=GQ(s,r,a,n,d,l),f[d]=jQ(o,i,a,n,d,l),h[d]=WQ(a,d,l);return{begin:c,end:f,strides:h}}function VQ(n,e,t,r,i){const a=[...i],s=zQ(t,e);for(let o=0;o<a.length;o++)if(s.indexOf(o)>-1)a[o]=0;else{const l=UQ(e,t,o);let u=r[l];n&1<<l&&(u=0),a[o]=u}return a}function HQ(n,e,t,r,i){const a=[...i],s=zQ(t,e);for(let o=0;o<a.length;o++)if(s.indexOf(o)>-1)a[o]=Number.MAX_SAFE_INTEGER;else{const l=UQ(e,t,o);let u=r[l];n&1<<l&&(u=Number.MAX_SAFE_INTEGER),a[o]=u}for(let o=0;o<a.length;o++){const l=i[o];a[o]<0&&(a[o]+=l),a[o]=e_(0,a[o],i[o])}return a}function WQ(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function GQ(n,e,t,r,i,a){let s=e[i];const o=t[i]||1;(n&1<<i||a&1<<i||s==null)&&(o>0?s=Number.MIN_SAFE_INTEGER:s=Number.MAX_SAFE_INTEGER);const l=r[i];return s<0&&(s+=l),s=e_(0,s,l-1),s}function jQ(n,e,t,r,i,a){let s=e[i];const o=t[i]||1;(n&1<<i||a&1<<i||s==null)&&(o>0?s=Number.MAX_SAFE_INTEGER:s=Number.MIN_SAFE_INTEGER);const l=r[i];return s<0&&(s+=l),o>0?s=e_(0,s,l):s=e_(-1,s,l-1),s}function jO(n,e,t){let r=t.length;for(let i=0;i<t.length;i++)if(t[i]>1){r=i;break}for(let i=r+1;i<t.length;i++)if(e[i]>0||t[i]!==n[i])return!1;return!0}function qO(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function qQ(n,e,t){let r;const i=n.shape.length;typeof e=="number"?r=[e,...new Array(i-1).fill(0)]:e.length<i?r=e.concat(new Array(i-e.length).fill(0)):r=e.slice(),r.forEach(s=>{le(s!==-1,()=>"slice() does not support negative begin indexing.")});let a;return t==null?a=new Array(i).fill(-1):typeof t=="number"?a=[t,...new Array(i-1).fill(-1)]:t.length<i?a=t.concat(new Array(i-t.length).fill(-1)):a=t,a=a.map((s,o)=>s>=0?s:(le(s===-1,()=>`Negative size values should be exactly -1 but got ${s} for the slice() size at index ${o}.`),n.shape[o]-r[o])),[r,a]}function XQ(n,e,t,r,i,a,s,o,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,s!=null&&s&s-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let x=0;x<f.dims;x++)c&&1<<x&o&&f.numAddAxisAfterEllipsis++,1<<x&s&&(c=!0);c||(f.ellipsisMask|=1<<f.dims,f.dims++);const h={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};TUe(f,h);let d=!0,p=!0,m=!0;const g=[],v=[];for(let x=0;x<n.length;++x){if(h.strides[x]===0)throw Error(`strides[${x}] must be non-zero`);const b=!!(h.shrinkAxisMask&1<<x),S=n[x];if(S===-1){g.push(b?1:-1);continue}const T=[h.beginMask&1<<x,h.endMask&1<<x],M=[h.strides[x]>0?0:-1,h.strides[x]>0?S:S-1];if(b&&h.strides[x]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[x]===1;const C=!!(h.beginMask&1<<x&&h.endMask&1<<x);if(h.beginValid&&h.endValid){if(b){const N=h.begin[x]<0?S+h.begin[x]:h.begin[x];if(h.begin[x]=N,h.end[x]=h.begin[x]+1,N<0||N>=S)throw Error(`slice index ${h.begin[x]} of dimension ${x} out of bounds.`)}else h.begin[x]=MH(h.begin[x],0,h.strides[x],S,T,M),h.end[x]=MH(h.end[x],1,h.strides[x],S,T,M);const P=h.strides[x]===1&&h.begin[x]===0&&h.end[x]===S;d=d&&P,p=p&&(x===0&&h.strides[x]===1||P)}else d=d&&h.strides[x]===1&&C,p=p&&(x===0&&h.strides[x]===1||C);let k,R=!1;if(h.beginValid&&h.endValid?(k=h.end[x]-h.begin[x],R=!0):b?(k=1,R=!0):C&&S>=0&&(h.strides[x]<0?k=-S:k=S,R=!0),R){let P;k===0||k<0!=h.strides[x]<0?P=0:P=Math.trunc(k/h.strides[x])+(k%h.strides[x]!==0?1:0),g.push(P)}else g.push(-1)}for(let x=0;x<h.finalShapeGatherIndices.length;++x){const b=h.finalShapeGatherIndices[x];b>=0?v.push(g[b]):b===vR&&v.push(1)}return{finalShapeSparse:v.filter((x,b)=>h.finalShapeGatherIndices[b]!==vR),finalShape:v,isIdentity:d,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function TUe(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const i=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<i;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(vR),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(bUe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function MH(n,e,t,r,i,a){if(i[e])return t>0?a[e]:a[e+1&1];{const s=n<0?r+n:n;return s<a[0]?a[0]:s>a[1]?a[1]:s}}const KQ=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:$Q,computeFlatOffset:qO,computeOutShape:FQ,getNormalizedAxes:SUe,isSliceContinous:jO,maskToAxes:wUe,parseSliceParams:qQ,sliceInfo:XQ,startForAxis:GQ,startIndicesWithElidedDims:VQ,stopForAxis:jQ,stopIndicesWithElidedDims:HQ,stridesForAxis:WQ,stridesWithElidedDims:BQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YQ{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class Hc{constructor(){this.classNameMap={}}static getMap(){return Hc.instance==null&&(Hc.instance=new Hc),Hc.instance}static register(e){Hc.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function If(n){le(n.className!=null,()=>"Class being registered does not have the static className property defined."),le(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),le(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Hc.register(n)}const CUe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:YQ,SerializationMap:Hc,registerClass:If},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EUe=.001,ZQ=.1;function AUe(n,e,t){return t==null&&(t=XO()),yR(n,e,(r,i)=>KO(r,i,t))}function XO(){return Ce.backend.floatPrecision()===32?EUe:ZQ}function yR(n,e,t){let r=!0;if((Wi(n)||Wi(e))&&(r=!1),Wi(n)&&Wi(e)&&(r=!0),r){const s=n.constructor.name,o=e.constructor.name;if(s!==o)throw new Error(`Arrays are of different type. Actual: ${s}. Expected: ${o}`)}if(Array.isArray(n)&&Array.isArray(e)){const s=Kl(n),o=Kl(e);if(!Jr(s,o))throw new Error(`Arrays have different shapes. Actual: [${s}]. Expected: [${o}]`)}const i=Wi(n)?n:Zu(n),a=Wi(e)?e:Zu(e);if(i.length!==a.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${a.length}.
Actual:   ${i}.
Expected: ${a}.`);for(let s=0;s<a.length;++s){const o=i[s],l=a[s];if(!t(o,l))throw new Error(`Arrays differ: actual[${s}] = ${o}, expected[${s}] = ${l}.
Actual:   ${i}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function MUe(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function kUe(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return $u(n)||$u(n[0])||$u(e)||$u(e[0])?yR(n,t,(r,i)=>r==i):yR(n,e,(r,i)=>KO(r,i,0))}function RUe(n,e,t){if(t==null&&(t=XO()),!KO(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function KO(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function PUe(n,e,t){for(let r=0;r<n.length;r++)if(n[r]<e||n[r]>t)throw new Error(`Value out of range:${n[r]} low: ${e}, high: ${t}`)}function IUe(n,e){const t=new Float32Array(n),r=new Float32Array(e);if(t.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${t.length}`);for(let i=0;i<r.length;i++)if(t[i]!==r[i])throw new Error(`Expected ArrayBuffer value at ${i} to be ${r[i]} but got ${t[i]} instead`)}function QQ(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?QQ(t):n[e]=zu(t)}return n}function DUe(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",r=>t(e)),e.load()})}async function LUe(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const NUe=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:ZQ,createVideoElement:DUe,encodeStrings:QQ,expectArrayBuffersEqual:IUe,expectArraysClose:AUe,expectArraysEqual:kUe,expectNumbersClose:RUe,expectPromiseToFail:MUe,expectValuesInRange:PUe,play:LUe,testEpsilon:XO},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const OUe="3.21.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ue(n,e){let t=te(n,"a","add"),r=te(e,"b","add");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(qT,i)}const Jt=Te({add_:$Ue});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FUe(n,e){let t=te(n,"a","floorDiv"),r=te(e,"b","floorDiv");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(zL,i)}const YO=Te({floorDiv_:FUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BUe(n,e){let t=te(n,"a","div"),r=te(e,"b","div");if([t,r]=ri(t,r),t.dtype==="int32"&&r.dtype==="int32")return YO(t,r);const i={a:t,b:r},a={};return Ce.runKernel(kL,i,a)}const Pr=Te({div_:BUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UUe(n,e){let t=te(n,"a","mul"),r=te(e,"b","mul");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(_N,i)}const St=Te({mul_:UUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zUe(n){const e=te(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Ce.runKernel(cL,t)}else{const t={x:e};return Ce.runKernel(VD,t)}}const Ka=Te({abs_:zUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VUe(n){const t={x:te(n,"x","acos")};return Ce.runKernel(HD,t)}const JQ=Te({acos_:VUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HUe(n){const t={x:te(n,"x","acosh")};return Ce.runKernel(WD,t)}const eJ=Te({acosh_:HUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WUe(n){le(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),le(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((i,a)=>te(i,`tensors${a}`,"addN")),t=e[0];e.forEach(i=>{if(i.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(i=>{if(!Jr(i.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return Ce.runKernel(GD,r)}const tJ=Te({addN_:WUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GUe(n,e=null,t=!1){const i={x:te(n,"x","all","bool")},a={axis:e,keepDims:t};return Ce.runKernel(jD,i,a)}const nJ=Te({all_:GUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jUe(n,e=null,t=!1){const i={x:te(n,"x","any","bool")},a={axis:e,keepDims:t};return Ce.runKernel(qD,i,a)}const rJ=Te({any_:jUe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qUe(n,e=0){const r={x:te(n,"x","argMax")},i={axis:e};return Ce.runKernel(XD,r,i)}const ZO=Te({argMax_:qUe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XUe(n,e=0){const r={x:te(n,"x","argMin")},i={axis:e};return Ce.runKernel(KD,r,i)}const iJ=Te({argMin_:XUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KUe(n){const t={x:te(n,"x","asin")};return Ce.runKernel(YD,t)}const aJ=Te({asin_:KUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YUe(n){const t={x:te(n,"x","asinh")};return Ce.runKernel(ZD,t)}const sJ=Te({asinh_:YUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZUe(n){const t={x:te(n,"x","atan")};return Ce.runKernel(QD,t)}const oJ=Te({atan_:ZUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QUe(n,e){let t=te(n,"a","atan2"),r=te(e,"b","atan2");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(eL,i)}const lJ=Te({atan2_:QUe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JUe(n){const t={x:te(n,"x","atanh")};return Ce.runKernel(JD,t)}const uJ=Te({atanh_:JUe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cJ(n,e,t,r,i="NHWC",a){const s=n[3],o=[...e,s],l=Xg(i);return Ds(n,o,t,a,r,null,null,l)}function Xd(n,e,t,r,i,a,s="channelsLast"){const[o,l]=vS(e);let u;if(s==="channelsLast")u=[o,l,n[3],n[3]];else if(s==="channelsFirst")u=[o,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${s}`);return Ds(n,u,t,r,i,a,!1,s)}function H_(n,e,t,r,i,a,s="NDHWC"){const[o,l,u]=_R(e);let c,f;if(s==="NDHWC")f="channelsLast",c=[o,l,u,n[4],n[4]];else if(s==="NCDHW")f="channelsFirst",c=[o,l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${s}`);return W_(n,c,t,r,i,!1,f,a)}function Ds(n,e,t,r,i,a,s=!1,o="channelsLast"){let[l,u,c,f]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,f]=n;else if(o==="channelsFirst")[l,f,u,c]=n;else throw new Error(`Unknown dataFormat ${o}`);const[h,d,,p]=e,[m,g]=vS(t),[v,_]=vS(r),x=Fm(h,v),b=Fm(d,_),{padInfo:S,outHeight:T,outWidth:M}=nze(i,u,c,m,g,x,b,a,o),C=s?p*f:p;let k;return o==="channelsFirst"?k=[l,C,T,M]:o==="channelsLast"&&(k=[l,T,M,C]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:f,outHeight:T,outWidth:M,outChannels:C,padInfo:S,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:d,effectiveFilterHeight:x,effectiveFilterWidth:b,dilationHeight:v,dilationWidth:_,inShape:n,outShape:k,filterShape:e}}function W_(n,e,t,r,i,a=!1,s="channelsLast",o){let[l,u,c,f,h]=[-1,-1,-1,-1,-1];if(s==="channelsLast")[l,u,c,f,h]=n;else if(s==="channelsFirst")[l,h,u,c,f]=n;else throw new Error(`Unknown dataFormat ${s}`);const[d,p,m,,g]=e,[v,_,x]=_R(t),[b,S,T]=_R(r),M=Fm(d,b),C=Fm(p,S),k=Fm(m,T),{padInfo:R,outDepth:P,outHeight:N,outWidth:L}=rze(i,u,c,f,v,_,x,M,C,k,o),F=a?g*h:g;let O;return s==="channelsFirst"?O=[l,F,P,N,L]:s==="channelsLast"&&(O=[l,P,N,L,F]),{batchSize:l,dataFormat:s,inDepth:u,inHeight:c,inWidth:f,inChannels:h,outDepth:P,outHeight:N,outWidth:L,outChannels:F,padInfo:R,strideDepth:v,strideHeight:_,strideWidth:x,filterDepth:d,filterHeight:p,filterWidth:m,effectiveFilterDepth:M,effectiveFilterHeight:C,effectiveFilterWidth:k,dilationDepth:b,dilationHeight:S,dilationWidth:T,inShape:n,outShape:O,filterShape:e}}function eze(n,e,t,r,i){r==null&&(r=QO(n,e,t));const a=n[0],s=n[1],o=sd((a-e+2*r)/t+1,i),l=sd((s-e+2*r)/t+1,i);return[o,l]}function tze(n,e,t,r,i,a){i==null&&(i=QO(n,e,r));const s=n[0],o=n[1],l=n[2],u=sd((s-e+2*i)/r+1,a),c=sd((o-e+2*i)/r+1,a),f=sd((l-e+2*i)/r+1,a);return[u,c,f,t]}function QO(n,e,t,r=1){const i=Fm(e,r);return Math.floor((n[0]*(t-1)-t+i)/2)}function vS(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function _R(n){return typeof n=="number"?[n,n,n]:n}function Fm(n,e){return e<=1?n:n+(n-1)*(e-1)}function nze(n,e,t,r,i,a,s,o,l){let u,c,f;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const d=eze([e,t],a,r,n,o);c=d[0],f=d[1]}else if(n==="same"){c=Math.ceil(e/r),f=Math.ceil(t/i);const h=Math.max(0,(c-1)*r+a-e),d=Math.max(0,(f-1)*i+s-t),p=Math.floor(h/2),m=h-p,g=Math.floor(d/2),v=d-g;u={top:p,bottom:m,left:g,right:v,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-a+1)/r),f=Math.ceil((t-s+1)/i);else if(typeof n=="object"){const h=l==="channelsLast"?n[1][0]:n[2][0],d=l==="channelsLast"?n[1][1]:n[2][1],p=l==="channelsLast"?n[2][0]:n[3][0],m=l==="channelsLast"?n[2][1]:n[3][1];u={top:h,bottom:d,left:p,right:m,type:h===0&&d===0&&p===0&&m===0?"VALID":"EXPLICIT"},c=sd((e-a+h+d)/r+1,o),f=sd((t-s+p+m)/i+1,o)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:c,outWidth:f}}function rze(n,e,t,r,i,a,s,o,l,u,c){let f,h,d,p;if(typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const g=tze([e,t,r,1],o,1,i,n,c);h=g[0],d=g[1],p=g[2]}else if(n==="same"){h=Math.ceil(e/i),d=Math.ceil(t/a),p=Math.ceil(r/s);const m=(h-1)*i+o-e,g=(d-1)*a+l-t,v=(p-1)*s+u-r,_=Math.floor(m/2),x=m-_,b=Math.floor(g/2),S=g-b,T=Math.floor(v/2),M=v-T;f={top:b,bottom:S,left:T,right:M,front:_,back:x,type:"SAME"}}else if(n==="valid")f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-o+1)/i),d=Math.ceil((t-l+1)/a),p=Math.ceil((r-u+1)/s);else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}function sd(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function o_(n){const[e,t,r]=vS(n);return e===1&&t===1&&r===1}function hs(n,e){return o_(n)||o_(e)}function Xg(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function To(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")le(Sd(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(i=>{le(Sd(i),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${i}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ize(n,e){const r={x:te(n,"x","reshape","string_or_numeric")},i={shape:e};return Ce.runKernel(FN,r,i)}const nt=Te({reshape_:ize});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aze(n,e,t,r,i){const a=te(n,"x","avgPool","float32"),s=1;le(hs(t,s),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${s}'`);let o=a,l=!1;a.rank===3&&(l=!0,o=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),le(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),To("avgPool",r,i);const u={x:o},c={filterSize:e,strides:t,pad:r,dimRoundingMode:i};let f=Ce.runKernel(tL,u,c);return f=or(f,a.dtype),l?nt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const JO=Te({avgPool_:aze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sze(n,e,t,r,i,a="NDHWC"){const s=te(n,"x","avgPool3d","float32");let o=s,l=!1;s.rank===4&&(l=!0,o=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),le(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),le(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),To("avgPool3d",r,i);const u={x:o},c={filterSize:e,strides:t,pad:r,dimRoundingMode:i,dataFormat:a};let f=Ce.runKernel(nL,u,c);return f=or(f,o.dtype),l?nt(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const fJ=Te({avgPool3d_:sze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oze(n,e=0){le(n.length>=1,()=>"Pass at least one tensor to concat");const t=r_(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),t.length===1)return Vu(t[0]);const r=t,i={axis:e};return Ce.runKernel(fL,r,i)}const Zi=Te({concat_:oze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lze(n){const t={x:te(n,"x","sigmoid","float32")};return Ce.runKernel(JN,t)}const Vl=Te({sigmoid_:lze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uze(n,e,t){const r=te(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},a={begin:e,size:t};return Ce.runKernel(KN,i,a)}const Tr=Te({slice_:uze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cze(n){const t={x:te(n,"x","tanh","float32")};return Ce.runKernel(yO,t)}const yS=Te({tanh_:cze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fze(n,e,t,r,i,a){const s=te(n,"forgetBias","basicLSTMCell"),o=te(e,"lstmKernel","basicLSTMCell"),l=te(t,"lstmBias","basicLSTMCell"),u=te(r,"data","basicLSTMCell"),c=te(i,"c","basicLSTMCell"),f=te(a,"h","basicLSTMCell"),h=Zi([u,f],1),d=nr(h,o),p=Jt(d,l),m=p.shape[0],g=p.shape[1]/4,v=[m,g],_=Tr(p,[0,0],v),x=Tr(p,[0,g],v),b=Tr(p,[0,g*2],v),S=Tr(p,[0,g*3],v),T=Jt(St(Vl(_),yS(x)),St(c,Vl(Jt(s,b)))),M=St(yS(T),Vl(S));return[T,M]}const hJ=Te({basicLSTMCell_:fze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hze(n,e,t){const r=te(n,"x","batchToSpaceND"),i=e.reduce((o,l)=>o*l);le(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),le(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),le(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${i}`);const a={x:r},s={blockShape:e,crops:t};return Ce.runKernel(iL,a,s)}const e3=Te({batchToSpaceND_:hze});function dze(n){let e;return n.rank===0||n.rank===1?e=nt(n,[1,1,1,n.size]):n.rank===2?e=nt(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=nt(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pze(n,e,t,r,i,a){a==null&&(a=.001);const s=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let u;i!=null&&(u=te(i,"scale","batchNorm"));let c;r!=null&&(c=te(r,"offset","batchNorm")),le(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),le(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),le(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:dze(s),scale:u,offset:c,mean:o,variance:l},d={varianceEpsilon:a},p=Ce.runKernel(VL,h,d);return nt(p,s.shape)}const G_=Te({batchNorm_:pze});function mze(n,e,t,r,i,a){const s=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let u;i!=null&&(u=te(i,"scale","batchNorm"));let c;return r!=null&&(c=te(r,"offset","batchNorm")),le(s.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`),le(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),le(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&le(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&le(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),G_(s,o,l,c,u,a)}const dJ=Te({batchNorm2d_:mze});function gze(n,e,t,r,i,a){const s=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let u;i!=null&&(u=te(i,"scale","batchNorm"));let c;return r!=null&&(c=te(r,"offset","batchNorm")),le(s.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`),le(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),le(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&le(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&le(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),G_(s,o,l,c,u,a)}const pJ=Te({batchNorm3d_:gze});function vze(n,e,t,r,i,a){const s=te(n,"x","batchNorm"),o=te(e,"mean","batchNorm"),l=te(t,"variance","batchNorm");let u;i!=null&&(u=te(i,"scale","batchNorm"));let c;return r!=null&&(c=te(r,"offset","batchNorm")),le(s.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`),le(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),le(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&le(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&le(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),G_(s,o,l,c,u,a)}const mJ=Te({batchNorm4d_:vze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yze(n,e,t){const r=te(n,"x","bincount"),i=te(e,"weights","bincount");le(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),le(t>=0,()=>`size must be non-negative, but got ${t}.`),le(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const a={x:r,weights:i},s={size:t};return Ce.runKernel(aL,a,s)}const t3=Te({bincount_:yze});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ze(n,e){const t=te(n,"s0","broadcastArgs","int32"),r=te(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:t,s1:r};return Ce.runKernel(sL,i)}const gJ=Te({broadcastArgs_:_ze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xze(n,e){let t=te(n,"broadcastTo","x");const r=t.shape;if(e.some(u=>!(u>0)||u%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=nt(t,u)}const i=t.shape,a=Array.from(e);for(let u=e.length-1;u>=0;u--)if(i[u]===e[u])a[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(a.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Vu(t);const o={x:t},l={reps:a};return Ce.runKernel(YT,o,l)}const Bm=Te({broadcastTo_:xze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bze(n){const t={x:te(n,"x","ceil","float32")};return Ce.runKernel(oL,t)}const vJ=Te({ceil_:bze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kg(n,e,t){const r={shape:n,value:e,dtype:t};return Ce.runKernel(FL,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wze(n,e,t){const r=te(n,"x","clipByValue");if(le(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return Kg(r.shape,e,r.dtype);const i={x:r},a={clipValueMin:e,clipValueMax:t};return Ce.runKernel(lL,i,a)}const yJ=Te({clipByValue_:wze});function Sze(n){return Zi(n,0)}const _J=Te({concat1d_:Sze});function Tze(n,e){return Zi(n,e)}const xJ=Te({concat2d_:Tze});function Cze(n,e){return Zi(n,e)}const bJ=Te({concat3d_:Cze});function Eze(n,e){return Zi(n,e)}const wJ=Te({concat4d_:Eze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aze(n,e,t,r,i="NHWC",a=[1,1],s){const o=te(n,"x","conv2d","float32"),l=te(e,"filter","conv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),le(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),le(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),To("conv2d",r,s);const f=i==="NHWC"?u.shape[3]:u.shape[1];le(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),le(hs(t,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);const h={x:u,filter:l},d={strides:t,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},p=Ce.runKernel(hL,h,d);return c?nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const j_=Te({conv2d_:Aze});function Mze(n,e,t,r,i="NWC",a=1,s){const o=te(n,"x","conv1d"),l=te(e,"filter","conv1d");let u=o,c=!1;o.rank===2&&(c=!0,u=nt(o,[1,o.shape[0],o.shape[1]])),le(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),le(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),To("conv1d",r,s),le(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),le(hs(t,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${a}'`),le(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const f=nt(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=nt(u,[u.shape[0],1,u.shape[1],u.shape[2]]),g=j_(h,f,[1,t],r,"NHWC",[1,a],s);return c?nt(g,[g.shape[2],g.shape[3]]):nt(g,[g.shape[0],g.shape[2],g.shape[3]])}const SJ=Te({conv1d_:Mze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kze(n,e,t,r,i,a="NHWC",s){le(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,l=e,u=!1;e.rank===3&&(u=!0,l=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,n[0],n[1],n[2]]),le(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),le(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),le(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const c=a==="NHWC"?o[3]:o[1],f=a==="NHWC"?l.shape[3]:l.shape[1];le(c===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${t.shape[2]}.`),le(f===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[3]}.`),To("conv2dDerInput",i,s);const h={dy:l,filter:t},d={strides:r,pad:i,dataFormat:a,dimRoundingMode:s,inputShape:o},p=Ce.runKernel(pL,h,d);return u?nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const TJ=Te({conv2DBackpropInput_:kze});function Rze(n,e,t,r,i,a){const s=te(n,"x","conv2dTranspose"),o=te(e,"filter","conv2dTranspose");return TJ(t,s,o,r,i,"NHWC",a)}const CJ=Te({conv2dTranspose_:Rze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pze(n,e,t,r,i="NDHWC",a=[1,1,1]){const s=te(n,"x","conv3d"),o=te(e,"filter","conv3d");let l=s,u=!1;s.rank===4&&(u=!0,l=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),le(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),le(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),le(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),le(hs(t,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),le(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`);const c={x:l,filter:o},f={strides:t,pad:r,dataFormat:i,dilations:a},h=Ce.runKernel(mL,c,f);return u?nt(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const EJ=Te({conv3d_:Pze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ize(n,e,t,r,i){le(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,s=e,o=!1;e.rank===4&&(o=!0,s=nt(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,n[0],n[1],n[2],n[3]]);const l=a[4],u=s.shape[4];le(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),le(s.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${s.rank}`),le(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),le(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),le(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const c={dy:s,filter:t},f={pad:i,strides:r,inputShape:a},h=Ce.runKernel(gL,c,f);return o?nt(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const Dze=Te({conv3DBackpropInput_:Ize});function Lze(n,e,t,r,i){const a=te(n,"x","conv3dTranspose"),s=te(e,"filter","conv3dTranspose");return Dze(t,a,s,r,i)}const AJ=Te({conv3dTranspose_:Lze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nze(n){const t={x:te(n,"x","cos","float32")};return Ce.runKernel(vL,t)}const MJ=Te({cos_:Nze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oze(n){const t={x:te(n,"x","cosh","float32")};return Ce.runKernel(yL,t)}const kJ=Te({cosh_:Oze});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ze(n,e=0,t=!1,r=!1){const a={x:te(n,"x","cumprod")},s={axis:e,exclusive:t,reverse:r};return Ce.runKernel(_L,a,s)}const RJ=Te({cumprod_:$ze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fze(n,e=0,t=!1,r=!1){const a={x:te(n,"x","cumsum")},s={axis:e,exclusive:t,reverse:r};return Ce.runKernel(xL,a,s)}const PJ=Te({cumsum_:Fze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bze(n,e,t,r=!1){const i=te(n,"x","denseBincount"),a=te(e,"weights","denseBincount");le(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),le(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),le(t>=0,()=>`size must be non-negative, but got ${t}.`),le(a.size===i.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`);const s={x:i,weights:a},o={size:t,binaryOutput:r};return Ce.runKernel(wL,s,o)}const IJ=Te({denseBincount_:Bze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uze(n,e,t="NHWC"){const r=te(n,"x","depthToSpace","float32"),i=t==="NHWC"?r.shape[1]:r.shape[2],a=t==="NHWC"?r.shape[2]:r.shape[3],s=t==="NHWC"?r.shape[3]:r.shape[1];le(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),le(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e}  for depthToSpace with input shape
    ${r.shape}`),le(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${r.shape}`),le(s%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${s} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:e,dataFormat:t};return Ce.runKernel(SL,o,l)}const DJ=Te({depthToSpace_:Uze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zze(n,e,t,r,i="NHWC",a=[1,1],s){const o=te(n,"x","depthwiseConv2d","float32"),l=te(e,"filter","depthwiseConv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),le(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),le(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=i==="NHWC"?u.shape[3]:u.shape[1];le(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),To("depthwiseConv2d",r,s);const h={x:u,filter:l},d={strides:t,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},p=Ce.runKernel(TL,h,d);return c?nt(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const tC=Te({depthwiseConv2d_:zze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vze(n){const t={x:te(n,"x","diag")};return Ce.runKernel(AL,t)}const LJ=Te({diag_:Vze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hze(n,e,t,r,i=[1,1],a="NHWC"){const s=te(n,"x","dilation2d"),o=te(e,"filter","dilation2d");le(s.rank===3||s.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`),le(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),le(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let l=s,u=!1;s.rank===3&&(l=nt(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0);const c={x:l,filter:o},f={strides:t,pad:r,dilations:i},h=Ce.runKernel(ML,c,f);return u?nt(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const NJ=Te({dilation2d_:Hze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wze(n,e){let t=te(n,"a","equal","string_or_numeric"),r=te(e,"b","equal","string_or_numeric");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(DL,i)}const q_=Te({equal_:Wze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gze(n,e,t){const r=te(e,"a","where"),i=te(t,"b","where"),a=te(n,"condition","where","bool"),s=Kn(Kn(a.shape,r.shape),i.shape),o=Bm(a,s),l=Bm(r,s),u=Bm(i,s),c={condition:o,t:l,e:u};return Ce.runKernel(qN,c)}const kd=Te({where_:Gze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jze(n){const t={x:te(n,"x","zerosLike")};return Ce.runKernel(TO,t)}const ss=Te({zerosLike_:jze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qze(n,e){let t=te(n,"a","div"),r=te(e,"b","div");[t,r]=ri(t,r);const i=Pr(t,r),a=ss(i),s=q_(r,a);return kd(s,a,i)}const OJ=Te({divNoNan_:qze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xze(n,e){const t=te(n,"t1","dot"),r=te(e,"t2","dot");le((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const i=t.rank===1?t.size:t.shape[1],a=r.rank===1?r.size:r.shape[0];if(le(i===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`),t.rank===1&&r.rank===1){const s=nt(t,[1,-1]),o=nt(r,[-1,1]),l=nr(s,o);return nt(l,[])}else if(t.rank===1&&r.rank===2){const s=nt(t,[1,-1]),o=nt(r,[r.shape[0],r.shape[1]]),l=nr(s,o);return nt(l,[l.size])}else if(t.rank===2&&r.rank===1){const s=nt(r,[-1,1]),o=nr(t,s);return nt(o,[o.size])}else{const s=nt(r,[r.shape[0],r.shape[1]]);return nr(t,s)}}const $J=Te({dot_:Xze});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kze(n,...e){const t=e.map((i,a)=>te(i,`tensors${a}`,"einsum")),r={equation:n};return Ce.runKernel(RL,t,r)}const FJ=Te({einsum_:Kze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yze(n){const t={x:te(n,"x","elu","float32")};return Ce.runKernel(PL,t)}const n3=Te({elu_:Yze});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zze(n){let e=te(n,"x","erf");le(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=or(e,"float32"));const t={x:e};return Ce.runKernel(IL,t)}const BJ=Te({erf_:Zze});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function UJ(n,e,t){const r=n.length+e.length,i=[];let a=0,s=0;for(let o=0;o<r;o++)t.indexOf(o)===-1?i.push(n[a++]):i.push(e[s++]);return i}function ru(n,e){const t=[],r=n.length;for(let a=0;a<r;a++)e.indexOf(a)===-1&&t.push(n[a]);const i=e.map(a=>n[a]);return[t,i]}function Ls(n,e){const t=e.map(r=>1);return UJ(n,t,e)}function hl(n,e,t){le(r3(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function Co(n,e){if(r3(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function i3(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Eo(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qze(n,e=null,t=!1){const i={x:te(n,"x","max")},a={reductionIndices:e,keepDims:t};return Ce.runKernel(lN,i,a)}const od=Te({max_:Qze});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jze(n,e=null,t=!1){const i={x:te(n,"x","min")},a={axis:e,keepDims:t};return Ce.runKernel(pN,i,a)}const _S=Te({min_:Jze});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eVe(n,e){let t=te(n,"base","pow"),r=te(e,"exp","pow");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(kN,i)}const bg=Te({pow_:eVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xn(n,e){if((Wi(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Wi(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Pf(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tVe(n){const t={x:te(n,"x","sqrt","float32")};return Ce.runKernel(tO,t)}const Yl=Te({sqrt_:tVe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nVe(n){const e=te(n,"x","square"),t={};return Ce.runKernel("Square",{x:e},t)}const vo=Te({square_:nVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rVe(n,e=null,t=!1){let r=te(n,"x","sum");r.dtype==="bool"&&(r=or(r,"int32"));const i={x:r},a={axis:e,keepDims:t};return Ce.runKernel(nO,i,a)}const Or=Te({sum_:rVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iVe(n,e="euclidean",t=null,r=!1){n=te(n,"x","norm");const i=zJ(n,e,t);let a=i.shape;if(r){const s=_i(t,n.shape);a=Ls(i.shape,s)}return nt(i,a)}function zJ(n,e,t=null){if(n.rank===0)return Ka(n);if(n.rank!==1&&t===null)return zJ(nt(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Or(Ka(n),t);if(e===1/0)return od(Ka(n),t);if(e===-1/0)return _S(Ka(n),t);if(e==="euclidean"||e===2)return Yl(Or(bg(Ka(n),xn(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return od(Or(Ka(n),t[0]),t[1]-1);if(e===1/0)return od(Or(Ka(n),t[1]),t[0]);if(e===-1/0)return _S(Or(Ka(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Yl(Or(vo(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const X_=Te({norm_:iVe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aVe(n,e=null,t=!1){return X_(n,"euclidean",e,t)}const VJ=Te({euclideanNorm_:aVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sVe(n){const t={x:te(n,"x","exp")};return Ce.runKernel(LL,t)}const xf=Te({exp_:sVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oVe(n,e=0){const t=te(n,"x","expandDims","string_or_numeric");le(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},i={dim:e};return Ce.runKernel(NL,r,i)}const es=Te({expandDims_:oVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lVe(n){const t={x:te(n,"x","expm1")};return Ce.runKernel(OL,t)}const HJ=Te({expm1_:lVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uVe(n,e){const t=te(n,"x","tile","string_or_numeric");le(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},i={reps:e};return Ce.runKernel(YT,r,i)}const Um=Te({tile_:uVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cVe(n,e,t,r="float32"){e==null&&(e=n);const i=ei([n,e],r),a=n<=e?n:e;for(let o=0;o<a;++o)i.set(1,o,o);const s=nt(i.toTensor(),[n,e]);if(t==null)return s;if(t.length===1)return Um(es(s,0),[t[0],1,1]);if(t.length===2)return Um(es(es(s,0),0),[t[0],t[1],1,1]);if(t.length===3)return Um(es(es(es(s,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const a3=Te({eye_:cVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fVe(n){const t={x:te(n,"x","floor","float32")};return Ce.runKernel(UL,t)}const s3=Te({floor_:fVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hVe(n,e,t=0,r=0){const i=te(n,"x","gather"),a=te(e,"indices","gather","int32"),s={x:i,indices:a},o={axis:t,batchDims:r};return Ce.runKernel(HL,s,o)}const o3=Te({gather_:hVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dVe(n,e){let t=te(n,"a","greater","string_or_numeric"),r=te(e,"b","greater","string_or_numeric");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(GL,i)}const Yg=Te({greater_:dVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pVe(n,e){let t=te(n,"a","greaterEqual","string_or_numeric"),r=te(e,"b","greaterEqual","string_or_numeric");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(jL,i)}const l3=Te({greaterEqual_:pVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mVe(n){const t={x:te(n,"x","isFinite")};return Ce.runKernel(KL,t)}const WJ=Te({isFinite_:mVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gVe(n){const t={x:te(n,"x","isInf")};return Ce.runKernel(YL,t)}const GJ=Te({isInf_:gVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vVe(n){const t={x:te(n,"x","isNaN")};return Ce.runKernel(ZL,t)}const jJ=Te({isNaN_:vVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yVe(n,e=.2){const r={x:te(n,"x","leakyRelu")},i={alpha:e};return Ce.runKernel(QL,r,i)}const u3=Te({leakyRelu_:yVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ve(n,e){let t=te(n,"a","less","string_or_numeric"),r=te(e,"b","less","string_or_numeric");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(JL,i)}const qJ=Te({less_:_Ve});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xVe(n,e){let t=te(n,"a","lessEqual","string_or_numeric"),r=te(e,"b","lessEqual","string_or_numeric");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(eN,i)}const nC=Te({lessEqual_:xVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const r={start:n,stop:e,num:t};return Ce.runKernel(tN,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bVe(n,e=5,t=1,r=1,i=.5){const a=te(n,"x","localResponseNormalization");le(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),le(Sd(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let s=a,o=!1;a.rank===3&&(o=!0,s=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:s},u={depthRadius:e,bias:t,alpha:r,beta:i},c=Ce.runKernel(oN,l,u);return o?nt(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const KJ=Te({localResponseNormalization_:bVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wVe(n){const t={x:te(n,"x","log","float32")};return Ce.runKernel(nN,t)}const wg=Te({log_:wVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SVe(n){const t={x:te(n,"x","log1p")};return Ce.runKernel(rN,t)}const c3=Te({log1p_:SVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TVe(n){return le(_f(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const r=te(e,"x","tf.grad","string_or_numeric"),i=t!=null?te(t,"dy","tf.grad"):null;return Ce.tidy(()=>{const{value:a,grads:s}=Ce.gradients(()=>n(r),[r],i);return i!=null&&Qi(a.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),rC(s),s[0]})}}function CVe(n){return le(_f(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{le(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=r_(e,"args","tf.grads","string_or_numeric"),i=t!=null?te(t,"dy","tf.grads"):null;return Ce.tidy(()=>{const{value:a,grads:s}=Ce.gradients(()=>n(...r),r,i);return i!=null&&Qi(a.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),rC(s),s})}}function EVe(n){return le(_f(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{le(e instanceof dr,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),le(t==null||t instanceof dr,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:i}=Ce.gradients(()=>n(e),[e],t);return rC(r),{grad:r[0],value:i}}}function AVe(n){return le(_f(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{le(Array.isArray(e)&&e.every(i=>i instanceof dr),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),le(t==null||t instanceof dr,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=Ce.gradients(()=>n(...e),e,t);return t!=null&&Qi(r.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),rC(r.grads),r}}function YJ(n,e){le(_f(n),()=>"The f passed in variableGrads(f) must be a function"),le(e==null||Array.isArray(e)&&e.every(u=>u instanceof n_),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in Ce.registeredVariables)e.push(Ce.registeredVariables[u])}const r=t?e.filter(u=>!u.trainable):null,i=e.length;e=e.filter(u=>u.trainable),le(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const a=!0,{value:s,grads:o}=Ce.gradients(n,e,null,a);le(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),le(s.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${s.rank} tensor`);const l={};return e.forEach((u,c)=>{o[c]!=null&&(l[u.name]=o[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:s,grads:l}}function Zl(n){return Ce.customGrad(n)}function rC(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MVe(n){const t={x:te(n,"x","softplus")};return Ce.runKernel(eO,t)}const f3=Te({softplus_:MVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kVe(n){const e=te(n,"x","logSigmoid");return Zl(r=>({value:zl(f3(zl(r))),gradFunc:s=>St(s,Vl(zl(r)))}))(e)}const ZJ=Te({logSigmoid_:kVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RVe(n,e){let t=te(n,"a","sub"),r=te(e,"b","sub");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(gO,i)}const bn=Te({sub_:RVe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PVe(n,e=-1){const t=te(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Zl((i,a)=>{const o=od(i,e,!0),l=bn(i,o),u=bn(or(l,"float32"),wg(Or(xf(l),e,!0)));return a([u]),{value:u,gradFunc:(f,h)=>{const[d]=h,p=!0,m=xf(d);return bn(f,St(Or(f,e,p),m))}}})(t)}const QJ=Te({logSoftmax_:PVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IVe(n,e=null,t=!1){const r=te(n,"x","logSumExp"),i=_i(e,r.shape),a=od(r,i,!0),s=bn(r,a),o=xf(s),l=Or(o,i),u=wg(l),c=Jt(nt(a,u.shape),u);if(t){const f=Ls(c.shape,i);return nt(c,f)}return c}const h3=Te({logSumExp_:IVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DVe(n,e){const t=te(n,"a","logicalAnd","bool"),r=te(e,"b","logicalAnd","bool");Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(iN,i)}const l_=Te({logicalAnd_:DVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LVe(n){const t={x:te(n,"x","logicalNot","bool")};return Ce.runKernel(aN,t)}const d3=Te({logicalNot_:LVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NVe(n,e){const t=te(n,"a","logicalOr","bool"),r=te(e,"b","logicalOr","bool");Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(sN,i)}const p3=Te({logicalOr_:NVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OVe(n,e){const t=te(n,"a","logicalXor","bool"),r=te(e,"b","logicalXor","bool");return Kn(t.shape,r.shape),l_(p3(n,e),d3(l_(n,e)))}const JJ=Te({logicalXor_:OVe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n1=2147483648;function $Ve(n,e,t="left"){const r=te(n,"sortedSequence","searchSorted"),i=te(e,"values","searchSorted"),a=r.shape[r.shape.length-1],s=i.shape[i.shape.length-1],o=nt(r,[-1,a]),l=nt(i,[-1,s]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(yt(l.shape)>=n1)throw new Error(`values tensor size must less than ${n1}`);if(o.shape[1]>=n1)throw new Error(`trailing dim_size must less than ${n1} for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},c={side:t};return Ce.runKernel(jN,u,c)}const iC=Te({searchSorted_:$Ve});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eee(n,e){return iC(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FVe(n,e,t,r,i){const a=te(n,"x","maxPool"),s=1;let o=a,l=!1;a.rank===3&&(l=!0,o=nt(a,[1,a.shape[0],a.shape[1],a.shape[2]])),le(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),le(hs(t,s),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${s}'`),To("maxPool",r,i);const u={x:o},c={filterSize:e,strides:t,pad:r,dimRoundingMode:i},f=Ce.runKernel(cN,u,c);return l?nt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const m3=Te({maxPool_:FVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BVe(n,e=[1,1,1],t,r,i,a="NDHWC"){const s=te(n,"x","maxPool3d");let o=s,l=!1;s.rank===4&&(l=!0,o=nt(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),le(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),le(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),To("maxPool3d",r,i);const u={x:o},c={filterSize:e,strides:t,pad:r,dimRoundingMode:i,dataFormat:a},f=Ce.runKernel(fN,u,c);return l?nt(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const tee=Te({maxPool3d_:BVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UVe(n,e,t,r,i=!1){const s={x:te(n,"x","maxPoolWithArgmax")},o={filterSize:e,strides:t,pad:r,includeBatchInIndex:i},l=Ce.runKernel(hN,s,o);return{result:l[0],indexes:l[1]}}const nee=Te({maxPoolWithArgmax_:UVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zVe(n,e){let t=te(n,"a","maximum"),r=te(e,"b","maximum");[t,r]=ri(t,r),t.dtype==="bool"&&(t=or(t,"int32"),r=or(r,"int32")),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(uN,i)}const g3=Te({maximum_:zVe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VVe(n,e=null,t=!1){const i={x:te(n,"x","mean")},a={axis:e,keepDims:t};return Ce.runKernel(dN,i,a)}const u_=Te({mean_:VVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bf(n,e="float32"){if(e==="complex64"){const r=bf(n,"float32"),i=bf(n,"float32");return Ju(r,i)}const t=Qu(yt(n),e);return Ce.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zc(n,e="float32"){if(e==="complex64"){const r=Zc(n,"float32"),i=bf(n,"float32");return Ju(r,i)}const t=FD(yt(n),e);return Ce.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let r=te(n,"x","meshgrid",n instanceof dr?n.dtype:"float32");if(e===void 0)return[r];let i=te(e,"y","meshgrid",e instanceof dr?e.dtype:"float32");const a=yt(r.shape),s=yt(i.shape);return t==="xy"?(r=nt(r,[1,-1]),i=nt(i,[-1,1]),[nr(Zc([s,1],r.dtype),r),nr(i,Zc([1,a],i.dtype))]):(r=nt(r,[-1,1]),i=nt(i,[1,-1]),[nr(r,Zc([1,s],r.dtype)),nr(Zc([a,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HVe(n,e){let t=te(n,"a","minimum"),r=te(e,"b","minimum");[t,r]=ri(t,r),t.dtype==="bool"&&(t=or(t,"int32"),r=or(r,"int32")),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(mN,i)}const v3=Te({minimum_:HVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WVe(n,e,t){le(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=te(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");le(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const i=t==="reflect"?1:0;for(let o=0;o<r.rank;o++)le(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),le(e[o][0]>=0&&e[o][0]<=r.shape[o]-i&&e[o][1]>=0&&e[o][1]<=r.shape[o]-i,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-i} or less than 0 for input of shape ${r.shape}`);const a={paddings:e,mode:t},s={x:r};return Ce.runKernel(gN,s,a)}const y3=Te({mirrorPad_:WVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GVe(n,e){let t=te(n,"a","mod"),r=te(e,"b","mod");[t,r]=ri(t,r);const i={a:t,b:r};return Ce.runKernel(vN,i)}const iee=Te({mod_:GVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jVe(n,e=null,t=!1){n=te(n,"x","moments");const r=_i(e,n.shape),i=u_(n,r,t);let a=i.shape;t||(a=Ls(i.shape,r));const s=vo(bn(or(n,"float32"),nt(i,a))),o=u_(s,r,t);return{mean:i,variance:o}}const aee=Te({moments_:jVe});function qVe(n,e,t,r){const i=te(e,"data","multiRNNCell"),a=r_(t,"c","multiRNNCell"),s=r_(r,"h","multiRNNCell");let o=i;const l=[];for(let f=0;f<n.length;f++){const h=n[f](o,a[f],s[f]);l.push(h[0]),l.push(h[1]),o=h[1]}const u=[],c=[];for(let f=0;f<l.length;f+=2)u.push(l[f]),c.push(l[f+1]);return[u,c]}const see=Te({multiRNNCell_:qVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XVe(n,e,t,r=!1){const i=te(n,"logits","multinomial"),a=i.size,s=i.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);t=t||Math.random();const l={logits:s===1?nt(i,[1,-1]):i},u={numSamples:e,seed:t,normalized:r},c=Ce.runKernel(yN,l,u);return s===1?nt(c,[c.size]):c}const oee=Te({multinomial_:XVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KVe(n,e){let t=te(n,"a","notEqual","string_or_numeric"),r=te(e,"b","notEqual","string_or_numeric");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r};return Ce.runKernel(bN,i)}const _3=Te({notEqual_:KVe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YVe(n){const t={x:te(n,"x","onesLike")};return Ce.runKernel(CN,t)}const lee=Te({onesLike_:YVe});function ZVe(n,e){const t=te(n,"v1","outerProduct"),r=te(e,"v2","outerProduct");le(t.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${r.rank}.`);const i=nt(t,[-1,1]),a=nt(r,[1,-1]);return nr(i,a)}const uee=Te({outerProduct_:ZVe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QVe(n,e,t=0){const r=te(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:t},a={x:r};return Ce.runKernel(MN,a,i)}const Kd=Te({pad_:QVe});function JVe(n,e,t=0){return le(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Kd(n,[e],t)}const cee=Te({pad1d_:JVe});function e6e(n,e,t=0){return le(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Kd(n,e,t)}const fee=Te({pad2d_:e6e});function t6e(n,e,t=0){return le(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Kd(n,e,t)}const x3=Te({pad3d_:t6e});function n6e(n,e,t=0){return le(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Kd(n,e,t)}const hee=Te({pad4d_:n6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r6e(n,e,t){const r=te(n,"x","spaceToBatchND");le(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),le(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),le(r.shape.reduce((s,o,l)=>l>0&&l<=e.length?s&&(o+t[l-1][0]+t[l-1][1])%e[l-1]===0:s,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const i={x:r},a={blockShape:e,paddings:t};return Ce.runKernel(rO,i,a)}const b3=Te({spaceToBatchND_:r6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6e(n,e,t,r,i,a,s){i==null&&(i=[1,1]),a==null&&(a=1),r===0&&(r="valid");const o=te(n,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),le(hs(a,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`);const c=Xd(l.shape,e,a,i,r),f=[c.dilationHeight,c.dilationWidth];let h;r==="same"?h=s6e([c.filterHeight,c.filterWidth],f):h=[[0,0],[0,0]];const d=f[0]===1&&f[1]===1,[p,m]=a6e([c.inHeight,c.inWidth],f,h),g=d?r:"valid",v=d?l:b3(l,f,p),x=(t==="avg"?()=>JO(v,e,a,g,s):()=>m3(v,e,a,g,s))(),b=d?x:e3(x,f,m);return u?nt(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function a6e(n,e,t){const r=t.map(c=>c[0]),i=t.map(c=>c[1]),a=n.concat(r,i),s=e.map((c,f)=>(c-a[f]%c)%c),o=i.map((c,f)=>c+s[f]),l=e.map((c,f)=>[r[f],o[f]]),u=e.map((c,f)=>[0,s[f]]);return[l,u]}function s6e(n,e){const r=n.map((s,o)=>s+(s-1)*(e[o]-1)).map(s=>s-1),i=r.map(s=>Math.floor(s/2)),a=r.map((s,o)=>s-i[o]);return r.map((s,o)=>[i[o],a[o]])}const dee=Te({pool_:i6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6e(n,e){const t=te(n,"x","prelu"),r=te(e,"alpha","prelu"),i={x:t,alpha:r};return Ce.runKernel(RN,i)}const w3=Te({prelu_:o6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l6e(n,e=null,t=!1){let r=te(n,"x","prod");r.dtype==="bool"&&(r=or(r,"int32"));const i={x:r},a={axis:e,keepDims:t};return Ce.runKernel(PN,i,a)}const pee=Te({prod_:l6e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u6e(n,e,t,r){const i=n.map((c,f)=>te(c,`tensors${f}`,"raggedGather","int32")),a=te(e,"paramsDenseValues","raggedGather"),s=te(t,"indices","raggedGather","int32"),o={paramsNestedSplits:i,paramsDenseValues:a,indices:s},l={outputRaggedRank:r},u=Ce.runKernel(IN,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const mee=Te({raggedGather_:u6e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6e(n,e,t,r,i){const a=te(n,"shape","raggedTensorToTensor","int32"),s=te(e,"values","raggedTensorToTensor"),o=te(t,"defaultValue","raggedTensorToTensor",s.dtype),l=r.map((f,h)=>te(f,`tensors${h}`,"raggedTensorToTensor","int32")),u={shape:a,values:s,defaultValue:o,rowPartitionTensors:l},c={rowPartitionTypes:i};return Ce.runKernel(DN,u,c)}const gee=Te({raggedTensorToTensor_:c6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6e(n,e,t){const r=yt(n);let i=null;if(t==null||t==="float32")i=new Float32Array(r);else if(t==="int32")i=new Int32Array(r);else if(t==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${t}`);for(let a=0;a<r;a++)i[a]=e();return Ce.makeTensor(i,n,t)}const vee=Te({rand_:f6e});var S3={exports:{}};S3.exports;(function(n){(function(e,t,r){function i(l){var u=this,c=o();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function a(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),f=u&&u.state,h=c.next;return h.int32=function(){return c.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,f&&(typeof f=="object"&&a(f,c),h.state=function(){return a(c,{})}),h}function o(){var l=4022871197,u=function(c){c=String(c);for(var f=0;f<c.length;f++){l+=c.charCodeAt(f);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(ho,n,!1)})(S3);var h6e=S3.exports,T3={exports:{}};T3.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function s(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&a(c,u),f.state=function(){return a(u,{})}),f}t&&t.exports?t.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(ho,n,!1)})(T3);var d6e=T3.exports,C3={exports:{}};C3.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function a(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function s(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&a(c,u),f.state=function(){return a(u,{})}),f}t&&t.exports?t.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(ho,n,!1)})(C3);var p6e=C3.exports,E3={exports:{}};E3.exports;(function(n){(function(e,t,r){function i(o){var l=this;l.next=function(){var c=l.x,f=l.i,h,d;return h=c[f],h^=h>>>7,d=h^h<<24,h=c[f+1&7],d^=h^h>>>10,h=c[f+3&7],d^=h^h>>>3,h=c[f+4&7],d^=h^h<<7,h=c[f+7&7],h=h^h<<13,d^=h^h<<9,c[f]=d,l.i=f+1&7,d};function u(c,f){var h,d=[];if(f===(f|0))d[0]=f;else for(f=""+f,h=0;h<f.length;++h)d[h&7]=d[h&7]<<15^f.charCodeAt(h)+d[h+1&7]<<13;for(;d.length<8;)d.push(0);for(h=0;h<8&&d[h]===0;++h);for(h==8?d[7]=-1:d[h],c.x=d,c.i=0,h=256;h>0;--h)c.next()}u(l,o)}function a(o,l){return l.x=o.x.slice(),l.i=o.i,l}function s(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.x&&a(c,u),f.state=function(){return a(u,{})}),f}t&&t.exports?t.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(ho,n,!1)})(E3);var m6e=E3.exports,A3={exports:{}};A3.exports;(function(n){(function(e,t,r){function i(o){var l=this;l.next=function(){var c=l.w,f=l.X,h=l.i,d,p;return l.w=c=c+1640531527|0,p=f[h+34&127],d=f[h=h+1&127],p^=p<<13,d^=d<<17,p^=p>>>15,d^=d>>>12,p=f[h]=p^d,l.i=h,p+(c^c>>>16)|0};function u(c,f){var h,d,p,m,g,v=[],_=128;for(f===(f|0)?(d=f,f=null):(f=f+"\0",d=0,_=Math.max(_,f.length)),p=0,m=-32;m<_;++m)f&&(d^=f.charCodeAt((m+32)%f.length)),m===0&&(g=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,m>=0&&(g=g+1640531527|0,h=v[m&127]^=d+g,p=h==0?p+1:0);for(p>=128&&(v[(f&&f.length||0)&127]=-1),p=127,m=4*128;m>0;--m)d=v[p+34&127],h=v[p=p+1&127],d^=d<<13,h^=h<<17,d^=d>>>15,h^=h>>>12,v[p]=d^h;c.w=g,c.X=v,c.i=p}u(l,o)}function a(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function s(o,l){o==null&&(o=+new Date);var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(c.X&&a(c,u),f.state=function(){return a(u,{})}),f}t&&t.exports?t.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(ho,n,!1)})(A3);var g6e=A3.exports,M3={exports:{}};M3.exports;(function(n){(function(e,t,r){function i(o){var l=this,u="";l.next=function(){var f=l.b,h=l.c,d=l.d,p=l.a;return f=f<<25^f>>>7^h,h=h-d|0,d=d<<24^d>>>8^p,p=p-f|0,l.b=f=f<<20^f>>>12^h,l.c=h=h-d|0,l.d=d<<16^h>>>16^p,l.a=p-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function a(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function s(o,l){var u=new i(o),c=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var h=u.next()>>>11,d=(u.next()>>>0)/4294967296,p=(h+d)/(1<<21);while(p===0);return p},f.int32=u.next,f.quick=f,c&&(typeof c=="object"&&a(c,u),f.state=function(){return a(u,{})}),f}t&&t.exports?t.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(ho,n,!1)})(M3);var v6e=M3.exports,yee={exports:{}};const y6e={},_6e=Object.freeze(Object.defineProperty({__proto__:null,default:y6e},Symbol.toStringTag,{value:"Module"})),x6e=Mve(_6e);(function(n){(function(e,t,r){var i=256,a=6,s=52,o="random",l=r.pow(i,a),u=r.pow(2,s),c=u*2,f=i-1,h;function d(b,S,T){var M=[];S=S==!0?{entropy:!0}:S||{};var C=v(g(S.entropy?[b,x(t)]:b??_(),3),M),k=new p(M),R=function(){for(var P=k.g(a),N=l,L=0;P<u;)P=(P+L)*i,N*=i,L=k.g(1);for(;P>=c;)P/=2,N/=2,L>>>=1;return(P+L)/N};return R.int32=function(){return k.g(4)|0},R.quick=function(){return k.g(4)/4294967296},R.double=R,v(x(k.S),t),(S.pass||T||function(P,N,L,F){return F&&(F.S&&m(F,k),P.state=function(){return m(k,{})}),L?(r[o]=P,N):P})(R,C,"global"in S?S.global:this==r,S.state)}function p(b){var S,T=b.length,M=this,C=0,k=M.i=M.j=0,R=M.S=[];for(T||(b=[T++]);C<i;)R[C]=C++;for(C=0;C<i;C++)R[C]=R[k=f&k+b[C%T]+(S=R[C])],R[k]=S;(M.g=function(P){for(var N,L=0,F=M.i,O=M.j,B=M.S;P--;)N=B[F=f&F+1],L=L*i+B[f&(B[F]=B[O=f&O+N])+(B[O]=N)];return M.i=F,M.j=O,L})(i)}function m(b,S){return S.i=b.i,S.j=b.j,S.S=b.S.slice(),S}function g(b,S){var T=[],M=typeof b,C;if(S&&M=="object")for(C in b)try{T.push(g(b[C],S-1))}catch{}return T.length?T:M=="string"?b:b+"\0"}function v(b,S){for(var T=b+"",M,C=0;C<T.length;)S[f&C]=f&(M^=S[f&C]*19)+T.charCodeAt(C++);return x(S)}function _(){try{var b;return h&&(b=h.randomBytes)?b=b(i):(b=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(b)),x(b)}catch{var S=e.navigator,T=S&&S.plugins;return[+new Date,e,T,e.screen,x(t)]}}function x(b){return String.fromCharCode.apply(0,b)}if(v(r.random(),t),n.exports){n.exports=d;try{h=x6e}catch{}}else r["seed"+o]=d})(typeof self<"u"?self:ho,[],Math)})(yee);var b6e=yee.exports,w6e=h6e,S6e=d6e,T6e=p6e,C6e=m6e,E6e=g6e,A6e=v6e,Yd=b6e;Yd.alea=w6e;Yd.xor128=S6e;Yd.xorwow=T6e;Yd.xorshift7=C6e;Yd.xor4096=E6e;Yd.tychei=A6e;var k3=Yd;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3{constructor(e,t,r,i,a){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const s=a||Math.random();this.random=k3.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let e,t,r=!1;for(;!r;){let i,a,s;do i=2*this.random()-1,a=2*this.random()-1,s=i*i+a*a;while(s>=1||s===0);const o=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*i*o,t=this.mean+this.stdDev*a*o,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class M6e{constructor(e,t,r,i){this.alpha=e,this.beta=1/t,this.dtype=r;const a=i||Math.random();this.randu=k3.alea(a.toString()),this.randn=new R3(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,i,a,s;for(;;){do i=this.randn.nextValue(),s=1+this.c*i;while(s<=0);if(s*=s*s,e=i*i,t=1-.331*e*e,r=.5*e+this.d*(1-s+Math.log(s)),a=this.randu(),a<t||Math.log(a)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class k6e{constructor(e=0,t=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=k3.alea(i)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6e(n,e,t=1,r="float32",i){if(t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const a=new M6e(e,t,r,i),s=ei(n,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const _ee=Te({randomGamma_:R6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6e(n,e=0,t=1,r,i){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const a=new R3(e,t,r,!1,i),s=ei(n,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const P3=Te({randomNormal_:P6e});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6e(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return P3(n,0,1,e,t)}const xee=Te({randomStandardNormal_:I6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D6e(n,e=0,t=1,r="float32",i){const a=ei(n,r),s=new k6e(e,t,null,i);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const I3=Te({randomUniform_:D6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wf(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const i={start:n,stop:e,step:t,dtype:r};return Ce.runKernel(LN,{},i)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6e(n){const t={x:te(n,"x","reciprocal")};return Ce.runKernel(ON,t)}const bee=Te({reciprocal_:L6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6e(n){const t={x:te(n,"x","relu")};return Ce.runKernel($N,t)}const K_=Te({relu_:N6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6e(n){const t={x:te(n,"x","relu6")};return Ce.runKernel(zN,t)}const D3=Te({relu6_:O6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $6e(n,e){const r={x:te(n,"x","reverse")},i={dims:e};return Ce.runKernel(VN,r,i)}const Sf=Te({reverse_:$6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6e(n){const e=te(n,"x","reverse");return le(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Sf(e,0)}const wee=Te({reverse1d_:F6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6e(n,e){const t=te(n,"x","reverse");return le(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),Sf(t,e)}const See=Te({reverse2d_:B6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6e(n,e){const t=te(n,"x","reverse");return le(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),Sf(t,e)}const Tee=Te({reverse3d_:U6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6e(n,e){const t=te(n,"x","reverse");return le(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),Sf(t,e)}const Cee=Te({reverse4d_:z6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6e(n){const t={x:te(n,"x","round")};return Ce.runKernel(HN,t)}const L3=Te({round_:V6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6e(n){const t={x:te(n,"x","rsqrt","float32")};return Ce.runKernel(WN,t)}const Eee=Te({rsqrt_:H6e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6e(n){const t={x:te(n,"x","selu")};return Ce.runKernel(XN,t)}const Aee=Te({selu_:W6e});function G6e(n,e,t,r,i,a=[1,1],s="NHWC"){const o=te(n,"x","separableConv2d"),l=te(e,"depthwiseFilter","separableConv2d"),u=te(t,"pointwiseFilter","separableConv2d");let c=o,f=!1;if(o.rank===3&&(f=!0,c=nt(o,[1,o.shape[0],o.shape[1],o.shape[2]])),s==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");le(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),le(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),le(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),le(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),le(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=l.shape[2],d=l.shape[3];le(u.shape[2]===h*d,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*d}, but got ${u.shape[2]}.`);const p=tC(c,l,r,i,s,a),g=j_(p,u,1,"valid",s);return f?nt(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Mee=Te({separableConv2d_:G6e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function j6e(n,e){const t=te(n,"x","setdiff1d"),r=te(e,"y","setdiff1d");le(t.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${r.dtype}).`),le(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),le(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await t.data(),a=await r.data(),s=new Set(a);let o=0;for(let c=0;c<i.length;c++)s.has(i[c])||o++;const l=new yg([o],t.dtype),u=new yg([o],"int32");for(let c=0,f=0;c<i.length;c++)s.has(i[c])||(l.values[f]=i[c],u.values[f]=c,f++);return[l.toTensor(),u.toTensor()]}const kee=j6e;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6e(n){const t={x:te(n,"x","sign")};return Ce.runKernel(QN,t)}const Ree=Te({sign_:q6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6e(n){const t={x:te(n,"x","sin","float32")};return Ce.runKernel(YN,t)}const Pee=Te({sin_:X6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6e(n){const t={x:te(n,"x","sinh")};return Ce.runKernel(ZN,t)}const Iee=Te({sinh_:K6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6e(n,e,t){const r=te(n,"x","slice1d");return le(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Tr(r,[e],[t])}const Dee=Te({slice1d_:Y6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6e(n,e,t){const r=te(n,"x","slice2d");return le(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Tr(r,e,t)}const Lee=Te({slice2d_:Z6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6e(n,e,t){const r=te(n,"x","slice3d");return le(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Tr(r,e,t)}const Nee=Te({slice3d_:Q6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6e(n,e,t){const r=te(n,"x","slice4d");return le(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Tr(r,e,t)}const Oee=Te({slice4d_:J6e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eHe(n,e=-1){const t=te(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},i={dim:e};return Ce.runKernel(aO,r,i)}const $ee=Te({softmax_:eHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tHe(n){le(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Ce.runKernel($L,e)}const aC=Te({fft_:tHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nHe(n){le(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Ce.runKernel(qL,e)}const c_=Te({ifft_:nHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rHe(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const i=nt(n,[t,e]);r=c_(i)}else{const i=[t,2*(e-1)],a=nt(xg(n),[t,e]),s=nt(V_(n),[t,e]),o=Sf(Tr(a,[0,1],[t,e-2]),1),l=St(Sf(Tr(s,[0,1],[t,e-2]),1),xn(-1)),u=Zi([a,o],1),c=Zi([s,l],1),f=nt(Ju(u,c),[i[0],i[1]]);r=c_(f)}if(r=xg(r),n.rank===3&&n.shape[0]!==0){const i=r,a=n.shape[0];r=nt(r,[a,r.shape[0]/a,r.shape[1]]),i.dispose()}return r}const N3=Te({irfft_:rHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iHe(n,e,t=0){const i={x:te(n,"x","split")},a={numOrSizeSplits:e,axis:t};return Ce.runKernel(iO,i,a)}const Sg=Te({split_:iHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aHe(n,e){le(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let i;if(e!=null&&e<t){const p=n.shape.map(g=>0),m=n.shape.map(g=>g);m[n.shape.length-1]=e,i=Tr(n,p,m),t=e}else if(e!=null&&e>t){const p=n.shape.map(m=>m);p[n.shape.length-1]=e-t,i=Zi([n,bf(p)],n.shape.length-1),t=e}else i=n;const a=ss(i),s=nt(Ju(i,a),[r,t]),o=aC(s),l=Math.floor(t/2)+1,u=xg(o),c=V_(o),f=Sg(u,[l,t-l],u.shape.length-1),h=Sg(c,[l,t-l],c.shape.length-1),d=i.shape.slice();return d[i.shape.length-1]=l,nt(Ju(f[0],h[0]),d)}const sC=Te({rfft_:aHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sHe(n,e){let t=te(n,"a","squaredDifference"),r=te(e,"b","squaredDifference");[t,r]=ri(t,r),Kn(t.shape,r.shape);const i={a:t,b:r},a={};return Ce.runKernel(fO,i,a)}const O3=Te({squaredDifference_:sHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oHe(n,e){const t=te(n,"x","squeeze","string_or_numeric");return nt(t,ic(t.shape,e).newShape)}const oo=Te({squeeze_:oHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lHe(n,e=0){const t=r_(n,"tensors","stack","string_or_numeric");le(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&le(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,i={axis:e};return Ce.runKernel(AN,r,i)}const Ql=Te({stack_:lHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uHe(n,e=0){const r={x:te(n,"x","step")},i={alpha:e};return Ce.runKernel(CO,r,i)}const $3=Te({step_:uHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cHe(n,e,t,r,i=0,a=0,s=0,o=0,l=0){const c={x:te(n,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:r,beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return Ce.runKernel(hO,c,f)}const Fee=Te({stridedSlice_:cHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fHe(n){const t={x:te(n,"x","tan","float32")};return Ce.runKernel(vO,t)}const Bee=Te({tan_:fHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lo(n,e){Gd(n);const t=Kl(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Pf(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ld(n,e,t){if(Gd(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Kl(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Pf(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(n,e,t){if(Gd(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Kl(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Pf(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zee(n,e,t){if(Gd(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Kl(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Pf(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(n,e,t){if(Gd(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Kl(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Pf(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hHe(n,e=1,t=!0){const r=te(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const a={x:r},s={k:e,sorted:t},[o,l]=Ce.runKernel(_O,a,s);return{values:o,indices:l}}const Hee=Te({topk_:hHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dHe(n,e=0,t=1,r,i){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new R3(e,t,r,!0,i),s=ei(n,r);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const Wee=Te({truncatedNormal_:dHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pHe(n,e=0){const t=te(n,"x","unique","string_or_numeric");le(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},i={axis:e},[a,s]=Ce.runKernel(bO,r,i);return{values:a,indices:s}}const Gee=Te({unique_:pHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mHe(n,e,t){const r=te(n,"x","unsortedSegmentSum"),i=te(e,"segmentIds","unsortedSegmentSum","int32");le(Sd(t),()=>"numSegments must be of dtype int");const a={x:r,segmentIds:i},s={numSegments:t};return Ce.runKernel(SO,a,s)}const jee=Te({unsortedSegmentSum_:mHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gHe(n,e=0){const t=te(n,"x","unstack","string_or_numeric");le(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},i={axis:e};return Ce.runKernel(wO,r,i)}const Df=Te({unstack_:gHe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(n,e){return iC(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(n,e=!0,t,r){return Ce.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3(n,e){const t=[];for(let a=0;a<e.length;a++)e[a]&&t.push(a);const r=ei(n,"int32"),i=ei([t.length,n.length],"int32");for(let a=0;a<t.length;a++){const s=r.indexToLoc(t[a]),o=a*n.length;i.values.set(s,o)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vHe(n){const e=te(n,"condition","whereAsync","bool"),t=await e.data(),r=F3(e.shape,t);return n!==e&&e.dispose(),r}const B3=vHe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yHe(n,e,t){const r=te(n,"tensor","boolMask"),i=te(e,"mask","boolMask","bool"),a=t??0,s=i.rank,o=r.shape;le(s>0,()=>"mask cannot be scalar"),Qi(o.slice(a,a+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=a;m<a+s;m++)l*=o[m];const u=o.slice(0,a).concat([l],o.slice(a+s)),c=nt(r,u),f=nt(i,[-1]),h=await B3(f),d=oo(h,[1]),p=o3(c,d,a);return n!==r&&r.dispose(),e!==i&&i.dispose(),d.dispose(),c.dispose(),f.dispose(),h.dispose(),p}const Kee=yHe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _He(n,e,t,r,i=!0){const a=te(n,"v","movingAverage"),s=te(e,"x","movingAverage"),o=te(t,"decay","movingAverage");dQ(a,s),le(Jr(a.shape,s.shape),()=>"Shape mismatch in v and x");const l=xn(1),u=bn(l,o);let c=St(bn(s,a),u);if(i){le(r!=null,()=>"When using zeroDebias: true, step is required.");const f=te(r,"step","movingAverage");c=Pr(c,bn(l,bg(o,f)))}return Jt(a,c)}const Yee=Te({movingAverage_:_He});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xHe(n,e,t){const r=te(n,"indices","scatterND","int32"),i=te(e,"updates","scatterND");GO(i,r,t);const a={indices:r,updates:i},s={shape:t};return Ce.runKernel(GN,a,s)}const Zee=Te({scatterND_:xHe});function bHe(n,e,t,r){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const i=n.rank>0?n.shape[0]:1,a=n.rank>1?n.shape[1]:1;if(t.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${a}.`);const s=e.size;if(!(e.rank===0||e.rank===1&&s===i))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${i}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wHe(n,e,t,r=0){const i=te(n,"sparseIndices","sparseToDense","int32"),a=te(e,"sparseValues","sparseToDense","string_or_numeric"),s=te(r,"defaultValue","sparseToDense",a.dtype);bHe(i,a,t,s);const o={sparseIndices:i,sparseValues:a,defaultValue:s},l={outputShape:t};return Ce.runKernel(cO,o,l)}const Qee=Te({sparseToDense_:wHe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SHe(n,e){const t=te(e,"indices","gatherND","int32"),i={params:te(n,"x","gatherND","string_or_numeric"),indices:t};return Ce.runKernel(WL,i)}const Jee=Te({gatherND_:SHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function THe(n,e){if(e==null)return n.shape.slice();if(Jr(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CHe(n,e,t,r){const i=te(n,"x","dropout");if(le(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),le(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof dr?i.clone():i;const a=THe(i,t),s=1-e,o=Pr(s3(Jt(I3(a,0,1,"float32",r),s)),s);return St(i,o)}const ete=Te({dropout_:CHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function oC(n,e,t){const r=1-n%2,i=new Float32Array(n);for(let a=0;a<n;++a){const s=2*Math.PI*a/(n+r-1);i[a]=e-t*Math.cos(s)}return lo(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function EHe(n,e,t=1){const r=te(n,"predictions","inTopK"),i=te(e,"targets","inTopK");le(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),le(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),Qi(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];le(t>0&&t<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${t}`);const s=await r.data(),o=await i.data(),[l,u]=[s.length/a,a],c=Xl("bool",l);for(let f=0;f<l;f++){const h=f*u,d=s.subarray(h,h+u),p=[];for(let m=0;m<d.length;m++)p.push({value:d[m],index:m});p.sort((m,g)=>g.value-m.value),c[f]=0;for(let m=0;m<t;m++)if(p[m].index===o[f]){c[f]=1;break}}return n!==r&&r.dispose(),e!==i&&i.dispose(),go(c,i.shape,"bool")}const tte=EHe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AHe(n,e,t,r,i,a="NHWC",s){let o=n;n.rank===3&&(o=nt(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]])),le(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),le(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),le(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=a==="NHWC"?o.shape[3]:o.shape[1],c=a==="NHWC"?l.shape[3]:l.shape[1];le(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),le(c===t[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${t[3]}).`),To("conv2dDerFilter",i,s);const f={x:o,dy:l},h={strides:r,pad:i,dataFormat:a,dimRoundingMode:s,filterShape:t};return Ce.runKernel(dL,f,h)}const MHe=Te({conv2DBackpropFilter_:AHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lC(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return St(n,$3(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function uC(n,e){let t=e;const r=zO(n.shape,e.shape);return r.length>0&&(t=Or(t,r)),nt(t,n.shape)}function cC(n,e,t,r){if(e==="linear")return n;if(e==="relu")return K_(n);if(e==="elu")return n3(n);if(e==="relu6")return D3(n);if(e==="prelu")return w3(n,t);if(e==="leakyrelu")return u3(n,r);if(e==="sigmoid")return Vl(n);throw new Error(`Unknown fused activation ${e}.`)}const fC=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kHe({x:n,filter:e,strides:t,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",fC(Ce.state.gradientDepth,l)===!1){le(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let T=j_(n,e,t,r,i,a,s);return o!=null&&(T=Jt(T,o)),cC(T,l,u,c)}const f=te(n,"x","conv2d","float32"),h=te(e,"filter","conv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=nt(f,[1,f.shape[0],f.shape[1],f.shape[2]])),le(d.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${d.rank}.`),le(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),To("fused conv2d",r,s);const m=i==="NHWC"?d.shape[3]:d.shape[1];le(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),le(hs(t,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`);const g=Ds(d.shape,h.shape,t,a,r,s);let v;o!=null&&(v=te(o,"bias","fused conv2d"),[v]=ri(v,f),i==="NHWC"?Kn(g.outShape,v.shape):(le(v.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${v.shape.length}.`),le(v.shape.length===0||v.shape[0]===g.outChannels||v.shape[0]===1,()=>`Error in fused conv2d: bias shape (${v.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let _;if(u!=null){const T=u.shape;if(le(T.length<=1||T.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${T.length}.`),T.length===1)le(T[0]===1||T[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the number of output channels (${g.outChannels}).`);else if(T.length===3)try{Kn(T,g.outShape)}catch{const C=`Error in fused conv2d: PReLU activation weights (${T}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(C)}_=te(u,"prelu weights","fused conv2d")}const x=(T,M)=>{le(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[C,k,R,P]=M,N=lC(T,R,l);le(o_(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const L=TJ(k.shape,N,C,t,r),F=MHe(k,N,C.shape,t,r),O=[L,F];if(P!=null){const B=uC(P,N);O.push(B)}return O},b={x:d,filter:h,bias:v,preluActivationWeights:_},S={strides:t,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return o==null?Zl((M,C,k)=>{let R=Ce.runKernel(fS,b,S);return k([C,M,R]),p&&(R=nt(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:x}})(d,h):Zl((M,C,k,R)=>{let P=Ce.runKernel(fS,b,S);return R([C,M,P,k]),p&&(P=nt(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:x}})(d,h,v)}const RHe=Te({fusedConv2d_:kHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PHe(n,e,t,r,i,a=[1,1],s){let o=n;n.rank===3&&(o=nt(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:o,dy:l},c={strides:r,pad:i,dimRoundingMode:s,dilations:a,filterShape:t};return Ce.runKernel(CL,u,c)}const IHe=Te({depthwiseConv2dNativeBackpropFilter_:PHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DHe(n,e,t,r,i,a=[1,1],s){let o=e,l=!1;e.rank===3&&(l=!0,o=nt(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:o,filter:t},c={strides:r,pad:i,dimRoundingMode:s,dilations:a,inputShape:n},f=Ce.runKernel(EL,u,c);return l?nt(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const LHe=Te({depthwiseConv2dNativeBackpropInput_:DHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NHe({x:n,filter:e,strides:t,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(fC(Ce.state.gradientDepth,l)===!1){let S=tC(n,e,t,r,i,a,s);return o!=null&&(S=Jt(S,o)),cC(S,l,u,c)}const f=te(n,"x","depthwiseConv2d","float32"),h=te(e,"filter","depthwiseConv2d","float32");let d=f,p=!1;f.rank===3&&(p=!0,d=nt(f,[1,f.shape[0],f.shape[1],f.shape[2]])),le(d.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${d.rank}.`),le(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),le(d.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${d.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),a==null&&(a=[1,1]),le(hs(t,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${a}'`),To("fused depthwiseConv2d",r,s);const m=Ds(d.shape,h.shape,t,a,r,s,!0);let g;o!=null&&(g=te(o,"bias","fused conv2d"),[g]=ri(g,f),Kn(m.outShape,g.shape));let v;u!=null&&(v=te(u,"prelu weights","fused depthwiseConv2d"));const _=(S,T)=>{le(o_(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[M,C,k,R]=T,P=lC(S,k,l),N=LHe(C.shape,P,M,t,r,a,s),L=IHe(C,P,M.shape,t,r,a,s);if(R!=null){const F=uC(g,P);return[N,L,F]}return[N,L]},x={x:d,filter:h,bias:g,preluActivationWeights:v},b={strides:t,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:c};return o==null?Zl((T,M,C)=>{let k=Ce.runKernel(hS,x,b);return C([M,T,k]),p&&(k=nt(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:_}})(d,h):Zl((T,M,C,k)=>{let R=Ce.runKernel(hS,x,b);return k([M,T,R,C]),p&&(R=nt(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:_}})(d,h,g)}const OHe=Te({fusedDepthwiseConv2d_:NHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $He({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:s,leakyreluAlpha:o=.2}){if(fC(Ce.state.gradientDepth,a)===!1){let P=nr(n,e,t,r);return i!=null&&(P=Jt(P,i)),cC(P,a,s,o)}let l=te(n,"a","fused matMul"),u=te(e,"b","fused matMul");[l,u]=ri(l,u);const c=t?l.shape[l.rank-2]:l.shape[l.rank-1],f=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=t?l.shape[l.rank-1]:l.shape[l.rank-2],d=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),m=u.shape.slice(0,-2),g=yt(p),v=yt(m);le(c===f,()=>`Error in fused matMul: inner shapes (${c}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${r} must match.`);const x=Kn(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,d]),b=t?nt(l,[g,c,h]):nt(l,[g,h,c]),S=r?nt(u,[v,d,f]):nt(u,[v,f,d]);let T;i!=null&&(T=te(i,"bias","fused matMul"),[T]=ri(T,l),Kn(x,T.shape));let M;s!=null&&(M=te(s,"prelu weights","fused matMul"));const C=(P,N)=>{const[L,F,O,B]=N,H=lC(nt(P,O.shape),O,a);let j,K;if(!t&&!r?(j=nr(H,F,!1,!0),K=nr(L,H,!0,!1)):!t&&r?(j=nr(H,F,!1,!1),K=nr(H,L,!0,!1)):t&&!r?(j=nr(F,H,!1,!0),K=nr(L,H,!1,!1)):(j=nr(F,H,!0,!0),K=nr(H,L,!0,!0)),i!=null){const J=uC(B,H);return[j,K,J]}else return[j,K]},k={a:b,b:S,bias:T,preluActivationWeights:M},R={transposeA:t,transposeB:r,activation:a,leakyreluAlpha:o};return i==null?Zl((N,L,F)=>{const O=Ce.runKernel(cS,k,R);return F([N,L,O]),{value:nt(O,x),gradFunc:C}})(b,S):Zl((N,L,F,O)=>{const B=Ce.runKernel(cS,k,R);return O([N,L,B,F]),{value:nt(B,x),gradFunc:C}})(b,S,T)}const FHe=Te({fusedMatMul_:$He});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nte=Object.freeze(Object.defineProperty({__proto__:null,conv2d:RHe,depthwiseConv2d:OHe,matMul:FHe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BHe(n){return oC(n,.54,.46)}const UHe=Te({hammingWindow_:BHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zHe(n){return oC(n,.5,.5)}const rte=Te({hannWindow_:zHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VHe(n,e,t,r=!1,i=0){let a=0;const s=[];for(;a+e<=n.size;)s.push(Tr(n,a,e)),a+=t;if(r)for(;a<n.size;){const o=a+e-n.size,l=Zi([Tr(n,a,e-o),Kg([o],i)]);s.push(l),a+=t}return s.length===0?ld([],[0,e]):nt(Zi(s),[s.length,e])}const ite=Te({frame_:VHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HHe(n,e,t,r,i=rte){r==null&&(r=U3(e));const a=ite(n,e,t),s=St(a,i(e));return sC(s,r)}const WHe=Te({stft_:HHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GHe(n,e,t,r,i="bilinear",a=0){const s=te(n,"image","cropAndResize"),o=te(e,"boxes","cropAndResize","float32"),l=te(t,"boxInd","cropAndResize","int32"),u=o.shape[0];le(s.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`),le(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),le(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),le(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),le(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),le(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const c={image:s,boxes:o,boxInd:l},f={method:i,extrapolationValue:a,cropSize:r};return Ce.runKernel(bL,c,f)}const jHe=Te({cropAndResize_:GHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qHe(n){const e=te(n,"image","flipLeftRight","float32");le(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Ce.runKernel(BL,t,{})}const XHe=Te({flipLeftRight_:qHe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KHe(n){const e=te(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];le(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),le(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(e.rank);return i.fill(1,0,t),i[t]=3,Um(e,i)}const YHe=Te({grayscaleToRGB_:KHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZHe(n,e,t=0,r=.5){const i=te(n,"image","rotateWithOffset","float32");le(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const a={image:i},s={radians:e,fillValue:t,center:r};return Ce.runKernel(EO,a,s)}const QHe=Te({rotateWithOffset_:ZHe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zg(n,e,t,r,i,a){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),a==null&&(a=0);const s=n.shape[0];return t=Math.min(t,s),le(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),le(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),le(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),le(e.rank===1,()=>"scores must be a 1D tensor"),le(e.shape[0]===s,()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${e.shape[0]}`),le(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JHe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY){const a=te(n,"boxes","nonMaxSuppression","float32"),s=te(e,"scores","nonMaxSuppression","float32"),o=Zg(a,s,t,r,i);t=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l={maxOutputSize:t,iouThreshold:r,scoreThreshold:i};return Ce.runKernel(wN,{boxes:a,scores:s},l)}const eWe=Te({nonMaxSuppression_:JHe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tWe(n,e,t){const r=nWe(n,e,t),i=r<0?-(r+1):r;n.splice(i,0,e)}function nWe(n,e,t){return iWe(n,e,t||rWe)}function rWe(n,e){return n>e?1:n<e?-1:0}function iWe(n,e,t){let r=0,i=n.length,a=0,s=!1;for(;r<i;){a=r+(i-r>>>1);const o=t(e,n[a]);o>0?r=a+1:(i=a,s=!o)}return s?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(n,e,t,r,i){return W3(n,e,t,r,i,0)}function V3(n,e,t,r,i,a){return W3(n,e,t,r,i,0,!1,a,!0)}function H3(n,e,t,r,i,a){return W3(n,e,t,r,i,a,!0)}function W3(n,e,t,r,i,a,s=!1,o=!1,l=!1){const u=[];for(let g=0;g<e.length;g++)e[g]>i&&u.push({score:e[g],boxIndex:g,suppressBeginIndex:0});u.sort(kH);const c=a>0?-.5/a:0,f=[],h=[];for(;f.length<t&&u.length>0;){const g=u.pop(),{score:v,boxIndex:_,suppressBeginIndex:x}=g;if(v<i)break;let b=!1;for(let S=f.length-1;S>=x;--S){const T=aWe(n,_,f[S]);if(T>=r){b=!0;break}if(g.score=g.score*sWe(r,c,T),g.score<=i)break}g.suppressBeginIndex=f.length,b||(g.score===v?(f.push(_),h.push(g.score)):g.score>i&&tWe(u,g,kH))}const d=f.length,p=t-d;o&&p>0&&(f.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:f};return s&&(m.selectedScores=h),l&&(m.validOutputs=d),m}function aWe(n,e,t){const r=n.subarray(e*4,e*4+4),i=n.subarray(t*4,t*4+4),a=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),f=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),d=(o-a)*(l-s),p=(f-u)*(h-c);if(d<=0||p<=0)return 0;const m=Math.max(a,u),g=Math.max(s,c),v=Math.min(o,f),_=Math.min(l,h),x=Math.max(v-m,0)*Math.max(_-g,0);return x/(d+p-x)}function sWe(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function kH(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oWe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY){const a=te(n,"boxes","nonMaxSuppressionAsync"),s=te(e,"scores","nonMaxSuppressionAsync"),o=Zg(a,s,t,r,i);t=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([a.data(),s.data()]),u=l[0],c=l[1],{selectedIndices:f}=z3(u,c,t,r,i);return a!==n&&a.dispose(),s!==e&&s.dispose(),lo(f,"int32")}const lWe=oWe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uWe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=te(n,"boxes","nonMaxSuppression"),o=te(e,"scores","nonMaxSuppression"),l=Zg(s,o,t,r,i,a);t=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const u={boxes:s,scores:o},c={maxOutputSize:t,iouThreshold:r,scoreThreshold:i,softNmsSigma:a},f=Ce.runKernel(TN,u,c);return{selectedIndices:f[0],selectedScores:f[1]}}const cWe=Te({nonMaxSuppressionWithScore_:uWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fWe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=te(n,"boxes","nonMaxSuppressionAsync"),o=te(e,"scores","nonMaxSuppressionAsync"),l=Zg(s,o,t,r,i,a);t=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const u=await Promise.all([s.data(),o.data()]),c=u[0],f=u[1],{selectedIndices:h,selectedScores:d}=H3(c,f,t,r,i,a);return s!==n&&s.dispose(),o!==e&&o.dispose(),{selectedIndices:lo(h,"int32"),selectedScores:lo(d)}}const hWe=fWe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dWe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const s=te(n,"boxes","nonMaxSuppression"),o=te(e,"scores","nonMaxSuppression"),l=Zg(s,o,t,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,h={boxes:s,scores:o},d={maxOutputSize:u,iouThreshold:c,scoreThreshold:f,padToMaxOutputSize:a},p=Ce.runKernel(SN,h,d);return{selectedIndices:p[0],validOutputs:p[1]}}const pWe=Te({nonMaxSuppressionPadded_:dWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function mWe(n,e,t,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const s=te(n,"boxes","nonMaxSuppressionAsync"),o=te(e,"scores","nonMaxSuppressionAsync"),l=Zg(s,o,t,r,i,null),u=l.maxOutputSize,c=l.iouThreshold,f=l.scoreThreshold,[h,d]=await Promise.all([s.data(),o.data()]),{selectedIndices:p,validOutputs:m}=V3(h,d,u,c,f,a);return s!==n&&s.dispose(),o!==e&&o.dispose(),{selectedIndices:lo(p,"int32"),validOutputs:xn(m,"int32")}}const gWe=mWe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vWe(n,e,t=!1,r=!1){const i=te(n,"images","resizeBilinear");le(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),le(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),le(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=i,s=!1;i.rank===3&&(s=!0,a=nt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:a},l={alignCorners:t,halfPixelCenters:r,size:e},u=Ce.runKernel(UN,o,l);return s?nt(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const yWe=Te({resizeBilinear_:vWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _We(n,e,t=!1,r=!1){const i=te(n,"images","resizeNearestNeighbor");le(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),le(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),le(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),le(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=i,s=!1;i.rank===3&&(s=!0,a=nt(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:a},l={alignCorners:t,halfPixelCenters:r,size:e},u=Ce.runKernel(BN,o,l);return s?nt(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const xWe=Te({resizeNearestNeighbor_:_We});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bWe(n,e="binary",t=!1,r=.5){const i=te(n,"image","threshold"),a=.2989,s=.587,o=.114,l=i.shape[0]*i.shape[1];let u=St(lo([r]),255),c,f,h,d;if(le(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),le(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),le(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),le(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),i.shape[2]===3){[c,f,h]=Sg(i,[1,1,1],-1);const g=St(c,a),v=St(f,s),_=St(h,o);d=Jt(Jt(g,v),_)}else d=n;if(e==="otsu"){const g=t3(or(L3(d),"int32"),go([]),256);u=wWe(g,l)}const p=t?nC(d,u):Yg(d,u);return or(St(p,255),"int32")}function wWe(n,e){let t=lo([-1]),r=lo([0]),i=lo([0]),a,s,o,l,u,c;for(let f=0;f<n.size-1;f++){a=Tr(n,0,f+1),s=Tr(n,f+1),u=Pr(Or(a),e),c=Pr(Or(s),e);const h=Or(St(a,wf(0,a.size)));o=Pr(h,Or(a));const d=Kg(s.shape,a.size),p=Jt(wf(0,s.size),d),m=St(s,p);l=Pr(Or(m),Or(s));const g=bn(o,l),v=bn(o,l),_=St(u,c);i=St(St(_,g),v);const x=Yg(i,r);r=kd(x,i,r),t=kd(x,lo([f]),t)}return t}const SWe=Te({threshold_:bWe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TWe(n,e,t="nearest",r="constant",i=0,a){const s=te(n,"image","transform","float32"),o=te(e,"transforms","transform","float32");le(s.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`),le(o.rank===2&&(o.shape[0]===s.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),le(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const l={image:s,transforms:o},u={interpolation:t,fillMode:r,fillValue:i,outputShape:a};return Ce.runKernel(xO,l,u)}const CWe=Te({transform_:TWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EWe(n,e,t){le(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),le(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const r=te(n,"a","bandPart");le(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[a,s]=r.shape.slice(-2);if(!(e<=a))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`);if(!(t<=s))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${s}).`);e<0&&(e=a),t<0&&(t=s);const o=nt(wf(0,a,1,"int32"),[-1,1]),l=wf(0,s,1,"int32"),u=bn(o,l),c=l_(nC(u,xn(+e,"int32")),l3(u,xn(-t,"int32"))),f=bf([a,s],r.dtype);return nt(Ql(Df(nt(r,[-1,a,s])).map(h=>kd(c,h,f))),i)}const AWe=Te({bandPart_:EWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MWe(n){let e;if(Array.isArray(n)){e=!1,le(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=n[0].shape[0];for(let a=1;a<n.length;++a)le(n[a].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[a].shape[0]} vs. ${i})`)}else e=!0,n=Sg(n,n.shape[0],0).map(i=>oo(i,[0]));le(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let i=0;i<n.length;++i)t.push(Ce.tidy(()=>{let a=r[i];if(i>0)for(let s=0;s<i;++s){const o=St(Or(St(t[s],a)),t[s]);a=bn(a,o)}return Pr(a,X_(a,"euclidean"))}));return e?Ql(t,0):t}const kWe=Te({gramSchmidt_:MWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RWe(n,e=!1){if(le(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return RH(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),r=Df(nt(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),i=[],a=[];r.forEach(l=>{const[u,c]=RH(l,e);i.push(u),a.push(c)});const s=nt(Ql(i,0),n.shape),o=nt(Ql(a,0),n.shape);return[s,o]}}function RH(n,e=!1){return Ce.tidy(()=>{le(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let i=a3(t),a=Vu(n);const s=ld([[1]],[1,1]);let o=Vu(s);const l=t>=r?r:t;for(let u=0;u<l;++u){const c=a,f=o,h=i;[o,a,i]=Ce.tidy(()=>{const d=Tr(a,[u,u],[t-u,1]),p=X_(d),m=Tr(a,[u,u],[1,1]),g=kd(Yg(m,0),ld([[-1]]),ld([[1]])),v=bn(m,St(g,p)),_=Pr(d,v);_.shape[0]===1?o=Vu(s):o=Zi([s,Tr(_,[1,0],[_.shape[0]-1,_.shape[1]])],0);const x=zl(Pr(nr(g,v),p)),b=Tr(a,[u,0],[t-u,r]),S=St(x,o),T=a_(o);if(u===0)a=bn(b,nr(S,nr(T,b)));else{const k=bn(b,nr(S,nr(T,b)));a=Zi([Tr(a,[0,0],[u,r]),k],0)}const M=a_(S),C=Tr(i,[0,u],[t,i.shape[1]-u]);if(u===0)i=bn(C,nr(nr(C,o),M));else{const k=bn(C,nr(nr(C,o),M));i=Zi([Tr(i,[0,0],[t,u]),k],1)}return[o,a,i]}),$a([c,f,h])}return!e&&t>r&&(i=Tr(i,[0,0],[t,r]),a=Tr(a,[0,0],[r,r])),[i,a]})}const PWe=Te({qr_:RWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var da;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(da||(da={}));function IWe(n,e,t=da.SUM_BY_NONZERO_WEIGHTS){const r=te(n,"losses","computeWeightedLoss");let i=null;e!=null&&(i=te(e,"weights","computeWeightedLoss"));const a=i==null?r:St(r,i);if(t===da.NONE)return a;if(t===da.SUM)return Or(a);if(t===da.MEAN){if(i==null)return u_(a);{const s=r.size/i.size,o=Pr(Or(a),Or(i));return s>1?Pr(o,xn(s)):o}}if(t===da.SUM_BY_NONZERO_WEIGHTS){if(i==null)return Pr(Or(a),xn(r.size));{const s=St(i,Zc(r.shape)),o=or(Or(_3(s,xn(0))),"float32");return Pr(Or(a),o)}}throw Error(`Unknown reduction: ${t}`)}const ac=Te({computeWeightedLoss_:IWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DWe(n,e,t,r=da.SUM_BY_NONZERO_WEIGHTS){const i=te(n,"labels","absoluteDifference"),a=te(e,"predictions","absoluteDifference");let s=null;t!=null&&(s=te(t,"weights","absoluteDifference")),Qi(i.shape,a.shape,"Error in absoluteDifference: ");const o=Ka(bn(i,a));return ac(o,s,r)}const LWe=Te({absoluteDifference_:DWe});function NWe(n,e,t,r,i=da.SUM_BY_NONZERO_WEIGHTS){const a=te(n,"labels","cosineDistance"),s=te(e,"predictions","cosineDistance");let o=null;r!=null&&(o=te(r,"weights","cosineDistance")),Qi(a.shape,s.shape,"Error in cosineDistance: ");const l=xn(1),u=bn(l,Or(St(a,s),t,!0));return ac(u,o,i)}const OWe=Te({cosineDistance_:NWe});function $We(n,e,t,r=da.SUM_BY_NONZERO_WEIGHTS){let i=te(n,"labels","hingeLoss");const a=te(e,"predictions","hingeLoss");let s=null;t!=null&&(s=te(t,"weights","hingeLoss")),Qi(i.shape,a.shape,"Error in hingeLoss: ");const o=xn(1);i=bn(St(xn(2),i),o);const l=K_(bn(o,St(i,a)));return ac(l,s,r)}const FWe=Te({hingeLoss_:$We});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BWe(n,e,t,r=1,i=da.SUM_BY_NONZERO_WEIGHTS){const a=te(n,"labels","huberLoss"),s=te(e,"predictions","huberLoss");let o=null;t!=null&&(o=te(t,"weights","huberLoss")),Qi(a.shape,s.shape,"Error in huberLoss: ");const l=xn(r),u=Ka(bn(s,a)),c=v3(u,l),f=bn(u,c),h=Jt(St(xn(.5),vo(c)),St(l,f));return ac(h,o,i)}const UWe=Te({huberLoss_:BWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zWe(n,e,t,r=1e-7,i=da.SUM_BY_NONZERO_WEIGHTS){const a=te(n,"labels","logLoss"),s=te(e,"predictions","logLoss");let o=null;t!=null&&(o=te(t,"weights","logLoss")),Qi(a.shape,s.shape,"Error in logLoss: ");const l=xn(1),u=xn(r),c=zl(St(a,wg(Jt(s,u)))),f=St(bn(l,a),wg(Jt(bn(l,s),u))),h=bn(c,f);return ac(h,o,i)}const VWe=Te({logLoss_:zWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HWe(n,e,t,r=da.SUM_BY_NONZERO_WEIGHTS){const i=te(n,"labels","meanSquaredError"),a=te(e,"predictions","meanSquaredError");let s=null;t!=null&&(s=te(t,"weights","meanSquaredError")),Qi(i.shape,a.shape,"Error in meanSquaredError: ");const o=O3(i,a);return ac(o,s,r)}const WWe=Te({meanSquaredError_:HWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GWe(n,e){const t=te(n,"labels","sigmoidCrossEntropyWithLogits"),r=te(e,"logits","sigmoidCrossEntropyWithLogits");Qi(t.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=K_(r),a=St(r,t),s=c3(xf(zl(Ka(r))));return Jt(bn(i,a),s)}function jWe(n,e,t,r=0,i=da.SUM_BY_NONZERO_WEIGHTS){let a=te(n,"multiClassLabels","sigmoidCrossEntropy");const s=te(e,"logits","sigmoidCrossEntropy");let o=null;if(t!=null&&(o=te(t,"weights","sigmoidCrossEntropy")),Qi(a.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=xn(r),c=xn(1),f=xn(.5);a=Jt(St(a,bn(c,u)),St(f,u))}const l=GWe(a,s);return ac(l,o,i)}const qWe=Te({sigmoidCrossEntropy_:jWe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XWe(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Zl((i,a,s)=>{const l=h3(a,[t],!0),u=bn(or(a,"float32"),l);s([i,u]);const c=zl(St(u,i));return{value:Or(c,[t]),gradFunc:(d,p)=>{const[m,g]=p,v=Ls(d.shape,[t]);return[St(nt(d,v),bn(or(m,"float32"),xf(g))),St(nt(d,v),bn(xf(g),or(m,"float32")))]}}})(n,e)}function KWe(n,e,t,r=0,i=da.SUM_BY_NONZERO_WEIGHTS){let a=te(n,"onehotLabels","softmaxCrossEntropy");const s=te(e,"logits","softmaxCrossEntropy");let o=null;if(t!=null&&(o=te(t,"weights","softmaxCrossEntropy")),Qi(a.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){const u=xn(r),c=xn(1),f=xn(a.shape[1]);a=Jt(St(a,bn(c,u)),Pr(u,f))}const l=XWe(a,s);return ac(l,o,i)}const YWe=Te({softmaxCrossEntropy_:KWe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZWe(n,e,t,r){const i=te(n,"indices","sparseFillEmptyRows","int32"),a=te(e,"values","sparseFillEmptyRows"),s=te(t,"denseShape","sparseFillEmptyRows","int32"),o=te(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(s.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:i,values:a,denseShape:s,defaultValue:o},u=Ce.runKernel(sO,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const QWe=Te({sparseFillEmptyRows_:ZWe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JWe(n,e,t){const r=te(n,"inputIndices","sparseReshape","int32"),i=te(e,"inputShape","sparseReshape","int32"),a=te(t,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const s={inputIndices:r,inputShape:i,newShape:a},o=Ce.runKernel(oO,s);return{outputIndices:o[0],outputShape:o[1]}}const eGe=Te({sparseReshape_:JWe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tGe(n,e,t){const r=te(n,"data","sparseSegmentMean"),i=te(e,"indices","sparseSegmentMean","int32"),a=te(t,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const s={data:r,indices:i,segmentIds:a};return Ce.runKernel(lO,s)}const nGe=Te({sparseSegmentMean_:tGe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rGe(n,e,t){const r=te(n,"data","sparseSegmentSum"),i=te(e,"indices","sparseSegmentSum","int32"),a=te(t,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const s={data:r,indices:i,segmentIds:a};return Ce.runKernel(uO,s)}const iGe=Te({sparseSegmentSum_:rGe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aGe(n,e,t,r,i,a,s,o){const l=te(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=te(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:t,nGramWidths:r,leftPad:i,rightPad:a,padWidth:s,preserveShortSequences:o},f={data:l,dataSplits:u},h=Ce.runKernel(dO,f,c);return{nGrams:h[0],nGramsSplits:h[1]}}const sGe=Te({stringNGrams_:aGe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oGe(n,e,t=!0){const r=te(n,"input","stringSplit","string"),i=te(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const a={skipEmpty:t},s={input:r,delimiter:i},o=Ce.runKernel(pO,s,a);return{indices:o[0],values:o[1],shape:o[2]}}const lGe=Te({stringSplit_:oGe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uGe(n,e){const t=te(n,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:t};return Ce.runKernel(mO,i,r)}const cGe=Te({stringToHashBucketFast_:uGe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ate={fft:aC,ifft:c_,rfft:sC,irfft:N3},ste={hammingWindow:UHe,hannWindow:rte,frame:ite,stft:WHe},Rd={flipLeftRight:XHe,grayscaleToRGB:YHe,resizeNearestNeighbor:xWe,resizeBilinear:yWe,rotateWithOffset:QHe,cropAndResize:jHe,nonMaxSuppression:eWe,nonMaxSuppressionAsync:lWe,nonMaxSuppressionWithScore:cWe,nonMaxSuppressionWithScoreAsync:hWe,nonMaxSuppressionPadded:pWe,nonMaxSuppressionPaddedAsync:gWe,threshold:SWe,transform:CWe},ote={bandPart:AWe,gramSchmidt:kWe,qr:PWe},lte={absoluteDifference:LWe,computeWeightedLoss:ac,cosineDistance:OWe,hingeLoss:FWe,huberLoss:UWe,logLoss:VWe,meanSquaredError:WWe,sigmoidCrossEntropy:qWe,softmaxCrossEntropy:YWe},ute={sparseFillEmptyRows:QWe,sparseReshape:eGe,sparseSegmentMean:nGe,sparseSegmentSum:iGe},cte={stringNGrams:sGe,stringSplit:lGe,stringToHashBucketFast:cGe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lf extends YQ{minimize(e,t=!1,r){const{value:i,grads:a}=this.computeGradients(e,r);if(r!=null){const s=r.map(o=>({name:o.name,tensor:a[o.name]}));this.applyGradients(s)}else this.applyGradients(a);return $a(a),t?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return YJ(e,t)}dispose(){this.iterations_!=null&&$a(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:xn(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Lf,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hC extends Lf{constructor(e,t,r=null){super(),this.learningRate=e,this.rho=t,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=Ce.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const a=Ce.registeredVariables[r],s=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:tn(()=>ss(a).variable(s))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:tn(()=>ss(a).variable(s))});const o=Array.isArray(e)?e[i].tensor:e[r];if(o==null)return;const l=this.accumulatedGrads[i].variable,u=this.accumulatedUpdates[i].variable;tn(()=>{const c=Jt(St(l,this.rho),St(vo(o),1-this.rho)),f=St(Pr(Yl(Jt(u,this.epsilon)),Yl(Jt(l,this.epsilon))),o),h=Jt(St(u,this.rho),St(vo(f),1-this.rho));l.assign(c),u.assign(h);const d=Jt(St(f,-this.learningRate),a);a.assign(d)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&($a(this.accumulatedGrads.map(e=>e.variable)),$a(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}hC.className="Adadelta";If(hC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dC extends Lf{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const a=Ce.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:tn(()=>Kg(a.shape,this.initialAccumulatorValue).variable(!1))});const s=Array.isArray(e)?e[i].tensor:e[r];if(s==null)return;const o=this.accumulatedGrads[i].variable;tn(()=>{const l=Jt(o,vo(s));o.assign(l);const u=Jt(St(Pr(s,Yl(Jt(l,Ce.backend.epsilon()))),-this.learningRate),a);a.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&$a(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}dC.className="Adagrad";If(dC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pC extends Lf{constructor(e,t,r,i=null){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],tn(()=>{this.accBeta1=xn(t).variable(),this.accBeta2=xn(r).variable()}),i==null&&(this.epsilon=Ce.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);tn(()=>{const r=bn(1,this.accBeta1),i=bn(1,this.accBeta2);t.forEach((a,s)=>{const o=Ce.registeredVariables[a],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:tn(()=>ss(o).variable(l))}),this.accumulatedSecondMoment[s]==null&&(this.accumulatedSecondMoment[s]={originalName:`${a}/v`,variable:tn(()=>ss(o).variable(l))});const u=Array.isArray(e)?e[s].tensor:e[a];if(u==null)return;const c=this.accumulatedFirstMoment[s].variable,f=this.accumulatedSecondMoment[s].variable,h=Jt(St(c,this.beta1),St(u,1-this.beta1)),d=Jt(St(f,this.beta2),St(vo(u),1-this.beta2)),p=Pr(h,r),m=Pr(d,i);c.assign(h),f.assign(d);const g=Jt(St(Pr(p,Jt(Yl(m),this.epsilon)),-this.learningRate),o);o.assign(g)}),this.accBeta1.assign(St(this.accBeta1,this.beta1)),this.accBeta2.assign(St(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&$a(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&$a(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),tn(()=>{this.accBeta1.assign(bg(this.beta1,this.iterations_+1)),this.accBeta2.assign(bg(this.beta2,this.iterations_+1))});const t=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}pC.className="Adam";If(pC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mC extends Lf{constructor(e,t,r,i=null,a=0){super(),this.learningRate=e,this.beta1=t,this.beta2=r,this.epsilon=i,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],tn(()=>{this.iteration=xn(0).variable(),this.accBeta1=xn(t).variable()}),i==null&&(this.epsilon=Ce.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);tn(()=>{const r=bn(1,this.accBeta1),i=Pr(-this.learningRate,Jt(St(this.iteration,this.decay),1));t.forEach((a,s)=>{const o=Ce.registeredVariables[a],l=!1;this.accumulatedFirstMoment[s]==null&&(this.accumulatedFirstMoment[s]={originalName:`${a}/m`,variable:ss(o).variable(l)}),this.accumulatedWeightedInfNorm[s]==null&&(this.accumulatedWeightedInfNorm[s]={originalName:`${a}/v`,variable:ss(o).variable(l)});const u=Array.isArray(e)?e[s].tensor:e[a];if(u==null)return;const c=this.accumulatedFirstMoment[s].variable,f=this.accumulatedWeightedInfNorm[s].variable,h=Jt(St(c,this.beta1),St(u,1-this.beta1)),d=St(f,this.beta2),p=Ka(u),m=g3(d,p);c.assign(h),f.assign(m);const g=Jt(St(Pr(i,r),Pr(h,Jt(m,this.epsilon))),o);o.assign(g)}),this.iteration.assign(Jt(this.iteration,1)),this.accBeta1.assign(St(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&$a(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&$a(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}mC.className="Adamax";If(mC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y_ extends Lf{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const a=Array.isArray(e)?e[i].tensor:e[r];if(a==null)return;const s=Ce.registeredVariables[r];tn(()=>{const o=Jt(St(this.c,a),s);s.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Ol(xn(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}Y_.className="SGD";If(Y_);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gC extends Y_{constructor(e,t,r=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=r,this.accumulations=[],this.m=xn(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const a=Ce.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:tn(()=>ss(a).variable(!1))});const s=this.accumulations[i].variable,o=Array.isArray(e)?e[i].tensor:e[r];o!=null&&tn(()=>{let l;const u=Jt(St(this.m,s),o);this.useNesterov?l=Jt(St(this.c,Jt(o,St(u,this.m))),a):l=Jt(St(this.c,u),a),s.assign(u),a.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&$a(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}gC.className="Momentum";If(gC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vC extends Lf{constructor(e,t=.9,r=0,i=null,a=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,i==null&&(this.epsilon=Ce.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const a=Ce.registeredVariables[r],s=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:tn(()=>ss(a).variable(s))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:tn(()=>ss(a).variable(s))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:tn(()=>ss(a).variable(s))});const o=Array.isArray(e)?e[i].tensor:e[r];if(o==null)return;const l=this.accumulatedMeanSquares[i].variable,u=this.accumulatedMoments[i].variable;tn(()=>{const c=Jt(St(l,this.decay),St(vo(o),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[i].variable,h=Jt(St(f,this.decay),St(o,1-this.decay)),d=Pr(St(o,this.learningRate),Yl(bn(c,Jt(vo(h),this.epsilon)))),p=Jt(St(u,this.momentum),d);l.assign(c),f.assign(h),u.assign(p);const m=bn(a,p);a.assign(m)}else{const f=Jt(St(l,this.decay),St(vo(o),1-this.decay)),h=Jt(St(u,this.momentum),Pr(St(o,this.learningRate),Yl(Jt(f,this.epsilon))));l.assign(f),u.assign(h);const d=bn(a,h);a.assign(d)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&$a(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&$a(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&$a(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,t).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=e.slice(t,t*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}vC.className="RMSProp";If(vC);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $c{static sgd(e){return new Y_(e)}static momentum(e,t,r=!1){return new gC(e,t,r)}static rmsprop(e,t=.9,r=0,i=null,a=!1){return new vC(e,t,r,i,a)}static adam(e=.001,t=.9,r=.999,i=null){return new pC(e,t,r,i)}static adadelta(e=.001,t=.95,r=null){return new hC(e,t,r)}static adamax(e=.002,t=.9,r=.999,i=null,a=0){return new mC(e,t,r,i,a)}static adagrad(e,t=.1){return new dC(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fGe={sgd:$c.sgd,momentum:$c.momentum,adadelta:$c.adadelta,adagrad:$c.adagrad,rmsprop:$c.rmsprop,adamax:$c.adamax,adam:$c.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hGe=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n())();function fte(){return new Promise(n=>hGe(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(n,e){const t=n[0].length;n.forEach((i,a)=>{le(i.length===t,()=>`Error in concat${t}D: rank of tensors[${a}] must be the same as the rank of the rest (${t})`)}),le(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((i,a)=>{for(let s=0;s<t;s++)le(s===e||i[s]===r[s],()=>`Error in concat${t}D: Shape of tensors[${a}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`)})}function Pd(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Vo;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Vo||(Vo={}));function dte(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let i=1;i<t.length;++i){const a=t[i],s=r[r.length-t.length+i],o=r[s];if(a>=0)if(o>=0){if(o!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${i+n}] = ${a} but shape[${i+n}] = ${o}`)}else r[s]=a}return r}function pte(n){const e={FIRST_DIM_SIZE:Vo.FIRST_DIM_SIZE,VALUE_ROWIDS:Vo.VALUE_ROWIDS,ROW_LENGTHS:Vo.ROW_LENGTHS,ROW_SPLITS:Vo.ROW_SPLITS,ROW_LIMITS:Vo.ROW_LIMITS,ROW_STARTS:Vo.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function mte(n){return n.length===0?0:n[0]===Vo.FIRST_DIM_SIZE?n.length-1:n.length}function gte(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(t,r-1);++i){const a=n[i],s=e[i+1];if(a>=0&&s>=0&&a!==1&&a!==s)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${i-n.length}] = ${a} but ragged tensor input.flatValues.shape[${i-n.length}] = ${s}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3=30;function yC(n){return n<=G3?n:oS(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(n,e,t){const r=t*(typeof n=="number"?n:n[0]),i=e*(typeof n=="number"?n:n[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3(n,e,t,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(n[0]/t),i=i.concat(n.slice(1));else{i=i.concat(n[0]);const a=e.length;for(let s=0;s<a;++s)i=i.concat([n[s+1]/e[s],e[s]]);i=i.concat(n.slice(a+1))}return i}function q3(n,e,t=!0){const r=[];if(t){r.push(e);for(let i=e+1;i<n;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{const i=[],a=[];for(let s=1;s<n;++s)s>=e*2+1||s%2===1?a.push(s):i.push(s);r.push(...i),r.push(0),r.push(...a)}return r}function X3(n,e,t,r=!0){const i=[];r?i.push(n[0]/t):i.push(n[0]*t);for(let a=1;a<n.length;++a)a<=e.length?r?i.push(e[a-1]*n[a]):i.push(n[a]/e[a-1]):i.push(n[a]);return i}function yte(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function _te(n,e,t){const r=n.slice(0,1);for(let i=0;i<t;++i)r.push(n[i+1]-e[i][0]-e[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte=1.7580993408473768,bte=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wte=.3275911,Ste=.254829592,Tte=-.284496736,Cte=1.421413741,Ete=-1.453152027,Ate=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xR(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function dGe(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function pGe(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<n.length;i+=4)t[Math.floor(i/4)]=n[i],r[Math.floor(i/4)]=n[i+1];return{real:t,imag:r}}function mGe(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<n.length;i+=4)t[Math.floor(i/4)]=n[i],r[Math.floor(i/4)]=n[i+1];return{real:t,imag:r}}function gGe(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function vGe(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function yGe(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let i=0;i<Math.ceil(n/2);i++){const a=(e?2:-2)*Math.PI*(i/n);t[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:t,imag:r}}function _Ge(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),i=Math.cos(r),a=Math.sin(r);return{real:i,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _A="->",xGe=/->/g,PH=",",IH="...";function Mte(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(xGe,"").length)/_A.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${_A}").`);const[r,i]=n.split(_A);le(r.indexOf(IH)===-1,()=>`The ellipsis notation ("${IH}") is not supported yet.`);const a=r.split(PH),s=a.length;if(e!==s)throw new Error(`Expected ${s} input tensors, received ${e}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let h=0;h<i.length;++h){const d=i[h];if(!a.some(p=>p.indexOf(d)!==-1))throw new Error(`Output subscripts contain the label ${d} not present in the input subscripts.`);o.indexOf(d)===-1&&o.push(d)}for(let h=0;h<r.length;++h){const d=r[h];o.indexOf(d)===-1&&d!==PH&&o.push(d)}const l=new Array(a.length);for(let h=0;h<s;++h){if(new Set(a[h].split("")).size!==a[h].length)throw new Error(`Found duplicate axes in input component ${a[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let d=0;d<a[h].length;++d)l[h].push(o.indexOf(a[h][d]))}const u=o.length,c=i.length,f=[];for(let h=c;h<u;++h)f.push(h);return{allDims:o,summedDims:f,idDims:l}}function kte(n,e){let t=new Array(n);t.fill(-1);for(let i=0;i<e.length;++i)t[e[i]]=i;const r=[];for(let i=0;i<n;++i)t[i]===-1&&r.push(i);return t=t.filter(i=>i!==-1),{permutationIndices:t,expandDims:r}}function Rte(n,e,t){const r=new Array(n);for(let i=0;i<t.length;++i){const a=t[i].shape;for(let s=0;s<e[i].length;++s)r[e[i][s]]===void 0?r[e[i][s]]=a[s]:le(r[e[i][s]]===a[s],()=>`Expected dimension ${r[e[i][s]]} at axis ${s} of input shaped ${JSON.stringify(a)}, but got dimension ${a[s]}`)}}function Pte(n,e){const t=n,r=[];let i=0;n.length===0&&t.push(-1),i=n.length+1;for(let s=0;s<i;++s)r.push([]);const a=[];for(let s=0;s<t.length;++s){const o=t[s],l=bGe(e,o);for(const u of l)a.indexOf(u)===-1&&(r[s].push(u),a.push(u))}return{path:t,steps:r}}function Ite(n){return n.every((e,t)=>e===t)}function bGe(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function Dte(n,e,t=0){let r=[];if(typeof e=="number")le(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const i=e.reduce((s,o)=>(o===-1&&(s+=1),s),0);le(i<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const s=e.reduce((o,l)=>l>0?o+l:o);e[a]=n.shape[t]-s}le(n.shape[t]===e.reduce((s,o)=>s+o),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function Nte(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function Ote(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function Fte(n,e){return`size ${n} must be non-negative, not ${e}`}function Bte(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Ute(n,e){const t=yt(n),r=yt(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function zte(n,e){const t=yt(n),r=yt(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bR(){return"segment ids must be >= 0"}function Vte(){return"segment ids are not increasing"}function Hte(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Wte(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(n,e){let t=!1,r;for(n<=G3?(r=n,t=!0):r=oS(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=oS(n,r+1);return r}function jte(n,e,t){const r=[],i=n.length;for(let a=0;a<i;a++)a!==e?r.push(n[a]):r.push(t);return r}function qte(n,e,t,r){const i=e.shape.length,a=n.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${a}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let f=0;f<r;++f)if(n.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const s=n.shape[t],o=[];let l=1,u=1,c=1;for(let f=0;f<r;++f)o.push(n.shape[f]),l*=n.shape[f];for(let f=r;f<t;f++)o.push(n.shape[f]),u*=n.shape[f];for(let f=r;f<i;f++)o.push(e.shape[f]);for(let f=t+1;f<a;f++)o.push(n.shape[f]),c*=n.shape[f];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:s,outputShape:o}}const wGe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:qte,computeOutShape:jte,segOpComputeOptimalWindowSize:Gte},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_(n){try{return n.map(e=>Cd(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Xte(n){return n.map(e=>zu(e))}const Kte=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Ste,ERF_A2:Tte,ERF_A3:Cte,ERF_A4:Ete,ERF_A5:Ate,ERF_P:wte,PARALLELIZE_THRESHOLD:G3,get RowPartitionType(){return Vo},SELU_SCALE:bte,SELU_SCALEALPHA:xte,applyActivation:cC,assertAndGetBroadcastShape:Kn,assertAxesAreInnerMostDims:hl,assertParamsConsistent:hte,assignToTypedArray:vGe,axesAreInnerMostDims:r3,calculateShapes:eC,checkEinsumDimSizes:Rte,checkPadOnDimRoundingMode:To,combineLocations:UJ,combineRaggedTensorToTensorShapes:dte,complexWithEvenIndex:pGe,complexWithOddIndex:mGe,computeConv2DInfo:Ds,computeConv3DInfo:W_,computeDefaultPad:QO,computeDilation2DInfo:cJ,computeOptimalWindowSize:yC,computeOutAndReduceShapes:ru,computeOutShape:Pd,computePool2DInfo:Xd,computePool3DInfo:H_,convertConv2DDataFormat:Xg,decodeEinsumEquation:Mte,eitherStridesOrDilationsAreOne:hs,expandShapeToKeepDim:Ls,exponent:_Ge,exponents:yGe,fromStringArrayToUint8:Xte,fromUint8ToStringArray:f_,getAxesPermutation:Co,getBroadcastDims:s_,getComplexWithIndex:gGe,getEinsumComputePath:Pte,getEinsumPermutation:kte,getFusedBiasGradient:uC,getFusedDyActivation:lC,getImageCenter:vte,getInnerMostAxes:Eo,getPermuted:q3,getRaggedRank:mte,getReductionAxes:zO,getReshaped:j3,getReshapedPermuted:X3,getRowPartitionTypesHelper:pte,getSliceBeginCoords:yte,getSliceSize:_te,getSparseFillEmptyRowsIndicesDenseShapeMismatch:Lte,getSparseFillEmptyRowsNegativeIndexErrorMessage:Nte,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:Ote,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Bte,getSparseReshapeInputOutputMismatchErrorMessage:zte,getSparseReshapeInputOutputMultipleErrorMessage:Ute,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:$te,getSparseReshapeNegativeOutputDimErrorMessage:Fte,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Wte,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:bR,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Vte,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:Hte,getUndoAxesPermutation:i3,isIdentityPermutation:Ite,log:p4e,mergeRealAndImagArrays:xR,prepareAndValidate:HO,prepareSplitSize:Dte,segment_util:wGe,shouldFuse:fC,slice_util:KQ,splitRealAndImagArrays:dGe,tupleValuesAreOne:o_,upcastType:nl,validateDefaultValueShape:gte,validateInput:GO,validateUpdateShape:WO,warn:no},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SGe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:z3,nonMaxSuppressionV4Impl:V3,nonMaxSuppressionV5Impl:H3,whereImpl:F3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yte=Object.freeze(Object.defineProperty({__proto__:null,Abs:VD,Acos:HD,Acosh:WD,AdadeltaOptimizer:hC,AdagradOptimizer:dC,AdamOptimizer:pC,AdamaxOptimizer:mC,Add:qT,AddN:GD,All:jD,Any:qD,ArgMax:XD,ArgMin:KD,Asin:YD,Asinh:ZD,Atan:QD,Atan2:eL,Atanh:JD,AvgPool:tL,AvgPool3D:nL,AvgPool3DGrad:XZ,AvgPoolGrad:qZ,BatchMatMul:rL,BatchToSpaceND:iL,Bincount:aL,BroadcastArgs:sL,BroadcastTo:s4e,Cast:XT,Ceil:oL,ClipByValue:lL,Complex:uL,ComplexAbs:cL,Concat:fL,Conv2D:hL,Conv2DBackpropFilter:dL,Conv2DBackpropInput:pL,Conv3D:mL,Conv3DBackpropFilterV2:KZ,Conv3DBackpropInputV2:gL,Cos:vL,Cosh:yL,CropAndResize:bL,Cumprod:_L,Cumsum:xL,DataStorage:LZ,DenseBincount:wL,DepthToSpace:SL,DepthwiseConv2dNative:TL,DepthwiseConv2dNativeBackpropFilter:CL,DepthwiseConv2dNativeBackpropInput:EL,Diag:AL,Dilation2D:ML,Dilation2DBackpropFilter:l4e,Dilation2DBackpropInput:o4e,get ENV(){return UD},Einsum:RL,Elu:PL,EluGrad:YZ,Environment:GZ,Equal:DL,Erf:IL,Exp:LL,ExpandDims:NL,Expm1:OL,FFT:$L,Fill:FL,FlipLeftRight:BL,Floor:UL,FloorDiv:zL,FromPixels:uS,FusedBatchNorm:VL,FusedConv2D:fS,FusedDepthwiseConv2D:hS,GatherNd:WL,GatherV2:HL,Greater:GL,GreaterEqual:jL,IFFT:qL,Identity:KT,Imag:XL,IsFinite:KL,IsInf:YL,IsNan:ZL,KernelBackend:$D,LRN:oN,LRNGrad:ZZ,LeakyRelu:QL,Less:JL,LessEqual:eN,LinSpace:tN,Log:nN,Log1p:rN,LogSoftmax:c4e,LogicalAnd:iN,LogicalNot:aN,LogicalOr:sN,LogicalXor:u4e,LowerBound:f4e,Max:lN,MaxPool:cN,MaxPool3D:fN,MaxPool3DGrad:JZ,MaxPoolGrad:QZ,MaxPoolWithArgmax:hN,Maximum:uN,Mean:dN,Min:pN,Minimum:mN,MirrorPad:gN,Mod:vN,MomentumOptimizer:gC,Multinomial:yN,Multiply:_N,Neg:xN,NonMaxSuppressionV3:wN,NonMaxSuppressionV4:SN,NonMaxSuppressionV5:TN,NotEqual:bN,OP_SCOPE_SUFFIX:DO,OneHot:EN,OnesLike:CN,Optimizer:Lf,OptimizerConstructors:$c,Pack:AN,PadV2:MN,Pool:h4e,Pow:kN,Prelu:RN,Prod:PN,RMSPropOptimizer:vC,RaggedGather:IN,RaggedTensorToTensor:DN,Range:LN,get Rank(){return sR},Real:NN,RealDiv:kL,Reciprocal:ON,get Reduction(){return da},Relu:$N,Relu6:zN,Reshape:FN,ResizeBilinear:UN,ResizeBilinearGrad:tQ,ResizeNearestNeighbor:BN,ResizeNearestNeighborGrad:eQ,Reverse:VN,RotateWithOffset:EO,Round:HN,Rsqrt:WN,SGDOptimizer:Y_,ScatterNd:GN,SearchSorted:jN,Select:qN,Selu:XN,Sigmoid:JN,Sign:QN,Sin:YN,Sinh:ZN,Slice:KN,Softmax:aO,Softplus:eO,SpaceToBatchND:rO,SparseFillEmptyRows:sO,SparseReshape:oO,SparseSegmentMean:lO,SparseSegmentSum:uO,SparseToDense:cO,SplitV:iO,Sqrt:tO,Square:nQ,SquaredDifference:fO,Step:CO,StridedSlice:hO,StringNGrams:dO,StringSplit:pO,StringToHashBucketFast:mO,Sub:gO,Sum:nO,Tan:vO,Tanh:yO,Tensor:dr,TensorBuffer:yg,Tile:YT,TopK:_O,Transform:xO,Transpose:s0,Unique:bO,Unpack:wO,UnsortedSegmentSum:SO,UpperBound:d4e,Variable:n_,ZerosLike:TO,_FusedMatMul:cS,abs:Ka,acos:JQ,acosh:eJ,add:Jt,addN:tJ,all:nJ,any:rJ,argMax:ZO,argMin:iJ,asin:aJ,asinh:sJ,atan:oJ,atan2:lJ,atanh:uJ,avgPool:JO,avgPool3d:fJ,backend:NQ,backend_util:Kte,basicLSTMCell:hJ,batchNorm:G_,batchNorm2d:dJ,batchNorm3d:pJ,batchNorm4d:mJ,batchToSpaceND:e3,bincount:t3,booleanMaskAsync:Kee,broadcastArgs:gJ,broadcastTo:Bm,broadcast_util:hUe,browser:yUe,buffer:ei,cast:or,ceil:vJ,clipByValue:yJ,clone:Vu,complex:Ju,concat:Zi,concat1d:_J,concat2d:xJ,concat3d:bJ,concat4d:wJ,conv1d:SJ,conv2d:j_,conv2dTranspose:CJ,conv3d:EJ,conv3dTranspose:AJ,copyRegisteredKernels:y4e,cos:MJ,cosh:kJ,cosineWindow:oC,cumprod:RJ,cumsum:PJ,customGrad:Zl,denseBincount:IJ,deprecationWarn:X5e,depthToSpace:DJ,depthwiseConv2d:tC,device_util:j4e,diag:LJ,dilation2d:NJ,disableDeprecationWarnings:q5e,dispose:$a,disposeVariables:K5e,div:Pr,divNoNan:OJ,dot:$J,dropout:ete,einsum:FJ,elu:n3,enableDebugMode:j5e,enableProdMode:G5e,enclosingPowerOfTwo:U3,engine:Cu,env:We,equal:q_,erf:BJ,euclideanNorm:VJ,exp:xf,expandDims:es,expm1:HJ,eye:a3,fft:aC,fill:Kg,findBackend:nUe,findBackendFactory:rUe,floor:s3,floorDiv:YO,fused:nte,gather:o3,gatherND:Jee,gather_util:_Ue,getBackend:DQ,getGradient:rR,getKernel:dS,getKernelsForBackend:pS,grad:TVe,grads:CVe,greater:Yg,greaterEqual:l3,ifft:c_,imag:V_,image:Rd,inTopKAsync:tte,io:UO,irfft:N3,isFinite:WJ,isInf:GJ,isNaN:jJ,keep:Ol,kernel_impls:SGe,leakyRelu:u3,less:qJ,lessEqual:nC,linalg:ote,linspace:XJ,localResponseNormalization:KJ,log:wg,log1p:c3,logSigmoid:ZJ,logSoftmax:QJ,logSumExp:h3,logicalAnd:l_,logicalNot:d3,logicalOr:p3,logicalXor:JJ,losses:lte,lowerBound:eee,matMul:nr,math:fUe,max:od,maxPool:m3,maxPool3d:tee,maxPoolWithArgmax:nee,maximum:g3,mean:u_,memory:Y5e,meshgrid:ree,min:_S,minimum:v3,mirrorPad:y3,mod:iee,moments:aee,movingAverage:Yee,mul:St,multiRNNCell:see,multinomial:oee,neg:zl,nextFrame:fte,norm:X_,notEqual:_3,oneHot:i_,ones:Zc,onesLike:lee,op:Te,outerProduct:uee,pad:Kd,pad1d:cee,pad2d:fee,pad3d:x3,pad4d:hee,pool:dee,pow:bg,prelu:w3,print:$O,prod:pee,profile:Z5e,raggedGather:mee,raggedTensorToTensor:gee,rand:vee,randomGamma:_ee,randomNormal:P3,randomStandardNormal:xee,randomUniform:I3,range:wf,ready:eUe,real:xg,reciprocal:bee,registerBackend:LQ,registerGradient:m4e,registerKernel:AO,relu:K_,relu6:D3,removeBackend:tUe,reshape:nt,reverse:Sf,reverse1d:wee,reverse2d:See,reverse3d:Tee,reverse4d:Cee,rfft:sC,round:L3,rsqrt:Eee,scalar:xn,scatterND:Zee,scatter_util:xUe,searchSorted:iC,selu:Aee,separableConv2d:Mee,serialization:CUe,setBackend:J5e,setPlatform:iUe,setdiff1dAsync:kee,sigmoid:Vl,sign:Ree,signal:ste,sin:Pee,sinh:Iee,slice:Tr,slice1d:Dee,slice2d:Lee,slice3d:Nee,slice4d:Oee,slice_util:KQ,softmax:$ee,softplus:f3,spaceToBatchND:b3,sparse:ute,sparseToDense:Qee,spectral:ate,split:Sg,sqrt:Yl,square:vo,squaredDifference:O3,squeeze:oo,stack:Ql,step:$3,stridedSlice:Fee,string:cte,sub:bn,sum:Or,sumOutType:ZT,tan:Bee,tanh:yS,tensor:go,tensor1d:lo,tensor2d:ld,tensor3d:VO,tensor4d:Uee,tensor5d:zee,tensor6d:Vee,tensor_util:z4e,test_util:NUe,tidy:tn,tile:Um,time:Q5e,topk:Hee,train:fGe,transpose:a_,truncatedNormal:Wee,unique:Gee,unregisterGradient:v4e,unregisterKernel:g4e,unsortedSegmentSum:jee,unstack:Df,upcastType:nl,upperBound:qee,util:A4e,valueAndGrad:EVe,valueAndGrads:AVe,variable:Xee,variableGrads:YJ,version_core:OUe,where:kd,whereAsync:B3,zeros:bf,zerosLike:ss},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TGe=We();TGe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Hs;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(Hs||(Hs={}));var DH;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(DH||(DH={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CGe={};function Zte(n){return CGe[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V(n,e,t,r,i){const a=e.inputParams[n];if(a&&a.inputIndexStart!==void 0){const o=a.inputIndexStart,l=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?o+1:a.inputIndexEnd;if(a.type==="tensor")return pa(e.inputNames[a.inputIndexStart],t,r,i);if(a.type==="tensors")return e.inputNames.slice(o,l).map(h=>pa(h,t,r,i));const u=pa(e.inputNames.slice(o)[0],t,r,i),c=u.dataSync();return a.type==="number"?c[0]:ad(u.shape,c)}const s=e.attrParams[n];return s&&s.value}function pa(n,e,t,r){const[i,a]=Xa(n);if(r!=null){const o=r.getHashTableHandleByName(i);if(o!=null)return o}const s=t.currentContextIds.find(o=>!!e[xS(i,o)]);return s!==void 0?e[xS(i,s)][a]:void 0}function EGe(n,e,t){return e[xS(n,t.currentContextId)]}function kl(n,e){const[t,r,i]=Xa(n);return[xS(t,e&&e.currentContextId),r,i]}function xS(n,e){return e?`${n}-${e}`:n}function Xa(n){const e=n.split(":");if(e.length===1)return[n,0,void 0];const t=e[0],r=e.length===3?e[1]:void 0,i=Number(e[e.length-1]);return[t,i,r]}function sw(n,e,t){let r=V("pad",n,e,t);if(r==="explicit"){r=V("explicitPaddings",n,e,t);const i=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)i[a][0]=r[a*2],i[a][1]=r[a*2+1];return i}return r}function Eu(n){return n.kept?n:Vu(n)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AGe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],MGe=Object.freeze(Object.defineProperty({__proto__:null,json:AGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kGe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],RGe=Object.freeze(Object.defineProperty({__proto__:null,json:kGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PGe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],IGe=Object.freeze(Object.defineProperty({__proto__:null,json:PGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DGe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],LGe=Object.freeze(Object.defineProperty({__proto__:null,json:DGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NGe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],OGe=Object.freeze(Object.defineProperty({__proto__:null,json:NGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ge=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],FGe=Object.freeze(Object.defineProperty({__proto__:null,json:$Ge},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BGe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],UGe=Object.freeze(Object.defineProperty({__proto__:null,json:BGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zGe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],VGe=Object.freeze(Object.defineProperty({__proto__:null,json:zGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HGe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],WGe=Object.freeze(Object.defineProperty({__proto__:null,json:HGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GGe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],jGe=Object.freeze(Object.defineProperty({__proto__:null,json:GGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qGe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],XGe=Object.freeze(Object.defineProperty({__proto__:null,json:qGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KGe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],YGe=Object.freeze(Object.defineProperty({__proto__:null,json:KGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZGe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],QGe=Object.freeze(Object.defineProperty({__proto__:null,json:ZGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JGe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],e8e=Object.freeze(Object.defineProperty({__proto__:null,json:JGe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],n8e=Object.freeze(Object.defineProperty({__proto__:null,json:t8e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r8e=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],i8e=Object.freeze(Object.defineProperty({__proto__:null,json:r8e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a8e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],s8e=Object.freeze(Object.defineProperty({__proto__:null,json:a8e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o8e=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],l8e=Object.freeze(Object.defineProperty({__proto__:null,json:o8e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u8e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],c8e=Object.freeze(Object.defineProperty({__proto__:null,json:u8e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LH{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[MGe,RGe,IGe,LGe,OGe,FGe,UGe,VGe,WGe,jGe,XGe,YGe,QGe,e8e,n8e,i8e,s8e,l8e,c8e],t=[].concat(...e.map(r=>r.json));this.opMappers=t.reduce((r,i)=>(r[i.tfOpName]=i,r),{})}transformGraph(e,t={}){const r=e.node,i=[],a=[],s=[],o=r.reduce((m,g)=>(m[g.name]=this.mapNode(g),g.op.startsWith("Placeholder")?i.push(m[g.name]):g.op==="Const"?a.push(m[g.name]):(g.input==null||g.input.length===0)&&s.push(m[g.name]),m),{});let l=[];const u=[];let c={},f={};t!=null&&(c=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));const h=Object.keys(o);h.forEach(m=>{const g=o[m];g.inputNames.forEach((v,_)=>{const[x,,b]=kl(v),S=o[x];if(S.outputs!=null){const T=S.outputs.indexOf(b);if(T!==-1){const M=`${x}:${T}`;g.inputNames[_]=M}}g.inputs.push(S),S.children.push(g)})}),Object.keys(f).length===0?h.forEach(m=>{const g=o[m];g.children.length===0&&u.push(g)}):Object.keys(f).forEach(m=>{const[g]=kl(m),v=o[g];v!=null&&(v.signatureKey=f[m],u.push(v))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[g]=kl(m),v=o[g];v&&(v.signatureKey=c[m],l.push(v))}):l=i;let d={};e.library!=null&&e.library.function!=null&&(d=e.library.function.reduce((m,g)=>(m[g.signature.name]=this.mapFunction(g),m),{}));const p={nodes:o,inputs:l,outputs:u,weights:a,placeholders:i,signature:t,functions:d};return s.length>0&&(p.initNodes=s),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,r)=>(t[e[r].name]=r,t),{})}mapNode(e){const t=Zte(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(r.inputParams=t.inputs.reduce((i,a)=>(i[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},i),{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce((i,a)=>{const s=a.type;let o;switch(a.type){case"string":o=wR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=wR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":o=kR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=kR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":o=TR(e.attr,a.tfName,a.defaultValue||0),o===void 0&&a.tfDeprecatedName&&(o=TR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":o=MR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=MR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":o=SR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=SR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":o=PR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=PR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":o=AR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=AR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":o=RR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=RR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":o=CR(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=CR(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":o=ER(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=ER(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":o=NH(e.attr,a.tfName,a.defaultValue),o===void 0&&a.tfDeprecatedName&&(o=NH(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return i[a.name]={value:o,type:s},i},{})),r}mapFunction(e){const t=e.nodeDef,r=[],i=[];let a={};t!=null&&(a=t.reduce((f,h)=>(f[h.name]=this.mapNode(h),h.op==="Const"&&i.push(f[h.name]),f),{}));const s=[],o=[];e.signature.inputArg.forEach(f=>{const[h]=kl(f.name),d={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:K3(f.type),type:"dtype"}},children:[]};d.signatureKey=f.name,s.push(d),a[h]=d}),Object.keys(a).forEach(f=>{const h=a[f];h.inputNames.forEach((d,p)=>{const[m,,g]=kl(d),v=a[m];if(v.outputs!=null){const _=v.outputs.indexOf(g);if(_!==-1){const x=`${m}:${_}`;h.inputNames[p]=x}}h.inputs.push(v),v.children.push(h)})});const u=e.ret;e.signature.outputArg.forEach(f=>{const[h,d]=kl(u[f.name]),p=a[h];p!=null&&(p.defaultOutput=d,o.push(p))});const c=this.mapArgsToSignature(e);return{nodes:a,inputs:s,outputs:o,weights:i,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r),t),{}),outputs:e.signature.outputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t),{})}}mapArgToTensorInfo(e,t){let r=e.name;return t!=null&&(r=t[r]),{name:r,dtype:e.type}}}function f8e(n){const e=We().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Qte(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):f8e(n);return e?t:t.toLowerCase()}function wR(n,e,t,r=!1){const i=n[e];return i!=null?Qte(i.s,r):t}function SR(n,e,t){const r=n[e];return r?r.b:t}function TR(n,e,t){const r=n[e]||{},i=r.i!=null?r.i:r.f!=null?r.f:t;return typeof i=="number"?i:parseInt(i,10)}function K3(n){switch(typeof n=="string"&&(n=Hs[n]),n){case Hs.DT_FLOAT:case Hs.DT_HALF:return"float32";case Hs.DT_INT32:case Hs.DT_INT64:case Hs.DT_INT8:case Hs.DT_UINT8:return"int32";case Hs.DT_BOOL:return"bool";case Hs.DT_DOUBLE:return"float32";case Hs.DT_STRING:return"string";default:return null}}function NH(n,e,t){const r=n[e];return r&&r.func?r.func.name:t}function CR(n,e,t){const r=n[e];return r&&r.type?K3(r.type):t}function ER(n,e,t){const r=n[e];return r&&r.list&&r.list.type?r.list.type.map(i=>K3(i)):t}function Jte(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function AR(n,e,t){const r=n[e];return r&&r.shape?Jte(r.shape):t}function MR(n,e,t){const r=n[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):t}function kR(n,e,t,r=!1){const i=n[e];return i&&i.list&&i.list.s?i.list.s.map(a=>Qte(a,r)):t}function RR(n,e,t){const r=n[e];return r&&r.list&&r.list.shape?r.list.shape.map(i=>Jte(i)):t}function PR(n,e,t){const r=n[e];return r&&r.list&&r.list.b?r.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class h8e{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(i=>this.getInput(i)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((i,a)=>(i[a]=this.getAttr(a),i),{}))}getInput(e){return pa(e,this.tensorMap,this.context)}getAttr(e,t){const r=this.node.rawAttrs[e];if(r.tensor!=null)return pa(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return TR(this.node.rawAttrs,e,t);if(r.s!=null)return wR(this.node.rawAttrs,e,t);if(r.b!=null)return SR(this.node.rawAttrs,e,t);if(r.shape!=null)return AR(this.node.rawAttrs,e,t);if(r.type!=null)return CR(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return MR(this.node.rawAttrs,e,t);if(r.list.s!=null)return kR(this.node.rawAttrs,e,t);if(r.list.shape!=null)return RR(this.node.rawAttrs,e,t);if(r.list.b!=null)return PR(this.node.rawAttrs,e,t);if(r.list.type!=null)return ER(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ji=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:DO,abs:Ka,acos:JQ,acosh:eJ,add:Jt,addN:tJ,all:nJ,any:rJ,argMax:ZO,argMin:iJ,asin:aJ,asinh:sJ,atan:oJ,atan2:lJ,atanh:uJ,avgPool:JO,avgPool3d:fJ,basicLSTMCell:hJ,batchNorm:G_,batchNorm2d:dJ,batchNorm3d:pJ,batchNorm4d:mJ,batchToSpaceND:e3,bincount:t3,booleanMaskAsync:Kee,broadcastArgs:gJ,broadcastTo:Bm,buffer:ei,cast:or,ceil:vJ,clipByValue:yJ,clone:Vu,complex:Ju,concat:Zi,concat1d:_J,concat2d:xJ,concat3d:bJ,concat4d:wJ,conv1d:SJ,conv2d:j_,conv2dTranspose:CJ,conv3d:EJ,conv3dTranspose:AJ,cos:MJ,cosh:kJ,cosineWindow:oC,cumprod:RJ,cumsum:PJ,denseBincount:IJ,depthToSpace:DJ,depthwiseConv2d:tC,diag:LJ,dilation2d:NJ,div:Pr,divNoNan:OJ,dot:$J,dropout:ete,einsum:FJ,elu:n3,enclosingPowerOfTwo:U3,equal:q_,erf:BJ,euclideanNorm:VJ,exp:xf,expandDims:es,expm1:HJ,eye:a3,fft:aC,fill:Kg,floor:s3,floorDiv:YO,fused:nte,gather:o3,gatherND:Jee,greater:Yg,greaterEqual:l3,ifft:c_,imag:V_,image:Rd,inTopKAsync:tte,irfft:N3,isFinite:WJ,isInf:GJ,isNaN:jJ,leakyRelu:u3,less:qJ,lessEqual:nC,linalg:ote,linspace:XJ,localResponseNormalization:KJ,log:wg,log1p:c3,logSigmoid:ZJ,logSoftmax:QJ,logSumExp:h3,logicalAnd:l_,logicalNot:d3,logicalOr:p3,logicalXor:JJ,losses:lte,lowerBound:eee,matMul:nr,max:od,maxPool:m3,maxPool3d:tee,maxPoolWithArgmax:nee,maximum:g3,mean:u_,meshgrid:ree,min:_S,minimum:v3,mirrorPad:y3,mod:iee,moments:aee,movingAverage:Yee,mul:St,multiRNNCell:see,multinomial:oee,neg:zl,norm:X_,notEqual:_3,oneHot:i_,ones:Zc,onesLike:lee,op:Te,outerProduct:uee,pad:Kd,pad1d:cee,pad2d:fee,pad3d:x3,pad4d:hee,pool:dee,pow:bg,prelu:w3,print:$O,prod:pee,raggedGather:mee,raggedTensorToTensor:gee,rand:vee,randomGamma:_ee,randomNormal:P3,randomStandardNormal:xee,randomUniform:I3,range:wf,real:xg,reciprocal:bee,relu:K_,relu6:D3,reshape:nt,reverse:Sf,reverse1d:wee,reverse2d:See,reverse3d:Tee,reverse4d:Cee,rfft:sC,round:L3,rsqrt:Eee,scalar:xn,scatterND:Zee,searchSorted:iC,selu:Aee,separableConv2d:Mee,setdiff1dAsync:kee,sigmoid:Vl,sign:Ree,signal:ste,sin:Pee,sinh:Iee,slice:Tr,slice1d:Dee,slice2d:Lee,slice3d:Nee,slice4d:Oee,softmax:$ee,softplus:f3,spaceToBatchND:b3,sparse:ute,sparseToDense:Qee,spectral:ate,split:Sg,sqrt:Yl,square:vo,squaredDifference:O3,squeeze:oo,stack:Ql,step:$3,stridedSlice:Fee,string:cte,sub:bn,sum:Or,tan:Bee,tanh:yS,tensor:go,tensor1d:lo,tensor2d:ld,tensor3d:VO,tensor4d:Uee,tensor5d:zee,tensor6d:Vee,tile:Um,topk:Hee,transpose:a_,truncatedNormal:Wee,unique:Gee,unsortedSegmentSum:jee,unstack:Df,upperBound:qee,variable:Xee,where:kd,whereAsync:B3,zeros:bf,zerosLike:ss},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d8e=(n,e,t,r=Ji)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(V("a",n,e,t),V("b",n,e,t))];case"AddN":return[r.addN(V("tensors",n,e,t))];case"FloorMod":case"Mod":return[r.mod(V("a",n,e,t),V("b",n,e,t))];case"Mul":return[r.mul(V("a",n,e,t),V("b",n,e,t))];case"RealDiv":case"Div":return[r.div(V("a",n,e,t),V("b",n,e,t))];case"DivNoNan":return[r.divNoNan(V("a",n,e,t),V("b",n,e,t))];case"FloorDiv":return[r.floorDiv(V("a",n,e,t),V("b",n,e,t))];case"Sub":return[r.sub(V("a",n,e,t),V("b",n,e,t))];case"Minimum":return[r.minimum(V("a",n,e,t),V("b",n,e,t))];case"Maximum":return[r.maximum(V("a",n,e,t),V("b",n,e,t))];case"Pow":return[r.pow(V("a",n,e,t),V("b",n,e,t))];case"SquaredDifference":return[r.squaredDifference(V("a",n,e,t),V("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p8e=(n,e,t,r=Ji)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(V("x",n,e,t))];case"Acos":return[r.acos(V("x",n,e,t))];case"Acosh":return[r.acosh(V("x",n,e,t))];case"Asin":return[r.asin(V("x",n,e,t))];case"Asinh":return[r.asinh(V("x",n,e,t))];case"Atan":return[r.atan(V("x",n,e,t))];case"Atan2":return[r.atan2(V("x",n,e,t),V("y",n,e,t))];case"Atanh":return[r.atanh(V("x",n,e,t))];case"Ceil":return[r.ceil(V("x",n,e,t))];case"Complex":return[r.complex(V("real",n,e,t),V("imag",n,e,t))];case"Cos":return[r.cos(V("x",n,e,t))];case"Cosh":return[r.cosh(V("x",n,e,t))];case"Elu":return[r.elu(V("x",n,e,t))];case"Erf":return[r.erf(V("x",n,e,t))];case"Exp":return[r.exp(V("x",n,e,t))];case"Expm1":return[r.expm1(V("x",n,e,t))];case"Floor":return[r.floor(V("x",n,e,t))];case"Log":return[r.log(V("x",n,e,t))];case"Log1p":return[r.log1p(V("x",n,e,t))];case"Imag":return[r.imag(V("x",n,e,t))];case"Neg":return[r.neg(V("x",n,e,t))];case"Reciprocal":return[r.reciprocal(V("x",n,e,t))];case"Real":return[r.real(V("x",n,e,t))];case"Relu":return[r.relu(V("x",n,e,t))];case"Round":return[r.round(V("x",n,e,t))];case"Selu":return[r.selu(V("x",n,e,t))];case"Sigmoid":return[r.sigmoid(V("x",n,e,t))];case"Sin":return[r.sin(V("x",n,e,t))];case"Sign":return[r.sign(V("x",n,e,t))];case"Sinh":return[r.sinh(V("x",n,e,t))];case"Softplus":return[r.softplus(V("x",n,e,t))];case"Sqrt":return[r.sqrt(V("x",n,e,t))];case"Square":return[r.square(V("x",n,e,t))];case"Tanh":return[r.tanh(V("x",n,e,t))];case"Tan":return[r.tan(V("x",n,e,t))];case"ClipByValue":return[r.clipByValue(V("x",n,e,t),V("clipValueMin",n,e,t),V("clipValueMax",n,e,t))];case"Relu6":return[r.relu6(V("x",n,e,t))];case"Rsqrt":return[r.rsqrt(pa(n.inputNames[0],e,t))];case"Prod":return[r.prod(V("x",n,e,t),V("axes",n,e,t))];case"LeakyRelu":return[r.leakyRelu(V("x",n,e,t),V("alpha",n,e,t))];case"Prelu":return[r.prelu(V("x",n,e,t),V("alpha",n,e,t))];case"IsNan":return[r.isNaN(pa(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){le(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let r=0;r<n.length;r++){const i=n[r],a=e[r];le(i<0||a<0||i===a,()=>t+` Shapes ${n} and ${e} must match`)}}}function OH(n){return!(typeof n=="number"||n.some(e=>e<0))}function oy(n,e,t){let r=IR(n,t);const i=!OH(r);if(i&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&e.forEach(a=>{r=IR(a.shape,r)}),!OH(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function IR(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let r=0;r<n.length;++r){const i=n[r],a=e[r];if(i>=0&&a>=0&&i!==a)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[r]=i>=0?i:a}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m8e{constructor(e,t,r,i,a,s,o){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=a,this.dynamicSize=s,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=xn(0),Ol(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Xs(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,Ol(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((r,i)=>this.write(r,t[i]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let i=0;i<this.size();i++)e.push(i)}if(e.length===0)return go([],[0].concat(this.elementShape));const r=this.readMany(e);return Xs(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ql(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return go([],[0].concat(this.elementShape));const t=[];for(let i=0;i<this.size();i++)t.push(i);const r=this.readMany(t);return Xs(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Zi(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Df(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0;const i=e.map(l=>(r+=l,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=r===0?0:t.size/r,s=[];tn(()=>{t=nt(t,[1,r,a]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:i[l-1],0],f=[1,e[l],a];s[l]=nt(Tr(t,c,f),this.elementShape)}return s});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,s)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Id{constructor(e,t,r,i=-1){this.tensors=e,this.elementShape=t,this.elementDtype=r,e!=null&&e.forEach(a=>{if(r!==a.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${a.dtype}`);Xs(t,a.shape,"TensorList shape mismatch: "),Ol(a)}),this.idTensor=xn(0),this.maxNumElements=i,Ol(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Id([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,r=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Xs(e,this.elementShape,"TensorList shape mismatch: ");const i=oy(this.elementShape,this.tensors,e);return tn(()=>{const a=this.tensors.map(s=>nt(s,i));return Ql(a,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=oy(this.elementShape,this.tensors,e),i=this.tensors.pop();return i.kept=!1,Xs(i.shape,e,"TensorList shape mismatch: "),nt(i,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Xs(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ol(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Id([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)t.tensors[r]=this.tensors[r];return t}getItem(e,t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Xs(this.tensors[e].shape,t,"TensorList shape mismatch: ");const i=oy(this.elementShape,this.tensors,t);return nt(this.tensors[e],i)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Xs(this.elementShape,t.shape,"TensorList shape mismatch: "),Ol(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,r){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Xs(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const i=oy(this.elementShape,this.tensors,r);return e.length===0?go([],[0].concat(i)):tn(()=>{const a=e.map(s=>nt(this.tensors[s],i));return Ql(a,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Xs(this.elementShape,t,"TensorList shape mismatch: ");const r=oy(this.elementShape,this.tensors,t);return this.size()===0?go([],[0].concat(r)):tn(()=>{const i=this.tensors.map(a=>nt(a,r));return Zi(i,0)})}}function g8e(n,e,t){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const i=n.shape.slice(1);Xs(i,e,"TensorList shape mismatch: ");const a=Df(n);return new Id(a,e,r)}function v8e(n,e,t,r){return new Id([],n,e,r)}function y8e(n,e,t,r){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const i=Math.max(...e);if(r!=null&&r!==-1&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const a=new Id([],t,n.dtype,r),s=Df(n,0);return e.forEach((o,l)=>{a.setItem(o,s[l])}),a}function _8e(n,e,t){let r=0;const i=e.map(c=>(r+=c,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);const a=n.shape.slice(1),s=IR(a,t),o=r===0?0:n.size/r,l=tn(()=>{const c=[];n=nt(n,[1,r,o]);for(let f=0;f<e.length;++f){const d=[0,f===0?0:i[f-1],0],p=[1,e[f],o];c[f]=nt(Tr(n,d,p),s)}return n.dispose(),c}),u=new Id([],t,n.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8e=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const r=V("thenBranch",n,e,t),i=V("elseBranch",n,e,t),a=V("cond",n,e,t),s=V("args",n,e,t);return(await a.data())[0]?t.functionMap[r].executeFunctionAsync(s,t.tensorArrayMap,t.tensorListMap):t.functionMap[i].executeFunctionAsync(s,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const r=V("body",n,e,t),i=V("cond",n,e,t),a=V("args",n,e,t),s=await t.functionMap[i].executeFunctionAsync(a,t.tensorArrayMap,t.tensorListMap),o=a.map(c=>c.id);let l=await s[0].data();s.forEach(c=>{!c.kept&&o.indexOf(c.id)===-1&&c.dispose()});let u=a;for(;l[0];){const c=u;u=await t.functionMap[r].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);const f=u.map(d=>d.id);c.forEach(d=>{!d.kept&&o.indexOf(d.id)===-1&&f.indexOf(d.id)===-1&&d.dispose()});const h=await t.functionMap[i].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);l=await h[0].data(),h.forEach(d=>{!d.kept&&o.indexOf(d.id)===-1&&f.indexOf(d.id)===-1&&d.dispose()})}return u}case"LoopCond":{const r=V("pred",n,e,t);return[Eu(r)]}case"Switch":{const r=V("pred",n,e,t);let i=V("data",n,e,t);return i.kept||(i=Eu(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=n.inputNames.find(i=>pa(i,e,t)!==void 0);if(r){const i=pa(r,e,t);return[Eu(i)]}return}case"Enter":{const r=V("frameName",n,e,t),i=V("tensor",n,e,t);return t.enterFrame(r),[Eu(i)]}case"Exit":{const r=V("tensor",n,e,t);return t.exitFrame(),[Eu(r)]}case"NextIteration":{const r=V("tensor",n,e,t);return t.nextIteration(),[Eu(r)]}case"TensorArrayV3":{const r=V("size",n,e,t),i=V("dtype",n,e,t),a=V("elementShape",n,e,t),s=V("dynamicSize",n,e,t),o=V("clearAfterRead",n,e,t),l=V("identicalElementShapes",n,e,t),u=V("name",n,e,t),c=new m8e(u,i,r,a,l,s,o);return t.addTensorArray(c),[c.idTensor,xn(1)]}case"TensorArrayWriteV3":{const r=V("tensorArrayId",n,e,t),i=V("index",n,e,t),a=V("tensor",n,e,t),s=t.getTensorArray(r.id);return s.write(i,a),[s.idTensor]}case"TensorArrayReadV3":{const r=V("tensorArrayId",n,e,t),i=V("index",n,e,t);return[t.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=V("tensorArrayId",n,e,t),i=V("indices",n,e,t),a=V("dtype",n,e,t);return[t.getTensorArray(r.id).gather(i,a)]}case"TensorArrayScatterV3":{const r=V("tensorArrayId",n,e,t),i=V("indices",n,e,t),a=V("tensor",n,e,t),s=t.getTensorArray(r.id);return s.scatter(i,a),[s.idTensor]}case"TensorArrayConcatV3":{const r=V("tensorArrayId",n,e,t),i=t.getTensorArray(r.id),a=V("dtype",n,e,t);return[i.concat(a)]}case"TensorArraySplitV3":{const r=V("tensorArrayId",n,e,t),i=V("tensor",n,e,t),a=V("lengths",n,e,t),s=t.getTensorArray(r.id);return s.split(a,i),[s.idTensor]}case"TensorArraySizeV3":{const r=V("tensorArrayId",n,e,t),i=t.getTensorArray(r.id);return[xn(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=V("tensorArrayId",n,e,t),i=t.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=V("tensorListId",n,e,t),i=V("index",n,e,t),a=V("tensor",n,e,t),s=t.getTensorList(r.id);return s.setItem(i,a),[s.idTensor]}case"TensorListGetItem":{const r=V("tensorListId",n,e,t),i=V("index",n,e,t),a=V("elementShape",n,e,t),s=V("elementDType",n,e,t);return[t.getTensorList(r.id).getItem(i,a,s)]}case"TensorListScatterV2":case"TensorListScatter":{const r=V("indices",n,e,t),i=V("tensor",n,e,t),a=V("elementShape",n,e,t),s=V("numElements",n,e,t),o=y8e(i,r,a,s);return t.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=V("elementShape",n,e,t),i=V("elementDType",n,e,t);let a;n.op==="TensorListReserve"?a="numElements":a="maxNumElements";const s=V(a,n,e,t),o=n.op==="TensorListReserve"?-1:s,l=v8e(r,i,s,o);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=V("tensorListId",n,e,t),i=V("indices",n,e,t),a=V("elementShape",n,e,t),s=V("elementDType",n,e,t);return[t.getTensorList(r.id).gather(i,s,a)]}case"TensorListStack":{const r=V("tensorListId",n,e,t),i=V("elementShape",n,e,t),a=V("elementDType",n,e,t),s=V("numElements",n,e,t);return[t.getTensorList(r.id).stack(i,a,s)]}case"TensorListFromTensor":{const r=V("tensor",n,e,t),i=V("elementShape",n,e,t),a=V("elementDType",n,e,t),s=g8e(r,i,a);return t.addTensorList(s),[s.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=V("tensorListId",n,e,t),i=t.getTensorList(r.id),a=V("dtype",n,e,t),s=V("elementShape",n,e,t);return[i.concat(a,s)]}case"TensorListPushBack":{const r=V("tensorListId",n,e,t),i=V("tensor",n,e,t),a=t.getTensorList(r.id);return a.pushBack(i),[a.idTensor]}case"TensorListPopBack":{const r=V("tensorListId",n,e,t),i=V("elementShape",n,e,t),a=V("elementDType",n,e,t);return[t.getTensorList(r.id).popBack(i,a)]}case"TensorListSplit":{const r=V("tensor",n,e,t),i=V("elementShape",n,e,t),a=V("lengths",n,e,t),s=_8e(r,a,i);return t.addTensorList(s),[s.idTensor]}case"TensorListLength":{const r=V("tensorListId",n,e,t),i=t.getTensorList(r.id);return[xn(i.size(),"int32")]}case"TensorListResize":{const r=V("tensorListId",n,e,t),i=V("size",n,e,t),s=t.getTensorList(r.id).resize(i);return t.addTensorList(s),[s.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(n,e,t){const[r,i]=V("fusedOps",n,e,t),a=r==="biasadd",s=!a,o=i==="prelu",l=r==="fusedbatchnorm",u=V("numArgs",n,e,t);if(a){if(o&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&a&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=V("strides",n,e,t),f=sw(n,e,t),h=V("dataFormat",n,e,t).toUpperCase(),d=V("dilations",n,e,t);let[p,m]=V("args",n,e,t);s&&(m=p,p=void 0);const g=V("leakyreluAlpha",n,e,t);return{stride:c,pad:f,dataFormat:h,dilations:d,biasArg:p,preluArg:m,activationFunc:i,leakyreluAlpha:g}}const b8e=(n,e,t,r=Ji)=>{switch(n.op){case"Conv1D":{const i=V("stride",n,e,t),a=V("pad",n,e,t),s=V("dataFormat",n,e,t).toUpperCase(),o=V("dilation",n,e,t);return[r.conv1d(V("x",n,e,t),V("filter",n,e,t),i,a,s,o)]}case"Conv2D":{const i=V("strides",n,e,t),a=sw(n,e,t),s=V("dataFormat",n,e,t).toUpperCase(),o=V("dilations",n,e,t);return[r.conv2d(V("x",n,e,t),V("filter",n,e,t),[i[1],i[2]],a,s,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:i,pad:a,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:f}=$H(n,e,t);return[r.fused.conv2d({x:V("x",n,e,t),filter:V("filter",n,e,t),strides:[i[1],i[2]],pad:a,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:a,dataFormat:s,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:f}=$H(n,e,t);return[r.fused.depthwiseConv2d({x:V("x",n,e,t),filter:V("filter",n,e,t),strides:[i[1],i[2]],pad:a,dataFormat:s,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=V("outputShape",n,e,t),a=V("strides",n,e,t),s=sw(n,e,t);return[r.conv2dTranspose(V("x",n,e,t),V("filter",n,e,t),i,[a[1],a[2]],s)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=V("strides",n,e,t),a=sw(n,e,t),s=V("dilations",n,e,t),o=V("dataFormat",n,e,t).toUpperCase();return[r.depthwiseConv2d(V("input",n,e,t),V("filter",n,e,t),[i[1],i[2]],a,o,[s[1],s[2]])]}case"Conv3D":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("dataFormat",n,e,t).toUpperCase(),o=V("dilations",n,e,t);return[r.conv3d(V("x",n,e,t),V("filter",n,e,t),[i[1],i[2],i[3]],a,s,[o[1],o[2],o[3]])]}case"AvgPool":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("kernelSize",n,e,t);return[r.avgPool(V("x",n,e,t),[s[1],s[2]],[i[1],i[2]],a)]}case"MaxPool":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("kernelSize",n,e,t);return[r.maxPool(V("x",n,e,t),[s[1],s[2]],[i[1],i[2]],a)]}case"MaxPoolWithArgmax":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("kernelSize",n,e,t),o=V("includeBatchInIndex",n,e,t),{result:l,indexes:u}=r.maxPoolWithArgmax(V("x",n,e,t),[s[1],s[2]],[i[1],i[2]],a,o);return[l,u]}case"AvgPool3D":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("kernelSize",n,e,t);return[r.avgPool3d(V("x",n,e,t),[s[1],s[2],s[3]],[i[1],i[2],i[3]],a)]}case"MaxPool3D":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("kernelSize",n,e,t);return[r.maxPool3d(V("x",n,e,t),[s[1],s[2],s[3]],[i[1],i[2],i[3]],a)]}case"Dilation2D":{const i=V("strides",n,e,t),a=V("pad",n,e,t),s=V("dilations",n,e,t),o=i[1],l=i[2],u=s[1],c=s[2];return[r.dilation2d(V("x",n,e,t),V("filter",n,e,t),[o,l],a,[u,c],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8e=(n,e,t,r=Ji)=>{switch(n.op){case"Fill":{const i=V("shape",n,e,t),a=V("dtype",n,e,t),s=V("value",n,e,t);return[r.fill(i,s,a)]}case"LinSpace":{const i=V("start",n,e,t),a=V("stop",n,e,t),s=V("num",n,e,t);return[r.linspace(i,a,s)]}case"Multinomial":{const i=V("logits",n,e,t),a=V("numSamples",n,e,t),s=V("seed",n,e,t);return[r.multinomial(i,a,s)]}case"OneHot":{const i=V("indices",n,e,t),a=V("depth",n,e,t),s=V("onValue",n,e,t),o=V("offValue",n,e,t),l=V("dtype",n,e,t);return[r.oneHot(i,a,s,o,l)]}case"Ones":return[r.ones(V("shape",n,e,t),V("dtype",n,e,t))];case"OnesLike":return[r.onesLike(V("x",n,e,t))];case"RandomStandardNormal":return[r.randomStandardNormal(V("shape",n,e,t),V("dtype",n,e,t),V("seed",n,e,t))];case"RandomUniform":return[r.randomUniform(V("shape",n,e,t),V("minval",n,e,t),V("maxval",n,e,t),V("dtype",n,e,t))];case"Range":{const i=V("start",n,e,t),a=V("stop",n,e,t),s=V("step",n,e,t);return[r.range(i,a,s,V("dtype",n,e,t))]}case"TruncatedNormal":{const i=V("shape",n,e,t),a=V("mean",n,e,t),s=V("stdDev",n,e,t),o=V("seed",n,e,t);return[r.truncatedNormal(i,a,s,V("dtype",n,e,t),o)]}case"Zeros":return[r.zeros(V("shape",n,e,t),V("dtype",n,e,t))];case"ZerosLike":return[r.zerosLike(V("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xA(n,e,t){const r=V("boxes",n,e,t),i=V("scores",n,e,t),a=V("maxOutputSize",n,e,t),s=V("iouThreshold",n,e,t),o=V("scoreThreshold",n,e,t),l=V("softNmsSigma",n,e,t);return{boxes:r,scores:i,maxOutputSize:a,iouThreshold:s,scoreThreshold:o,softNmsSigma:l}}const S8e=async(n,e,t,r,i=Ji)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=xA(n,e,t),f=await i.image.nonMaxSuppressionWithScoreAsync(a,s,o,l,u,c);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=xA(n,e,t),c=V("padToMaxOutputSize",n,e,t),f=await i.image.nonMaxSuppressionPaddedAsync(a,s,o,l,u,c);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:s,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=xA(n,e,t);return[await i.image.nonMaxSuppressionAsync(a,s,o,l,u)]}case"Where":{const a=i.cast(V("condition",n,e,t),"bool"),s=[await i.whereAsync(a)];return a.dispose(),s}case"ListDiff":return i.setdiff1dAsync(V("x",n,e,t),V("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8e=(n,e,t,r=Ji)=>{switch(n.op){case"LowerBound":{const i=V("sortedSequence",n,e,t),a=V("values",n,e,t);return[r.lowerBound(i,a)]}case"TopKV2":{const i=V("x",n,e,t),a=V("k",n,e,t),s=V("sorted",n,e,t),o=r.topk(i,a,s);return[o.values,o.indices]}case"UpperBound":{const i=V("sortedSequence",n,e,t),a=V("values",n,e,t);return[r.upperBound(i,a)]}case"Unique":{const i=V("x",n,e,t),a=r.unique(i);return[a.values,a.indices]}case"UniqueV2":{const i=V("x",n,e,t),a=V("axis",n,e,t),s=r.unique(i,a);return[s.values,s.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8e=(n,e,t,r=Ji)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const i=V("default",n,e,t);return[pa(n.name,e,t)||i];case"Placeholder":return[pa(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=V("x",n,e,t);return[Eu(c)]}case"IdentityN":return V("x",n,e,t).map(c=>Eu(c));case"Snapshot":const a=V("x",n,e,t);return[Eu(a)];case"Shape":return[r.tensor1d(V("x",n,e,t).shape,"int32")];case"ShapeN":return V("x",n,e,t).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(V("x",n,e,t).size,"int32")];case"Rank":return[r.scalar(V("x",n,e,t).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const s=V("x",n,e,t),o=V("data",n,e,t),l=V("message",n,e,t),u=V("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[s];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E8e{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=xn(0),this.tensorMap=new Map,Ol(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return xn(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),tn(()=>{const i=Df(t),a=r.length,s=i.length;le(a===s,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${s} elements.`);for(let o=0;o<a;o++){const l=r[o],u=i[o];Ol(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return tn(()=>{const i=[];for(let a=0;a<r.length;a++){const s=r[a],o=this.findWithDefault(s,t);i.push(o)}return Ql(i)})}findWithDefault(e,t){const r=this.tensorMap.get(e);return r??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8e=async(n,e,t,r)=>{switch(n.op){case"HashTable":case"HashTableV2":{const i=V("keyDType",n,e,t),a=V("valueDType",n,e,t),s=new E8e(i,a);return r.addHashTable(n.name,s),[s.handle]}case"LookupTableImport":case"LookupTableImportV2":{const i=V("tableHandle",n,e,t,r),a=V("keys",n,e,t),s=V("values",n,e,t);return[await r.getHashTableById(i.id).import(a,s)]}case"LookupTableFind":case"LookupTableFindV2":{const i=V("tableHandle",n,e,t,r),a=V("keys",n,e,t),s=V("defaultValue",n,e,t);return[await r.getHashTableById(i.id).find(a,s)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=V("tableHandle",n,e,t,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8e=(n,e,t,r=Ji)=>{switch(n.op){case"ResizeBilinear":{const i=V("images",n,e,t),a=V("size",n,e,t),s=V("alignCorners",n,e,t),o=V("halfPixelCenters",n,e,t);return[r.image.resizeBilinear(i,[a[0],a[1]],s,o)]}case"ResizeNearestNeighbor":{const i=V("images",n,e,t),a=V("size",n,e,t),s=V("alignCorners",n,e,t),o=V("halfPixelCenters",n,e,t);return[r.image.resizeNearestNeighbor(i,[a[0],a[1]],s,o)]}case"CropAndResize":{const i=V("image",n,e,t),a=V("boxes",n,e,t),s=V("boxInd",n,e,t),o=V("cropSize",n,e,t),l=V("method",n,e,t),u=V("extrapolationValue",n,e,t);return[r.image.cropAndResize(i,a,s,o,l,u)]}case"ImageProjectiveTransformV3":{const i=V("images",n,e,t),a=V("transforms",n,e,t),s=V("outputShape",n,e,t),o=V("fillValue",n,e,t),l=V("interpolation",n,e,t),u=V("fillMode",n,e,t);return[r.image.transform(i,a,l.toLowerCase(),u.toLowerCase(),o,s)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8e=(n,e,t,r=Ji)=>{switch(n.op){case"Equal":return[r.equal(V("a",n,e,t),V("b",n,e,t))];case"NotEqual":return[r.notEqual(V("a",n,e,t),V("b",n,e,t))];case"Greater":return[r.greater(V("a",n,e,t),V("b",n,e,t))];case"GreaterEqual":return[r.greaterEqual(V("a",n,e,t),V("b",n,e,t))];case"Less":return[r.less(V("a",n,e,t),V("b",n,e,t))];case"LessEqual":return[r.lessEqual(V("a",n,e,t),V("b",n,e,t))];case"LogicalAnd":return[r.logicalAnd(V("a",n,e,t),V("b",n,e,t))];case"LogicalNot":return[r.logicalNot(V("a",n,e,t))];case"LogicalOr":return[r.logicalOr(V("a",n,e,t),V("b",n,e,t))];case"Select":case"SelectV2":return[r.where(V("condition",n,e,t),V("a",n,e,t),V("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8e=(n,e,t,r=Ji)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(V("a",n,e,t),V("b",n,e,t),V("transposeA",n,e,t),V("transposeB",n,e,t))];case"Einsum":return[r.einsum(V("equation",n,e,t),...V("tensors",n,e,t))];case"Transpose":return[r.transpose(V("x",n,e,t),V("perm",n,e,t))];case"_FusedMatMul":const[i,a]=V("fusedOps",n,e,t),s=i==="biasadd",o=a==="prelu",l=V("numArgs",n,e,t),u=V("leakyreluAlpha",n,e,t);if(s){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,f]=V("args",n,e,t);return[r.fused.matMul({a:V("a",n,e,t),b:V("b",n,e,t),transposeA:V("transposeA",n,e,t),transposeB:V("transposeB",n,e,t),bias:c,activation:a,preluActivationWeights:f,leakyreluAlpha:u})];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P8e=(n,e,t,r=Ji)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(V("x",n,e,t),V("axis",n,e,t),V("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(V("x",n,e,t),V("mean",n,e,t),V("variance",n,e,t),V("offset",n,e,t),V("scale",n,e,t),V("epsilon",n,e,t))];case"FusedBatchNormV3":return[r.batchNorm(V("x",n,e,t),V("mean",n,e,t),V("variance",n,e,t),V("offset",n,e,t),V("scale",n,e,t),V("epsilon",n,e,t))];case"LRN":return[r.localResponseNormalization(V("x",n,e,t),V("radius",n,e,t),V("bias",n,e,t),V("alpha",n,e,t),V("beta",n,e,t))];case"Softmax":return[r.softmax(V("x",n,e,t))];case"LogSoftmax":return[r.logSoftmax(V("x",n,e,t))];case"SparseToDense":return[r.sparseToDense(V("sparseIndices",n,e,t),V("outputShape",n,e,t),V("sparseValues",n,e,t),V("defaultValue",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I8e=(n,e,t,r=Ji)=>{switch(n.op){case"Max":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.max(V("x",n,e,t),o,l)]}case"Mean":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.mean(V("x",n,e,t),o,l)]}case"Min":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.min(V("x",n,e,t),o,l)]}case"Sum":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.sum(V("x",n,e,t),o,l)]}case"All":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.all(V("x",n,e,t),o,l)]}case"Any":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.any(V("x",n,e,t),o,l)]}case"ArgMax":{const o=V("axis",n,e,t);return[r.argMax(V("x",n,e,t),o)]}case"ArgMin":{const o=V("axis",n,e,t);return[r.argMin(V("x",n,e,t),o)]}case"Prod":{const o=V("axis",n,e,t),l=V("keepDims",n,e,t);return[r.prod(V("x",n,e,t),o,l)]}case"Cumprod":{const o=V("axis",n,e,t),l=V("exclusive",n,e,t),u=V("reverse",n,e,t);return[r.cumprod(V("x",n,e,t),o,l,u)]}case"Cumsum":{const o=V("axis",n,e,t),l=V("exclusive",n,e,t),u=V("reverse",n,e,t);return[r.cumsum(V("x",n,e,t),o,l,u)]}case"Bincount":const i=V("x",n,e,t),a=V("weights",n,e,t),s=V("size",n,e,t);return[r.bincount(i,a,s)];case"DenseBincount":{const o=V("x",n,e,t),l=V("weights",n,e,t),u=V("size",n,e,t),c=V("binaryOutput",n,e,t);return[r.denseBincount(o,l,u,c)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8e=(n,e,t,r=Ji)=>{switch(n.op){case"ConcatV2":case"Concat":{const i=V("n",n,e,t),a=V("axis",n,e,t);let s=V("tensors",n,e,t);return s=s.slice(0,i),[r.concat(s,a)]}case"Gather":{const i=V("x",n,e,t),a=V("indices",n,e,t);return[r.gather(i,r.cast(a,"int32"),0)]}case"GatherV2":{const i=V("axis",n,e,t),a=V("batchDims",n,e,t),s=V("x",n,e,t),o=V("indices",n,e,t);return[r.gather(s,r.cast(o,"int32"),i,a)]}case"Reverse":{const i=V("dims",n,e,t),a=[];for(let o=0;o<i.length;o++)i[o]&&a.push(o);const s=V("x",n,e,t);return[r.reverse(s,a)]}case"ReverseV2":{const i=V("axis",n,e,t),a=V("x",n,e,t);return[r.reverse(a,i)]}case"Slice":{const i=V("begin",n,e,t),a=V("size",n,e,t);return[r.slice(V("x",n,e,t),i,a)]}case"StridedSlice":{const i=V("begin",n,e,t),a=V("end",n,e,t),s=V("strides",n,e,t),o=V("beginMask",n,e,t),l=V("endMask",n,e,t),u=V("ellipsisMask",n,e,t),c=V("newAxisMask",n,e,t),f=V("shrinkAxisMask",n,e,t),h=V("x",n,e,t);return[r.stridedSlice(h,i,a,s,o,l,u,c,f)]}case"Pack":return tn(()=>{const i=V("axis",n,e,t),a=V("tensors",n,e,t),s=a[0].shape,o=r.squeeze(a[0]).shape,l=a.map(u=>{const c=Jr(u.shape,s);if(!c&&!Jr(r.squeeze(u).shape,o))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,s)});return[r.stack(l,i)]});case"Unpack":{const i=V("axis",n,e,t),a=V("tensor",n,e,t);return r.unstack(a,i)}case"Tile":{const i=V("reps",n,e,t);return[r.tile(V("x",n,e,t),i)]}case"Split":case"SplitV":{const i=V("axis",n,e,t),a=V("numOrSizeSplits",n,e,t),s=V("x",n,e,t);return r.split(s,a,i)}case"ScatterNd":{const i=V("indices",n,e,t),a=V("values",n,e,t),s=V("shape",n,e,t);return[r.scatterND(i,a,s)]}case"GatherNd":{const i=V("x",n,e,t),a=V("indices",n,e,t);return[r.gatherND(i,a)]}case"SparseToDense":{const i=V("sparseIndices",n,e,t),a=V("outputShape",n,e,t),s=V("sparseValues",n,e,t),o=V("defaultValue",n,e,t);return[r.sparseToDense(i,s,a,s.dtype===o.dtype?o:r.cast(o,s.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L8e=(n,e,t,r=Ji)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:a,emptyRowIndicator:s,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(V("indices",n,e,t),V("values",n,e,t),V("denseShape",n,e,t),V("defaultValue",n,e,t));return[i,a,s,o]}case"SparseReshape":{const{outputIndices:i,outputShape:a}=r.sparse.sparseReshape(V("inputIndices",n,e,t),V("inputShape",n,e,t),V("newShape",n,e,t));return[i,a]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(V("data",n,e,t),V("indices",n,e,t),V("segmentIds",n,e,t))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(V("data",n,e,t),V("indices",n,e,t),V("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8e=(n,e,t,r=Ji)=>{switch(n.op){case"FFT":return[r.fft(V("x",n,e,t))];case"IFFT":return[r.ifft(V("x",n,e,t))];case"RFFT":return[r.rfft(V("x",n,e,t))];case"IRFFT":return[r.irfft(V("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8e=(n,e,t,r=Ji)=>{switch(n.op){case"StringNGrams":{const{nGrams:i,nGramsSplits:a}=r.string.stringNGrams(V("data",n,e,t),V("dataSplits",n,e,t),V("separator",n,e,t),V("nGramWidths",n,e,t),V("leftPad",n,e,t),V("rightPad",n,e,t),V("padWidth",n,e,t),V("preserveShortSequences",n,e,t));return[i,a]}case"StringSplit":{const{indices:i,values:a,shape:s}=r.string.stringSplit(V("input",n,e,t),V("delimiter",n,e,t),V("skipEmpty",n,e,t));return[i,a,s]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(V("input",n,e,t),V("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $8e=(n,e,t,r=Ji)=>{switch(n.op){case"Cast":return[r.cast(V("x",n,e,t),V("dtype",n,e,t))];case"ExpandDims":{const i=V("axis",n,e,t);return[r.expandDims(V("x",n,e,t),i)]}case"Squeeze":{const i=V("axis",n,e,t);return[r.squeeze(V("x",n,e,t),i)]}case"Reshape":return[r.reshape(V("x",n,e,t),V("shape",n,e,t))];case"MirrorPad":return[r.mirrorPad(V("x",n,e,t),V("padding",n,e,t),V("mode",n,e,t))];case"PadV2":case"Pad":return[r.pad(V("x",n,e,t),V("padding",n,e,t),V("constantValue",n,e,t))];case"SpaceToBatchND":{const i=V("blockShape",n,e,t),a=V("paddings",n,e,t);return[r.spaceToBatchND(V("x",n,e,t),i,a)]}case"BatchToSpaceND":{const i=V("blockShape",n,e,t),a=V("crops",n,e,t);return[r.batchToSpaceND(V("x",n,e,t),i,a)]}case"DepthToSpace":{const i=V("blockSize",n,e,t),a=V("dataFormat",n,e,t).toUpperCase();return[r.depthToSpace(V("x",n,e,t),i,a)]}case"BroadcastTo":return[r.broadcastTo(V("x",n,e,t),V("shape",n,e,t))];case"BroadcastArgs":return[r.broadcastArgs(V("s0",n,e,t),V("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(n,e,t,r,i=tn){const a=((s,o,l)=>{switch(s.category){case"arithmetic":return i(()=>d8e(s,o,l));case"basic_math":return i(()=>p8e(s,o,l));case"control":return x8e(s,o,l);case"convolution":return i(()=>b8e(s,o,l));case"creation":return i(()=>w8e(s,o,l));case"dynamic":return S8e(s,o,l);case"evaluation":return i(()=>T8e(s,o,l));case"image":return i(()=>M8e(s,o,l));case"graph":return i(()=>C8e(s,o,l));case"logical":return i(()=>k8e(s,o,l));case"matrices":return i(()=>R8e(s,o,l));case"normalization":return i(()=>P8e(s,o,l));case"reduction":return i(()=>I8e(s,o,l));case"slice_join":return i(()=>D8e(s,o,l));case"sparse":return i(()=>L8e(s,o,l));case"spectral":return i(()=>N8e(s,o,l));case"string":return i(()=>O8e(s,o,l));case"transformation":return i(()=>$8e(s,o,l));case"hash_table":return A8e(s,o,l,r);case"custom":const u=Zte(s.op);if(u&&u.customExecutor)return u.customExecutor(new h8e(s,o,l));throw TypeError(`Custom op ${s.op} is not registered.`);default:throw TypeError(`Unknown op '${s.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Td(a)?a.then(s=>[].concat(s)):[].concat(a)}class BH{constructor(e={},t={},r={},i={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=i,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(n,e,t,r){const i=new Set,a=[];let s=null,o=null;const l=new Set,u=Object.keys(n).map(h=>Xa(h)[0]);let c=[];r!=null&&(c=r.map(h=>Xa(h.name)[0]));const f=[...e];for(;f.length>0;){const h=f.pop();if((ene(h)||V8e(h)||H8e(h))&&s==null&&(s=h,o=s.children.map(d=>d.name).filter(d=>i.has(d))),i.add(h.name),t[h.name]==null&&u.indexOf(h.name)===-1&&c.indexOf(h.name)===-1){if(h.inputs.length===0){a.push(h.name);continue}h.inputs.forEach(d=>{l.has(d.name)||(l.add(d.name),f.push(d))})}}return{inputs:n,outputs:e,usedNodes:i,missingInputs:a,dynamicNode:s,syncInputs:o}}function F8e(n,e,t){const{usedNodes:r,inputs:i}=t,a=[],s=Object.keys(i).map(c=>Xa(c)[0]).map(c=>n.nodes[c]),o=n.initNodes;s.forEach(c=>{r.has(c.name)&&a.push(c)}),n.weights.forEach(c=>{r.has(c.name)&&a.push(c)}),o!=null&&o.forEach(c=>{r.has(c.name)&&a.push(c)});const l=new Set,u=[];for(;a.length>0;){const c=a.pop();l.add(c.name),e[c.name]||u.push(c),c.children.forEach(f=>{!l.has(f.name)&&r.has(f.name)&&f.inputs.every(h=>l.has(h.name))&&a.push(f)})}return u}const B8e=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],U8e=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],z8e=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function ene(n){return B8e.indexOf(n.op)>=0}function V8e(n){return U8e.indexOf(n.op)>=0}function H8e(n){return z8e.indexOf(n.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bS{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new bS(e.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(r=>e[r].map(i=>i.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const r=e.map(a=>a.name).sort(),i=t.map(a=>a.name).sort();return r.join(this.SEPERATOR)+"--"+i.join(this.SEPERATOR)}compile(e,t){const r=UH(e,t,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:a,syncInputs:s}=r;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${s}]`);if(i.length>0){const o=t.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${o}] from the provided inputs [${l}]. Missing the following inputs: [${i}]`)}return F8e(this.graph,this.weightMap,r)}execute(e,t){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const i=r.map(f=>this.graph.nodes[Xa(f)[0]]),a=t.map(f=>Xa(f)[0]);let s=a.map(f=>this.graph.nodes[f]);this.resetIntermediateTensors(),s.length===0&&(s=this._outputs);const o=this.getCompilationKey(i,s);let l=this.compiledMap.get(o);l==null&&(l=this.compile(e,s),this.compiledMap.set(o,l));const u={},c={};return tn(()=>{const f=new BH(this.weightMap,u,c,this.functionExecutorMap),h=Object.assign({},this.weightMap);Object.keys(e).forEach(m=>{const[g,v]=Xa(m),_=[];_[v]=e[m],h[g]=_});const d=this.getFrozenTensorIds(h),p={};for(let m=0;m<l.length;m++){const g=l[m];if(!h[g.name]){const v=FH(g,h,f,this._resourceManager);if(Td(v))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);h[g.name]=v,this.checkTensorForDisposal(g.name,g,h,f,d,a,p)}}return this.parent==null&&f.dispose(d),t.map(m=>pa(m,h,f))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(i=>i.id)));return new Set(t)}checkTensorForDisposal(e,t,r,i,a,s,o){t.category==="control"||s.indexOf(e)!==-1||(r[e].forEach(l=>{l!=null&&(o[l.id]=(o[l.id]||0)+t.children.length)}),t.inputs.forEach(l=>{if(l.category!=="control"){const u=EGe(l.name,r,i);u!=null&&u.forEach(c=>{if(c&&!c.kept&&!a.has(c.id)){const f=o[c.id];if(f===1){if(!this.keepTensorForDebug)c.dispose();else{const[h,d]=kl(t.name,i);this.intermediateTensors[h]?this.intermediateTensors[h][d]=c:(this.intermediateTensors[h]=[],this.intermediateTensors[h][d]=c)}delete o[c.id]}else f!=null&&o[c.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(r=>{r&&!r.kept&&!r.isDisposed&&!this.keepIds.has(r.id)&&r.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,r=!1,i={},a={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=We().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(c){console.warn(c.message)}this.resetIntermediateTensors();const s=new BH(this.weightMap,i,a,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,s,t,r);const o=t.map(c=>pa(c,this.tensorsMap,s)),l=o.map(c=>c.id),u=Object.keys(e).map(c=>e[c].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&s.dispose(this.keepIds),o}async executeFunctionAsync(e,t,r){const i=e.reduce((a,s,o)=>(a[this.inputs[o].name]=s,a),{});return this._executeAsync(i,this.outputNodes,!0,t,r)}async executeWithControlFlow(e,t,r,i){const a=Object.keys(e),s=a.map(x=>this.graph.nodes[Xa(x)[0]]),o=r.map(x=>Xa(x)[0]);let l=o.map(x=>this.graph.nodes[x]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:f,syncInputs:h}=UH(e,l,this.weightMap,this._initNodes),d=[...s,...this.graph.weights,...this._initNodes||[]].map(x=>({node:x,contexts:t.currentContext})),p=Object.assign({},this.weightMap);Object.keys(e).forEach(x=>{const[b,S]=Xa(x),T=[];T[S]=e[x],p[b]=T});const m={},g=this.getFrozenTensorIds(p),v={};for(;d.length>0;){const x=this.processStack(s,d,t,p,v,g,o,m,u);await Promise.all(x)}f==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const _=l.filter(x=>!ene(x)&&!pa(x.name,p,t)).map(x=>x.name);if(_.length>0){let x="";throw f!=null&&(x=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${_}] from the provided inputs [${a}]. Consider providing the following inputs: [${c}]. ${x}`)}return p}processStack(e,t,r,i,a,s,o,l,u){const c=[];for(;t.length>0;){const f=t.pop();r.currentContext=f.contexts;let h="";if(f.node.op==="Enter"&&V("isConstant",f.node,i,r)&&([h]=kl(f.node.name,r)),i[f.node.name]==null){const d=FH(f.node,i,r,this._resourceManager);h||([h]=kl(f.node.name,r));const p=r.currentContext;Td(d)?c.push(d.then(m=>(i[h]=m,r.currentContext=p,this.checkTensorForDisposal(h,f.node,i,r,s,o,l),this.processChildNodes(f.node,t,r,i,a,u),m))):(i[h]=d,this.checkTensorForDisposal(h,f.node,i,r,s,o,l),this.processChildNodes(f.node,t,r,i,a,u))}else this.processChildNodes(f.node,t,r,i,a,u)}return c}processChildNodes(e,t,r,i,a,s){e.children.forEach(o=>{const[l]=kl(o.name,r);a[l]||!s.has(o.name)||(o.op==="Merge"?o.inputNames.some(u=>!!pa(u,i,r))&&(a[l]=!0,t.push({contexts:r.currentContext,node:o})):o.inputNames.every(u=>!!pa(u,i,r))&&(a[l]=!0,t.push({contexts:r.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const r=e[t],[i]=Xa(t),a=this.graph.nodes[i];if(a.attrParams.shape&&a.attrParams.shape.value){const s=a.attrParams.shape.value,o=s.length===r.shape.length&&r.shape.every((l,u)=>s[u]===-1||s[u]===l);le(o,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${s}], but was [${r.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&le(r.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){const t={};for(const r in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){const i=this._signature.inputs[r];t[i.name]=e[r]}else t[r]=e[r];return t}checkInputs(e){const t=Object.keys(e).filter(r=>{const[i]=Xa(r);return this.graph.nodes[i]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[r]=Xa(t);if(!this.graph.nodes[r])throw new Error(`The output '${t}' is not found in the graph`)})}}class W8e{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G8e="?tfjs-format=file",j8e="model.json";class q8e{constructor(e,t={},r=UO){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=r,t==null&&(this.loadOptions={}),this.resourceManager=new W8e}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Td(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}this.signature=r,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const i=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new bS(LH.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(i),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const a=LH.Instance.transformGraph(e.modelInitializer);this.initializer=new bS(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const i=r instanceof dr?[r]:r,a={};return i.forEach((s,o)=>a[this.structuredOutputKeys[o]]=s),a}return r}normalizeInputs(e){if(!(e instanceof dr)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,r,i)=>(t[r]=e[i],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,r)=>(t[r]=[e[r]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Y3(n,e={},t=UO){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=X8e(n));const r=new q8e(n,e,t);return await r.load(),r}function X8e(n){return n.endsWith("/")||(n=n+"/"),`${n}${j8e}${G8e}`}var K8e={};(function(){var n;function e(E){var D=0;return function(){return D<E.length?{done:!1,value:E[D++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(E,D,U){return E==Array.prototype||E==Object.prototype||(E[D]=U.value),E};function r(E){E=[typeof globalThis=="object"&&globalThis,E,typeof window=="object"&&window,typeof self=="object"&&self,typeof ho=="object"&&ho];for(var D=0;D<E.length;++D){var U=E[D];if(U&&U.Math==Math)return U}throw Error("Cannot find global object")}var i=r(this);function a(E,D){if(D)e:{var U=i;E=E.split(".");for(var X=0;X<E.length-1;X++){var de=E[X];if(!(de in U))break e;U=U[de]}E=E[E.length-1],X=U[E],D=D(X),D!=X&&D!=null&&t(U,E,{configurable:!0,writable:!0,value:D})}}a("Symbol",function(E){function D(ge){if(this instanceof D)throw new TypeError("Symbol is not a constructor");return new U(X+(ge||"")+"_"+de++,ge)}function U(ge,_e){this.h=ge,t(this,"description",{configurable:!0,writable:!0,value:_e})}if(E)return E;U.prototype.toString=function(){return this.h};var X="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",de=0;return D}),a("Symbol.iterator",function(E){if(E)return E;E=Symbol("Symbol.iterator");for(var D="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),U=0;U<D.length;U++){var X=i[D[U]];typeof X=="function"&&typeof X.prototype[E]!="function"&&t(X.prototype,E,{configurable:!0,writable:!0,value:function(){return s(e(this))}})}return E});function s(E){return E={next:E},E[Symbol.iterator]=function(){return this},E}function o(E){var D=typeof Symbol<"u"&&Symbol.iterator&&E[Symbol.iterator];return D?D.call(E):{next:e(E)}}function l(E){if(!(E instanceof Array)){E=o(E);for(var D,U=[];!(D=E.next()).done;)U.push(D.value);E=U}return E}var u=typeof Object.assign=="function"?Object.assign:function(E,D){for(var U=1;U<arguments.length;U++){var X=arguments[U];if(X)for(var de in X)Object.prototype.hasOwnProperty.call(X,de)&&(E[de]=X[de])}return E};a("Object.assign",function(E){return E||u});var c=typeof Object.create=="function"?Object.create:function(E){function D(){}return D.prototype=E,new D},f;if(typeof Object.setPrototypeOf=="function")f=Object.setPrototypeOf;else{var h;e:{var d={a:!0},p={};try{p.__proto__=d,h=p.a;break e}catch{}h=!1}f=h?function(E,D){if(E.__proto__=D,E.__proto__!==D)throw new TypeError(E+" is not extensible");return E}:null}var m=f;function g(E,D){if(E.prototype=c(D.prototype),E.prototype.constructor=E,m)m(E,D);else for(var U in D)if(U!="prototype")if(Object.defineProperties){var X=Object.getOwnPropertyDescriptor(D,U);X&&Object.defineProperty(E,U,X)}else E[U]=D[U];E.za=D.prototype}function v(){this.m=!1,this.j=null,this.i=void 0,this.h=1,this.v=this.s=0,this.l=null}function _(E){if(E.m)throw new TypeError("Generator is already running");E.m=!0}v.prototype.u=function(E){this.i=E};function x(E,D){E.l={ma:D,na:!0},E.h=E.s||E.v}v.prototype.return=function(E){this.l={return:E},this.h=this.v};function b(E,D,U){return E.h=U,{value:D}}function S(E){this.h=new v,this.i=E}function T(E,D){_(E.h);var U=E.h.j;return U?M(E,"return"in U?U.return:function(X){return{value:X,done:!0}},D,E.h.return):(E.h.return(D),C(E))}function M(E,D,U,X){try{var de=D.call(E.h.j,U);if(!(de instanceof Object))throw new TypeError("Iterator result "+de+" is not an object");if(!de.done)return E.h.m=!1,de;var ge=de.value}catch(_e){return E.h.j=null,x(E.h,_e),C(E)}return E.h.j=null,X.call(E.h,ge),C(E)}function C(E){for(;E.h.h;)try{var D=E.i(E.h);if(D)return E.h.m=!1,{value:D.value,done:!1}}catch(U){E.h.i=void 0,x(E.h,U)}if(E.h.m=!1,E.h.l){if(D=E.h.l,E.h.l=null,D.na)throw D.ma;return{value:D.return,done:!0}}return{value:void 0,done:!0}}function k(E){this.next=function(D){return _(E.h),E.h.j?D=M(E,E.h.j.next,D,E.h.u):(E.h.u(D),D=C(E)),D},this.throw=function(D){return _(E.h),E.h.j?D=M(E,E.h.j.throw,D,E.h.u):(x(E.h,D),D=C(E)),D},this.return=function(D){return T(E,D)},this[Symbol.iterator]=function(){return this}}function R(E){function D(X){return E.next(X)}function U(X){return E.throw(X)}return new Promise(function(X,de){function ge(_e){_e.done?X(_e.value):Promise.resolve(_e.value).then(D,U).then(ge,de)}ge(E.next())})}function P(E){return R(new k(new S(E)))}a("Promise",function(E){function D(_e){this.i=0,this.j=void 0,this.h=[],this.u=!1;var Re=this.l();try{_e(Re.resolve,Re.reject)}catch(je){Re.reject(je)}}function U(){this.h=null}function X(_e){return _e instanceof D?_e:new D(function(Re){Re(_e)})}if(E)return E;U.prototype.i=function(_e){if(this.h==null){this.h=[];var Re=this;this.j(function(){Re.m()})}this.h.push(_e)};var de=i.setTimeout;U.prototype.j=function(_e){de(_e,0)},U.prototype.m=function(){for(;this.h&&this.h.length;){var _e=this.h;this.h=[];for(var Re=0;Re<_e.length;++Re){var je=_e[Re];_e[Re]=null;try{je()}catch(ft){this.l(ft)}}}this.h=null},U.prototype.l=function(_e){this.j(function(){throw _e})},D.prototype.l=function(){function _e(ft){return function(xt){je||(je=!0,ft.call(Re,xt))}}var Re=this,je=!1;return{resolve:_e(this.I),reject:_e(this.m)}},D.prototype.I=function(_e){if(_e===this)this.m(new TypeError("A Promise cannot resolve to itself"));else if(_e instanceof D)this.L(_e);else{e:switch(typeof _e){case"object":var Re=_e!=null;break e;case"function":Re=!0;break e;default:Re=!1}Re?this.F(_e):this.s(_e)}},D.prototype.F=function(_e){var Re=void 0;try{Re=_e.then}catch(je){this.m(je);return}typeof Re=="function"?this.M(Re,_e):this.s(_e)},D.prototype.m=function(_e){this.v(2,_e)},D.prototype.s=function(_e){this.v(1,_e)},D.prototype.v=function(_e,Re){if(this.i!=0)throw Error("Cannot settle("+_e+", "+Re+"): Promise already settled in state"+this.i);this.i=_e,this.j=Re,this.i===2&&this.K(),this.H()},D.prototype.K=function(){var _e=this;de(function(){if(_e.D()){var Re=i.console;typeof Re<"u"&&Re.error(_e.j)}},1)},D.prototype.D=function(){if(this.u)return!1;var _e=i.CustomEvent,Re=i.Event,je=i.dispatchEvent;return typeof je>"u"?!0:(typeof _e=="function"?_e=new _e("unhandledrejection",{cancelable:!0}):typeof Re=="function"?_e=new Re("unhandledrejection",{cancelable:!0}):(_e=i.document.createEvent("CustomEvent"),_e.initCustomEvent("unhandledrejection",!1,!0,_e)),_e.promise=this,_e.reason=this.j,je(_e))},D.prototype.H=function(){if(this.h!=null){for(var _e=0;_e<this.h.length;++_e)ge.i(this.h[_e]);this.h=null}};var ge=new U;return D.prototype.L=function(_e){var Re=this.l();_e.T(Re.resolve,Re.reject)},D.prototype.M=function(_e,Re){var je=this.l();try{_e.call(Re,je.resolve,je.reject)}catch(ft){je.reject(ft)}},D.prototype.then=function(_e,Re){function je(qt,Pt){return typeof qt=="function"?function(an){try{ft(qt(an))}catch(Cn){xt(Cn)}}:Pt}var ft,xt,Qt=new D(function(qt,Pt){ft=qt,xt=Pt});return this.T(je(_e,ft),je(Re,xt)),Qt},D.prototype.catch=function(_e){return this.then(void 0,_e)},D.prototype.T=function(_e,Re){function je(){switch(ft.i){case 1:_e(ft.j);break;case 2:Re(ft.j);break;default:throw Error("Unexpected state: "+ft.i)}}var ft=this;this.h==null?ge.i(je):this.h.push(je),this.u=!0},D.resolve=X,D.reject=function(_e){return new D(function(Re,je){je(_e)})},D.race=function(_e){return new D(function(Re,je){for(var ft=o(_e),xt=ft.next();!xt.done;xt=ft.next())X(xt.value).T(Re,je)})},D.all=function(_e){var Re=o(_e),je=Re.next();return je.done?X([]):new D(function(ft,xt){function Qt(an){return function(Cn){qt[an]=Cn,Pt--,Pt==0&&ft(qt)}}var qt=[],Pt=0;do qt.push(void 0),Pt++,X(je.value).T(Qt(qt.length-1),xt),je=Re.next();while(!je.done)})},D});function N(E,D){E instanceof String&&(E+="");var U=0,X=!1,de={next:function(){if(!X&&U<E.length){var ge=U++;return{value:D(ge,E[ge]),done:!1}}return X=!0,{done:!0,value:void 0}}};return de[Symbol.iterator]=function(){return de},de}a("Array.prototype.keys",function(E){return E||function(){return N(this,function(D){return D})}}),a("Array.prototype.fill",function(E){return E||function(D,U,X){var de=this.length||0;for(0>U&&(U=Math.max(0,de+U)),(X==null||X>de)&&(X=de),X=Number(X),0>X&&(X=Math.max(0,de+X)),U=Number(U||0);U<X;U++)this[U]=D;return this}});function L(E){return E||Array.prototype.fill}a("Int8Array.prototype.fill",L),a("Uint8Array.prototype.fill",L),a("Uint8ClampedArray.prototype.fill",L),a("Int16Array.prototype.fill",L),a("Uint16Array.prototype.fill",L),a("Int32Array.prototype.fill",L),a("Uint32Array.prototype.fill",L),a("Float32Array.prototype.fill",L),a("Float64Array.prototype.fill",L),a("Object.is",function(E){return E||function(D,U){return D===U?D!==0||1/D===1/U:D!==D&&U!==U}}),a("Array.prototype.includes",function(E){return E||function(D,U){var X=this;X instanceof String&&(X=String(X));var de=X.length;for(U=U||0,0>U&&(U=Math.max(U+de,0));U<de;U++){var ge=X[U];if(ge===D||Object.is(ge,D))return!0}return!1}}),a("String.prototype.includes",function(E){return E||function(D,U){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(D instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(D,U||0)!==-1}});var F=this||self;function O(E,D){E=E.split(".");var U=F;E[0]in U||typeof U.execScript>"u"||U.execScript("var "+E[0]);for(var X;E.length&&(X=E.shift());)E.length||D===void 0?U[X]&&U[X]!==Object.prototype[X]?U=U[X]:U=U[X]={}:U[X]=D}function B(E){var D;e:{if((D=F.navigator)&&(D=D.userAgent))break e;D=""}return D.indexOf(E)!=-1}var H=Array.prototype.map?function(E,D){return Array.prototype.map.call(E,D,void 0)}:function(E,D){for(var U=E.length,X=Array(U),de=typeof E=="string"?E.split(""):E,ge=0;ge<U;ge++)ge in de&&(X[ge]=D.call(void 0,de[ge],ge,E));return X},j={},K=null;function J(E){var D=E.length,U=3*D/4;U%3?U=Math.floor(U):"=.".indexOf(E[D-1])!=-1&&(U="=.".indexOf(E[D-2])!=-1?U-2:U-1);var X=new Uint8Array(U),de=0;return re(E,function(ge){X[de++]=ge}),de!==U?X.subarray(0,de):X}function re(E,D){function U(je){for(;X<E.length;){var ft=E.charAt(X++),xt=K[ft];if(xt!=null)return xt;if(!/^[\s\xa0]*$/.test(ft))throw Error("Unknown base64 encoding at char: "+ft)}return je}se();for(var X=0;;){var de=U(-1),ge=U(0),_e=U(64),Re=U(64);if(Re===64&&de===-1)break;D(de<<2|ge>>4),_e!=64&&(D(ge<<4&240|_e>>2),Re!=64&&D(_e<<6&192|Re))}}function se(){if(!K){K={};for(var E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),D=["+/=","+/","-_=","-_.","-_"],U=0;5>U;U++){var X=E.concat(D[U].split(""));j[U]=X;for(var de=0;de<X.length;de++){var ge=X[de];K[ge]===void 0&&(K[ge]=de)}}}}var Ae=typeof Uint8Array<"u",Ee=!(B("Trident")||B("MSIE"))&&typeof F.btoa=="function";function Ne(E){if(!Ee){var D;D===void 0&&(D=0),se(),D=j[D];for(var U=Array(Math.floor(E.length/3)),X=D[64]||"",de=0,ge=0;de<E.length-2;de+=3){var _e=E[de],Re=E[de+1],je=E[de+2],ft=D[_e>>2];_e=D[(_e&3)<<4|Re>>4],Re=D[(Re&15)<<2|je>>6],je=D[je&63],U[ge++]=ft+_e+Re+je}switch(ft=0,je=X,E.length-de){case 2:ft=E[de+1],je=D[(ft&15)<<2]||X;case 1:E=E[de],U[ge]=D[E>>2]+D[(E&3)<<4|ft>>4]+je+X}return U.join("")}for(D="";10240<E.length;)D+=String.fromCharCode.apply(null,E.subarray(0,10240)),E=E.subarray(10240);return D+=String.fromCharCode.apply(null,E),btoa(D)}var we=RegExp("[-_.]","g");function me(E){switch(E){case"-":return"+";case"_":return"/";case".":return"=";default:return""}}function Se(E){if(!Ee)return J(E);we.test(E)&&(E=E.replace(we,me)),E=atob(E);for(var D=new Uint8Array(E.length),U=0;U<E.length;U++)D[U]=E.charCodeAt(U);return D}var Me;function ke(){return Me||(Me=new Uint8Array(0))}var He={},ee=typeof Uint8Array.prototype.slice=="function",ie=0,xe=0;function Ve(E){var D=0>E;E=Math.abs(E);var U=E>>>0;E=Math.floor((E-U)/4294967296),D&&(U=o(Ze(U,E)),D=U.next().value,E=U.next().value,U=D),ie=U>>>0,xe=E>>>0}var Ge=typeof BigInt=="function";function Ze(E,D){return D=~D,E?E=~E+1:D+=1,[E,D]}function ut(E,D){this.i=E>>>0,this.h=D>>>0}function Qe(E){if(!E)return ve||(ve=new ut(0,0));if(!/^-?\d+$/.test(E))return null;if(16>E.length)Ve(Number(E));else if(Ge)E=BigInt(E),ie=Number(E&BigInt(4294967295))>>>0,xe=Number(E>>BigInt(32)&BigInt(4294967295));else{var D=+(E[0]==="-");xe=ie=0;for(var U=E.length,X=D,de=(U-D)%6+D;de<=U;X=de,de+=6)X=Number(E.slice(X,de)),xe*=1e6,ie=1e6*ie+X,4294967296<=ie&&(xe+=ie/4294967296|0,ie%=4294967296);D&&(D=o(Ze(ie,xe)),E=D.next().value,D=D.next().value,ie=E,xe=D)}return new ut(ie,xe)}var ve;function Ke(E,D){return Error("Invalid wire type: "+E+" (at position "+D+")")}function ne(){return Error("Failed to read varint, encoding is invalid.")}function Z(E,D){return Error("Tried to read past the end of the data "+D+" > "+E)}function fe(){throw Error("Invalid UTF8")}function Be(E,D){return D=String.fromCharCode.apply(null,D),E==null?D:E+D}var Xe=void 0,st,mt=typeof TextDecoder<"u",ye,$e=typeof TextEncoder<"u",vt;function bt(E){if(E!==He)throw Error("illegal external caller")}function dt(E,D){if(bt(D),this.V=E,E!=null&&E.length===0)throw Error("ByteString should be constructed with non-empty values")}function $t(){return vt||(vt=new dt(null,He))}function Ct(E){bt(He);var D=E.V;return D=D==null||Ae&&D!=null&&D instanceof Uint8Array?D:typeof D=="string"?Se(D):null,D==null?D:E.V=D}function Kt(E){if(typeof E=="string")return{buffer:Se(E),C:!1};if(Array.isArray(E))return{buffer:new Uint8Array(E),C:!1};if(E.constructor===Uint8Array)return{buffer:E,C:!1};if(E.constructor===ArrayBuffer)return{buffer:new Uint8Array(E),C:!1};if(E.constructor===dt)return{buffer:Ct(E)||ke(),C:!0};if(E instanceof Uint8Array)return{buffer:new Uint8Array(E.buffer,E.byteOffset,E.byteLength),C:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function Vt(E,D){this.i=null,this.m=!1,this.h=this.j=this.l=0,Ft(this,E,D)}function Ft(E,D,U){U=U===void 0?{}:U,E.S=U.S===void 0?!1:U.S,D&&(D=Kt(D),E.i=D.buffer,E.m=D.C,E.l=0,E.j=E.i.length,E.h=E.l)}Vt.prototype.reset=function(){this.h=this.l};function Pe(E,D){if(E.h=D,D>E.j)throw Z(E.j,D)}function Je(E){var D=E.i,U=E.h,X=D[U++],de=X&127;if(X&128&&(X=D[U++],de|=(X&127)<<7,X&128&&(X=D[U++],de|=(X&127)<<14,X&128&&(X=D[U++],de|=(X&127)<<21,X&128&&(X=D[U++],de|=X<<28,X&128&&D[U++]&128&&D[U++]&128&&D[U++]&128&&D[U++]&128&&D[U++]&128)))))throw ne();return Pe(E,U),de}function ot(E,D){if(0>D)throw Error("Tried to read a negative byte length: "+D);var U=E.h,X=U+D;if(X>E.j)throw Z(D,E.j-U);return E.h=X,U}var wt=[];function Bt(){this.h=[]}Bt.prototype.length=function(){return this.h.length},Bt.prototype.end=function(){var E=this.h;return this.h=[],E};function Ln(E,D,U){for(;0<U||127<D;)E.h.push(D&127|128),D=(D>>>7|U<<25)>>>0,U>>>=7;E.h.push(D)}function lr(E,D){for(;127<D;)E.h.push(D&127|128),D>>>=7;E.h.push(D)}function Xr(E,D){if(wt.length){var U=wt.pop();Ft(U,E,D),E=U}else E=new Vt(E,D);this.h=E,this.j=this.h.h,this.i=this.l=-1,this.setOptions(D)}Xr.prototype.setOptions=function(E){E=E===void 0?{}:E,this.ca=E.ca===void 0?!1:E.ca},Xr.prototype.reset=function(){this.h.reset(),this.j=this.h.h,this.i=this.l=-1};function Ca(E){var D=E.h;if(D.h==D.j)return!1;E.j=E.h.h;var U=Je(E.h)>>>0;if(D=U>>>3,U&=7,!(0<=U&&5>=U))throw Ke(U,E.j);if(1>D)throw Error("Invalid field number: "+D+" (at position "+E.j+")");return E.l=D,E.i=U,!0}function tr(E){switch(E.i){case 0:if(E.i!=0)tr(E);else e:{E=E.h;for(var D=E.h,U=D+10,X=E.i;D<U;)if(!(X[D++]&128)){Pe(E,D);break e}throw ne()}break;case 1:E=E.h,Pe(E,E.h+8);break;case 2:E.i!=2?tr(E):(D=Je(E.h)>>>0,E=E.h,Pe(E,E.h+D));break;case 5:E=E.h,Pe(E,E.h+4);break;case 3:D=E.l;do{if(!Ca(E))throw Error("Unmatched start-group tag: stream EOF");if(E.i==4){if(E.l!=D)throw Error("Unmatched end-group tag");break}tr(E)}while(1);break;default:throw Ke(E.i,E.j)}}var Fr=[];function hi(){this.j=[],this.i=0,this.h=new Bt}function ii(E,D){D.length!==0&&(E.j.push(D),E.i+=D.length)}function zt(E,D){if(D=D.R){ii(E,E.h.end());for(var U=0;U<D.length;U++)ii(E,Ct(D[U])||ke())}}var it=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():void 0;function za(E,D){return it?E[it]|=D:E.A!==void 0?E.A|=D:(Object.defineProperties(E,{A:{value:D,configurable:!0,writable:!0,enumerable:!1}}),D)}function he(E,D){it?E[it]&&(E[it]&=~D):E.A!==void 0&&(E.A&=~D)}function Fe(E){var D;return it?D=E[it]:D=E.A,D??0}function Ye(E,D){it?E[it]=D:E.A!==void 0?E.A=D:Object.defineProperties(E,{A:{value:D,configurable:!0,writable:!0,enumerable:!1}})}function ze(E){return za(E,1),E}function tt(E,D){Ye(D,(E|0)&-51)}function Gt(E,D){Ye(D,(E|18)&-41)}var Zt={};function fn(E){return E!==null&&typeof E=="object"&&!Array.isArray(E)&&E.constructor===Object}var hn,Mn=[];Ye(Mn,23),hn=Object.freeze(Mn);function vn(E){if(Fe(E.o)&2)throw Error("Cannot mutate an immutable Message")}function yn(E){var D=E.length;(D=D?E[D-1]:void 0)&&fn(D)?D.g=1:(D={},E.push((D.g=1,D)))}function Cr(E){var D=E.i+E.G;return E.B||(E.B=E.o[D]={})}function ur(E,D){return D===-1?null:D>=E.i?E.B?E.B[D]:void 0:E.o[D+E.G]}function Kr(E,D,U,X){vn(E),Di(E,D,U,X)}function Di(E,D,U,X){E.j&&(E.j=void 0),D>=E.i||X?Cr(E)[D]=U:(E.o[D+E.G]=U,(E=E.B)&&D in E&&delete E[D])}function Er(E,D,U,X){var de=ur(E,D);Array.isArray(de)||(de=hn);var ge=Fe(de);if(ge&1||ze(de),X)ge&2||za(de,2),U&1||Object.freeze(de);else{X=!(U&2);var _e=ge&2;U&1||!_e?X&&ge&16&&!_e&&he(de,16):(de=ze(Array.prototype.slice.call(de)),Di(E,D,de))}return de}function ue(E,D){var U=ur(E,D),X=U==null?U:typeof U=="number"||U==="NaN"||U==="Infinity"||U==="-Infinity"?Number(U):void 0;return X!=null&&X!==U&&Di(E,D,X),X}function q(E,D,U,X,de){E.h||(E.h={});var ge=E.h[U],_e=Er(E,U,3,de);if(!ge){var Re=_e;ge=[];var je=!!(Fe(E.o)&16);_e=!!(Fe(Re)&2);var ft=Re;!de&&_e&&(Re=Array.prototype.slice.call(Re));for(var xt=_e,Qt=0;Qt<Re.length;Qt++){var qt=Re[Qt],Pt=D,an=!1;if(an=an===void 0?!1:an,qt=Array.isArray(qt)?new Pt(qt):an?new Pt:void 0,qt!==void 0){Pt=qt.o;var Cn=an=Fe(Pt);_e&&(Cn|=2),je&&(Cn|=16),Cn!=an&&Ye(Pt,Cn),Pt=Cn,xt=xt||!!(2&Pt),ge.push(qt)}}return E.h[U]=ge,je=Fe(Re),D=je|33,D=xt?D&-9:D|8,je!=D&&(xt=Re,Object.isFrozen(xt)&&(xt=Array.prototype.slice.call(xt)),Ye(xt,D),Re=xt),ft!==Re&&Di(E,U,Re),(de||X&&_e)&&za(ge,2),X&&Object.freeze(ge),ge}return de||(de=Object.isFrozen(ge),X&&!de?Object.freeze(ge):!X&&de&&(ge=Array.prototype.slice.call(ge),E.h[U]=ge)),ge}function z(E,D,U){var X=!!(Fe(E.o)&2);if(D=q(E,D,U,X,X),E=Er(E,U,3,X),!(X||Fe(E)&8)){for(X=0;X<D.length;X++){if(U=D[X],Fe(U.o)&2){var de=Va(U,!1);de.j=U}else de=U;U!==de&&(D[X]=de,E[X]=de.o)}za(E,8)}return D}function G(E,D,U){if(U!=null&&typeof U!="number")throw Error("Value of float/double field must be a number|null|undefined, found "+typeof U+": "+U);Kr(E,D,U)}function ae(E,D,U,X,de){vn(E);var ge=q(E,U,D,!1,!1);return U=X??new U,E=Er(E,D,2,!1),de!=null?(ge.splice(de,0,U),E.splice(de,0,U.o)):(ge.push(U),E.push(U.o)),U.C()&&he(E,8),U}function be(E,D){return E??D}function Ie(E,D,U){return U=U===void 0?0:U,be(ue(E,D),U)}var Ue;function rt(E){switch(typeof E){case"number":return isFinite(E)?E:String(E);case"object":if(E)if(Array.isArray(E)){if(Fe(E)&128)return E=Array.prototype.slice.call(E),yn(E),E}else{if(Ae&&E!=null&&E instanceof Uint8Array)return Ne(E);if(E instanceof dt){var D=E.V;return D==null?"":typeof D=="string"?D:E.V=Ne(D)}}}return E}function _t(E,D,U,X){if(E!=null){if(Array.isArray(E))E=ct(E,D,U,X!==void 0);else if(fn(E)){var de={},ge;for(ge in E)de[ge]=_t(E[ge],D,U,X);E=de}else E=D(E,X);return E}}function ct(E,D,U,X){var de=Fe(E);X=X?!!(de&16):void 0,E=Array.prototype.slice.call(E);for(var ge=0;ge<E.length;ge++)E[ge]=_t(E[ge],D,U,X);return U(de,E),E}function Lt(E){return E.ja===Zt?E.toJSON():rt(E)}function Ot(E,D){E&128&&yn(D)}function En(E,D,U){if(U=U===void 0?Gt:U,E!=null){if(Ae&&E instanceof Uint8Array)return E.length?new dt(new Uint8Array(E),He):$t();if(Array.isArray(E)){var X=Fe(E);return X&2?E:D&&!(X&32)&&(X&16||X===0)?(Ye(E,X|2),E):(E=ct(E,En,X&4?Gt:U,!0),D=Fe(E),D&4&&D&2&&Object.freeze(E),E)}return E.ja===Zt?Xt(E):E}}function Br(E,D,U,X,de,ge,_e){if(E=E.h&&E.h[U]){if(X=Fe(E),X&2?X=E:(ge=H(E,Xt),Gt(X,ge),Object.freeze(ge),X=ge),vn(D),_e=X==null?hn:ze([]),X!=null){for(ge=!!X.length,E=0;E<X.length;E++){var Re=X[E];ge=ge&&!(Fe(Re.o)&2),_e[E]=Re.o}ge=(ge?8:0)|1,E=Fe(_e),(E&ge)!==ge&&(Object.isFrozen(_e)&&(_e=Array.prototype.slice.call(_e)),Ye(_e,E|ge)),D.h||(D.h={}),D.h[U]=X}else D.h&&(D.h[U]=void 0);Di(D,U,_e,de)}else Kr(D,U,En(X,ge,_e),de)}function Xt(E){return Fe(E.o)&2||(E=Va(E,!0),za(E.o,2)),E}function Va(E,D){var U=E.o,X=[];za(X,16);var de=E.constructor.h;if(de&&X.push(de),de=E.B,de){X.length=U.length,X.fill(void 0,X.length,U.length);var ge={};X[X.length-1]=ge}Fe(U)&128&&yn(X),D=D||E.C()?Gt:tt,ge=E.constructor,Ue=X,X=new ge(X),Ue=void 0,E.R&&(X.R=E.R.slice()),ge=!!(Fe(U)&16);for(var _e=de?U.length-1:U.length,Re=0;Re<_e;Re++)Br(E,X,Re-E.G,U[Re],!1,ge,D);if(de)for(var je in de)Br(E,X,+je,de[je],!0,ge,D);return X}function mn(E,D,U){E==null&&(E=Ue),Ue=void 0;var X=this.constructor.i||0,de=0<X,ge=this.constructor.h,_e=!1;if(E==null){E=ge?[ge]:[];var Re=48,je=!0;de&&(X=0,Re|=128),Ye(E,Re)}else{if(!Array.isArray(E)||ge&&ge!==E[0])throw Error();var ft=Re=za(E,0);if((je=(16&ft)!==0)&&((_e=(32&ft)!==0)||(ft|=32)),de){if(128&ft)X=0;else if(0<E.length){var xt=E[E.length-1];if(fn(xt)&&"g"in xt){X=0,ft|=128,delete xt.g;var Qt=!0,qt;for(qt in xt){Qt=!1;break}Qt&&E.pop()}}}else if(128&ft)throw Error();Re!==ft&&Ye(E,ft)}this.G=(ge?0:-1)-X,this.h=void 0,this.o=E;e:{if(ge=this.o.length,X=ge-1,ge&&(ge=this.o[X],fn(ge))){this.B=ge,this.i=X-this.G;break e}D!==void 0&&-1<D?(this.i=Math.max(D,X+1-this.G),this.B=void 0):this.i=Number.MAX_VALUE}if(!de&&this.B&&"g"in this.B)throw Error('Unexpected "g" flag in sparse object of message that is not a group type.');if(U){D=je&&!_e&&!0,de=this.i;var Pt;for(je=0;je<U.length;je++)_e=U[je],_e<de?(_e+=this.G,(X=E[_e])?Os(X,D):E[_e]=hn):(Pt||(Pt=Cr(this)),(X=Pt[_e])?Os(X,D):Pt[_e]=hn)}}mn.prototype.toJSON=function(){return ct(this.o,Lt,Ot)},mn.prototype.C=function(){return!!(Fe(this.o)&2)};function Os(E,D){if(Array.isArray(E)){var U=Fe(E),X=1;!D||U&2||(X|=16),(U&X)!==X&&Ye(E,U|X)}}mn.prototype.ja=Zt,mn.prototype.toString=function(){return this.o.toString()};function iu(E,D,U){if(U){var X={},de;for(de in U){var ge=U[de],_e=ge.ra;_e||(X.J=ge.xa||ge.oa.W,ge.ia?(X.aa=pl(ge.ia),_e=function(Re){return function(je,ft,xt){return Re.J(je,ft,xt,Re.aa)}}(X)):ge.ka?(X.Z=au(ge.da.P,ge.ka),_e=function(Re){return function(je,ft,xt){return Re.J(je,ft,xt,Re.Z)}}(X)):_e=X.J,ge.ra=_e),_e(D,E,ge.da),X={J:X.J,aa:X.aa,Z:X.Z}}}zt(D,E)}var ds=Symbol();function Ea(E,D,U){return E[ds]||(E[ds]=function(X,de){return D(X,de,U)})}function ps(E){var D=E[ds];if(!D){var U=lc(E);D=function(X,de){return uc(X,de,U)},E[ds]=D}return D}function oc(E){var D=E.ia;if(D)return ps(D);if(D=E.wa)return Ea(E.da.P,D,E.ka)}function yr(E){var D=oc(E),U=E.da,X=E.oa.U;return D?function(de,ge){return X(de,ge,U,D)}:function(de,ge){return X(de,ge,U)}}function dl(E,D){var U=E[D];return typeof U=="function"&&U.length===0&&(U=U(),E[D]=U),Array.isArray(U)&&(ou in U||ml in U||0<U.length&&typeof U[0]=="function")?U:void 0}function sr(E,D,U,X,de,ge){D.P=E[0];var _e=1;if(E.length>_e&&typeof E[_e]!="number"){var Re=E[_e++];U(D,Re)}for(;_e<E.length;){U=E[_e++];for(var je=_e+1;je<E.length&&typeof E[je]!="number";)je++;switch(Re=E[_e++],je-=_e,je){case 0:X(D,U,Re);break;case 1:(je=dl(E,_e))?(_e++,de(D,U,Re,je)):X(D,U,Re,E[_e++]);break;case 2:je=_e++,je=dl(E,je),de(D,U,Re,je,E[_e++]);break;case 3:ge(D,U,Re,E[_e++],E[_e++],E[_e++]);break;case 4:ge(D,U,Re,E[_e++],E[_e++],E[_e++],E[_e++]);break;default:throw Error("unexpected number of binary field arguments: "+je)}}return D}var Aa=Symbol();function pl(E){var D=E[Aa];if(!D){var U=su(E);D=function(X,de){return cc(X,de,U)},E[Aa]=D}return D}function au(E,D){var U=E[Aa];return U||(U=function(X,de){return iu(X,de,D)},E[Aa]=U),U}var ml=Symbol();function ep(E,D){E.push(D)}function tp(E,D,U){E.push(D,U.W)}function np(E,D,U,X){var de=pl(X),ge=su(X).P,_e=U.W;E.push(D,function(Re,je,ft){return _e(Re,je,ft,ge,de)})}function rp(E,D,U,X,de,ge){var _e=au(X,ge),Re=U.W;E.push(D,function(je,ft,xt){return Re(je,ft,xt,X,_e)})}function su(E){var D=E[ml];return D||(D=sr(E,E[ml]=[],ep,tp,np,rp),ou in E&&ml in E&&(E.length=0),D)}var ou=Symbol();function $f(E,D){E[0]=D}function ip(E,D,U,X){var de=U.U;E[D]=X?function(ge,_e,Re){return de(ge,_e,Re,X)}:de}function lu(E,D,U,X,de){var ge=U.U,_e=ps(X),Re=lc(X).P;E[D]=function(je,ft,xt){return ge(je,ft,xt,Re,_e,de)}}function Ur(E,D,U,X,de,ge,_e){var Re=U.U,je=Ea(X,de,ge);E[D]=function(ft,xt,Qt){return Re(ft,xt,Qt,X,je,_e)}}function lc(E){var D=E[ou];return D||(D=sr(E,E[ou]={},$f,ip,lu,Ur),ou in E&&ml in E&&(E.length=0),D)}function uc(E,D,U){for(;Ca(D)&&D.i!=4;){var X=D.l,de=U[X];if(!de){var ge=U[0];ge&&(ge=ge[X])&&(de=U[X]=yr(ge))}if(!de||!de(D,E,X)){de=D,X=E,ge=de.j,tr(de);var _e=de;if(!_e.ca){if(de=_e.h.h-ge,_e.h.h=ge,_e=_e.h,de==0)de=$t();else{if(ge=ot(_e,de),_e.S&&_e.m)de=_e.i.subarray(ge,ge+de);else{_e=_e.i;var Re=ge;de=ge+de,de=Re===de?ke():ee?_e.slice(Re,de):new Uint8Array(_e.subarray(Re,de))}de=de.length==0?$t():new dt(de,He)}(ge=X.R)?ge.push(de):X.R=[de]}}}return E}function cc(E,D,U){for(var X=U.length,de=X%2==1,ge=de?1:0;ge<X;ge+=2)(0,U[ge+1])(D,E,U[ge]);iu(E,D,de?U[0]:void 0)}function gl(E,D){return{U:E,W:D}}var ea=gl(function(E,D,U){if(E.i!==5)return!1;E=E.h;var X=E.i,de=E.h,ge=X[de],_e=X[de+1],Re=X[de+2];return X=X[de+3],Pe(E,E.h+4),_e=(ge<<0|_e<<8|Re<<16|X<<24)>>>0,E=2*(_e>>31)+1,ge=_e>>>23&255,_e&=8388607,Kr(D,U,ge==255?_e?NaN:1/0*E:ge==0?E*Math.pow(2,-149)*_e:E*Math.pow(2,ge-150)*(_e+Math.pow(2,23))),!0},function(E,D,U){if(D=ue(D,U),D!=null){lr(E.h,8*U+5),E=E.h;var X=+D;X===0?0<1/X?ie=xe=0:(xe=0,ie=2147483648):isNaN(X)?(xe=0,ie=2147483647):(X=(U=0>X?-2147483648:0)?-X:X,34028234663852886e22<X?(xe=0,ie=(U|2139095040)>>>0):11754943508222875e-54>X?(X=Math.round(X/Math.pow(2,-149)),xe=0,ie=(U|X)>>>0):(D=Math.floor(Math.log(X)/Math.LN2),X*=Math.pow(2,-D),X=Math.round(8388608*X),16777216<=X&&++D,xe=0,ie=(U|D+127<<23|X&8388607)>>>0)),U=ie,E.h.push(U>>>0&255),E.h.push(U>>>8&255),E.h.push(U>>>16&255),E.h.push(U>>>24&255)}}),av=gl(function(E,D,U){if(E.i!==0)return!1;var X=E.h,de=0,ge=E=0,_e=X.i,Re=X.h;do{var je=_e[Re++];de|=(je&127)<<ge,ge+=7}while(32>ge&&je&128);for(32<ge&&(E|=(je&127)>>4),ge=3;32>ge&&je&128;ge+=7)je=_e[Re++],E|=(je&127)<<ge;if(Pe(X,Re),128>je)X=de>>>0,je=E>>>0,(E=je&2147483648)&&(X=~X+1>>>0,je=~je>>>0,X==0&&(je=je+1>>>0)),X=4294967296*je+(X>>>0);else throw ne();return Kr(D,U,E?-X:X),!0},function(E,D,U){D=ur(D,U),D!=null&&(typeof D=="string"&&Qe(D),D!=null&&(lr(E.h,8*U),typeof D=="number"?(E=E.h,Ve(D),Ln(E,ie,xe)):(U=Qe(D),Ln(E.h,U.i,U.h))))}),Ff=gl(function(E,D,U){return E.i!==0?!1:(Kr(D,U,Je(E.h)),!0)},function(E,D,U){if(D=ur(D,U),D!=null&&D!=null)if(lr(E.h,8*U),E=E.h,U=D,0<=U)lr(E,U);else{for(D=0;9>D;D++)E.h.push(U&127|128),U>>=7;E.h.push(1)}}),Bf=gl(function(E,D,U){if(E.i!==2)return!1;var X=Je(E.h)>>>0;E=E.h;var de=ot(E,X);if(E=E.i,mt){var ge=E,_e;(_e=st)||(_e=st=new TextDecoder("utf-8",{fatal:!0})),E=de+X,ge=de===0&&E===ge.length?ge:ge.subarray(de,E);try{var Re=_e.decode(ge)}catch(Qt){if(Xe===void 0){try{_e.decode(new Uint8Array([128]))}catch{}try{_e.decode(new Uint8Array([97])),Xe=!0}catch{Xe=!1}}throw!Xe&&(st=void 0),Qt}}else{Re=de,X=Re+X,de=[];for(var je=null,ft,xt;Re<X;)ft=E[Re++],128>ft?de.push(ft):224>ft?Re>=X?fe():(xt=E[Re++],194>ft||(xt&192)!==128?(Re--,fe()):de.push((ft&31)<<6|xt&63)):240>ft?Re>=X-1?fe():(xt=E[Re++],(xt&192)!==128||ft===224&&160>xt||ft===237&&160<=xt||((ge=E[Re++])&192)!==128?(Re--,fe()):de.push((ft&15)<<12|(xt&63)<<6|ge&63)):244>=ft?Re>=X-2?fe():(xt=E[Re++],(xt&192)!==128||(ft<<28)+(xt-144)>>30||((ge=E[Re++])&192)!==128||((_e=E[Re++])&192)!==128?(Re--,fe()):(ft=(ft&7)<<18|(xt&63)<<12|(ge&63)<<6|_e&63,ft-=65536,de.push((ft>>10&1023)+55296,(ft&1023)+56320))):fe(),8192<=de.length&&(je=Be(je,de),de.length=0);Re=Be(je,de)}return Kr(D,U,Re),!0},function(E,D,U){if(D=ur(D,U),D!=null){var X=!1;if(X=X===void 0?!1:X,$e){if(X&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(D))throw Error("Found an unpaired surrogate");D=(ye||(ye=new TextEncoder)).encode(D)}else{for(var de=0,ge=new Uint8Array(3*D.length),_e=0;_e<D.length;_e++){var Re=D.charCodeAt(_e);if(128>Re)ge[de++]=Re;else{if(2048>Re)ge[de++]=Re>>6|192;else{if(55296<=Re&&57343>=Re){if(56319>=Re&&_e<D.length){var je=D.charCodeAt(++_e);if(56320<=je&&57343>=je){Re=1024*(Re-55296)+je-56320+65536,ge[de++]=Re>>18|240,ge[de++]=Re>>12&63|128,ge[de++]=Re>>6&63|128,ge[de++]=Re&63|128;continue}else _e--}if(X)throw Error("Found an unpaired surrogate");Re=65533}ge[de++]=Re>>12|224,ge[de++]=Re>>6&63|128}ge[de++]=Re&63|128}}D=de===ge.length?ge:ge.subarray(0,de)}lr(E.h,8*U+2),lr(E.h,D.length),ii(E,E.h.end()),ii(E,D)}}),Uf=gl(function(E,D,U,X,de){if(E.i!==2)return!1;D=ae(D,U,X),U=E.h.j,X=Je(E.h)>>>0;var ge=E.h.h+X,_e=ge-U;if(0>=_e&&(E.h.j=ge,de(D,E,void 0,void 0,void 0),_e=ge-E.h.h),_e)throw Error("Message parsing ended unexpectedly. Expected to read "+(X+" bytes, instead read "+(X-_e)+" bytes, either the data ended unexpectedly or the message misreported its own length"));return E.h.h=ge,E.h.j=U,!0},function(E,D,U,X,de){if(D=z(D,X,U),D!=null)for(X=0;X<D.length;X++){var ge=E;lr(ge.h,8*U+2);var _e=ge.h.end();ii(ge,_e),_e.push(ge.i),ge=_e,de(D[X],E),_e=E;var Re=ge.pop();for(Re=_e.i+_e.h.length()-Re;127<Re;)ge.push(Re&127|128),Re>>>=7,_e.i++;ge.push(Re),_e.i++}});function zf(E){return function(D,U){e:{if(Fr.length){var X=Fr.pop();X.setOptions(U),Ft(X.h,D,U),D=X}else D=new Xr(D,U);try{var de=lc(E),ge=uc(new de.P,D,de);break e}finally{de=D.h,de.i=null,de.m=!1,de.l=0,de.j=0,de.h=0,de.S=!1,D.l=-1,D.i=-1,100>Fr.length&&Fr.push(D)}ge=void 0}return ge}}function fc(E){return function(){var D=new hi;cc(this,D,su(E)),ii(D,D.h.end());for(var U=new Uint8Array(D.i),X=D.j,de=X.length,ge=0,_e=0;_e<de;_e++){var Re=X[_e];U.set(Re,ge),ge+=Re.length}return D.j=[U],U}}function vl(E){mn.call(this,E)}g(vl,mn);var Vf=[vl,1,Ff,2,ea,3,Bf,4,Bf];vl.prototype.l=fc(Vf);function hc(E){mn.call(this,E,-1,ap)}g(hc,mn),hc.prototype.addClassification=function(E,D){return ae(this,1,vl,E,D),this};var ap=[1],sp=zf([hc,1,Uf,Vf]);function uu(E){mn.call(this,E)}g(uu,mn);var op=[uu,1,ea,2,ea,3,ea,4,ea,5,ea];uu.prototype.l=fc(op);function sv(E){mn.call(this,E,-1,EC)}g(sv,mn);var EC=[1],ix=zf([sv,1,Uf,op]);function lp(E){mn.call(this,E)}g(lp,mn);var ov=[lp,1,ea,2,ea,3,ea,4,ea,5,ea,6,av],AC=zf(ov);lp.prototype.l=fc(ov);function lv(E,D,U){if(U=E.createShader(U===0?E.VERTEX_SHADER:E.FRAGMENT_SHADER),E.shaderSource(U,D),E.compileShader(U),!E.getShaderParameter(U,E.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+E.getShaderInfoLog(U));return U}function MC(E){return z(E,vl,1).map(function(D){var U=ur(D,1);return{index:U??0,qa:Ie(D,2),label:ur(D,3)!=null?be(ur(D,3),""):void 0,displayName:ur(D,4)!=null?be(ur(D,4),""):void 0}})}function ax(E){return{x:Ie(E,1),y:Ie(E,2),z:Ie(E,3),visibility:ue(E,4)!=null?Ie(E,4):void 0}}function uv(E,D){this.i=E,this.h=D,this.m=0}function cv(E,D,U){return kC(E,D),typeof E.h.canvas.transferToImageBitmap=="function"?Promise.resolve(E.h.canvas.transferToImageBitmap()):U?Promise.resolve(E.h.canvas):typeof createImageBitmap=="function"?createImageBitmap(E.h.canvas):(E.j===void 0&&(E.j=document.createElement("canvas")),new Promise(function(X){E.j.height=E.h.canvas.height,E.j.width=E.h.canvas.width,E.j.getContext("2d",{}).drawImage(E.h.canvas,0,0,E.h.canvas.width,E.h.canvas.height),X(E.j)}))}function kC(E,D){var U=E.h;if(E.s===void 0){var X=lv(U,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),de=lv(U,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),ge=U.createProgram();if(U.attachShader(ge,X),U.attachShader(ge,de),U.linkProgram(ge),!U.getProgramParameter(ge,U.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+U.getProgramInfoLog(ge));X=E.s=ge,U.useProgram(X),de=U.getUniformLocation(X,"sampler0"),E.l={O:U.getAttribLocation(X,"aVertex"),N:U.getAttribLocation(X,"aTex"),ya:de},E.v=U.createBuffer(),U.bindBuffer(U.ARRAY_BUFFER,E.v),U.enableVertexAttribArray(E.l.O),U.vertexAttribPointer(E.l.O,2,U.FLOAT,!1,0,0),U.bufferData(U.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),U.STATIC_DRAW),U.bindBuffer(U.ARRAY_BUFFER,null),E.u=U.createBuffer(),U.bindBuffer(U.ARRAY_BUFFER,E.u),U.enableVertexAttribArray(E.l.N),U.vertexAttribPointer(E.l.N,2,U.FLOAT,!1,0,0),U.bufferData(U.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),U.STATIC_DRAW),U.bindBuffer(U.ARRAY_BUFFER,null),U.uniform1i(de,0)}X=E.l,U.useProgram(E.s),U.canvas.width=D.width,U.canvas.height=D.height,U.viewport(0,0,D.width,D.height),U.activeTexture(U.TEXTURE0),E.i.bindTexture2d(D.glName),U.enableVertexAttribArray(X.O),U.bindBuffer(U.ARRAY_BUFFER,E.v),U.vertexAttribPointer(X.O,2,U.FLOAT,!1,0,0),U.enableVertexAttribArray(X.N),U.bindBuffer(U.ARRAY_BUFFER,E.u),U.vertexAttribPointer(X.N,2,U.FLOAT,!1,0,0),U.bindFramebuffer(U.DRAW_FRAMEBUFFER?U.DRAW_FRAMEBUFFER:U.FRAMEBUFFER,null),U.clearColor(0,0,0,0),U.clear(U.COLOR_BUFFER_BIT),U.colorMask(!0,!0,!0,!0),U.drawArrays(U.TRIANGLE_FAN,0,4),U.disableVertexAttribArray(X.O),U.disableVertexAttribArray(X.N),U.bindBuffer(U.ARRAY_BUFFER,null),E.i.bindTexture2d(0)}function sx(E){this.h=E}var RC=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function ox(E,D){return D+E}function fv(E,D){window[E]=D}function lx(E){var D=document.createElement("script");return D.setAttribute("src",E),D.setAttribute("crossorigin","anonymous"),new Promise(function(U){D.addEventListener("load",function(){U()},!1),D.addEventListener("error",function(){U()},!1),document.body.appendChild(D)})}function ux(){return P(function(E){switch(E.h){case 1:return E.s=2,b(E,WebAssembly.instantiate(RC),4);case 4:E.h=3,E.s=0;break;case 2:return E.s=0,E.l=null,E.return(!1);case 3:return E.return(!0)}})}function hv(E){if(this.h=E,this.listeners={},this.l={},this.L={},this.s={},this.v={},this.M=this.u=this.ga=!0,this.I=Promise.resolve(),this.fa="",this.D={},this.locateFile=E&&E.locateFile||ox,typeof window=="object")var D=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")D=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.ha=D,E.options){D=o(Object.keys(E.options));for(var U=D.next();!U.done;U=D.next()){U=U.value;var X=E.options[U].default;X!==void 0&&(this.l[U]=typeof X=="function"?X():X)}}}n=hv.prototype,n.close=function(){return this.j&&this.j.delete(),Promise.resolve()};function PC(E){var D,U,X,de,ge,_e,Re,je,ft,xt,Qt;return P(function(qt){switch(qt.h){case 1:return E.ga?(D=E.h.files===void 0?[]:typeof E.h.files=="function"?E.h.files(E.l):E.h.files,b(qt,ux(),2)):qt.return();case 2:if(U=qt.i,typeof window=="object")return fv("createMediapipeSolutionsWasm",{locateFile:E.locateFile}),fv("createMediapipeSolutionsPackedAssets",{locateFile:E.locateFile}),_e=D.filter(function(Pt){return Pt.data!==void 0}),Re=D.filter(function(Pt){return Pt.data===void 0}),je=Promise.all(_e.map(function(Pt){var an=up(E,Pt.url);if(Pt.path!==void 0){var Cn=Pt.path;an=an.then(function(Ir){return E.overrideFile(Cn,Ir),Promise.resolve(Ir)})}return an})),ft=Promise.all(Re.map(function(Pt){return Pt.simd===void 0||Pt.simd&&U||!Pt.simd&&!U?lx(E.locateFile(Pt.url,E.ha)):Promise.resolve()})).then(function(){var Pt,an,Cn;return P(function(Ir){if(Ir.h==1)return Pt=window.createMediapipeSolutionsWasm,an=window.createMediapipeSolutionsPackedAssets,Cn=E,b(Ir,Pt(an),2);Cn.i=Ir.i,Ir.h=0})}),xt=function(){return P(function(Pt){return E.h.graph&&E.h.graph.url?Pt=b(Pt,up(E,E.h.graph.url),0):(Pt.h=0,Pt=void 0),Pt})}(),b(qt,Promise.all([ft,je,xt]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return X=D.filter(function(Pt){return Pt.simd===void 0||Pt.simd&&U||!Pt.simd&&!U}).map(function(Pt){return E.locateFile(Pt.url,E.ha)}),importScripts.apply(null,l(X)),de=E,b(qt,createMediapipeSolutionsWasm(Module),6);case 6:de.i=qt.i,E.m=new OffscreenCanvas(1,1),E.i.canvas=E.m,ge=E.i.GL.createContext(E.m,{antialias:!1,alpha:!1,va:typeof WebGL2RenderingContext<"u"?2:1}),E.i.GL.makeContextCurrent(ge),qt.h=4;break;case 7:if(E.m=document.createElement("canvas"),Qt=E.m.getContext("webgl2",{}),!Qt&&(Qt=E.m.getContext("webgl",{}),!Qt))return alert("Failed to create WebGL canvas context when passing video frame."),qt.return();E.K=Qt,E.i.canvas=E.m,E.i.createContext(E.m,!0,!0,{});case 4:E.j=new E.i.SolutionWasm,E.ga=!1,qt.h=0}})}function cx(E){var D,U,X,de,ge,_e,Re,je;return P(function(ft){if(ft.h==1){if(E.h.graph&&E.h.graph.url&&E.fa===E.h.graph.url)return ft.return();if(E.u=!0,!E.h.graph||!E.h.graph.url){ft.h=2;return}return E.fa=E.h.graph.url,b(ft,up(E,E.h.graph.url),3)}for(ft.h!=2&&(D=ft.i,E.j.loadGraph(D)),U=o(Object.keys(E.D)),X=U.next();!X.done;X=U.next())de=X.value,E.j.overrideFile(de,E.D[de]);if(E.D={},E.h.listeners)for(ge=o(E.h.listeners),_e=ge.next();!_e.done;_e=ge.next())Re=_e.value,IC(E,Re);je=E.l,E.l={},E.setOptions(je),ft.h=0})}n.reset=function(){var E=this;return P(function(D){E.j&&(E.j.reset(),E.s={},E.v={}),D.h=0})},n.setOptions=function(E,D){var U=this;if(D=D||this.h.options){for(var X=[],de=[],ge={},_e=o(Object.keys(E)),Re=_e.next();!Re.done;ge={X:ge.X,Y:ge.Y},Re=_e.next())if(Re=Re.value,!(Re in this.l&&this.l[Re]===E[Re])){this.l[Re]=E[Re];var je=D[Re];je!==void 0&&(je.onChange&&(ge.X=je.onChange,ge.Y=E[Re],X.push(function(ft){return function(){var xt;return P(function(Qt){if(Qt.h==1)return b(Qt,ft.X(ft.Y),2);xt=Qt.i,xt===!0&&(U.u=!0),Qt.h=0})}}(ge))),je.graphOptionXref&&(Re=Object.assign({},{calculatorName:"",calculatorIndex:0},je.graphOptionXref,{valueNumber:je.type===1?E[Re]:0,valueBoolean:je.type===0?E[Re]:!1,valueString:je.type===2?E[Re]:""}),de.push(Re)))}(X.length!==0||de.length!==0)&&(this.u=!0,this.H=(this.H===void 0?[]:this.H).concat(de),this.F=(this.F===void 0?[]:this.F).concat(X))}};function fx(E){var D,U,X,de,ge,_e,Re;return P(function(je){switch(je.h){case 1:if(!E.u)return je.return();if(!E.F){je.h=2;break}D=o(E.F),U=D.next();case 3:if(U.done){je.h=5;break}return X=U.value,b(je,X(),4);case 4:U=D.next(),je.h=3;break;case 5:E.F=void 0;case 2:if(E.H){for(de=new E.i.GraphOptionChangeRequestList,ge=o(E.H),_e=ge.next();!_e.done;_e=ge.next())Re=_e.value,de.push_back(Re);E.j.changeOptions(de),de.delete(),E.H=void 0}E.u=!1,je.h=0}})}n.initialize=function(){var E=this;return P(function(D){return D.h==1?b(D,PC(E),2):D.h!=3?b(D,cx(E),3):b(D,fx(E),0)})};function up(E,D){var U,X;return P(function(de){return D in E.L?de.return(E.L[D]):(U=E.locateFile(D,""),X=fetch(U).then(function(ge){return ge.arrayBuffer()}),E.L[D]=X,de.return(X))})}n.overrideFile=function(E,D){this.j?this.j.overrideFile(E,D):this.D[E]=D},n.clearOverriddenFiles=function(){this.D={},this.j&&this.j.clearOverriddenFiles()},n.send=function(E,D){var U=this,X,de,ge,_e,Re,je,ft,xt,Qt;return P(function(qt){switch(qt.h){case 1:return U.h.inputs?(X=1e3*(D??performance.now()),b(qt,U.I,2)):qt.return();case 2:return b(qt,U.initialize(),3);case 3:for(de=new U.i.PacketDataList,ge=o(Object.keys(E)),_e=ge.next();!_e.done;_e=ge.next())if(Re=_e.value,je=U.h.inputs[Re]){e:{var Pt=E[Re];switch(je.type){case"video":var an=U.s[je.stream];if(an||(an=new uv(U.i,U.K),U.s[je.stream]=an),an.m===0&&(an.m=an.i.createTexture()),typeof HTMLVideoElement<"u"&&Pt instanceof HTMLVideoElement)var Cn=Pt.videoWidth,Ir=Pt.videoHeight;else typeof HTMLImageElement<"u"&&Pt instanceof HTMLImageElement?(Cn=Pt.naturalWidth,Ir=Pt.naturalHeight):(Cn=Pt.width,Ir=Pt.height);Ir={glName:an.m,width:Cn,height:Ir},Cn=an.h,Cn.canvas.width=Ir.width,Cn.canvas.height=Ir.height,Cn.activeTexture(Cn.TEXTURE0),an.i.bindTexture2d(an.m),Cn.texImage2D(Cn.TEXTURE_2D,0,Cn.RGBA,Cn.RGBA,Cn.UNSIGNED_BYTE,Pt),an.i.bindTexture2d(0),an=Ir;break e;case"detections":for(an=U.s[je.stream],an||(an=new sx(U.i),U.s[je.stream]=an),an.data||(an.data=new an.h.DetectionListData),an.data.reset(Pt.length),Ir=0;Ir<Pt.length;++Ir){Cn=Pt[Ir];var Ar=an.data,xi=Ar.setBoundingBox,Ha=Ir,ta=Cn.la,Gn=new lp;if(G(Gn,1,ta.sa),G(Gn,2,ta.ta),G(Gn,3,ta.height),G(Gn,4,ta.width),G(Gn,5,ta.rotation),Kr(Gn,6,ta.pa),ta=Gn.l(),xi.call(Ar,Ha,ta),Cn.ea)for(Ar=0;Ar<Cn.ea.length;++Ar){Gn=Cn.ea[Ar],xi=an.data,Ha=xi.addNormalizedLandmark,ta=Ir,Gn=Object.assign({},Gn,{visibility:Gn.visibility?Gn.visibility:0});var bi=new uu;G(bi,1,Gn.x),G(bi,2,Gn.y),G(bi,3,Gn.z),Gn.visibility&&G(bi,4,Gn.visibility),Gn=bi.l(),Ha.call(xi,ta,Gn)}if(Cn.ba)for(Ar=0;Ar<Cn.ba.length;++Ar)xi=an.data,Ha=xi.addClassification,ta=Ir,Gn=Cn.ba[Ar],bi=new vl,G(bi,2,Gn.qa),Gn.index&&Kr(bi,1,Gn.index),Gn.label&&Kr(bi,3,Gn.label),Gn.displayName&&Kr(bi,4,Gn.displayName),Gn=bi.l(),Ha.call(xi,ta,Gn)}an=an.data;break e;default:an={}}}switch(ft=an,xt=je.stream,je.type){case"video":de.pushTexture2d(Object.assign({},ft,{stream:xt,timestamp:X}));break;case"detections":Qt=ft,Qt.stream=xt,Qt.timestamp=X,de.pushDetectionList(Qt);break;default:throw Error("Unknown input config type: '"+je.type+"'")}}return U.j.send(de),b(qt,U.I,4);case 4:de.delete(),qt.h=0}})};function hx(E,D,U){var X,de,ge,_e,Re,je,ft,xt,Qt,qt,Pt,an,Cn,Ir;return P(function(Ar){switch(Ar.h){case 1:if(!U)return Ar.return(D);for(X={},de=0,ge=o(Object.keys(U)),_e=ge.next();!_e.done;_e=ge.next())Re=_e.value,je=U[Re],typeof je!="string"&&je.type==="texture"&&D[je.stream]!==void 0&&++de;1<de&&(E.M=!1),ft=o(Object.keys(U)),_e=ft.next();case 2:if(_e.done){Ar.h=4;break}if(xt=_e.value,Qt=U[xt],typeof Qt=="string")return Cn=X,Ir=xt,b(Ar,dx(E,xt,D[Qt]),14);if(qt=D[Qt.stream],Qt.type==="detection_list"){if(qt){for(var xi=qt.getRectList(),Ha=qt.getLandmarksList(),ta=qt.getClassificationsList(),Gn=[],bi=0;bi<xi.size();++bi){var yl=AC(xi.get(bi)),DC=Ie(yl,1),cp=Ie(yl,2),pv=Ie(yl,3),mv=Ie(yl,4),gv=Ie(yl,5,0),dc=void 0;dc=dc===void 0?0:dc,yl={la:{sa:DC,ta:cp,height:pv,width:mv,rotation:gv,pa:be(ur(yl,6),dc)},ea:z(ix(Ha.get(bi)),uu,1).map(ax),ba:MC(sp(ta.get(bi)))},Gn.push(yl)}xi=Gn}else xi=[];X[xt]=xi,Ar.h=7;break}if(Qt.type==="proto_list"){if(qt){for(xi=Array(qt.size()),Ha=0;Ha<qt.size();Ha++)xi[Ha]=qt.get(Ha);qt.delete()}else xi=[];X[xt]=xi,Ar.h=7;break}if(qt===void 0){Ar.h=3;break}if(Qt.type==="float_list"){X[xt]=qt,Ar.h=7;break}if(Qt.type==="proto"){X[xt]=qt,Ar.h=7;break}if(Qt.type!=="texture")throw Error("Unknown output config type: '"+Qt.type+"'");return Pt=E.v[xt],Pt||(Pt=new uv(E.i,E.K),E.v[xt]=Pt),b(Ar,cv(Pt,qt,E.M),13);case 13:an=Ar.i,X[xt]=an;case 7:Qt.transform&&X[xt]&&(X[xt]=Qt.transform(X[xt])),Ar.h=3;break;case 14:Cn[Ir]=Ar.i;case 3:_e=ft.next(),Ar.h=2;break;case 4:return Ar.return(X)}})}function dx(E,D,U){var X;return P(function(de){return typeof U=="number"||U instanceof Uint8Array||U instanceof E.i.Uint8BlobList?de.return(U):U instanceof E.i.Texture2dDataOut?(X=E.v[D],X||(X=new uv(E.i,E.K),E.v[D]=X),de.return(cv(X,U,E.M))):de.return(void 0)})}function IC(E,D){for(var U=D.name||"$",X=[].concat(l(D.wants)),de=new E.i.StringList,ge=o(D.wants),_e=ge.next();!_e.done;_e=ge.next())de.push_back(_e.value);ge=E.i.PacketListener.implement({onResults:function(Re){for(var je={},ft=0;ft<D.wants.length;++ft)je[X[ft]]=Re.get(ft);var xt=E.listeners[U];xt&&(E.I=hx(E,je,D.outs).then(function(Qt){Qt=xt(Qt);for(var qt=0;qt<D.wants.length;++qt){var Pt=je[X[qt]];typeof Pt=="object"&&Pt.hasOwnProperty&&Pt.hasOwnProperty("delete")&&Pt.delete()}Qt&&(E.I=Qt)}))}}),E.j.attachMultiListener(de,ge),de.delete()}n.onResults=function(E,D){this.listeners[D||"$"]=E},O("Solution",hv),O("OptionType",{BOOL:0,NUMBER:1,ua:2,0:"BOOL",1:"NUMBER",2:"STRING"});function px(E){switch(E===void 0&&(E=0),E){case 1:return"selfie_segmentation_landscape.tflite";default:return"selfie_segmentation.tflite"}}function dv(E){var D=this;E=E||{},this.h=new hv({locateFile:E.locateFile,files:function(U){return[{simd:!0,url:"selfie_segmentation_solution_simd_wasm_bin.js"},{simd:!1,url:"selfie_segmentation_solution_wasm_bin.js"},{data:!0,url:px(U.modelSelection)}]},graph:{url:"selfie_segmentation.binarypb"},listeners:[{wants:["segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window!="object"||window.navigator===void 0?!1:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelSelection:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelSelection",fieldName:"int_value"},onChange:function(U){var X,de,ge;return P(function(_e){return _e.h==1?(X=px(U),de="third_party/mediapipe/modules/selfie_segmentation/"+X,b(_e,up(D.h,X),2)):(ge=_e.i,D.h.overrideFile(de,ge),_e.return(!0))})}}}})}n=dv.prototype,n.close=function(){return this.h.close(),Promise.resolve()},n.onResults=function(E){this.h.onResults(E)},n.initialize=function(){var E=this;return P(function(D){return b(D,E.h.initialize(),0)})},n.reset=function(){this.h.reset()},n.send=function(E){var D=this;return P(function(U){return b(U,D.h.send(E),0)})},n.setOptions=function(E){this.h.setOptions(E)},O("SelfieSegmentation",dv),O("VERSION","0.1.1675465747")}).call(ho);/**
    * @license
    * Copyright 2022 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var DR=function(n,e){return DR=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])},DR(n,e)};function tne(n,e){function t(){this.constructor=n}DR(n,e),n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var oa=function(){return oa=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},oa.apply(this,arguments)};function pr(n,e,t,r){return new(t||(t=Promise))(function(i,a){function s(u){try{l(r.next(u))}catch(c){a(c)}}function o(u){try{l(r.throw(u))}catch(c){a(c)}}function l(u){var c;u.done?i(u.value):(c=u.value,c instanceof t?c:new t(function(f){f(c)})).then(s,o)}l((r=r.apply(n,e||[])).next())})}function mr(n,e){var t,r,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(u){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,r=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){s=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){s.label=c[1];break}if(c[0]===6&&s.label<i[1]){s.label=i[1],i=c;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(c);break}i[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(n,s)}catch(f){c=[6,f],r=0}finally{t=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}function wS(n){return n instanceof SVGAnimatedLength?n.baseVal.value:n}function Z3(n){return pr(this,void 0,void 0,function(){var e,t;return mr(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),n instanceof dr?[4,QT(n,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=wS(n.width),e.height=wS(n.height),t=e.getContext("2d"),n instanceof ImageData?t.putImageData(n,0,0):t.drawImage(n,0,0),r.label=3;case 3:return[2,e]}})})}function nne(n){return pr(this,void 0,void 0,function(){var e,t,r,i,a,s;return mr(this,function(o){switch(o.label){case 0:return n instanceof dr?(e=n.shape.slice(0,2),t=e[0],r=e[1],i=ImageData.bind,[4,QT(n)]):[3,2];case 1:return[2,new(i.apply(ImageData,[void 0,o.sent(),r,t]))];case 2:return a=document.createElement("canvas"),s=a.getContext("2d"),a.width=wS(n.width),a.height=wS(n.height),s.drawImage(n,0,0),[2,s.getImageData(0,0,a.width,a.height)]}})})}function rne(n){return pr(this,void 0,void 0,function(){var e,t;return mr(this,function(r){switch(r.label){case 0:return n instanceof SVGImageElement||n instanceof OffscreenCanvas?[4,Z3(n)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=n,r.label=3;case 3:return e=t,[2,JT(e,4)]}})})}function _C(n){if(n<0||n>=256)throw new Error("Mask value must be in range [0, 255] but got "+n);if(!Number.isInteger(n))throw new Error("Mask value must be an integer but got "+n)}function ine(n){var e=n.shape[2],t=ZO(n,2),r=nt(t,[-1]);return i_(r,e)}function r1(n,e){return tn(function(){return or(Yg(n,xn(e)),"int32")})}function Y8e(n,e){var t=e.shape,r=t[0],i=t[1],a=t[2];return tn(function(){var s=ine(e),o=es(wf(0,a,1,"int32"),1),l=or(nr(s,o),"int32"),u=nt(l,[r,i]),c=Jt(u,xn(1,"int32"));return bn(function(f,h){return St(f,h)}(c,n),xn(1,"int32"))})}var ane=function(){function n(e,t){this.model=e,this.outputStride=t;var r=this.model.inputs[0].shape;le(r[1]===-1&&r[2]===-1,function(){return"Input shape ["+r[1]+", "+r[2]+"] must both be equal to or -1"})}return n.prototype.predict=function(e){var t=this;return tn(function(){var r=t.preprocessInput(or(e,"float32")),i=es(r,0),a=t.model.predict(i).map(function(o){return oo(o,[0])}),s=t.nameOutputResults(a);return{heatmapScores:Vl(s.heatmap),offsets:s.offsets,displacementFwd:s.displacementFwd,displacementBwd:s.displacementBwd,segmentation:s.segmentation,partHeatmaps:s.partHeatmaps,longOffsets:s.longOffsets,partOffsets:s.partOffsets}})},n.prototype.dispose=function(){this.model.dispose()},n}(),Z8e=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return tne(e,n),e.prototype.preprocessInput=function(t){return tn(function(){return bn(Pr(t,127.5),1)})},e.prototype.nameOutputResults=function(t){return{offsets:t[0],segmentation:t[1],partHeatmaps:t[2],longOffsets:t[3],heatmap:t[4],displacementFwd:t[5],displacementBwd:t[6],partOffsets:t[7]}},e}(ane),xC=["nose","leftEye","rightEye","leftEar","rightEar","leftShoulder","rightShoulder","leftElbow","rightElbow","leftWrist","rightWrist","leftHip","rightHip","leftKnee","rightKnee","leftAnkle","rightAnkle"],Ho=xC.length,SS=xC.reduce(function(n,e,t){return n[e]=t,n},{});[["leftHip","leftShoulder"],["leftElbow","leftShoulder"],["leftElbow","leftWrist"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["rightHip","rightShoulder"],["rightElbow","rightShoulder"],["rightElbow","rightWrist"],["rightHip","rightKnee"],["rightKnee","rightAnkle"],["leftShoulder","rightShoulder"],["leftHip","rightHip"]].map(function(n){var e=n[0],t=n[1];return[SS[e],SS[t]]});function Q3(n,e,t){var r=n[0],i=n[1],a=e[0],s=e[1],o=t.top,l=t.bottom;return[s/(t.left+t.right+i),a/(o+l+r)]}function sne(n,e,t,r){return{y:r.get(n,e,t),x:r.get(n,e,t+Ho)}}function one(n,e,t){var r=sne(n.heatmapY,n.heatmapX,n.id,t),i=r.y,a=r.x;return{x:n.heatmapX*e+a,y:n.heatmapY*e+i}}function zH(n,e,t){return n<e?e:n>t?t:n}function VH(n,e){return{x:n.x+e.x,y:n.y+e.y}}function Q8e(n,e,t){t===void 0&&(t=.3);for(var r=0,i=0,a=0;a<n.length;a++)e.keypoints[a].score>t&&(i+=1,r+=Math.pow(n[a].x-e.keypoints[a].position.x,2)+Math.pow(n[a].y-e.keypoints[a].position.y,2));return i===0?r=1/0:r/=i,r}function J8e(n,e,t,r,i,a,s){for(var o=s[0],l=s[1],u=t(n),c=u.y*r+u.x,f=i[Ho*(2*c)+e],h=i[Ho*(2*c+1)+e],d=n.y+f,p=n.x+h,m=0;m<a;m++){d=Math.min(d,o-1);var g=t({x:p=Math.min(p,l-1),y:d}),v=g.y*r+g.x;d+=f=i[Ho*(2*v)+e],p+=h=i[Ho*(2*v+1)+e]}return{x:p,y:d}}function lne(n,e,t,r,i,a,s,o,l,u){for(var c=i[0],f=i[1],h=a[0],d=a[1],p=o[0],m=o[1],g=[],v=function(C){return function(k,R,P,N){var L=R[0],F=R[1],O=P[0],B=P[1],H=Math.round(((L+k.y+1)*B-1)/N);return{x:Math.round(((F+k.x+1)*O-1)/N),y:H}}(C,[c,f],[h,d],l)},_=0;_<r;_++){var x=J8e(n,_,v,s,e,u,[p,m]);g.push(x)}for(var b=-1,S=1/0,T=0;T<t.length;T++){var M=Q8e(g,t[T]);M<S&&(b=T,S=M)}return b}function une(n,e){var t=n[0],r=n[1];return[Math.round((r-1)/e+1),Math.round((t-1)/e+1)]}function cne(n,e,t,r,i,a,s,o,l,u,c){for(var f=s[0],h=s[1],d=n.shape,p=d[0],m=d[1],g=e.shape.slice(0,2),v=g[0],_=g[1],x=nt(e,[v,_,2,Ho]),b=new Float32Array(c*Ho*3).fill(0),S=0;S<t.length;S++)for(var T=S*Ho*3,M=t[S],C=0;C<Ho;C++){var k=M.keypoints[C],R=T+3*C;b[R]=k.score,b[R+1]=k.position.y,b[R+2]=k.position.x}var P=Q3([r,i],[f,h],o),N=P[0],L=P[1],F=go(b,[c,Ho,3]),O=o.top,B=o.left,H={variableNames:["segmentation","longOffsets","poses"],outputShape:[p,m],userCode:`
    int convertToPositionInOutput(int pos, int pad, float scale, int stride) {
      return round(((float(pos + pad) + 1.0) * scale - 1.0) / float(stride));
    }

    float convertToPositionInOutputFloat(
        int pos, int pad, float scale, int stride) {
      return ((float(pos + pad) + 1.0) * scale - 1.0) / float(stride);
    }

    float dist(float x1, float y1, float x2, float y2) {
      return pow(x1 - x2, 2.0) + pow(y1 - y2, 2.0);
    }

    float sampleLongOffsets(float h, float w, int d, int k) {
      float fh = fract(h);
      float fw = fract(w);
      int clH = int(ceil(h));
      int clW = int(ceil(w));
      int flH = int(floor(h));
      int flW = int(floor(w));
      float o11 = getLongOffsets(flH, flW, d, k);
      float o12 = getLongOffsets(flH, clW, d, k);
      float o21 = getLongOffsets(clH, flW, d, k);
      float o22 = getLongOffsets(clH, clW, d, k);
      float o1 = mix(o11, o12, fw);
      float o2 = mix(o21, o22, fw);
      return mix(o1, o2, fh);
    }

    int findNearestPose(int h, int w) {
      float prob = getSegmentation(h, w);
      if (prob < 1.0) {
        return -1;
      }

      // Done(Tyler): convert from output space h/w to strided space.
      float stridedH = convertToPositionInOutputFloat(
        h, `+O+", "+L+", "+a+`);
      float stridedW = convertToPositionInOutputFloat(
        w, `+B+", "+N+", "+a+`);

      float minDist = 1000000.0;
      int iMin = -1;
      for (int i = 0; i < `+c+`; i++) {
        float curDistSum = 0.0;
        int numKpt = 0;
        for (int k = 0; k < `+Ho+`; k++) {
          float dy = sampleLongOffsets(stridedH, stridedW, 0, k);
          float dx = sampleLongOffsets(stridedH, stridedW, 1, k);

          float y = float(h) + dy;
          float x = float(w) + dx;

          for (int s = 0; s < `+l+`; s++) {
            int yRounded = round(min(y, float(`+(r-1)+`)));
            int xRounded = round(min(x, float(`+(i-1)+`)));

            float yStrided = convertToPositionInOutputFloat(
              yRounded, `+O+", "+L+", "+a+`);
            float xStrided = convertToPositionInOutputFloat(
              xRounded, `+B+", "+N+", "+a+`);

            float dy = sampleLongOffsets(yStrided, xStrided, 0, k);
            float dx = sampleLongOffsets(yStrided, xStrided, 1, k);

            y = y + dy;
            x = x + dx;
          }

          float poseScore = getPoses(i, k, 0);
          float poseY = getPoses(i, k, 1);
          float poseX = getPoses(i, k, 2);
          if (poseScore > `+u+`) {
            numKpt = numKpt + 1;
            curDistSum = curDistSum + dist(x, y, poseX, poseY);
          }
        }
        if (numKpt > 0 && curDistSum / float(numKpt) < minDist) {
          minDist = curDistSum / float(numKpt);
          iMin = i;
        }
      }
      return iMin;
    }

    void main() {
        ivec2 coords = getOutputCoords();
        int nearestPose = findNearestPose(coords[0], coords[1]);
        setOutput(float(nearestPose));
      }
  `};return NQ().compileAndRun(H,[n,x,F])}function fne(){return DQ()==="webgl"}function e9e(n,e,t,r,i,a,s,o,l,u,c,f){var h=s[0],d=s[1];return l===void 0&&(l=.2),u===void 0&&(u=8),c===void 0&&(c=.3),f===void 0&&(f=10),pr(this,void 0,void 0,function(){var p,m,g,v,_;return mr(this,function(x){switch(x.label){case 0:return p=t.filter(function(b){return b.score>=l}),fne()?(g=tn(function(){var b=cne(n,e,p,r,i,a,[h,d],o,u,c,f),S=Cu().makeTensorFromDataId(b.dataId,b.shape,b.dtype);return p.map(function(T,M){return function(C,k){return tn(function(){return or(q_(C,xn(k)),"int32")})}(S,M)})}),[4,Promise.all(g.map(function(b){return b.data()}))]):[3,2];case 1:return m=x.sent(),g.forEach(function(b){return b.dispose()}),[3,5];case 2:return[4,n.data()];case 3:return v=x.sent(),[4,e.data()];case 4:_=x.sent(),m=function(b,S,T,M,C,k,R,P,N,L){var F=R[0],O=R[1];L===void 0&&(L=5);for(var B=T.map(function(me){return new Uint8Array(M*C).fill(0)}),H=P.top,j=P.left,K=Q3([M,C],[F,O],P),J=K[0],re=K[1],se=une([F,O],k)[0],Ae=0;Ae<M;Ae+=1)for(var Ee=0;Ee<C;Ee+=1){var Ne=Ae*C+Ee;if(b[Ne]===1){var we=lne({x:Ee,y:Ae},S,T,L,[H,j],[J,re],se,[M,C],k,N);we>=0&&(B[we][Ne]=1)}}return B}(v,_,p,r,i,a,[h,d],o,u),x.label=5;case 5:return[2,m.map(function(b,S){return{data:b,pose:p[S],width:i,height:r}})]}})})}function t9e(n,e,t,r,i,a,s,o,l,u,c,f,h){var d=o[0],p=o[1];return u===void 0&&(u=.2),c===void 0&&(c=8),f===void 0&&(f=.3),h===void 0&&(h=10),pr(this,void 0,void 0,function(){var m,g,v,_,x,b;return mr(this,function(S){switch(S.label){case 0:return m=r.filter(function(T){return T.score>=u}),fne()?(v=tn(function(){var T=cne(n,e,m,i,a,s,[d,p],l,c,f,h),M=Cu().makeTensorFromDataId(T.dataId,T.shape,T.dtype);return m.map(function(C,k){return function(R,P,N){return tn(function(){return bn(St(or(q_(R,xn(N)),"int32"),Jt(P,1)),1)})}(M,t,k)})}),[4,Promise.all(v.map(function(T){return T.data()}))]):[3,2];case 1:return g=S.sent(),v.forEach(function(T){return T.dispose()}),[3,6];case 2:return[4,n.data()];case 3:return _=S.sent(),[4,e.data()];case 4:return x=S.sent(),[4,t.data()];case 5:b=S.sent(),g=function(T,M,C,k,R,P,N,L,F,O,B){var H=L[0],j=L[1];B===void 0&&(B=5);for(var K=k.map(function(ke){return new Int32Array(R*P).fill(-1)}),J=F.top,re=F.left,se=Q3([R,P],[H,j],F),Ae=se[0],Ee=se[1],Ne=une([H,j],N)[0],we=0;we<R;we+=1)for(var me=0;me<P;me+=1){var Se=we*P+me;if(T[Se]===1){var Me=lne({x:me,y:we},M,k,B,[J,re],[Ae,Ee],Ne,[R,P],N,O);Me>=0&&(K[Me][Se]=C[Se])}}return K}(_,x,b,m,i,a,s,[d,p],l,c),S.label=6;case 6:return[2,g.map(function(T,M){return{pose:m[M],data:T,height:i,width:a}})]}})})}function bA(n){return Math.floor(n/2)}var n9e=function(){function n(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return n.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},n.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},n.prototype.empty=function(){return this.numberOfElements===-1},n.prototype.size=function(){return this.numberOfElements+1},n.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},n.prototype.max=function(){return this.priorityQueue[0]},n.prototype.swim=function(e){for(;e>0&&this.less(bA(e),e);)this.exchange(e,bA(e)),e=bA(e)},n.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},n.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},n.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},n.prototype.exchange=function(e,t){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=r},n}();function r9e(n,e,t,r,i,a){for(var s=a.shape,o=s[0],l=s[1],u=!0,c=Math.max(t-i,0),f=Math.min(t+i+1,o),h=c;h<f;++h){for(var d=Math.max(r-i,0),p=Math.min(r+i+1,l),m=d;m<p;++m)if(a.get(h,m,n)>e){u=!1;break}if(!u)break}return u}var hne=[["nose","leftEye"],["leftEye","leftEar"],["nose","rightEye"],["rightEye","rightEar"],["nose","leftShoulder"],["leftShoulder","leftElbow"],["leftElbow","leftWrist"],["leftShoulder","leftHip"],["leftHip","leftKnee"],["leftKnee","leftAnkle"],["nose","rightShoulder"],["rightShoulder","rightElbow"],["rightElbow","rightWrist"],["rightShoulder","rightHip"],["rightHip","rightKnee"],["rightKnee","rightAnkle"]].map(function(n){var e=n[0],t=n[1];return[SS[e],SS[t]]}),wA=hne.map(function(n){return n[1]}),HH=hne.map(function(n){return n[0]});function SA(n,e,t,r){return{y:zH(Math.round(n.y/e),0,t-1),x:zH(Math.round(n.x/e),0,r-1)}}function WH(n,e,t,r,i,a,s,o){o===void 0&&(o=2);for(var l=r.shape,u=l[0],c=l[1],f=function(_,x,b){var S=b.shape[2]/2;return{y:b.get(x.y,x.x,_),x:b.get(x.y,x.x,S+_)}}(n,SA(e.position,a,u,c),s),h=VH(e.position,f),d=0;d<o;d++){var p=SA(h,a,u,c),m=sne(p.y,p.x,t,i);h=VH({x:p.x*a,y:p.y*a},{x:m.x,y:m.y})}var g=SA(h,a,u,c),v=r.get(g.y,g.x,t);return{position:h,part:xC[t],score:v}}function i9e(n,e,t,r,i,a){var s=e.shape[2],o=wA.length,l=new Array(s),u=n.part,c=n.score,f=one(u,r,t);l[u.id]={score:c,part:xC[u.id],position:f};for(var h=o-1;h>=0;--h){var d=wA[h],p=HH[h];l[d]&&!l[p]&&(l[p]=WH(h,l[d],p,e,t,r,a))}for(h=0;h<o;++h)d=HH[h],p=wA[h],l[d]&&!l[p]&&(l[p]=WH(h,l[d],p,e,t,r,i));return l}function dne(n,e,t,r){var i=t.x,a=t.y;return n.some(function(s){var o,l,u,c,f,h,d=s.keypoints[r].position;return o=a,l=i,u=d.y,c=d.x,(f=u-o)*f+(h=c-l)*h<=e})}function a9e(n,e,t){var r=t.reduce(function(i,a,s){var o=a.position,l=a.score;return dne(n,e,o,s)||(i+=l),i},0);return r/t.length}function i1(n,e,t,r,i,a,s,o){s===void 0&&(s=.5),o===void 0&&(o=20);for(var l=[],u=function(p,m,g){for(var v=g.shape,_=v[0],x=v[1],b=v[2],S=new n9e(_*x*b,function(R){return R.score}),T=0;T<_;++T)for(var M=0;M<x;++M)for(var C=0;C<b;++C){var k=g.get(T,M,C);k<p||r9e(C,k,T,M,m,g)&&S.enqueue({score:k,part:{heatmapY:T,heatmapX:M,id:C}})}return S}(s,1,n),c=o*o;l.length<a&&!u.empty();){var f=u.dequeue();if(!dne(l,c,one(f.part,i,e),f.part.id)){var h=i9e(f,n,e,i,t,r),d=a9e(l,c,h);l.push({keypoints:h,score:d})}}return l}var ly,s9e=[-123.15,-115.9,-103.06],o9e=function(n){function e(){return n!==null&&n.apply(this,arguments)||this}return tne(e,n),e.prototype.preprocessInput=function(t){return Jt(t,s9e)},e.prototype.nameOutputResults=function(t){var r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],l=t[5];return{offsets:o,segmentation:t[6],partHeatmaps:l,longOffsets:s,heatmap:a,displacementFwd:i,displacementBwd:r,partOffsets:t[7]}},e}(ane),GH="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/resnet50/",jH="https://storage.googleapis.com/tfjs-models/savedmodel/bodypix/mobilenet/";function Ay(n){if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas||typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)return function(e){if("offsetHeight"in e&&e.offsetHeight!==0&&"offsetWidth"in e&&e.offsetWidth!==0)return[e.offsetHeight,e.offsetWidth];if(e.height!=null&&e.width!=null)return[e.height,e.width];throw new Error("HTMLImageElement must have height and width attributes set.")}(n);if(typeof ImageData<"u"&&n instanceof ImageData)return[n.height,n.width];if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)return function(e){return e.hasAttribute("height")&&e.hasAttribute("width")?[e.height,e.width]:[e.videoHeight,e.videoWidth]}(n);if(n instanceof dr)return[n.shape[0],n.shape[1]];throw new Error("error: Unknown input type: "+n+".")}function qH(n,e){return function(t,r){return(t-1)%r==0}(n,e)?n:Math.floor(n/e)*e+1}var My={low:"low",medium:"medium",high:"high",full:"full"},l9e=((ly={})[My.low]=.25,ly[My.medium]=.5,ly[My.high]=.75,ly[My.full]=1,ly);function a1(n,e,t){var r=t[0],i=t[1],a=function(s){if(typeof s=="string"){var o=l9e[s];return le(typeof o=="number",function(){return"string value of inputResolution must be one of "+Object.values(My).join(",")+" but was "+s+"."}),o}return le(typeof s=="number"&&s<=2&&s>=.1,function(){return"inputResolution must be a string or number between 0.1 and 2, but was "+s}),s}(n);return[qH(r*a,e),qH(i*a,e)]}function qp(n,e,t,r,i){var a=e[0],s=e[1],o=t[0],l=t[1],u=r[0],c=u[0],f=u[1],h=r[1],d=h[0],p=h[1];return i===void 0&&(i=!1),tn(function(){var m=Rd.resizeBilinear(n,[o,l],!0);return i&&(m=Vl(m)),function(g,v,_){var x=v[0],b=v[1],S=_[0],T=S[0],M=S[1],C=_[1],k=C[0],R=C[1];return tn(function(){var P=es(g);return oo(Rd.cropAndResize(P,[[T/(x+T+M-1),k/(b+k+R-1),(T+x-1)/(x+T+M-1),(k+b-1)/(b+k+R-1)]],[0],[x,b]),[0])})}(m,[a,s],[[c,f],[d,p]])})}function s1(n,e){var t=e[0],r=e[1],i=Ay(n),a=i[0],s=i[1],o=r/t,l=[0,0,0,0],u=l[0],c=l[1],f=l[2],h=l[3];s/a<o?(u=0,c=0,f=Math.round(.5*(o*a-s)),h=Math.round(.5*(o*a-s))):(u=Math.round(.5*(1/o*s-a)),c=Math.round(.5*(1/o*s-a)),f=0,h=0);var d=tn(function(){var p=function(m){return m instanceof dr?m:JT(m)}(n);return p=x3(p,[[u,c],[f,h],[0,0]]),Rd.resizeBilinear(p,[t,r])});return{resized:d,padding:{top:u,left:f,right:h,bottom:c}}}function o1(n){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,Promise.all(n.map(function(t){return t.buffer()}))]})})}function l1(n,e,t,r,i){var a=e[0],s=e[1],o=t[0],l=t[1],u=function(c,f,h,d,p){return d===void 0&&(d=0),p===void 0&&(p=0),h===1&&f===1&&d===0&&p===0?c:c.map(function(m){return function(g,v,_,x,b){return x===void 0&&(x=0),b===void 0&&(b=0),{score:g.score,keypoints:g.keypoints.map(function(S){var T=S.score,M=S.part,C=S.position;return{score:T,part:M,position:{x:C.x*_+b,y:C.y*v+x}}})}}(m,f,h,d,p)})}(n,(a+r.top+r.bottom)/o,(s+r.left+r.right)/l,-r.top,-r.left);return i?function(c,f){return f<=0?c:c.map(function(h){return function(d,p){return{score:d.score,keypoints:d.keypoints.map(function(m){var g=m.score,v=m.part,_=m.position;return{score:g,part:v,position:{x:p-1-_.x,y:_.y}}})}}(h,f)})}(u,s):u}var XH={architecture:"MobileNetV1",outputStride:16,quantBytes:4,multiplier:.75},KH=["MobileNetV1","ResNet50"],YH={MobileNetV1:[8,16,32],ResNet50:[32,16]},ZH={MobileNetV1:[.5,.75,1],ResNet50:[1]},QH=[1,2,4],u1={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20},c1={flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:10,scoreThreshold:.4,nmsRadius:20,minKeypointScore:.3,refineSteps:10};function JH(n){var e=n.segmentationThreshold,t=n.maxDetections,r=n.scoreThreshold,i=n.nmsRadius;if(e<0||e>1)throw new Error("segmentationThreshold "+e+". Should be in range [0.0, 1.0]");if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(r<0||r>1)throw new Error("Invalid scoreThreshold "+r+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".")}function eW(n){var e=n.segmentationThreshold,t=n.maxDetections,r=n.scoreThreshold,i=n.nmsRadius,a=n.minKeypointScore,s=n.refineSteps;if(e<0||e>1)throw new Error("segmentationThreshold "+e+". Should be in range [0.0, 1.0]");if(t<=0)throw new Error("Invalid maxDetections "+t+". Should be > 0");if(r<0||r>1)throw new Error("Invalid scoreThreshold "+r+". Should be in range [0.0, 1.0]");if(i<=0)throw new Error("Invalid nmsRadius "+i+".");if(a<0||a>1)throw new Error("Invalid minKeypointScore "+a+".Should be in range [0.0, 1.0]");if(s<=0||s>20)throw new Error("Invalid refineSteps "+s+".Should be in range [1, 20]")}var pne=function(){function n(e){this.baseModel=e}return n.prototype.predictForPersonSegmentation=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},n.prototype.predictForPersonSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,partHeatmapLogits:t.partHeatmaps,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd}},n.prototype.predictForMultiPersonInstanceSegmentationAndPart=function(e){var t=this.baseModel.predict(e);return{segmentLogits:t.segmentation,longOffsets:t.longOffsets,heatmapScores:t.heatmapScores,offsets:t.offsets,displacementFwd:t.displacementFwd,displacementBwd:t.displacementBwd,partHeatmaps:t.partHeatmaps}},n.prototype.segmentPersonActivation=function(e,t,r){var i=this;r===void 0&&(r=.5);var a=Ay(e),s=a[0],o=a[1],l=a1(t,this.baseModel.outputStride,[s,o]),u=s1(e,l),c=u.resized,f=u.padding,h=tn(function(){var _=i.predictForPersonSegmentation(c),x=_.segmentLogits,b=_.heatmapScores,S=_.offsets,T=_.displacementFwd,M=_.displacementBwd,C=c.shape,k=C[0],R=C[1],P=qp(x,[s,o],[k,R],[[f.top,f.bottom],[f.left,f.right]],!0);return{segmentation:r1(oo(P),r),heatmapScores:b,offsets:S,displacementFwd:T,displacementBwd:M}}),d=h.segmentation,p=h.heatmapScores,m=h.offsets,g=h.displacementFwd,v=h.displacementBwd;return c.dispose(),{segmentation:d,heatmapScores:p,offsets:m,displacementFwd:g,displacementBwd:v,padding:f,internalResolutionHeightAndWidth:l}},n.prototype.segmentPerson=function(e,t){return t===void 0&&(t=u1),pr(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,f,h,d,p,m,g,v,_,x,b;return mr(this,function(S){switch(S.label){case 0:return JH(t=oa(oa({},u1),t)),r=this.segmentPersonActivation(e,t.internalResolution,t.segmentationThreshold),i=r.segmentation,a=r.heatmapScores,s=r.offsets,o=r.displacementFwd,l=r.displacementBwd,u=r.padding,c=r.internalResolutionHeightAndWidth,f=i.shape,h=f[0],d=f[1],[4,i.data()];case 1:return p=S.sent(),i.dispose(),[4,o1([a,s,o,l])];case 2:return m=S.sent(),g=m[0],v=m[1],_=m[2],x=m[3],b=l1(b=i1(g,v,_,x,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[h,d],c,u,!1),a.dispose(),s.dispose(),o.dispose(),l.dispose(),[2,{height:h,width:d,data:p,allPoses:b}]}})})},n.prototype.segmentMultiPerson=function(e,t){return t===void 0&&(t=c1),pr(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,f,h,d,p,m,g,v,_,x,b,S,T,M,C=this;return mr(this,function(k){switch(k.label){case 0:return eW(t=oa(oa({},c1),t)),r=Ay(e),i=r[0],a=r[1],s=a1(t.internalResolution,this.baseModel.outputStride,[i,a]),o=s1(e,s),l=o.resized,u=o.padding,c=tn(function(){var R,P=C.predictForMultiPersonInstanceSegmentationAndPart(l),N=P.segmentLogits,L=P.longOffsets,F=P.heatmapScores,O=P.offsets,B=P.displacementFwd,H=P.displacementBwd,j=qp(N,[i,a],s,[[u.top,u.bottom],[u.left,u.right]],!0);return R=L,{segmentation:r1(oo(j),t.segmentationThreshold),longOffsets:R,heatmapScoresRaw:F,offsetsRaw:O,displacementFwdRaw:B,displacementBwdRaw:H}}),f=c.segmentation,h=c.longOffsets,d=c.heatmapScoresRaw,p=c.offsetsRaw,m=c.displacementFwdRaw,g=c.displacementBwdRaw,[4,o1([d,p,m,g])];case 1:return v=k.sent(),_=v[0],x=v[1],b=v[2],S=v[3],T=l1(T=i1(_,x,b,S,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[i,a],s,u,!1),[4,e9e(f,h,T,i,a,this.baseModel.outputStride,s,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return M=k.sent(),l.dispose(),f.dispose(),h.dispose(),d.dispose(),p.dispose(),m.dispose(),g.dispose(),[2,M]}})})},n.prototype.segmentPersonPartsActivation=function(e,t,r){var i=this;r===void 0&&(r=.5);var a=Ay(e),s=a[0],o=a[1],l=a1(t,this.baseModel.outputStride,[s,o]),u=s1(e,l),c=u.resized,f=u.padding,h=tn(function(){var _=i.predictForPersonSegmentationAndPart(c),x=_.segmentLogits,b=_.partHeatmapLogits,S=_.heatmapScores,T=_.offsets,M=_.displacementFwd,C=_.displacementBwd,k=c.shape,R=k[0],P=k[1],N=qp(x,[s,o],[R,P],[[f.top,f.bottom],[f.left,f.right]],!0),L=qp(b,[s,o],[R,P],[[f.top,f.bottom],[f.left,f.right]],!0);return{partSegmentation:Y8e(r1(oo(N),r),L),heatmapScores:S,offsets:T,displacementFwd:M,displacementBwd:C}}),d=h.partSegmentation,p=h.heatmapScores,m=h.offsets,g=h.displacementFwd,v=h.displacementBwd;return c.dispose(),{partSegmentation:d,heatmapScores:p,offsets:m,displacementFwd:g,displacementBwd:v,padding:f,internalResolutionHeightAndWidth:l}},n.prototype.segmentPersonParts=function(e,t){return t===void 0&&(t=u1),pr(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,f,h,d,p,m,g,v,_,x,b;return mr(this,function(S){switch(S.label){case 0:return JH(t=oa(oa({},u1),t)),r=this.segmentPersonPartsActivation(e,t.internalResolution,t.segmentationThreshold),i=r.partSegmentation,a=r.heatmapScores,s=r.offsets,o=r.displacementFwd,l=r.displacementBwd,u=r.padding,c=r.internalResolutionHeightAndWidth,f=i.shape,h=f[0],d=f[1],[4,i.data()];case 1:return p=S.sent(),i.dispose(),[4,o1([a,s,o,l])];case 2:return m=S.sent(),g=m[0],v=m[1],_=m[2],x=m[3],b=l1(b=i1(g,v,_,x,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[h,d],c,u,!1),a.dispose(),s.dispose(),o.dispose(),l.dispose(),[2,{height:h,width:d,data:p,allPoses:b}]}})})},n.prototype.segmentMultiPersonParts=function(e,t){return t===void 0&&(t=c1),pr(this,void 0,void 0,function(){var r,i,a,s,o,l,u,c,f,h,d,p,m,g,v,_,x,b,S,T,M,C,k=this;return mr(this,function(R){switch(R.label){case 0:return eW(t=oa(oa({},c1),t)),r=Ay(e),i=r[0],a=r[1],s=a1(t.internalResolution,this.baseModel.outputStride,[i,a]),o=s1(e,s),l=o.resized,u=o.padding,c=tn(function(){var P=k.predictForMultiPersonInstanceSegmentationAndPart(l),N=P.segmentLogits,L=P.longOffsets,F=P.heatmapScores,O=P.offsets,B=P.displacementFwd,H=P.displacementBwd,j=P.partHeatmaps,K=qp(N,[i,a],s,[[u.top,u.bottom],[u.left,u.right]],!0),J=qp(j,[i,a],s,[[u.top,u.bottom],[u.left,u.right]],!0),re=L,se=r1(oo(K),t.segmentationThreshold),Ae=function(Ee){var Ne=Ee.shape,we=Ne[0],me=Ne[1],Se=Ne[2];return tn(function(){var Me=ine(Ee),ke=es(wf(0,Se,1,"int32"),1),He=or(nr(Me,ke),"int32");return nt(He,[we,me])})}(J);return{segmentation:se,longOffsets:re,heatmapScoresRaw:F,offsetsRaw:O,displacementFwdRaw:B,displacementBwdRaw:H,partSegmentation:Ae}}),f=c.segmentation,h=c.longOffsets,d=c.heatmapScoresRaw,p=c.offsetsRaw,m=c.displacementFwdRaw,g=c.displacementBwdRaw,v=c.partSegmentation,[4,o1([d,p,m,g])];case 1:return _=R.sent(),x=_[0],b=_[1],S=_[2],T=_[3],M=l1(M=i1(x,b,S,T,this.baseModel.outputStride,t.maxDetections,t.scoreThreshold,t.nmsRadius),[i,a],s,u,!1),[4,t9e(f,h,v,M,i,a,this.baseModel.outputStride,s,u,t.scoreThreshold,t.refineSteps,t.minKeypointScore,t.maxDetections)];case 2:return C=R.sent(),l.dispose(),f.dispose(),h.dispose(),d.dispose(),p.dispose(),m.dispose(),g.dispose(),v.dispose(),[2,C]}})})},n.prototype.dispose=function(){this.baseModel.dispose()},n}();function u9e(n){return pr(this,void 0,void 0,function(){var e,t,r,i,a,s;return mr(this,function(o){switch(o.label){case 0:if(e=n.outputStride,t=n.quantBytes,r=n.multiplier,Yte==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return i=function(l,u,c){var f={1:"100",.75:"075",.5:"050"},h="model-stride"+l+".json";return c===4?jH+"float/"+f[u]+"/"+h:jH+"quant"+c+"/"+f[u]+"/"+h}(e,r,t),[4,Y3(n.modelUrl||i)];case 1:return a=o.sent(),s=new Z8e(a,e),[2,new pne(s)]}})})}function c9e(n){return pr(this,void 0,void 0,function(){var e,t,r,i,a;return mr(this,function(s){switch(s.label){case 0:if(e=n.outputStride,t=n.quantBytes,Yte==null)throw new Error(`Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this
        model.`);return r=function(o,l){var u="model-stride"+o+".json";return l===4?GH+"float/"+u:GH+"quant"+l+"/"+u}(e,t),[4,Y3(n.modelUrl||r)];case 1:return i=s.sent(),a=new o9e(i,e),[2,new pne(a)]}})})}function f9e(n){return n===void 0&&(n=XH),pr(this,void 0,void 0,function(){return mr(this,function(e){return(n=function(t){if((t=t||XH).architecture==null&&(t.architecture="MobileNetV1"),KH.indexOf(t.architecture)<0)throw new Error("Invalid architecture "+t.architecture+". Should be one of "+KH);if(t.outputStride==null&&(t.outputStride=16),YH[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride "+t.outputStride+". Should be one of "+YH[t.architecture]+" for architecture "+t.architecture+".");if(t.multiplier==null&&(t.multiplier=1),ZH[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier "+t.multiplier+". Should be one of "+ZH[t.architecture]+" for architecture "+t.architecture+".");if(t.quantBytes==null&&(t.quantBytes=4),QH.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes "+t.quantBytes+". Should be one of "+QH+" for architecture "+t.architecture+".");return t}(n)).architecture==="ResNet50"?[2,c9e(n)]:n.architecture==="MobileNetV1"?[2,u9e(n)]:[2,null]})})}var LR=["left_face","right_face","left_upper_arm_front","left_upper_arm_back","right_upper_arm_front","right_upper_arm_back","left_lower_arm_front","left_lower_arm_back","right_lower_arm_front","right_lower_arm_back","left_hand","right_hand","torso_front","torso_back","left_upper_leg_front","left_upper_leg_back","right_upper_leg_front","right_upper_leg_back","left_lower_leg_front","left_lower_leg_back","right_lower_leg_front","right_lower_leg_back","left_feet","right_feet"],tW=function(){function n(e){this.mask=e}return n.prototype.toCanvasImageSource=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,Z3(this.mask)]})})},n.prototype.toImageData=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,this.mask]})})},n.prototype.toTensor=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,rne(this.mask)]})})},n.prototype.getUnderlyingType=function(){return"imagedata"},n}();function h9e(n){if(_C(n),n!==255)throw new Error("Foreground id must be 255 but got "+n);return"person"}function d9e(n){if(_C(n),n>=LR.length)throw new Error("Invalid body part value "+n);return LR[n]}var p9e=function(){function n(e){this.bodyPixModel=e}return n.prototype.segmentPeople=function(e,t){return pr(this,void 0,void 0,function(){var r,i,a,s;return mr(this,function(o){switch(o.label){case 0:return e instanceof ImageBitmap&&((r=document.createElement("canvas")).getContext("2d").drawImage(e,0,0),e=r),t.segmentBodyParts?t.multiSegmentation?[4,this.bodyPixModel.segmentMultiPersonParts(e,t)]:[3,2]:[3,5];case 1:return a=o.sent(),[3,4];case 2:return[4,this.bodyPixModel.segmentPersonParts(e,t)];case 3:a=[o.sent()],o.label=4;case 4:return i=a.map(function(l){var u=l.data,c=l.width,f=l.height,h=new Uint8ClampedArray(c*f*4).fill(0);return u.forEach(function(d,p){d===-1?(h[4*p]=LR.length,h[4*p+3]=0):(h[4*p]=d,h[4*p+3]=255)}),{maskValueToLabel:d9e,mask:new tW(new ImageData(h,c,f))}}),[3,10];case 5:return t.multiSegmentation?[4,this.bodyPixModel.segmentMultiPerson(e,t)]:[3,7];case 6:return s=o.sent(),[3,9];case 7:return[4,this.bodyPixModel.segmentPerson(e,t)];case 8:s=[o.sent()],o.label=9;case 9:i=s.map(function(l){var u=l.data,c=l.width,f=l.height,h=new Uint8ClampedArray(c*f*4).fill(0);return u.forEach(function(d,p){d===0?(h[4*p]=0,h[4*p+3]=0):(h[4*p]=255,h[4*p+3]=255)}),{maskValueToLabel:h9e,mask:new tW(new ImageData(h,c,f))}}),o.label=10;case 10:return[2,i]}})})},n.prototype.dispose=function(){this.bodyPixModel.dispose()},n.prototype.reset=function(){},n}();function m9e(n){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,f9e(n).then(function(t){return new p9e(t)})]})})}var nW={runtime:"mediapipe",modelType:"general"},g9e=function(){function n(e){this.mask=e}return n.prototype.toCanvasImageSource=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,this.mask]})})},n.prototype.toImageData=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,nne(this.mask)]})})},n.prototype.toTensor=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,rne(this.mask)]})})},n.prototype.getUnderlyingType=function(){return"canvasimagesource"},n}();function v9e(n){return _C(n),"person"}var y9e=function(){function n(e){var t,r=this;this.selfieMode=!1,this.selfieSegmentationSolution=new K8e.SelfieSegmentation({locateFile:function(i,a){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+i:a+"/"+i}}),e.modelType==="landscape"?t=1:t=0,this.selfieSegmentationSolution.setOptions({modelSelection:t,selfieMode:this.selfieMode}),this.selfieSegmentationSolution.onResults(function(i){r.segmentation=[{maskValueToLabel:v9e,mask:new g9e(i.segmentationMask)}]})}return n.prototype.segmentPeople=function(e,t){return pr(this,void 0,void 0,function(){var r,i;return mr(this,function(a){switch(a.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.selfieSegmentationSolution.setOptions({selfieMode:this.selfieMode})),e instanceof dr?(i=ImageData.bind,[4,QT(e)]):[3,2];case 1:return r=new(i.apply(ImageData,[void 0,a.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:r=e,a.label=3;case 3:return e=r,[4,this.selfieSegmentationSolution.send({image:e})];case 4:return a.sent(),[2,this.segmentation]}})})},n.prototype.dispose=function(){this.selfieSegmentationSolution.close()},n.prototype.reset=function(){this.selfieSegmentationSolution.reset(),this.segmentation=null,this.selfieMode=!1},n.prototype.initialize=function(){return this.selfieSegmentationSolution.initialize()},n}();function _9e(n){return pr(this,void 0,void 0,function(){var e,t;return mr(this,function(r){switch(r.label){case 0:return e=function(i){if(i==null)return oa({},nW);var a=oa({},i);return a.runtime="mediapipe",a.modelType==null&&(a.modelType=nW.modelType),a}(n),[4,(t=new y9e(e)).initialize()];case 1:return r.sent(),[2,t]}})})}function x9e(n,e,t,r){var i=n.width,a=n.height,s=r?-1:1,o=Math.cos(n.rotation),l=Math.sin(n.rotation),u=n.xCenter,c=n.yCenter,f=1/e,h=1/t,d=new Array(16);return d[0]=i*o*s*f,d[1]=-a*l*f,d[2]=0,d[3]=(-.5*i*o*s+.5*a*l+u)*f,d[4]=i*l*s*h,d[5]=a*o*h,d[6]=0,d[7]=(-.5*a*o-.5*i*l*s+c)*h,d[8]=0,d[9]=0,d[10]=i*f,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,function(p){if(p.length!==16)throw new Error("Array length must be 16 but got "+p.length);return[[p[0],p[1],p[2],p[3]],[p[4],p[5],p[6],p[7]],[p[8],p[9],p[10],p[11]],[p[12],p[13],p[14],p[15]]]}(d)}function mne(n){return n instanceof dr?{height:n.shape[0],width:n.shape[1]}:{height:n.height,width:n.width}}function TA(n,e){le(n.width!==0,function(){return e+" width cannot be 0."}),le(n.height!==0,function(){return e+" height cannot be 0."})}function b9e(n,e){var t=function(r,i,a,s){var o=i-r,l=s-a;if(o===0)throw new Error("Original min and max are both "+r+", range cannot be 0.");var u=l/o;return{scale:u,offset:a-r*u}}(0,255,e[0],e[1]);return tn(function(){return Jt(St(n,t.scale),t.offset)})}function w9e(n,e,t){var r=e.outputTensorSize,i=e.keepAspectRatio,a=e.borderMode,s=e.outputTensorFloatRange,o=mne(n),l=function(h,d){return d?{xCenter:d.xCenter*h.width,yCenter:d.yCenter*h.height,width:d.width*h.width,height:d.height*h.height,rotation:d.rotation}:{xCenter:.5*h.width,yCenter:.5*h.height,width:h.width,height:h.height,rotation:0}}(o,t),u=function(h,d,p){if(p===void 0&&(p=!1),!p)return{top:0,left:0,right:0,bottom:0};var m=d.height,g=d.width;TA(d,"targetSize"),TA(h,"roi");var v,_,x=m/g,b=h.height/h.width,S=0,T=0;return x>b?(v=h.width,_=h.width*x,T=(1-b/x)/2):(v=h.height/x,_=h.height,S=(1-x/b)/2),h.width=v,h.height=_,{top:T,left:S,right:S,bottom:T}}(l,r,i),c=x9e(l,o.width,o.height,!1),f=tn(function(){var h,d=(h=n)instanceof dr?h:JT(h),p=ld(function(v,_,x){return TA(x,"inputResolution"),[1/x.width*v[0][0]*_.width,1/x.height*v[0][1]*_.width,v[0][3]*_.width,1/x.width*v[1][0]*_.height,1/x.height*v[1][1]*_.height,v[1][3]*_.height,0,0]}(c,o,r),[1,8]),m=a==="zero"?"constant":"nearest",g=Rd.transform(es(or(d,"float32")),p,"bilinear",m,0,[r.height,r.width]);return s!=null?b9e(g,s):g});return{imageTensor:f,padding:u,transformationMatrix:c}}function S9e(n,e,t){return tn(function(){var r=oo(n,[0]),i=r.shape[2];if(i===1){var a=r;switch(e.activation){case"none":break;case"sigmoid":a=Vl(a);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported ("+e.activation+")")}var s=t?Rd.resizeBilinear(a,[t.height,t.width]):a;return oo(s,[2])}throw new Error("Unsupported number of tensor channels "+i)})}var rW={runtime:"tfjs",modelType:"general",modelUrl:"https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1"},iW={flipHorizontal:!1},T9e={outputTensorSize:{width:256,height:256},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},C9e={outputTensorSize:{width:256,height:144},keepAspectRatio:!1,borderMode:"zero",outputTensorFloatRange:[0,1]},E9e={activation:"none"},A9e=function(){function n(e){this.mask=e}return n.prototype.toCanvasImageSource=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,Z3(this.mask)]})})},n.prototype.toImageData=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,nne(this.mask)]})})},n.prototype.toTensor=function(){return pr(this,void 0,void 0,function(){return mr(this,function(e){return[2,this.mask]})})},n.prototype.getUnderlyingType=function(){return"tensor"},n}();function M9e(n){return _C(n),"person"}var TS,k9e=function(){function n(e,t){this.modelType=e,this.model=t}return n.prototype.segmentPeople=function(e,t){return pr(this,void 0,void 0,function(){var r,i=this;return mr(this,function(a){return t=function(s){if(s==null)return oa({},iW);var o=oa({},s);return o.flipHorizontal==null&&(o.flipHorizontal=iW.flipHorizontal),o}(t),e==null?(this.reset(),[2,[]]):(r=tn(function(){var s=w9e(e,i.modelType==="general"?T9e:C9e).imageTensor,o=Tr(i.model.predict(s),[0,0,0,1],-1),l=mne(e),u=S9e(o,E9e,l),c=es(u,2),f=Kd(c,[[0,0],[0,0],[0,1]]);return y3(f,[[0,0],[0,0],[0,2]],"symmetric")}),[2,[{maskValueToLabel:M9e,mask:new A9e(r)}]])})})},n.prototype.dispose=function(){this.model.dispose()},n.prototype.reset=function(){},n}();function R9e(n){return pr(this,void 0,void 0,function(){var e,t,r;return mr(this,function(i){switch(i.label){case 0:return e=function(a){if(a==null)return oa({},rW);var s=oa({},a);if(s.runtime="tfjs",s.modelType==null&&(s.modelType=rW.modelType),s.modelType!=="general"&&s.modelType!=="landscape")throw new Error("Model type must be one of general or landscape, but got "+s.modelType);return s.modelUrl==null&&(s.modelType==="general"?s.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/general/1":s.modelUrl="https://tfhub.dev/mediapipe/tfjs-model/selfie_segmentation/landscape/1"),s}(n),t=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Y3(e.modelUrl,{fromTFHub:t})];case 1:return r=i.sent(),[2,new k9e(e.modelType,r)]}})})}function xit(n,e){return pr(this,void 0,void 0,function(){var t,r;return mr(this,function(i){switch(n){case TS.MediaPipeSelfieSegmentation:if(t=void 0,(r=e)!=null){if(r.runtime==="tfjs")return[2,R9e(r)];if(r.runtime==="mediapipe")return[2,_9e(r)];t=r.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+t);case TS.BodyPix:return[2,m9e(r=e)];default:throw new Error(n+" is not a supported model name.")}})})}(function(n){n.BodyPix="BodyPix",n.MediaPipeSelfieSegmentation="MediaPipeSelfieSegmentation"})(TS||(TS={}));function P9e(n,e,t,r,i,a){a===void 0&&(a={r:0,g:255,b:255,a:255});for(var s=-i;s<=i;s++)for(var o=-i;o<=i;o++)if(s!==0&&o!==0){var l=(e+s)*r+(t+o);n[4*l+0]=a.r,n[4*l+1]=a.g,n[4*l+2]=a.b,n[4*l+3]=a.a}}function I9e(n,e,t,r,i,a,s){s===void 0&&(s=1);for(var o=0,l=-s;l<=s;l++)for(var u=-s;u<=s;u++)if(l!==0&&u!==0){var c=(e+l)*r+(t+u);(!i[n[4*c]]||n[4*c+3]<a)&&(o+=1)}return o>0}function bit(n,e,t,r,i,a){return e===void 0&&(e={r:0,g:0,b:0,a:0}),t===void 0&&(t={r:0,g:0,b:0,a:255}),r===void 0&&(r=!1),i===void 0&&(i=.5),a===void 0&&(a=Array.from(Array(256).keys())),pr(this,void 0,void 0,function(){var s,o,l,u,c,f,h,d,p,m,g,v,_,x;return mr(this,function(b){switch(b.label){case 0:return(s=Array.isArray(n)?n:[n]).length===0?[2,null]:[4,Promise.all(s.map(function(S){return S.mask.toImageData()}))];case 1:for(o=b.sent(),l=o[0],u=l.width,c=l.height,f=new Uint8ClampedArray(u*c*4),h=Math.round(255*i),d=new Array(256).fill(!1),a.forEach(function(S){return d[S]=!0}),p=0;p<c;p++)for(m=0;m<u;m++)for(f[4*(g=p*u+m)+0]=t.r,f[4*g+1]=t.g,f[4*g+2]=t.b,f[4*g+3]=t.a,v=0,_=o;v<_.length;v++)x=_[v],d[x.data[4*g]]&&x.data[4*g+3]>=h&&(f[4*g]=e.r,f[4*g+1]=e.g,f[4*g+2]=e.b,f[4*g+3]=e.a,r&&p-1>=0&&p+1<c&&m-1>=0&&m+1<u&&I9e(x.data,p,m,u,d,h)&&P9e(f,p,m,u,1));return[2,new ImageData(f,u,c)]}})})}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nh={},f1={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function D9e(n,e){Nh[n]=e}function rl(n,e){if(!(n in Nh)||e!=null){const r=N9e(n,e);if(r!==null)Nh[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=Nh[n];return t==null||t.isContextLost()?(delete Nh[n],rl(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Nh[n])}function L9e(n){if(typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function N9e(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??L9e(n);return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Nh[n]},!1),We().getBool("SOFTWARE_WEBGL_ENABLED")&&(f1.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",f1)||t.getContext("experimental-webgl",f1):t.getContext("webgl2",f1)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var h_;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(h_||(h_={}));var As;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(As||(As={}));var $i;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})($i||($i={}));function Z_(n,e){return[e,n]}function O9e(n,e){return n*e}function h1(n){const e=yt(n),t=Math.ceil(e/4);return aS(t)}function Qg(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function $9e(n,e){const[t,r]=Qg(n,e);return t*r*4}function J3(n,e){const t=n;let r,i,a,s,o,l,u,c,f,h;return We().getNumber("WEBGL_VERSION")===2?(r=t.R32F,i=t.R16F,a=t.RGBA16F,s=t.RGBA32F,o=t.RED,u=4,c=1,f=t.HALF_FLOAT,h=t.FLOAT,l=t.RGBA8):(r=n.RGBA,i=n.RGBA,a=n.RGBA,s=t.RGBA,o=n.RGBA,u=4,c=4,f=e!=null?e.HALF_FLOAT_OES:null,h=n.FLOAT,l=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:s,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:f,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ut(n,e){const t=e();return We().getBool("DEBUG")&&F9e(n),t}function F9e(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+V9e(n,e))}const B9e=596e-10,U9e=65504;function z9e(n){return!!(We().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||B9e<Math.abs(n)&&Math.abs(n)<U9e)}function V9e(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function d1(n,e){return sc(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function H9e(n,e){const t=sc(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ut(n,()=>n.shaderSource(t,e)),Ut(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function W9e(n,e){const t=sc(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ut(n,()=>n.shaderSource(t,e)),Ut(n,()=>n.compileShader(t)),We().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw gne(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const G9e=/ERROR: [0-9]+:([0-9]+):/g;function gne(n,e){const t=G9e.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],i=n.split(`
`),a=i.length.toString().length+2,s=i.map((f,h)=>id((h+1).toString(),a)+f);let o=0;for(let f=0;f<s.length;f++)o=Math.max(s[f].length,o);const l=s.slice(0,r-1),u=s.slice(r-1,r),c=s.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${id(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function j9e(n){return sc(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function q9e(n,e){if(Ut(n,()=>n.linkProgram(e)),!We().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function CA(n,e){if(Ut(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function X9e(n,e){const t=sc(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ut(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),Ut(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function K9e(n,e){const t=sc(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return Ut(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),Ut(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function Y9e(n){return sc(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function Z9e(n,e){const t=We().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,i=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function Q9e(n){return sc(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function aW(n,e,t,r,i,a,s){const o=n.getAttribLocation(e,t);return o===-1?!1:(Ut(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),Ut(n,()=>n.vertexAttribPointer(o,i,n.FLOAT,!1,a,s)),Ut(n,()=>n.enableVertexAttribArray(o)),!0)}function J9e(n,e,t){ije(n,t),Ut(n,()=>n.activeTexture(n.TEXTURE0+t)),Ut(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function eje(n,e,t){return sc(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function tje(n,e,t){return n.getUniformLocation(e,t)}function nje(n,e,t,r){Ut(n,()=>J9e(n,e,r)),Ut(n,()=>n.uniform1i(t,r))}function EA(n,e,t){Ut(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),Ut(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function sW(n,e){Ut(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),Ut(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function p1(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+rje(n,e))}function rje(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function sc(n,e,t){const r=Ut(n,()=>e());if(r==null)throw new Error(t);return r}function ije(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const i=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Tg(n,e=2){return yt(n.slice(0,n.length-e))}function Cg(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function AA(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Tg(n),...Cg(n)]),e}function aje(n,e=!1){let t=We().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=We().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&We().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((o,l)=>l>=n.length-2?GT(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=ic(n).newShape);let i=yt(n),a=null;n.length<=1&&i<=t?a=[1,i]:n.length===2&&n[0]<=t&&n[1]<=t?a=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?a=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?a=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?a=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(a=[n[0],n[1]*n[2]*n[3]]);const s=a!=null&&Math.max(...a)>r&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||s)if(e){const o=Tg(n);let l=2,u=2;n.length&&([l,u]=Cg(n)),i=o*(l/2)*(u/2),a=aS(i).map(c=>c*2)}else a=aS(i);return a}function m1(n){return n%2===0}function CS(n,e){if(n=n.slice(-2),e=e.slice(-2),Jr(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||m1(t)&&m1(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&m1(n[0])&&m1(e[0])}let MA,kA;function sje(n){if(MA==null){const e=rl(n);MA=e.getParameter(e.MAX_TEXTURE_SIZE)}return MA}function oje(n){if(kA==null){const e=rl(n);kA=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,kA)}function lje(n){if(n===0)return 0;let e;const t=rl(n);return uo(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:uo(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function uo(n,e){return n.getExtension(e)!=null}function oW(n){try{if(rl(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function uje(n){if(n===0)return!1;const e=rl(n);if(n===1){if(!uo(e,"OES_texture_float"))return!1}else if(!uo(e,"EXT_color_buffer_float"))return!1;return NR(e)}function cje(n){if(n===0)return!1;const e=rl(n);if(n===1){if(!uo(e,"OES_texture_float")||!uo(e,"WEBGL_color_buffer_float"))return!1}else{if(uo(e,"EXT_color_buffer_float"))return NR(e);const r="EXT_color_buffer_half_float";if(uo(e,r)){const i=e.getExtension(r);return fje(e,i)}return!1}return NR(e)}function NR(n){const e=J3(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);const r=1,i=1;n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,r,i,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const s=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(a),s}function fje(n,e){const t=J3(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r);const i=1,a=1;n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,i,a,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const s=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,s),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const o=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(s),o}function hje(n){return n!==2?!1:rl(n).fenceSync!=null}function Q_(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&le(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wt=We();Wt.registerFlag("HAS_WEBGL",()=>Wt.getNumber("WEBGL_VERSION")>0);Wt.registerFlag("WEBGL_VERSION",()=>oW(2)?2:oW(1)?1:0);Wt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Wt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Wt.get("WEBGL_VERSION")===2);Wt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Wt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Wt.registerFlag("WEBGL_PACK",()=>Wt.getBool("HAS_WEBGL"));Wt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_CLIP",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_PACK_REDUCE",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_LAZILY_UNPACK",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_CONV_IM2COL",()=>Wt.getBool("WEBGL_PACK"));Wt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>sje(Wt.getNumber("WEBGL_VERSION")));Wt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>oje(Wt.getNumber("WEBGL_VERSION")));Wt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Wt.getNumber("WEBGL_VERSION");return n===0?0:lje(n)});Wt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Wt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!PO());Wt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>uje(Wt.getNumber("WEBGL_VERSION")));Wt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Wt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Wt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Wt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>cje(Wt.getNumber("WEBGL_VERSION")));Wt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>hje(Wt.getNumber("WEBGL_VERSION")));Wt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Wt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Wt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Wt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>PO()?1:-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Wt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Wt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Wt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Wt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Wt.registerFlag("WEBGL_EXP_CONV",()=>!1);Wt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Wt.getBool("IS_TEST"));Wt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Wt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Wt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(){let n,e,t,r,i,a,s,o,l,u;return We().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",i="texture",a="outputColor",s="out vec4 outputColor;",o=We().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",i="texture2D",a="gl_FragColor",s="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:i,output:a,defineOutput:s,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zd(n,e,t="index"){const r=Ai(e);return r.map((i,a)=>{const s=`int ${n[a]} = ${t} / ${i}`,o=a===r.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * ${i}`:`index -= ${n[a]} * ${i}`;return`${s}; ${o};`}).join("")}function bC(n,e,t="index"){const r=Ai(e);return r.map((i,a)=>{const s=`int ${n[a]} = ${t} / outShapeStrides[${a}]`,o=a===r.length-1?`int ${n[a+1]} = ${t} - ${n[a]} * outShapeStrides[${a}]`:`index -= ${n[a]} * outShapeStrides[${a}]`;return`${s}; ${o};`}).join("")}function dje(n,e){const t=n.length,r=n.map(a=>`${e}[${a}]`),i=new Array(t-1);i[t-2]=r[t-1];for(let a=t-3;a>=0;--a)i[a]=`(${i[a+1]} * ${r[a+1]})`;return i}function pje(n,e,t="index"){const r=n.map((a,s)=>s),i=dje(r,e);return i.map((a,s)=>{const o=`int ${n[s]} = ${t} / ${i[s]}`,l=s===i.length-1?`int ${n[s+1]} = ${t} - ${n[s]} * ${i[s]}`:`index -= ${n[s]} * ${i[s]}`;return`${o}; ${l};`}).join("")}function e$(n){const e=Ai(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function t$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const vne=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:yne}=Kte;function mje(n,e,t){const r=[];if(n.forEach(d=>{const p=yt(d.shapeInfo.logicalShape);if(d.shapeInfo.isUniform?r.push(`uniform float ${d.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${d.name};`),r.push(`uniform int offset${d.name};`)),t.enableShapeUniforms){const{uniformShape:m}=n$(t.packedInputs,d.shapeInfo.logicalShape,d.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${d.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${d.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${d.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${d.name}Shape;`);break}r.push(`uniform ivec2 ${d.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(d=>{r.push(`uniform ${d.type} ${d.name}${d.arrayIndex?`[${d.arrayIndex}]`:""};`)});const i=r.join(`
`),a=n.map(d=>gje(d,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),s=e.texShape,o=Sa(),l=_je(o);let u,c,f=wje(o);return e.isPacked?(u=vje(e.logicalShape,s,t.enableShapeUniforms),c=bje(o)):(u=yje(e.logicalShape,s,t.enableShapeUniforms),c=xje(o)),t.packedInputs&&(f+=Eje),[f,l,c,i,u,a,t.userCode].join(`
`)}function Jg(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return Fje(n,e);case 1:return Uje(n,e);case 2:return Vje(n,e);case 3:return Wje(n,e);case 4:return jje(n,e);case 5:return qje(n);case 6:return Xje(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function _ne(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return $je(n);case 1:return Bje(n,e);case 2:return zje(n,e);case 3:return Hje(n,e);default:return Gje(n,e)}}function gje(n,e,t=!1,r){let i="";t?i+=_ne(n,r):i+=Jg(n,r);const a=n.shapeInfo.logicalShape,s=e.logicalShape;return a.length<=s.length&&(t?i+=Kje(n,e):i+=Yje(n,e)),i}function vje(n,e,t){switch(n.length){case 0:return xne();case 1:return Aje(n,e,t);case 2:return Nje(n,e,t);case 3:return kje(n,e,t);default:return Pje(n,e,t)}}function yje(n,e,t){switch(n.length){case 0:return xne();case 1:return Mje(n,e,t);case 2:return Oje(n,e,t);case 3:return Rje(n,e,t);case 4:return Ije(n,e,t);case 5:return Dje(n,e);case 6:return Lje(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function _je(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function xje(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function bje(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function wje(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Sje}
    ${Tje}
    ${Cje}
  `}const Sje=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Tje=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Cje=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Eje=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function xne(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Aje(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Mje(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function kje(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(n[2]/2),a=i*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function Rje(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${bC(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=Zd(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Pje(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(n[n.length-1]/2),a=i*Math.ceil(n[n.length-2]/2);let s=a,o="",l="b, r, c";for(let u=2;u<n.length-1;u++)s*=n[n.length-u-1],o=`
      int b${u} = index / ${s};
      index -= b${u} * ${s};
    `+o,l=`b${u}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${n.length}(${l});
    }
  `}function Ije(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${bC(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Zd(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Dje(n,e){const t=Zd(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Lje(n,e){const t=Zd(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Nje(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Jr(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function Oje(n,e,t){return Jr(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Qd(n){return`offset${n}`}function $je(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Sa();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Fje(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[i,a]=n.shapeInfo.texShape;if(i===1&&a===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const s=Qd(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${s});
      return sampleTexture(${t}, uv);
    }
  `;const[o,l]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${s});
      return sampleTexture(${t}, uv);
    }
  `}function Bje(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),i=n.shapeInfo.texShape,a=Sa();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${t}, uv);
    }
  `;const s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${s[0]}, ${s[1]}, index);
      return ${a.texture2D}(${t}, uv);
    }
  `}function Uje(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${ev(n)}
      }
    `;const i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const o=Qd(t);return s===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${a}.0);
        return sampleTexture(${t}, uv);
      }
    `:a===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${s}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${o});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${a}, ${s}, index + ${o});
      return sampleTexture(${t}, uv);
    }
  `}function zje(n,e){const t=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n.shapeInfo.texShape,s=a[0],o=a[1],l=Sa();if(a!=null&&Jr(t,a))return e?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${s}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(t[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function Vje(n,e){const t=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n.shapeInfo.texShape;if(a!=null&&Jr(t,a)){if(e)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=a[0],d=a[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:s,keptDims:o}=ic(t),l=s;if(l.length<t.length){const h=tv(n,l),d=["row","col"];return`
      ${Jg(h,e)}
      float ${i}(int row, int col) {
        return ${i}(${nv(d,o)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${ev(n)}
      }
    `;const u=a[0],c=a[1],f=Qd(r);return c===1?e?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function Hje(n,e){const t=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=n.shapeInfo.texShape,s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(t[0]===1){const h=t.slice(1),d=[1,2],p=tv(n,h),m=["b","row","col"];return`
        ${_ne(p,e)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${nv(m,d)});
        }
      `}const o=Sa();if(e)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const l=s[0],u=s[1],c=Math.ceil(t[2]/2),f=c*Math.ceil(t[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${c}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function Wje(n,e){const t=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t[1]*t[2],s=t[2],{newShape:o,keptDims:l}=ic(t),u=o;if(u.length<t.length){const m=tv(n,u),g=["row","col","depth"];return`
        ${Jg(m,e)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${nv(g,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${s}, 1)));
        ${ev(n)}
      }
    `;const c=n.shapeInfo.texShape,f=c[0],h=c[1],d=n.shapeInfo.flatOffset;if(h===a&&d==null)return e?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${s}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${f}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===s&&d==null)return e?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Qd(r);return e?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${s} + depth + ${p};
        vec2 uv = uvFromFlat(${f}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Gje(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),i=Sa();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${t}, uv);
    }
  `;const a=n.shapeInfo.logicalShape,s=a.length,o=n.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],f=Math.ceil(a[s-1]/2);let h=f*Math.ceil(a[s-2]/2),d="int b, int row, int col",p=`b * ${h} + (row / 2) * ${f} + (col / 2)`;for(let m=2;m<s-1;m++)d=`int b${m}, `+d,h*=a[s-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${r}(${d}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${i.texture2D}(${t}, uv);
    }
  `}function jje(n,e){const t=n.shapeInfo.logicalShape,r=n.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),a=t[3],s=t[2]*a,o=t[1]*s,{newShape:l,keptDims:u}=ic(t);if(l.length<t.length){const _=tv(n,l),x=["row","col","depth","depth2"];return`
      ${Jg(_,e)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${nv(x,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${s}, ${a}, 1)));
        ${ev(n)}
      }
    `;const c=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,h=f[0],d=f[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(d===o&&c==null)return e?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${s}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(d===a&&c==null)return e?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const v=Qd(r);return e?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${v});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${h}, ${d}, index + ${v});
      return sampleTexture(${r}, uv);
    }
  `}function qje(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),i=e[4],a=e[3]*i,s=e[2]*a,o=e[1]*s,{newShape:l,keptDims:u}=ic(e);if(l.length<e.length){const m=tv(n,l),g=["row","col","depth","depth2","depth3"];return`
      ${Jg(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${nv(g,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${s}, ${a}, ${i})) +
          depth3;
        ${ev(n)}
      }
    `;const c=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,h=f[0],d=f[1];if(d===o&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${s}, ${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${d}.0, ${h}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(d===i&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${d}.0, ${h}.0);
        return sampleTexture(${t}, uv);
      }
    `;const p=Qd(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${s} + depth * ${a} +
          depth2 * ${i} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${d}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Xje(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:i,keptDims:a}=ic(e);if(i.length<e.length){const g=tv(n,i),v=["row","col","depth","depth2","depth3","depth4"];return`
      ${Jg(g)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${nv(v,a)});
      }
    `}const s=e[5],o=e[4]*s,l=e[3]*o,u=e[2]*l,c=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${s}, 1)));
        ${ev(n)}
      }
    `;const f=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,d=h[0],p=h[1];if(p===c&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${s})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(p===s&&f==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;const m=Qd(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${s} + depth4 + ${m};
      vec2 uv = uvFromFlat(${d}, ${p}, index);
      return sampleTexture(${t}, uv);
    }
  `}function ev(n){const e=n.name,t=yt(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Kje(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),i="get"+r+"AtOutCoords",a=n.shapeInfo.logicalShape.length,s=e.logicalShape.length,o=yne(n.shapeInfo.logicalShape,e.logicalShape),l=$r(s),u=s-a;let c;const f=["x","y","z","w","u","v"];a===0?c="":s<2&&o.length>=1?c="coords = 0;":c=o.map(_=>`coords.${f[_+u]} = 0;`).join(`
`);let h="";s<2&&a>0?h="coords":h=n.shapeInfo.logicalShape.map((_,x)=>`coords.${f[x+u]}`).join(", ");let d="return outputValue;";const m=yt(n.shapeInfo.logicalShape)===1,v=yt(e.logicalShape)===1;if(a===1&&!m&&!v)d=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!v)s===1?d=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:d=`
        return vec4(outputValue.x);
      `;else if(o.length){const _=a-2,x=a-1;o.indexOf(_)>-1&&o.indexOf(x)>-1?d="return vec4(outputValue.x);":o.indexOf(_)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(x)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${h});
      ${d}
    }
  `}function Yje(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),i="get"+r+"AtOutCoords",a=e.texShape,s=n.shapeInfo.texShape,o=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&o===l&&n.shapeInfo.flatOffset==null&&Jr(s,a))return`
      float ${i}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=$r(l),c=yne(n.shapeInfo.logicalShape,e.logicalShape),f=l-o;let h;const d=["x","y","z","w","u","v"];o===0?h="":l<2&&c.length>=1?h="coords = 0;":h=c.map(m=>`coords.${d[m+f]} = 0;`).join(`
`);let p="";return l<2&&o>0?p="coords":p=n.shapeInfo.logicalShape.map((m,g)=>`coords.${d[g+f]}`).join(", "),`
    float ${i}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function $r(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function n$(n,e,t){const{newShape:r,keptDims:i}=ic(e),a=e.length,s=n&&a===3&&e[0]===1,o=s?e.slice(1):r,l=!n&&a>1&&!Jr(e,t)&&r.length<a||s;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:i}}function tv(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function nv(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zje(n,e,t,r){const i=t.map((c,f)=>{const h={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(h.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:h}}),a=i.map(c=>c.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=mje(i,s,e),l=W9e(n.gl,o),u=n.createProgram(l);return We().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:a,outShapeInfo:s,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:a,outShapeInfo:s},bne(n,e,u))}function bne(n,e,t){const r={},i={},a={},s=[];let o,l,u,c=null,f=null;f=n.getUniformLocation(t,"NAN",!1),We().getNumber("WEBGL_VERSION")===1&&(c=n.getUniformLocation(t,"INFINITY",!1));const h=!1;for(let d=0;d<e.variableNames.length;d++){const p=e.variableNames[d];r[p]=n.getUniformLocation(t,p,h),r[`offset${p}`]=n.getUniformLocation(t,`offset${p}`,h),e.enableShapeUniforms&&(i[`${p}Shape`]=n.getUniformLocation(t,`${p}Shape`,h),a[`${p}TexShape`]=n.getUniformLocation(t,`${p}TexShape`,h))}return e.enableShapeUniforms&&(o=n.getUniformLocation(t,"outShape",h),u=n.getUniformLocation(t,"outShapeStrides",h),l=n.getUniformLocation(t,"outTexShape",h)),e.customUniforms&&e.customUniforms.forEach((d,p)=>{s[p]=n.getUniformLocation(t,d.name,h)}),{uniformLocations:r,customUniformLocations:s,infLoc:c,nanLoc:f,inShapesLocations:i,inTexShapesLocations:a,outShapeLocation:o,outShapeStridesLocation:u,outTexShapeLocation:l}}function lW(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const i=t.logicalShape,a=e[r],s=a.shape;if(!Jr(i,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${s} must match`);if(t.isUniform&&a.isUniform)return;const o=t.texShape,l=a.isUniform?null:a.texData.texShape;if(!Jr(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function Qje(n,e,t,r,i){e.program.enableShapeUniforms||(lW(e.inShapeInfos,t),lW([e.outShapeInfo],[r]));const a=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(a.texture,s[0],s[1]):n.setOutputMatrixTexture(a.texture,s[0],s[1]),n.setProgram(e.webGLProgram),We().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN),t.forEach((l,u)=>{const c=e.program.variableNames[u],f=e.uniformLocations[c],h=e.uniformLocations[`offset${c}`],d=e.inShapesLocations[`${c}Shape`],p=e.inTexShapesLocations[`${c}TexShape`];if(d){const{uniformShape:m}=n$(e.program.packedInputs,l.shape,l.texData.texShape);switch(m.length){case 1:n.gl.uniform1iv(d,new Int32Array(m));break;case 2:n.gl.uniform2iv(d,new Int32Array(m));break;case 3:n.gl.uniform3iv(d,new Int32Array(m));break;case 4:n.gl.uniform4iv(d,new Int32Array(m));break}}if(p&&n.gl.uniform2i(p,l.texData.texShape[0],l.texData.texShape[1]),f!=null){if(l.isUniform){if(yt(l.shape)<2)n.gl.uniform1f(f,l.uniformValues[0]);else{let m=l.uniformValues;m instanceof Float32Array||(m=new Float32Array(m)),n.gl.uniform1fv(f,m)}return}l.texData.slice!=null&&h!=null&&n.gl.uniform1i(h,l.texData.slice.flatOffset),n.setInputMatrixTexture(l.texData.texture.texture,f,u)}});const o=e.outShapeLocation;if(o)switch(r.shape.length){case 1:n.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(o,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Ai(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&i&&e.program.customUniforms.forEach((l,u)=>{const c=e.customUniformLocations[u],f=i[u];if(l.type==="float")n.gl.uniform1fv(c,f);else if(l.type==="vec2")n.gl.uniform2fv(c,f);else if(l.type==="vec3")n.gl.uniform3fv(c,f);else if(l.type==="vec4")n.gl.uniform4fv(c,f);else if(l.type==="int")n.gl.uniform1iv(c,f);else if(l.type==="ivec2")n.gl.uniform2iv(c,f);else if(l.type==="ivec3")n.gl.uniform3iv(c,f);else if(l.type==="ivec4")n.gl.uniform4iv(c,f);else throw Error(`uniform type ${l.type} is not supported yet.`)}),n.executeProgram()}function Jje(n,e,t){let r="";e.concat(t).forEach(s=>{const o=s.texData!=null&&s.texData.slice!=null&&s.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!s.isUniform){const l=s.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:f}=n$(n.packedInputs,s.shape,l);let h="",d="",p="";if(c.length===1&&n.packedInputs){const S=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${S[0]>1}_${S[1]>1}`}else if(c.length===2&&!n.packedInputs)d=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!n.packedInputs){const S=Ai(c);p=`${S[0]===l[1]}_${S[S.length-1]===l[1]}`}const m=s.shape.length,g=c.length===2&&Jr(s.shape,l),v=yt(s.shape)===1,_=s_(s.shape,t.shape),x=!n.packedInputs&&m===t.shape.length&&Jr(l,t.texData.texShape),b=n.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${x}_${u?f:""}_${c.length}_${v}_${_}_${g}_${h}_${d}_${p}_${b}_${o}`}else{const l=s.isUniform?"uniform":s.texData.texShape;r+=`${s.shape}_${l}_${o}`}});const i=n.userCode;let a=n.constructor.name;return a+="_"+r+"_"+i+`${We().getNumber("WEBGL_VERSION")}`,a}function Ta(n){return We().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e7e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=h_.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Sa();this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?bC(["r","c","d"],e):Zd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t7e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=h_.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Sa();this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?bC(["r","c","d"],e):Zd(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n7e{constructor(e){this.variableNames=["A"],this.outTexUsage=As.DOWNLOAD;const t=Sa();this.outputShape=e,this.userCode=`
      ${vne}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r7e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=As.DOWNLOAD;const t=Sa();this.outputShape=e,this.userCode=`
      ${vne}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i7e{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Sa();this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length);let i="result";t&&(i="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?t$():e$(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${r.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a7e{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Sa();this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length);let i="",a="result";t&&(a="floor(result * 255. + 0.5)");for(let s=0;s<=1;s++)for(let o=0;o<=1;o++){const l=s*2+o;i+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${s} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${s};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?t$():e$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7e(n){const e=Sa(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return H9e(n,t)}function o7e(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return X9e(n,e)}function l7e(n){const e=new Uint16Array([0,1,2,2,1,3]);return K9e(n,e)}function J_(n,e,t,r,i,a){Z9e(e,t);const s=Y9e(n),o=n.TEXTURE_2D;return Ut(n,()=>n.bindTexture(o,s)),Ut(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),Ut(n,()=>n.texParameteri(o,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),Ut(n,()=>n.texParameteri(o,n.TEXTURE_MIN_FILTER,n.NEAREST)),Ut(n,()=>n.texParameteri(o,n.TEXTURE_MAG_FILTER,n.NEAREST)),We().getNumber("WEBGL_VERSION")===1?Ut(n,()=>n.texImage2D(o,0,r,e,t,0,i,a,null)):Ut(n,()=>n.texStorage2D(o,1,r,e,t)),Ut(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:s,texShape:[t,e]}}function wne(n){return n.internalFormatFloat}function u7e(n,e,t,r){const[i,a]=Z_(e,t);return J_(n,i,a,wne(r),r.textureFormatFloat,n.FLOAT)}function Sne(n){return n.internalFormatHalfFloat}function c7e(n,e,t,r){const[i,a]=Z_(e,t);return J_(n,i,a,Sne(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Tne(n){return n.downloadTextureFormat}function f7e(n,e,t,r){const[i,a]=Z_(e,t);return J_(n,i,a,Tne(r),n.RGBA,n.UNSIGNED_BYTE)}function Cne(n){return n.internalFormatPackedFloat}function h7e(n,e,t,r){const[i,a]=Qg(e,t);return J_(n,i,a,Cne(r),n.RGBA,n.FLOAT)}function Ene(n){return n.internalFormatPackedHalfFloat}function d7e(n,e,t,r){const[i,a]=Qg(e,t);return J_(n,i,a,Ene(r),n.RGBA,r.textureTypeHalfFloat)}function p7e(n,e,t){return Ut(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),aW(n,e,"clipSpacePos",t,3,20,0)&&aW(n,e,"uv",t,2,20,12)}function m7e(n,e,t,r,i,a){Ut(n,()=>n.bindTexture(n.TEXTURE_2D,e));let s,o,l;i instanceof Uint8Array?(s=new Uint8Array(t*r*4),o=n.UNSIGNED_BYTE,l=n.RGBA):(s=new Float32Array(t*r*4),o=n.FLOAT,l=a.internalFormatPackedFloat),s.set(i),We().getNumber("WEBGL_VERSION")===2?Ut(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,o,s)):Ut(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,r,0,n.RGBA,o,s)),Ut(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function g7e(n,e,t){Ut(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?We().getNumber("WEBGL_VERSION")===2?Ut(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):Ut(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):We().getNumber("WEBGL_VERSION")===2?Ut(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):Ut(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),Ut(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function v7e(n,e,t,r){const i=n.createBuffer();Ut(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,i));const o=4*4*e*t;return Ut(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,o,n.STREAM_READ)),Ut(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),Ut(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),i}function y7e(n,e,t){const r=n,i=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function _7e(n,e,t,r){const[i,a]=Z_(e,t),s=4,o=new Uint8Array(O9e(e*t,s));return Ut(n,()=>n.readPixels(0,0,i,a,r.downloadTextureFormat,n.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function x7e(n,e,t,r,i,a,s,o){const l=n,u=new Float32Array($9e(a,s));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function b7e(n,e,t){const r=new Float32Array(e*t*4);return Ut(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RA{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const t=We().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,D9e(t,e)):this.gl=rl(t);let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),We().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",s="OES_texture_half_float";if(this.textureFloatExtension=d1(this.gl,a),uo(this.gl,s))this.textureHalfFloatExtension=d1(this.gl,s);else if(We().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),uo(this.gl,i))this.colorBufferHalfFloatExtension=d1(this.gl,i);else if(We().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",uo(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(uo(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=o7e(this.gl),this.indexBuffer=l7e(this.gl),this.framebuffer=Q9e(this.gl),this.textureConfig=J3(this.gl,this.textureHalfFloatExtension)}get debug(){return We().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ut(e,()=>e.finish()),Ut(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ut(e,()=>e.deleteFramebuffer(this.framebuffer)),Ut(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ut(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ut(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),u7e(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),c7e(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),f7e(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),g7e(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,i){this.throwIfDisposed(),m7e(this.gl,e,t,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),d7e(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),h7e(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(sW(this.gl,this.framebuffer),this.outputTexture=null),Ut(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>_7e(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,i,a,s){return x7e(this.gl,e,t,r,i,a,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return y7e(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const i=v7e(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(We().getBool("WEBGL_FENCE_API_ENABLED")){const i=e,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},t=a}else We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>b7e(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=s7e(t));const r=j9e(t);return Ut(t,()=>t.attachShader(r,this.vertexShader)),Ut(t,()=>t.attachShader(r,e)),q9e(t,r),this.debug&&CA(t,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=p7e(t,this.program,this.vertexBuffer)),r}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Ut(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&CA(this.gl,this.program),Ut(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?eje(this.gl,e,t):tje(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Ut(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),nje(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[i,a]=Qg(t,r);this.setOutputMatrixTextureDriver(e,i,a)}setOutputMatrixWriteRegion(e,t,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,t)}setOutputPackedMatrixWriteRegion(e,t,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&CA(this.gl,this.program),p1(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),Ut(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ut(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=d1(this.gl,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await nR(()=>this.disposed||this.isQueryAvailable(e,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),a=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=w7e(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in We().platform&&(r=We().platform.setTimeoutCustom.bind(We().platform)),nR(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),EA(this.gl,e,this.framebuffer),this.debug&&p1(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(EA(this.gl,this.outputTexture,this.framebuffer),this.debug&&p1(this.gl)):sW(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const i=this.gl;EA(i,e,this.framebuffer),this.debug&&p1(i),this.outputTexture=e,Ut(i,()=>i.viewport(0,0,t,r)),Ut(i,()=>i.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,i){this.throwIfDisposed(),Ut(this.gl,()=>this.gl.scissor(e,t,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function w7e(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7e(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ns(n){return(e,t,r,i,a)=>{const s=Kn(e,t),o=s.length,l=Ai(s),u=yt(s),c=Xl(a,u),f=e.length,h=t.length,d=Ai(e),p=Ai(t),m=s_(e,s),g=s_(t,s);if(m.length+g.length===0)for(let v=0;v<c.length;++v)c[v]=n(r[v%r.length],i[v%i.length]);else for(let v=0;v<c.length;++v){const _=jT(v,o,l),x=_.slice(-f);m.forEach(M=>x[M]=0);const b=lS(x,f,d),S=_.slice(-h);g.forEach(M=>S[M]=0);const T=lS(S,h,p);c[v]=n(r[b],i[T])}return[c,s]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T7e(n,e,t,r){if(r==="int32"){const i=Int32Array.from(n);return[e,"int32",i]}if(r==="bool"){const i=U_([0],t),[a,s]=Ns((o,l)=>o!==l?1:0)(e,[],n,i,"bool");return[s,"bool",a]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7e=Ns((n,e)=>n+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7e(n,e,t,r,i){const a=yt(r),s=Qu(i,t);for(let o=0;o<n.length;o++){const l=n[o];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(a>0?s[l]+=e[o]:s[l]+=1)}return s}function A7e(n,e,t,r=!1){const i=n.shape[0],a=n.shape[1],s=ei([i,t],e.dtype);for(let o=0;o<i;o++)for(let l=0;l<a;l++){const u=n.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(r?s.set(1,o,u):e.size>0?s.set(s.get(o,u)+e.get(o,l),o,u):s.set(s.get(o,u)+1,o,u))}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nf(n){return(e,t,r)=>{const i=Xl(t,e.length);for(let a=0;a<e.length;++a)i[a]=n(e[a],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7e=Nf(n=>Math.ceil(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7e(n,e,t,r){const i=ga(t,yt(e));if(r&&t!=="string"){let a=0;n.forEach(s=>{const o=yt(s.shape);i.set(s.vals,a),a+=o})}else{let a=0;n.forEach(s=>{const o=t==="string"?f_(s.vals):s.vals;let l=0;for(let u=0;u<s.shape[0];++u){const c=u*e[1]+a;for(let f=0;f<s.shape[1];++f)i[c+f]=o[l++]}a+=s.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7e=Ns((n,e)=>n===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7e=Nf(n=>Math.exp(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7e=Nf(n=>Math.expm1(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D7e=Nf(n=>Math.floor(n));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7e(n,e,t,r,i,a,s,o,l){const u=ei([r,a],t);for(let c=0;c<r;c++){const f=[];let h=0;for(let d=0;d<i;d++){const p=n[c*i+d];h+=p*s[d],f.push(p)}if(h<0||h>=l/a)throw new Error(`Invalid indices: ${f} does not index into ${o}`);for(let d=0;d<a;d++)u.values[c*a+d]=e.get(...e.indexToLoc(h*a+d))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7e(n,e,t){const r=ei(t,n.dtype);for(let i=0;i<r.size;++i){const s=r.indexToLoc(i).slice(),o=s[0],l=s[2],u=e.locToIndex([o,l]);s[2]=e.values[u];const c=n.locToIndex(s);0<=c&&c<n.values.length&&(r.values[i]=n.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7e=Ns((n,e)=>n>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7e=Ns((n,e)=>n>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F7e=Ns((n,e)=>n<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B7e=Ns((n,e)=>n<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7e(n,e,t){const r=(e-n)/(t-1),i=Qu(t,"float32");i[0]=n;for(let a=1;a<i.length;a++)i[a]=i[a-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z7e=Nf(n=>Math.log(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7e(n,e,t,r){const i=Xl(r,yt(t));for(let a=0;a<i.length;++a){const s=a*e;let o=n[s];for(let l=0;l<e;++l){const u=n[s+l];(Number.isNaN(u)||u>o)&&(o=u)}i[a]=o}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H7e=Ns((n,e)=>Math.max(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7e=Ns((n,e)=>Math.min(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ane=Ns((n,e)=>n*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7e(n,e,t){const r=qd(-1,t);return Ane([],e,r,n,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7e=Ns((n,e)=>n!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7e(n,e,t,r,i){const a=e.length,s=yt(e),o=Ai(e),l=Ai(i),u=Xl(t,yt(i));for(let c=0;c<s;++c){const f=jT(c,a,o),h=new Array(f.length);for(let p=0;p<h.length;p++)h[p]=f[r[p]];const d=lS(h,a,l);u[d]=n[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X7e(n,e,t,r){const[i,a]=ru(n,r),s=nl(e,"int32"),o=Qu(yt(i),s),l=yt(a);for(let u=0;u<o.length;++u){const c=u*l;let f=1;for(let h=0;h<l;++h)f*=t[c+h];o[u]=f}return{outVals:o,outShape:i,outDtype:s}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7e(n,e,t){n.forEach((r,i)=>{if(r<0||r>=t){const a=jT(i,e.length,Ai(e)).join(",");throw new Error(`indices[${a}] = ${r} is not in [0, ${t})`)}})}function Y7e(n,e){for(let t=0;t<n.length;++t){const r=n[t],i=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let a=1;a<r.length;++a)if(r[a-1]>r[a])throw new Error("Ragged splits must be sorted in ascending order")}}function Z7e(n,e,t,r){const i=[];let a=0;const s=e.length-1+t.length,o=new Array(s).fill(null).map(()=>[0]);Y7e(t,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let f=1;f<l+1;++f)o[u].push(f*c)}for(let u=0;u<n.length;++u){let c=n[u],f=n[u]+1;for(let h=0;h<t.length;++h){const d=t[h],p=h+e.length-1;if(p>=0){const m=o[p],g=m[m.length-1]-d[c];for(let v=c;v<f;++v)o[p].push(d[v+1]+g)}c=d[c],f=d[f]}f!==c&&(i.push([c,f]),a+=f-c)}return{outSplits:o,valueSlices:i,numValues:a}}function Q7e(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,i=ga("int32",r);e.push(i),n[t].forEach((a,s)=>i[s]=a)}return e}function uW(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function J7e(n,e,t,r,i,a){const s=uW(e,2)[1],o=uW(a,2)[1];let l=0;for(const u of t)for(let c=u[0];c<u[1];++c){for(let f=0;f<r;++f)i[l*o+f]=n[c*s+f];++l}}function eqe(n,e,t,r,i){const a=e.slice();a[0]=i;const s=ga(t,yt(a)),o=n.length,l=o===0?0:o/e[0];return J7e(n,e,r,l,s,a),[s,a]}function tqe(n,e,t,r,i,a,s,o){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(K7e(a,s,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:f,numValues:h}=Z7e(a,s,n,u),d=Q7e(c),p=eqe(t,r,i,f,h);return[d,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var zs=Vo;class ES{constructor(e,t,r,i,a,s,o,l,u,c){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=i,this.valuesDType=a,this.defaultValue=s,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=pte(c),this.raggedRank=mte(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===zs.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===zs.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case zs.VALUE_ROWIDS:return ES.getMaxWidthValueRowID(t);case zs.ROW_SPLITS:return ES.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${zs[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let i=0;i<t-1;++i){const a=e[i+1]-e[i];a>r&&(r=a)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,i=e[0],a=0;for(let s=1;s<t;++s){const o=e[s];o!==i&&(i=o,a=Math.max(s-r,a),r=s)}return Math.max(t-r,a)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return fW(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;gte(r,t);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),s=dte(this.raggedRank,i,t);s[0]<0&&(s[0]=e);for(let o=1;o<=this.raggedRank;++o)s[o]<0&&(s[o]=this.getMaxWidth(o));return s}calculateFirstParentOutputIndex(e,t,r){const i=Math.min(e,r),a=[];let s=0;for(let o=0;o<i;++o,s+=t)a.push(s);for(let o=i;o<e;++o)a.push(-1);return le(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,t,r,i){const a=e.length,s=[];for(let o=0;o<a-1;++o){const l=e[o+1]-e[o];let u=Math.min(i,l),c=t[o];c===-1&&(u=0);for(let f=0;f<u;++f)s.push(c),c+=r;for(let f=0;f<l-u;++f)s.push(-1)}if(a>0&&s.length!==e[a-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(e,t,r,i){const a=e.length,s=[];if(a===0)return[];let o=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];s.push(u);for(let c=1;c<a;++c){const f=e[c];if(f===l)u>=0&&(++o,o<i?u+=r:u=-1);else{if(o=0,l=f,f>=t.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${t.length}`);u=t[f]}s.push(u)}if(s.length!==e.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(e,t,r,i){const a=this.getRowPartitionTensor(e),s=this.getRowPartitionTypeByDimension(e);switch(s){case zs.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,r,i);case zs.ROW_SPLITS:if(a.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(a,t,r,i);default:throw new Error(`Unsupported partition type: ${zs[s]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case zs.FIRST_DIM_SIZE:return e[0];case zs.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case zs.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${zs[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];const a=fW(r,!1),s=ga(this.valuesDType,yt(a));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(t,i[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,i[u],r[u]);this.setOutput(this.raggedRank,l,s,a)}return[a,s]}setOutput(e,t,r,i){if(r.length===0)return;const a=this.values,s=r;let o=i.slice();o=o.slice(e+1);const l=yt(o),u=t.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;tn(()=>{const m=nt(c,p);c=Bm(m,o).dataSync()})}let f=0,h=0,d=0;for(let p=0;p<=u;++p){let m=p<u?t[p]:-1;if(m===d){++d;continue}if(h<d){const g=a.subarray(f*l),v=s.subarray(h*l),_=(d-h)*l;cW(v,g,_)}if(p>=u){const g=r.length;m=Math.floor(g/l)}if(m>d)if(this.defaultValue.length===1)s.subarray(d*l,m*l).fill(this.defaultValue[0]),d=m;else for(;m>d;){const g=s.slice(d*l);cW(g,c,l),++d}m<0?(f=p+1,h=d):(f=p,h=d,d=h+1)}}}function cW(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function fW(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function nqe(n,e,t,r,i,a,s,o,l,u){return new ES(n,e,t,r,i,a,s,o,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rqe(n,e,t,r){const i=n===e,a=n<e&&t<0,s=e<n&&t>1;if(i||a||s)return Qu(0,r);const o=Math.abs(Math.ceil((e-n)/t)),l=Qu(o,r);e<n&&t===1&&(t=-1),l[0]=n;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iqe=Nf(n=>1/Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aqe(n,e,t,r,i,a,s,o,l,u){const c=[r/i,i],f=n.values,h=e.values;if(r===0)return ei(t,e.dtype);const d=ei(c,e.dtype);typeof l=="string"||typeof l=="number"?d.values.fill(l):typeof l=="boolean"&&d.values.fill(+l);for(let p=0;p<a;p++){const m=[];let g=0;for(let v=0;v<s;v++){const _=f[p*s+v];m.push(_),g+=_*o[v]}if(g<0||g>=r/i)throw new Error(`Invalid indices: ${m} does not index into ${t}`);for(let v=0;v<i;v++)u?d.values[g*i+v]+=h[p*i+v]:d.values[g*i+v]=e.rank===0?h[0]:h[p*i+v]}return d}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sqe=Nf(n=>1/(1+Math.exp(-n)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oqe(n,e,t,r,i){const a=jO(r,e,t),s=yt(t),o=Ai(r);if(a){const f=qO(e,o);return i==="string"?n.slice(f,f+s):n.subarray(f,f+s)}const l=i==="string"?f_(n):n,u=ei(r,i,l),c=ei(t,i);for(let f=0;f<c.size;++f){const h=c.indexToLoc(f),d=h.map((p,m)=>p+e[m]);c.set(u.get(...d),...h)}return i==="string"?Xte(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lqe(n,e,t,r,i,a,s){const o=e[0],l=a[0],u=new Array(l),c=new Array(o),f=e[1];if(l===0){if(o!==0)throw new Error(Lte(o));const g=ga(t,0),v=ga(i,0);return[g,[0,f],v,u,c]}let h=!0,d=0;const p=new Array(l).fill(0);for(let g=0;g<o;++g){const v=n[g*f];if(v<0)throw new Error(Nte(g,v));if(v>=l)throw new Error(Ote(g,v,l));++p[v],h=h&&v>=d,d=v}let m=!0;for(let g=0;g<l;++g){const v=p[g]===0;u[g]=v,m=m&&!v,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&h){const g=n,v=r;for(let _=0;_<o;++_)c[_]=_;return[g,[o,f],v,u,c]}else{const g=p[l-1],v=ga(t,g*f),_=ga(i,g),x=new Array(l).fill(0);for(let b=0;b<o;++b){const S=n[b*f],T=x[S],M=(S===0?0:p[S-1])+T;x[S]++;for(let C=0;C<f;++C)v[M*f+C]=n[b*f+C];_[M]=r[b],c[b]=M}for(let b=0;b<l;++b)if(x[b]===0){const T=b===0?0:p[b-1];v[T*f+0]=b;for(let M=1;M<f;++M)v[T*f+M]=0;_[T]=s}return[v,[g,f],_,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uqe(n,e,t,r,i){const a=yt(r),s=e[0],o=i.length,l=[];let u=1,c=-1;for(let g=0;g<o;++g){const v=i[g];if(v===-1){if(c!==-1)throw new Error($te(c,g));c=g,l.push(1)}else{if(v<0)throw new Error(Fte(g,v));u*=v,l.push(v)}}if(c!==-1){if(u<=0)throw new Error(Bte());const g=Math.trunc(a/u);if(u*g!==a)throw new Error(Ute(r,l));l[c]=g}if(yt(l)!==a)throw new Error(zte(r,l));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let g=h-2;g>=0;--g)d[g]=d[g+1]*r[g+1]}const p=[];if(o>0){p[o-1]=1;for(let g=o-2;g>=0;--g)p[g]=p[g+1]*l[g+1]}const m=ga(t,s*o);for(let g=0;g<s;++g){let v=0;for(let _=0;_<h;++_)v+=n[g*h+_]*d[_];for(let _=0;_<o;++_)m[g*o+_]=Math.trunc(v/p[_]),v%=p[_]}return[m,[s,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cqe(n,e,t,r,i,a=!1,s=0){const o=r.length,l=[e[0],n.length/e[0]],u=l[1],f=o>0?i[o-1]+1:0;if(f<0)throw new Error(bR());const h=e.slice();h[0]=f;const d=h.reduce((x,b)=>x*b,1),p=ga(t,d);if(o===0)return f>0&&p.fill(s),[p,h];if(f<=0)throw new Error(bR());let m=0,g=1,v=0,_=i[m];for(;;){let x=0;if(g<o){if(x=i[g],_===x){++g;continue}if(_>=x)throw new Error(Vte())}if(_<0||_>=f)throw new Error(Hte(_,f));_>v&&p.fill(s,v*u,_*u);for(let b=m;b<g;++b){const S=r[b];if(S<0||S>=l[0])throw new Error(Wte(b,r[b],l[0]));for(let T=0;T<u;T++)p[_*u+T]+=n[S*u+T]}if(a)for(let b=0;b<u;b++)p[_*u+b]/=g-m;if(m=g,++g,v=_+1,_=x,g>o)break}return v<f&&p.fill(s,v*u,f*u),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fqe=Nf(n=>Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hqe=Ns((n,e)=>{const t=n-e;return t*t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dqe(n,e,t,r){const i=ei(n,e.dtype);for(let a=0;a<i.size;a++){const s=i.indexToLoc(a),o=new Array(s.length);for(let l=0;l<o.length;l++)o[l]=s[l]*t[l]+r[l];i.set(e.get(...o),...s)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pqe{constructor(e,t,r,i,a,s){this.separator=zu(e),this.nGramWidths=t,this.leftPad=zu(r),this.rightPad=zu(i),this.padWidth=a,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,i,a,s){for(let o=0;o<a;++o){const l=this.getPadWidth(s),u=Math.max(0,l-o),c=Math.max(0,l-(a-(o+1))),f=s-(u+c),h=t+(u>0?0:o-l);let d=0;d+=u*this.leftPad.length;for(let _=0;_<f;++_)d+=e[h+_].length;d+=c*this.rightPad.length;const p=u+c+f-1;d+=p*this.separator.length,r[i+o]=new Uint8Array(d);const m=r[i+o];let g=0;const v=_=>_.forEach(x=>m[g++]=x);for(let _=0;_<u;++_)v(this.leftPad),v(this.separator);for(let _=0;_<f-1;++_)v(e[h+_]),v(this.separator);if(f>0){v(e[h+f-1]);for(let _=0;_<c;++_)v(this.separator),v(this.rightPad)}else{for(let _=0;_<c-1;++_)v(this.rightPad),v(this.separator);v(this.rightPad)}}}compute(e,t){const r=e.length,i=t.length;if(i>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<i;++u){let c=t[u]>=l;if(c=c&&t[u]<=r,!c)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${r}]`);l=t[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const a=i-1,s=ga("int32",i);if(r===0||i===0){const l=new Array(r);for(let u=0;u<=a;++u)s[u]=0;return[l,s]}s[0]=0;for(let l=1;l<=a;++l){const u=t[l]-t[l-1];let c=0;this.nGramWidths.forEach(f=>{c+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&c===0&&(c=1),s[l]=s[l-1]+c}const o=new Array(s[a]);for(let l=0;l<a;++l){const u=t[l];let c=s[l];if(this.nGramWidths.forEach(f=>{const h=t[l+1]-t[l],d=this.getNumNGrams(h,f);this.createNGrams(e,u,o,c,d,f),c+=d}),this.preserveShort&&c===s[l]){const f=t[l+1]-t[l];if(f===0)continue;const h=f+2*this.padWidth,d=1;this.createNGrams(e,u,o,c,d,h)}}return[o,s]}}function mqe(n,e,t,r,i,a,s,o){return new pqe(t,r,i,a,s,o).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gqe(n,e,t,r){if(!n.length)return;if(e.length===0){for(let a=0;a<n.length;++a)r.push(n.subarray(a,a+1));return}if(e.length===1){const a=e[0];let s=n.indexOf(a);for(;s!==-1;){const o=n.subarray(0,s);(!t||o.length!==0)&&r.push(o),n=n.subarray(s+1),s=n.indexOf(a)}(!t||n.length!==0)&&r.push(n);return}let i=0;for(let a=0;a<n.length+1;a++)if(a===n.length||e.indexOf(n[a])!==-1){const s=n.subarray(i,a);(!t||s.length!==0)&&r.push(s),i=a+1}}function vqe(n,e,t){const r=n.length,i=[];let a=0,s=0;const o=new Array(r);for(let h=0;h<r;++h){const d=i.length;gqe(n[h],e,t,i);const p=i.length-d;o[h]=p,a+=p,s=Math.max(s,p)}const l=ga("int32",a*2),u=new Array(a),c=[r,s];let f=0;for(let h=0;h<r;++h)for(let d=0;d<o[h];++d)l[f*2]=h,l[f*2+1]=d,u[f]=i[f],++f;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yqe(n,e){const t=ga("int32",n.length);for(let r=0;r<n.length;++r)t[r]=fQ(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _qe=Ns((n,e)=>n-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xqe(n,e){const t=new Array(n.rank);for(let i=0;i<t.length;i++)t[i]=n.shape[i]*e[i];const r=ei(t,n.dtype);for(let i=0;i<r.values.length;++i){const a=r.indexToLoc(i),s=new Array(n.rank);for(let l=0;l<s.length;l++)s[l]=a[l]%n.shape[l];const o=n.locToIndex(s);r.values[i]=n.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ky=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function Mne(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const o=r-t+1,l=e-t+1,u=Math.log(o),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(o-c)/o)*Math.sign(l-o/2),h=Math.max(t,Math.floor(e-l*c/o+f)),d=Math.min(r,Math.floor(e+(o-l)*c/o+f));Mne(n,e,h,d)}const i=n[e];let a=t,s=r;for(ku(n,t,e),ky(n[r],i)>0&&ku(n,t,r);a<s;){for(ku(n,a,s),a++,s--;ky(n[a],i)<0;)a=a+1;for(;ky(n[s],i)>0;)s=s-1}ky(n[t],i)===0?ku(n,t,s):(s=s+1,ku(n,s,r)),s<=e&&(t=s+1),e<=s&&(r=s-1)}}function bqe(n,e,t,r,i){const a=e[e.length-1],[s,o]=[n.length/a,a],l=Xl(t,s*r),u=Xl("int32",s*r);for(let f=0;f<s;f++){const h=f*o,d=n.subarray(h,h+o);let p=new Array(d.length);d.forEach((_,x)=>p[x]={value:_,index:x}),r<p.length&&(Mne(p,r),p=p.slice(0,r)),i&&p.sort(ky);const m=f*r,g=l.subarray(m,m+r),v=u.subarray(m,m+r);for(let _=0;_<r;_++)g[_]=p[_].value,v[_]=p[_].index}const c=e.slice();return c[c.length-1]=r,[ei(c,t,l),ei(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wqe(n,e,t,r){const i=_i(e,t)[0],a=[1,t[0],1];for(let p=0;p<i;p++)a[0]*=t[p];a[1]=t[i];for(let p=i+1;p<t.length;p++)a[2]*=t[p];const s={},o=new Int32Array(t[i]),l=new yg(a,r,n),u=[],c=a[0]===1&&a[2]===1;for(let p=0;p<t[i];p++){let m;if(c)m=n[p].toString();else{const g=[];for(let v=0;v<a[0];v++)for(let _=0;_<a[2];_++)g.push(l.get(v,p,_));m=g.join(",")}if(s[m]!==void 0)o[p]=s[m];else{const g=Object.keys(s).length;s[m]=g,o[p]=g,u.push(p)}}const f=a.slice();f[1]=Object.keys(s).length;const h=new yg(f,r);u.forEach((p,m)=>{for(let g=0;g<a[0];g++)for(let v=0;v<a[2];v++)h.set(l.get(g,p,v),g,m,v)});const d=t.slice();return d[i]=f[1],{outputValues:h.values,outputShape:d,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sqe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:C7e,bincountImpl:E7e,bincountReduceImpl:A7e,castImpl:T7e,ceilImpl:M7e,concatImpl:k7e,equalImpl:R7e,expImpl:P7e,expm1Impl:I7e,floorImpl:D7e,gatherNdImpl:L7e,gatherV2Impl:N7e,greaterEqualImpl:$7e,greaterImpl:O7e,lessEqualImpl:B7e,lessImpl:F7e,linSpaceImpl:U7e,logImpl:z7e,maxImpl:V7e,maximumImpl:H7e,minimumImpl:W7e,multiplyImpl:Ane,negImpl:G7e,notEqualImpl:j7e,prodImpl:X7e,raggedGatherImpl:tqe,raggedTensorToTensorImpl:nqe,rangeImpl:rqe,rsqrtImpl:iqe,scatterImpl:aqe,sigmoidImpl:sqe,simpleAbsImpl:S7e,sliceImpl:oqe,sparseFillEmptyRowsImpl:lqe,sparseReshapeImpl:uqe,sparseSegmentReductionImpl:cqe,sqrtImpl:fqe,squaredDifferenceImpl:hqe,stridedSliceImpl:dqe,stringNGramsImpl:mqe,stringSplitImpl:vqe,stringToHashBucketFastImpl:yqe,subImpl:_qe,tileImpl:xqe,topKImpl:bqe,transposeImpl:q7e,uniqueImpl:wqe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Tqe,bincountImpl:kne,bincountReduceImpl:Cqe,castImpl:Eqe,ceilImpl:Aqe,concatImpl:Mqe,equalImpl:kqe,expImpl:Rqe,expm1Impl:Pqe,floorImpl:Iqe,gatherNdImpl:Dqe,gatherV2Impl:Lqe,greaterImpl:Nqe,greaterEqualImpl:Oqe,lessImpl:$qe,lessEqualImpl:Fqe,linSpaceImpl:Bqe,logImpl:Uqe,maxImpl:zqe,maximumImpl:Vqe,minimumImpl:Hqe,multiplyImpl:Wqe,negImpl:Gqe,notEqualImpl:jqe,prodImpl:qqe,raggedGatherImpl:Xqe,raggedTensorToTensorImpl:Kqe,rangeImpl:Yqe,rsqrtImpl:Zqe,scatterImpl:Qqe,sigmoidImpl:Jqe,simpleAbsImpl:Rne,sliceImpl:eXe,sparseFillEmptyRowsImpl:tXe,sparseReshapeImpl:nXe,sparseSegmentReductionImpl:Pne,sqrtImpl:rXe,stridedSliceImpl:iXe,stringNGramsImpl:aXe,stringSplitImpl:sXe,stringToHashBucketFastImpl:oXe,subImpl:lXe,tileImpl:uXe,topKImpl:cXe,transposeImpl:r$,uniqueImpl:fXe}=Sqe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function ma(n,e){return e===1?[n]:Ine(n,e)}function hXe(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dXe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Ta(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=ma("rc",this.rank),r=$r(this.rank),i=this.getOutOfBoundsCondition(t),a=this.getSetup(t),s=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${s}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let a=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let s=2;s<this.rank;s++)a=`${e[e.length-1-s]},`+a;t.push(a)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dne{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length);let r="";for(let i=0;i<4;i++){let a="thisRC = rc;";i%2===1&&(a+="thisRC.z += 1;"),i>1&&(a+="thisRC.y += 1;"),r+=`
        ${a}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${pXe(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?t$():e$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function pXe(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?pje(["r","c","d"],"inputShape"):Zd(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mXe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,r){const i=dW(t,r),a=pW(e,i,r);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const s=hW(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const l=this.freeTextures[a].shift();return this.usedTextures[a].push(l),l}let o;return i===$i.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===$i.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===$i.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===$i.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===$i.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),o}releaseTexture(e,t,r,i){if(this.freeTextures==null)return;const a=dW(r,i),s=pW(t,a,i);s in this.freeTextures||(this.freeTextures[s]=[]);const o=hW(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=We().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[s],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function gXe(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function hW(n,e,t,r,i){const a=vXe(e,r);let s;if(i){const[l,u]=Qg(n[0],n[1]);s=l*u}else{const[l,u]=Z_(n[0],n[1]);s=l*u}const o=gXe(t,a);return s*o}function vXe(n,e){switch(n){case $i.PACKED_2X2_FLOAT32:return Cne(e);case $i.PACKED_2X2_FLOAT16:return Ene(e);case $i.UNPACKED_FLOAT32:return wne(e);case $i.UNPACKED_FLOAT16:return Sne(e);case $i.PACKED_4X1_UNSIGNED_BYTE:return Tne(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function yXe(n){return We().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?$i.PACKED_2X2_FLOAT32:$i.UNPACKED_FLOAT32:n?$i.PACKED_2X2_FLOAT16:$i.UNPACKED_FLOAT16}function dW(n,e){if(n===As.UPLOAD)return $i.PACKED_2X2_FLOAT32;if(n===As.RENDER||n==null)return yXe(e);if(n===As.DOWNLOAD||n===As.PIXELS)return $i.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function pW(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fu{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ao="if (isnan(x)) return x;",_Xe="return x;",mW="return abs(x);",xXe="return (x >= 0.0) ? x : (exp(x) - 1.0);",bXe=Ao+`
  return (x < 0.0) ? 0.0 : x;
`,wXe=Ao+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Xp="return x;",SXe="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TXe="return x;",CXe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,EXe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,AXe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,MXe="return 1.0 / (1.0 + exp(-1.0 * x));";class jh{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kXe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length);const t=e.length,r=ma("rc",t),i=$r(t),a=hXe(t,r),s=r.slice(-2),o=t<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RXe=F3,PXe=1e-7,IXe=1e-4,g1={};function DXe(n){return n in g1||(g1[n]={}),g1[n]}const LXe=We().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),NXe=600;function OXe(){return We().global.screen==null?1024:We().global.screen.height*We().global.screen.width*window.devicePixelRatio*NXe/1024/1024}class wC extends $D{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!We().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof RA)t=e;else{const r=rl(We().getNumber("WEBGL_VERSION"),e);t=new RA(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=rl(We().getNumber("WEBGL_VERSION"));t=new RA(r),this.binaryCache=DXe(We().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new mXe(this.gpgpu),this.numMBBeforeWarning=OXe(),this.texData=new LZ(this,Cu())}nextDataId(){return wC.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,r){if((We().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||We().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:t,dtype:r,values:e,usage:As.UPLOAD,refCount:1}),i}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,i,a){if(We().getBool("DEBUG")&&this.checkNumericalProblems(t),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:i,values:t,usage:As.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:i,complexTensorInfos:a,slice:s,shape:o,isPacked:l}=t;if(s!=null){let h;l?h=new jh(o,Xp):h=new Fu(o,Xp);const d=this.runWebGLProgram(h,[{dataId:e,shape:o,dtype:i}],i),p=this.readSync(d.dataId);return this.disposeIntermediateTensorInfo(d),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Ks());let f;if(i==="complex64"){const h=this.readSync(a.real.dataId),d=this.readSync(a.imag.dataId);f=xR(h,d)}else f=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Ks()-c),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const t=this.texData.get(e),{values:r,shape:i,slice:a,dtype:s,complexTensorInfos:o,isPacked:l}=t;if(a!=null){let p;l?p=new jh(i,Xp):p=new Fu(i,Xp);const m=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:s}],s),g=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(We().getBool("DEBUG")&&!We().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&We().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(s!=="complex64"&&We().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...h1(i))}this.pendingRead.set(e,[]),s!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(s==="complex64"){const p=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),m=p[0],g=p[1];f=xR(m,g)}else if(u==null)f=this.getValuesFromTexture(e);else{const p=yt(i);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;Ut(p,()=>p.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,f),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Cu().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,t={}){const r=this.texData.get(e),{values:i,shape:a,slice:s,dtype:o,isPacked:l,texture:u}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(s!=null){let d;l?d=new jh(a,Xp):d=new Fu(a,Xp);const p=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:o}],o),m=this.readToGPU(p,t);return this.disposeIntermediateTensorInfo(p),m}if(u==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,t.customTexShape),f=Cu().makeTensorFromTensorInfo(c),h=this.texData.get(c.dataId);return Object.assign({tensorRef:f},h.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(i=>Cd(i));return ei(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ei(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!z9e(r))throw We().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:i}=this.texData.get(e),a=yt(t);if(We().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),d=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(d.texture.texture,...h1(t)).subarray(0,a);return this.disposeIntermediateTensorInfo(h),p}const s=We().getBool("WEBGL_PACK")&&i===!0,o=s?AA(t):t,l=s?new r7e(o):new n7e(o),u=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,e();const a=Zu(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),s=Zu(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(a);o.kernelMs=OZ(l),o.getExtraProfileInfo=()=>l.map((u,c)=>({name:s[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ks(),endMs:null}}endTimer(e){return We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ks(),e)}async getQueryTime(e){if(We().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:i,usage:a,isPacked:s,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(t,i,a,s)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=LXe){return We().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&yt(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){no("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return RXe(e.shape,t)}packedUnaryOp(e,t,r){const i=new jh(e.shape,t),a=this.compileAndRun(i,[e],r);return Cu().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const i=Rne(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,i)}if(We().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,mW,e.dtype);const t=new Fu(e.shape,mW),r=this.compileAndRun(t,[e]);return Cu().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let i;if(t==="string"&&r!=null&&r.length>0&&$u(r[0])){const a=r.map(s=>zu(s));i=this.write(a,e,t)}else i=this.write(r,e,t);return this.texData.get(i).usage=null,{dataId:i,shape:e,dtype:t}}makeOutput(e,t,r){return Cu().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new kXe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new dXe(e.shape),r=!0;return this.runWebGLProgram(t,[e],e.dtype,null,r)}packedReshape(e,t){const r=[Tg(e.shape),...Cg(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},a=[Tg(t),...Cg(t)],s=new Dne(a,r),o=!0,l=[r],u=this.runWebGLProgram(s,[i],e.dtype,l,o);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:i,shape:a,dtype:s}=r;if(t!=null){const h=yt(a),d=t[0]*t[1]*4;le(h<=d,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=AA(a);let l;i?l=new t7e(o):l=new e7e(o);const u=!0,c=[t??h1(o)],f=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],s,c,u,t);return{dtype:s,shape:a,dataId:f.dataId}}runWebGLProgram(e,t,r,i,a=!1,s){const o=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===h_.DENSE){const v=s??h1(e.outputShape);l.texShape=v.map(_=>_*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),yt(o.shape)===0)return l.values=Xl(o.dtype,0),o;const u=[],c=t.map(v=>{if(v.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let _=this.texData.get(v.dataId);if(_.texture==null){if(!e.packedInputs&&yt(v.shape)<=We().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:v.shape,texData:null,isUniform:!0,uniformValues:_.values};e.packedInputs&&(_.isPacked=!0,_.shape=v.shape)}if(this.uploadToGPU(v.dataId),!!_.isPacked!=!!e.packedInputs)v=_.isPacked?this.unpackTensor(v):this.packTensor(v),u.push(v),_=this.texData.get(v.dataId);else if(_.isPacked&&!CS(_.shape,v.shape)){const x=v,b=v.shape;v.shape=_.shape,v=this.packedReshape(v,b),u.push(v),_=this.texData.get(v.dataId),x.shape=b}return{shape:v.shape,texData:_,isUniform:!1}});this.uploadToGPU(o.dataId);const f={shape:o.shape,texData:l,isUniform:!1},h=Jje(e,c,f),d=this.getAndSaveBinary(h,()=>Zje(this.gpgpu,e,c,f)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),We().get("ENGINE_COMPILE_ONLY")||Qje(this.gpgpu,d,c,f,i),u.forEach(v=>this.disposeIntermediateTensorInfo(v)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const g=We().get("WEBGL_FLUSH_THRESHOLD");if(g>0){const v=Ks();v-this.lastGlFlushTime>g&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=v)}if(!We().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){const v=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),v}return o}compileAndRun(e,t,r,i,a=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,i,a)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(We().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=tn(()=>{if(!We().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=We().getBool("DEBUG");We().set("DEBUG",!1);const t=this.abs(xn(1e-8)).dataSync()[0];if(We().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?PXe:IXe}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:i,values:a,texture:s,usage:o,isPacked:l}=t;if(s!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Ks());let f=t.texShape;if(f==null&&(f=aje(r,l),t.texShape=f),a!=null){const h=AA(r);let d,p=f[1],m=f[0];const g=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(l||!g)&&([p,m]=Qg(f[0],f[1])),l?d=new a7e(h,g):d=new i7e(h,g);const v=g?[m,p]:f,_=this.makeTensorInfo(v,i),x=this.texData.get(_.dataId);g?x.usage=As.PIXELS:x.usage=As.UPLOAD,x.texShape=v,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(_.dataId),p,m,a);const b=[[m,p]],S=!0,T=this.runWebGLProgram(d,[_],i,b,S),M=this.texData.get(T.dataId);t.texShape=M.texShape,t.isPacked=M.isPacked,t.usage=M.usage,We().get("ENGINE_COMPILE_ONLY")?this.disposeData(T.dataId):(t.texture=M.texture,t.values=null,this.texData.delete(T.dataId)),this.disposeIntermediateTensorInfo(_),u&&(this.uploadWaitMs+=Ks()-c)}else{const h=this.acquireTexture(f,o,i,l);t.texture=h}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:i}=r;return this.releaseGPUData(e),t!=null&&(r.values=$Xe(t,i)),r.values}acquireTexture(e,t,r,i){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,i)}computeBytes(e,t){return e[0]*e[1]*sS(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(t),i(!0)}catch(a){throw a}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await fte(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(gne(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:t,customUniformLocations:r,infLoc:i,nanLoc:a,inShapesLocations:s,inTexShapesLocations:o,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:c}=bne(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=r,e.infLoc=i,e.nanLoc=a,e.inShapesLocations=s,e.inTexShapesLocations=o,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=c}}}wC.nextDataId=0;function $Xe(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */IO()&&LQ("webgl",()=>new wC,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Eg{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=Kn(t,r),this.enableShapeUniforms=Ta(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ex=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class tx{constructor(e,t,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Kn(t,r);const a=this.outputShape.length;this.enableShapeUniforms=Ta(a);let s="";if(i)if(a===0||yt(this.outputShape)===1)s=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(s=`
          ${$r(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?s+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:s+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ma("coords",a);this.enableShapeUniforms?s+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:s+=`
            bool nextRowOutOfBounds =
              (${l[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${l[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${s}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function us(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const FXe={kernelName:KT,backendName:"webgl",kernelFunc:us};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Of(n){const{inputs:e,backend:t}=n,{real:r,imag:i}=e,a=t.makeTensorInfo(r.shape,"complex64"),s=t.texData.get(a.dataId),o=us({inputs:{x:r},backend:t}),l=us({inputs:{x:i},backend:t});return s.complexTensorInfos={real:o,imag:l},a}const BXe={kernelName:uL,backendName:"webgl",kernelFunc:Of};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lne="return (a < 0.) ? b * a : a;",Nne=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function UXe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{alpha:a}=r,s=t.makeTensorInfo([],"float32",qd(a,"float32")),o=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new tx(Nne,i.shape,s.shape):new Eg(Lne,i.shape,s.shape),l=t.runWebGLProgram(o,[i,s],"float32");return t.disposeIntermediateTensorInfo(s),l}const zXe={kernelName:QL,backendName:"webgl",kernelFunc:UXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const One="return (a < 0.) ? b * a : a;",$ne=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function VXe(n){const{inputs:e,backend:t}=n,{x:r,alpha:i}=e,a=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new tx($ne,r.shape,i.shape):new Eg(One,r.shape,i.shape);return t.runWebGLProgram(a,[r,i],"float32")}const HXe={kernelName:RN,backendName:"webgl",kernelFunc:VXe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rv="if (isnan(x)) return x;";function Zn({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:i,backend:a})=>{const{x:s}=i,o=a,l=r||s.dtype;if(o.shouldExecuteOnCPU([s])&&t!=null){const f=o.texData.get(s.dataId),h=t(f.values,l);return o.makeTensorInfo(s.shape,l,h)}const u=We().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new jh(s.shape,e):c=new Fu(s.shape,n),o.runWebGLProgram(c,[s],l)}}function zi({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:a}){return({inputs:s,backend:o})=>{const{a:l,b:u}=s,c=o;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[g,v]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(x=>{const[b,S]=x,T={dataId:b.dataId,dtype:b.dtype,shape:l.shape},M={dataId:S.dataId,dtype:S.dtype,shape:u.shape},C=new Eg(n,l.shape,u.shape);return c.runWebGLProgram(C,[T,M],nl(b.dtype,S.dtype))}),_=Of({inputs:{real:g,imag:v},backend:c});return c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(v),_}const f=a||nl(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&i!=null){const p=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,g=l.dtype==="string"?f_(p):p,v=l.dtype==="string"?f_(m):m,[_,x]=i(l.shape,u.shape,g,v,f),b=c.makeTensorInfo(x,f),S=c.texData.get(b.dataId);return S.values=_,b}const h=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let d;return h?d=new tx(e,l.shape,u.shape,t):d=new Eg(n,l.shape,u.shape),c.runWebGLProgram(d,[l,u],f)}}function d_(n,e=!1){if(n==="linear")return e?TXe:_Xe;if(n==="relu")return e?EXe:bXe;if(n==="elu")return e?CXe:xXe;if(n==="relu6")return e?AXe:wXe;if(n==="prelu")return e?$ne:One;if(n==="leakyrelu")return e?Nne:Lne;if(n==="sigmoid")return e?MXe:SXe;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fne{constructor(e,t,r,i=!1,a=!1,s=!1,o=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Ta(this.outputShape.length);const c=i?e[1]:e[2],f=Math.ceil(c/2),h=i?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let g="",v="";o&&(l?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:g=`vec4 activation(vec4 x) {
          ${o}
        }`,v="result = activation(result);");const _=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let x="rc.x",b="rc.x";e[0]<t[0]?x=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(b=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`
      ${g}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${f}; i++) {
          int batchA = ${x};
          int batchB = ${b};
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${d});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${_}

        ${v}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gW={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class vW{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Kn(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yW="return a * b;";function a$(n){const{inputs:e,backend:t}=n,{a:r,b:i}=e,a=nl(r.dtype,i.dtype);if(r.dtype==="complex64"){const o=t.texData.get(r.dataId),l=t.texData.get(i.dataId),u=new vW(gW.REAL,r.shape,i.shape),c=new vW(gW.IMAG,r.shape,i.shape),f=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],h=t.runWebGLProgram(u,f,"float32"),d=t.runWebGLProgram(c,f,"float32"),p=Of({inputs:{real:h,imag:d},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),p}if(t.shouldExecuteOnCPU([r,i])){const o=t.texData.get(r.dataId),l=t.texData.get(i.dataId),[u,c]=Wqe(r.shape,i.shape,o.values,l.values,a),f=t.makeTensorInfo(c,a),h=t.texData.get(f.dataId);return h.values=u,f}let s;return We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?s=new tx(yW,r.shape,i.shape):s=new Eg(yW,r.shape,i.shape),t.runWebGLProgram(s,[r,i],a)}const WXe={kernelName:_N,backendName:"webgl",kernelFunc:a$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GXe(n,e,t){const r=[Tg(n.shape),...Cg(n.shape)],i={dtype:n.dtype,shape:r,dataId:n.dataId},a=[Tg(e),...Cg(e)],s=new Dne(a,r),o=!0,l=[r],u=t.runWebGLProgram(s,[i],n.dtype,l,o);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{shape:a}=r,s=t,o=yt(i.shape),l=$Z(a,o),u=yt(l);le(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const c=s.texData.get(i.dataId);return c.isPacked&&!CS(i.shape,l)&&!(c.texture!==null&&CS(c.shape,l))?GXe(i,l,s):(s.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const jXe={kernelName:FN,backendName:"webgl",kernelFunc:Mt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _W{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:a,outSize:s}=e;this.outputShape=[i,s];const o=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(t!=null){const f=1/t;u=`sumValue += dot(values * ${Sd(f)?f.toPrecision(2):f}, ones);`}let c="";a%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qXe{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:a,outSize:s}=e;this.outputShape=[i,s];let o="0.0",l="";t==="prod"?o="1.0":t==="min"?(o="1.0 / 1e-20",l="min"):t==="max"&&(o="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,f=r%4;let h=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,d="vec4";t==="all"?(o="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(o="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");let p="";a%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===2}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${f===3}) {
          ${d} values = ${d}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XXe(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=yC(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function Jd(n,e,t,r){const i=XXe(n.shape);let a=n;for(let s=0;s<i.length;s++){const{inSize:o,windowSize:l,outSize:u}=i[s];let c,f;t==="mean"?c=s===0?new _W({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:u},o):new _W({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:u}):c=new qXe({windowSize:l,inSize:o,batchSize:n.shape[0],outSize:u},t),f=a,a=r.runWebGLProgram(c,[a],e),f.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(f)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KXe{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[t[s]];this.outputShape=r,this.rank=r.length;const i=$r(this.rank),a=YXe(t);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function YXe(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<n.length;i++)r[n[i]]=t[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZXe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[t[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=$r(this.rank),a=Ine("rc",this.rank),s=new Array(this.rank);for(let c=0;c<t.length;c++)s[t[c]]=a[c];const o=`vec2(${s.slice(-2).join()})`,l=`++${a[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${s.join()}), ${o})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SC(n,e,t){const r=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZXe(n.shape,e):new KXe(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QXe(n,e,t,r){const i=e,a=n.shape.length,s=_i(i,n.shape);let o=s;const l=Co(o,a),u=l!=null;let c=n;u&&(c=SC(n,l,r),o=Eo(o.length,a)),hl("sum",o,a);const[f,h]=ru(c.shape,o);let d=f;t&&(d=Ls(f,s));const p=yt(h),g=yt(n.shape)/p,v=Mt({inputs:{x:c},attrs:{shape:[g,p]},backend:r}),_=ZT(n.dtype),x=Jd(v,_,"sum",r),b=Mt({inputs:{x},attrs:{shape:d},backend:r});return r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(x),u&&r.disposeIntermediateTensorInfo(c),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TC(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,keepDims:s}=r;return QXe(i,a,s,t)}const JXe={kernelName:nO,backendName:"webgl",kernelFunc:TC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{perm:a}=r,s=t,o=i.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=i.shape[a[c]];let u;if(s.shouldExecuteOnCPU([i])){const f=s.texData.get(i.dataId).values,h=r$(f,i.shape,i.dtype,a,l);u=s.makeTensorInfo(l,i.dtype);const d=s.texData.get(u.dataId);d.values=h}else u=SC(i,a,s);return u}const eKe={kernelName:s0,backendName:"webgl",kernelFunc:ba};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bne=1e3;function AS({a:n,b:e,transposeA:t,transposeB:r,backend:i,bias:a=null,preluActivationWeights:s=null,leakyreluAlpha:o=0,activation:l=null}){const u=n.shape.length,c=e.shape.length,f=t?n.shape[u-2]:n.shape[u-1],h=r?e.shape[c-1]:e.shape[c-2],d=t?n.shape[u-1]:n.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],m=n.shape.slice(0,-2),g=e.shape.slice(0,-2),v=yt(m),_=yt(g),b=Kn(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([d,p]);le(f===h,()=>`Error in matMul: inner shapes (${f}) and (${h}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const S=t?[v,f,d]:[v,d,f],T=r?[_,p,h]:[_,h,p],M=Mt({inputs:{x:n},backend:i,attrs:{shape:S}}),C=Mt({inputs:{x:e},backend:i,attrs:{shape:T}}),k=[M,C],R=Math.max(v,_),P=t?M.shape[1]:M.shape[2],N=a!=null,L=s!=null,F=l==="leakyrelu",O=l!=null?d_(l,!0):null,B=N||L||F||O!=null;let H;if((d===1||p===1)&&P>Bne&&B===!1){let K=M,J=C;t&&(K=ba({inputs:{x:M},backend:i,attrs:{perm:[0,2,1]}}),k.push(K)),r&&(J=ba({inputs:{x:C},backend:i,attrs:{perm:[0,2,1]}}),k.push(J));const re=p!==1,se=p===1;let Ae=K;re&&(Ae=Mt({inputs:{x:K},backend:i,attrs:{shape:[R,P,1]}}),k.push(Ae));const Ee=p===1?2:1;let Ne=J;se&&(Ne=Mt({inputs:{x:J},backend:i,attrs:{shape:[R,1,P]}}),k.push(Ne));const we=a$({inputs:{a:Ae,b:Ne},backend:i});H=TC({inputs:{x:we},backend:i,attrs:{axis:Ee,keepDims:!0}}),k.push(we)}else{const K=nl(n.dtype,e.dtype),J=new Fne(S,T,[R,d,p],t,r,N,O,L,F),re=[M,C];if(a!=null&&re.push(a),L&&re.push(s),F){const se=i.makeTensorInfo([],"float32",qd(o,"float32"));re.push(se),k.push(se)}H=i.runWebGLProgram(J,re,K)}const j=Mt({inputs:{x:H},backend:i,attrs:{shape:b}});k.push(H);for(const K of k)i.disposeIntermediateTensorInfo(K);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tKe(n){const{inputs:e,backend:t,attrs:r}=n,{a:i,b:a,bias:s,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:f}=r;return AS({a:i,b:a,transposeA:l,transposeB:u,backend:t,bias:s,preluActivationWeights:o,leakyreluAlpha:f,activation:c})}const nKe={kernelName:cS,backendName:"webgl",kernelFunc:tKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xW="return abs(x);";function rKe(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const a=t.texData.get(r.dataId),s=Rne(a.values);return t.makeTensorInfo(r.shape,r.dtype,s)}let i;return We().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new jh(r.shape,xW):i=new Fu(r.shape,xW),t.runWebGLProgram(i,[r],r.dtype)}const iKe={kernelName:VD,backendName:"webgl",kernelFunc:rKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aKe=Ao+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,sKe=Zn({opSnippet:aKe}),oKe={kernelName:HD,backendName:"webgl",kernelFunc:sKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lKe=Ao+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,uKe=Zn({opSnippet:lKe}),cKe={kernelName:WD,backendName:"webgl",kernelFunc:uKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bW="return a + b;",fKe=zi({opSnippet:bW,packedOpSnippet:bW,supportsComplex:!0,cpuKernelImpl:Tqe}),hKe={kernelName:qT,backendName:"webgl",kernelFunc:fKe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dKe{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((a,s)=>`T${s}`);const r=[];this.variableNames.forEach(a=>{r.push(`float v${a} = get${a}AtOutCoords();`)});const i=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pKe{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((a,s)=>`T${s}`);const r=[];this.variableNames.forEach(a=>{r.push(`vec4 v${a} = get${a}AtOutCoords();`)});const i=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ow(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return us({inputs:{x:r[0]},backend:t});if(r.length>We().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=ow({inputs:r.slice(0,l),backend:t}),c=ow({inputs:r.slice(l),backend:t});return ow({inputs:[u,c],backend:t})}const i=r.map(l=>l.dtype).reduce((l,u)=>nl(l,u)),a=r.map(l=>l.shape),o=We().getBool("WEBGL_PACK")?new pKe(r[0].shape,a):new dKe(r[0].shape,a);return t.runWebGLProgram(o,r,i)}const mKe={kernelName:GD,backendName:"webgl",kernelFunc:ow};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,keepDims:s}=r,o=i.shape.length,l=_i(a,i.shape);let u=l;const c=Co(u,o);let f=i;c!=null&&(f=ba({inputs:{x:i},backend:t,attrs:{perm:c}}),u=Eo(u.length,o)),hl("all",u,o);const[h,d]=ru(f.shape,u),p=yt(d),m=Mt({inputs:{x:f},backend:t,attrs:{shape:[-1,p]}}),g=Jd(m,m.dtype,"all",t);let v;if(s){const _=Ls(h,l);v=Mt({inputs:{x:g},backend:t,attrs:{shape:_}})}else v=Mt({inputs:{x:g},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(f),v}const vKe={kernelName:jD,backendName:"webgl",kernelFunc:gKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,keepDims:s}=r,o=i.shape.length,l=_i(a,i.shape);let u=l;const c=Co(u,o);let f=i;c!=null&&(f=ba({inputs:{x:i},backend:t,attrs:{perm:c}}),u=Eo(u.length,o)),hl("any",u,o);const[h,d]=ru(f.shape,u),p=yt(d),m=Mt({inputs:{x:f},backend:t,attrs:{shape:[-1,p]}}),g=Jd(m,m.dtype,"any",t);let v;if(s){const _=Ls(h,l);v=Mt({inputs:{x:g},backend:t,attrs:{shape:_}})}else v=Mt({inputs:{x:g},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(f),v}const _Ke={kernelName:qD,backendName:"webgl",kernelFunc:yKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xKe{constructor(e,t,r){this.variableNames=["A"];const{windowSize:i,batchSize:a,outSize:s}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[a,s];const o=t==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bKe{constructor(e,t,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,le(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],s=Math.ceil(a/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,u=$r(l),c=ma("coords",l);let f,h;if(s===1){h=l+1;const C=$r(h);f=`
        ${C} sourceLocR = ${C}(${c.join()}, 0);
        ++${c[l-1]};
        ${C} sourceLocG = ${C}(${c.join()}, 0);
        ++${c[l-2]};
        ${C} sourceLocA = ${C}(${c.join()}, 0);
        --${c[l-1]};
        ${C} sourceLocB = ${C}(${c.join()}, 0);
        --${c[l-2]};`}else h=l,f=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const d=["x","y","z","w","u","v"].slice(0,h),p="."+d[h-1],m=d.map(C=>"int "+C),g=ma("sourceLocR",h-1).concat("inIdx.r"),v=ma("sourceLocG",h-1).concat("inIdx.g"),_=ma("sourceLocB",h-1).concat("inIdx.b"),x=ma("sourceLocA",h-1).concat("inIdx.a"),b=r==="max"?"greaterThan":"lessThan",S=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${_.join()}),
                             getBestIndicesAChannel(${x.join()})));`,T=`vec4(
            getAChannel(${g.join()}),
            hasNextCol ? getAChannel(${v.join()}) : 0.,
            hasNextRow ? getAChannel(${_.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${x.join()}) : 0.)`,M=i?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${d.join()}),
                                          vec2(${d.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${d.join()}),
                               vec2(${d.slice(-2).join()}));
      }
      ${M}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${o[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${T};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${S}
          vec4 candidate = ${T};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(n,e,t,r=null){let i=e.shape[0],a=e.shape[1];r!=null&&(i=r.shape[0],a=r.shape[1]);const s=yC(a),o={windowSize:s,inSize:a,batchSize:i,outSize:Math.ceil(a/s)},l=new xKe(o,t,r==null),u=[e];r!=null&&u.push(r);const c=n.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const f=Une(n,e,t,c);return n.disposeIntermediateTensorInfo(c),f}function zne(n,e,t,r=null){const i=r!=null?r.shape:e.shape,a=i[i.length-1],s=yC(a),o=new bKe(i,s,t,r==null),l=r==null?[e]:[e,r],u=n.runWebGLProgram(o,l,"int32");if(u.shape.length===e.shape.length){const c=zne(n,e,t,u);return n.disposeIntermediateTensorInfo(u),c}return u}function Vne(n,e,t,r){const i=[t];if(hl("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,e.shape.length),!We().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],s=n.texData.get(e.dataId),o=s!==null&&s.isPacked;let l=e;o&&(l=n.unpackTensor(e),a.push(l));const[u,c]=ru(l.shape,i),f=yt(c),h=Mt({inputs:{x:l},backend:n,attrs:{shape:[-1,f]}});a.push(h);const d=Une(n,h,r);a.push(d);const p=Mt({inputs:{x:d},backend:n,attrs:{shape:u}});return a.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}return zne(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a}=r;let s=_i(a,i.shape);const o=Co(s,i.shape.length);let l=i;const u=[];o!=null&&(l=ba({inputs:{x:i},backend:t,attrs:{perm:o}}),u.push(l),s=Eo(s.length,l.shape.length)),hl("argMax",[s[0]],l.shape.length);const c=Vne(t,l,s[0],"max");return u.forEach(f=>t.disposeIntermediateTensorInfo(f)),c}const SKe={kernelName:XD,backendName:"webgl",kernelFunc:wKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a}=r;let s=_i(a,i.shape);const o=Co(s,i.shape.length);let l=i;const u=[];o!=null&&(l=ba({inputs:{x:i},backend:t,attrs:{perm:o}}),u.push(l),s=Eo(s.length,l.shape.length)),hl("argMin",[s[0]],l.shape.length);const c=Vne(t,l,s[0],"min");return u.forEach(f=>t.disposeIntermediateTensorInfo(f)),c}const CKe={kernelName:KD,backendName:"webgl",kernelFunc:TKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EKe=Ao+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,AKe=Zn({opSnippet:EKe}),MKe={kernelName:YD,backendName:"webgl",kernelFunc:AKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kKe=Ao+"return log(x + sqrt(x * x + 1.0));",RKe=Zn({opSnippet:kKe}),PKe={kernelName:ZD,backendName:"webgl",kernelFunc:RKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IKe=Ao+`
  return atan(x);
`,DKe=Zn({opSnippet:IKe}),LKe={kernelName:QD,backendName:"webgl",kernelFunc:DKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NKe=i$+`
  return atan(a, b);
`,OKe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ex+`
  return result;
`,$Ke=zi({opSnippet:NKe,packedOpSnippet:OKe}),FKe={kernelName:eL,backendName:"webgl",kernelFunc:$Ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BKe=Ao+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,UKe=Zn({opSnippet:BKe}),zKe={kernelName:JD,backendName:"webgl",kernelFunc:UKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p_{constructor(e,t,r,i=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=t==="avg",g=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,v=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let _="0.0";if(m||(_="-1.0 / 1e-20"),r){const C=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${d}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${C} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?a?g:v:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const x="max";let b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(b="avgValue / count");const S=Math.floor(s/4)*4,T=s%4,M=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${d}, ${p});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${S}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${M}
          }

          int xC = xCCorner + ${S};
          if (${T===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${M}
          } else if (${T===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${M}
          } else if (${T===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${M}
          }
        }
        setOutput(${b});
      }
    `}}class s${constructor(e,t,r,i=!1,a=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,o=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,f=e.dilationHeight,h=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=e.padInfo.front,v=e.padInfo.top,_=e.padInfo.left;this.outputShape=e.outShape;const x=t==="avg";let b="0.0";if(x||(b="-1.0 / 1e-20"),r){const R=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${u});
        const ivec3 pads = ivec3(${g}, ${v}, ${_});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${d};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${R} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const S="max";let T=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(T="avgValue / count");const M=Math.floor(s/4)*4,C=s%4,k=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${S}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${u});
      const ivec3 pads = ivec3(${g}, ${v}, ${_});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${M}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${k}
            }

            int xC = xCCorner + ${M};
            if (${C===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${C===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${k}
            } else if (${C===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${k}
            }
          }
          setOutput(${T});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e;Q_(i,"avgPool");const{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,u=1;le(hs(s,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=Xd(i.shape,a,s,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Jr(c.inShape,c.outShape))return us({inputs:{x:i},backend:t});const f=new p_(c,"avg",!1);return t.runWebGLProgram(f,[i],"float32")}const HKe={kernelName:tL,backendName:"webgl",kernelFunc:VKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WKe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{filterSize:a,strides:s,pad:o,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],f=H_(i.shape,a,s,c,o,l,u),h=new s$(f,"avg",!1);return t.runWebGLProgram(h,[i],"float32")}const GKe={kernelName:nL,backendName:"webgl",kernelFunc:WKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jKe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,i=e.strideHeight,a=e.strideWidth,s=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,f=u-1-e.padInfo.left,h=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${f});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class qKe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,i=e.filterWidth,a=e.strideDepth,s=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,f=e.effectiveFilterDepth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=f-1-e.padInfo.front,m=h-1-e.padInfo.top,g=d-1-e.padInfo.left,v=1/(t*r*i);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${g});
      const float avgMultiplier = float(${v});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XKe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:a}=e,s=a,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=H_(s.shape,o,l,f,u,c),d=new qKe(h);return t.runWebGLProgram(d,[i],s.dtype)}const KKe={kernelName:XZ,backendName:"webgl",kernelFunc:XKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YKe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:a}=e,s=a;Q_([i,a],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=r,c=Xd(s.shape,o,l,1,u),f=new jKe(c);return t.runWebGLProgram(f,[i],s.dtype)}const ZKe={kernelName:qZ,backendName:"webgl",kernelFunc:YKe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QKe(n){const{inputs:e,backend:t,attrs:r}=n,{a:i,b:a}=e,{transposeA:s,transposeB:o}=r;return AS({a:i,b:a,transposeA:s,transposeB:o,backend:t})}const JKe={kernelName:rL,backendName:"webgl",kernelFunc:QKe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eYe{constructor(e,t,r,i,a,s){this.outputShape=[],this.variableNames=["x","mean","variance"],Kn(e,t),Kn(e,r);let o="0.0";i!=null&&(Kn(e,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";a!=null&&(Kn(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${s}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tYe{constructor(e,t,r,i,a,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Kn(e,t),Kn(e,r);let o="vec4(0.0)";i!=null&&(Kn(e,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";a!=null&&(Kn(e,a),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${s}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nYe=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:i,variance:a,offset:s,scale:o}=n;le(i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),le(s==null||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),le(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[r,i,a];let c=null;s!=null&&(c=s.shape,u.push(s));let f=null;o!=null&&(f=o.shape,u.push(o));const h=We().getBool("WEBGL_PACK_NORMALIZATION")?new tYe(r.shape,i.shape,a.shape,c,f,l):new eYe(r.shape,i.shape,a.shape,c,f,l);return e.runWebGLProgram(h,u,u[0].dtype)},rYe={kernelName:VL,backendName:"webgl",kernelFunc:nYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iYe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=$r(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=aYe(this.rank);let i;const a=e.map((s,o)=>`sourceLoc.${OR[o]} = start[${o}] + coords.${OR[o]};`);i=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const OR=["x","y","z","w","u","v"];function aYe(n){if(n===1)return"sourceLoc";if(n<=6)return OR.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sYe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=$r(this.rank),r=ma("coords",this.rank),i=ma("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,s=`getChannel(getSource(${i.join()}), ${a})`,o=`
      result.x = ${s};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${s};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${s};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${s};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((c,f)=>`start[${f}]`).join()});`:e.map((c,f)=>`${i[f]} = ${r[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oYe(n,e,t,r){const i=r.texData.get(n.dataId),a=r.makeTensorInfo(t,n.dtype),s=r.texData.get(a.dataId);Object.assign(s,i),s.refCount=1,s.shape=t,s.dtype=n.dtype;let o=qO(e,Ai(n.shape));i.slice&&(o+=i.slice.flatOffset),s.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||n.dataId};const l=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,l+1),a}function iv(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{begin:a,size:s}=r,[o,l]=qQ(i,a,s);if($Q(i,o,l),yt(l)===0)return t.makeTensorInfo(l,i.dtype,[]);if(t.shouldExecuteOnCPU([i])||i.dtype==="string"){const f=t.texData.get(i.dataId),h=eXe(f.values,o,l,i.shape,i.dtype);return t.makeTensorInfo(l,i.dtype,h)}const{isPacked:u}=t.texData.get(i.dataId),c=jO(i.shape,o,l);if(u||!c){const f=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sYe(l):new iYe(l),h=[o];return t.runWebGLProgram(f,[i],i.dtype,h)}return t.uploadToGPU(i.dataId),oYe(i,o,l,t)}const lYe={kernelName:KN,backendName:"webgl",kernelFunc:iv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uYe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{blockShape:a,crops:s}=r;le(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((_,x)=>_*x),l=j3(i.shape,a,o),u=q3(l.length,a.length),c=X3(i.shape,a,o),f=yte(s,a.length),h=_te(c,s,a.length),d=[],p=Mt({inputs:{x:i},backend:t,attrs:{shape:l}}),m=ba({inputs:{x:p},backend:t,attrs:{perm:u}}),g=Mt({inputs:{x:m},backend:t,attrs:{shape:c}}),v=iv({inputs:{x:g},backend:t,attrs:{begin:f,size:h}});return d.push(p),d.push(m),d.push(g),d.forEach(_=>t.disposeIntermediateTensorInfo(_)),v},cYe={kernelName:iL,backendName:"webgl",kernelFunc:uYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fYe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,weights:a}=e,{size:s}=r,o=t.readSync(i.dataId),l=t.readSync(a.dataId),u=kne(o,l,a.dtype,a.shape,s);return t.makeTensorInfo([s],a.dtype,u)}const hYe={kernelName:aL,backendName:"webgl",kernelFunc:fYe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dYe(n){const{inputs:e,backend:t}=n,{s0:r,s1:i}=e,a=t.readSync(r.dataId),s=t.readSync(i.dataId),o=Kn(Array.from(a),Array.from(s));return t.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const pYe={kernelName:sL,backendName:"webgl",kernelFunc:dYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mYe="return float(a != b);",Hne=zi({opSnippet:mYe,cpuKernelImpl:jqe,dtype:"bool"}),gYe={kernelName:bN,backendName:"webgl",kernelFunc:Hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(n){const{inputs:e,backend:t}=n,{input:r}=e,i=t.texData.get(r.dataId);return us({inputs:{x:i.complexTensorInfos.real},backend:t})}const vYe={kernelName:NN,backendName:"webgl",kernelFunc:nx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yYe="return float(int(x));";function _Ye(n,e){const t=new Fu(n.shape,yYe),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $R(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{dtype:a}=r;if(a==="complex64"){if(i.dtype==="complex64")return us({inputs:{x:i},backend:t});const s=bf(i.shape),o=$R({inputs:{x:i},backend:t,attrs:{dtype:"float32"}}),l=Of({inputs:{real:o,imag:s},backend:t});return s.dispose(),t.disposeIntermediateTensorInfo(o),l}if(i.dtype==="complex64"){const s=nx({inputs:{input:i},backend:t}),o=$R({inputs:{x:s},backend:t,attrs:{dtype:a}});return t.disposeIntermediateTensorInfo(s),o}if(!UZ(i.dtype,a)){const s=us({inputs:{x:i},backend:t});return{dataId:s.dataId,shape:s.shape,dtype:a}}if(t.shouldExecuteOnCPU([i])){const s=t.texData.get(i.dataId).values,[o,l,u]=Eqe(s,i.shape,i.dtype,a);return t.makeTensorInfo(o,l,u)}if(a==="int32")return _Ye(i,t);if(a==="bool"){const s=t.makeTensorInfo([],"bool",Xl("bool",1)),l=Hne({inputs:{a:i,b:s},backend:t});return t.disposeIntermediateTensorInfo(s),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}const xYe={kernelName:XT,backendName:"webgl",kernelFunc:$R};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wW="return ceil(x);",bYe=Zn({opSnippet:wW,packedOpSnippet:wW,cpuKernelImpl:Aqe}),wYe={kernelName:oL,backendName:"webgl",kernelFunc:bYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SYe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TYe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CYe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{clipValueMin:a,clipValueMax:s}=r;let o;We().getBool("WEBGL_PACK_CLIP")?o=new TYe(i.shape):o=new SYe(i.shape);const l=[[a],[s]];return t.runWebGLProgram(o,[i],i.dtype,l)}const EYe={kernelName:lL,backendName:"webgl",kernelFunc:CYe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AYe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function MYe(n){const{inputs:e,backend:t}=n,{x:r}=e,i=t.texData.get(r.dataId),a=new AYe(r.shape),s=[SW(r,i.complexTensorInfos.real),SW(r,i.complexTensorInfos.imag)];return t.runWebGLProgram(a,s,s[0].dtype)}const kYe={kernelName:cL,backendName:"webgl",kernelFunc:MYe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RYe{constructor(e){this.outputShape=[],this.outputShape=Pd(e,1),this.variableNames=e.map((s,o)=>`T${o}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let s=1;s<t.length;s++)t[s]=t[s-1]+e[s][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let s=1;s<t.length;s++){const o=t[s-1];r.push(`else if (yC < ${t[s]}) setOutput(getT${s}(yR, yC-${o}));`)}const i=t.length,a=t[t.length-1];r.push(`else setOutput(getT${i}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PYe{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Pd(e,t);const r=this.outputShape,i=r.length,a=$r(i),s=ma("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=e.map((m,g)=>`T${g}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][t];const u=o[t],c=o.slice(-2),f=o.join();let h=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const g=l[m-1];h+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${v1(o,u,g)}),
            vec2(${v1(c,u,g)}));
        }`}const d=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${d}(${v1(o,u,p)}),
          vec2(${v1(c,u,p)}));`,this.userCode=`
      float getValue(${o.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${s}), 0., 0., 0.);

        ${s[i-1]} = ${s[i-1]} + 1;
        if (${s[i-1]} < ${r[i-1]}) {
          result.g = getValue(${s});
        }

        ${s[i-2]} = ${s[i-2]} + 1;
        if (${s[i-2]} < ${r[i-2]}) {
          result.a = getValue(${s});
        }

        ${s[i-1]} = ${s[i-1]} - 1;
        if (${s[i-2]} < ${r[i-2]} &&
            ${s[i-1]} < ${r[i-1]}) {
          result.b = getValue(${s});
        }
        setOutput(result);
      }
    `}}function v1(n,e,t){const r=n.indexOf(e);return n.map((a,s)=>s===r?`${a} - ${t}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CC(n){const{inputs:e,backend:t}=n,{input:r}=e,i=t.texData.get(r.dataId);return us({inputs:{x:i.complexTensorInfos.imag},backend:t})}const IYe={kernelName:XL,backendName:"webgl",kernelFunc:CC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ry(n,e,t){const r=n[0].dtype;if(r==="complex64"){const f=n.map(g=>nx({inputs:{input:g},backend:t})),h=n.map(g=>CC({inputs:{input:g},backend:t})),d=Ry(f,e,t),p=Ry(h,e,t),m=Of({inputs:{real:d,imag:p},backend:t});return f.forEach(g=>t.disposeIntermediateTensorInfo(g)),h.forEach(g=>t.disposeIntermediateTensorInfo(g)),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),m}let i=t.shouldExecuteOnCPU(n);if(r==="string"&&(i=!0),i){const f=n.map(_=>{const b=[-1,yt(_.shape.slice(e))];return Mt({inputs:{x:_},backend:t,attrs:{shape:b}})}),h=f.map(_=>({vals:t.readSync(_.dataId),shape:_.shape})),d=Pd(f.map(_=>_.shape),1),p=f[0].shape[0]===1,m=Mqe(h,d,r,p),g=Pd(n.map(_=>_.shape),e),v=t.makeTensorInfo(g,r,m);return f.forEach(_=>t.disposeIntermediateTensorInfo(_)),v}const a=We().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(n.length>a){const f=[];for(let d=0;d<n.length;d+=a){const p=n.slice(d,d+a);f.push(Ry(p,e,t))}const h=Ry(f,e,t);for(const d of f)t.disposeIntermediateTensorInfo(d);return h}if(We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].shape.length>1){const f=new PYe(n.map(h=>h.shape),e);return t.runWebGLProgram(f,n,r)}const{tensors2D:s,outShape:o}=DYe(n,e,t),l=new RYe(s.map(f=>f.shape)),u=t.runWebGLProgram(l,s,r);s.forEach(f=>t.disposeIntermediateTensorInfo(f));const c=Mt({inputs:{x:u},attrs:{shape:o},backend:t});return t.disposeIntermediateTensorInfo(u),c}function DYe(n,e,t){const r=Pd(n.map(a=>a.shape),e);return{tensors2D:n.map(a=>Mt({inputs:{x:a},attrs:{shape:[-1,yt(a.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(n){const{inputs:e,backend:t,attrs:r}=n,{axis:i}=r,a=_i(i,e[0].shape)[0],s=e.map(u=>u.shape);hte(s,a);const o=Pd(e.map(u=>u.shape),a);if(yt(o)===0)return t.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(u=>yt(u.shape)>0);return l.length===1?us({inputs:{x:l[0]},backend:t}):Ry(l,a,t)}const LYe={kernelName:fL,backendName:"webgl",kernelFunc:Wne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gne{constructor(e,t=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const s=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,g=e.dataFormat==="channelsLast",v=g?1:2,_=g?2:3,x=g?3:1;let b="",S="";r&&(i?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:b=`
          float activation(float x) {
            ${r}
          }
        `,S="result = activation(result);");const T=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${x}];

        ivec2 xRCCorner =
            ivec2(coords[${v}], coords[${_}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${d}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${g}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${g}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${g}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${g}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${T}
        ${S}
        setOutput(result);
      }
    `}}class NYe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,i=e.padInfo.left,a=e.strideDepth,s=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,f=e.filterDepth,h=e.filterHeight,d=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${s}, ${o});
      const ivec3 pads = ivec3(${t}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jne{constructor(e,t=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ta(this.outputShape.length);const s=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,f=c;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<c;g++)h+=`
           vec4 xTexelC${g*2};
           int xTexelC${g*2}Ready;
           vec4 xTexelC${g*2+1};
           int xTexelC${g*2+1}Ready;
           vec4 xC${g};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let g=0;g<c;g++)h+=`
           xTexelC${g*2} = vec4(0.0);
           xTexelC${g*2}Ready = 0;
           xTexelC${g*2+1} = vec4(0.0);
           xTexelC${g*2+1}Ready = 0;
           xC${g} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let g=0;g<(f+1)/2;g++){const v=g*2;if(h+=`
           xC = xCCorner + ${v*l};
           `,o===1){if(v<c&&(s%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }
               `,l===1&&v>0?h+=`
                 xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                   } else {
                     xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xC${v} = xTexelC${v};
                 `,v+1<c)){const _=s%2===0?GT(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${_};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                     xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${v+1}.zw = vec2(0.0);
                     }
                     xTexelC${v+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                     } else {
                      xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                     }
                     `:h+=`
                     xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                     `):_===1?h+=`
                     xC${v+1} = xTexelC${v};
                     `:h+=`
                     xCOffset = xC + ${_};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                       xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${v+1}.zw = vec2(0.0);
                       }
                       xTexelC${v+1}Ready = 1;
                     }

                     xC${v+1} = xTexelC${v+1};
                     `}}else v<c&&(s%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.0);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
               `,v+1<c&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                   xTexelC${v} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${v}.zw = vec2(0.0);
                   }
                   xTexelC${v}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                   xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${v+1}.zw = vec2(0.);
                   }
                   xTexelC${v+1}Ready = 1;
                 }

                 xC${v} = vec4(
                   xTexelC${v}.xy, xTexelC${v+1}.xy);
               `,v+1<c&&(h+=`
                   xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                 `)));v<c&&(h+=`
             wTexel = getW(r, ${v}, d1, d2);
             dotProd += xC${v}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${v}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,v+1<c&&(h+=`
               wTexel = getW(r, ${v+1}, d1, d2);
               dotProd += xC${v+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${v+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let d="",p="";r&&(i?d=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:a?d=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:d=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${d}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OYe{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Ta(this.outputShape.length);const{dataFormat:r}=t,i=Sa(),a=r==="channelsLast",s=a?1:2,o=a?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${s}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MS(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function qne({x:n,filter:e,convInfo:t,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:o=null}){const l=n.shape,u=r.texData.get(n.dataId),c=t.inChannels,f=l[0]*l[1]*l[2],h=t.outChannels,d=t.dataFormat==="channelsLast",p=!1,m=!1;let g;const v=[];if(a!=null){const b=MS(a.shape,d);b!=null&&(a=Mt({inputs:{x:a},backend:r,attrs:{shape:b}}),v.push(a))}if(i!=null){const b=MS(i.shape,d);b!=null&&(i=Mt({inputs:{x:i},backend:r,attrs:{shape:b}}),v.push(i))}if(!((f===1||h===1)&&c>Bne)&&u.isPacked&&d&&u.texture!=null&&l[2]%2!==0&&Jr(u.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),S={dataId:n.dataId,shape:[1,b,t.inChannels],dtype:n.dtype},T=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,le(CS(u.shape,S.shape),()=>`packed reshape ${u.shape} to ${S.shape} isn't free`);const M=Mt({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});v.push(M);const C=AS({a:S,b:M,backend:r,transposeA:p,transposeB:m,bias:i,activation:o,preluActivationWeights:a,leakyreluAlpha:s}),k=r.texData.get(C.dataId);le(k.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=T,k.shape=t.outShape,g=us({inputs:{x:C},backend:r}),g.shape=t.outShape,v.push(C)}else{const b=t.outHeight*t.outWidth,S=Mt({inputs:{x:n},backend:r,attrs:{shape:d?[t.batchSize,b,t.inChannels]:[t.batchSize,t.inChannels,b]}}),T=Mt({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),M=AS({a:d?S:T,b:d?T:S,transposeA:!d,transposeB:m,backend:r,bias:i,activation:o,preluActivationWeights:a,leakyreluAlpha:s});g=Mt({inputs:{x:M},backend:r,attrs:{shape:t.outShape}}),v.push(S),v.push(T),v.push(M)}for(const b of v)r.disposeIntermediateTensorInfo(b);return g}function Xne({x:n,filter:e,convInfo:t,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:s=0,activation:o=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:f,outHeight:h,dataFormat:d}=t,p=d==="channelsLast",m=l*u*c,g=h*f,v=[t.batchSize,m,g],_=!0,x=!1,b=[];if(a!=null){const j=MS(a.shape,p);j!=null&&(a=Mt({inputs:{x:a},backend:r,attrs:{shape:j}}),b.push(a))}if(i!=null){const j=MS(i.shape,p);j!=null&&(i=Mt({inputs:{x:i},backend:r,attrs:{shape:j}}),b.push(i))}const S=Mt({inputs:{x:e},backend:r,attrs:{shape:[1,m,yt(e.shape)/m]}});b.push(S);const T=new OYe(v,t),M=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],C=r.runWebGLProgram(T,[n],"float32",M),k=Mt({inputs:{x:C},backend:r,attrs:{shape:v}});b.push(C),b.push(k);const R=i!=null,P=a!=null,N=o==="leakyrelu",L=o?d_(o,!0):null,F=new Fne(p?k.shape:S.shape,p?S.shape:k.shape,p?[t.batchSize,g,t.outChannels]:[t.batchSize,t.outChannels,g],_,x,R,L,P,N),O=p?[k,S]:[S,k];if(i&&O.push(i),P&&O.push(a),N){const j=r.makeTensorInfo([],"float32",qd(s,"float32"));O.push(j),b.push(j)}const B=r.runWebGLProgram(F,O,"float32"),H=Mt({inputs:{x:B},backend:r,attrs:{shape:t.outShape}});b.push(B);for(const j of b)r.disposeIntermediateTensorInfo(j);return H}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ye(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:a}=e,{strides:s,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=r,f=Xg(l),h=Ds(i.shape,a.shape,s,u,o,c,!1,f);let d;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))d=qne({x:i,filter:a,convInfo:h,backend:t});else if(h.strideWidth<=2&&f==="channelsLast"&&We().getBool("WEBGL_EXP_CONV")){const m=new jne(h),g=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];d=t.runWebGLProgram(m,[i,a],"float32",g)}else if(We().getBool("WEBGL_CONV_IM2COL"))d=Xne({x:i,filter:a,convInfo:h,backend:t});else{const m=new Gne(h);d=t.runWebGLProgram(m,[i,a],"float32")}const p=Mt({inputs:{x:d},backend:t,attrs:{shape:h.outShape}});return t.disposeIntermediateTensorInfo(d),p}const FYe={kernelName:hL,backendName:"webgl",kernelFunc:$Ye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BYe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,i=e.padInfo.top,a=e.padInfo.left,s=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${i};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${s}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class UYe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,i=e.strideHeight,a=e.strideWidth,s=e.dataFormat==="channelsLast",o=t-1-e.padInfo.top,l=r-1-e.padInfo.left,u=s?1:2,c=s?2:3,f=s?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${s}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class zYe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,i=e.strideWidth,a=e.padInfo.front,s=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${s};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class VYe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,i=e.filterWidth,a=e.strideDepth,s=e.strideHeight,o=e.strideWidth,l=t-1-e.padInfo.front,u=r-1-e.padInfo.top,c=i-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HYe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,dy:a}=e,{strides:s,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,f=Xg(l),h=Ds(i.shape,c,s,1,o,u,!1,f),d=new BYe(h);return t.runWebGLProgram(d,[i,a],"float32")}const WYe={kernelName:dL,backendName:"webgl",kernelFunc:HYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GYe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,filter:a}=e,{inputShape:s,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=r,f=Xg(u),h=Ds(s,a.shape,o,1,l,c,!1,f),d=new UYe(h);return t.runWebGLProgram(d,[i,a],"float32")}const jYe={kernelName:pL,backendName:"webgl",kernelFunc:GYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qYe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:a}=e,{strides:s,pad:o,dilations:l}=r,u=W_(i.shape,a.shape,s,l,o),c=new NYe(u);return t.runWebGLProgram(c,[i,a],"float32")}const XYe={kernelName:mL,backendName:"webgl",kernelFunc:qYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KYe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,dy:a}=e,{strides:s,pad:o,filterShape:l}=r,u=W_(i.shape,l,s,1,o),c=new zYe(u);return t.runWebGLProgram(c,[i,a],"float32")}const YYe={kernelName:KZ,backendName:"webgl",kernelFunc:KYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZYe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,filter:a}=e,{pad:s,strides:o,inputShape:l}=r,u=W_(l,a.shape,o,1,s),c=new VYe(u);return t.runWebGLProgram(c,[i,a],"float32")}const QYe={kernelName:gL,backendName:"webgl",kernelFunc:ZYe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JYe=rv+`
  return cos(x);
`,eZe=Zn({opSnippet:JYe}),tZe={kernelName:vL,backendName:"webgl",kernelFunc:eZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,rZe=Zn({opSnippet:nZe}),iZe={kernelName:yL,backendName:"webgl",kernelFunc:rZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aZe{constructor(e,t,r,i,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,o,l,u]=e,[c]=t,[f,h]=r;this.outputShape=[c,f,h,u];const d=i==="bilinear"?1:0,[p,m]=[`${o-1}.0`,`${l-1}.0`],[g,v,_]=f>1?[`${(o-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[x,b,S]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${g});
      const float width_ratio = float(${x});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${s}) {
          return;
        }

        float height_scale = ${v};
        float width_scale = ${b};

        float in_y = ${_};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${S};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${d} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sZe=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:i,boxes:a,boxInd:s}=e,{cropSize:o,method:l,extrapolationValue:u}=r,c=new aZe(i.shape,a.shape,o,l,u);return t.runWebGLProgram(c,[i,a,s],"float32")},oZe={kernelName:bL,backendName:"webgl",kernelFunc:sZe};var m_;(function(n){n.Prod="*",n.Sum="+"})(m_||(m_={}));class TW{constructor(e,t,r,i){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,s=this.op===m_.Prod?"1.0":"0.0",o=r?s:`getX(${CW(a,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=i?`end != ${l-1}`:"end != 0",c=i?"end + 1":"end - 1"):(u=i?`end + pow2 < ${l}`:"end >= pow2",c=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${$r(a)} coords = getOutputCoords();
        int end = ${EW(a,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${EW(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${CW(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function CW(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function EW(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(n,e,t,r,i,a){const s=e.shape.length,o=Co([r],s);let l=e;o!=null&&(l=ba({inputs:{x:e},backend:t,attrs:{perm:o}}));const u=Eo(1,s)[0];if(u!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let f=us({inputs:{x:l},backend:t});for(let h=0;h<=Math.ceil(Math.log2(c))-1;h++){const d=new TW(n,l.shape,!1,a),p=[[h]],m=f;f=t.runWebGLProgram(d,[f],f.dtype,p),t.disposeIntermediateTensorInfo(m)}if(i){const h=new TW(n,l.shape,i,a),d=f;f=t.runWebGLProgram(h,[f],f.dtype),t.disposeIntermediateTensorInfo(d)}if(o!=null){const h=i3(o),d=ba({inputs:{x:f},backend:t,attrs:{perm:h}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(l),d}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,exclusive:s,reverse:o}=r;return Kne(m_.Prod,i,t,a,s,o)}const uZe={kernelName:_L,backendName:"webgl",kernelFunc:lZe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,exclusive:s,reverse:o}=r;return Kne(m_.Sum,i,t,a,s,o)}const fZe={kernelName:xL,backendName:"webgl",kernelFunc:cZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,weights:a}=e,{size:s,binaryOutput:o}=r;if(i.shape.length===1){const l=t.readSync(i.dataId),u=t.readSync(a.dataId),c=kne(l,u,a.dtype,a.shape,s);return t.makeTensorInfo([s],a.dtype,c)}else if(i.shape.length===2){const l=t.bufferSync(i),u=t.bufferSync(a),c=Cqe(l,u,s,o);return t.makeTensorInfo(c.shape,a.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const dZe={kernelName:wL,backendName:"webgl",kernelFunc:hZe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pZe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{blockSize:a,dataFormat:s}=r,o=i.shape[0],l=s==="NHWC"?i.shape[1]:i.shape[2],u=s==="NHWC"?i.shape[2]:i.shape[3],c=s==="NHWC"?i.shape[3]:i.shape[1],f=l*a,h=u*a,d=c/(a*a),p=s==="NHWC"?[o,f,h,d]:[o,d,f,h],m=new pZe(p,a,s);return t.runWebGLProgram(m,[i],i.dtype)}const gZe={kernelName:SL,backendName:"webgl",kernelFunc:mZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yne{constructor(e,t=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ta(this.outputShape.length);const s=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(i?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${s}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zne{constructor(e,t=!1,r=null,i=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Ta(this.outputShape.length);const s=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,h=f;let d=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<f;v++)d+=`
          vec4 xTexelC${v*2};
          int xTexelC${v*2}Ready;
          vec4 xTexelC${v*2+1};
          int xTexelC${v*2+1}Ready;
          vec4 xC${v};`;d+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let v=0;v<f;v++)d+=`
          xTexelC${v*2} = vec4(0.0);
          xTexelC${v*2}Ready = 0;
          xTexelC${v*2+1} = vec4(0.0);
          xTexelC${v*2+1}Ready = 0;
          xC${v} = vec4(0.0);`;d+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let v=0;v<(h+1)/2;v++){const _=v*2;if(d+=`
          xC = xCCorner + ${_*u};
          `,l===1){if(_<f&&(o%2===1?(d+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_}Ready == 0) {
                  xTexelC${_} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${_}.zw = vec2(0.0);
                  }
                  xTexelC${_}Ready = 1;
                }
              `,u===1&&_>0?d+=`
                xC${_} = vec4(xTexelC${_-2}.zw, xTexelC${_}.xy);
                `:d+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${_} = vec4(previous.zw, xTexelC${_}.xy);
                  } else {
                    xC${_} = vec4(0.0, 0.0, xTexelC${_}.xy);
                  }
                  `):d+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${_}Ready == 0) {
                  xTexelC${_} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${_}.zw = vec2(0.0);
                  }
                  xTexelC${_}Ready = 1;
                }

                xC${_} = xTexelC${_};
                `,_+1<f)){const x=o%2===0?GT(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(d+=`
                  xCOffset = xC + imod(pads[1], 2) + ${x};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_+1}Ready == 0) {
                    xTexelC${_+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${_+1}.zw = vec2(0.0);
                    }
                    xTexelC${_+1}Ready = 1;
                  }
                  `,u>1?d+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${_+1} = vec4(previous.zw, xTexelC${_+1}.xy);
                    } else {
                     xC${_+1} = vec4(0.0, 0.0, xTexelC${_+1}.xy);
                    }
                    `:d+=`
                    xC${_+1} = vec4(xTexelC${_}.zw, xTexelC${_+1}.xy);
                    `):x===1?d+=`
                    xC${_+1} = xTexelC${_};
                    `:d+=`
                    xCOffset = xC + ${x};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_+1}Ready == 0) {
                      xTexelC${_+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${_+1}.zw = vec2(0.0);
                      }
                      xTexelC${_+1}Ready = 1;
                    }

                    xC${_+1} = xTexelC${_+1};
                    `}}else _<f&&(o%2===1?(d+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_}Ready == 0) {
                  xTexelC${_} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${_}.zw = vec2(0.0);
                  }
                  xTexelC${_}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${_+1}Ready == 0) {
                  xTexelC${_+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${_+1}.zw = vec2(0.0);
                  }
                  xTexelC${_+1}Ready = 1;
                }

                xC${_} = vec4(xTexelC${_}.zw, xTexelC${_+1}.zw);
              `,_+1<f&&(d+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${_+1} = vec4(xTexelC${_+1}.xy, final.xy);
                `)):(d+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${_}Ready == 0) {
                  xTexelC${_} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${_}.zw = vec2(0.0);
                  }
                  xTexelC${_}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${_+1}Ready == 0) {
                  xTexelC${_+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${_+1}.zw = vec2(0.);
                  }
                  xTexelC${_+1}Ready = 1;
                }

                xC${_} = vec4(
                  xTexelC${_}.xy, xTexelC${_+1}.xy);
              `,_+1<f&&(d+=`
                  xC${_+1} = vec4(xTexelC${_}.zw, xTexelC${_+1}.zw);
                `)));_<f&&(d+=`
            wTexel = getW(r, ${_}, d1, q);
            dotProd += xC${_} * vec4(wTexel.xz, wTexel.xz);
          `,_+1<f&&(d+=`
              wTexel = getW(r, ${_+1}, d1, q);
              dotProd += xC${_+1} * vec4(wTexel.xz, wTexel.xz);
            `))}d+=`
    }
  `,d+=`
      }
    `;let p="",m="";r&&(i?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:a?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${d}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${g}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:a}=e,{strides:s,pad:o,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),le(hs(s,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const f=Ds(i.shape,a.shape,s,c,o,u,!0);let h;We().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?h=new Zne(f):h=new Yne(f);const d=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(h,[i,a],"float32",d)}const yZe={kernelName:TL,backendName:"webgl",kernelFunc:vZe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Ze{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,i=e.padInfo.top,a=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${s} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${i};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xZe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.top,o=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,dy:a}=e,{strides:s,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=r,f=Ds(i.shape,c,s,o,l,u,!0),h=new _Ze(f);return t.runWebGLProgram(h,[i,a],"float32")}const wZe={kernelName:CL,backendName:"webgl",kernelFunc:bZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SZe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,filter:a}=e,{strides:s,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=r,f=Ds(c,a.shape,s,o,l,u,!0),h=new xZe(f);return t.runWebGLProgram(h,[i,a],"float32")}const TZe={kernelName:EL,backendName:"webgl",kernelFunc:SZe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CZe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZe(n){const{inputs:e,backend:t}=n,{x:r}=e,i=[...r.shape,...r.shape],a=yt(r.shape),s=Mt({inputs:{x:r},backend:t,attrs:{shape:[a]}}),o=new CZe(a),l=t.runWebGLProgram(o,[s],s.dtype),u=Mt({inputs:{x:l},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(l),u}const AZe={kernelName:AL,backendName:"webgl",kernelFunc:EZe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MZe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:i,strideHeight:a,strideWidth:s,filterHeight:o,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:f,left:h}=i;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${s});
      const ivec2 pads = ivec2(${f}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:a}=e,{strides:s,pad:o,dilations:l}=r,u=cJ(i.shape,a.shape,s,o,"NHWC",l);let c;const f=new MZe(u);c=t.runWebGLProgram(f,[i,a],"float32");const h=Mt({inputs:{x:c},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(c),h}const RZe={kernelName:ML,backendName:"webgl",kernelFunc:kZe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZe(n){const{inputs:e,backend:t,attrs:r}=n,{equation:i}=r,a=e,{allDims:s,summedDims:o,idDims:l}=Mte(i,a.length);Rte(s.length,l,a);const{path:u,steps:c}=Pte(o,l),f=c.length;let h=null,d=s.length;const p=[];for(let m=0;m<f;++m){for(const g of c[m]){const{permutationIndices:v,expandDims:_}=kte(d,l[g]);let x;Ite(v)?x=a[g]:(x=ba({inputs:{x:a[g]},backend:t,attrs:{perm:v}}),p.push(x));const b=x.shape.slice();for(let S=0;S<_.length;++S)b.splice(_[S],0,1);Jr(x.shape,b)||(x=Mt({inputs:{x},backend:t,attrs:{shape:b}}),p.push(x)),h===null?h=x:(h=a$({inputs:{a:x,b:h},backend:t}),p.push(h))}m<f-1&&(u[m]>=0&&(h=TC({inputs:{x:h},backend:t,attrs:{axis:u[m]-(s.length-d),keepDims:!1}}),p.push(h)),d--)}for(const m of p)m!==h&&t.disposeIntermediateTensorInfo(m);return h}const IZe={kernelName:RL,backendName:"webgl",kernelFunc:PZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DZe="return (x >= 0.0) ? x : (exp(x) - 1.0);",LZe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,NZe=Zn({opSnippet:DZe,packedOpSnippet:LZe}),OZe={kernelName:PL,backendName:"webgl",kernelFunc:NZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ze="return (b >= 1.0) ? a : a * (b + 1.0);",FZe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,BZe=n=>{const{inputs:e,backend:t}=n,{dy:r,y:i}=e,a=We().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new tx(FZe,r.shape,i.shape):new Eg($Ze,r.shape,i.shape);return t.runWebGLProgram(a,[r,i],r.dtype)},UZe={kernelName:YZ,backendName:"webgl",kernelFunc:BZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zZe=`
  return vec4(equal(a, b));
`,VZe="return float(a == b);",HZe=zi({opSnippet:VZe,packedOpSnippet:zZe,dtype:"bool",cpuKernelImpl:kqe}),WZe={kernelName:DL,backendName:"webgl",kernelFunc:HZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${wte};
  float a1 = ${Ste};
  float a2 = ${Tte};
  float a3 = ${Cte};
  float a4 = ${Ete};
  float a5 = ${Ate};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,jZe=Zn({opSnippet:GZe}),qZe={kernelName:IL,backendName:"webgl",kernelFunc:jZe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XZe=rv+`
  return exp(x);
`,KZe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Qne=Zn({opSnippet:XZe,packedOpSnippet:KZe,cpuKernelImpl:Rqe,dtype:"float32"}),YZe={kernelName:LL,backendName:"webgl",kernelFunc:Qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FR(n){const{inputs:e,attrs:t,backend:r}=n,{dim:i}=t,{input:a}=e,s=a.shape.length,o=a.shape.slice();let l=i;return i<0&&(le(-(s+1)<=i,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),l=s+i+1),o.splice(l,0,1),Mt({inputs:{x:a},backend:r,attrs:{shape:o}})}const ZZe={kernelName:NL,backendName:"webgl",kernelFunc:FR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AW="return exp(x) - 1.0;",QZe=Zn({opSnippet:AW,packedOpSnippet:AW,cpuKernelImpl:Pqe}),JZe={kernelName:OL,backendName:"webgl",kernelFunc:QZe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MW{constructor(e,t,r){this.variableNames=["real","imag"];const i=t[1];this.outputShape=t;const a=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${i}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${s};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(n,e,t){const r=t.texData.get(n.dataId),i=yt(n.shape),a=n.shape[n.shape.length-1],s=i/a,o=Mt({inputs:{x:n},backend:t,attrs:{shape:[s,a]}}),l=o.shape,u=new MW("real",l,e),c=new MW("imag",l,e),f=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=t.runWebGLProgram(u,f,"float32"),d=t.runWebGLProgram(c,f,"float32"),p=Of({inputs:{real:h,imag:d},backend:t});t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d);const m=Mt({inputs:{x:p},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQe(n){const{inputs:e,backend:t}=n,{input:r}=e;return Jne(r,!1,t)}const tQe={kernelName:$L,backendName:"webgl",kernelFunc:eQe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nQe{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rx(n){const{backend:e,attrs:t}=n,{shape:r,value:i}=t;let{dtype:a}=t;if(a=a||F_(i),a==="string"){const s=ga(a,yt(r));return s.fill(i),e.makeTensorInfo(r,a,s)}else{const s=new nQe(r,i),o=[[i]];return e.runWebGLProgram(s,[],a,o)}}const rQe={kernelName:FL,backendName:"webgl",kernelFunc:rx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iQe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQe={kernelName:BL,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,i=new iQe(t.shape);return r.runWebGLProgram(i,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kW="return floor(x);",sQe=Zn({opSnippet:kW,packedOpSnippet:kW,cpuKernelImpl:Iqe}),oQe={kernelName:UL,backendName:"webgl",kernelFunc:sQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lQe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,uQe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,cQe=zi({opSnippet:lQe,packedOpSnippet:uQe,dtype:"int32"}),fQe={kernelName:zL,backendName:"webgl",kernelFunc:cQe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hQe{constructor(e){this.variableNames=["A"];const t=Sa(),[r,i]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dQe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Sa(),[r,i]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQe={kernelName:uS,backendName:"webgl",kernelFunc:mQe};let Kp,PA=We().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function mQe(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:i}=e;const{numChannels:a}=r,s=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,u]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=[u,l],f=[u,l,a];if(o||s){const m=We().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Kp==null||m!==PA)&&(PA=m,Kp=document.createElement("canvas").getContext("2d",{willReadFrequently:PA})),Kp.canvas.width=l,Kp.canvas.height=u,Kp.drawImage(i,0,0,l,u),i=Kp.canvas}const h=t.makeTensorInfo(c,"int32");t.texData.get(h.dataId).usage=As.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(h.dataId),i);const d=We().getBool("WEBGL_PACK")?new dQe(f):new hQe(f),p=t.runWebGLProgram(d,[h],"int32");return t.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:a,bias:s,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:f,dimRoundingMode:h,activation:d,leakyreluAlpha:p}=r,m=Xg(c),g=Ds(i.shape,a.shape,l,f,u,h,!1,m);let v;const _=[],x=s!=null,b=o!=null,S=d==="leakyrelu",T=()=>{const C=[i,a],k=(R,P)=>{if(P==="NCHW"&&R.shape.length===1&&R.shape[0]!==1){const N=Mt({inputs:{x:R},backend:t,attrs:{shape:[R.shape[0],1,1]}});return _.push(N),N}return R};if(x&&C.push(k(s,c)),b&&C.push(k(o,c)),S){const R=t.makeTensorInfo([],"float32",qd(p,"float32"));C.push(R),_.push(R)}return C};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type==="SAME"||g.padInfo.type==="VALID"))v=qne({x:i,filter:a,convInfo:g,backend:t,bias:s,activation:d,preluActivationWeights:o,leakyreluAlpha:p});else if(g.strideWidth<=2&&m==="channelsLast"&&We().getBool("WEBGL_EXP_CONV")){const C=d?d_(d,!0):null,k=new jne(g,x,C,b,S),R=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],P=T();v=t.runWebGLProgram(k,P,"float32",R)}else if(We().getBool("WEBGL_CONV_IM2COL"))v=Xne({x:i,filter:a,convInfo:g,backend:t,bias:s,activation:d,preluActivationWeights:o,leakyreluAlpha:p});else{const C=d?d_(d,!1):null,k=new Gne(g,x,C,b,S),R=T();v=t.runWebGLProgram(k,R,"float32")}const M=Mt({inputs:{x:v},backend:t,attrs:{shape:g.outShape}});return _.push(v),_.forEach(C=>t.disposeIntermediateTensorInfo(C)),M}const vQe={kernelName:fS,backendName:"webgl",kernelFunc:gQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,filter:a,bias:s,preluActivationWeights:o}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:f,activation:h,leakyreluAlpha:d}=r,p=[];let m=c;m==null&&(m=[1,1]),le(hs(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const g=Ds(i.shape,a.shape,l,m,u,f,!0),v=We().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,_=h?d_(h,v):null,x=[i,a],b=s!=null,S=o!=null,T=h==="leakyrelu";if(b&&x.push(s),S&&x.push(o),T){const R=t.makeTensorInfo([],"float32",qd(d,"float32"));x.push(R),p.push(R)}let M;v?M=new Zne(g,b,_,S,T):M=new Yne(g,b,_,S,T);const C=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],k=t.runWebGLProgram(M,x,"float32",C);return p.forEach(R=>t.disposeIntermediateTensorInfo(R)),k}const _Qe={kernelName:hS,backendName:"webgl",kernelFunc:yQe};class xQe{constructor(e,t,r,i){this.sliceDim=e,this.strides=t,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const a=$r(r.length);let s=`
    int index;`;for(let o=0;o<this.sliceDim;o++)s+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${s}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQe(n){const{inputs:e,backend:t}=n,{params:r,indices:i}=e,a=i.shape,s=a[a.length-1],o=yt(r.shape),[l,u,c,f]=HO(r,i),h=Mt({inputs:{x:i},backend:t,attrs:{shape:[u,s]}}),d=Mt({inputs:{x:r},backend:t,attrs:{shape:[yt(r.shape)/c,c]}});if(t.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const v=t.readSync(i.dataId),_=t.bufferSync(r),x=Dqe(v,_,r.dtype,u,s,c,f,r.shape,o);return t.makeTensorInfo(l,r.dtype,x.values)}const p=new xQe(s,f,[u,c],r.shape),m=t.runWebGLProgram(p,[d,h],d.dtype),g=Mt({inputs:{x:m},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),g}const wQe={kernelName:WL,backendName:"webgl",kernelFunc:bQe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SQe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=$r(this.rank),i=TQe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function TQe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<n.length;i++)i===2?r.push("index"):r.push(`${t[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,indices:a}=e,{axis:s,batchDims:o}=r,l=_i(s,i.shape)[0];if(We().get("DEBUG")){const _=t.readSync(a.dataId),x=i.shape[l];for(let b=0;b<_.length;++b){const S=_[b];le(S<=x-1&&S>=0,()=>`GatherV2: the index value ${S} is not in [0, ${x-1}]`)}}const u=qte(i,a,l,o),c=yt(a.shape),f=[],h=Mt({inputs:{x:i},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),d=Mt({inputs:{x:a},backend:t,attrs:{shape:[u.batchSize,c/u.batchSize]}});f.push(h),f.push(d);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([i,a])||i.dtype==="string"){const _=t.bufferSync(d),x=t.bufferSync(h),b=Lqe(x,_,p);return f.forEach(S=>t.disposeIntermediateTensorInfo(S)),t.makeTensorInfo(u.outputShape,b.dtype,b.values)}const m=new SQe(h.shape,p),g=t.runWebGLProgram(m,[h,d],h.dtype);f.push(g);const v=Mt({inputs:{x:g},backend:t,attrs:{shape:u.outputShape}});return f.forEach(_=>t.disposeIntermediateTensorInfo(_)),v}const CQe={kernelName:HL,backendName:"webgl",kernelFunc:ere};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EQe="return float(a > b);",AQe=`
  return vec4(greaterThan(a, b));
`,MQe=zi({opSnippet:EQe,packedOpSnippet:AQe,cpuKernelImpl:Nqe,dtype:"bool"}),kQe={kernelName:GL,backendName:"webgl",kernelFunc:MQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQe="return float(a >= b);",PQe=`
  return vec4(greaterThanEqual(a, b));
`,IQe=zi({opSnippet:RQe,packedOpSnippet:PQe,dtype:"bool",cpuKernelImpl:Oqe}),DQe={kernelName:jL,backendName:"webgl",kernelFunc:IQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LQe(n){const{inputs:e,backend:t}=n,{input:r}=e;return Jne(r,!0,t)}const NQe={kernelName:qL,backendName:"webgl",kernelFunc:LQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQe="return float(!isnan(x) && !isinf(x));",$Qe=Zn({opSnippet:OQe,dtype:"bool"}),FQe={kernelName:KL,backendName:"webgl",kernelFunc:$Qe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BQe="return float(isinf(x));",UQe=Zn({opSnippet:BQe,dtype:"bool"}),zQe={kernelName:YL,backendName:"webgl",kernelFunc:UQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VQe="return float(isnan(x));",HQe=Zn({opSnippet:VQe,dtype:"bool"}),WQe={kernelName:ZL,backendName:"webgl",kernelFunc:HQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GQe="return float(a < b);",jQe=`
  return vec4(lessThan(a, b));
`,qQe=zi({opSnippet:GQe,packedOpSnippet:jQe,cpuKernelImpl:$qe,dtype:"bool"}),XQe={kernelName:JL,backendName:"webgl",kernelFunc:qQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQe="return float(a <= b);",YQe=`
  return vec4(lessThanEqual(a, b));
`,ZQe=zi({opSnippet:KQe,packedOpSnippet:YQe,cpuKernelImpl:Fqe,dtype:"bool"}),QQe={kernelName:eN,backendName:"webgl",kernelFunc:ZQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQe(n){const{backend:e,attrs:t}=n,{start:r,stop:i,num:a}=t,s=Bqe(r,i,a);return e.makeTensorInfo([s.length],"float32",s)}const eJe={kernelName:tN,backendName:"webgl",kernelFunc:JQe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJe=rv+`
  return x < 0.0 ? 0./0. : log(x);
`,nJe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,rJe=Zn({opSnippet:tJe,packedOpSnippet:nJe,cpuKernelImpl:Uqe}),iJe={kernelName:nN,backendName:"webgl",kernelFunc:rJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJe=rv+`
  return log(1.0 + x);
`,sJe=Zn({opSnippet:aJe}),oJe={kernelName:rN,backendName:"webgl",kernelFunc:sJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lJe="return float(a >= 1.0 && b >= 1.0);",uJe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,cJe=zi({opSnippet:lJe,packedOpSnippet:uJe,dtype:"bool"}),fJe={kernelName:iN,backendName:"webgl",kernelFunc:cJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJe="return float(!(x >= 1.0));",dJe=Zn({opSnippet:hJe}),pJe={kernelName:aN,backendName:"webgl",kernelFunc:dJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJe="return float(a >= 1.0 || b >= 1.0);",gJe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,vJe=zi({opSnippet:mJe,packedOpSnippet:gJe,dtype:"bool"}),yJe={kernelName:sN,backendName:"webgl",kernelFunc:vJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Je{constructor(e,t,r,i,a){this.variableNames=["x"],this.outputShape=[];const s=t,o=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${i}) * sum`;a===.5?l=`inversesqrt(${u})`:a===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${s}; j <= ${s}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xJe{constructor(e,t,r,i,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=t,o=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${i}) * sum`;a===.5?l=`inversesqrt(${u})`:a===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${s};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${s}; j <= ${s}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{depthRadius:a,bias:s,alpha:o,beta:l}=r,u=We().getBool("WEBGL_PACK_NORMALIZATION")?new xJe(i.shape,a,s,o,l):new _Je(i.shape,a,s,o,l);return t.runWebGLProgram(u,[i],i.dtype)},wJe={kernelName:oN,backendName:"webgl",kernelFunc:bJe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SJe{constructor(e,t,r,i,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=i,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${a})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJe=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i,y:a,dy:s}=e,{depthRadius:o,bias:l,alpha:u,beta:c}=r,f=new SJe(i.shape,o,l,u,c);return t.runWebGLProgram(f,[i,a,s],i.dtype)},CJe={kernelName:ZZ,backendName:"webgl",kernelFunc:TJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJe(n,e,t,r){const i=yt(e),s=yt(n.shape)/i,o=Mt({inputs:{x:n},attrs:{shape:[s,i]},backend:r}),l=Jd(o,n.dtype,"max",r),u=Mt({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tre(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{reductionIndices:a,keepDims:s}=r,o=i.shape.length,l=_i(a,i.shape);let u=l;const c=Co(u,o),f=c!=null,h=t.shouldExecuteOnCPU([i]);let d=i;if(f){if(h){const x=t.texData.get(d.dataId).values,b=new Array(o);for(let M=0;M<b.length;M++)b[M]=i.shape[c[M]];const S=r$(x,i.shape,i.dtype,c,b);d=t.makeTensorInfo(b,i.dtype);const T=t.texData.get(d.dataId);T.values=S}else d=SC(i,c,t);u=Eo(u.length,o)}hl("max",u,o);const[p,m]=ru(d.shape,u);let g=p;s&&(g=Ls(p,l));let v;if(h){const x=t.texData.get(d.dataId).values,b=zqe(x,yt(m),g,i.dtype);v=t.makeTensorInfo(g,i.dtype);const S=t.texData.get(v.dataId);S.values=b}else v=EJe(d,m,g,t);return f&&t.disposeIntermediateTensorInfo(d),v}const AJe={kernelName:lN,backendName:"webgl",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJe=i$+`
  return max(a, b);
`,kJe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ex+`
  return result;
`,RJe=zi({opSnippet:MJe,packedOpSnippet:kJe,cpuKernelImpl:Vqe}),PJe={kernelName:uN,backendName:"webgl",kernelFunc:RJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e;Q_(i,"maxPool");const{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=r,u=1;le(hs(s,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`);const c=Xd(i.shape,a,s,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Jr(c.inShape,c.outShape))return us({inputs:{x:i},backend:t});const f=new p_(c,"max",!1);return t.runWebGLProgram(f,[i],i.dtype)}const DJe={kernelName:cN,backendName:"webgl",kernelFunc:IJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{filterSize:a,strides:s,pad:o,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],f=H_(i.shape,a,s,c,o,u,l),h=new s$(f,"max",!1);return t.runWebGLProgram(h,[i],i.dtype)}const NJe={kernelName:fN,backendName:"webgl",kernelFunc:LJe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OJe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,a=e.effectiveFilterHeight,s=e.effectiveFilterWidth,o=a-1-e.padInfo.top,l=s-1-e.padInfo.left,u=a*s-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${s} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class $Je{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,i=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,f=l-1-e.padInfo.front,h=u-1-e.padInfo.top,d=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${h}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${s}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FJe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:a}=e,s=a,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=r,f=[1,1,1],h=H_(s.shape,o,l,f,u,c),d=new s$(h,"max",!0),p=t.runWebGLProgram(d,[s],s.dtype),m=new $Je(h),g=t.runWebGLProgram(m,[i,p],s.dtype);return t.disposeIntermediateTensorInfo(p),g}const BJe={kernelName:JZ,backendName:"webgl",kernelFunc:FJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UJe(n){const{inputs:e,backend:t,attrs:r}=n,{dy:i,input:a,output:s}=e,o=a;Q_([a,s],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:f}=r,h=Xd(o.shape,l,u,1,c,f),d=!0,p=new p_(h,"max",d),m=t.runWebGLProgram(p,[o],o.dtype),g=new OJe(h),v=t.runWebGLProgram(g,[i,m],o.dtype);return t.disposeIntermediateTensorInfo(m),v}const zJe={kernelName:QZ,backendName:"webgl",kernelFunc:UJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VJe(n,e,t,r){let i=new p_(t,"max",!1);const a=r.runWebGLProgram(i,[n],"float32");i=new p_(t,"max",!0,!0,e);const s=r.runWebGLProgram(i,[n],"float32");return[a,s]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJe={kernelName:hN,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:i,strides:a,pad:s,includeBatchInIndex:o}=e,l=t;le(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];le(hs(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const c=Xd(r.shape,i,a,u,s),[f,h]=VJe(r,o,c,l);return[f,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJe(n,e,t,r){const i=yt(e),s=yt(n.shape)/i,o=Mt({inputs:{x:n},attrs:{shape:[s,i]},backend:r}),l=Jd(o,"float32","mean",r),u=Mt({inputs:{x:l},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GJe={kernelName:dN,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:i,axis:a}=e,s=t,o=r.shape.length,l=_i(a,r.shape);let u=l;const c=Co(u,o),f=c!=null,h=s.shouldExecuteOnCPU([r]),d=[];let p=r;if(f){if(h){const b=s.texData.get(p.dataId).values,S=new Array(o);for(let C=0;C<S.length;C++)S[C]=r.shape[c[C]];const T=r$(b,r.shape,r.dtype,c,S);p=s.makeTensorInfo(S,r.dtype);const M=s.texData.get(p.dataId);M.values=T}else p=SC(r,c,s);d.push(p),u=Eo(u.length,o)}hl("sum",u,o);const[m,g]=ru(p.shape,u);let v=m;i&&(v=Ls(m,l));const _=WJe(p,g,v,s);for(const x of d)s.disposeIntermediateTensorInfo(x);return _}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jJe(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,keepDims:s}=r,o=i.shape.length,l=_i(a,i.shape);let u=l;const c=Co(u,o);let f=i;c!=null&&(f=ba({inputs:{x:i},backend:t,attrs:{perm:c}}),u=Eo(u.length,i.shape.length)),hl("min",u,o);const[h,d]=ru(f.shape,u),p=yt(d),m=Mt({inputs:{x:f},backend:t,attrs:{shape:[-1,p]}}),g=Jd(m,m.dtype,"min",t);let v;if(s){const _=Ls(h,l);v=Mt({inputs:{x:g},backend:t,attrs:{shape:_}})}else v=Mt({inputs:{x:g},backend:t,attrs:{shape:h}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),c!=null&&t.disposeIntermediateTensorInfo(f),v}const qJe={kernelName:pN,backendName:"webgl",kernelFunc:jJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XJe=i$+`
  return min(a, b);
`,KJe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ex+`
  return result;
`,YJe=zi({opSnippet:XJe,packedOpSnippet:KJe,cpuKernelImpl:Hqe}),ZJe={kernelName:mN,backendName:"webgl",kernelFunc:YJe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QJe{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((c,f)=>c[0]+e[f]+c[1]);const i=e.length,a=$r(i),s=t.map(c=>c[0]).join(","),o=t.map((c,f)=>c[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),u=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${s};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JJe{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((p,m)=>p[0]+e[m]+p[1]);const i=e.length,a=$r(i),s=t.map(p=>p[0]).join(","),o=t.map((p,m)=>p[0]+e[m]).join(","),l=ma("rc",i),u=ma("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,h=r==="reflect"?0:1;let d="";if(i===1){const p=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;d=`
        ${a} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const p=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;d=`
        ${a} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[i-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[i-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eet=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:i,mode:a}=t,s=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new JJe(r.shape,i,a):new QJe(r.shape,i,a);return e.runWebGLProgram(s,[r],r.dtype)},tet={kernelName:gN,backendName:"webgl",kernelFunc:eet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const net=`if (b == 0.0) return NAN;
  return mod(a, b);`,ret=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+ex+`
  return result;
`,iet=zi({opSnippet:net,packedOpSnippet:ret}),aet={kernelName:vN,backendName:"webgl",kernelFunc:iet};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class set{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oet=`
if (a == b) {
  return 1.0;
};
return a / b;`,uet=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,nre=zi({opSnippet:oet,packedOpSnippet:uet,checkOutOfBounds:!0}),cet={kernelName:kL,backendName:"webgl",kernelFunc:nre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RW="return a - b;",rre=zi({opSnippet:RW,packedOpSnippet:RW,supportsComplex:!0,cpuKernelImpl:lXe}),fet={kernelName:gO,backendName:"webgl",kernelFunc:rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ire(n){const{inputs:e,backend:t,attrs:r}=n,{logits:i}=e,{dim:a}=r,s=_i([a],i.shape),o=tre({inputs:{x:i},backend:t,attrs:{reductionIndices:s,keepDims:!1}}),l=Ls(o.shape,s),u=Mt({inputs:{x:o},backend:t,attrs:{shape:l}}),c=rre({inputs:{a:i,b:u},backend:t}),f=Qne({inputs:{x:c},backend:t}),h=TC({inputs:{x:f},backend:t,attrs:{axis:s,keepDims:!1}}),d=Mt({inputs:{x:h},backend:t,attrs:{shape:l}}),p=nre({inputs:{a:f,b:d},backend:t});return t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),p}const het={kernelName:aO,backendName:"webgl",kernelFunc:ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function det(n){const{inputs:e,backend:t,attrs:r}=n,{logits:i}=e,{numSamples:a,seed:s,normalized:o}=r,l=o?i:ire({inputs:{logits:i},backend:t,attrs:{dim:i.shape.length-1}}),u=l.shape[0],c=l.shape[1],f=new set(u,c,a),h=[[s]],d=t.runWebGLProgram(f,[l],"int32",h);return o||t.disposeIntermediateTensorInfo(l),d}const pet={kernelName:yN,backendName:"webgl",kernelFunc:det};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const met=Ao+`
  return -x;
`,get=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function vet(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const a=t.texData.get(r.dataId),[s,o]=Gqe(a.values,r.shape,r.dtype);return t.makeTensorInfo(o,r.dtype,s)}let i;return We().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new jh(r.shape,get):i=new Fu(r.shape,met),t.runWebGLProgram(i,[r],r.dtype)}const yet={kernelName:xN,backendName:"webgl",kernelFunc:vet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _et=z3;function xet(n){no("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:i,scores:a}=e,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l}=r,u=t.readSync(i.dataId),c=t.readSync(a.dataId),{selectedIndices:f}=_et(u,c,s,o,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const bet={kernelName:wN,backendName:"webgl",kernelFunc:xet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wet=V3;function Tet(n){no("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:i,scores:a}=e,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=r,c=t.readSync(i.dataId),f=t.readSync(a.dataId),{selectedIndices:h,validOutputs:d}=wet(c,f,s,o,l,u);return[t.makeTensorInfo([h.length],"int32",new Int32Array(h)),t.makeTensorInfo([],"int32",new Int32Array([d]))]}const Cet={kernelName:SN,backendName:"webgl",kernelFunc:Tet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eet=H3;function Aet(n){no("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:i,scores:a}=e,{maxOutputSize:s,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=r,c=t.readSync(i.dataId),f=t.readSync(a.dataId),h=s,d=o,p=l,m=u,{selectedIndices:g,selectedScores:v}=Eet(c,f,h,d,p,m);return[t.makeTensorInfo([g.length],"int32",new Int32Array(g)),t.makeTensorInfo([v.length],"float32",new Float32Array(v))]}const Met={kernelName:TN,backendName:"webgl",kernelFunc:Aet};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ket{constructor(e,t,r,i){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ret=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:i}=e,{dtype:a,depth:s,onValue:o,offValue:l}=r,u=yt(i.shape),c=new ket(u,s,o,l),f=Mt({inputs:{x:i},backend:t,attrs:{shape:[u]}}),h=t.runWebGLProgram(c,[f],a);t.disposeIntermediateTensorInfo(f);const d=[...i.shape,s],p=Mt({inputs:{x:h},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(h),p},Pet={kernelName:EN,backendName:"webgl",kernelFunc:Ret};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kS(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const i=nx({inputs:{input:r},backend:t}),a=kS({inputs:{x:i},backend:t}),s=CC({inputs:{input:r},backend:t}),o=kS({inputs:{x:s},backend:t}),l=Of({inputs:{real:a,imag:o},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),l}else return rx({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const Iet={kernelName:TO,backendName:"webgl",kernelFunc:kS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function are(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=nx({inputs:{input:r},backend:t}),a=are({inputs:{x:i},backend:t}),s=CC({inputs:{input:r},backend:t}),o=kS({inputs:{x:s},backend:t}),l=Of({inputs:{real:a,imag:o},backend:t});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),l}else return rx({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const Det={kernelName:CN,backendName:"webgl",kernelFunc:are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Let(n){const{inputs:e,backend:t,attrs:r}=n,{axis:i}=r;if(e.length===1)return FR({inputs:{input:e[0]},backend:t,attrs:{dim:i}});const a=e[0].shape,s=e[0].dtype;e.forEach(c=>{Qi(a,c.shape,"All tensors passed to stack must have matching shapes"),le(s===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(c=>{const f=FR({inputs:{input:c},backend:t,attrs:{dim:i}});return o.push(f),f}),u=Wne({inputs:l,backend:t,attrs:{axis:i}});return o.forEach(c=>t.disposeIntermediateTensorInfo(c)),u}const Net={kernelName:AN,backendName:"webgl",kernelFunc:Let};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oet{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,c)=>u[0]+e[c]+u[1]);const i=e.length,a=$r(i),s=t.map(u=>u[0]).join(","),o=t.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${s};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${s});
      ${a} end = ${a}(${o});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $et{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((m,g)=>m[0]+e[g]+m[1]);const i=e.length,a=$r(i),s=t.map(m=>m[0]).join(","),o=t.map((m,g)=>m[0]+e[g]).join(","),l=ma("rc",i),u=ma("source",i),c=`${l[i-1]} < ${this.outputShape[i-1]}`,f=i===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${a} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${c}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${c}) {`],d=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,g=i===1?2:4;m<g;m++)p+=`
        ${h[m]}
        if (${d}) {
          result[${m}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${f});
        }
      `;p+=i===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${s});
      const ${a} end = ${a}(${o});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sre=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{paddings:a,constantValue:s}=r;if(yt(i.shape)===0){const u=a.map((c,f)=>c[0]+i.shape[f]+c[1]);return rx({backend:t,attrs:{shape:u,value:s,dtype:i.dtype}})}const o=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $et(i.shape,a,s):new Oet(i.shape,a,s),l=[[s]];return t.runWebGLProgram(o,[i],i.dtype,l)},Fet={kernelName:MN,backendName:"webgl",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bet=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Uet=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+ex+`
  return result;
`,zet=zi({opSnippet:Bet,packedOpSnippet:Uet}),Vet={kernelName:kN,backendName:"webgl",kernelFunc:zet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Het(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{axis:a,keepDims:s}=r,o=i.shape.length,l=[],u=_i(a,i.shape);let c=u;const f=Co(c,o);let h=i;f!=null&&(h=ba({inputs:{x:i},backend:t,attrs:{perm:f}}),c=Eo(c.length,o),l.push(h)),hl("prod",c,o);let d;if(t.shouldExecuteOnCPU([h])){const p=t.texData.get(h.dataId).values,{outVals:m,outShape:g,outDtype:v}=qqe(h.shape,h.dtype,p,c);d=t.makeTensorInfo(g,v,m)}else{const[p,m]=ru(h.shape,c),g=yt(m),v=Mt({inputs:{x:h},backend:t,attrs:{shape:[-1,g]}}),_=ZT(i.dtype),x=Jd(v,_,"prod",t);d=Mt({inputs:{x},backend:t,attrs:{shape:p}}),l.push(v),l.push(x)}if(s){l.push(d);const p=Ls(d.shape,u);d=Mt({inputs:{x:d},backend:t,attrs:{shape:p}})}return l.forEach(p=>t.disposeIntermediateTensorInfo(p)),d}const Wet={kernelName:PN,backendName:"webgl",kernelFunc:Het};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Get(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:i,paramsDenseValues:a,indices:s}=e,{outputRaggedRank:o}=r,l=i.map(v=>t.readSync(v.dataId)),u=i.map(v=>v.shape),c=t.readSync(a.dataId),f=t.readSync(s.dataId),[h,d,p]=Xqe(l,u,c,a.shape,a.dtype,f,s.shape,o),m=h.map(v=>t.makeTensorInfo([v.length],"int32",v)),g=t.makeTensorInfo(p,a.dtype,d);return m.concat([g])}const jet={kernelName:IN,backendName:"webgl",kernelFunc:Get};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qet(n){const{inputs:e,backend:t,attrs:r}=n,{shape:i,values:a,defaultValue:s,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=r,u=t.readSync(i.dataId),c=t.readSync(a.dataId),f=t.readSync(s.dataId),h=o.map(g=>t.readSync(g.dataId)),d=o.map(g=>g.shape),[p,m]=Kqe(u,i.shape,c,a.shape,a.dtype,f,s.shape,h,d,l);return t.makeTensorInfo(p,a.dtype,m)}const Xet={kernelName:DN,backendName:"webgl",kernelFunc:qet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore=n=>{const{backend:e,attrs:t}=n,{start:r,stop:i,step:a,dtype:s}=t,o=Yqe(r,i,a,s);return e.makeTensorInfo([o.length],s,o)},Ket={kernelName:LN,backendName:"webgl",kernelFunc:ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yet="return 1.0 / x;",Zet=Zn({opSnippet:Yet}),Qet={kernelName:ON,backendName:"webgl",kernelFunc:Zet};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jet=Ao+`
  return (x < 0.0) ? 0.0 : x;
`,ett=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ttt=Zn({opSnippet:Jet,packedOpSnippet:ett}),ntt={kernelName:$N,backendName:"webgl",kernelFunc:ttt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rtt=Ao+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,itt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,att=Zn({opSnippet:rtt,packedOpSnippet:itt}),stt={kernelName:zN,backendName:"webgl",kernelFunc:att};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ott{constructor(e,t,r,i,a){this.variableNames=["A"],this.outputShape=[];const[s,o,l,u]=e;this.outputShape=[s,t,r,u];const c=[i&&t>1?o-1:o,i&&r>1?l-1:l],f=[i&&t>1?t-1:t,i&&r>1?r-1:r];let h;a?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ltt{constructor(e,t,r,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,l,u]=e;this.outputShape=[s,t,r,u];const c=[i&&t>1?o-1:o,i&&r>1?l-1:l],f=[i&&t>1?t-1:t,i&&r>1?r-1:r];let h;a?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function utt(n){const{inputs:e,backend:t,attrs:r}=n,{images:i}=e,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,u]=o,c=We().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ltt(i.shape,l,u,a,s):new ott(i.shape,l,u,a,s);return t.runWebGLProgram(c,[i],"float32")}const ctt={kernelName:UN,backendName:"webgl",kernelFunc:utt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ftt{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,i,a]=t,[,s,o]=e,l=[r&&s>1?i-1:i,r&&o>1?a-1:a],u=[r&&s>1?s-1:s,r&&o>1?o-1:o],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,m=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function htt(n){const{inputs:e,backend:t,attrs:r}=n,{images:i,dy:a}=e,{alignCorners:s}=r,o=new ftt(a.shape,i.shape,s);return t.runWebGLProgram(o,[a],a.dtype)}const dtt={kernelName:tQ,backendName:"webgl",kernelFunc:htt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ptt{constructor(e,t,r,i,a){this.variableNames=["A"],this.outputShape=[];const[s,o,l,u]=e;this.outputShape=[s,t,r,u];const c=[i&&t>1?o-1:o,i&&r>1?l-1:l],f=[i&&t>1?t-1:t,i&&r>1?r-1:r],h=i?"0.5":"0.0";let d;a?d="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/f[0]},
          ${c[1]/f[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mtt{constructor(e,t,r,i,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,o,l,u]=e;this.outputShape=[s,t,r,u];const c=[i&&t>1?o-1:o,i&&r>1?l-1:l],f=[i&&t>1?t-1:t,i&&r>1?r-1:r],h=i?"0.5":"0.0";let d;a?d="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/f[0]},
          ${c[1]/f[1]},
          ${c[1]/f[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gtt(n){const{inputs:e,backend:t,attrs:r}=n,{images:i}=e,{alignCorners:a,halfPixelCenters:s,size:o}=r,[l,u]=o,c=We().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new mtt(i.shape,l,u,a,s):new ptt(i.shape,l,u,a,s);return t.runWebGLProgram(c,[i],i.dtype)}const vtt={kernelName:BN,backendName:"webgl",kernelFunc:gtt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ytt{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,i,a]=t,[,s,o]=e,l=[r&&s>1?i-1:i,r&&o>1?a-1:a],u=[r&&s>1?s-1:s,r&&o>1?o-1:o],c=l[0]/u[0],f=l[1]/u[1],h=1/c,d=1/f,p=Math.ceil(h)*2+2,m=Math.ceil(d)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${f});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${d});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${s}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _tt(n){const{inputs:e,backend:t,attrs:r}=n,{images:i,dy:a}=e,{alignCorners:s}=r,o=new ytt(a.shape,i.shape,s);return t.runWebGLProgram(o,[a],a.dtype)}const xtt={kernelName:eQ,backendName:"webgl",kernelFunc:_tt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class btt{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const i=o=>t.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,a=e.map((o,l)=>i(l)).join(","),s=$r(r);this.userCode=`
      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wtt{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const i=ma("rc",r),a=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,o=$r(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${a}){
            result.g = ${u(i.slice())};
          }
          if(${s}) {
            result.b = ${c(i.slice())};
            if(${a}) {
              result.a = ${f(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function f(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const m=e.map((_,x)=>d(x,p)),g=m.join(","),v=m.slice(-2).join(",");return`getChannel(getX(${g}), vec2(${v}))`}function d(p,m){return t.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Stt(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{dims:a}=r,s=i.shape.length,o=_i(a,i.shape);if(s===0)return us({inputs:{x:i},backend:t});const l=We().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wtt(i.shape,o):new btt(i.shape,o);return t.runWebGLProgram(l,[i],i.dtype)}const Ttt={kernelName:VN,backendName:"webgl",kernelFunc:Stt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ctt{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],i=e[2];this.outputShape=e;let a="";typeof t=="number"?a=`float outputValue = ${t.toFixed(2)};`:a=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ett={kernelName:EO,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:i,fillValue:a,center:s}=e,o=t,l=new Ctt(r.shape,a),[u,c]=vte(s,r.shape[1],r.shape[2]),f=[[u,c,Math.sin(i),Math.cos(i)]];return o.runWebGLProgram(l,[r],r.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Att=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Mtt=Zn({opSnippet:Att}),ktt={kernelName:HN,backendName:"webgl",kernelFunc:Mtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rtt="return inversesqrt(x);",Ptt=Zn({opSnippet:Rtt,cpuKernelImpl:Zqe}),Itt={kernelName:WN,backendName:"webgl",kernelFunc:Ptt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lre{constructor(e,t,r,i,a,s,o=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const l=$r(a.length),u=$r(s.length);let c="";r===1?c="i":r===2&&(c="i, j");const f=`getIndices(${c})`;let h="";i===1?h="i":i===2&&(h="i, coords[1]");const d=`getUpdates(${h})`,p=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${a});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${p};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${d};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dtt(n){const{inputs:e,backend:t,attrs:r}=n,{indices:i,updates:a}=e,{shape:s}=r,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:f}=eC(a,i,s),h=[f/u,u];if(f===0)return t.makeTensorInfo(s,i.dtype);const d=Mt({inputs:{x:i},backend:t,attrs:{shape:[l,o]}}),p=Mt({inputs:{x:a},backend:t,attrs:{shape:[l,u]}}),m=t.makeTensorInfo([],"float32",new Float32Array([0])),g=new lre(l,o,d.shape.length,p.shape.length,c,h),v=t.runWebGLProgram(g,[p,d,m],p.dtype),_=Mt({inputs:{x:v},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(m),_}const Ltt={kernelName:GN,backendName:"webgl",kernelFunc:Dtt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ntt{constructor(e,t,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const a="while (left < right) {",s=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,o=We().getNumber("WEBGL_VERSION")===2?a:s,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ott(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:i,values:a}=e,{side:s}=r,o=new Ntt(i.shape[0],i.shape[1],a.shape[1],s),l=[[i.shape[1]]];return t.runWebGLProgram(o,[i,a],"int32",l)}const $tt={kernelName:jN,backendName:"webgl",kernelFunc:Ott};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ftt{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let i,a;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)a="resRC",i="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<t.length;c++)u.push(`${o[c]}`),c<e&&l.push(`${o[c]}`);i=l.join(),a=u.join()}const s=$r(r);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Btt(n){const{inputs:e,backend:t}=n,{condition:r,t:i,e:a}=e,s=new Ftt(r.shape.length,i.shape,i.shape.length);return t.runWebGLProgram(s,[r,i,a],nl(i.dtype,a.dtype))}const Utt={kernelName:qN,backendName:"webgl",kernelFunc:Btt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ztt=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${xte};
  float scale = ${bte};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Vtt=Zn({opSnippet:ztt}),Htt={kernelName:XN,backendName:"webgl",kernelFunc:Vtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wtt=rv+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Gtt=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,jtt=Zn({opSnippet:Wtt,packedOpSnippet:Gtt,cpuKernelImpl:Jqe}),qtt={kernelName:JN,backendName:"webgl",kernelFunc:jtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xtt=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Ktt=Zn({opSnippet:Xtt}),Ytt={kernelName:QN,backendName:"webgl",kernelFunc:Ktt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ztt=rv+`
  return sin(x);
`,Qtt=Zn({opSnippet:Ztt}),Jtt={kernelName:YN,backendName:"webgl",kernelFunc:Qtt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ent=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,tnt=Zn({opSnippet:ent}),nnt={kernelName:ZN,backendName:"webgl",kernelFunc:tnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rnt=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,int=Zn({opSnippet:rnt}),ant={kernelName:eO,backendName:"webgl",kernelFunc:int};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const snt=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{blockShape:a,paddings:s}=r;le(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=a.reduce((v,_)=>v*_),l=[[0,0]];l.push(...s);for(let v=1+a.length;v<i.shape.length;++v)l.push([0,0]);const u=[],c=sre({inputs:{x:i},backend:t,attrs:{paddings:l,constantValue:0}}),f=j3(c.shape,a,o,!1),h=q3(f.length,a.length,!1),d=X3(c.shape,a,o,!1),p=Mt({inputs:{x:c},backend:t,attrs:{shape:f}}),m=ba({inputs:{x:p},backend:t,attrs:{perm:h}}),g=Mt({inputs:{x:m},backend:t,attrs:{shape:d}});return u.push(c),u.push(p),u.push(m),u.forEach(v=>t.disposeIntermediateTensorInfo(v)),g},ont={kernelName:rO,backendName:"webgl",kernelFunc:snt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lnt(n){const{inputs:e,backend:t}=n,{indices:r,values:i,denseShape:a,defaultValue:s}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(s.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${s.shape}`);const o=t.readSync(r.dataId),l=t.readSync(i.dataId),u=t.readSync(a.dataId),c=t.readSync(s.dataId)[0],[f,h,d,p,m]=tXe(o,r.shape,r.dtype,l,i.dtype,u,c);return[t.makeTensorInfo(h,r.dtype,f),t.makeTensorInfo([h[0]],i.dtype,d),t.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(g=>Number(g)))),t.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const unt={kernelName:sO,backendName:"webgl",kernelFunc:lnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cnt(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:i,newShape:a}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const s=Array.from(t.readSync(i.dataId)),o=t.readSync(r.dataId),l=Array.from(t.readSync(a.dataId)),[u,c,f]=nXe(o,r.shape,r.dtype,s,l);return[t.makeTensorInfo(c,r.dtype,u),t.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const fnt={kernelName:oO,backendName:"webgl",kernelFunc:cnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hnt(n){const{inputs:e,backend:t}=n,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const s=t.readSync(r.dataId),o=t.readSync(i.dataId),l=t.readSync(a.dataId),[u,c]=Pne(s,r.shape,r.dtype,o,l,!0);return t.makeTensorInfo(c,r.dtype,u)}const dnt={kernelName:lO,backendName:"webgl",kernelFunc:hnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pnt(n){const{inputs:e,backend:t}=n,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const s=t.readSync(r.dataId),o=t.readSync(i.dataId),l=t.readSync(a.dataId),[u,c]=Pne(s,r.shape,r.dtype,o,l);return t.makeTensorInfo(c,r.dtype,u)}const mnt={kernelName:uO,backendName:"webgl",kernelFunc:pnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gnt(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:i,sparseValues:a,defaultValue:s}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:f,outputSize:h}=eC(a,i,o),d=!1;if(a.dtype==="string"){const v=t.bufferSync(i),_=t.bufferSync(a),x=Cd(t.readSync(s.dataId)[0]),b=Qqe(v,_,o,h,c,u,l,f,x,d);return t.makeTensorInfo(o,b.dtype,b.values)}const p=new lre(u,l,i.shape.length,a.shape.length,f,[h,1],d),m=t.runWebGLProgram(p,[a,i,s],a.dtype),g=Mt({inputs:{x:m},backend:t,attrs:{shape:o}});return t.disposeIntermediateTensorInfo(m),g}const vnt={kernelName:cO,backendName:"webgl",kernelFunc:gnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ynt(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{numOrSizeSplits:a,axis:s}=r,o=_i(s,i.shape)[0],l=Dte(i,a,o),u=i.shape.length,c=new Array(u).fill(0),f=i.shape.slice();return l.map(h=>{const d=[...f];d[o]=h;const p=iv({inputs:{x:i},backend:t,attrs:{begin:c,size:d}});return c[o]+=h,p})}const _nt={kernelName:iO,backendName:"webgl",kernelFunc:ynt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PW="return sqrt(x);",xnt=Zn({opSnippet:PW,packedOpSnippet:PW,cpuKernelImpl:rXe}),bnt={kernelName:tO,backendName:"webgl",kernelFunc:xnt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wnt="return x * x;",Snt=Zn({opSnippet:wnt}),Tnt={kernelName:nQ,backendName:"webgl",kernelFunc:Snt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW="return (a - b) * (a - b);",Cnt=zi({opSnippet:IW,packedOpSnippet:IW}),Ent={kernelName:fO,backendName:"webgl",kernelFunc:Cnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ant({inputs:n,attrs:e,backend:t}){const{x:r}=n,i=Ao+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new Fu(r.shape,i);return t.runWebGLProgram(a,[r],r.dtype)}const Mnt={kernelName:CO,backendName:"webgl",kernelFunc:Ant};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class knt{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,a=$r(r.length),s=$r(r.length);let o="";if(i===1)o="coords * strides + begin";else{let l=0;o=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${t});

      void main() {
        ${s} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rnt(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{begin:a,end:s,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:f,shrinkAxisMask:h}=r,{finalShapeSparse:d,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:v,begin:_,end:x,strides:b}=XQ(i.shape,a,s,o,l,u,c,f,h);let S;if(m)S=Mt({inputs:{x:i},backend:t,attrs:{shape:p}});else if(g||v){le(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const M=FQ(_,x,b),C=iv({inputs:{x:i},backend:t,attrs:{begin:_,size:M}});S=Mt({inputs:{x:C},backend:t,attrs:{shape:p}}),t.disposeIntermediateTensorInfo(C)}else if(t.shouldExecuteOnCPU([i])){const C=t.readSync(i.dataId),k=ei(i.shape,i.dtype,C),R=iXe(d,k,b,_);S=t.makeTensorInfo(p,i.dtype,R.values)}else{const C=new knt(_,b,d);S=t.runWebGLProgram(C,[i],i.dtype)}const T=Mt({inputs:{x:S},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(S),T}const Pnt={kernelName:hO,backendName:"webgl",kernelFunc:Rnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Int(n){const{inputs:e,backend:t,attrs:r}=n,{separator:i,nGramWidths:a,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:f}=e,h=t.readSync(c.dataId),d=t.readSync(f.dataId),[p,m]=aXe(h,d,i,a,s,o,l,u);return[t.makeTensorInfo([p.length],"string",p),t.makeTensorInfo(f.shape,"int32",m)]}const Dnt={kernelName:dO,backendName:"webgl",kernelFunc:Int};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lnt(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:i}=r,{input:a,delimiter:s}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(s.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const o=t.readSync(a.dataId),l=t.readSync(s.dataId)[0],[u,c,f]=sXe(o,l,i),h=c.length;return[t.makeTensorInfo([h,2],"int32",u),t.makeTensorInfo([h],"string",c),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const Nnt={kernelName:pO,backendName:"webgl",kernelFunc:Lnt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ont(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:i}=r,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const s=t.readSync(a.dataId),o=oXe(s,i);return t.makeTensorInfo(a.shape,"int32",o)}const $nt={kernelName:mO,backendName:"webgl",kernelFunc:Ont};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fnt="return tan(x);",Bnt=Zn({opSnippet:Fnt}),Unt={kernelName:vO,backendName:"webgl",kernelFunc:Bnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const znt=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Vnt=Zn({opSnippet:znt}),Hnt={kernelName:yO,backendName:"webgl",kernelFunc:Vnt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wnt{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let s=0;s<r.length;s++)r[s]=e[s]*t[s];this.outputShape=r,this.rank=r.length;const i=$r(this.rank),a=Gnt(e);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function Gnt(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<n.length;i++)r.push(`imod(${t[i]}, ${n[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{reps:a}=r;if(i.dtype==="string"||i.shape.length>5){const l=t.readSync(i.dataId),u=i.dtype==="string"?l.map(h=>Cd(h)):l,c=ei(i.shape,i.dtype,u),f=uXe(c,a);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const s=new Wnt(i.shape,a);return t.runWebGLProgram(s,[i],i.dtype)}const jnt={kernelName:YT,backendName:"webgl",kernelFunc:ure};class qnt{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Xnt{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wh(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function DW(n){let e=1;for(;e<n;)e*=2;return e}function Knt(n){const{inputs:e,backend:t,attrs:r}=n,{x:i}=e,{k:a,sorted:s}=r,o=We().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=We().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=i.shape,c=u[u.length-1];if(t.shouldExecuteOnCPU([i])||c<o||a>l){const R=t.readSync(i.dataId),[P,N]=cXe(R,u,i.dtype,a,s);return[t.makeTensorInfo(P.shape,P.dtype,P.values),t.makeTensorInfo(N.shape,N.dtype,N.values)]}if(a===0)return u[u.length-1]=0,[t.makeTensorInfo(u,i.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(c===1)return[i,rx({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const f=t.texData.get(i.dataId),h=f!==null&&f.isPacked,d=h?t.unpackTensor(i):i,m=yt(u)/c,g=Mt({inputs:{x:d},attrs:{shape:[m,c]},backend:t});h&&wh(t,d);const v=DW(a),_=DW(c);let x=null;const b=()=>x===null?[g,g]:[g,x],S=(R,P,N)=>{const L=b(),F=new qnt(N),B=[[c],[x===null?1:0],[Number.NEGATIVE_INFINITY],[R],[P]],H=x;x=t.runWebGLProgram(F,L,"int32",B),wh(t,H)};for(let R=1;R<v;R*=2){const P=R*2;for(let N=R;N>=1;N/=2)S(P,N,[m,_])}for(let R=_;R>v;R/=2){const P=b(),N=new Xnt([m,R/2]),F=[[c],[x===null?1:0],[v]],O=x;x=t.runWebGLProgram(N,P,"int32",F),wh(t,O);const B=v/2,H=B*2;for(let j=B;j>=1;j/=2)S(H,j,x.shape)}let T=x;x=iv({inputs:{x},backend:t,attrs:{begin:0,size:[m,a]}}),wh(t,T);let M=ere({inputs:{x:g,indices:x},backend:t,attrs:{axis:1,batchDims:1}});wh(t,g);const C=u.slice(0,-1);C.push(a),T=x,x=Mt({inputs:{x},attrs:{shape:C},backend:t}),wh(t,T);const k=M;return M=Mt({inputs:{x:M},attrs:{shape:C},backend:t}),wh(t,k),[M,x]}const Ynt={kernelName:_O,backendName:"webgl",kernelFunc:Knt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Znt{constructor(e,t,r,i,a,s){this.variableNames=["Image","Transforms"],this.outputShape=s;const o=r==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qnt(n){const{inputs:e,backend:t,attrs:r}=n,{image:i,transforms:a}=e,{interpolation:s,fillMode:o,fillValue:l,outputShape:u}=r,[c,f,h,d]=i.shape,[p,m]=u??[f,h],g=[c,p,m,d],v=new Znt(f,h,s,o,l,g);return t.runWebGLProgram(v,[i,a],"float32")}const Jnt={kernelName:xO,backendName:"webgl",kernelFunc:Qnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ert(n){const{inputs:e,attrs:t,backend:r}=n,{axis:i}=t,{x:a}=e;Q_(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const s=r.readSync(a.dataId),{outputValues:o,outputShape:l,indices:u}=fXe(s,i,a.shape,a.dtype);return[r.makeTensorInfo(l,a.dtype,o),r.makeTensorInfo([u.length],"int32",u)]}const trt={kernelName:bO,backendName:"webgl",kernelFunc:ert};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nrt(n){const{inputs:e,backend:t,attrs:r}=n,{value:i}=e;let{axis:a}=r;a<0&&(a+=i.shape.length);const s=i,o=s.shape.length,l=i.shape[a],u=new Array(o-1);let c=0;for(let m=0;m<o;m++)m!==a&&(u[c++]=s.shape[m]);const f=[],h=new Array(o).fill(0),d=s.shape.slice();d[a]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[a]=m;const g=iv({inputs:{x:s},backend:t,attrs:{begin:h,size:d}}),v=Mt({inputs:{x:g},backend:t,attrs:{shape:u}});p[m]=v,f.push(g)}return f.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}const rrt={kernelName:wO,backendName:"webgl",kernelFunc:nrt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class irt{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,i=e.batchSize,a=e.inSize,s=e.numSegments,o=s*Math.ceil(a/r);this.outputShape=[i,o];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,f=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let d="";a%r>0&&(d=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let p="";a%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${s})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${s})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${c};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function art(n){const{inputs:e,backend:t,attrs:r}=n,{x:i,segmentIds:a}=e,{numSegments:s}=r,o=i.shape.length,l=[];let u=0;const c=Co([u],o);let f=i;c!=null&&(f=ba({inputs:{x:i},backend:t,attrs:{perm:c}}),l.push(f),u=Eo(1,o)[0]);const h=jte(f.shape,u,s),d=yt([f.shape[u]]),p=Mt({inputs:{x:f},backend:t,attrs:{shape:[-1,d]}});l.push(p);const m=ZT(i.dtype),g=(b,S,T,M,C)=>{const k=b.shape[0],R=b.shape[1],P=Gte(R,C),N={windowSize:P,inSize:R,batchSize:k,numSegments:C},L=new irt(N,S),F=t.compileAndRun(L,[b,T],M);if(l.push(F),F.shape[1]===C)return F;const O=ore({backend:t,attrs:{start:0,stop:C,step:1,dtype:"float32"}}),B=ure({inputs:{x:O},backend:t,attrs:{reps:[R/P]}});return l.push(O),l.push(B),g(F,S,B,M,C)},v=g(p,"unsortedSegmentSum",a,m,s),_=Mt({inputs:{x:v},backend:t,attrs:{shape:h}});let x=_;if(c!=null){l.push(_);const b=i3(c);x=ba({inputs:{x},backend:t,attrs:{perm:b}})}return l.forEach(b=>t.disposeIntermediateTensorInfo(b)),x}const srt={kernelName:SO,backendName:"webgl",kernelFunc:art};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ort=[nKe,iKe,oKe,cKe,hKe,mKe,vKe,_Ke,SKe,CKe,MKe,PKe,LKe,FKe,zKe,HKe,GKe,KKe,ZKe,JKe,rYe,cYe,hYe,pYe,xYe,wYe,EYe,BXe,kYe,LYe,FYe,WYe,jYe,XYe,YYe,QYe,tZe,iZe,oZe,uZe,fZe,dZe,gZe,yZe,wZe,TZe,AZe,RZe,IZe,OZe,UZe,WZe,qZe,YZe,ZZe,JZe,tQe,rQe,aQe,oQe,fQe,pQe,vQe,_Qe,wQe,CQe,kQe,DQe,FXe,NQe,IYe,FQe,zQe,WQe,zXe,XQe,QQe,eJe,iJe,oJe,fJe,pJe,yJe,wJe,CJe,AJe,PJe,DJe,NJe,BJe,zJe,HJe,GJe,qJe,ZJe,tet,aet,pet,WXe,yet,bet,Cet,Met,gYe,Pet,Det,Net,Fet,Vet,HXe,Wet,jet,Xet,Ket,vYe,cet,Qet,ntt,stt,jXe,ctt,dtt,vtt,xtt,Ttt,Ett,ktt,Itt,Ltt,$tt,Utt,Htt,qtt,Ytt,Jtt,nnt,lYe,het,ant,ont,unt,fnt,dnt,mnt,vnt,_nt,bnt,Tnt,Ent,Mnt,Pnt,Dnt,Nnt,$nt,fet,JXe,Unt,Hnt,jnt,Ynt,Jnt,eKe,trt,rrt,srt,Iet];for(const n of ort)AO(n);export{Grt as $,nP as A,Cf as B,frt as C,lrt as D,Lrt as E,hr as F,urt as G,$rt as H,grt as I,yrt as J,xrt as K,_rt as L,wrt as M,brt as N,Trt as O,Hae as P,r2 as Q,Yrt as R,bo as S,YR as T,ui as U,Q as V,nI as W,Vrt as X,ns as Y,dCe as Z,Xrt as _,It as a,prt as a$,qrt as a0,Urt as a1,Za as a2,BTe as a3,Krt as a4,gn as a5,Wrt as a6,Fd as a7,De as a8,pp as a9,yit as aA,cit as aB,pit as aC,fit as aD,sit as aE,lit as aF,Jrt as aG,eit as aH,tit as aI,rit as aJ,Zrt as aK,Hr as aL,Ei as aM,Qrt as aN,xa as aO,Hrt as aP,I0 as aQ,C2 as aR,iit as aS,nit as aT,fCe as aU,S_ as aV,_it as aW,uP as aX,TS as aY,xit as aZ,mrt as a_,mp as aa,Gl as ab,x5 as ac,un as ad,_r as ae,Ef as af,Drt as ag,Le as ah,crt as ai,oCe as aj,jrt as ak,Dd as al,Et as am,d7 as an,jc as ao,rT as ap,sX as aq,Yu as ar,dit as as,hit as at,uit as au,git as av,mit as aw,oit as ax,ait as ay,vit as az,Ii as b,Ort as b0,bit as b1,On as c,Dt as d,kt as e,Pn as f,Nn as g,Nrt as h,vrt as i,ef as j,wm as k,Prt as l,Irt as m,Rrt as n,at as o,Crt as p,Ert as q,Iie as r,Srt as s,pi as t,drt as u,hrt as v,An as w,Gae as x,e2 as y,cn as z};
