import{y as R,z as $,A as K,B as M,n as O,o as z,m as P,C as U,p as j}from"./vendor-0d15525d.js";import{d as T,b as w,c as C,j as W,m as b,S as f,R as t,O as a,ak as X,V as d,W as V,u as c,X as k,t as q}from"./@vue-30559afa.js";const F=q("label",{class:"operation-label"},"文本指令：",-1),J=T({__name:"console-form",props:{localStream:{},dataChannel:{},peerConnection:{},btnDiabled:{type:Boolean},experiment:{type:Boolean},mediaDevices:{}},emits:["handleAudio","handleVideo"],setup(D,{expose:S,emit:p}){const l=D,s=w(""),u=w("");let o;const m=C(()=>l.mediaDevices.audio),v=C(()=>l.mediaDevices.video),g=e=>{u.value+=`${e}
`},y=()=>{var e,n;if(s.value){if(((e=l.dataChannel)==null?void 0:e.readyState)!=="open"){O.error("信道未建立，无法发送指令");return}(n=l.dataChannel)==null||n.send(s.value),g(`发送指令：${s.value}`),s.value=""}},x=()=>{u.value="",p("handleAudio",!1)},h=e=>{e==="audio"?p("handleAudio",!l.mediaDevices.audio):p("handleVideo",!l.mediaDevices.video)},B=()=>{"webkitSpeechRecognition"in window&&(o=new webkitSpeechRecognition||new SpeechRecognition,o.continuous=!0,o.lang="zh-CN",o.onaudiostart=()=>{console.log("录音开始-audiostart")},o.onaudioend=()=>{console.log("录音结束-audioend")},o.onstart=()=>{console.log("收声开始-start")},o.onnomatch=()=>{console.log("未匹配")},o.onsoundstart=()=>{console.log("收声开始-soundstart")},o.onsoundend=()=>{console.log("收声结束-soundend")},o.onspeechend=()=>{console.log("语音结束-speeched")},o.onspeechstart=()=>{console.log("语音开始-speechstart")},o.onend=()=>{console.log("收声结束-end")},o.onresult=e=>{const n=e.results[e.resultIndex][0].transcript;console.log("语音识别结果：",n)},o.onerror=e=>{console.error("语音识别错误：",e.error)})};W(()=>{B()});const A=()=>{o.start()},E=()=>{o.stop()};return S({writeInfo:g,reduction:x}),(e,n)=>{const _=z,i=P,N=U,I=j;return b(),f(I,{class:"box-card"},{default:t(()=>[F,a(_,{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=r=>s.value=r),style:{width:"200px","margin-right":"10px"},placeholder:"要发送的指令",clearable:"",disabled:e.btnDiabled,onKeyup:X(y,["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(i,{type:"primary",onClick:y,disabled:e.btnDiabled},{default:t(()=>[d("发送指令")]),_:1},8,["disabled"]),a(i,{type:m.value?"success":"warning",onClick:n[1]||(n[1]=r=>h("audio")),disabled:e.btnDiabled,icon:m.value?c(R):c($)},{default:t(()=>[d(V(m.value?"关闭":"打开")+"麦克风 ",1)]),_:1},8,["type","disabled","icon"]),a(i,{type:v.value?"success":"warning",onClick:n[2]||(n[2]=r=>h("video")),icon:v.value?c(K):c(M)},{default:t(()=>[d(V(v.value?"关闭":"打开")+"本地视频",1)]),_:1},8,["type","icon"]),a(N,{placement:"bottom",title:"指令面板",width:500,trigger:"click"},{reference:t(()=>[a(i,{disabled:e.btnDiabled},{default:t(()=>[d("打开对话框")]),_:1},8,["disabled"])]),default:t(()=>[a(_,{modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=r=>u.value=r),readonly:"",placeholder:"Please input",rows:6,"show-word-limit":"",type:"textarea"},null,8,["modelValue"])]),_:1}),e.experiment?(b(),f(i,{key:0,type:"primary",onClick:A},{default:t(()=>[d("开始录音")]),_:1})):k("",!0),e.experiment?(b(),f(i,{key:1,type:"primary",onClick:E},{default:t(()=>[d("结束录音")]),_:1})):k("",!0)]),_:1})}}});export{J as _};
