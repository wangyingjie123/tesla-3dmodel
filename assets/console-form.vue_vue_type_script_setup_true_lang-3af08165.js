import{x as I,y as R,z as $,A as K,o as O,m as z,B as M,p as P}from"./vendor-43fb942a.js";import{d as U,b as w,c as V,j,m as b,S as f,R as t,O as a,ak as T,V as i,W as k,u as c,X as C,t as W}from"./@vue-30559afa.js";const X=W("label",{class:"operation-label"},"文本指令：",-1),G=U({__name:"console-form",props:{localStream:{},dataChannel:{},peerConnection:{},btnDiabled:{type:Boolean},experiment:{type:Boolean},mediaDevices:{}},emits:["handleAudio","handleVideo"],setup(D,{expose:x,emit:p}){const d=D,l=w(""),u=w("");let o;const m=V(()=>d.mediaDevices.audio),v=V(()=>d.mediaDevices.video),g=e=>{u.value+=`${e}
`},y=()=>{var e;l.value&&((e=d.dataChannel)==null||e.send(l.value),g(`发送指令：${l.value}`),l.value="")},S=()=>{u.value="",p("handleAudio",!1)},_=e=>{e==="audio"?p("handleAudio",!d.mediaDevices.audio):p("handleVideo",!d.mediaDevices.video)};j(()=>{"webkitSpeechRecognition"in window&&(o=new webkitSpeechRecognition||new SpeechRecognition,o.continuous=!0,o.lang="zh-CN",o.onaudiostart=()=>{console.log("录音开始-audiostart")},o.onaudioend=()=>{console.log("录音结束-audioend")},o.onstart=()=>{console.log("收声开始-start")},o.onnomatch=()=>{console.log("未匹配")},o.onsoundstart=()=>{console.log("收声开始-soundstart")},o.onsoundend=()=>{console.log("收声结束-soundend")},o.onspeechend=()=>{console.log("语音结束-speeched")},o.onspeechstart=()=>{console.log("语音开始-speechstart")},o.onend=()=>{console.log("收声结束-end")},o.onresult=e=>{const n=e.results[e.resultIndex][0].transcript;console.log("语音识别结果：",n)},o.onerror=e=>{console.error("语音识别错误：",e.error)})});const B=()=>{o.start()},A=()=>{o.stop()};return x({writeInfo:g,reduction:S}),(e,n)=>{const h=O,s=z,N=M,E=P;return b(),f(E,{class:"box-card"},{default:t(()=>[X,a(h,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=r=>l.value=r),style:{width:"200px","margin-right":"10px"},placeholder:"要发送的指令",clearable:"",disabled:e.btnDiabled,onKeyup:T(y,["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(s,{type:"primary",onClick:y,disabled:e.btnDiabled},{default:t(()=>[i("发送指令")]),_:1},8,["disabled"]),a(s,{type:m.value?"success":"warning",onClick:n[1]||(n[1]=r=>_("audio")),disabled:e.btnDiabled,icon:m.value?c(I):c(R)},{default:t(()=>[i(k(m.value?"关闭":"打开")+"麦克风 ",1)]),_:1},8,["type","disabled","icon"]),a(s,{type:v.value?"success":"warning",onClick:n[2]||(n[2]=r=>_("video")),icon:v.value?c($):c(K)},{default:t(()=>[i(k(v.value?"关闭":"打开")+"本地视频",1)]),_:1},8,["type","icon"]),a(N,{placement:"bottom",title:"指令面板",width:500,trigger:"click"},{reference:t(()=>[a(s,{disabled:e.btnDiabled},{default:t(()=>[i("打开对话框")]),_:1},8,["disabled"])]),default:t(()=>[a(h,{modelValue:u.value,"onUpdate:modelValue":n[3]||(n[3]=r=>u.value=r),readonly:"",placeholder:"Please input",rows:6,"show-word-limit":"",type:"textarea"},null,8,["modelValue"])]),_:1}),e.experiment?(b(),f(s,{key:0,type:"primary",onClick:B},{default:t(()=>[i("开始录音")]),_:1})):C("",!0),e.experiment?(b(),f(s,{key:1,type:"primary",onClick:A},{default:t(()=>[i("结束录音")]),_:1})):C("",!0)]),_:1})}}});export{G as _};
